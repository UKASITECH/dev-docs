<h1>useTransition
</h1>
<div>
<p><code dir="ltr">useTransition</code> is a React Hook that lets you update the state without blocking the UI.</p>
<pre data-language="jsx"><code><span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span></code></pre>
</div> <ul>
<li>
<a href="#reference">Reference </a><ul>
<li><a href="#usetransition"><code dir="ltr">useTransition()</code> </a></li>
<li><a href="#starttransition"><code dir="ltr">startTransition</code> function </a></li>
</ul>
</li>
<li>
<a href="#usage">Usage </a><ul>
<li><a href="#marking-a-state-update-as-a-non-blocking-transition">Marking a state update as a non-blocking Transition </a></li>
<li><a href="#updating-the-parent-component-in-a-transition">Updating the parent component in a Transition </a></li>
<li><a href="#displaying-a-pending-visual-state-during-the-transition">Displaying a pending visual state during the Transition </a></li>
<li><a href="#preventing-unwanted-loading-indicators">Preventing unwanted loading indicators </a></li>
<li><a href="#building-a-suspense-enabled-router">Building a Suspense-enabled router </a></li>
<li><a href="#displaying-an-error-to-users-with-error-boundary">Displaying an error to users with an error boundary </a></li>
</ul>
</li>
<li>
<a href="#troubleshooting">Troubleshooting </a><ul>
<li><a href="#updating-an-input-in-a-transition-doesnt-work">Updating an input in a Transition doesn‚Äôt work </a></li>
<li><a href="#react-doesnt-treat-my-state-update-as-a-transition">React doesn‚Äôt treat my state update as a Transition </a></li>
<li><a href="#i-want-to-call-usetransition-from-outside-a-component">I want to call <code dir="ltr">useTransition</code> from outside a component </a></li>
<li><a href="#the-function-i-pass-to-starttransition-executes-immediately">The function I pass to <code dir="ltr">startTransition</code> executes immediately </a></li>
</ul>
</li>
</ul> <hr> <h2 id="reference">Reference 
</h2> <h3 id="usetransition">
<code dir="ltr">useTransition()</code> 
</h3> <p>Call <code dir="ltr">useTransition</code> at the top level of your component to mark some state updates as Transitions.</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>useTransition</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>function</span> <span>TabContainer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre> <p><a href="#usage">See more examples below.</a></p> <h4 id="parameters">Parameters 
</h4> <p><code dir="ltr">useTransition</code> does not take any parameters.</p> <h4 id="returns">Returns 
</h4> <p><code dir="ltr">useTransition</code> returns an array with exactly two items:</p> <ol> <li>The <code dir="ltr">isPending</code> flag that tells you whether there is a pending Transition.</li> <li>The <a href="#starttransition"><code dir="ltr">startTransition</code> function</a> that lets you mark a state update as a Transition.</li> </ol> <hr> <h3 id="starttransition">
<code dir="ltr">startTransition</code> function 
</h3> <p>The <code dir="ltr">startTransition</code> function returned by <code dir="ltr">useTransition</code> lets you mark a state update as a Transition.</p> <pre data-language="jsx"><code><span>function</span> <span>TabContainer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>tab</span><span>,</span> <span>setTab</span><span>]</span> = <span>useState</span><span>(</span><span>'about'</span><span>)</span><span>;</span>

  <span>function</span> <span>selectTab</span><span>(</span><span>nextTab</span><span>)</span> <span>{</span>
    <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setTab</span><span>(</span><span>nextTab</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>
  <span>// ...</span>
<span>}</span></code></pre> <h4 id="starttransition-parameters">Parameters 
</h4> <ul> <li>
<code dir="ltr">scope</code>: A function that updates some state by calling one or more <a href="usestate#setstate"><code dir="ltr">set</code> functions.</a> React immediately calls <code dir="ltr">scope</code> with no parameters and marks all state updates scheduled synchronously during the <code dir="ltr">scope</code> function call as Transitions. They will be <a href="#marking-a-state-update-as-a-non-blocking-transition">non-blocking</a> and <a href="#preventing-unwanted-loading-indicators">will not display unwanted loading indicators.</a>
</li> </ul> <h4 id="starttransition-returns">Returns 
</h4> <p><code dir="ltr">startTransition</code> does not return anything.</p> <h4 id="starttransition-caveats">Caveats 
</h4> <ul> <li> <p><code dir="ltr">useTransition</code> is a Hook, so it can only be called inside components or custom Hooks. If you need to start a Transition somewhere else (for example, from a data library), call the standalone <a href="starttransition"><code dir="ltr">startTransition</code></a> instead.</p> </li> <li> <p>You can wrap an update into a Transition only if you have access to the <code dir="ltr">set</code> function of that state. If you want to start a Transition in response to some prop or a custom Hook value, try <a href="usedeferredvalue"><code dir="ltr">useDeferredValue</code></a> instead.</p> </li> <li> <p>The function you pass to <code dir="ltr">startTransition</code> must be synchronous. React immediately executes this function, marking all state updates that happen while it executes as Transitions. If you try to perform more state updates later (for example, in a timeout), they won‚Äôt be marked as Transitions.</p> </li> <li> <p>The <code dir="ltr">startTransition</code> function has a stable identity, so you will often see it omitted from Effect dependencies, but including it will not cause the Effect to fire. If the linter lets you omit a dependency without errors, it is safe to do. <a href="../../learn/removing-effect-dependencies#move-dynamic-objects-and-functions-inside-your-effect">Learn more about removing Effect dependencies.</a></p> </li> <li> <p>A state update marked as a Transition will be interrupted by other state updates. For example, if you update a chart component inside a Transition, but then start typing into an input while the chart is in the middle of a re-render, React will restart the rendering work on the chart component after handling the input update.</p> </li> <li> <p>Transition updates can‚Äôt be used to control text inputs.</p> </li> <li> <p>If there are multiple ongoing Transitions, React currently batches them together. This is a limitation that will likely be removed in a future release.</p> </li> </ul> <hr> <h2 id="usage">Usage 
</h2> <h3 id="marking-a-state-update-as-a-non-blocking-transition">Marking a state update as a non-blocking Transition 
</h3> <p>Call <code dir="ltr">useTransition</code> at the top level of your component to mark state updates as non-blocking <em>Transitions</em>.</p> <pre data-language="jsx"><code><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useTransition</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>function</span> <span>TabContainer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>// ...</span>
<span>}</span></code></pre> <p><code dir="ltr">useTransition</code> returns an array with exactly two items:</p> <ol> <li>The <span data-step="1"><code dir="ltr">isPending</code> flag</span> that tells you whether there is a pending Transition.</li> <li>The <span data-step="2"><code dir="ltr">startTransition</code> function</span> that lets you mark a state update as a Transition.</li> </ol> <p>You can then mark a state update as a Transition like this:</p> <pre data-language="jsx"><code><span>function</span> <span>TabContainer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>tab</span><span>,</span> <span>setTab</span><span>]</span> = <span>useState</span><span>(</span><span>'about'</span><span>)</span><span>;</span>

  <span>function</span> <span>selectTab</span><span>(</span><span>nextTab</span><span>)</span> <span>{</span>
    <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setTab</span><span>(</span><span>nextTab</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>
  <span>// ...</span>
<span>}</span></code></pre> <p>Transitions let you keep the user interface updates responsive even on slow devices.</p> <p>With a Transition, your UI stays responsive in the middle of a re-render. For example, if the user clicks a tab but then change their mind and click another tab, they can do that without waiting for the first re-render to finish.</p> <div class="note">
<h4 id="examples">The difference between useTransition and regular state updates
</h4>

<div>
<h4 id="updating-the-current-tab-in-a-transition">
<div>Example 1 of 2<span>: </span>
</div>Updating the current tab in a Transition 
</h4>
<p>In this example, the ‚ÄúPosts‚Äù tab is <strong>artificially slowed down</strong> so that it takes at least a second to render.</p>
<p>Click ‚ÄúPosts‚Äù and then immediately click ‚ÄúContact‚Äù. Notice that this interrupts the slow render of ‚ÄúPosts‚Äù. The ‚ÄúContact‚Äù tab shows immediately. Because this state update is marked as a Transition, a slow re-render did not freeze the user interface.</p>

<pre data-language="jsx"><span>import</span> <span>{</span> <span>useState</span><span>,</span> <span>useTransition</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>TabButton</span> <span>from</span> <span>'./TabButton.js'</span><span>;</span>
<span>import</span> <span>AboutTab</span> <span>from</span> <span>'./AboutTab.js'</span><span>;</span>
<span>import</span> <span>PostsTab</span> <span>from</span> <span>'./PostsTab.js'</span><span>;</span>
<span>import</span> <span>ContactTab</span> <span>from</span> <span>'./ContactTab.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>TabContainer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>tab</span><span>,</span> <span>setTab</span><span>]</span> = <span>useState</span><span>(</span><span>'about'</span><span>)</span><span>;</span>

  <span>function</span> <span>selectTab</span><span>(</span><span>nextTab</span><span>)</span> <span>{</span>
    <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setTab</span><span>(</span><span>nextTab</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>tab</span> === <span>'about'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>selectTab</span><span>(</span><span>'about'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        About
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>tab</span> === <span>'posts'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>selectTab</span><span>(</span><span>'posts'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Posts (slow)
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>tab</span> === <span>'contact'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>selectTab</span><span>(</span><span>'contact'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Contact
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>{</span><span>tab</span> === <span>'about'</span> &amp;&amp; <span>&lt;</span><span>AboutTab</span> <span>/&gt;</span><span>}</span>
      <span>{</span><span>tab</span> === <span>'posts'</span> &amp;&amp; <span>&lt;</span><span>PostsTab</span> <span>/&gt;</span><span>}</span>
      <span>{</span><span>tab</span> === <span>'contact'</span> &amp;&amp; <span>&lt;</span><span>ContactTab</span> <span>/&gt;</span><span>}</span>
    <span>&lt;/</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre>
</div>

</div> <hr> <h3 id="updating-the-parent-component-in-a-transition">Updating the parent component in a Transition 
</h3> <p>You can update a parent component‚Äôs state from the <code dir="ltr">useTransition</code> call, too. For example, this <code dir="ltr">TabButton</code> component wraps its <code dir="ltr">onClick</code> logic in a Transition:</p> <pre data-language="jsx"><code><span>export</span> <span>default</span> <span>function</span> <span>TabButton</span><span>(</span><span>{</span> <span>children</span><span>,</span> <span>isActive</span><span>,</span> <span>onClick</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>if</span> <span>(</span><span>isActive</span><span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>b</span><span>&gt;</span><span>{</span><span>children</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span>
  <span>}</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
        <span>onClick</span><span>(</span><span>)</span><span>;</span>
      <span>}</span><span>)</span><span>;</span>
    <span>}</span><span>}</span><span>&gt;</span>
      <span>{</span><span>children</span><span>}</span>
    <span>&lt;/</span><span>button</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span></code></pre> <p>Because the parent component updates its state inside the <code dir="ltr">onClick</code> event handler, that state update gets marked as a Transition. This is why, like in the earlier example, you can click on ‚ÄúPosts‚Äù and then immediately click ‚ÄúContact‚Äù. Updating the selected tab is marked as a Transition, so it does not block user interactions.</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useTransition</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>TabButton</span><span>(</span><span>{</span> <span>children</span><span>,</span> <span>isActive</span><span>,</span> <span>onClick</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>if</span> <span>(</span><span>isActive</span><span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>b</span><span>&gt;</span><span>{</span><span>children</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span>
  <span>}</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
        <span>onClick</span><span>(</span><span>)</span><span>;</span>
      <span>}</span><span>)</span><span>;</span>
    <span>}</span><span>}</span><span>&gt;</span>
      <span>{</span><span>children</span><span>}</span>
    <span>&lt;/</span><span>button</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <hr> <h3 id="displaying-a-pending-visual-state-during-the-transition">Displaying a pending visual state during the Transition 
</h3> <p>You can use the <code dir="ltr">isPending</code> boolean value returned by <code dir="ltr">useTransition</code> to indicate to the user that a Transition is in progress. For example, the tab button can have a special ‚Äúpending‚Äù visual state:</p> <pre data-language="jsx"><code><span>function</span> <span>TabButton</span><span>(</span><span>{</span> <span>children</span><span>,</span> <span>isActive</span><span>,</span> <span>onClick</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>// ...</span>
  <span>if</span> <span>(</span><span>isPending</span><span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>b</span> <span>className</span>=<span>"pending"</span><span>&gt;</span><span>{</span><span>children</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span><span>;</span>
  <span>}</span>
  <span>// ...</span></code></pre> <p>Notice how clicking ‚ÄúPosts‚Äù now feels more responsive because the tab button itself updates right away:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useTransition</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>TabButton</span><span>(</span><span>{</span> <span>children</span><span>,</span> <span>isActive</span><span>,</span> <span>onClick</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>if</span> <span>(</span><span>isActive</span><span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>b</span><span>&gt;</span><span>{</span><span>children</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span>
  <span>}</span>
  <span>if</span> <span>(</span><span>isPending</span><span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>b</span> <span>className</span>=<span>"pending"</span><span>&gt;</span><span>{</span><span>children</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
        <span>onClick</span><span>(</span><span>)</span><span>;</span>
      <span>}</span><span>)</span><span>;</span>
    <span>}</span><span>}</span><span>&gt;</span>
      <span>{</span><span>children</span><span>}</span>
    <span>&lt;/</span><span>button</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <hr> <h3 id="preventing-unwanted-loading-indicators">Preventing unwanted loading indicators 
</h3> <p>In this example, the <code dir="ltr">PostsTab</code> component fetches some data using a <a href="suspense">Suspense-enabled</a> data source. When you click the ‚ÄúPosts‚Äù tab, the <code dir="ltr">PostsTab</code> component <em>suspends</em>, causing the closest loading fallback to appear:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>Suspense</span><span>,</span> <span>useState</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>TabButton</span> <span>from</span> <span>'./TabButton.js'</span><span>;</span>
<span>import</span> <span>AboutTab</span> <span>from</span> <span>'./AboutTab.js'</span><span>;</span>
<span>import</span> <span>PostsTab</span> <span>from</span> <span>'./PostsTab.js'</span><span>;</span>
<span>import</span> <span>ContactTab</span> <span>from</span> <span>'./ContactTab.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>TabContainer</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>tab</span><span>,</span> <span>setTab</span><span>]</span> = <span>useState</span><span>(</span><span>'about'</span><span>)</span><span>;</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>Suspense</span> <span>fallback</span>=<span>{</span><span>&lt;</span><span>h1</span><span>&gt;</span>üåÄ Loading...<span>&lt;/</span><span>h1</span><span>&gt;</span><span>}</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>tab</span> === <span>'about'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setTab</span><span>(</span><span>'about'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        About
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>tab</span> === <span>'posts'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setTab</span><span>(</span><span>'posts'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Posts
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>TabButton</span>
        <span>isActive</span>=<span>{</span><span>tab</span> === <span>'contact'</span><span>}</span>
        <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>setTab</span><span>(</span><span>'contact'</span><span>)</span><span>}</span>
      <span>&gt;</span>
        Contact
      <span>&lt;/</span><span>TabButton</span><span>&gt;</span>
      <span>&lt;</span><span>hr</span> <span>/&gt;</span>
      <span>{</span><span>tab</span> === <span>'about'</span> &amp;&amp; <span>&lt;</span><span>AboutTab</span> <span>/&gt;</span><span>}</span>
      <span>{</span><span>tab</span> === <span>'posts'</span> &amp;&amp; <span>&lt;</span><span>PostsTab</span> <span>/&gt;</span><span>}</span>
      <span>{</span><span>tab</span> === <span>'contact'</span> &amp;&amp; <span>&lt;</span><span>ContactTab</span> <span>/&gt;</span><span>}</span>
    <span>&lt;/</span><span>Suspense</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p>Hiding the entire tab container to show a loading indicator leads to a jarring user experience. If you add <code dir="ltr">useTransition</code> to <code dir="ltr">TabButton</code>, you can instead indicate display the pending state in the tab button instead.</p> <p>Notice that clicking ‚ÄúPosts‚Äù no longer replaces the entire tab container with a spinner:</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useTransition</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>TabButton</span><span>(</span><span>{</span> <span>children</span><span>,</span> <span>isActive</span><span>,</span> <span>onClick</span> <span>}</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>
  <span>if</span> <span>(</span><span>isActive</span><span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>b</span><span>&gt;</span><span>{</span><span>children</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span>
  <span>}</span>
  <span>if</span> <span>(</span><span>isPending</span><span>)</span> <span>{</span>
    <span>return</span> <span>&lt;</span><span>b</span> <span>className</span>=<span>"pending"</span><span>&gt;</span><span>{</span><span>children</span><span>}</span><span>&lt;/</span><span>b</span><span>&gt;</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>button</span> <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
        <span>onClick</span><span>(</span><span>)</span><span>;</span>
      <span>}</span><span>)</span><span>;</span>
    <span>}</span><span>}</span><span>&gt;</span>
      <span>{</span><span>children</span><span>}</span>
    <span>&lt;/</span><span>button</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <p><a href="suspense#preventing-already-revealed-content-from-hiding">Read more about using Transitions with Suspense.</a></p> <div class="note note-green">
<h4>Note</h4>
<div><p>Transitions will only ‚Äúwait‚Äù long enough to avoid hiding <em>already revealed</em> content (like the tab container). If the Posts tab had a <a href="suspense#revealing-nested-content-as-it-loads">nested <code dir="ltr">&lt;Suspense&gt;</code> boundary,</a> the Transition would not ‚Äúwait‚Äù for it.</p></div>
</div> <hr> <h3 id="building-a-suspense-enabled-router">Building a Suspense-enabled router 
</h3> <p>If you‚Äôre building a React framework or a router, we recommend marking page navigations as Transitions.</p> <pre data-language="jsx"><code><span>function</span> <span>Router</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>page</span><span>,</span> <span>setPage</span><span>]</span> = <span>useState</span><span>(</span><span>'/'</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>

  <span>function</span> <span>navigate</span><span>(</span><span>url</span><span>)</span> <span>{</span>
    <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setPage</span><span>(</span><span>url</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>
  <span>// ...</span></code></pre> <p>This is recommended for two reasons:</p> <ul> <li>
<a href="#marking-a-state-update-as-a-non-blocking-transition">Transitions are interruptible,</a> which lets the user click away without waiting for the re-render to complete.</li> <li>
<a href="#preventing-unwanted-loading-indicators">Transitions prevent unwanted loading indicators,</a> which lets the user avoid jarring jumps on navigation.</li> </ul> <p>Here is a tiny simplified router example using Transitions for navigations.</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>Suspense</span><span>,</span> <span>useState</span><span>,</span> <span>useTransition</span> <span>}</span> <span>from</span> <span>'react'</span><span>;</span>
<span>import</span> <span>IndexPage</span> <span>from</span> <span>'./IndexPage.js'</span><span>;</span>
<span>import</span> <span>ArtistPage</span> <span>from</span> <span>'./ArtistPage.js'</span><span>;</span>
<span>import</span> <span>Layout</span> <span>from</span> <span>'./Layout.js'</span><span>;</span>

<span>export</span> <span>default</span> <span>function</span> <span>App</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>Suspense</span> <span>fallback</span>=<span>{</span><span>&lt;</span><span>BigSpinner</span> <span>/&gt;</span><span>}</span><span>&gt;</span>
      <span>&lt;</span><span>Router</span> <span>/&gt;</span>
    <span>&lt;/</span><span>Suspense</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>Router</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>page</span><span>,</span> <span>setPage</span><span>]</span> = <span>useState</span><span>(</span><span>'/'</span><span>)</span><span>;</span>
  <span>const</span> <span>[</span><span>isPending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>

  <span>function</span> <span>navigate</span><span>(</span><span>url</span><span>)</span> <span>{</span>
    <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
      <span>setPage</span><span>(</span><span>url</span><span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
  <span>}</span>

  <span>let</span> <span>content</span><span>;</span>
  <span>if</span> <span>(</span><span>page</span> === <span>'/'</span><span>)</span> <span>{</span>
    <span>content</span> = <span>(</span>
      <span>&lt;</span><span>IndexPage</span> <span>navigate</span>=<span>{</span><span>navigate</span><span>}</span> <span>/&gt;</span>
    <span>)</span><span>;</span>
  <span>}</span> <span>else</span> <span>if</span> <span>(</span><span>page</span> === <span>'/the-beatles'</span><span>)</span> <span>{</span>
    <span>content</span> = <span>(</span>
      <span>&lt;</span><span>ArtistPage</span>
        <span>artist</span>=<span>{</span><span>{</span>
          <span>id</span><span>:</span> <span>'the-beatles'</span><span>,</span>
          <span>name</span><span>:</span> <span>'The Beatles'</span><span>,</span>
        <span>}</span><span>}</span>
      <span>/&gt;</span>
    <span>)</span><span>;</span>
  <span>}</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>Layout</span> <span>isPending</span>=<span>{</span><span>isPending</span><span>}</span><span>&gt;</span>
      <span>{</span><span>content</span><span>}</span>
    <span>&lt;/</span><span>Layout</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>BigSpinner</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>&lt;</span><span>h2</span><span>&gt;</span>üåÄ Loading...<span>&lt;/</span><span>h2</span><span>&gt;</span><span>;</span>
<span>}</span>

</pre> <div class="note note-green">
<h4>Note</h4>
<div><p><a href="suspense">Suspense-enabled</a> routers are expected to wrap the navigation updates into Transitions by default.</p></div>
</div> <hr> <h3 id="displaying-an-error-to-users-with-error-boundary">Displaying an error to users with an error boundary 
</h3> <div class="note">
<h4>Canary</h4>
<div><p>Error Boundary for useTransition is currently only available in React‚Äôs canary and experimental channels. Learn more about <a href="https://18.react.dev/community/versioning-policy#all-release-channels">React‚Äôs release channels here</a>.</p></div>
</div> <p>If a function passed to <code dir="ltr">startTransition</code> throws an error, you can display an error to your user with an <a href="component#catching-rendering-errors-with-an-error-boundary">error boundary</a>. To use an error boundary, wrap the component where you are calling the <code dir="ltr">useTransition</code> in an error boundary. Once the function passed to <code dir="ltr">startTransition</code> errors, the fallback for the error boundary will be displayed.</p> 
<pre data-language="jsx"><span>import</span> <span>{</span> <span>useTransition</span> <span>}</span> <span>from</span> <span>"react"</span><span>;</span>
<span>import</span> <span>{</span> <span>ErrorBoundary</span> <span>}</span> <span>from</span> <span>"react-error-boundary"</span><span>;</span>

<span>export</span> <span>function</span> <span>AddCommentContainer</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>ErrorBoundary</span> <span>fallback</span>=<span>{</span><span>&lt;</span><span>p</span><span>&gt;</span>‚ö†Ô∏èSomething went wrong<span>&lt;/</span><span>p</span><span>&gt;</span><span>}</span><span>&gt;</span>
      <span>&lt;</span><span>AddCommentButton</span> <span>/&gt;</span>
    <span>&lt;/</span><span>ErrorBoundary</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>addComment</span><span>(</span><span>comment</span><span>)</span> <span>{</span>
  <span>// For demonstration purposes to show Error Boundary</span>
  <span>if</span> <span>(</span><span>comment</span> == <span>null</span><span>)</span> <span>{</span>
    <span>throw</span> <span>new</span> <span>Error</span><span>(</span><span>"Example Error: An error thrown to trigger error boundary"</span><span>)</span><span>;</span>
  <span>}</span>
<span>}</span>

<span>function</span> <span>AddCommentButton</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span><span>pending</span><span>,</span> <span>startTransition</span><span>]</span> = <span>useTransition</span><span>(</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>button</span>
      <span>disabled</span>=<span>{</span><span>pending</span><span>}</span>
      <span>onClick</span>=<span>{</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
        <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
          <span>// Intentionally not passing a comment</span>
          <span>// so error gets thrown</span>
          <span>addComment</span><span>(</span><span>)</span><span>;</span>
        <span>}</span><span>)</span><span>;</span>
      <span>}</span><span>}</span>
    <span>&gt;</span>
      Add comment
    <span>&lt;/</span><span>button</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

</pre> <hr> <h2 id="troubleshooting">Troubleshooting 
</h2> <h3 id="updating-an-input-in-a-transition-doesnt-work">Updating an input in a Transition doesn‚Äôt work 
</h3> <p>You can‚Äôt use a Transition for a state variable that controls an input:</p> <pre data-language="jsx"><code><span>const</span> <span>[</span><span>text</span><span>,</span> <span>setText</span><span>]</span> = <span>useState</span><span>(</span><span>''</span><span>)</span><span>;</span>
<span>// ...</span>
<span>function</span> <span>handleChange</span><span>(</span><span>e</span><span>)</span> <span>{</span>
  <span>// ‚ùå Can't use Transitions for controlled input state</span>
  <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setText</span><span>(</span><span>e</span>.<span>target</span>.<span>value</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>
<span>}</span>
<span>// ...</span>
<span>return</span> <span>&lt;</span><span>input</span> <span>value</span>=<span>{</span><span>text</span><span>}</span> <span>onChange</span>=<span>{</span><span>handleChange</span><span>}</span> <span>/&gt;</span><span>;</span></code></pre> <p>This is because Transitions are non-blocking, but updating an input in response to the change event should happen synchronously. If you want to run a Transition in response to typing, you have two options:</p> <ol> <li>You can declare two separate state variables: one for the input state (which always updates synchronously), and one that you will update in a Transition. This lets you control the input using the synchronous state, and pass the Transition state variable (which will ‚Äúlag behind‚Äù the input) to the rest of your rendering logic.</li> <li>Alternatively, you can have one state variable, and add <a href="usedeferredvalue"><code dir="ltr">useDeferredValue</code></a> which will ‚Äúlag behind‚Äù the real value. It will trigger non-blocking re-renders to ‚Äúcatch up‚Äù with the new value automatically.</li> </ol> <hr> <h3 id="react-doesnt-treat-my-state-update-as-a-transition">React doesn‚Äôt treat my state update as a Transition 
</h3> <p>When you wrap a state update in a Transition, make sure that it happens <em>during</em> the <code dir="ltr">startTransition</code> call:</p> <pre data-language="jsx"><code><span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>// ‚úÖ Setting state *during* startTransition call</span>
  <span>setPage</span><span>(</span><span>'/about'</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>The function you pass to <code dir="ltr">startTransition</code> must be synchronous.</p> <p>You can‚Äôt mark an update as a Transition like this:</p> <pre data-language="jsx"><code><span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>// ‚ùå Setting state *after* startTransition call</span>
  <span>setTimeout</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>setPage</span><span>(</span><span>'/about'</span><span>)</span><span>;</span>
  <span>}</span><span>,</span> <span>1000</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>Instead, you could do this:</p> <pre data-language="jsx"><code><span>setTimeout</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>// ‚úÖ Setting state *during* startTransition call</span>
    <span>setPage</span><span>(</span><span>'/about'</span><span>)</span><span>;</span>
  <span>}</span><span>)</span><span>;</span>
<span>}</span><span>,</span> <span>1000</span><span>)</span><span>;</span></code></pre> <p>Similarly, you can‚Äôt mark an update as a Transition like this:</p> <pre data-language="jsx"><code><span>startTransition</span><span>(</span><span>async</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>await</span> <span>someAsyncFunction</span><span>(</span><span>)</span><span>;</span>
  <span>// ‚ùå Setting state *after* startTransition call</span>
  <span>setPage</span><span>(</span><span>'/about'</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span></code></pre> <p>However, this works instead:</p> <pre data-language="jsx"><code><span>await</span> <span>someAsyncFunction</span><span>(</span><span>)</span><span>;</span>
<span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>// ‚úÖ Setting state *during* startTransition call</span>
  <span>setPage</span><span>(</span><span>'/about'</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span></code></pre> <hr> <h3 id="i-want-to-call-usetransition-from-outside-a-component">I want to call <code dir="ltr">useTransition</code> from outside a component 
</h3> <p>You can‚Äôt call <code dir="ltr">useTransition</code> outside a component because it‚Äôs a Hook. In this case, use the standalone <a href="starttransition"><code dir="ltr">startTransition</code></a> method instead. It works the same way, but it doesn‚Äôt provide the <code dir="ltr">isPending</code> indicator.</p> <hr> <h3 id="the-function-i-pass-to-starttransition-executes-immediately">The function I pass to <code dir="ltr">startTransition</code> executes immediately 
</h3> <p>If you run this code, it will print 1, 2, 3:</p> <pre data-language="jsx"><code><span>console</span>.<span>log</span><span>(</span><span>1</span><span>)</span><span>;</span>
<span>startTransition</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>console</span>.<span>log</span><span>(</span><span>2</span><span>)</span><span>;</span>
  <span>setPage</span><span>(</span><span>'/about'</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span>
<span>console</span>.<span>log</span><span>(</span><span>3</span><span>)</span><span>;</span></code></pre> <p><strong>It is expected to print 1, 2, 3.</strong> The function you pass to <code dir="ltr">startTransition</code> does not get delayed. Unlike with the browser <code dir="ltr">setTimeout</code>, it does not run the callback later. React executes your function immediately, but any state updates scheduled <em>while it is running</em> are marked as Transitions. You can imagine that it works like this:</p> <pre data-language="jsx"><code><span>// A simplified version of how React works</span>

<span>let</span> <span>isInsideTransition</span> = <span>false</span><span>;</span>

<span>function</span> <span>startTransition</span><span>(</span><span>scope</span><span>)</span> <span>{</span>
  <span>isInsideTransition</span> = <span>true</span><span>;</span>
  <span>scope</span><span>(</span><span>)</span><span>;</span>
  <span>isInsideTransition</span> = <span>false</span><span>;</span>
<span>}</span>

<span>function</span> <span>setState</span><span>(</span><span>)</span> <span>{</span>
  <span>if</span> <span>(</span><span>isInsideTransition</span><span>)</span> <span>{</span>
    <span>// ... schedule a Transition state update ...</span>
  <span>}</span> <span>else</span> <span>{</span>
    <span>// ... schedule an urgent state update ...</span>
  <span>}</span>
<span>}</span></code></pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2013&ndash;present Facebook Inc.<br>Licensed under the Creative Commons Attribution 4.0 International Public License.<br>
    <a href="https://18.react.dev/reference/react/useTransition" class="_attribution-link">https://18.react.dev/reference/react/useTransition</a>
  </p>
</div>
