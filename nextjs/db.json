{"index":"<h1>NextJS2</h1>\n<h1 class=\"break-words\">Introduction</h1>\n<p>Welcome to the Next.js documentation!</p> <h2 id=\"what-is-nextjs\" data-docs-heading=\"\">What is Next.js?     </h2> <p>Next.js is a React framework for building full-stack web applications. You use React Components to build user interfaces, and Next.js for additional features and optimizations.</p> <p>Under the hood, Next.js also abstracts and automatically configures tooling needed for React, like bundling, compiling, and more. This allows you to focus on building your application instead of spending time with configuration.</p> <p>Whether you're an individual developer or part of a larger team, Next.js can help you build interactive, dynamic, and fast React applications.</p> <h2 id=\"main-features\" data-docs-heading=\"\">Main Features     </h2> <p>Some of the main Next.js features include:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Feature</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"app/building-your-application/routing\">Routing</a></td>\n<td>A file-system based router built on top of Server Components that supports layouts, nested routing, loading states, error handling, and more.</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/rendering\">Rendering</a></td>\n<td>Client-side and Server-side Rendering with Client and Server Components. Further optimized with Static and Dynamic Rendering on the server with Next.js. Streaming on Edge and Node.js runtimes.</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/data-fetching\">Data Fetching</a></td>\n<td>Simplified data fetching with async/await in Server Components, and an extended <code>fetch</code> API for request memoization, data caching and revalidation.</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/styling\">Styling</a></td>\n<td>Support for your preferred styling methods, including CSS Modules, Tailwind CSS, and CSS-in-JS</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/optimizing\">Optimizations</a></td>\n<td>Image, Fonts, and Script Optimizations to improve your application's Core Web Vitals and User Experience.</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/configuring/typescript\">TypeScript</a></td>\n<td>Improved support for TypeScript, with better type checking and more efficient compilation, as well as custom TypeScript Plugin and type checker.</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"how-to-use-these-docs\" data-docs-heading=\"\">How to Use These Docs     </h2> <p>On the left side of the screen, you'll find the docs navbar. The pages of the docs are organized sequentially, from basic to advanced, so you can follow them step-by-step when building your application. However, you can read them in any order or skip to the pages that apply to your use case.</p> <p>On the right side of the screen, you'll see a table of contents that makes it easier to navigate between sections of a page. If you need to quickly find a page, you can use the search bar at the top, or the search shortcut (<code>Ctrl+K</code> or <code>Cmd+K</code>).</p> <p>To get started, checkout the <a href=\"getting-started/installation\">Installation</a> guide.</p> <h2 id=\"app-router-vs-pages-router\" data-docs-heading=\"\">App Router vs Pages Router     </h2> <p>Next.js has two different routers: the App Router and the Pages Router. The App Router is a newer router that allows you to use React's latest features, such as Server Components and Streaming. The Pages Router is the original Next.js router, which allowed you to build server-rendered React applications and continues to be supported for older Next.js applications.</p> <p>At the top of the sidebar, you'll notice a dropdown menu that allows you to switch between the <strong>App Router</strong> and the <strong>Pages Router</strong> features. Since there are features that are unique to each directory, it's important to keep track of which tab is selected.</p> <p>The breadcrumbs at the top of the page will also indicate whether you're viewing App Router docs or Pages Router docs.</p> <h2 id=\"pre-requisite-knowledge\" data-docs-heading=\"\">Pre-Requisite Knowledge     </h2> <p>Although our docs are designed to be beginner-friendly, we need to establish a baseline so that the docs can stay focused on Next.js functionality. We'll make sure to provide links to relevant documentation whenever we introduce a new concept.</p> <p>To get the most out of our docs, it's recommended that you have a basic understanding of HTML, CSS, and React. If you need to brush up on your React skills, check out our <a href=\"https://nextjs.org/learn/react-foundations\">React Foundations Course</a>, which will introduce you to the fundamentals. Then, learn more about Next.js by <a href=\"https://nextjs.org/learn/dashboard-app\">building a dashboard application</a>.</p> <h2 id=\"accessibility\" data-docs-heading=\"\">Accessibility     </h2> <p>For optimal accessibility when using a screen reader while reading the docs, we recommend using Firefox and NVDA, or Safari and VoiceOver.</p> <h2 id=\"join-our-community\" data-docs-heading=\"\">Join our Community     </h2> <p>If you have questions about anything related to Next.js, you're always welcome to ask our community on <a href=\"https://github.com/vercel/next.js/discussions\" rel=\"noopener noreferrer\" target=\"_blank\">GitHub Discussions</a>, <a href=\"https://discord.com/invite/bUG2bvbtHy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Discord</a>, <a href=\"https://twitter.com/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Twitter</a>, and <a href=\"https://www.reddit.com/r/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Reddit</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs\" class=\"_attribution-link\">https://nextjs.org/docs</a>\n  </p>\n</div>\n","getting-started":"<h1 class=\"break-words\">Introduction</h1>\n<p>Welcome to the Next.js documentation!</p> <h2 id=\"what-is-nextjs\" data-docs-heading=\"\">What is Next.js?     </h2> <p>Next.js is a React framework for building full-stack web applications. You use React Components to build user interfaces, and Next.js for additional features and optimizations.</p> <p>Under the hood, Next.js also abstracts and automatically configures tooling needed for React, like bundling, compiling, and more. This allows you to focus on building your application instead of spending time with configuration.</p> <p>Whether you're an individual developer or part of a larger team, Next.js can help you build interactive, dynamic, and fast React applications.</p> <h2 id=\"main-features\" data-docs-heading=\"\">Main Features     </h2> <p>Some of the main Next.js features include:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Feature</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"app/building-your-application/routing\">Routing</a></td>\n<td>A file-system based router built on top of Server Components that supports layouts, nested routing, loading states, error handling, and more.</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/rendering\">Rendering</a></td>\n<td>Client-side and Server-side Rendering with Client and Server Components. Further optimized with Static and Dynamic Rendering on the server with Next.js. Streaming on Edge and Node.js runtimes.</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/data-fetching\">Data Fetching</a></td>\n<td>Simplified data fetching with async/await in Server Components, and an extended <code>fetch</code> API for request memoization, data caching and revalidation.</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/styling\">Styling</a></td>\n<td>Support for your preferred styling methods, including CSS Modules, Tailwind CSS, and CSS-in-JS</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/optimizing\">Optimizations</a></td>\n<td>Image, Fonts, and Script Optimizations to improve your application's Core Web Vitals and User Experience.</td>\n</tr>\n<tr>\n<td><a href=\"app/building-your-application/configuring/typescript\">TypeScript</a></td>\n<td>Improved support for TypeScript, with better type checking and more efficient compilation, as well as custom TypeScript Plugin and type checker.</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"how-to-use-these-docs\" data-docs-heading=\"\">How to Use These Docs     </h2> <p>On the left side of the screen, you'll find the docs navbar. The pages of the docs are organized sequentially, from basic to advanced, so you can follow them step-by-step when building your application. However, you can read them in any order or skip to the pages that apply to your use case.</p> <p>On the right side of the screen, you'll see a table of contents that makes it easier to navigate between sections of a page. If you need to quickly find a page, you can use the search bar at the top, or the search shortcut (<code>Ctrl+K</code> or <code>Cmd+K</code>).</p> <p>To get started, checkout the <a href=\"getting-started/installation\">Installation</a> guide.</p> <h2 id=\"app-router-vs-pages-router\" data-docs-heading=\"\">App Router vs Pages Router     </h2> <p>Next.js has two different routers: the App Router and the Pages Router. The App Router is a newer router that allows you to use React's latest features, such as Server Components and Streaming. The Pages Router is the original Next.js router, which allowed you to build server-rendered React applications and continues to be supported for older Next.js applications.</p> <p>At the top of the sidebar, you'll notice a dropdown menu that allows you to switch between the <strong>App Router</strong> and the <strong>Pages Router</strong> features. Since there are features that are unique to each directory, it's important to keep track of which tab is selected.</p> <p>The breadcrumbs at the top of the page will also indicate whether you're viewing App Router docs or Pages Router docs.</p> <h2 id=\"pre-requisite-knowledge\" data-docs-heading=\"\">Pre-Requisite Knowledge     </h2> <p>Although our docs are designed to be beginner-friendly, we need to establish a baseline so that the docs can stay focused on Next.js functionality. We'll make sure to provide links to relevant documentation whenever we introduce a new concept.</p> <p>To get the most out of our docs, it's recommended that you have a basic understanding of HTML, CSS, and React. If you need to brush up on your React skills, check out our <a href=\"https://nextjs.org/learn/react-foundations\">React Foundations Course</a>, which will introduce you to the fundamentals. Then, learn more about Next.js by <a href=\"https://nextjs.org/learn/dashboard-app\">building a dashboard application</a>.</p> <h2 id=\"accessibility\" data-docs-heading=\"\">Accessibility     </h2> <p>For optimal accessibility when using a screen reader while reading the docs, we recommend using Firefox and NVDA, or Safari and VoiceOver.</p> <h2 id=\"join-our-community\" data-docs-heading=\"\">Join our Community     </h2> <p>If you have questions about anything related to Next.js, you're always welcome to ask our community on <a href=\"https://github.com/vercel/next.js/discussions\" rel=\"noopener noreferrer\" target=\"_blank\">GitHub Discussions</a>, <a href=\"https://discord.com/invite/bUG2bvbtHy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Discord</a>, <a href=\"https://twitter.com/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Twitter</a>, and <a href=\"https://www.reddit.com/r/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Reddit</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/getting-started\" class=\"_attribution-link\">https://nextjs.org/docs/getting-started</a>\n  </p>\n</div>\n","app/building-your-application/data-fetching":"<h1 class=\"break-words\">Data Fetching</h1><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/data-fetching</a>\n  </p>\n</div>\n","getting-started/project-structure":"<h1 class=\"break-words\">Next.js Project Structure</h1>\n<p>This page provides an overview of the project structure of a Next.js application. It covers top-level files and folders, configuration files, and routing conventions within the <code>app</code> and <code>pages</code> directories.</p> <p>Click the file and folder names to learn more about each convention.</p> <h2 id=\"top-level-folders\" data-docs-heading=\"\">Top-level folders     </h2> <p>Top-level folders are used to organize your application's code and static assets.</p> <figure><img alt=\"Route segments to path segments\" loading=\"lazy\" width=\"1600\" height=\"525\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ftop-level-folders.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ftop-level-folders.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ftop-level-folders.png&amp;w=3840&amp;q=75\"><img alt=\"Route segments to path segments\" loading=\"lazy\" width=\"1600\" height=\"525\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ftop-level-folders.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ftop-level-folders.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ftop-level-folders.png&amp;w=3840&amp;q=75\"></figure> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/building-your-application/routing\"><code>app</code></a></td>\n<td>App Router</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing\"><code>pages</code></a></td>\n<td>Pages Router</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/optimizing/static-assets\"><code>public</code></a></td>\n<td>Static assets to be served</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/configuring/src-directory\"><code>src</code></a></td>\n<td>Optional application source folder</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"top-level-files\" data-docs-heading=\"\">Top-level files     </h2> <p>Top-level files are used to configure your application, manage dependencies, run middleware, integrate monitoring tools, and define environment variables.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><strong>Next.js</strong></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/next-config-js\"><code>next.config.js</code></a></td>\n<td>Configuration file for Next.js</td>\n</tr>\n<tr>\n<td><a href=\"installation#manual-installation\"><code>package.json</code></a></td>\n<td>Project dependencies and scripts</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/optimizing/instrumentation\"><code>instrumentation.ts</code></a></td>\n<td>OpenTelemetry and Instrumentation file</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing/middleware\"><code>middleware.ts</code></a></td>\n<td>Next.js request middleware</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/configuring/environment-variables\"><code>.env</code></a></td>\n<td>Environment variables</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/configuring/environment-variables\"><code>.env.local</code></a></td>\n<td>Local environment variables</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/configuring/environment-variables\"><code>.env.production</code></a></td>\n<td>Production environment variables</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/configuring/environment-variables\"><code>.env.development</code></a></td>\n<td>Development environment variables</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/configuring/eslint\"><code>.eslintrc.json</code></a></td>\n<td>Configuration file for ESLint</td>\n</tr>\n<tr>\n<td><code>.gitignore</code></td>\n<td>Git files and folders to ignore</td>\n</tr>\n<tr>\n<td><code>next-env.d.ts</code></td>\n<td>TypeScript declaration file for Next.js</td>\n</tr>\n<tr>\n<td><code>tsconfig.json</code></td>\n<td>Configuration file for TypeScript</td>\n</tr>\n<tr>\n<td><code>jsconfig.json</code></td>\n<td>Configuration file for JavaScript</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"app-routing-conventions\" data-docs-heading=\"\">app Routing Conventions     </h2> <p>The following file conventions are used to define routes and handle metadata in the <a href=\"../app\"><code>app</code> router</a>.</p> <h3 id=\"routing-files\" data-docs-heading=\"\">Routing Files     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/layout\"><code>layout</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Layout</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/page\"><code>page</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Page</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/loading\"><code>loading</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Loading UI</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/not-found\"><code>not-found</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Not found UI</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/error\"><code>error</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Error UI</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/error#global-errorjs\"><code>global-error</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Global error UI</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/route\"><code>route</code></a></td>\n<td>\n<code>.js</code> <code>.ts</code>\n</td>\n<td>API endpoint</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/template\"><code>template</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Re-rendered layout</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/default\"><code>default</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Parallel route fallback page</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"nested-routes\" data-docs-heading=\"\">Nested Routes     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/building-your-application/routing#route-segments\"><code>folder</code></a></td>\n<td>Route segment</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing#nested-routes\"><code>folder/folder</code></a></td>\n<td>Nested route segment</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"dynamic-routes\" data-docs-heading=\"\">Dynamic Routes     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/building-your-application/routing/dynamic-routes#convention\"><code>[folder]</code></a></td>\n<td>Dynamic route segment</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing/dynamic-routes#catch-all-segments\"><code>[...folder]</code></a></td>\n<td>Catch-all route segment</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing/dynamic-routes#optional-catch-all-segments\"><code>[[...folder]]</code></a></td>\n<td>Optional catch-all route segment</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"route-groups-and-private-folders\" data-docs-heading=\"\">Route Groups and Private Folders     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/building-your-application/routing/route-groups#convention\"><code>(folder)</code></a></td>\n<td>Group routes without affecting routing</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing/colocation#private-folders\"><code>_folder</code></a></td>\n<td>Opt folder and all child segments out of routing</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"parallel-and-intercepted-routes\" data-docs-heading=\"\">Parallel and Intercepted Routes     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/building-your-application/routing/parallel-routes#slots\"><code>@folder</code></a></td>\n<td>Named slot</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing/intercepting-routes#convention\"><code>(.)folder</code></a></td>\n<td>Intercept same level</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing/intercepting-routes#convention\"><code>(..)folder</code></a></td>\n<td>Intercept one level above</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing/intercepting-routes#convention\"><code>(..)(..)folder</code></a></td>\n<td>Intercept two levels above</td>\n</tr>\n<tr>\n<td><a href=\"../app/building-your-application/routing/intercepting-routes#convention\"><code>(...)folder</code></a></td>\n<td>Intercept from root</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"metadata-file-conventions\" data-docs-heading=\"\">Metadata File Conventions     </h3> <h4 id=\"app-icons\" data-docs-heading=\"\">App Icons     </h4> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/app-icons#favicon\"><code>favicon</code></a></td>\n<td><code>.ico</code></td>\n<td>Favicon file</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/app-icons#icon\"><code>icon</code></a></td>\n<td>\n<code>.ico</code> <code>.jpg</code> <code>.jpeg</code> <code>.png</code> <code>.svg</code>\n</td>\n<td>App Icon file</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx\"><code>icon</code></a></td>\n<td>\n<code>.js</code> <code>.ts</code> <code>.tsx</code>\n</td>\n<td>Generated App Icon</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/app-icons#apple-icon\"><code>apple-icon</code></a></td>\n<td>\n<code>.jpg</code> <code>.jpeg</code>, <code>.png</code>\n</td>\n<td>Apple App Icon file</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx\"><code>apple-icon</code></a></td>\n<td>\n<code>.js</code> <code>.ts</code> <code>.tsx</code>\n</td>\n<td>Generated Apple App Icon</td>\n</tr>\n</tbody>\n</table></div> <h4 id=\"open-graph-and-twitter-images\" data-docs-heading=\"\">Open Graph and Twitter Images     </h4> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/opengraph-image#opengraph-image\"><code>opengraph-image</code></a></td>\n<td>\n<code>.jpg</code> <code>.jpeg</code> <code>.png</code> <code>.gif</code>\n</td>\n<td>Open Graph image file</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/opengraph-image#generate-images-using-code-js-ts-tsx\"><code>opengraph-image</code></a></td>\n<td>\n<code>.js</code> <code>.ts</code> <code>.tsx</code>\n</td>\n<td>Generated Open Graph image</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/opengraph-image#twitter-image\"><code>twitter-image</code></a></td>\n<td>\n<code>.jpg</code> <code>.jpeg</code> <code>.png</code> <code>.gif</code>\n</td>\n<td>Twitter image file</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/opengraph-image#generate-images-using-code-js-ts-tsx\"><code>twitter-image</code></a></td>\n<td>\n<code>.js</code> <code>.ts</code> <code>.tsx</code>\n</td>\n<td>Generated Twitter image</td>\n</tr>\n</tbody>\n</table></div> <h4 id=\"seo\" data-docs-heading=\"\">SEO     </h4> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/sitemap#sitemap-files-xml\"><code>sitemap</code></a></td>\n<td><code>.xml</code></td>\n<td>Sitemap file</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/sitemap#generating-a-sitemap-using-code-js-ts\"><code>sitemap</code></a></td>\n<td>\n<code>.js</code> <code>.ts</code>\n</td>\n<td>Generated Sitemap</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/robots#static-robotstxt\"><code>robots</code></a></td>\n<td><code>.txt</code></td>\n<td>Robots file</td>\n</tr>\n<tr>\n<td><a href=\"../app/api-reference/file-conventions/metadata/robots#generate-a-robots-file\"><code>robots</code></a></td>\n<td>\n<code>.js</code> <code>.ts</code>\n</td>\n<td>Generated Robots file</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"pages-routing-conventions\" data-docs-heading=\"\">pages Routing Conventions     </h2> <p>The following file conventions are used to define routes in the <a href=\"../pages\"><code>pages</code> router</a>.</p> <h3 id=\"special-files\" data-docs-heading=\"\">Special Files     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/custom-app\"><code>_app</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Custom App</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/custom-document\"><code>_document</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Custom Document</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/custom-error#more-advanced-error-page-customizing\"><code>_error</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Custom Error Page</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/custom-error#404-page\"><code>404</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>404 Error Page</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/custom-error#500-page\"><code>500</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>500 Error Page</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"routes\" data-docs-heading=\"\">Routes     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><strong>Folder convention</strong></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/pages-and-layouts#index-routes\"><code>index</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Home page</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/pages-and-layouts#index-routes\"><code>folder/index</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Nested page</td>\n</tr>\n<tr>\n<td><strong>File convention</strong></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/pages-and-layouts#index-routes\"><code>index</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Home page</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/pages-and-layouts\"><code>file</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Nested page</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"dynamic-routes-1\" data-docs-heading=\"\">Dynamic Routes     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><strong>Folder convention</strong></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/dynamic-routes\"><code>[folder]/index</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Dynamic route segment</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/dynamic-routes#catch-all-segments\"><code>[...folder]/index</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Catch-all route segment</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/dynamic-routes#optional-catch-all-segments\"><code>[[...folder]]/index</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Optional catch-all route segment</td>\n</tr>\n<tr>\n<td><strong>File convention</strong></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/dynamic-routes\"><code>[file]</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Dynamic route segment</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/dynamic-routes#catch-all-segments\"><code>[...file]</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Catch-all route segment</td>\n</tr>\n<tr>\n<td><a href=\"../pages/building-your-application/routing/dynamic-routes#optional-catch-all-segments\"><code>[[...file]]</code></a></td>\n<td>\n<code>.js</code> <code>.jsx</code> <code>.tsx</code>\n</td>\n<td>Optional catch-all route segment</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/getting-started/project-structure\" class=\"_attribution-link\">https://nextjs.org/docs/getting-started/project-structure</a>\n  </p>\n</div>\n","app/building-your-application/routing":"<h1 class=\"break-words\">Routing Fundamentals</h1>\n<p>The skeleton of every application is routing. This page will introduce you to the <strong>fundamental concepts</strong> of routing for the web and how to handle routing in Next.js.</p> <h2 id=\"terminology\" data-docs-heading=\"\">Terminology     </h2> <p>First, you will see these terms being used throughout the documentation. Here's a quick reference:</p> <figure><img alt=\"Terminology for Component Tree\" loading=\"lazy\" width=\"1600\" height=\"832\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fterminology-component-tree.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fterminology-component-tree.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fterminology-component-tree.png&amp;w=3840&amp;q=75\"><img alt=\"Terminology for Component Tree\" loading=\"lazy\" width=\"1600\" height=\"832\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fterminology-component-tree.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fterminology-component-tree.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fterminology-component-tree.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>\n<strong>Tree:</strong> A convention for visualizing a hierarchical structure. For example, a component tree with parent and children components, a folder structure, etc.</li> <li>\n<strong>Subtree:</strong> Part of a tree, starting at a new root (first) and ending at the leaves (last).</li> <li>\n<strong>Root</strong>: The first node in a tree or subtree, such as a root layout.</li> <li>\n<strong>Leaf:</strong> Nodes in a subtree that have no children, such as the last segment in a URL path.</li> </ul> <figure><img alt=\"Terminology for URL Anatomy\" loading=\"lazy\" width=\"1600\" height=\"371\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fterminology-url-anatomy.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fterminology-url-anatomy.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fterminology-url-anatomy.png&amp;w=3840&amp;q=75\"><img alt=\"Terminology for URL Anatomy\" loading=\"lazy\" width=\"1600\" height=\"371\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fterminology-url-anatomy.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fterminology-url-anatomy.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fterminology-url-anatomy.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>\n<strong>URL Segment:</strong> Part of the URL path delimited by slashes.</li> <li>\n<strong>URL Path:</strong> Part of the URL that comes after the domain (composed of segments).</li> </ul> <h2 id=\"the-app-router\" data-docs-heading=\"\">The app Router     </h2> <p>In version 13, Next.js introduced a new <strong>App Router</strong> built on <a href=\"rendering/server-components\">React Server Components</a>, which supports shared layouts, nested routing, loading states, error handling, and more.</p> <p>The App Router works in a new directory named <code>app</code>. The <code>app</code> directory works alongside the <code>pages</code> directory to allow for incremental adoption. This allows you to opt some routes of your application into the new behavior while keeping other routes in the <code>pages</code> directory for previous behavior. If your application uses the <code>pages</code> directory, please also see the <a href=\"../../pages/building-your-application/routing\">Pages Router</a> documentation.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The App Router takes priority over the Pages Router. Routes across directories should not resolve to the same URL path and will cause a build-time error to prevent a conflict.</p> </blockquote> <figure><img alt=\"Next.js App Directory\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fnext-router-directories.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fnext-router-directories.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fnext-router-directories.png&amp;w=3840&amp;q=75\"><img alt=\"Next.js App Directory\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fnext-router-directories.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fnext-router-directories.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fnext-router-directories.png&amp;w=3840&amp;q=75\"></figure> <p>By default, components inside <code>app</code> are <a href=\"rendering/server-components\">React Server Components</a>. This is a performance optimization and allows you to easily adopt them, and you can also use <a href=\"rendering/client-components\">Client Components</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation:</strong> Check out the <a href=\"rendering/server-components\">Server</a> page if you're new to Server Components.</p> </blockquote> <h2 id=\"roles-of-folders-and-files\" data-docs-heading=\"\">Roles of Folders and Files     </h2> <p>Next.js uses a file-system based router where:</p> <ul> <li>\n<strong>Folders</strong> are used to define routes. A route is a single path of nested folders, following the file-system hierarchy from the <strong>root folder</strong> down to a final <strong>leaf folder</strong> that includes a <code>page.js</code> file. See <a href=\"routing/defining-routes\">Defining Routes</a>.</li> <li>\n<strong>Files</strong> are used to create UI that is shown for a route segment. See <a href=\"#file-conventions\">special files</a>.</li> </ul> <h2 id=\"route-segments\" data-docs-heading=\"\">Route Segments     </h2> <p>Each folder in a route represents a <strong>route segment</strong>. Each route segment is mapped to a corresponding <strong>segment</strong> in a <strong>URL path</strong>.</p> <figure><img alt=\"How Route Segments Map to URL Segments\" loading=\"lazy\" width=\"1600\" height=\"594\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Froute-segments-to-path-segments.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Froute-segments-to-path-segments.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Froute-segments-to-path-segments.png&amp;w=3840&amp;q=75\"><img alt=\"How Route Segments Map to URL Segments\" loading=\"lazy\" width=\"1600\" height=\"594\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Froute-segments-to-path-segments.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Froute-segments-to-path-segments.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Froute-segments-to-path-segments.png&amp;w=3840&amp;q=75\"></figure> <h2 id=\"nested-routes\" data-docs-heading=\"\">Nested Routes     </h2> <p>To create a nested route, you can nest folders inside each other. For example, you can add a new <code>/dashboard/settings</code> route by nesting two new folders in the <code>app</code> directory.</p> <p>The <code>/dashboard/settings</code> route is composed of three segments:</p> <ul> <li>\n<code>/</code> (Root segment)</li> <li>\n<code>dashboard</code> (Segment)</li> <li>\n<code>settings</code> (Leaf segment)</li> </ul> <h2 id=\"file-conventions\" data-docs-heading=\"\">File Conventions     </h2> <p>Next.js provides a set of special files to create UI with specific behavior in nested routes:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"routing/pages-and-layouts#layouts\"><code>layout</code></a></td>\n<td>Shared UI for a segment and its children</td>\n</tr>\n<tr>\n<td><a href=\"routing/pages-and-layouts#pages\"><code>page</code></a></td>\n<td>Unique UI of a route and make routes publicly accessible</td>\n</tr>\n<tr>\n<td><a href=\"routing/loading-ui-and-streaming\"><code>loading</code></a></td>\n<td>Loading UI for a segment and its children</td>\n</tr>\n<tr>\n<td><a href=\"../api-reference/file-conventions/not-found\"><code>not-found</code></a></td>\n<td>Not found UI for a segment and its children</td>\n</tr>\n<tr>\n<td><a href=\"routing/error-handling\"><code>error</code></a></td>\n<td>Error UI for a segment and its children</td>\n</tr>\n<tr>\n<td><a href=\"routing/error-handling\"><code>global-error</code></a></td>\n<td>Global Error UI</td>\n</tr>\n<tr>\n<td><a href=\"routing/route-handlers\"><code>route</code></a></td>\n<td>Server-side API endpoint</td>\n</tr>\n<tr>\n<td><a href=\"routing/pages-and-layouts#templates\"><code>template</code></a></td>\n<td>Specialized re-rendered Layout UI</td>\n</tr>\n<tr>\n<td><a href=\"../api-reference/file-conventions/default\"><code>default</code></a></td>\n<td>Fallback UI for <a href=\"routing/parallel-routes\">Parallel Routes</a>\n</td>\n</tr>\n</tbody>\n</table></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> file extensions can be used for special files.</p> </blockquote> <h2 id=\"component-hierarchy\" data-docs-heading=\"\">Component Hierarchy     </h2> <p>The React components defined in special files of a route segment are rendered in a specific hierarchy:</p> <ul> <li><code>layout.js</code></li> <li><code>template.js</code></li> <li>\n<code>error.js</code> (React error boundary)</li> <li>\n<code>loading.js</code> (React suspense boundary)</li> <li>\n<code>not-found.js</code> (React error boundary)</li> <li>\n<code>page.js</code> or nested <code>layout.js</code>\n</li> </ul> <figure><img alt=\"Component Hierarchy for File Conventions\" loading=\"lazy\" width=\"1600\" height=\"643\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ffile-conventions-component-hierarchy.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ffile-conventions-component-hierarchy.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ffile-conventions-component-hierarchy.png&amp;w=3840&amp;q=75\"><img alt=\"Component Hierarchy for File Conventions\" loading=\"lazy\" width=\"1600\" height=\"643\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ffile-conventions-component-hierarchy.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ffile-conventions-component-hierarchy.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ffile-conventions-component-hierarchy.png&amp;w=3840&amp;q=75\"></figure> <p>In a nested route, the components of a segment will be nested <strong>inside</strong> the components of its parent segment.</p> <figure><img alt=\"Nested File Conventions Component Hierarchy\" loading=\"lazy\" width=\"1600\" height=\"863\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fnested-file-conventions-component-hierarchy.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fnested-file-conventions-component-hierarchy.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fnested-file-conventions-component-hierarchy.png&amp;w=3840&amp;q=75\"><img alt=\"Nested File Conventions Component Hierarchy\" loading=\"lazy\" width=\"1600\" height=\"863\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fnested-file-conventions-component-hierarchy.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fnested-file-conventions-component-hierarchy.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fnested-file-conventions-component-hierarchy.png&amp;w=3840&amp;q=75\"></figure> <h2 id=\"colocation\" data-docs-heading=\"\">Colocation     </h2> <p>In addition to special files, you have the option to colocate your own files (e.g. components, styles, tests, etc) inside folders in the <code>app</code> directory.</p> <p>This is because while folders define routes, only the contents returned by <code>page.js</code> or <code>route.js</code> are publicly addressable.</p> <figure><img alt=\"An example folder structure with colocated files\" loading=\"lazy\" width=\"1600\" height=\"1011\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-colocation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-colocation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-colocation.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure with colocated files\" loading=\"lazy\" width=\"1600\" height=\"1011\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-colocation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-colocation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-colocation.png&amp;w=3840&amp;q=75\"></figure> <p>Learn more about <a href=\"routing/colocation\">Project Organization and Colocation</a>.</p> <h2 id=\"advanced-routing-patterns\" data-docs-heading=\"\">Advanced Routing Patterns     </h2> <p>The App Router also provides a set of conventions to help you implement more advanced routing patterns. These include:</p> <ul> <li>\n<a href=\"routing/parallel-routes\">Parallel Routes</a>: Allow you to simultaneously show two or more pages in the same view that can be navigated independently. You can use them for split views that have their own sub-navigation. E.g. Dashboards.</li> <li>\n<a href=\"routing/intercepting-routes\">Intercepting Routes</a>: Allow you to intercept a route and show it in the context of another route. You can use these when keeping the context for the current page is important. E.g. Seeing all tasks while editing one task or expanding a photo in a feed.</li> </ul> <p>These patterns allow you to build richer and more complex UIs, democratizing features that were historically complex for small teams and individual developers to implement.</p> <h2 id=\"next-steps\" data-docs-heading=\"\">Next Steps     </h2> <p>Now that you understand the fundamentals of routing in Next.js, follow the links below to create your first routes:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing</a>\n  </p>\n</div>\n","app/building-your-application/routing/defining-routes":"<h1 class=\"break-words\">Defining Routes</h1>\n<blockquote class=\"p-3 text-sm\"> <p>We recommend reading the <a href=\"../routing\">Routing Fundamentals</a> page before continuing.</p> </blockquote> <p>This page will guide you through how to define and organize routes in your Next.js application.</p> <h2 id=\"creating-routes\" data-docs-heading=\"\">Creating Routes     </h2> <p>Next.js uses a file-system based router where <strong>folders</strong> are used to define routes.</p> <p>Each folder represents a <a href=\"../routing#route-segments\"><strong>route</strong> segment</a> that maps to a <strong>URL</strong> segment. To create a <a href=\"../routing#nested-routes\">nested route</a>, you can nest folders inside each other.</p> <figure><img alt=\"Route segments to path segments\" loading=\"lazy\" width=\"1600\" height=\"594\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Froute-segments-to-path-segments.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Froute-segments-to-path-segments.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Froute-segments-to-path-segments.png&amp;w=3840&amp;q=75\"><img alt=\"Route segments to path segments\" loading=\"lazy\" width=\"1600\" height=\"594\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Froute-segments-to-path-segments.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Froute-segments-to-path-segments.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Froute-segments-to-path-segments.png&amp;w=3840&amp;q=75\"></figure> <p>A special <a href=\"pages-and-layouts#pages\"><code>page.js</code> file</a> is used to make route segments publicly accessible.</p> <figure><img alt=\"Defining Routes\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fdefining-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fdefining-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fdefining-routes.png&amp;w=3840&amp;q=75\"><img alt=\"Defining Routes\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fdefining-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fdefining-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fdefining-routes.png&amp;w=3840&amp;q=75\"></figure> <p>In this example, the <code>/dashboard/analytics</code> URL path is <em>not</em> publicly accessible because it does not have a corresponding <code>page.js</code> file. This folder could be used to store components, stylesheets, images, or other colocated files.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> file extensions can be used for special files.</p> </blockquote> <h2 id=\"creating-ui\" data-docs-heading=\"\">Creating UI     </h2> <p><a href=\"../routing#file-conventions\">Special file conventions</a> are used to create UI for each route segment. The most common are <a href=\"pages-and-layouts#pages\">pages</a> to show UI unique to a route, and <a href=\"pages-and-layouts#layouts\">layouts</a> to show UI that is shared across multiple routes.</p> <p>For example, to create your first page, add a <code>page.js</code> file inside the <code>app</code> directory and export a React component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return &lt;h1&gt;Hello, Next.js!&lt;/h1&gt;\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/defining-routes\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/defining-routes</a>\n  </p>\n</div>\n","app/building-your-application/routing/pages-and-layouts":"<h1 class=\"break-words\">Pages and Layouts</h1>\n<blockquote class=\"p-3 text-sm\"> <p>We recommend reading the <a href=\"../routing\">Routing Fundamentals</a> and <a href=\"defining-routes\">Defining Routes</a> pages before continuing.</p> </blockquote> <p>The special files <a href=\"#layouts\">layout.js</a>, <a href=\"#pages\">page.js</a>, and <a href=\"#templates\">template.js</a> allow you to create UI for a <a href=\"defining-routes#creating-routes\">route</a>. This page will guide you through how and when to use these special files.</p> <h2 id=\"pages\" data-docs-heading=\"\">Pages     </h2> <p>A page is UI that is <strong>unique</strong> to a route. You can define a page by default exporting a component from a <code>page.js</code> file.</p> <p>For example, to create your <code>index</code> page, add the <code>page.js</code> file inside the <code>app</code> directory:</p> <figure><img alt=\"page.js special file\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fpage-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fpage-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fpage-special-file.png&amp;w=3840&amp;q=75\"><img alt=\"page.js special file\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fpage-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fpage-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fpage-special-file.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app/page.tsx` is the UI for the `/` URL\nexport default function Page() {\n  return &lt;h1&gt;Hello, Home page!&lt;/h1&gt;\n}</pre></div>  <p>Then, to create further pages, create a new folder and add the <code>page.js</code> file inside it. For example, to create a page for the <code>/dashboard</code> route, create a new folder called <code>dashboard</code>, and add the <code>page.js</code> file inside it:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app/dashboard/page.tsx` is the UI for the `/dashboard` URL\nexport default function Page() {\n  return &lt;h1&gt;Hello, Dashboard Page!&lt;/h1&gt;\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>The <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> file extensions can be used for Pages.</li> <li>A page is always the <a href=\"../routing#terminology\">leaf</a> of the <a href=\"../routing#terminology\">route subtree</a>.</li> <li>A <code>page.js</code> file is required to make a route segment publicly accessible.</li> <li>Pages are <a href=\"../rendering/server-components\">Server Components</a> by default, but can be set to a <a href=\"../rendering/client-components\">Client Component</a>.</li> <li>Pages can fetch data. View the <a href=\"../data-fetching\">Data Fetching</a> section for more information.</li> </ul> </blockquote> <h2 id=\"layouts\" data-docs-heading=\"\">Layouts     </h2> <p>A layout is UI that is <strong>shared</strong> between multiple routes. On navigation, layouts preserve state, remain interactive, and do not re-render. Layouts can also be <a href=\"#nesting-layouts\">nested</a>.</p> <p>You can define a layout by default exporting a React component from a <code>layout.js</code> file. The component should accept a <code>children</code> prop that will be populated with a child layout (if it exists) or a page during rendering.</p> <p>For example, the layout will be shared with the <code>/dashboard</code> and <code>/dashboard/settings</code> pages:</p> <figure><img alt=\"layout.js special file\" loading=\"lazy\" width=\"1600\" height=\"606\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Flayout-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Flayout-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Flayout-special-file.png&amp;w=3840&amp;q=75\"><img alt=\"layout.js special file\" loading=\"lazy\" width=\"1600\" height=\"606\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Flayout-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Flayout-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Flayout-special-file.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function DashboardLayout({\n  children, // will be a page or nested layout\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;section&gt;\n      {/* Include shared UI here e.g. a header or sidebar */}\n      &lt;nav&gt;&lt;/nav&gt;\n \n      {children}\n    &lt;/section&gt;\n  )\n}</pre></div>  <h3 id=\"root-layout-required\" data-docs-heading=\"\">Root Layout (Required)     </h3> <p>The root layout is defined at the top level of the <code>app</code> directory and applies to all routes. This layout is <strong>required</strong> and must contain <code>html</code> and <code>body</code> tags, allowing you to modify the initial HTML returned from the server.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;\n        {/* Layout UI */}\n        &lt;main&gt;{children}&lt;/main&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <h3 id=\"nesting-layouts\" data-docs-heading=\"\">Nesting Layouts     </h3> <p>By default, layouts in the folder hierarchy are <strong>nested</strong>, which means they wrap child layouts via their <code>children</code> prop. You can nest layouts by adding <code>layout.js</code> inside specific route segments (folders).</p> <p>For example, to create a layout for the <code>/dashboard</code> route, add a new <code>layout.js</code> file inside the <code>dashboard</code> folder:</p> <figure><img alt=\"Nested Layout\" loading=\"lazy\" width=\"1600\" height=\"606\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fnested-layout.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fnested-layout.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fnested-layout.png&amp;w=3840&amp;q=75\"><img alt=\"Nested Layout\" loading=\"lazy\" width=\"1600\" height=\"606\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fnested-layout.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fnested-layout.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fnested-layout.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return &lt;section&gt;{children}&lt;/section&gt;\n}</pre></div>  <p>If you were to combine the two layouts above, the root layout (<code>app/layout.js</code>) would wrap the dashboard layout (<code>app/dashboard/layout.js</code>), which would wrap route segments inside <code>app/dashboard/*</code>.</p> <p>The two layouts would be nested as such:</p> <figure><img alt=\"Nested Layouts\" loading=\"lazy\" width=\"1600\" height=\"1026\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fnested-layouts-ui.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fnested-layouts-ui.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fnested-layouts-ui.png&amp;w=3840&amp;q=75\"><img alt=\"Nested Layouts\" loading=\"lazy\" width=\"1600\" height=\"1026\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fnested-layouts-ui.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fnested-layouts-ui.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fnested-layouts-ui.png&amp;w=3840&amp;q=75\"></figure> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> file extensions can be used for Layouts.</li> <li>Only the root layout can contain <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags.</li> <li>When a <code>layout.js</code> and <code>page.js</code> file are defined in the same folder, the layout will wrap the page.</li> <li>Layouts are <a href=\"../rendering/server-components\">Server Components</a> by default but can be set to a <a href=\"../rendering/client-components\">Client Component</a>.</li> <li>Layouts can fetch data. View the <a href=\"../data-fetching\">Data Fetching</a> section for more information.</li> <li>Passing data between a parent layout and its children is not possible. However, you can fetch the same data in a route more than once, and React will <a href=\"../caching#request-memoization\">automatically dedupe the requests</a> without affecting performance.</li> <li>Layouts do not have access to the route segments below itself. To access all route segments, you can use <a href=\"../../api-reference/functions/use-selected-layout-segment\"><code>useSelectedLayoutSegment</code></a> or <a href=\"../../api-reference/functions/use-selected-layout-segments\"><code>useSelectedLayoutSegments</code></a> in a Client Component.</li> <li>You can use <a href=\"route-groups\">Route Groups</a> to opt specific route segments in and out of shared layouts.</li> <li>You can use <a href=\"route-groups\">Route Groups</a> to create multiple root layouts. See an <a href=\"route-groups#creating-multiple-root-layouts\">example here</a>.</li> <li>\n<strong>Migrating from the <code>pages</code> directory:</strong> The root layout replaces the <a href=\"../../../pages/building-your-application/routing/custom-app\"><code>_app.js</code></a> and <a href=\"../../../pages/building-your-application/routing/custom-document\"><code>_document.js</code></a> files. <a href=\"../upgrading/app-router-migration#migrating-_documentjs-and-_appjs\">View the migration guide</a>.</li> </ul> </blockquote> <h2 id=\"templates\" data-docs-heading=\"\">Templates     </h2> <p>Templates are similar to layouts in that they wrap each child layout or page. Unlike layouts that persist across routes and maintain state, templates create a new instance for each of their children on navigation. This means that when a user navigates between routes that share a template, a new instance of the component is mounted, DOM elements are recreated, state is <strong>not</strong> preserved, and effects are re-synchronized.</p> <p>There may be cases where you need those specific behaviors, and templates would be a more suitable option than layouts. For example:</p> <ul> <li>Features that rely on <code>useEffect</code> (e.g logging page views) and <code>useState</code> (e.g a per-page feedback form).</li> <li>To change the default framework behavior. For example, Suspense Boundaries inside layouts only show the fallback the first time the Layout is loaded and not when switching pages. For templates, the fallback is shown on each navigation.</li> </ul> <p>A template can be defined by exporting a default React component from a <code>template.js</code> file. The component should accept a <code>children</code> prop.</p> <figure><img alt=\"template.js special file\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ftemplate-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ftemplate-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ftemplate-special-file.png&amp;w=3840&amp;q=75\"><img alt=\"template.js special file\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ftemplate-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ftemplate-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ftemplate-special-file.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Template({ children }: { children: React.ReactNode }) {\n  return &lt;div&gt;{children}&lt;/div&gt;\n}</pre></div>  <p>In terms of nesting, <code>template.js</code> is rendered between a layout and its children. Here's a simplified output:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Layout&gt;\n  {/* Note that the template is given a unique key. */}\n  &lt;Template key={routeParam}&gt;{children}&lt;/Template&gt;\n&lt;/Layout&gt;</pre></div> <h2 id=\"metadata\" data-docs-heading=\"\">Metadata     </h2> <p>In the <code>app</code> directory, you can modify the <code>&lt;head&gt;</code> HTML elements such as <code>title</code> and <code>meta</code> using the <a href=\"../optimizing/metadata\">Metadata APIs</a>.</p> <p>Metadata can be defined by exporting a <a href=\"../../api-reference/functions/generate-metadata#the-metadata-object\"><code>metadata</code> object</a> or <a href=\"../../api-reference/functions/generate-metadata#generatemetadata-function\"><code>generateMetadata</code> function</a> in a <a href=\"../../api-reference/file-conventions/layout\"><code>layout.js</code></a> or <a href=\"../../api-reference/file-conventions/page\"><code>page.js</code></a> file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'Next.js',\n}\n \nexport default function Page() {\n  return '...'\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You should <strong>not</strong> manually add <code>&lt;head&gt;</code> tags such as <code>&lt;title&gt;</code> and <code>&lt;meta&gt;</code> to root layouts. Instead, you should use the <a href=\"../../api-reference/functions/generate-metadata\">Metadata API</a> which automatically handles advanced requirements such as streaming and de-duplicating <code>&lt;head&gt;</code> elements.</p> </blockquote> <p>Learn more about available metadata options in the <a href=\"../../api-reference/functions/generate-metadata\">API reference</a></p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/pages-and-layouts\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/pages-and-layouts</a>\n  </p>\n</div>\n","app/building-your-application/routing/intercepting-routes":"<h1 class=\"break-words\">Intercepting Routes</h1>\n<p>Intercepting routes allows you to load a route from another part of your application within the current layout. This routing paradigm can be useful when you want to display the content of a route without the user switching to a different context.</p> <p>For example, when clicking on a photo in a feed, you can display the photo in a modal, overlaying the feed. In this case, Next.js intercepts the <code>/photo/123</code> route, masks the URL, and overlays it over <code>/feed</code>.</p> <figure><img alt=\"Intercepting routes soft navigation\" loading=\"lazy\" width=\"1600\" height=\"617\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fintercepting-routes-soft-navigate.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fintercepting-routes-soft-navigate.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fintercepting-routes-soft-navigate.png&amp;w=3840&amp;q=75\"><img alt=\"Intercepting routes soft navigation\" loading=\"lazy\" width=\"1600\" height=\"617\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fintercepting-routes-soft-navigate.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fintercepting-routes-soft-navigate.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fintercepting-routes-soft-navigate.png&amp;w=3840&amp;q=75\"></figure> <p>However, when navigating to the photo by clicking a shareable URL or by refreshing the page, the entire photo page should render instead of the modal. No route interception should occur.</p> <figure><img alt=\"Intercepting routes hard navigation\" loading=\"lazy\" width=\"1600\" height=\"604\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fintercepting-routes-hard-navigate.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fintercepting-routes-hard-navigate.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fintercepting-routes-hard-navigate.png&amp;w=3840&amp;q=75\"><img alt=\"Intercepting routes hard navigation\" loading=\"lazy\" width=\"1600\" height=\"604\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fintercepting-routes-hard-navigate.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fintercepting-routes-hard-navigate.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fintercepting-routes-hard-navigate.png&amp;w=3840&amp;q=75\"></figure> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>Intercepting routes can be defined with the <code>(..)</code> convention, which is similar to relative path convention <code>../</code> but for segments.</p> <p>You can use:</p> <ul> <li>\n<code>(.)</code> to match segments on the <strong>same level</strong>\n</li> <li>\n<code>(..)</code> to match segments <strong>one level above</strong>\n</li> <li>\n<code>(..)(..)</code> to match segments <strong>two levels above</strong>\n</li> <li>\n<code>(...)</code> to match segments from the <strong>root</strong> <code>app</code> directory</li> </ul> <p>For example, you can intercept the <code>photo</code> segment from within the <code>feed</code> segment by creating a <code>(..)photo</code> directory.</p> <figure><img alt=\"Intercepting routes folder structure\" loading=\"lazy\" width=\"1600\" height=\"604\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fintercepted-routes-files.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fintercepted-routes-files.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fintercepted-routes-files.png&amp;w=3840&amp;q=75\"><img alt=\"Intercepting routes folder structure\" loading=\"lazy\" width=\"1600\" height=\"604\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fintercepted-routes-files.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fintercepted-routes-files.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fintercepted-routes-files.png&amp;w=3840&amp;q=75\"></figure> <blockquote class=\"p-3 text-sm\"> <p>Note that the <code>(..)</code> convention is based on <em>route segments</em>, not the file-system.</p> </blockquote> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"modals\" data-docs-heading=\"\">Modals     </h3> <p>Intercepting Routes can be used together with <a href=\"parallel-routes\">Parallel Routes</a> to create modals. This allows you to solve common challenges when building modals, such as:</p> <ul> <li>Making the modal content <strong>shareable through a URL</strong>.</li> <li>\n<strong>Preserving context</strong> when the page is refreshed, instead of closing the modal.</li> <li>\n<strong>Closing the modal on backwards navigation</strong> rather than going to the previous route.</li> <li>\n<strong>Reopening the modal on forwards navigation</strong>.</li> </ul> <p>Consider the following UI pattern, where a user can open a photo modal from a gallery using client-side navigation, or navigate to the photo page directly from a shareable URL:</p> <figure><img alt=\"Intercepting routes modal example\" loading=\"lazy\" width=\"1600\" height=\"976\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fintercepted-routes-modal-example.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fintercepted-routes-modal-example.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fintercepted-routes-modal-example.png&amp;w=3840&amp;q=75\"><img alt=\"Intercepting routes modal example\" loading=\"lazy\" width=\"1600\" height=\"976\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fintercepted-routes-modal-example.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fintercepted-routes-modal-example.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fintercepted-routes-modal-example.png&amp;w=3840&amp;q=75\"></figure> <p>In the above example, the path to the <code>photo</code> segment can use the <code>(..)</code> matcher since <code>@modal</code> is a slot and <strong>not</strong> a segment. This means that the <code>photo</code> route is only one segment level higher, despite being two file-system levels higher.</p> <p>See the <a href=\"parallel-routes#modals\">Parallel Routes</a> documentation for a step-by-step example, or see our <a href=\"https://github.com/vercel-labs/nextgram\" rel=\"noopener noreferrer\" target=\"_blank\">image gallery example</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>Other examples could include opening a login modal in a top navbar while also having a dedicated <code>/login</code> page, or opening a shopping cart in a side modal.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/intercepting-routes\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/intercepting-routes</a>\n  </p>\n</div>\n","app/building-your-application":"<h1 class=\"break-words\">Building Your Application</h1> <p>Next.js provides the building blocks to create flexible, full-stack web applications. The guides in <strong>Building Your Application</strong> explain how to use these features and how to customize your application's behavior.</p> <p>The sections and pages are organized sequentially, from basic to advanced, so you can follow them step-by-step when building your Next.js application. However, you can read them in any order or skip to the pages that apply to your use case.</p> <p>If you're new to Next.js, we recommend starting with the <a href=\"building-your-application/routing\">Routing</a>, <a href=\"building-your-application/rendering\">Rendering</a>, <a href=\"building-your-application/data-fetching\">Data Fetching</a> and <a href=\"building-your-application/styling\">Styling</a> sections, as they introduce the fundamental Next.js and web concepts to help you get started. Then, you can dive deeper into the other sections such as <a href=\"building-your-application/optimizing\">Optimizing</a> and <a href=\"building-your-application/configuring\">Configuring</a>. Finally, once you're ready, checkout the <a href=\"building-your-application/deploying\">Deploying</a> and <a href=\"building-your-application/upgrading\">Upgrading</a> sections.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application</a>\n  </p>\n</div>\n","app/building-your-application/routing/error-handling":"<h1 class=\"break-words\">Error Handling</h1>\n<p>The <code>error.js</code> file convention allows you to gracefully handle unexpected runtime errors in <a href=\"../routing#nested-routes\">nested routes</a>.</p> <ul> <li>Automatically wrap a route segment and its nested children in a <a href=\"https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Error Boundary</a>.</li> <li>Create error UI tailored to specific segments using the file-system hierarchy to adjust granularity.</li> <li>Isolate errors to affected segments while keeping the rest of the application functional.</li> <li>Add functionality to attempt to recover from an error without a full page reload.</li> </ul> <p>Create error UI by adding an <code>error.js</code> file inside a route segment and exporting a React component:</p> <figure><img alt=\"error.js special file\" loading=\"lazy\" width=\"1600\" height=\"606\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ferror-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ferror-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ferror-special-file.png&amp;w=3840&amp;q=75\"><img alt=\"error.js special file\" loading=\"lazy\" width=\"1600\" height=\"606\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ferror-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ferror-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ferror-special-file.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client' // Error components must be Client Components\n \nimport { useEffect } from 'react'\n \nexport default function Error({\n  error,\n  reset,\n}: {\n  error: Error &amp; { digest?: string }\n  reset: () =&gt; void\n}) {\n  useEffect(() =&gt; {\n    // Log the error to an error reporting service\n    console.error(error)\n  }, [error])\n \n  return (\n    &lt;div&gt;\n      &lt;h2&gt;Something went wrong!&lt;/h2&gt;\n      &lt;button\n        onClick={\n          // Attempt to recover by trying to re-render the segment\n          () =&gt; reset()\n        }\n      &gt;\n        Try again\n      &lt;/button&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <h3 id=\"how-errorjs-works\" data-docs-heading=\"\">How error.js Works     </h3> <figure><img alt=\"How error.js works\" loading=\"lazy\" width=\"1600\" height=\"903\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ferror-overview.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ferror-overview.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ferror-overview.png&amp;w=3840&amp;q=75\"><img alt=\"How error.js works\" loading=\"lazy\" width=\"1600\" height=\"903\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ferror-overview.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ferror-overview.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ferror-overview.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>\n<code>error.js</code> automatically creates a <a href=\"https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Error Boundary</a> that <strong>wraps</strong> a nested child segment or <code>page.js</code> component.</li> <li>The React component exported from the <code>error.js</code> file is used as the <strong>fallback</strong> component.</li> <li>If an error is thrown within the error boundary, the error is <strong>contained</strong>, and the fallback component is <strong>rendered</strong>.</li> <li>When the fallback error component is active, layouts <strong>above</strong> the error boundary <strong>maintain</strong> their state and <strong>remain</strong> interactive, and the error component can display functionality to recover from the error.</li> </ul> <h3 id=\"recovering-from-errors\" data-docs-heading=\"\">Recovering From Errors     </h3> <p>The cause of an error can sometimes be temporary. In these cases, simply trying again might resolve the issue.</p> <p>An error component can use the <code>reset()</code> function to prompt the user to attempt to recover from the error. When executed, the function will try to re-render the Error boundary's contents. If successful, the fallback error component is replaced with the result of the re-render.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nexport default function Error({\n  error,\n  reset,\n}: {\n  error: Error &amp; { digest?: string }\n  reset: () =&gt; void\n}) {\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;Something went wrong!&lt;/h2&gt;\n      &lt;button onClick={() =&gt; reset()}&gt;Try again&lt;/button&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <h3 id=\"nested-routes\" data-docs-heading=\"\">Nested Routes     </h3> <p>React components created through <a href=\"../routing#file-conventions\">special files</a> are rendered in a <a href=\"../routing#component-hierarchy\">specific nested hierarchy</a>.</p> <p>For example, a nested route with two segments that both include <code>layout.js</code> and <code>error.js</code> files are rendered in the following <em>simplified</em> component hierarchy:</p> <figure><img alt=\"Nested Error Component Hierarchy\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fnested-error-component-hierarchy.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fnested-error-component-hierarchy.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fnested-error-component-hierarchy.png&amp;w=3840&amp;q=75\"><img alt=\"Nested Error Component Hierarchy\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fnested-error-component-hierarchy.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fnested-error-component-hierarchy.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fnested-error-component-hierarchy.png&amp;w=3840&amp;q=75\"></figure> <p>The nested component hierarchy has implications for the behavior of <code>error.js</code> files across a nested route:</p> <ul> <li>Errors bubble up to the nearest parent error boundary. This means an <code>error.js</code> file will handle errors for all its nested child segments. More or less granular error UI can be achieved by placing <code>error.js</code> files at different levels in the nested folders of a route.</li> <li>An <code>error.js</code> boundary will <strong>not</strong> handle errors thrown in a <code>layout.js</code> component in the <strong>same</strong> segment because the error boundary is nested <strong>inside</strong> that layout's component.</li> </ul> <h3 id=\"handling-errors-in-layouts\" data-docs-heading=\"\">Handling Errors in Layouts     </h3> <p><code>error.js</code> boundaries do <strong>not</strong> catch errors thrown in <code>layout.js</code> or <code>template.js</code> components of the <strong>same segment</strong>. This <a href=\"#nested-routes\">intentional hierarchy</a> keeps important UI that is shared between sibling routes (such as navigation) visible and functional when an error occurs.</p> <p>To handle errors within a specific layout or template, place an <code>error.js</code> file in the layout's parent segment.</p> <p>To handle errors within the root layout or template, use a variation of <code>error.js</code> called <code>global-error.js</code>.</p> <h3 id=\"handling-errors-in-root-layouts\" data-docs-heading=\"\">Handling Errors in Root Layouts     </h3> <p>The root <code>app/error.js</code> boundary does <strong>not</strong> catch errors thrown in the root <code>app/layout.js</code> or <code>app/template.js</code> component.</p> <p>To specifically handle errors in these root components, use a variation of <code>error.js</code> called <code>app/global-error.js</code> located in the root <code>app</code> directory.</p> <p>Unlike the root <code>error.js</code>, the <code>global-error.js</code> error boundary wraps the <strong>entire</strong> application, and its fallback component replaces the root layout when active. Because of this, it is important to note that <code>global-error.js</code> <strong>must</strong> define its own <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags.</p> <p><code>global-error.js</code> is the least granular error UI and can be considered \"catch-all\" error handling for the whole application. It is unlikely to be triggered often as root components are typically less dynamic, and other <code>error.js</code> boundaries will catch most errors.</p> <p>Even if a <code>global-error.js</code> is defined, it is still recommended to define a root <code>error.js</code> whose fallback component will be rendered <strong>within</strong> the root layout, which includes globally shared UI and branding.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nexport default function GlobalError({\n  error,\n  reset,\n}: {\n  error: Error &amp; { digest?: string }\n  reset: () =&gt; void\n}) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;h2&gt;Something went wrong!&lt;/h2&gt;\n        &lt;button onClick={() =&gt; reset()}&gt;Try again&lt;/button&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>global-error.js</code> is only enabled in production. In development, our error overlay will show instead.</li> </ul> </blockquote> <h3 id=\"handling-server-errors\" data-docs-heading=\"\">Handling Server Errors     </h3> <p>If an error is thrown inside a Server Component, Next.js will forward an <code>Error</code> object (stripped of sensitive error information in production) to the nearest <code>error.js</code> file as the <code>error</code> prop.</p> <h4 id=\"securing-sensitive-error-information\" data-docs-heading=\"\">Securing Sensitive Error Information     </h4> <p>During production, the <code>Error</code> object forwarded to the client only includes a generic <code>message</code> and <code>digest</code> property.</p> <p>This is a security precaution to avoid leaking potentially sensitive details included in the error to the client.</p> <p>The <code>message</code> property contains a generic message about the error and the <code>digest</code> property contains an automatically generated hash of the error that can be used to match the corresponding error in server-side logs.</p> <p>During development, the <code>Error</code> object forwarded to the client will be serialized and include the <code>message</code> of the original error for easier debugging.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/error-handling\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/error-handling</a>\n  </p>\n</div>\n","app/building-your-application/routing/route-groups":"<h1 class=\"break-words\">Route Groups</h1>\n<p>In the <code>app</code> directory, nested folders are normally mapped to URL paths. However, you can mark a folder as a <strong>Route Group</strong> to prevent the folder from being included in the route's URL path.</p> <p>This allows you to organize your route segments and project files into logical groups without affecting the URL path structure.</p> <p>Route groups are useful for:</p> <ul> <li>\n<a href=\"#organize-routes-without-affecting-the-url-path\">Organizing routes into groups</a> e.g. by site section, intent, or team.</li> <li>Enabling <a href=\"pages-and-layouts\">nested layouts</a> in the same route segment level: <ul> <li><a href=\"#creating-multiple-root-layouts\">Creating multiple nested layouts in the same segment, including multiple root layouts</a></li> <li><a href=\"#opting-specific-segments-into-a-layout\">Adding a layout to a subset of routes in a common segment</a></li> </ul> </li> </ul> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>A route group can be created by wrapping a folder's name in parenthesis: <code>(folderName)</code></p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"organize-routes-without-affecting-the-url-path\" data-docs-heading=\"\">Organize routes without affecting the URL path     </h3> <p>To organize routes without affecting the URL, create a group to keep related routes together. The folders in parenthesis will be omitted from the URL (e.g. <code>(marketing)</code> or <code>(shop)</code>).</p> <figure><img alt=\"Organizing Routes with Route Groups\" loading=\"lazy\" width=\"1600\" height=\"930\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Froute-group-organisation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Froute-group-organisation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Froute-group-organisation.png&amp;w=3840&amp;q=75\"><img alt=\"Organizing Routes with Route Groups\" loading=\"lazy\" width=\"1600\" height=\"930\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Froute-group-organisation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Froute-group-organisation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Froute-group-organisation.png&amp;w=3840&amp;q=75\"></figure> <p>Even though routes inside <code>(marketing)</code> and <code>(shop)</code> share the same URL hierarchy, you can create a different layout for each group by adding a <code>layout.js</code> file inside their folders.</p> <figure><img alt=\"Route Groups with Multiple Layouts\" loading=\"lazy\" width=\"1600\" height=\"768\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Froute-group-multiple-layouts.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Froute-group-multiple-layouts.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Froute-group-multiple-layouts.png&amp;w=3840&amp;q=75\"><img alt=\"Route Groups with Multiple Layouts\" loading=\"lazy\" width=\"1600\" height=\"768\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Froute-group-multiple-layouts.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Froute-group-multiple-layouts.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Froute-group-multiple-layouts.png&amp;w=3840&amp;q=75\"></figure> <h3 id=\"opting-specific-segments-into-a-layout\" data-docs-heading=\"\">Opting specific segments into a layout     </h3> <p>To opt specific routes into a layout, create a new route group (e.g. <code>(shop)</code>) and move the routes that share the same layout into the group (e.g. <code>account</code> and <code>cart</code>). The routes outside of the group will not share the layout (e.g. <code>checkout</code>).</p> <figure><img alt=\"Route Groups with Opt-in Layouts\" loading=\"lazy\" width=\"1600\" height=\"930\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Froute-group-opt-in-layouts.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Froute-group-opt-in-layouts.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Froute-group-opt-in-layouts.png&amp;w=3840&amp;q=75\"><img alt=\"Route Groups with Opt-in Layouts\" loading=\"lazy\" width=\"1600\" height=\"930\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Froute-group-opt-in-layouts.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Froute-group-opt-in-layouts.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Froute-group-opt-in-layouts.png&amp;w=3840&amp;q=75\"></figure> <h3 id=\"creating-multiple-root-layouts\" data-docs-heading=\"\">Creating multiple root layouts     </h3> <p>To create multiple <a href=\"pages-and-layouts#root-layout-required\">root layouts</a>, remove the top-level <code>layout.js</code> file, and add a <code>layout.js</code> file inside each route groups. This is useful for partitioning an application into sections that have a completely different UI or experience. The <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags need to be added to each root layout.</p> <figure><img alt=\"Route Groups with Multiple Root Layouts\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Froute-group-multiple-root-layouts.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Froute-group-multiple-root-layouts.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Froute-group-multiple-root-layouts.png&amp;w=3840&amp;q=75\"><img alt=\"Route Groups with Multiple Root Layouts\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Froute-group-multiple-root-layouts.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Froute-group-multiple-root-layouts.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Froute-group-multiple-root-layouts.png&amp;w=3840&amp;q=75\"></figure> <p>In the example above, both <code>(marketing)</code> and <code>(shop)</code> have their own root layout.</p> <hr> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>The naming of route groups has no special significance other than for organization. They do not affect the URL path.</li> <li>Routes that include a route group <strong>should not</strong> resolve to the same URL path as other routes. For example, since route groups don't affect URL structure, <code>(marketing)/about/page.js</code> and <code>(shop)/about/page.js</code> would both resolve to <code>/about</code> and cause an error.</li> <li>If you use multiple root layouts without a top-level <code>layout.js</code> file, your home <code>page.js</code> file should be defined in one of the route groups, For example: <code>app/(marketing)/page.js</code>.</li> <li>Navigating <strong>across multiple root layouts</strong> will cause a <strong>full page load</strong> (as opposed to a client-side navigation). For example, navigating from <code>/cart</code> that uses <code>app/(shop)/layout.js</code> to <code>/blog</code> that uses <code>app/(marketing)/layout.js</code> will cause a full page load. This <strong>only</strong> applies to multiple root layouts.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/route-groups\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/route-groups</a>\n  </p>\n</div>\n","app/building-your-application/routing/colocation":"<h1 class=\"break-words\">Project Organization and File Colocation</h1>\n<p>Apart from <a href=\"../../../getting-started/project-structure#app-routing-conventions\">routing folder and file conventions</a>, Next.js is <strong>unopinionated</strong> about how you organize and colocate your project files.</p> <p>This page shares default behavior and features you can use to organize your project.</p> <ul> <li><a href=\"#safe-colocation-by-default\">Safe colocation by default</a></li> <li><a href=\"#project-organization-features\">Project organization features</a></li> <li><a href=\"#project-organization-strategies\">Project organization strategies</a></li> </ul> <h2 id=\"safe-colocation-by-default\" data-docs-heading=\"\">Safe colocation by default     </h2> <p>In the <code>app</code> directory, <a href=\"../routing#route-segments\">nested folder hierarchy</a> defines route structure.</p> <p>Each folder represents a route segment that is mapped to a corresponding segment in a URL path.</p> <p>However, even though route structure is defined through folders, a route is <strong>not publicly accessible</strong> until a <code>page.js</code> or <code>route.js</code> file is added to a route segment.</p> <figure><img alt=\"A diagram showing how a route is not publicly accessible until a page.js or route.js file is added to a route segment.\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-not-routable.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-not-routable.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-not-routable.png&amp;w=3840&amp;q=75\"><img alt=\"A diagram showing how a route is not publicly accessible until a page.js or route.js file is added to a route segment.\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-not-routable.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-not-routable.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-not-routable.png&amp;w=3840&amp;q=75\"></figure> <p>And, even when a route is made publicly accessible, only the <strong>content returned</strong> by <code>page.js</code> or <code>route.js</code> is sent to the client.</p> <figure><img alt=\"A diagram showing how page.js and route.js files make routes publicly accessible.\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-routable.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-routable.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-routable.png&amp;w=3840&amp;q=75\"><img alt=\"A diagram showing how page.js and route.js files make routes publicly accessible.\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-routable.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-routable.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-routable.png&amp;w=3840&amp;q=75\"></figure> <p>This means that <strong>project files</strong> can be <strong>safely colocated</strong> inside route segments in the <code>app</code> directory without accidentally being routable.</p> <figure><img alt=\"A diagram showing colocated project files are not routable even when a segment contains a page.js or route.js file.\" loading=\"lazy\" width=\"1600\" height=\"1011\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-colocation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-colocation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-colocation.png&amp;w=3840&amp;q=75\"><img alt=\"A diagram showing colocated project files are not routable even when a segment contains a page.js or route.js file.\" loading=\"lazy\" width=\"1600\" height=\"1011\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-colocation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-colocation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-colocation.png&amp;w=3840&amp;q=75\"></figure> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>This is different from the <code>pages</code> directory, where any file in <code>pages</code> is considered a route.</li> <li>While you <strong>can</strong> colocate your project files in <code>app</code> you don't <strong>have</strong> to. If you prefer, you can <a href=\"#store-project-files-outside-of-app\">keep them outside the <code>app</code> directory</a>.</li> </ul> </blockquote> <h2 id=\"project-organization-features\" data-docs-heading=\"\">Project organization features     </h2> <p>Next.js provides several features to help you organize your project.</p> <h3 id=\"private-folders\" data-docs-heading=\"\">Private Folders     </h3> <p>Private folders can be created by prefixing a folder with an underscore: <code>_folderName</code></p> <p>This indicates the folder is a private implementation detail and should not be considered by the routing system, thereby <strong>opting the folder and all its subfolders</strong> out of routing.</p> <figure><img alt=\"An example folder structure using private folders\" loading=\"lazy\" width=\"1600\" height=\"849\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-private-folders.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-private-folders.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-private-folders.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure using private folders\" loading=\"lazy\" width=\"1600\" height=\"849\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-private-folders.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-private-folders.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-private-folders.png&amp;w=3840&amp;q=75\"></figure> <p>Since files in the <code>app</code> directory can be <a href=\"#safe-colocation-by-default\">safely colocated by default</a>, private folders are not required for colocation. However, they can be useful for:</p> <ul> <li>Separating UI logic from routing logic.</li> <li>Consistently organizing internal files across a project and the Next.js ecosystem.</li> <li>Sorting and grouping files in code editors.</li> <li>Avoiding potential naming conflicts with future Next.js file conventions.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>While not a framework convention, you might also consider marking files outside private folders as \"private\" using the same underscore pattern.</li> <li>You can create URL segments that start with an underscore by prefixing the folder name with <code>%5F</code> (the URL-encoded form of an underscore): <code>%5FfolderName</code>.</li> <li>If you don't use private folders, it would be helpful to know Next.js <a href=\"../../../getting-started/project-structure#routing-files\">special file conventions</a> to prevent unexpected naming conflicts.</li> </ul> </blockquote> <h3 id=\"route-groups\" data-docs-heading=\"\">Route Groups     </h3> <p>Route groups can be created by wrapping a folder in parenthesis: <code>(folderName)</code></p> <p>This indicates the folder is for organizational purposes and should <strong>not be included</strong> in the route's URL path.</p> <figure><img alt=\"An example folder structure using route groups\" loading=\"lazy\" width=\"1600\" height=\"849\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-route-groups.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-route-groups.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-route-groups.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure using route groups\" loading=\"lazy\" width=\"1600\" height=\"849\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-route-groups.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-route-groups.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-route-groups.png&amp;w=3840&amp;q=75\"></figure> <p>Route groups are useful for:</p> <ul> <li>\n<a href=\"route-groups#organize-routes-without-affecting-the-url-path\">Organizing routes into groups</a> e.g. by site section, intent, or team.</li> <li>Enabling nested layouts in the same route segment level: <ul> <li><a href=\"route-groups#creating-multiple-root-layouts\">Creating multiple nested layouts in the same segment, including multiple root layouts</a></li> <li><a href=\"route-groups#opting-specific-segments-into-a-layout\">Adding a layout to a subset of routes in a common segment</a></li> </ul> </li> </ul> <h3 id=\"src-directory\" data-docs-heading=\"\">src Directory     </h3> <p>Next.js supports storing application code (including <code>app</code>) inside an optional <a href=\"../configuring/src-directory\"><code>src</code> directory</a>. This separates application code from project configuration files which mostly live in the root of a project.</p> <figure><img alt=\"An example folder structure with the `src` directory\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure with the `src` directory\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75\"></figure> <h3 id=\"module-path-aliases\" data-docs-heading=\"\">Module Path Aliases     </h3> <p>Next.js supports <a href=\"../configuring/absolute-imports-and-module-aliases\">Module Path Aliases</a> which make it easier to read and maintain imports across deeply nested project files.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// before\nimport { Button } from '../../../components/button'\n \n// after\nimport { Button } from '@/components/button'</pre></div> <h2 id=\"project-organization-strategies\" data-docs-heading=\"\">Project organization strategies     </h2> <p>There is no \"right\" or \"wrong\" way when it comes to organizing your own files and folders in a Next.js project.</p> <p>The following section lists a very high-level overview of common strategies. The simplest takeaway is to choose a strategy that works for you and your team and be consistent across the project.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: In our examples below, we're using <code>components</code> and <code>lib</code> folders as generalized placeholders, their naming has no special framework significance and your projects might use other folders like <code>ui</code>, <code>utils</code>, <code>hooks</code>, <code>styles</code>, etc.</p> </blockquote> <h3 id=\"store-project-files-outside-of-app\" data-docs-heading=\"\">Store project files outside of app     </h3> <p>This strategy stores all application code in shared folders in the <strong>root of your project</strong> and keeps the <code>app</code> directory purely for routing purposes.</p> <figure><img alt=\"An example folder structure with project files outside of app\" loading=\"lazy\" width=\"1600\" height=\"849\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-project-root.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-project-root.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-project-root.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure with project files outside of app\" loading=\"lazy\" width=\"1600\" height=\"849\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-project-root.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-project-root.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-project-root.png&amp;w=3840&amp;q=75\"></figure> <h3 id=\"store-project-files-in-top-level-folders-inside-of-app\" data-docs-heading=\"\">Store project files in top-level folders inside of app     </h3> <p>This strategy stores all application code in shared folders in the <strong>root of the <code>app</code> directory</strong>.</p> <figure><img alt=\"An example folder structure with project files inside app\" loading=\"lazy\" width=\"1600\" height=\"849\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-app-root.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-app-root.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-app-root.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure with project files inside app\" loading=\"lazy\" width=\"1600\" height=\"849\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-app-root.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-app-root.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-app-root.png&amp;w=3840&amp;q=75\"></figure> <h3 id=\"split-project-files-by-feature-or-route\" data-docs-heading=\"\">Split project files by feature or route     </h3> <p>This strategy stores globally shared application code in the root <code>app</code> directory and <strong>splits</strong> more specific application code into the route segments that use them.</p> <figure><img alt=\"An example folder structure with project files split by feature or route\" loading=\"lazy\" width=\"1600\" height=\"1011\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-app-root-split.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-app-root-split.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-app-root-split.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure with project files split by feature or route\" loading=\"lazy\" width=\"1600\" height=\"1011\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-app-root-split.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-app-root-split.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-app-root-split.png&amp;w=3840&amp;q=75\"></figure><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/colocation\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/colocation</a>\n  </p>\n</div>\n","app/building-your-application/routing/internationalization":"<h1 class=\"break-words\">Internationalization</h1>\n<p>Next.js enables you to configure the routing and rendering of content to support multiple languages. Making your site adaptive to different locales includes translated content (localization) and internationalized routes.</p> <h2 id=\"terminology\" data-docs-heading=\"\">Terminology     </h2> <ul> <li>\n<strong>Locale:</strong> An identifier for a set of language and formatting preferences. This usually includes the preferred language of the user and possibly their geographic region. <ul> <li>\n<code>en-US</code>: English as spoken in the United States</li> <li>\n<code>nl-NL</code>: Dutch as spoken in the Netherlands</li> <li>\n<code>nl</code>: Dutch, no specific region</li> </ul> </li> </ul> <h2 id=\"routing-overview\" data-docs-heading=\"\">Routing Overview     </h2> <p>Its recommended to use the users language preferences in the browser to select which locale to use. Changing your preferred language will modify the incoming <code>Accept-Language</code> header to your application.</p> <p>For example, using the following libraries, you can look at an incoming <code>Request</code> to determine which locale to select, based on the <code>Headers</code>, locales you plan to support, and the default locale.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { match } from '@formatjs/intl-localematcher'\nimport Negotiator from 'negotiator'\n \nlet headers = { 'accept-language': 'en-US,en;q=0.5' }\nlet languages = new Negotiator({ headers }).languages()\nlet locales = ['en-US', 'nl-NL', 'nl']\nlet defaultLocale = 'en-US'\n \nmatch(languages, locales, defaultLocale) // -&gt; 'en-US'</pre></div> <p>Routing can be internationalized by either the sub-path (<code>/fr/products</code>) or domain (<code>my-site.fr/products</code>). With this information, you can now redirect the user based on the locale inside <a href=\"middleware\">Middleware</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from \"next/server\";\n \nlet locales = ['en-US', 'nl-NL', 'nl']\n \n// Get the preferred locale, similar to the above or using a library\nfunction getLocale(request) { ... }\n \nexport function middleware(request) {\n  // Check if there is any supported locale in the pathname\n  const { pathname } = request.nextUrl\n  const pathnameHasLocale = locales.some(\n    (locale) =&gt; pathname.startsWith(`/${locale}/`) || pathname === `/${locale}`\n  )\n \n  if (pathnameHasLocale) return\n \n  // Redirect if there is no locale\n  const locale = getLocale(request)\n  request.nextUrl.pathname = `/${locale}${pathname}`\n  // e.g. incoming request is /products\n  // The new URL is now /en-US/products\n  return NextResponse.redirect(request.nextUrl)\n}\n \nexport const config = {\n  matcher: [\n    // Skip all internal paths (_next)\n    '/((?!_next).*)',\n    // Optional: only run on root (/) URL\n    // '/'\n  ],\n}</pre></div> <p>Finally, ensure all special files inside <code>app/</code> are nested under <code>app/[lang]</code>. This enables the Next.js router to dynamically handle different locales in the route, and forward the <code>lang</code> parameter to every layout and page. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// You now have access to the current locale\n// e.g. /en-US/products -&gt; `lang` is \"en-US\"\nexport default async function Page({ params: { lang } }) {\n  return ...\n}</pre></div> <p>The root layout can also be nested in the new folder (e.g. <code>app/[lang]/layout.js</code>).</p> <h2 id=\"localization\" data-docs-heading=\"\">Localization     </h2> <p>Changing displayed content based on the users preferred locale, or localization, is not something specific to Next.js. The patterns described below would work the same with any web application.</p> <p>Lets assume we want to support both English and Dutch content inside our application. We might maintain two different dictionaries, which are objects that give us a mapping from some key to a localized string. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"products\": {\n    \"cart\": \"Add to Cart\"\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"products\": {\n    \"cart\": \"Toevoegen aan Winkelwagen\"\n  }\n}</pre></div> <p>We can then create a <code>getDictionary</code> function to load the translations for the requested locale:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import 'server-only'\n \nconst dictionaries = {\n  en: () =&gt; import('./dictionaries/en.json').then((module) =&gt; module.default),\n  nl: () =&gt; import('./dictionaries/nl.json').then((module) =&gt; module.default),\n}\n \nexport const getDictionary = async (locale) =&gt; dictionaries[locale]()</pre></div> <p>Given the currently selected language, we can fetch the dictionary inside of a layout or page.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getDictionary } from './dictionaries'\n \nexport default async function Page({ params: { lang } }) {\n  const dict = await getDictionary(lang) // en\n  return &lt;button&gt;{dict.products.cart}&lt;/button&gt; // Add to Cart\n}</pre></div> <p>Because all layouts and pages in the <code>app/</code> directory default to <a href=\"../rendering/server-components\">Server Components</a>, we do not need to worry about the size of the translation files affecting our client-side JavaScript bundle size. This code will <strong>only run on the server</strong>, and only the resulting HTML will be sent to the browser.</p> <h2 id=\"static-generation\" data-docs-heading=\"\">Static Generation     </h2> <p>To generate static routes for a given set of locales, we can use <code>generateStaticParams</code> with any page or layout. This can be global, for example, in the root layout:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function generateStaticParams() {\n  return [{ lang: 'en-US' }, { lang: 'de' }]\n}\n \nexport default function Root({ children, params }) {\n  return (\n    &lt;html lang={params.lang}&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div> <h2 id=\"resources\" data-docs-heading=\"\">Resources     </h2> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/app-dir-i18n-routing\" rel=\"noopener noreferrer\" target=\"_blank\">Minimal i18n routing and translations</a></li> <li><a href=\"https://next-intl-docs.vercel.app/docs/next-13\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>next-intl</code></a></li> <li><a href=\"https://github.com/QuiiBz/next-international\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>next-international</code></a></li> <li><a href=\"https://github.com/i18nexus/next-i18n-router\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>next-i18n-router</code></a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/internationalization\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/internationalization</a>\n  </p>\n</div>\n","getting-started/installation":"<h1 class=\"break-words\">Installation</h1>\n<p>System Requirements:</p> <ul> <li>\n<a href=\"https://nodejs.org/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.js 18.17</a> or later.</li> <li>macOS, Windows (including WSL), and Linux are supported.</li> </ul> <h2 id=\"automatic-installation\" data-docs-heading=\"\">Automatic Installation     </h2> <p>We recommend starting a new Next.js app using <a href=\"../app/api-reference/create-next-app\"><code>create-next-app</code></a>, which sets up everything automatically for you. To create a project, run:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest</pre></div> <p>On installation, you'll see the following prompts:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">What is your project named? my-app\nWould you like to use TypeScript? No / Yes\nWould you like to use ESLint? No / Yes\nWould you like to use Tailwind CSS? No / Yes\nWould you like to use `src/` directory? No / Yes\nWould you like to use App Router? (recommended) No / Yes\nWould you like to customize the default import alias (@/*)? No / Yes\nWhat import alias would you like configured? @/*</pre></div> <p>After the prompts, <code>create-next-app</code> will create a folder with your project name and install the required dependencies.</p> <p>If you're new to Next.js, see the <a href=\"project-structure\">project structure</a> docs for an overview of all the possible files and folders in your application.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Next.js now ships with <a href=\"../app/building-your-application/configuring/typescript\">TypeScript</a>, <a href=\"../app/building-your-application/configuring/eslint\">ESLint</a>, and <a href=\"../app/building-your-application/styling/tailwind-css\">Tailwind CSS</a> configuration by default.</li> <li>You can optionally use a <a href=\"../app/building-your-application/configuring/src-directory\"><code>src</code> directory</a> in the root of your project to separate your application's code from configuration files.</li> </ul> </blockquote> <h2 id=\"manual-installation\" data-docs-heading=\"\">Manual Installation     </h2> <p>To manually create a new Next.js app, install the required packages:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest react@latest react-dom@latest</pre></div> <p>Open your <code>package.json</code> file and add the following <code>scripts</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\"\n  }\n}</pre></div> <p>These scripts refer to the different stages of developing an application:</p> <ul> <li>\n<code>dev</code>: runs <a href=\"../app/api-reference/next-cli#development\"><code>next dev</code></a> to start Next.js in development mode.</li> <li>\n<code>build</code>: runs <a href=\"../app/api-reference/next-cli#build\"><code>next build</code></a> to build the application for production usage.</li> <li>\n<code>start</code>: runs <a href=\"../app/api-reference/next-cli#production\"><code>next start</code></a> to start a Next.js production server.</li> <li>\n<code>lint</code>: runs <a href=\"../app/api-reference/next-cli#lint\"><code>next lint</code></a> to set up Next.js' built-in ESLint configuration.</li> </ul> <h3 id=\"creating-directories\" data-docs-heading=\"\">Creating directories     </h3> <p>Next.js uses file-system routing, which means the routes in your application are determined by how you structure your files.</p> <h4 id=\"the-app-directory\" data-docs-heading=\"\">The app directory     </h4> <p>For new applications, we recommend using the <a href=\"../app\">App Router</a>. This router allows you to use React's latest features and is an evolution of the <a href=\"../pages\">Pages Router</a> based on community feedback.</p> <p>Create an <code>app/</code> folder, then add a <code>layout.tsx</code> and <code>page.tsx</code> file. These will be rendered when the user visits the root of your application (<code>/</code>).</p> <figure><img alt=\"App Folder Structure\" loading=\"lazy\" width=\"1600\" height=\"363\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fapp-getting-started.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fapp-getting-started.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fapp-getting-started.png&amp;w=3840&amp;q=75\"><img alt=\"App Folder Structure\" loading=\"lazy\" width=\"1600\" height=\"363\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fapp-getting-started.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fapp-getting-started.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fapp-getting-started.png&amp;w=3840&amp;q=75\"></figure> <p>Create a <a href=\"../app/building-your-application/routing/pages-and-layouts#root-layout-required\">root layout</a> inside <code>app/layout.tsx</code> with the required <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>Finally, create a home page <code>app/page.tsx</code> with some initial content:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return &lt;h1&gt;Hello, Next.js!&lt;/h1&gt;\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you forget to create <code>layout.tsx</code>, Next.js will automatically create this file when running the development server with <code>next dev</code>.</p> </blockquote> <p>Learn more about <a href=\"../app/building-your-application/routing/defining-routes\">using the App Router</a>.</p> <h4 id=\"the-pages-directory-optional\" data-docs-heading=\"\">The pages directory (optional)     </h4> <p>If you prefer to use the Pages Router instead of the App Router, you can create a <code>pages/</code> directory at the root of your project.</p> <p>Then, add an <code>index.tsx</code> file inside your <code>pages</code> folder. This will be your home page (<code>/</code>):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return &lt;h1&gt;Hello, Next.js!&lt;/h1&gt;\n}</pre></div> <p>Next, add an <code>_app.tsx</code> file inside <code>pages/</code> to define the global layout. Learn more about the <a href=\"../pages/building-your-application/routing/custom-app\">custom App file</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { AppProps } from 'next/app'\n \nexport default function App({ Component, pageProps }: AppProps) {\n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>  <p>Finally, add a <code>_document.tsx</code> file inside <code>pages/</code> to control the initial response from the server. Learn more about the <a href=\"../pages/building-your-application/routing/custom-document\">custom Document file</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Html, Head, Main, NextScript } from 'next/document'\n \nexport default function Document() {\n  return (\n    &lt;Html&gt;\n      &lt;Head /&gt;\n      &lt;body&gt;\n        &lt;Main /&gt;\n        &lt;NextScript /&gt;\n      &lt;/body&gt;\n    &lt;/Html&gt;\n  )\n}</pre></div> <p>Learn more about <a href=\"../pages/building-your-application/routing/pages-and-layouts\">using the Pages Router</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Although you can use both routers in the same project, routes in <code>app</code> will be prioritized over <code>pages</code>. We recommend using only one router in your new project to avoid confusion.</p> </blockquote> <h4 id=\"the-public-folder-optional\" data-docs-heading=\"\">The public folder (optional)     </h4> <p>Create a <code>public</code> folder to store static assets such as images, fonts, etc. Files inside <code>public</code> directory can then be referenced by your code starting from the base URL (<code>/</code>).</p> <h2 id=\"run-the-development-server\" data-docs-heading=\"\">Run the Development Server     </h2> <ol> <li>Run <code>npm run dev</code> to start the development server.</li> <li>Visit <code>http://localhost:3000</code> to view your application.</li> <li>Edit <code>app/page.tsx</code> (or <code>pages/index.tsx</code>) file and save it to see the updated result in your browser.</li> </ol><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/getting-started/installation\" class=\"_attribution-link\">https://nextjs.org/docs/getting-started/installation</a>\n  </p>\n</div>\n","app/building-your-application/routing/loading-ui-and-streaming":"<h1 class=\"break-words\">Loading UI and Streaming</h1>\n<p>The special file <code>loading.js</code> helps you create meaningful Loading UI with <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Suspense</a>. With this convention, you can show an <a href=\"#instant-loading-states\">instant loading state</a> from the server while the content of a route segment loads. The new content is automatically swapped in once rendering is complete.</p> <figure><img alt=\"Loading UI\" loading=\"lazy\" width=\"1600\" height=\"691\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Floading-ui.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Floading-ui.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Floading-ui.png&amp;w=3840&amp;q=75\"><img alt=\"Loading UI\" loading=\"lazy\" width=\"1600\" height=\"691\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Floading-ui.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Floading-ui.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Floading-ui.png&amp;w=3840&amp;q=75\"></figure> <h2 id=\"instant-loading-states\" data-docs-heading=\"\">Instant Loading States     </h2> <p>An instant loading state is fallback UI that is shown immediately upon navigation. You can pre-render loading indicators such as skeletons and spinners, or a small but meaningful part of future screens such as a cover photo, title, etc. This helps users understand the app is responding and provides a better user experience.</p> <p>Create a loading state by adding a <code>loading.js</code> file inside a folder.</p> <figure><img alt=\"loading.js special file\" loading=\"lazy\" width=\"1600\" height=\"606\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Floading-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Floading-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Floading-special-file.png&amp;w=3840&amp;q=75\"><img alt=\"loading.js special file\" loading=\"lazy\" width=\"1600\" height=\"606\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Floading-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Floading-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Floading-special-file.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Loading() {\n  // You can add any UI inside Loading, including a Skeleton.\n  return &lt;LoadingSkeleton /&gt;\n}</pre></div>  <p>In the same folder, <code>loading.js</code> will be nested inside <code>layout.js</code>. It will automatically wrap the <code>page.js</code> file and any children below in a <code>&lt;Suspense&gt;</code> boundary.</p> <figure><img alt=\"loading.js overview\" loading=\"lazy\" width=\"1600\" height=\"768\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Floading-overview.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Floading-overview.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Floading-overview.png&amp;w=3840&amp;q=75\"><img alt=\"loading.js overview\" loading=\"lazy\" width=\"1600\" height=\"768\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Floading-overview.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Floading-overview.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Floading-overview.png&amp;w=3840&amp;q=75\"></figure> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Navigation is immediate, even with <a href=\"linking-and-navigating#how-routing-and-navigation-works\">server-centric routing</a>.</li> <li>Navigation is interruptible, meaning changing routes does not need to wait for the content of the route to fully load before navigating to another route.</li> <li>Shared layouts remain interactive while new route segments load.</li> </ul> </blockquote> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation:</strong> Use the <code>loading.js</code> convention for route segments (layouts and pages) as Next.js optimizes this functionality.</p> </blockquote> <h2 id=\"streaming-with-suspense\" data-docs-heading=\"\">Streaming with Suspense     </h2> <p>In addition to <code>loading.js</code>, you can also manually create Suspense Boundaries for your own UI components. The App Router supports streaming with <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Suspense</a> for both <a href=\"../rendering/edge-and-nodejs-runtimes\">Node.js and Edge runtimes</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<a href=\"https://bugs.webkit.org/show_bug.cgi?id=252413\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Some browsers</a> buffer a streaming response. You may not see the streamed response until the exceeds 1024 bytes. This typically only affects hello world applications, but not real applications.</li> </ul> </blockquote> <h3 id=\"what-is-streaming\" data-docs-heading=\"\">What is Streaming?     </h3> <p>To learn how Streaming works in React and Next.js, it's helpful to understand <strong>Server-Side Rendering (SSR)</strong> and its limitations.</p> <p>With SSR, there's a series of steps that need to be completed before a user can see and interact with a page:</p> <ol> <li>First, all data for a given page is fetched on the server.</li> <li>The server then renders the HTML for the page.</li> <li>The HTML, CSS, and JavaScript for the page are sent to the client.</li> <li>A non-interactive user interface is shown using the generated HTML, and CSS.</li> <li>Finally, React <a href=\"https://react.dev/reference/react-dom/client/hydrateRoot#hydrating-server-rendered-html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">hydrates</a> the user interface to make it interactive.</li> </ol> <figure><img alt=\"Chart showing Server Rendering without Streaming\" loading=\"lazy\" width=\"1600\" height=\"612\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-without-streaming-chart.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-without-streaming-chart.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-without-streaming-chart.png&amp;w=3840&amp;q=75\"><img alt=\"Chart showing Server Rendering without Streaming\" loading=\"lazy\" width=\"1600\" height=\"612\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-without-streaming-chart.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-without-streaming-chart.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-without-streaming-chart.png&amp;w=3840&amp;q=75\"></figure> <p>These steps are sequential and blocking, meaning the server can only render the HTML for a page once all the data has been fetched. And, on the client, React can only hydrate the UI once the code for all components in the page has been downloaded.</p> <p>SSR with React and Next.js helps improve the perceived loading performance by showing a non-interactive page to the user as soon as possible.</p> <figure><img alt=\"Server Rendering without Streaming\" loading=\"lazy\" width=\"1600\" height=\"748\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-without-streaming.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-without-streaming.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-without-streaming.png&amp;w=3840&amp;q=75\"><img alt=\"Server Rendering without Streaming\" loading=\"lazy\" width=\"1600\" height=\"748\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-without-streaming.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-without-streaming.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-without-streaming.png&amp;w=3840&amp;q=75\"></figure> <p>However, it can still be slow as all data fetching on server needs to be completed before the page can be shown to the user.</p> <p><strong>Streaming</strong> allows you to break down the page's HTML into smaller chunks and progressively send those chunks from the server to the client.</p> <figure><img alt=\"How Server Rendering with Streaming Works\" loading=\"lazy\" width=\"1600\" height=\"785\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75\"><img alt=\"How Server Rendering with Streaming Works\" loading=\"lazy\" width=\"1600\" height=\"785\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75\"></figure> <p>This enables parts of the page to be displayed sooner, without waiting for all the data to load before any UI can be rendered.</p> <p>Streaming works well with React's component model because each component can be considered a chunk. Components that have higher priority (e.g. product information) or that don't rely on data can be sent first (e.g. layout), and React can start hydration earlier. Components that have lower priority (e.g. reviews, related products) can be sent in the same server request after their data has been fetched.</p> <figure><img alt=\"Chart showing Server Rendering with Streaming\" loading=\"lazy\" width=\"1600\" height=\"730\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming-chart.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming-chart.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming-chart.png&amp;w=3840&amp;q=75\"><img alt=\"Chart showing Server Rendering with Streaming\" loading=\"lazy\" width=\"1600\" height=\"730\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming-chart.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming-chart.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming-chart.png&amp;w=3840&amp;q=75\"></figure> <p>Streaming is particularly beneficial when you want to prevent long data requests from blocking the page from rendering as it can reduce the <a href=\"https://web.dev/ttfb/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Time To First Byte (TTFB)</a> and <a href=\"https://web.dev/first-contentful-paint/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Contentful Paint (FCP)</a>. It also helps improve <a href=\"https://developer.chrome.com/en/docs/lighthouse/performance/interactive/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Time to Interactive (TTI)</a>, especially on slower devices.</p> <h3 id=\"example\" data-docs-heading=\"\">Example     </h3> <p><code>&lt;Suspense&gt;</code> works by wrapping a component that performs an asynchronous action (e.g. fetch data), showing fallback UI (e.g. skeleton, spinner) while it's happening, and then swapping in your component once the action completes.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Suspense } from 'react'\nimport { PostFeed, Weather } from './Components'\n \nexport default function Posts() {\n  return (\n    &lt;section&gt;\n      &lt;Suspense fallback={&lt;p&gt;Loading feed...&lt;/p&gt;}&gt;\n        &lt;PostFeed /&gt;\n      &lt;/Suspense&gt;\n      &lt;Suspense fallback={&lt;p&gt;Loading weather...&lt;/p&gt;}&gt;\n        &lt;Weather /&gt;\n      &lt;/Suspense&gt;\n    &lt;/section&gt;\n  )\n}</pre></div>  <p>By using Suspense, you get the benefits of:</p> <ol> <li>\n<strong>Streaming Server Rendering</strong> - Progressively rendering HTML from the server to the client.</li> <li>\n<strong>Selective Hydration</strong> - React prioritizes what components to make interactive first based on user interaction.</li> </ol> <p>For more Suspense examples and use cases, please see the <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Documentation</a>.</p> <h3 id=\"seo\" data-docs-heading=\"\">SEO     </h3> <ul> <li>Next.js will wait for data fetching inside <a href=\"../../api-reference/functions/generate-metadata\"><code>generateMetadata</code></a> to complete before streaming UI to the client. This guarantees the first part of a streamed response includes <code>&lt;head&gt;</code> tags.</li> <li>Since streaming is server-rendered, it does not impact SEO. You can use the <a href=\"https://search.google.com/test/rich-results\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Rich Results Test</a> tool from Google to see how your page appears to Google's web crawlers and view the serialized HTML (<a href=\"https://web.dev/rendering-on-the-web/#seo-considerations\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">source</a>).</li> </ul> <h3 id=\"status-codes\" data-docs-heading=\"\">Status Codes     </h3> <p>When streaming, a <code>200</code> status code will be returned to signal that the request was successful.</p> <p>The server can still communicate errors or issues to the client within the streamed content itself, for example, when using <a href=\"../../api-reference/functions/redirect\"><code>redirect</code></a> or <a href=\"../../api-reference/functions/not-found\"><code>notFound</code></a>. Since the response headers have already been sent to the client, the status code of the response cannot be updated. This does not affect SEO.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming</a>\n  </p>\n</div>\n","app/building-your-application/routing/redirecting":"<h1 class=\"break-words\">Redirecting</h1>\n<p>There are a few ways you can handle redirects in Next.js. This page will go through each available option, use cases, and how to manage large numbers of redirects.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Purpose</th>\n<th>Where</th>\n<th>Status Code</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#redirect-function\"><code>redirect</code></a></td>\n<td>Redirect user after a mutation or event</td>\n<td>Server Components, Server Actions, Route Handlers</td>\n<td>307 (Temporary) or 303 (Server Action)</td>\n</tr>\n<tr>\n<td><a href=\"#permanentredirect-function\"><code>permanentRedirect</code></a></td>\n<td>Redirect user after a mutation or event</td>\n<td>Server Components, Server Actions, Route Handlers</td>\n<td>308 (Permanent)</td>\n</tr>\n<tr>\n<td><a href=\"#userouter-hook\"><code>useRouter</code></a></td>\n<td>Perform a client-side navigation</td>\n<td>Event Handlers in Client Components</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td><a href=\"#redirects-in-nextconfigjs\"><code>redirects</code> in <code>next.config.js</code></a></td>\n<td>Redirect an incoming request based on a path</td>\n<td>\n<code>next.config.js</code> file</td>\n<td>307 (Temporary) or 308 (Permanent)</td>\n</tr>\n<tr>\n<td><a href=\"#nextresponseredirect-in-middleware\"><code>NextResponse.redirect</code></a></td>\n<td>Redirect an incoming request based on a condition</td>\n<td>Middleware</td>\n<td>Any</td>\n</tr>\n</tbody>\n</table></div>  <h2 id=\"redirect-function\" data-docs-heading=\"\">redirect function     </h2>\n<p>The <code>redirect</code> function allows you to redirect the user to another URL. You can call <code>redirect</code> in <a href=\"../rendering/server-components\">Server Components</a>, <a href=\"route-handlers\">Route Handlers</a>, and <a href=\"../data-fetching/server-actions-and-mutations\">Server Actions</a>.</p>\n<p><code>redirect</code> is often used after a mutation or event. For example, creating a post:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { redirect } from 'next/navigation'\nimport { revalidatePath } from 'next/cache'\n \nexport async function createPost(id: string) {\n  try {\n    // Call database\n  } catch (error) {\n    // Handle errors\n  }\n \n  revalidatePath('/posts') // Update cached posts\n  redirect(`/post/${id}`) // Navigate to the new post page\n}</pre></div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>redirect</code> returns a 307 (Temporary Redirect) status code by default. When used in a Server Action, it returns a 303 (See Other), which is commonly used for redirecting to a success page as a result of a POST request.</li> <li>\n<code>redirect</code> internally throws an error so it should be called outside of <code>try/catch</code> blocks.</li> <li>\n<code>redirect</code> can be called in Client Components during the rendering process but not in event handlers. You can use the <a href=\"#userouter-hook\"><code>useRouter</code> hook</a> instead.</li> <li>\n<code>redirect</code> also accepts absolute URLs and can be used to redirect to external links.</li> <li>If you'd like to redirect before the render process, use <a href=\"#redirects-in-nextconfigjs\"><code>next.config.js</code></a> or <a href=\"#nextresponseredirect-in-middleware\">Middleware</a>.</li> </ul> </blockquote>\n<p>See the <a href=\"../../api-reference/functions/redirect\"><code>redirect</code> API reference</a> for more information.</p>\n<h2 id=\"permanentredirect-function\" data-docs-heading=\"\">permanentRedirect function     </h2>\n<p>The <code>permanentRedirect</code> function allows you to <strong>permanently</strong> redirect the user to another URL. You can call <code>permanentRedirect</code> in <a href=\"../rendering/server-components\">Server Components</a>, <a href=\"route-handlers\">Route Handlers</a>, and <a href=\"../data-fetching/server-actions-and-mutations\">Server Actions</a>.</p>\n<p><code>permanentRedirect</code> is often used after a mutation or event that changes an entity's canonical URL, such as updating a user's profile URL after they change their username:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { permanentRedirect } from 'next/navigation'\nimport { revalidateTag } from 'next/cache'\n \nexport async function updateUsername(username: string, formData: FormData) {\n  try {\n    // Call database\n  } catch (error) {\n    // Handle errors\n  }\n \n  revalidateTag('username') // Update all references to the username\n  permanentRedirect(`/profile/${username}`) // Navigate to the new user profile\n}</pre></div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>permanentRedirect</code> returns a 308 (permanent redirect) status code by default.</li> <li>\n<code>permanentRedirect</code> also accepts absolute URLs and can be used to redirect to external links.</li> <li>If you'd like to redirect before the render process, use <a href=\"#redirects-in-nextconfigjs\"><code>next.config.js</code></a> or <a href=\"#nextresponseredirect-in-middleware\">Middleware</a>.</li> </ul> </blockquote>\n<p>See the <a href=\"../../api-reference/functions/permanentredirect\"><code>permanentRedirect</code> API reference</a> for more information.</p> <h2 id=\"userouter-hook\" data-docs-heading=\"\">useRouter() hook     </h2> <p>If you need to redirect inside an event handler in a Client Component, you can use the <code>push</code> method from the <code>useRouter</code> hook. For example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useRouter } from 'next/navigation'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.push('/dashboard')}&gt;\n      Dashboard\n    &lt;/button&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If you don't need to programmatically navigate a user, you should use a <a href=\"../../api-reference/components/link\"><code>&lt;Link&gt;</code></a> component.</li> </ul> </blockquote> <p>See the <a href=\"../../api-reference/functions/use-router\"><code>useRouter</code> API reference</a> for more information.</p>  <h2 id=\"redirects-in-nextconfigjs\" data-docs-heading=\"\">redirects in next.config.js     </h2> <p>The <code>redirects</code> option in the <code>next.config.js</code> file allows you to redirect an incoming request path to a different destination path. This is useful when you change the URL structure of pages or have a list of redirects that are known ahead of time.</p> <p><code>redirects</code> supports <a href=\"../../api-reference/next-config-js/redirects#path-matching\">path</a>, <a href=\"../../api-reference/next-config-js/redirects#header-cookie-and-query-matching\">header, cookie, and query matching</a>, giving you the flexibility to redirect users based on an incoming request.</p> <p>To use <code>redirects</code>, add the option to your <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      // Basic redirect\n      {\n        source: '/about',\n        destination: '/',\n        permanent: true,\n      },\n      // Wildcard path matching\n      {\n        source: '/blog/:slug',\n        destination: '/news/:slug',\n        permanent: true,\n      },\n    ]\n  },\n}</pre></div> <p>See the <a href=\"../../api-reference/next-config-js/redirects\"><code>redirects</code> API reference</a> for more information.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>redirects</code> can return a 307 (Temporary Redirect) or 308 (Permanent Redirect) status code with the <code>permanent</code> option.</li> <li>\n<code>redirects</code> may have a limit on platforms. For example, on Vercel, there's a limit of 1,024 redirects. To manage a large number of redirects (1000+), consider creating a custom solution using <a href=\"middleware\">Middleware</a>. See <a href=\"#managing-redirects-at-scale-advanced\">managing redirects at scale</a> for more.</li> <li>\n<code>redirects</code> runs <strong>before</strong> Middleware.</li> </ul> </blockquote> <h2 id=\"nextresponseredirect-in-middleware\" data-docs-heading=\"\">NextResponse.redirect in Middleware     </h2> <p>Middleware allows you to run code before a request is completed. Then, based on the incoming request, redirect to a different URL using <code>NextResponse.redirect</code>. This is useful if you want to redirect users based on a condition (e.g. authentication, session management, etc) or have <a href=\"#managing-redirects-at-scale-advanced\">a large number of redirects</a>.</p> <p>For example, to redirect the user to a <code>/login</code> page if they are not authenticated:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse, NextRequest } from 'next/server'\nimport { authenticate } from 'auth-provider'\n \nexport function middleware(request: NextRequest) {\n  const isAuthenticated = authenticate(request)\n \n  // If the user is authenticated, continue as normal\n  if (isAuthenticated) {\n    return NextResponse.next()\n  }\n \n  // Redirect to login page if not authenticated\n  return NextResponse.redirect(new URL('/login', request.url))\n}\n \nexport const config = {\n  matcher: '/dashboard/:path*',\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Middleware runs <strong>after</strong> <code>redirects</code> in <code>next.config.js</code> and <strong>before</strong> rendering.</li> </ul> </blockquote> <p>See the <a href=\"middleware\">Middleware</a> documentation for more information.</p> <h2 id=\"managing-redirects-at-scale-advanced\" data-docs-heading=\"\">Managing redirects at scale (advanced)     </h2> <p>To manage a large number of redirects (1000+), you may consider creating a custom solution using Middleware. This allows you to handle redirects programmatically without having to redeploy your application.</p> <p>To do this, you'll need to consider:</p> <ol> <li>Creating and storing a redirect map.</li> <li>Optimizing data lookup performance.</li> </ol> <blockquote class=\"p-3 text-sm\"> <p><strong>Next.js Example</strong>: See our <a href=\"https://redirects-bloom-filter.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Middleware with Bloom filter</a> example for an implementation of the recommendations below.</p> </blockquote> <h3 id=\"1-creating-and-storing-a-redirect-map\" data-docs-heading=\"\">1. Creating and storing a redirect map     </h3> <p>A redirect map is a list of redirects that you can store in a database (usually a key-value store) or JSON file.</p> <p>Consider the following data structure:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"/old\": {\n    \"destination\": \"/new\",\n    \"permanent\": true\n  },\n  \"/blog/post-old\": {\n    \"destination\": \"/blog/post-new\",\n    \"permanent\": true\n  }\n}</pre>\n</div> <p>In <a href=\"middleware\">Middleware</a>, you can read from a database such as Vercel's <a href=\"https://vercel.com/docs/storage/edge-config/get-started?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Edge Config</a> or <a href=\"https://vercel.com/docs/storage/vercel-kv?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Redis</a>, and redirect the user based on the incoming request:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse, NextRequest } from 'next/server'\nimport { get } from '@vercel/edge-config'\n \ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n \nexport async function middleware(request: NextRequest) {\n  const pathname = request.nextUrl.pathname\n  const redirectData = await get(pathname)\n \n  if (redirectData &amp;&amp; typeof redirectData === 'string') {\n    const redirectEntry: RedirectEntry = JSON.parse(redirectData)\n    const statusCode = redirectEntry.permanent ? 308 : 307\n    return NextResponse.redirect(redirectEntry.destination, statusCode)\n  }\n \n  // No redirect found, continue without redirecting\n  return NextResponse.next()\n}</pre></div>  <h3 id=\"2-optimizing-data-lookup-performance\" data-docs-heading=\"\">2. Optimizing data lookup performance     </h3> <p>Reading a large dataset for every incoming request can be slow and expensive. There are two ways you can optimize data lookup performance:</p> <ul> <li>Use a database that is optimized for fast reads, such as <a href=\"https://vercel.com/docs/storage/edge-config/get-started?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Edge Config</a> or <a href=\"https://vercel.com/docs/storage/vercel-kv?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Redis</a>.</li> <li>Use a data lookup strategy such as a <a href=\"https://en.wikipedia.org/wiki/Bloom_filter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Bloom filter</a> to efficiently check if a redirect exists <strong>before</strong> reading the larger redirects file or database.</li> </ul> <p>Considering the previous example, you can import a generated bloom filter file into Middleware, then, check if the incoming request pathname exists in the bloom filter.</p> <p>If it does, forward the request to a <a href=\"route-handlers\">Route Handler</a>  which will check the actual file and redirect the user to the appropriate URL. This avoids importing a large redirects file into Middleware, which can slow down every incoming request.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse, NextRequest } from 'next/server'\nimport { ScalableBloomFilter } from 'bloom-filters'\nimport GeneratedBloomFilter from './redirects/bloom-filter.json'\n \ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n \n// Initialize bloom filter from a generated JSON file\nconst bloomFilter = ScalableBloomFilter.fromJSON(GeneratedBloomFilter as any)\n \nexport async function middleware(request: NextRequest) {\n  // Get the path for the incoming request\n  const pathname = request.nextUrl.pathname\n \n  // Check if the path is in the bloom filter\n  if (bloomFilter.has(pathname)) {\n    // Forward the pathname to the Route Handler\n    const api = new URL(\n      `/api/redirects?pathname=${encodeURIComponent(request.nextUrl.pathname)}`,\n      request.nextUrl.origin\n    )\n \n    try {\n      // Fetch redirect data from the Route Handler\n      const redirectData = await fetch(api)\n \n      if (redirectData.ok) {\n        const redirectEntry: RedirectEntry | undefined =\n          await redirectData.json()\n \n        if (redirectEntry) {\n          // Determine the status code\n          const statusCode = redirectEntry.permanent ? 308 : 307\n \n          // Redirect to the destination\n          return NextResponse.redirect(redirectEntry.destination, statusCode)\n        }\n      }\n    } catch (error) {\n      console.error(error)\n    }\n  }\n \n  // No redirect found, continue the request without redirecting\n  return NextResponse.next()\n}</pre></div>  <p>Then, in the Route Handler:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse } from 'next/server'\nimport redirects from '@/app/redirects/redirects.json'\n \ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n \nexport function GET(request: NextRequest) {\n  const pathname = request.nextUrl.searchParams.get('pathname')\n  if (!pathname) {\n    return new Response('Bad Request', { status: 400 })\n  }\n \n  // Get the redirect entry from the redirects.json file\n  const redirect = (redirects as Record&lt;string, RedirectEntry&gt;)[pathname]\n \n  // Account for bloom filter false positives\n  if (!redirect) {\n    return new Response('No redirect', { status: 400 })\n  }\n \n  // Return the redirect entry\n  return NextResponse.json(redirect)\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>To generate a bloom filter, you can use a library like <a href=\"https://www.npmjs.com/package/bloom-filters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>bloom-filters</code></a>.</li> <li>You should validate requests made to your Route Handler to prevent malicious requests.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/redirecting\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/redirecting</a>\n  </p>\n</div>\n","app/building-your-application/routing/dynamic-routes":"<h1 class=\"break-words\">Dynamic Routes</h1>\n<p>When you don't know the exact segment names ahead of time and want to create routes from dynamic data, you can use Dynamic Segments that are filled in at request time or <a href=\"#generating-static-params\">prerendered</a> at build time.</p> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>A Dynamic Segment can be created by wrapping a folder's name in square brackets: <code>[folderName]</code>. For example, <code>[id]</code> or <code>[slug]</code>.</p> <p>Dynamic Segments are passed as the <code>params</code> prop to <a href=\"../../api-reference/file-conventions/layout\"><code>layout</code></a>, <a href=\"../../api-reference/file-conventions/page\"><code>page</code></a>, <a href=\"route-handlers\"><code>route</code></a>, and <a href=\"../../api-reference/functions/generate-metadata#generatemetadata-function\"><code>generateMetadata</code></a> functions.</p> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <p>For example, a blog could include the following route <code>app/blog/[slug]/page.js</code> where <code>[slug]</code> is the Dynamic Segment for blog posts.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page({ params }: { params: { slug: string } }) {\n  return &lt;div&gt;My Post: {params.slug}&lt;/div&gt;\n}</pre></div>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>Example URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/blog/[slug]/page.js</code></td>\n<td><code>/blog/a</code></td>\n<td><code>{ slug: 'a' }</code></td>\n</tr>\n<tr>\n<td><code>app/blog/[slug]/page.js</code></td>\n<td><code>/blog/b</code></td>\n<td><code>{ slug: 'b' }</code></td>\n</tr>\n<tr>\n<td><code>app/blog/[slug]/page.js</code></td>\n<td><code>/blog/c</code></td>\n<td><code>{ slug: 'c' }</code></td>\n</tr>\n</tbody>\n</table></div> <p>See the <a href=\"#generating-static-params\">generateStaticParams()</a> page to learn how to generate the params for the segment.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Dynamic Segments are equivalent to <a href=\"dynamic-routes\">Dynamic Routes</a> in the <code>pages</code> directory.</p> </blockquote> <h2 id=\"generating-static-params\" data-docs-heading=\"\">Generating Static Params     </h2> <p>The <code>generateStaticParams</code> function can be used in combination with <a href=\"dynamic-routes\">dynamic route segments</a> to <a href=\"../rendering/server-components#static-rendering-default\"><strong>statically generate</strong></a> routes at build time instead of on-demand at request time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) =&gt; res.json())\n \n  return posts.map((post) =&gt; ({\n    slug: post.slug,\n  }))\n}</pre></div>  <p>The primary benefit of the <code>generateStaticParams</code> function is its smart retrieval of data. If content is fetched within the <code>generateStaticParams</code> function using a <code>fetch</code> request, the requests are <a href=\"../caching#request-memoization\">automatically memoized</a>. This means a <code>fetch</code> request with the same arguments across multiple <code>generateStaticParams</code>, Layouts, and Pages will only be made once, which decreases build times.</p> <p>Use the <a href=\"../upgrading/app-router-migration#dynamic-paths-getstaticpaths\">migration guide</a> if you are migrating from the <code>pages</code> directory.</p> <p>See <a href=\"../../api-reference/functions/generate-static-params\"><code>generateStaticParams</code> server function documentation</a> for more information and advanced use cases.</p> <h2 id=\"catch-all-segments\" data-docs-heading=\"\">Catch-all Segments     </h2> <p>Dynamic Segments can be extended to <strong>catch-all</strong> subsequent segments by adding an ellipsis inside the brackets <code>[...folderName]</code>.</p> <p>For example, <code>app/shop/[...slug]/page.js</code> will match <code>/shop/clothes</code>, but also <code>/shop/clothes/tops</code>, <code>/shop/clothes/tops/t-shirts</code>, and so on.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>Example URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/shop/[...slug]/page.js</code></td>\n<td><code>/shop/a</code></td>\n<td><code>{ slug: ['a'] }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/page.js</code></td>\n<td><code>/shop/a/b</code></td>\n<td><code>{ slug: ['a', 'b'] }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/page.js</code></td>\n<td><code>/shop/a/b/c</code></td>\n<td><code>{ slug: ['a', 'b', 'c'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"optional-catch-all-segments\" data-docs-heading=\"\">Optional Catch-all Segments     </h2> <p>Catch-all Segments can be made <strong>optional</strong> by including the parameter in double square brackets: <code>[[...folderName]]</code>.</p> <p>For example, <code>app/shop/[[...slug]]/page.js</code> will <strong>also</strong> match <code>/shop</code>, in addition to <code>/shop/clothes</code>, <code>/shop/clothes/tops</code>, <code>/shop/clothes/tops/t-shirts</code>.</p> <p>The difference between <strong>catch-all</strong> and <strong>optional catch-all</strong> segments is that with optional, the route without the parameter is also matched (<code>/shop</code> in the example above).</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>Example URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/shop/[[...slug]]/page.js</code></td>\n<td><code>/shop</code></td>\n<td><code>{}</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[[...slug]]/page.js</code></td>\n<td><code>/shop/a</code></td>\n<td><code>{ slug: ['a'] }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[[...slug]]/page.js</code></td>\n<td><code>/shop/a/b</code></td>\n<td><code>{ slug: ['a', 'b'] }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[[...slug]]/page.js</code></td>\n<td><code>/shop/a/b/c</code></td>\n<td><code>{ slug: ['a', 'b', 'c'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"typescript\" data-docs-heading=\"\">TypeScript     </h2> <p>When using TypeScript, you can add types for <code>params</code> depending on your configured route segment.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page({ params }: { params: { slug: string } }) {\n  return &lt;h1&gt;My Page&lt;/h1&gt;\n}</pre></div>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>\n<code>params</code> Type Definition</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/blog/[slug]/page.js</code></td>\n<td><code>{ slug: string }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/page.js</code></td>\n<td><code>{ slug: string[] }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[[...slug]]/page.js</code></td>\n<td><code>{ slug?: string[] }</code></td>\n</tr>\n<tr>\n<td><code>app/[categoryId]/[itemId]/page.js</code></td>\n<td><code>{ categoryId: string, itemId: string }</code></td>\n</tr>\n</tbody>\n</table></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This may be done automatically by the <a href=\"../configuring/typescript#typescript-plugin\">TypeScript plugin</a> in the future.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes</a>\n  </p>\n</div>\n","app/building-your-application/routing/parallel-routes":"<h1 class=\"break-words\">Parallel Routes</h1>\n<p>Parallel Routes allows you to simultaneously or conditionally render one or more pages within the same layout. They are useful for highly dynamic sections of an app, such as dashboards and feeds on social sites.</p> <p>For example, considering a dashboard, you can use parallel routes to simultaneously render the <code>team</code> and <code>analytics</code> pages:</p> <figure><img alt=\"Parallel Routes Diagram\" loading=\"lazy\" width=\"1600\" height=\"942\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fparallel-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes.png&amp;w=3840&amp;q=75\"><img alt=\"Parallel Routes Diagram\" loading=\"lazy\" width=\"1600\" height=\"942\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes.png&amp;w=3840&amp;q=75\"></figure> <h2 id=\"slots\" data-docs-heading=\"\">Slots     </h2> <p>Parallel routes are created using named <strong>slots</strong>. Slots are defined with the <code>@folder</code> convention. For example, the following file structure defines two slots: <code>@analytics</code> and <code>@team</code>:</p> <figure><img alt=\"Parallel Routes File-system Structure\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-file-system.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-file-system.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-file-system.png&amp;w=3840&amp;q=75\"><img alt=\"Parallel Routes File-system Structure\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-file-system.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-file-system.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-file-system.png&amp;w=3840&amp;q=75\"></figure> <p>Slots are passed as props to the shared parent layout. For the example above, the component in <code>app/layout.js</code> now accepts the <code>@analytics</code> and <code>@team</code> slots props, and can render them in parallel alongside the <code>children</code> prop:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Layout({\n  children,\n  team,\n  analytics,\n}: {\n  children: React.ReactNode\n  analytics: React.ReactNode\n  team: React.ReactNode\n}) {\n  return (\n    &lt;&gt;\n      {children}\n      {team}\n      {analytics}\n    &lt;/&gt;\n  )\n}</pre></div>  <p>However, slots are <strong>not</strong> <a href=\"../routing#route-segments\">route segments</a> and do not affect the URL structure. For example, for <code>/@analytics/views</code>, the URL will be <code>/views</code> since <code>@analytics</code> is a slot.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>The <code>children</code> prop is an implicit slot that does not need to be mapped to a folder. This means <code>app/page.js</code> is equivalent to <code>app/@children/page.js</code>.</li> </ul> </blockquote> <h2 id=\"active-state-and-navigation\" data-docs-heading=\"\">Active state and navigation     </h2> <p>By default, Next.js keeps track of the active <em>state</em> (or subpage) for each slot. However, the content rendered within a slot will depend on the type of navigation:</p> <ul> <li>\n<a href=\"linking-and-navigating#5-soft-navigation\"><strong>Soft Navigation</strong></a>: During client-side navigation, Next.js will perform a <a href=\"linking-and-navigating#4-partial-rendering\">partial render</a>, changing the subpage within the slot, while maintaining the other slot's active subpages, even if they don't match the current URL.</li> <li>\n<strong>Hard Navigation</strong>: After a full-page load (browser refresh), Next.js cannot determine the active state for the slots that don't match the current URL. Instead, it will render a <a href=\"#defaultjs\"><code>default.js</code></a> file for the unmatched slots, or <code>404</code> if <code>default.js</code> doesn't exist.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>The <code>404</code> for unmatched routes helps ensure that you don't accidentally render a parallel route on a page that it was not intended for.</li> </ul> </blockquote> <h3 id=\"defaultjs\" data-docs-heading=\"\">default.js     </h3> <p>You can define a <code>default.js</code> file to render as a fallback for unmatched slots during the initial load or full-page reload.</p> <p>Consider the following folder structure. The <code>@team</code> slot has a <code>/settings</code> page, but <code>@analytics</code> does not.</p> <figure><img alt=\"Parallel Routes unmatched routes\" loading=\"lazy\" width=\"1600\" height=\"930\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-unmatched-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-unmatched-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-unmatched-routes.png&amp;w=3840&amp;q=75\"><img alt=\"Parallel Routes unmatched routes\" loading=\"lazy\" width=\"1600\" height=\"930\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-unmatched-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-unmatched-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-unmatched-routes.png&amp;w=3840&amp;q=75\"></figure> <p>When navigating to <code>/settings</code>, the <code>@team</code> slot will render the <code>/settings</code> page while maintaining the currently active page for the <code>@analytics</code> slot.</p> <p>On refresh, Next.js will render a <code>default.js</code> for <code>@analytics</code>. If <code>default.js</code> doesn't exist, a <code>404</code> is rendered instead.</p> <p>Additionally, since <code>children</code> is an implicit slot, you also need to create a <code>default.js</code> file to render a fallback for <code>children</code> when Next.js cannot recover the active state of the parent page.</p> <h3 id=\"useselectedlayoutsegments\" data-docs-heading=\"\">useSelectedLayoutSegment(s)     </h3> <p>Both <a href=\"../../api-reference/functions/use-selected-layout-segment\"><code>useSelectedLayoutSegment</code></a> and <a href=\"../../api-reference/functions/use-selected-layout-segments\"><code>useSelectedLayoutSegments</code></a> accept a <code>parallelRoutesKey</code> parameter, which allows you to read the active route segment within a slot.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useSelectedLayoutSegment } from 'next/navigation'\n \nexport default function Layout({ auth }: { auth: React.ReactNode }) {\n  const loginSegment = useSelectedLayoutSegment('auth')\n  // ...\n}</pre></div>  <p>When a user navigates to <code>app/@auth/login</code> (or <code>/login</code> in the URL bar), <code>loginSegment</code> will be equal to the string <code>\"login\"</code>.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"conditional-routes\" data-docs-heading=\"\">Conditional Routes     </h3> <p>You can use Parallel Routes to conditionally render routes based on certain conditions, such as user role. For example, to render a different dashboard page for the <code>/admin</code> or <code>/user</code> roles:</p> <figure><img alt=\"Conditional routes diagram\" loading=\"lazy\" width=\"1600\" height=\"898\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fconditional-routes-ui.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fconditional-routes-ui.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fconditional-routes-ui.png&amp;w=3840&amp;q=75\"><img alt=\"Conditional routes diagram\" loading=\"lazy\" width=\"1600\" height=\"898\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fconditional-routes-ui.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fconditional-routes-ui.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fconditional-routes-ui.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { checkUserRole } from '@/lib/auth'\n \nexport default function Layout({\n  user,\n  admin,\n}: {\n  user: React.ReactNode\n  admin: React.ReactNode\n}) {\n  const role = checkUserRole()\n  return &lt;&gt;{role === 'admin' ? admin : user}&lt;/&gt;\n}</pre></div>  <h3 id=\"tab-groups\" data-docs-heading=\"\">Tab Groups     </h3> <p>You can add a <code>layout</code> inside a slot to allow users to navigate the slot independently. This is useful for creating tabs.</p> <p>For example, the <code>@analytics</code> slot has two subpages: <code>/page-views</code> and <code>/visitors</code>.</p> <figure><img alt=\"Analytics slot with two subpages and a layout\" loading=\"lazy\" width=\"1600\" height=\"768\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-tab-groups.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-tab-groups.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-tab-groups.png&amp;w=3840&amp;q=75\"><img alt=\"Analytics slot with two subpages and a layout\" loading=\"lazy\" width=\"1600\" height=\"768\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-tab-groups.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-tab-groups.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-tab-groups.png&amp;w=3840&amp;q=75\"></figure> <p>Within <code>@analytics</code>, create a <a href=\"pages-and-layouts\"><code>layout</code></a> file to share the tabs between the two pages:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    &lt;&gt;\n      &lt;nav&gt;\n        &lt;Link href=\"/page-views\"&gt;Page Views&lt;/Link&gt;\n        &lt;Link href=\"/visitors\"&gt;Visitors&lt;/Link&gt;\n      &lt;/nav&gt;\n      &lt;div&gt;{children}&lt;/div&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"modals\" data-docs-heading=\"\">Modals     </h3> <p>Parallel Routes can be used together with <a href=\"intercepting-routes\">Intercepting Routes</a> to create modals. This allows you to solve common challenges when building modals, such as:</p> <ul> <li>Making the modal content <strong>shareable through a URL</strong>.</li> <li>\n<strong>Preserving context</strong> when the page is refreshed, instead of closing the modal.</li> <li>\n<strong>Closing the modal on backwards navigation</strong> rather than going to the previous route.</li> <li>\n<strong>Reopening the modal on forwards navigation</strong>.</li> </ul> <p>Consider the following UI pattern, where a user can open a login modal from a layout using client-side navigation, or access a separate <code>/login</code> page:</p> <figure><img alt=\"Parallel Routes Diagram\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-auth-modal.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-auth-modal.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-auth-modal.png&amp;w=3840&amp;q=75\"><img alt=\"Parallel Routes Diagram\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-auth-modal.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-auth-modal.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-auth-modal.png&amp;w=3840&amp;q=75\"></figure> <p>To implement this pattern, start by creating a <code>/login</code> route that renders your <strong>main</strong> login page.</p> <figure><img alt=\"Parallel Routes Diagram\" loading=\"lazy\" width=\"1600\" height=\"768\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-modal-login-page.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-modal-login-page.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-modal-login-page.png&amp;w=3840&amp;q=75\"><img alt=\"Parallel Routes Diagram\" loading=\"lazy\" width=\"1600\" height=\"768\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-modal-login-page.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-modal-login-page.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-modal-login-page.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Login } from '@/app/ui/login'\n \nexport default function Page() {\n  return &lt;Login /&gt;\n}</pre></div>  <p>Then, inside the <code>@auth</code> slot, add <a href=\"../../api-reference/file-conventions/default\"><code>default.js</code></a> file that returns <code>null</code>. This ensures that the modal is not rendered when it's not active.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Default() {\n  return null\n}</pre></div>  <p>Inside your <code>@auth</code> slot, intercept the <code>/login</code> route by updating the <code>/(.)login</code> folder. Import the <code>&lt;Modal&gt;</code> component and its children into the <code>/(.)login/page.tsx</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Modal } from '@/app/ui/modal'\nimport { Login } from '@/app/ui/login'\n \nexport default function Page() {\n  return (\n    &lt;Modal&gt;\n      &lt;Login /&gt;\n    &lt;/Modal&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>The convention used to intercept the route, e.g. <code>(.)</code>, depends on your file-system structure. See <a href=\"intercepting-routes#convention\">Intercepting Routes convention</a>.</li> <li>By separating the <code>&lt;Modal&gt;</code> functionality from the modal content (<code>&lt;Login&gt;</code>), you can ensure any content inside the modal, e.g. <a href=\"../data-fetching/server-actions-and-mutations#forms\">forms</a>, are Server Components. See <a href=\"../rendering/composition-patterns#supported-pattern-passing-server-components-to-client-components-as-props\">Interleaving Client and Server Components</a> for more information.</li> </ul> </blockquote> <h4 id=\"opening-the-modal\" data-docs-heading=\"\">Opening the modal     </h4> <p>Now, you can leverage the Next.js router to open and close the modal. This ensures the URL is correctly updated when the modal is open, and when navigating backwards and forwards.</p> <p>To open the modal, pass the <code>@auth</code> slot as a prop to the parent layout and render it alongside the <code>children</code> prop.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Layout({\n  auth,\n  children,\n}: {\n  auth: React.ReactNode\n  children: React.ReactNode\n}) {\n  return (\n    &lt;&gt;\n      &lt;nav&gt;\n        &lt;Link href=\"/login\"&gt;Open modal&lt;/Link&gt;\n      &lt;/nav&gt;\n      &lt;div&gt;{auth}&lt;/div&gt;\n      &lt;div&gt;{children}&lt;/div&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>When the user clicks the <code>&lt;Link&gt;</code>, the modal will open instead of navigating to the <code>/login</code> page. However, on refresh or initial load, navigating to <code>/login</code> will take the user to the main login page.</p> <h4 id=\"closing-the-modal\" data-docs-heading=\"\">Closing the modal     </h4> <p>You can close the modal by calling <code>router.back()</code> or by using the <code>Link</code> component.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useRouter } from 'next/navigation'\n \nexport function Modal({ children }: { children: React.ReactNode }) {\n  const router = useRouter()\n \n  return (\n    &lt;&gt;\n      &lt;button\n        onClick={() =&gt; {\n          router.back()\n        }}\n      &gt;\n        Close modal\n      &lt;/button&gt;\n      &lt;div&gt;{children}&lt;/div&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>When using the <code>Link</code> component to navigate away from a page that shouldn't render the <code>@auth</code> slot anymore, we use a catch-all route that returns <code>null</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport function Modal({ children }: { children: React.ReactNode }) {\n  return (\n    &lt;&gt;\n      &lt;Link href=\"/\"&gt;Close modal&lt;/Link&gt;\n      &lt;div&gt;{children}&lt;/div&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function CatchAll() {\n  return null\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>We use a catch-all route in our <code>@auth</code> slot to close the modal because of the behavior described in <a href=\"#active-state-and-navigation\">Active state and navigation</a>. Since client-side navigations to a route that no longer match the slot will remain visible, we need to match the slot to a route that returns <code>null</code> to close the modal.</li> <li>Other examples could include opening a photo modal in a gallery while also having a dedicated <code>/photo/[id]</code> page, or opening a shopping cart in a side modal.</li> <li>\n<a href=\"https://github.com/vercel-labs/nextgram\" rel=\"noopener noreferrer\" target=\"_blank\">View an example</a> of modals with Intercepted and Parallel Routes.</li> </ul> </blockquote> <h3 id=\"loading-and-error-ui\" data-docs-heading=\"\">Loading and Error UI     </h3> <p>Parallel Routes can be streamed independently, allowing you to define independent error and loading states for each route:</p> <figure><img alt=\"Parallel routes enable custom error and loading states\" loading=\"lazy\" width=\"1600\" height=\"1218\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-cinematic-universe.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-cinematic-universe.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-cinematic-universe.png&amp;w=3840&amp;q=75\"><img alt=\"Parallel routes enable custom error and loading states\" loading=\"lazy\" width=\"1600\" height=\"1218\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-cinematic-universe.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-cinematic-universe.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-cinematic-universe.png&amp;w=3840&amp;q=75\"></figure> <p>See the <a href=\"loading-ui-and-streaming\">Loading UI</a> and <a href=\"error-handling\">Error Handling</a> documentation for more information.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/parallel-routes\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/parallel-routes</a>\n  </p>\n</div>\n","app/building-your-application/data-fetching/fetching-caching-and-revalidating":"<h1 class=\"break-words\">Data Fetching, Caching, and Revalidating</h1>\n<p>Data fetching is a core part of any application. This page goes through how you can fetch, cache, and revalidate data in React and Next.js.</p> <p>There are four ways you can fetch data:</p> <ol> <li><a href=\"#fetching-data-on-the-server-with-fetch\">On the server, with <code>fetch</code></a></li> <li><a href=\"#fetching-data-on-the-server-with-third-party-libraries\">On the server, with third-party libraries</a></li> <li><a href=\"#fetching-data-on-the-client-with-route-handlers\">On the client, via a Route Handler</a></li> <li>\n<a href=\"#fetching-data-on-the-client-with-route-handlers\">On the client, with third-party libraries</a>.</li> </ol> <h2 id=\"fetching-data-on-the-server-with-fetch\" data-docs-heading=\"\">Fetching Data on the Server with fetch     </h2> <p>Next.js extends the native <a href=\"https://developer.mozilla.org/docs/Web/API/Fetch_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>fetch</code> Web API</a> to allow you to configure the <a href=\"#caching-data\">caching</a> and <a href=\"#revalidating-data\">revalidating</a> behavior for each fetch request on the server. React extends <code>fetch</code> to automatically <a href=\"patterns#fetching-data-where-its-needed\">memoize</a> fetch requests while rendering a React component tree.</p> <p>You can use <code>fetch</code> with <code>async</code>/<code>await</code> in Server Components, in <a href=\"../routing/route-handlers\">Route Handlers</a>, and in <a href=\"server-actions-and-mutations\">Server Actions</a>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">async function getData() {\n  const res = await fetch('https://api.example.com/...')\n  // The return value is *not* serialized\n  // You can return Date, Map, Set, etc.\n \n  if (!res.ok) {\n    // This will activate the closest `error.js` Error Boundary\n    throw new Error('Failed to fetch data')\n  }\n \n  return res.json()\n}\n \nexport default async function Page() {\n  const data = await getData()\n \n  return &lt;main&gt;&lt;/main&gt;\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Next.js provides helpful functions you may need when fetching data in Server Components such as <a href=\"../../api-reference/functions/cookies\"><code>cookies</code></a> and <a href=\"../../api-reference/functions/headers\"><code>headers</code></a>. These will cause the route to be dynamically rendered as they rely on request time information.</li> <li>In Route handlers, <code>fetch</code> requests are not memoized as Route Handlers are not part of the React component tree.</li> <li>In <a href=\"server-actions-and-mutations\">Server Actions</a>, <code>fetch</code> requests are not cached (defaults <code>cache: no-store</code>).</li> <li>To use <code>async</code>/<code>await</code> in a Server Component with TypeScript, you'll need to use TypeScript <code>5.1.3</code> or higher and <code>@types/react</code> <code>18.2.8</code> or higher.</li> </ul> </blockquote> <h3 id=\"caching-data\" data-docs-heading=\"\">Caching Data     </h3> <p>Caching stores data so it doesn't need to be re-fetched from your data source on every request.</p> <p>By default, Next.js automatically caches the returned values of <code>fetch</code> in the <a href=\"../caching#data-cache\">Data Cache</a> on the server. This means that the data can be fetched at build time or request time, cached, and reused on each data request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// 'force-cache' is the default, and can be omitted\nfetch('https://...', { cache: 'force-cache' })</pre>\n</div> <p>However, there are exceptions, <code>fetch</code> requests are not cached when:</p> <ul> <li>Used inside a <a href=\"server-actions-and-mutations\">Server Action</a>.</li> <li>Used inside a <a href=\"../routing/route-handlers\">Route Handler</a> that uses the <code>POST</code> method.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>What is the Data Cache?</strong></p> <p>The Data Cache is a persistent <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Caching\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP cache</a>. Depending on your platform, the cache can scale automatically and be <a href=\"https://vercel.com/docs/infrastructure/data-cache\" rel=\"noopener noreferrer\" target=\"_blank\">shared across multiple regions</a>.</p> <p>Learn more about the <a href=\"../caching#data-cache\">Data Cache</a>.</p> </blockquote> <h3 id=\"revalidating-data\" data-docs-heading=\"\">Revalidating Data     </h3> <p>Revalidation is the process of purging the Data Cache and re-fetching the latest data. This is useful when your data changes and you want to ensure you show the latest information.</p> <p>Cached data can be revalidated in two ways:</p> <ul> <li>\n<strong>Time-based revalidation</strong>: Automatically revalidate data after a certain amount of time has passed. This is useful for data that changes infrequently and freshness is not as critical.</li> <li>\n<strong>On-demand revalidation</strong>: Manually revalidate data based on an event (e.g. form submission). On-demand revalidation can use a tag-based or path-based approach to revalidate groups of data at once. This is useful when you want to ensure the latest data is shown as soon as possible (e.g. when content from your headless CMS is updated).</li> </ul> <h4 id=\"time-based-revalidation\" data-docs-heading=\"\">Time-based Revalidation     </h4> <p>To revalidate data at a timed interval, you can use the <code>next.revalidate</code> option of <code>fetch</code> to set the cache lifetime of a resource (in seconds).</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">fetch('https://...', { next: { revalidate: 3600 } })</pre>\n</div> <p>Alternatively, to revalidate all <code>fetch</code> requests in a route segment, you can use the <a href=\"../../api-reference/file-conventions/route-segment-config\">Segment Config Options</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const revalidate = 3600 // revalidate at most every hour</pre></div> <p>If you have multiple fetch requests in a statically rendered route, and each has a different revalidation frequency. The lowest time will be used for all requests. For dynamically rendered routes, each <code>fetch</code> request will be revalidated independently.</p> <p>Learn more about <a href=\"../caching#time-based-revalidation\">time-based revalidation</a>.</p> <h4 id=\"on-demand-revalidation\" data-docs-heading=\"\">On-demand Revalidation     </h4> <p>Data can be revalidated on-demand by path (<a href=\"../../api-reference/functions/revalidatepath\"><code>revalidatePath</code></a>) or by cache tag (<a href=\"../../api-reference/functions/revalidatetag\"><code>revalidateTag</code></a>) inside a <a href=\"server-actions-and-mutations\">Server Action</a> or <a href=\"../routing/route-handlers\">Route Handler</a>.</p> <p>Next.js has a cache tagging system for invalidating <code>fetch</code> requests across routes.</p> <ol> <li>When using <code>fetch</code>, you have the option to tag cache entries with one or more tags.</li> <li>Then, you can call <code>revalidateTag</code> to revalidate all entries associated with that tag.</li> </ol> <p>For example, the following <code>fetch</code> request adds the cache tag <code>collection</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function Page() {\n  const res = await fetch('https://...', { next: { tags: ['collection'] } })\n  const data = await res.json()\n  // ...\n}</pre></div>  <p>You can then revalidate this <code>fetch</code> call tagged with <code>collection</code> by calling <code>revalidateTag</code> in a Server Action:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { revalidateTag } from 'next/cache'\n \nexport default async function action() {\n  revalidateTag('collection')\n}</pre></div>  <p>Learn more about <a href=\"../caching#on-demand-revalidation\">on-demand revalidation</a>.</p> <h4 id=\"error-handling-and-revalidation\" data-docs-heading=\"\">Error handling and revalidation     </h4> <p>If an error is thrown while attempting to revalidate data, the last successfully generated data will continue to be served from the cache. On the next subsequent request, Next.js will retry revalidating the data.</p> <h3 id=\"opting-out-of-data-caching\" data-docs-heading=\"\">Opting out of Data Caching     </h3> <p><code>fetch</code> requests are <strong>not</strong> cached if:</p> <ul> <li>The <code>cache: 'no-store'</code> is added to <code>fetch</code> requests.</li> <li>The <code>revalidate: 0</code> option is added to individual <code>fetch</code> requests.</li> <li>The <code>fetch</code> request is inside a Router Handler that uses the <code>POST</code> method.</li> <li>The <code>fetch</code> request comes after the usage of <code>headers</code> or <code>cookies</code>.</li> <li>The <code>const dynamic = 'force-dynamic'</code> route segment option is used.</li> <li>The <code>fetchCache</code> route segment option is configured to skip cache by default.</li> <li>The <code>fetch</code> request uses <code>Authorization</code> or <code>Cookie</code> headers and there's an uncached request above it in the component tree.</li> </ul> <h4 id=\"individual-fetch-requests\" data-docs-heading=\"\">Individual fetch Requests     </h4> <p>To opt out of caching for individual <code>fetch</code> requests, you can set the <code>cache</code> option in <code>fetch</code> to <code>'no-store'</code>. This will fetch data dynamically, on every request.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">fetch('https://...', { cache: 'no-store' })</pre></div> <p>View all the available <code>cache</code> options in the <a href=\"../../api-reference/functions/fetch\"><code>fetch</code> API reference</a>.</p> <h4 id=\"multiple-fetch-requests\" data-docs-heading=\"\">Multiple fetch Requests     </h4> <p>If you have multiple <code>fetch</code> requests in a route segment (e.g. a Layout or Page), you can configure the caching behavior of all data requests in the segment using the <a href=\"../../api-reference/file-conventions/route-segment-config\">Segment Config Options</a>.</p> <p>However, we recommend configuring the caching behavior of each <code>fetch</code> request individually. This gives you more granular control over the caching behavior.</p> <h2 id=\"fetching-data-on-the-server-with-third-party-libraries\" data-docs-heading=\"\">Fetching data on the Server with third-party libraries     </h2> <p>In cases where you're using a third-party library that doesn't support or expose <code>fetch</code> (for example, a database, CMS, or ORM client), you can configure the caching and revalidating behavior of those requests using the <a href=\"../../api-reference/file-conventions/route-segment-config\">Route Segment Config Option</a> and React's <code>cache</code> function.</p> <p>Whether the data is cached or not will depend on whether the route segment is <a href=\"../rendering/server-components#server-rendering-strategies\">statically or dynamically rendered</a>. If the segment is static (default), the output of the request will be cached and revalidated as part of the route segment. If the segment is dynamic, the output of the request will <em>not</em> be cached and will be re-fetched on every request when the segment is rendered.</p> <p>You can also use the experimental <a href=\"../../api-reference/functions/unstable_cache\"><code>unstable_cache</code> API</a>.</p> <h3 id=\"example\" data-docs-heading=\"\">Example     </h3> <p>In the example below:</p> <ul> <li>The React <code>cache</code> function is used to <a href=\"../caching#request-memoization\">memoize</a> data requests.</li> <li>The <code>revalidate</code> option is set to <code>3600</code> in the Layout and Page segments, meaning the data will be cached and revalidated at most every hour.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cache } from 'react'\n \nexport const getItem = cache(async (id: string) =&gt; {\n  const item = await db.item.findUnique({ id })\n  return item\n})</pre></div>  <p>Although the <code>getItem</code> function is called twice, only one query will be made to the database.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getItem } from '@/utils/get-item'\n \nexport const revalidate = 3600 // revalidate the data at most every hour\n \nexport default async function Layout({\n  params: { id },\n}: {\n  params: { id: string }\n}) {\n  const item = await getItem(id)\n  // ...\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getItem } from '@/utils/get-item'\n \nexport const revalidate = 3600 // revalidate the data at most every hour\n \nexport default async function Page({\n  params: { id },\n}: {\n  params: { id: string }\n}) {\n  const item = await getItem(id)\n  // ...\n}</pre></div>  <h2 id=\"fetching-data-on-the-client-with-route-handlers\" data-docs-heading=\"\">Fetching Data on the Client with Route Handlers     </h2> <p>If you need to fetch data in a client component, you can call a <a href=\"../routing/route-handlers\">Route Handler</a> from the client. Route Handlers execute on the server and return the data to the client. This is useful when you don't want to expose sensitive information to the client, such as API tokens.</p> <p>See the <a href=\"../routing/route-handlers\">Route Handler</a> documentation for examples.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Server Components and Route Handlers</strong></p> <p>Since Server Components render on the server, you don't need to call a Route Handler from a Server Component to fetch data. Instead, you can fetch the data directly inside the Server Component.</p> </blockquote> <h2 id=\"fetching-data-on-the-client-with-third-party-libraries\" data-docs-heading=\"\">Fetching Data on the Client with third-party libraries     </h2> <p>You can also fetch data on the client using a third-party library such as <a href=\"https://swr.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SWR</a> or <a href=\"https://tanstack.com/query/latest\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">TanStack Query</a>. These libraries provide their own APIs for memoizing requests, caching, revalidating, and mutating data.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Future APIs</strong>:</p> <p><code>use</code> is a React function that <strong>accepts and handles a promise</strong> returned by a function. Wrapping <code>fetch</code> in <code>use</code> is currently <strong>not</strong> recommended in Client Components and may trigger multiple re-renders. Learn more about <code>use</code> in the <a href=\"https://react.dev/reference/react/use\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React docs</a>.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating</a>\n  </p>\n</div>\n","app/building-your-application/rendering":"<h1 class=\"break-words\">Rendering</h1>\n<p>Rendering converts the code you write into user interfaces. React and Next.js allow you to create hybrid web applications where parts of your code can be rendered on the server or the client. This section will help you understand the differences between these rendering environments, strategies, and runtimes.</p> <h2 id=\"fundamentals\" data-docs-heading=\"\">Fundamentals     </h2> <p>To start, it's helpful to be familiar with three foundational web concepts:</p> <ul> <li>The <a href=\"#rendering-environments\">Environments</a> your application code can be executed in: the server and the client.</li> <li>The <a href=\"#request-response-lifecycle\">Request-Response Lifecycle</a> that's initiated when a user visits or interacts with your application.</li> <li>The <a href=\"#network-boundary\">Network Boundary</a> that separates server and client code.</li> </ul> <h3 id=\"rendering-environments\" data-docs-heading=\"\">Rendering Environments     </h3> <p>There are two environments where web applications can be rendered: the client and the server.</p> <figure><img alt=\"Client and Server Environments\" loading=\"lazy\" width=\"1600\" height=\"672\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fclient-and-server-environments.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fclient-and-server-environments.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fclient-and-server-environments.png&amp;w=3840&amp;q=75\"><img alt=\"Client and Server Environments\" loading=\"lazy\" width=\"1600\" height=\"672\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fclient-and-server-environments.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fclient-and-server-environments.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fclient-and-server-environments.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>The <strong>client</strong> refers to the browser on a user's device that sends a request to a server for your application code. It then turns the response from the server into a user interface.</li> <li>The <strong>server</strong> refers to the computer in a data center that stores your application code, receives requests from a client, and sends back an appropriate response.</li> </ul> <p>Historically, developers had to use different languages (e.g. JavaScript, PHP) and frameworks when writing code for the server and the client. With React, developers can use the <strong>same language</strong> (JavaScript), and the <strong>same framework</strong> (e.g. Next.js or your framework of choice). This flexibility allows you to seamlessly write code for both environments without context switching.</p> <p>However, each environment has its own set of capabilities and constraints. Therefore, the code you write for the server and the client is not always the same. There are certain operations (e.g. data fetching or managing user state) that are better suited for one environment over the other.</p> <p>Understanding these differences is key to effectively using React and Next.js. We'll cover the differences and use cases in more detail on the <a href=\"rendering/server-components\">Server</a> and <a href=\"rendering/client-components\">Client</a> Components pages, for now, let's continue building on our foundation.</p> <h3 id=\"request-response-lifecycle\" data-docs-heading=\"\">Request-Response Lifecycle     </h3> <p>Broadly speaking, all websites follow the same <strong>Request-Response Lifecycle</strong>:</p> <ol> <li>\n<strong>User Action:</strong> The user interacts with a web application. This could be clicking a link, submitting a form, or typing a URL directly into the browser's address bar.</li> <li>\n<strong>HTTP Request:</strong> The client sends an <a href=\"https://developer.mozilla.org/docs/Web/HTTP\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP</a> request to the server that contains necessary information about what resources are being requested, what method is being used (e.g. <code>GET</code>, <code>POST</code>), and additional data if necessary.</li> <li>\n<strong>Server:</strong> The server processes the request and responds with the appropriate resources. This process may take a couple of steps like routing, fetching data, etc.</li> <li>\n<strong>HTTP Response:</strong> After processing the request, the server sends an HTTP response back to the client. This response contains a status code (which tells the client whether the request was successful or not) and requested resources (e.g. HTML, CSS, JavaScript, static assets, etc).</li> <li>\n<strong>Client:</strong> The client parses the resources to render the user interface.</li> <li>\n<strong>User Action:</strong> Once the user interface is rendered, the user can interact with it, and the whole process starts again.</li> </ol> <p>A major part of building a hybrid web application is deciding how to split the work in the lifecycle, and where to place the Network Boundary.</p> <h3 id=\"network-boundary\" data-docs-heading=\"\">Network Boundary     </h3> <p>In web development, the <strong>Network Boundary</strong> is a conceptual line that separates the different environments. For example, the client and the server, or the server and the data store.</p>  <p>In React, you choose where to place the client-server network boundary wherever it makes the most sense.</p> <p>Behind the scenes, the work is split into two parts: the <strong>client module graph</strong> and the <strong>server module graph</strong>. The server module graph contains all the components that are rendered on the server, and the client module graph contains all components that are rendered on the client.</p>  <p>It may be helpful to think about module graphs as a visual representation of how files in your application depend on each other.</p>  <p>You can use the React <code>\"use client\"</code> convention to define the boundary. There's also a <code>\"use server\"</code> convention, which tells React to do some computational work on the server.</p> <h2 id=\"building-hybrid-applications\" data-docs-heading=\"\">Building Hybrid Applications     </h2> <p>When working in these environments, it's helpful to think of the flow of the code in your application as <strong>unidirectional</strong>. In other words, during a response, your application code flows in one direction: from the server to the client.</p>  <p>If you need to access the server from the client, you send a <strong>new</strong> request to the server rather than re-use the same request. This makes it easier to understand where to render your components and where to place the Network Boundary.</p> <p>In practice, this model encourages developers to think about what they want to execute on the server first, before sending the result to the client and making the application interactive.</p> <p>This concept will become clearer when we look at how you can <a href=\"rendering/composition-patterns\">interleave client and server components</a> in the same component tree.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/rendering\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/rendering</a>\n  </p>\n</div>\n","app/building-your-application/routing/linking-and-navigating":"<h1 class=\"break-words\">Linking and Navigating</h1>\n<p>There are four ways to navigate between routes in Next.js:</p> <ul> <li>Using the <a href=\"#link-component\"><code>&lt;Link&gt;</code> Component</a>\n</li> <li>Using the <a href=\"#userouter-hook\"><code>useRouter</code> hook</a> (<a href=\"../rendering/client-components\">Client Components</a>)</li> <li>Using the <a href=\"#redirect-function\"><code>redirect</code> function</a> (<a href=\"../rendering/server-components\">Server Components</a>)</li> <li>Using the native <a href=\"#using-the-native-history-api\">History API</a>\n</li> </ul> <p>This page will go through how to use each of these options, and dive deeper into how navigation works.</p> <h2 id=\"link-component\" data-docs-heading=\"\">&lt;Link&gt; Component     </h2> <p><code>&lt;Link&gt;</code> is a built-in component that extends the HTML <code>&lt;a&gt;</code> tag to provide <a href=\"#2-prefetching\">prefetching</a> and client-side navigation between routes. It is the primary and recommended way to navigate between routes in Next.js.</p> <p>You can use it by importing it from <code>next/link</code>, and passing a <code>href</code> prop to the component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return &lt;Link href=\"/dashboard\"&gt;Dashboard&lt;/Link&gt;\n}</pre></div>  <p>There are other optional props you can pass to <code>&lt;Link&gt;</code>. See the <a href=\"../../api-reference/components/link\">API reference</a> for more.</p> <h3 id=\"examples\" data-docs-heading=\"\">Examples     </h3> <h4 id=\"linking-to-dynamic-segments\" data-docs-heading=\"\">Linking to Dynamic Segments     </h4> <p>When linking to <a href=\"dynamic-routes\">dynamic segments</a>, you can use <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Template_literals\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">template literals and interpolation</a> to generate a list of links. For example, to generate a list of blog posts:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function PostList({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li key={post.id}&gt;\n          &lt;Link href={`/blog/${post.slug}`}&gt;{post.title}&lt;/Link&gt;\n        &lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}</pre></div> <h4 id=\"checking-active-links\" data-docs-heading=\"\">Checking Active Links     </h4> <p>You can use <a href=\"../../api-reference/functions/use-pathname\"><code>usePathname()</code></a> to determine if a link is active. For example, to add a class to the active link, you can check if the current <code>pathname</code> matches the <code>href</code> of the link:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { usePathname } from 'next/navigation'\nimport Link from 'next/link'\n \nexport function Links() {\n  const pathname = usePathname()\n \n  return (\n    &lt;nav&gt;\n      &lt;ul&gt;\n        &lt;li&gt;\n          &lt;Link className={`link ${pathname === '/' ? 'active' : ''}`} href=\"/\"&gt;\n            Home\n          &lt;/Link&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n          &lt;Link\n            className={`link ${pathname === '/about' ? 'active' : ''}`}\n            href=\"/about\"\n          &gt;\n            About\n          &lt;/Link&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/nav&gt;\n  )\n}</pre></div>  <h4 id=\"scrolling-to-an-id\" data-docs-heading=\"\">Scrolling to an id     </h4> <p>The default behavior of the Next.js App Router is to <strong>scroll to the top of a new route or to maintain the scroll position for backwards and forwards navigation.</strong></p> <p>If you'd like to scroll to a specific <code>id</code> on navigation, you can append your URL with a <code>#</code> hash link or just pass a hash link to the <code>href</code> prop. This is possible since <code>&lt;Link&gt;</code> renders to an <code>&lt;a&gt;</code> element.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/dashboard#settings\"&gt;Settings&lt;/Link&gt;\n \n// Output\n&lt;a href=\"/dashboard#settings\"&gt;Settings&lt;/a&gt;</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Next.js will scroll to the <a href=\"pages-and-layouts#pages\">Page</a> if it is not visible in the viewport upon navigation.</li> </ul> </blockquote> <h4 id=\"disabling-scroll-restoration\" data-docs-heading=\"\">Disabling scroll restoration     </h4> <p>The default behavior of the Next.js App Router is to <strong>scroll to the top of a new route or to maintain the scroll position for backwards and forwards navigation.</strong> If you'd like to disable this behavior, you can pass <code>scroll={false}</code> to the <code>&lt;Link&gt;</code> component, or <code>scroll: false</code> to <code>router.push()</code> or <code>router.replace()</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// next/link\n&lt;Link href=\"/dashboard\" scroll={false}&gt;\n  Dashboard\n&lt;/Link&gt;</pre>\n</div> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// useRouter\nimport { useRouter } from 'next/navigation'\n \nconst router = useRouter()\n \nrouter.push('/dashboard', { scroll: false })</pre>\n</div> <h2 id=\"userouter-hook\" data-docs-heading=\"\">useRouter() hook     </h2> <p>The <code>useRouter</code> hook allows you to programmatically change routes from <a href=\"../rendering/client-components\">Client Components</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useRouter } from 'next/navigation'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.push('/dashboard')}&gt;\n      Dashboard\n    &lt;/button&gt;\n  )\n}</pre></div> <p>For a full list of <code>useRouter</code> methods, see the <a href=\"../../api-reference/functions/use-router\">API reference</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation:</strong> Use the <code>&lt;Link&gt;</code> component to navigate between routes unless you have a specific requirement for using <code>useRouter</code>.</p> </blockquote> <h2 id=\"redirect-function\" data-docs-heading=\"\">redirect function     </h2> <p>For <a href=\"../rendering/server-components\">Server Components</a>, use the <code>redirect</code> function instead.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { redirect } from 'next/navigation'\n \nasync function fetchTeam(id: string) {\n  const res = await fetch('https://...')\n  if (!res.ok) return undefined\n  return res.json()\n}\n \nexport default async function Profile({ params }: { params: { id: string } }) {\n  const team = await fetchTeam(params.id)\n  if (!team) {\n    redirect('/login')\n  }\n \n  // ...\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>redirect</code> returns a 307 (Temporary Redirect) status code by default. When used in a Server Action, it returns a 303 (See Other), which is commonly used for redirecting to a success page as a result of a POST request.</li> <li>\n<code>redirect</code> internally throws an error so it should be called outside of <code>try/catch</code> blocks.</li> <li>\n<code>redirect</code> can be called in Client Components during the rendering process but not in event handlers. You can use the <a href=\"#userouter-hook\"><code>useRouter</code> hook</a> instead.</li> <li>\n<code>redirect</code> also accepts absolute URLs and can be used to redirect to external links.</li> <li>If you'd like to redirect before the render process, use <a href=\"redirecting#redirects-in-nextconfigjs\"><code>next.config.js</code></a> or <a href=\"redirecting#nextresponseredirect-in-middleware\">Middleware</a>.</li> </ul> </blockquote> <p>See the <a href=\"../../api-reference/functions/redirect\"><code>redirect</code> API reference</a> for more information.</p> <h2 id=\"using-the-native-history-api\" data-docs-heading=\"\">Using the native History API     </h2> <p>Next.js allows you to use the native <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/History/pushState\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>window.history.pushState</code></a> and <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>window.history.replaceState</code></a> methods to update the browser's history stack without reloading the page.</p> <p><code>pushState</code> and <code>replaceState</code> calls integrate into the Next.js Router, allowing you to sync with <a href=\"../../api-reference/functions/use-pathname\"><code>usePathname</code></a> and <a href=\"../../api-reference/functions/use-search-params\"><code>useSearchParams</code></a>.</p> <h3 id=\"windowhistorypushstate\" data-docs-heading=\"\">window.history.pushState     </h3> <p>Use it to add a new entry to the browser's history stack. The user can navigate back to the previous state. For example, to sort a list of products:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useSearchParams } from 'next/navigation'\n \nexport default function SortProducts() {\n  const searchParams = useSearchParams()\n \n  function updateSorting(sortOrder: string) {\n    const params = new URLSearchParams(searchParams.toString())\n    params.set('sort', sortOrder)\n    window.history.pushState(null, '', `?${params.toString()}`)\n  }\n \n  return (\n    &lt;&gt;\n      &lt;button onClick={() =&gt; updateSorting('asc')}&gt;Sort Ascending&lt;/button&gt;\n      &lt;button onClick={() =&gt; updateSorting('desc')}&gt;Sort Descending&lt;/button&gt;\n    &lt;/&gt;\n  )\n}</pre>\n</div>  <h3 id=\"windowhistoryreplacestate\" data-docs-heading=\"\">window.history.replaceState     </h3> <p>Use it to replace the current entry on the browser's history stack. The user is not able to navigate back to the previous state. For example, to switch the application's locale:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { usePathname } from 'next/navigation'\n \nexport function LocaleSwitcher() {\n  const pathname = usePathname()\n \n  function switchLocale(locale: string) {\n    // e.g. '/en/about' or '/fr/contact'\n    const newPath = `/${locale}${pathname}`\n    window.history.replaceState(null, '', newPath)\n  }\n \n  return (\n    &lt;&gt;\n      &lt;button onClick={() =&gt; switchLocale('en')}&gt;English&lt;/button&gt;\n      &lt;button onClick={() =&gt; switchLocale('fr')}&gt;French&lt;/button&gt;\n    &lt;/&gt;\n  )\n}</pre>\n</div>  <h2 id=\"how-routing-and-navigation-works\" data-docs-heading=\"\">How Routing and Navigation Works     </h2> <p>The App Router uses a hybrid approach for routing and navigation. On the server, your application code is automatically <a href=\"#1-code-splitting\">code-split</a> by route segments. And on the client, Next.js <a href=\"#2-prefetching\">prefetches</a> and <a href=\"#3-caching\">caches</a> the route segments. This means, when a user navigates to a new route, the browser doesn't reload the page, and only the route segments that change re-render - improving the navigation experience and performance.</p> <h3 id=\"1-code-splitting\" data-docs-heading=\"\">1. Code Splitting     </h3> <p>Code splitting allows you to split your application code into smaller bundles to be downloaded and executed by the browser. This reduces the amount of data transferred and execution time for each request, leading to improved performance.</p> <p><a href=\"../rendering/server-components\">Server Components</a> allow your application code to be automatically code-split by route segments. This means only the code needed for the current route is loaded on navigation.</p> <h3 id=\"2-prefetching\" data-docs-heading=\"\">2. Prefetching     </h3> <p>Prefetching is a way to preload a route in the background before the user visits it.</p> <p>There are two ways routes are prefetched in Next.js:</p> <ul> <li>\n<strong><code>&lt;Link&gt;</code> component</strong>: Routes are automatically prefetched as they become visible in the user's viewport. Prefetching happens when the page first loads or when it comes into view through scrolling.</li> <li>\n<strong><code>router.prefetch()</code></strong>: The <code>useRouter</code> hook can be used to prefetch routes programmatically.</li> </ul> <p>The <code>&lt;Link&gt;</code>'s default prefetching behavior (i.e. when the <code>prefetch</code> prop is left unspecified or set to <code>null</code>) is different depending on your usage of <a href=\"../../api-reference/file-conventions/loading\"><code>loading.js</code></a>. Only the shared layout, down the rendered \"tree\" of components until the first <code>loading.js</code> file, is prefetched and cached for <code>30s</code>. This reduces the cost of fetching an entire dynamic route, and it means you can show an <a href=\"loading-ui-and-streaming#instant-loading-states\">instant loading state</a> for better visual feedback to users.</p> <p>You can disable prefetching by setting the <code>prefetch</code> prop to <code>false</code>. Alternatively, you can prefetch the full page data beyond the loading boundaries by setting the <code>prefetch</code> prop to <code>true</code>.</p> <p>See the <a href=\"../../api-reference/components/link\"><code>&lt;Link&gt;</code> API reference</a> for more information.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Prefetching is not enabled in development, only in production.</li> </ul> </blockquote> <h3 id=\"3-caching\" data-docs-heading=\"\">3. Caching     </h3> <p>Next.js has an <strong>in-memory client-side cache</strong> called the <a href=\"../caching#router-cache\">Router Cache</a>. As users navigate around the app, the React Server Component Payload of <a href=\"#2-prefetching\">prefetched</a> route segments and visited routes are stored in the cache.</p> <p>This means on navigation, the cache is reused as much as possible, instead of making a new request to the server - improving performance by reducing the number of requests and data transferred.</p> <p>Learn more about how the <a href=\"../caching#router-cache\">Router Cache</a> works and how to configure it.</p> <h3 id=\"4-partial-rendering\" data-docs-heading=\"\">4. Partial Rendering     </h3> <p>Partial rendering means only the route segments that change on navigation re-render on the client, and any shared segments are preserved.</p> <p>For example, when navigating between two sibling routes, <code>/dashboard/settings</code> and <code>/dashboard/analytics</code>, the <code>settings</code> and <code>analytics</code> pages will be rendered, and the shared <code>dashboard</code> layout will be preserved.</p> <figure><img alt=\"How partial rendering works\" loading=\"lazy\" width=\"1600\" height=\"945\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fpartial-rendering.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fpartial-rendering.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fpartial-rendering.png&amp;w=3840&amp;q=75\"><img alt=\"How partial rendering works\" loading=\"lazy\" width=\"1600\" height=\"945\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fpartial-rendering.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fpartial-rendering.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fpartial-rendering.png&amp;w=3840&amp;q=75\"></figure> <p>Without partial rendering, each navigation would cause the full page to re-render on the client. Rendering only the segment that changes reduces the amount of data transferred and execution time, leading to improved performance.</p> <h3 id=\"5-soft-navigation\" data-docs-heading=\"\">5. Soft Navigation     </h3> <p>Browsers perform a \"hard navigation\" when navigating between pages. The Next.js App Router enables \"soft navigation\" between pages, ensuring only the route segments that have changed are re-rendered (partial rendering). This enables client React state to be preserved during navigation.</p> <h3 id=\"6-back-and-forward-navigation\" data-docs-heading=\"\">6. Back and Forward Navigation     </h3> <p>By default, Next.js will maintain the scroll position for backwards and forwards navigation, and re-use route segments in the <a href=\"../caching#router-cache\">Router Cache</a>.</p> <h3 id=\"7-routing-between-pages-and-app\" data-docs-heading=\"\">7. Routing between pages/ and app/     </h3> <p>When incrementally migrating from <code>pages/</code> to <code>app/</code>, the Next.js router will automatically handle hard navigation between the two. To detect transitions from <code>pages/</code> to <code>app/</code>, there is a client router filter that leverages probabilistic checking of app routes, which can occasionally result in false positives. By default, such occurrences should be very rare, as we configure the false positive likelihood to be 0.01%. This likelihood can be customized via the <code>experimental.clientRouterFilterAllowedRate</code> option in <code>next.config.js</code>. It's important to note that lowering the false positive rate will increase the size of the generated filter in the client bundle.</p> <p>Alternatively, if you prefer to disable this handling completely and manage the routing between <code>pages/</code> and <code>app/</code> manually, you can set <code>experimental.clientRouterFilter</code> to false in <code>next.config.js</code>. When this feature is disabled, any dynamic routes in pages that overlap with app routes won't be navigated to properly by default.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/linking-and-navigating\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/linking-and-navigating</a>\n  </p>\n</div>\n","app/building-your-application/routing/route-handlers":"<h1 class=\"break-words\">Route Handlers</h1>\n<p>Route Handlers allow you to create custom request handlers for a given route using the Web <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Request</a> and <a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Response</a> APIs.</p> <figure><img alt=\"Route.js Special File\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Froute-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Froute-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Froute-special-file.png&amp;w=3840&amp;q=75\"><img alt=\"Route.js Special File\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Froute-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Froute-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Froute-special-file.png&amp;w=3840&amp;q=75\"></figure> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Route Handlers are only available inside the <code>app</code> directory. They are the equivalent of <a href=\"../../../pages/building-your-application/routing/api-routes\">API Routes</a> inside the <code>pages</code> directory meaning you <strong>do not</strong> need to use API Routes and Route Handlers together.</p> </blockquote> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>Route Handlers are defined in a <a href=\"../../api-reference/file-conventions/route\"><code>route.js|ts</code> file</a> inside the <code>app</code> directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const dynamic = 'force-dynamic' // defaults to auto\nexport async function GET(request: Request) {}</pre></div>  <p>Route Handlers can be nested inside the <code>app</code> directory, similar to <code>page.js</code> and <code>layout.js</code>. But there <strong>cannot</strong> be a <code>route.js</code> file at the same route segment level as <code>page.js</code>.</p> <h3 id=\"supported-http-methods\" data-docs-heading=\"\">Supported HTTP Methods     </h3> <p>The following <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Methods\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP methods</a> are supported: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, <code>DELETE</code>, <code>HEAD</code>, and <code>OPTIONS</code>. If an unsupported method is called, Next.js will return a <code>405 Method Not Allowed</code> response.</p> <h3 id=\"extended-nextrequest-and-nextresponse-apis\" data-docs-heading=\"\">Extended NextRequest and NextResponse APIs     </h3> <p>In addition to supporting native <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Request</a> and <a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Response</a>. Next.js extends them with <a href=\"../../api-reference/functions/next-request\"><code>NextRequest</code></a> and <a href=\"../../api-reference/functions/next-response\"><code>NextResponse</code></a> to provide convenient helpers for advanced use cases.</p> <h2 id=\"behavior\" data-docs-heading=\"\">Behavior     </h2> <h3 id=\"caching\" data-docs-heading=\"\">Caching     </h3> <p>Route Handlers are cached by default when using the <code>GET</code> method with the <code>Response</code> object.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET() {\n  const res = await fetch('https://data.mongodb-api.com/...', {\n    headers: {\n      'Content-Type': 'application/json',\n      'API-Key': process.env.DATA_API_KEY,\n    },\n  })\n  const data = await res.json()\n \n  return Response.json({ data })\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>TypeScript Warning:</strong> <code>Response.json()</code> is only valid from TypeScript 5.2. If you use a lower TypeScript version, you can use <a href=\"../../api-reference/functions/next-response#json\"><code>NextResponse.json()</code></a> for typed responses instead.</p> </blockquote> <h3 id=\"opting-out-of-caching\" data-docs-heading=\"\">Opting out of caching     </h3> <p>You can opt out of caching by:</p> <ul> <li>Using the <code>Request</code> object with the <code>GET</code> method.</li> <li>Using any of the other HTTP methods.</li> <li>Using <a href=\"#dynamic-functions\">Dynamic Functions</a> like <code>cookies</code> and <code>headers</code>.</li> <li>The <a href=\"#segment-config-options\">Segment Config Options</a> manually specifies dynamic mode.</li> </ul> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET(request: Request) {\n  const { searchParams } = new URL(request.url)\n  const id = searchParams.get('id')\n  const res = await fetch(`https://data.mongodb-api.com/product/${id}`, {\n    headers: {\n      'Content-Type': 'application/json',\n      'API-Key': process.env.DATA_API_KEY!,\n    },\n  })\n  const product = await res.json()\n \n  return Response.json({ product })\n}</pre></div>  <p>Similarly, the <code>POST</code> method will cause the Route Handler to be evaluated dynamically.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function POST() {\n  const res = await fetch('https://data.mongodb-api.com/...', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'API-Key': process.env.DATA_API_KEY!,\n    },\n    body: JSON.stringify({ time: new Date().toISOString() }),\n  })\n \n  const data = await res.json()\n \n  return Response.json(data)\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Like API Routes, Route Handlers can be used for cases like handling form submissions. A new abstraction for <a href=\"../data-fetching/server-actions-and-mutations\">handling forms and mutations</a> that integrates deeply with React is being worked on.</p> </blockquote> <h3 id=\"route-resolution\" data-docs-heading=\"\">Route Resolution     </h3> <p>You can consider a <code>route</code> the lowest level routing primitive.</p> <ul> <li>They <strong>do not</strong> participate in layouts or client-side navigations like <code>page</code>.</li> <li>There <strong>cannot</strong> be a <code>route.js</code> file at the same route as <code>page.js</code>.</li> </ul> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Page</th>\n<th>Route</th>\n<th>Result</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/page.js</code></td>\n<td><code>app/route.js</code></td>\n<td>\n Conflict</td>\n</tr>\n<tr>\n<td><code>app/page.js</code></td>\n<td><code>app/api/route.js</code></td>\n<td>\n Valid</td>\n</tr>\n<tr>\n<td><code>app/[user]/page.js</code></td>\n<td><code>app/api/route.js</code></td>\n<td>\n Valid</td>\n</tr>\n</tbody>\n</table></div> <p>Each <code>route.js</code> or <code>page.js</code> file takes over all HTTP verbs for that route.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return &lt;h1&gt;Hello, Next.js!&lt;/h1&gt;\n}\n \n//  Conflict\n// `app/route.js`\nexport async function POST(request) {}</pre></div> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <p>The following examples show how to combine Route Handlers with other Next.js APIs and features.</p> <h3 id=\"revalidating-cached-data\" data-docs-heading=\"\">Revalidating Cached Data     </h3> <p>You can <a href=\"../data-fetching/fetching-caching-and-revalidating#revalidating-data\">revalidate cached data</a> using the <a href=\"../data-fetching/fetching-caching-and-revalidating#revalidating-data\"><code>next.revalidate</code></a> option:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET() {\n  const res = await fetch('https://data.mongodb-api.com/...', {\n    next: { revalidate: 60 }, // Revalidate every 60 seconds\n  })\n  const data = await res.json()\n \n  return Response.json(data)\n}</pre></div>  <p>Alternatively, you can use the <a href=\"../../api-reference/file-conventions/route-segment-config#revalidate\"><code>revalidate</code> segment config option</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const revalidate = 60</pre>\n</div> <h3 id=\"dynamic-functions\" data-docs-heading=\"\">Dynamic Functions     </h3> <p>Route Handlers can be used with dynamic functions from Next.js, like <a href=\"../../api-reference/functions/cookies\"><code>cookies</code></a> and <a href=\"../../api-reference/functions/headers\"><code>headers</code></a>.</p> <h4 id=\"cookies\" data-docs-heading=\"\">Cookies     </h4> <p>You can read or set cookies with <a href=\"../../api-reference/functions/cookies\"><code>cookies</code></a> from <code>next/headers</code>. This server function can be called directly in a Route Handler, or nested inside of another function.</p> <p>Alternatively, you can return a new <code>Response</code> using the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Set-Cookie</code></a> header.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cookies } from 'next/headers'\n \nexport async function GET(request: Request) {\n  const cookieStore = cookies()\n  const token = cookieStore.get('token')\n \n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: { 'Set-Cookie': `token=${token.value}` },\n  })\n}</pre></div>  <p>You can also use the underlying Web APIs to read cookies from the request (<a href=\"../../api-reference/functions/next-request\"><code>NextRequest</code></a>):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { type NextRequest } from 'next/server'\n \nexport async function GET(request: NextRequest) {\n  const token = request.cookies.get('token')\n}</pre></div>  <h4 id=\"headers\" data-docs-heading=\"\">Headers     </h4> <p>You can read headers with <a href=\"../../api-reference/functions/headers\"><code>headers</code></a> from <code>next/headers</code>. This server function can be called directly in a Route Handler, or nested inside of another function.</p> <p>This <code>headers</code> instance is read-only. To set headers, you need to return a new <code>Response</code> with new <code>headers</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { headers } from 'next/headers'\n \nexport async function GET(request: Request) {\n  const headersList = headers()\n  const referer = headersList.get('referer')\n \n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: { referer: referer },\n  })\n}</pre></div>  <p>You can also use the underlying Web APIs to read headers from the request (<a href=\"../../api-reference/functions/next-request\"><code>NextRequest</code></a>):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { type NextRequest } from 'next/server'\n \nexport async function GET(request: NextRequest) {\n  const requestHeaders = new Headers(request.headers)\n}</pre></div>  <h3 id=\"redirects\" data-docs-heading=\"\">Redirects     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { redirect } from 'next/navigation'\n \nexport async function GET(request: Request) {\n  redirect('https://nextjs.org/')\n}</pre></div>  <h3 id=\"dynamic-route-segments\" data-docs-heading=\"\">Dynamic Route Segments     </h3> <blockquote class=\"p-3 text-sm\"> <p>We recommend reading the <a href=\"defining-routes\">Defining Routes</a> page before continuing.</p> </blockquote> <p>Route Handlers can use <a href=\"dynamic-routes\">Dynamic Segments</a> to create request handlers from dynamic data.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET(\n  request: Request,\n  { params }: { params: { slug: string } }\n) {\n  const slug = params.slug // 'a', 'b', or 'c'\n}</pre></div>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>Example URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/items/[slug]/route.js</code></td>\n<td><code>/items/a</code></td>\n<td><code>{ slug: 'a' }</code></td>\n</tr>\n<tr>\n<td><code>app/items/[slug]/route.js</code></td>\n<td><code>/items/b</code></td>\n<td><code>{ slug: 'b' }</code></td>\n</tr>\n<tr>\n<td><code>app/items/[slug]/route.js</code></td>\n<td><code>/items/c</code></td>\n<td><code>{ slug: 'c' }</code></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"url-query-parameters\" data-docs-heading=\"\">URL Query Parameters     </h3> <p>The request object passed to the Route Handler is a <code>NextRequest</code> instance, which has <a href=\"../../api-reference/functions/next-request#nexturl\">some additional convenience methods</a>, including for more easily handling query parameters.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { type NextRequest } from 'next/server'\n \nexport function GET(request: NextRequest) {\n  const searchParams = request.nextUrl.searchParams\n  const query = searchParams.get('query')\n  // query is \"hello\" for /api/search?query=hello\n}</pre></div>  <h3 id=\"streaming\" data-docs-heading=\"\">Streaming     </h3> <p>Streaming is commonly used in combination with Large Language Models (LLMs), such as OpenAI, for AI-generated content. Learn more about the <a href=\"https://sdk.vercel.ai/docs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">AI SDK</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import OpenAI from 'openai'\nimport { OpenAIStream, StreamingTextResponse } from 'ai'\n \nconst openai = new OpenAI({\n  apiKey: process.env.OPENAI_API_KEY,\n})\n \nexport const runtime = 'edge'\n \nexport async function POST(req: Request) {\n  const { messages } = await req.json()\n  const response = await openai.chat.completions.create({\n    model: 'gpt-3.5-turbo',\n    stream: true,\n    messages,\n  })\n \n  const stream = OpenAIStream(response)\n \n  return new StreamingTextResponse(stream)\n}</pre></div>  <p>These abstractions use the Web APIs to create a stream. You can also use the underlying Web APIs directly.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// https://developer.mozilla.org/docs/Web/API/ReadableStream#convert_async_iterator_to_stream\nfunction iteratorToStream(iterator: any) {\n  return new ReadableStream({\n    async pull(controller) {\n      const { value, done } = await iterator.next()\n \n      if (done) {\n        controller.close()\n      } else {\n        controller.enqueue(value)\n      }\n    },\n  })\n}\n \nfunction sleep(time: number) {\n  return new Promise((resolve) =&gt; {\n    setTimeout(resolve, time)\n  })\n}\n \nconst encoder = new TextEncoder()\n \nasync function* makeIterator() {\n  yield encoder.encode('&lt;p&gt;One&lt;/p&gt;')\n  await sleep(200)\n  yield encoder.encode('&lt;p&gt;Two&lt;/p&gt;')\n  await sleep(200)\n  yield encoder.encode('&lt;p&gt;Three&lt;/p&gt;')\n}\n \nexport async function GET() {\n  const iterator = makeIterator()\n  const stream = iteratorToStream(iterator)\n \n  return new Response(stream)\n}</pre></div>  <h3 id=\"request-body\" data-docs-heading=\"\">Request Body     </h3> <p>You can read the <code>Request</code> body using the standard Web API methods:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function POST(request: Request) {\n  const res = await request.json()\n  return Response.json({ res })\n}</pre></div>  <h3 id=\"request-body-formdata\" data-docs-heading=\"\">Request Body FormData     </h3> <p>You can read the <code>FormData</code> using the <code>request.formData()</code> function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function POST(request: Request) {\n  const formData = await request.formData()\n  const name = formData.get('name')\n  const email = formData.get('email')\n  return Response.json({ name, email })\n}</pre></div>  <p>Since <code>formData</code> data are all strings, you may want to use <a href=\"https://www.npmjs.com/zod-form-data\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>zod-form-data</code></a> to validate the request and retrieve data in the format you prefer (e.g. <code>number</code>).</p> <h3 id=\"cors\" data-docs-heading=\"\">CORS     </h3> <p>You can set CORS headers for a specific Route Handler using the standard Web API methods:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const dynamic = 'force-dynamic' // defaults to auto\n \nexport async function GET(request: Request) {\n  return new Response('Hello, Next.js!', {\n    status: 200,\n    headers: {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n    },\n  })\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>To add CORS headers to multiple Route Handlers, you can use <a href=\"middleware#cors\">Middleware</a> or the <a href=\"../../api-reference/next-config-js/headers#cors\"><code>next.config.js</code> file</a>.</li> <li>Alternatively, see our <a href=\"https://github.com/vercel/examples/blob/main/edge-functions/cors/lib/cors.ts\" rel=\"noopener noreferrer\" target=\"_blank\">CORS example</a> package.</li> </ul> </blockquote> <h3 id=\"webhooks\" data-docs-heading=\"\">Webhooks     </h3> <p>You can use a Route Handler to receive webhooks from third-party services:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function POST(request: Request) {\n  try {\n    const text = await request.text()\n    // Process the webhook payload\n  } catch (error) {\n    return new Response(`Webhook error: ${error.message}`, {\n      status: 400,\n    })\n  }\n \n  return new Response('Success!', {\n    status: 200,\n  })\n}</pre></div>  <p>Notably, unlike API Routes with the Pages Router, you do not need to use <code>bodyParser</code> to use any additional configuration.</p> <h3 id=\"edge-and-nodejs-runtimes\" data-docs-heading=\"\">Edge and Node.js Runtimes     </h3> <p>Route Handlers have an isomorphic Web API to support both Edge and Node.js runtimes seamlessly, including support for streaming. Since Route Handlers use the same <a href=\"../../api-reference/file-conventions/route-segment-config\">route segment configuration</a> as Pages and Layouts, they support long-awaited features like general-purpose <a href=\"../data-fetching/fetching-caching-and-revalidating#revalidating-data\">statically regenerated</a> Route Handlers.</p> <p>You can use the <code>runtime</code> segment config option to specify the runtime:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const runtime = 'edge' // 'nodejs' is the default</pre>\n</div> <h3 id=\"non-ui-responses\" data-docs-heading=\"\">Non-UI Responses     </h3> <p>You can use Route Handlers to return non-UI content. Note that <a href=\"../../api-reference/file-conventions/metadata/sitemap#generating-a-sitemap-using-code-js-ts\"><code>sitemap.xml</code></a>, <a href=\"../../api-reference/file-conventions/metadata/robots#generate-a-robots-file\"><code>robots.txt</code></a>, <a href=\"../../api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx\"><code>app icons</code></a>, and <a href=\"../../api-reference/file-conventions/metadata/opengraph-image\">open graph images</a> all have built-in support.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const dynamic = 'force-dynamic' // defaults to auto\n \nexport async function GET() {\n  return new Response(\n    `&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;rss version=\"2.0\"&gt;\n \n&lt;channel&gt;\n  &lt;title&gt;Next.js Documentation&lt;/title&gt;\n  &lt;link&gt;https://nextjs.org/docs&lt;/link&gt;\n  &lt;description&gt;The React Framework for the Web&lt;/description&gt;\n&lt;/channel&gt;\n \n&lt;/rss&gt;`,\n    {\n      headers: {\n        'Content-Type': 'text/xml',\n      },\n    }\n  )\n}</pre></div>  <h3 id=\"segment-config-options\" data-docs-heading=\"\">Segment Config Options     </h3> <p>Route Handlers use the same <a href=\"../../api-reference/file-conventions/route-segment-config\">route segment configuration</a> as pages and layouts.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const dynamic = 'auto'\nexport const dynamicParams = true\nexport const revalidate = false\nexport const fetchCache = 'auto'\nexport const runtime = 'nodejs'\nexport const preferredRegion = 'auto'</pre></div>  <p>See the <a href=\"../../api-reference/file-conventions/route-segment-config\">API reference</a> for more details.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/route-handlers\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/route-handlers</a>\n  </p>\n</div>\n","app/building-your-application/routing/middleware":"<h1 class=\"break-words\">Middleware</h1> <p>Middleware allows you to run code before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.</p> <p>Middleware runs before cached content and routes are matched. See <a href=\"#matching-paths\">Matching Paths</a> for more details.</p> <h2 id=\"use-cases\" data-docs-heading=\"\">Use Cases     </h2> <p>Integrating Middleware into your application can lead to significant improvements in performance, security, and user experience. Some common scenarios where Middleware is particularly effective include:</p> <ul> <li>Authentication and Authorization: Ensure user identity and check session cookies before granting access to specific pages or API routes.</li> <li>Server-Side Redirects: Redirect users at the server level based on certain conditions (e.g., locale, user role).</li> <li>Path Rewriting: Support A/B testing, feature rollouts, or legacy paths by dynamically rewriting paths to API routes or pages based on request properties.</li> <li>Bot Detection: Protect your resources by detecting and blocking bot traffic.</li> <li>Logging and Analytics: Capture and analyze request data for insights before processing by the page or API.</li> <li>Feature Flagging: Enable or disable features dynamically for seamless feature rollouts or testing.</li> </ul> <p>Recognizing situations where middleware may not be the optimal approach is just as crucial. Here are some scenarios to be mindful of:</p> <ul> <li>Complex Data Fetching and Manipulation: Middleware is not designed for direct data fetching or manipulation, this should be done within Route Handlers or server-side utilities instead.</li> <li>Heavy Computational Tasks: Middleware should be lightweight and respond quickly or it can cause delays in page load. Heavy computational tasks or long-running processes should be done within dedicated Route Handlers.</li> <li>Extensive Session Management: While Middleware can manage basic session tasks, extensive session management should be managed by dedicated authentication services or within Route Handlers.</li> <li>Direct Database Operations: Performing direct database operations within Middleware is not recommended. Database interactions should done within Route Handlers or server-side utilities.</li> </ul> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>Use the file <code>middleware.ts</code> (or <code>.js</code>) in the root of your project to define Middleware. For example, at the same level as <code>pages</code> or <code>app</code>, or inside <code>src</code> if applicable.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: While only one <code>middleware.ts</code> file is supported per project, you can still organize your middleware logic modularly. Break out middleware functionalities into separate <code>.ts</code> or <code>.js</code> files and import them into your main <code>middleware.ts</code> file. This allows for cleaner management of route-specific middleware, aggregated in the <code>middleware.ts</code> for centralized control. By enforcing a single middleware file, it simplifies configuration, prevents potential conflicts, and optimizes performance by avoiding multiple middleware layers.</p> </blockquote> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \n// This function can be marked `async` if using `await` inside\nexport function middleware(request: NextRequest) {\n  return NextResponse.redirect(new URL('/home', request.url))\n}\n \n// See \"Matching Paths\" below to learn more\nexport const config = {\n  matcher: '/about/:path*',\n}</pre></div>  <h2 id=\"matching-paths\" data-docs-heading=\"\">Matching Paths     </h2> <p>Middleware will be invoked for <strong>every route in your project</strong>. Given this, it's crucial to use matchers to precisely target or exclude specific routes. The following is the execution order:</p> <ol> <li>\n<code>headers</code> from <code>next.config.js</code>\n</li> <li>\n<code>redirects</code> from <code>next.config.js</code>\n</li> <li>Middleware (<code>rewrites</code>, <code>redirects</code>, etc.)</li> <li>\n<code>beforeFiles</code> (<code>rewrites</code>) from <code>next.config.js</code>\n</li> <li>Filesystem routes (<code>public/</code>, <code>_next/static/</code>, <code>pages/</code>, <code>app/</code>, etc.)</li> <li>\n<code>afterFiles</code> (<code>rewrites</code>) from <code>next.config.js</code>\n</li> <li>Dynamic Routes (<code>/blog/[slug]</code>)</li> <li>\n<code>fallback</code> (<code>rewrites</code>) from <code>next.config.js</code>\n</li> </ol> <p>There are two ways to define which paths Middleware will run on:</p> <ol> <li><a href=\"#matcher\">Custom matcher config</a></li> <li><a href=\"#conditional-statements\">Conditional statements</a></li> </ol> <h3 id=\"matcher\" data-docs-heading=\"\">Matcher     </h3> <p><code>matcher</code> allows you to filter Middleware to run on specific paths.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: '/about/:path*',\n}</pre></div> <p>You can match a single path or multiple paths with an array syntax:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: ['/about/:path*', '/dashboard/:path*'],\n}</pre></div> <p>The <code>matcher</code> config allows full regex so matching like negative lookaheads or character matching is supported. An example of a negative lookahead to match all except specific paths can be seen here:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    '/((?!api|_next/static|_next/image|favicon.ico).*)',\n  ],\n}</pre></div> <p>You can also bypass Middleware for certain requests by using the <code>missing</code> or <code>has</code> arrays, or a combination of both:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n \n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      has: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n \n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      has: [{ type: 'header', key: 'x-present' }],\n      missing: [{ type: 'header', key: 'x-missing', value: 'prefetch' }],\n    },\n  ],\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The <code>matcher</code> values need to be constants so they can be statically analyzed at build-time. Dynamic values such as variables will be ignored.</p> </blockquote> <p>Configured matchers:</p> <ol> <li>MUST start with <code>/</code>\n</li> <li>Can include named parameters: <code>/about/:path</code> matches <code>/about/a</code> and <code>/about/b</code> but not <code>/about/a/c</code>\n</li> <li>Can have modifiers on named parameters (starting with <code>:</code>): <code>/about/:path*</code> matches <code>/about/a/b/c</code> because <code>*</code> is <em>zero or more</em>. <code>?</code> is <em>zero or one</em> and <code>+</code> <em>one or more</em>\n</li> <li>Can use regular expression enclosed in parenthesis: <code>/about/(.*)</code> is the same as <code>/about/:path*</code>\n</li> </ol> <p>Read more details on <a href=\"https://github.com/pillarjs/path-to-regexp#path-to-regexp-1\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">path-to-regexp</a> documentation.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: For backward compatibility, Next.js always considers <code>/public</code> as <code>/public/index</code>. Therefore, a matcher of <code>/public/:path</code> will match.</p> </blockquote> <h3 id=\"conditional-statements\" data-docs-heading=\"\">Conditional Statements     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  if (request.nextUrl.pathname.startsWith('/about')) {\n    return NextResponse.rewrite(new URL('/about-2', request.url))\n  }\n \n  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n  }\n}</pre></div>  <h2 id=\"nextresponse\" data-docs-heading=\"\">NextResponse     </h2> <p>The <code>NextResponse</code> API allows you to:</p> <ul> <li>\n<code>redirect</code> the incoming request to a different URL</li> <li>\n<code>rewrite</code> the response by displaying a given URL</li> <li>Set request headers for API Routes, <code>getServerSideProps</code>, and <code>rewrite</code> destinations</li> <li>Set response cookies</li> <li>Set response headers</li> </ul> <p>To produce a response from Middleware, you can:</p>\n<ol> <li>\n<code>rewrite</code> to a route (<a href=\"pages-and-layouts\">Page</a> or <a href=\"route-handlers\">Route Handler</a>) that produces a response</li> <li>return a <code>NextResponse</code> directly. See <a href=\"#producing-a-response\">Producing a Response</a>\n</li> </ol>  <h2 id=\"using-cookies\" data-docs-heading=\"\">Using Cookies     </h2> <p>Cookies are regular headers. On a <code>Request</code>, they are stored in the <code>Cookie</code> header. On a <code>Response</code> they are in the <code>Set-Cookie</code> header. Next.js provides a convenient way to access and manipulate these cookies through the <code>cookies</code> extension on <code>NextRequest</code> and <code>NextResponse</code>.</p> <ol> <li>For incoming requests, <code>cookies</code> comes with the following methods: <code>get</code>, <code>getAll</code>, <code>set</code>, and <code>delete</code> cookies. You can check for the existence of a cookie with <code>has</code> or remove all cookies with <code>clear</code>.</li> <li>For outgoing responses, <code>cookies</code> have the following methods <code>get</code>, <code>getAll</code>, <code>set</code>, and <code>delete</code>.</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n  // Getting cookies from the request using the `RequestCookies` API\n  let cookie = request.cookies.get('nextjs')\n  console.log(cookie) // =&gt; { name: 'nextjs', value: 'fast', Path: '/' }\n  const allCookies = request.cookies.getAll()\n  console.log(allCookies) // =&gt; [{ name: 'nextjs', value: 'fast' }]\n \n  request.cookies.has('nextjs') // =&gt; true\n  request.cookies.delete('nextjs')\n  request.cookies.has('nextjs') // =&gt; false\n \n  // Setting cookies on the response using the `ResponseCookies` API\n  const response = NextResponse.next()\n  response.cookies.set('vercel', 'fast')\n  response.cookies.set({\n    name: 'vercel',\n    value: 'fast',\n    path: '/',\n  })\n  cookie = response.cookies.get('vercel')\n  console.log(cookie) // =&gt; { name: 'vercel', value: 'fast', Path: '/' }\n  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/` header.\n \n  return response\n}</pre></div>  <h2 id=\"setting-headers\" data-docs-heading=\"\">Setting Headers     </h2> <p>You can set request and response headers using the <code>NextResponse</code> API (setting <em>request</em> headers is available since Next.js v13.0.0).</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  // Clone the request headers and set a new header `x-hello-from-middleware1`\n  const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-hello-from-middleware1', 'hello')\n \n  // You can also set request headers in NextResponse.rewrite\n  const response = NextResponse.next({\n    request: {\n      // New request headers\n      headers: requestHeaders,\n    },\n  })\n \n  // Set a new response header `x-hello-from-middleware2`\n  response.headers.set('x-hello-from-middleware2', 'hello')\n  return response\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Avoid setting large headers as it might cause <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Status/431\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">431 Request Header Fields Too Large</a> error depending on your backend web server configuration.</p> </blockquote> <h3 id=\"cors\" data-docs-heading=\"\">CORS     </h3> <p>You can set CORS headers in Middleware to allow cross-origin requests, including <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">simple</a> and <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preflighted</a> requests.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse } from 'next/server'\n \nconst allowedOrigins = ['https://acme.com', 'https://my-app.org']\n \nconst corsOptions = {\n  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n}\n \nexport function middleware(request: NextRequest) {\n  // Check the origin from the request\n  const origin = request.headers.get('origin') ?? ''\n  const isAllowedOrigin = allowedOrigins.includes(origin)\n \n  // Handle preflighted requests\n  const isPreflight = request.method === 'OPTIONS'\n \n  if (isPreflight) {\n    const preflightHeaders = {\n      ...(isAllowedOrigin &amp;&amp; { 'Access-Control-Allow-Origin': origin }),\n      ...corsOptions,\n    }\n    return NextResponse.json({}, { headers: preflightHeaders })\n  }\n \n  // Handle simple requests\n  const response = NextResponse.next()\n \n  if (isAllowedOrigin) {\n    response.headers.set('Access-Control-Allow-Origin', origin)\n  }\n \n  Object.entries(corsOptions).forEach(([key, value]) =&gt; {\n    response.headers.set(key, value)\n  })\n \n  return response\n}\n \nexport const config = {\n  matcher: '/api/:path*',\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> You can configure CORS headers for individual routes in <a href=\"route-handlers#cors\">Route Handlers</a>.</p> </blockquote> <h2 id=\"producing-a-response\" data-docs-heading=\"\">Producing a Response     </h2> <p>You can respond from Middleware directly by returning a <code>Response</code> or <code>NextResponse</code> instance. (This is available since <a href=\"https://nextjs.org/blog/next-13-1#nextjs-advanced-middleware\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js v13.1.0</a>)</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest } from 'next/server'\nimport { isAuthenticated } from '@lib/auth'\n \n// Limit the middleware to paths starting with `/api/`\nexport const config = {\n  matcher: '/api/:function*',\n}\n \nexport function middleware(request: NextRequest) {\n  // Call our authentication function to check the request\n  if (!isAuthenticated(request)) {\n    // Respond with JSON indicating an error message\n    return Response.json(\n      { success: false, message: 'authentication failed' },\n      { status: 401 }\n    )\n  }\n}</pre></div>  <h3 id=\"waituntil-and-nextfetchevent\" data-docs-heading=\"\">waitUntil and NextFetchEvent     </h3> <p>The <code>NextFetchEvent</code> object extends the native <a href=\"https://developer.mozilla.org/docs/Web/API/FetchEvent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>FetchEvent</code></a> object, and includes the <a href=\"https://developer.mozilla.org/docs/Web/API/ExtendableEvent/waitUntil\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>waitUntil()</code></a> method.</p> <p>The <code>waitUntil()</code> method takes a promise as an argument, and extends the lifetime of the Middleware until the promise settles. This is useful for performing work in the background.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextFetchEvent, NextRequest } from 'next/server'\n \nexport function middleware(req: NextRequest, event: NextFetchEvent) {\n  event.waitUntil(\n    fetch('https://my-analytics-platform.com', {\n      method: 'POST',\n      body: JSON.stringify({ pathname: req.nextUrl.pathname }),\n    })\n  )\n \n  return NextResponse.next()\n}</pre></div> <h2 id=\"advanced-middleware-flags\" data-docs-heading=\"\">Advanced Middleware Flags     </h2> <p>In <code>v13.1</code> of Next.js two additional flags were introduced for middleware, <code>skipMiddlewareUrlNormalize</code> and <code>skipTrailingSlashRedirect</code> to handle advanced use cases.</p> <p><code>skipTrailingSlashRedirect</code> disables Next.js redirects for adding or removing trailing slashes. This allows custom handling inside middleware to maintain the trailing slash for some paths but not others, which can make incremental migrations easier.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  skipTrailingSlashRedirect: true,\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const legacyPrefixes = ['/docs', '/blog']\n \nexport default async function middleware(req) {\n  const { pathname } = req.nextUrl\n \n  if (legacyPrefixes.some((prefix) =&gt; pathname.startsWith(prefix))) {\n    return NextResponse.next()\n  }\n \n  // apply trailing slash handling\n  if (\n    !pathname.endsWith('/') &amp;&amp;\n    !pathname.match(/((?!\\.well-known(?:\\/.*)?)(?:[^/]+\\/)*[^/]+\\.\\w+)/)\n  ) {\n    req.nextUrl.pathname += '/'\n    return NextResponse.redirect(req.nextUrl)\n  }\n}</pre></div> <p><code>skipMiddlewareUrlNormalize</code> allows for disabling the URL normalization in Next.js to make handling direct visits and client-transitions the same. In some advanced cases, this option provides full control by using the original URL.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  skipMiddlewareUrlNormalize: true,\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function middleware(req) {\n  const { pathname } = req.nextUrl\n \n  // GET /_next/data/build-id/hello.json\n \n  console.log(pathname)\n  // with the flag this now /_next/data/build-id/hello.json\n  // without the flag this would be normalized to /hello\n}</pre></div> <h2 id=\"runtime\" data-docs-heading=\"\">Runtime     </h2> <p>Middleware currently only supports the <a href=\"../rendering/edge-and-nodejs-runtimes\">Edge runtime</a>. The Node.js runtime can not be used.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.1.0</code></td>\n<td>Advanced Middleware flags added</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>Middleware can modify request headers, response headers, and send responses</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>Middleware is stable, please see the <a href=\"../../../messages/middleware-upgrade-guide\">upgrade guide</a>\n</td>\n</tr>\n<tr>\n<td><code>v12.0.9</code></td>\n<td>Enforce absolute URLs in Edge Runtime (<a href=\"https://github.com/vercel/next.js/pull/33410\" rel=\"noopener noreferrer\" target=\"_blank\">PR</a>)</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>Middleware (Beta) added</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/routing/middleware\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/routing/middleware</a>\n  </p>\n</div>\n","app/building-your-application/data-fetching/server-actions-and-mutations":"<h1 class=\"break-words\">Server Actions and Mutations</h1>\n<p>Server Actions are <strong>asynchronous functions</strong> that are executed on the server. They can be used in Server and Client Components to handle form submissions and data mutations in Next.js applications.</p> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn more about forms and mutations with Server Actions  <a href=\"https://youtu.be/dDpZfOQBMaU?si=cJZHlUu_jFhCzHUg\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (10 minutes)</a>.</p> </blockquote> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>A Server Action can be defined with the React <a href=\"https://react.dev/reference/react/use-server\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>\"use server\"</code></a> directive. You can place the directive at the top of an <code>async</code> function to mark the function as a Server Action, or at the top of a separate file to mark all exports of that file as Server Actions.</p> <h3 id=\"server-components\" data-docs-heading=\"\">Server Components     </h3> <p>Server Components can use the inline function level or module level <code>\"use server\"</code> directive. To inline a Server Action, add <code>\"use server\"</code> to the top of the function body:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Server Component\nexport default function Page() {\n  // Server Action\n  async function create() {\n    'use server'\n \n    // ...\n  }\n \n  return (\n    // ...\n  )\n}</pre></div>  <h3 id=\"client-components\" data-docs-heading=\"\">Client Components     </h3> <p>Client Components can only import actions that use the module-level <code>\"use server\"</code> directive.</p> <p>To call a Server Action in a Client Component, create a new file and add the <code>\"use server\"</code> directive at the top of it. All functions within the file will be marked as Server Actions that can be reused in both Client and Server Components:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nexport async function create() {\n  // ...\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { create } from '@/app/actions'\n \nexport function Button() {\n  return (\n    // ...\n  )\n}</pre></div>  <p>You can also pass a Server Action to a Client Component as a prop:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;ClientComponent updateItem={updateItem} /&gt;</pre>\n</div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nexport default function ClientComponent({ updateItem }) {\n  return &lt;form action={updateItem}&gt;{/* ... */}&lt;/form&gt;\n}</pre></div> <h2 id=\"behavior\" data-docs-heading=\"\">Behavior     </h2> <ul> <li>Server actions can be invoked using the <code>action</code> attribute in a <a href=\"#forms\"><code>&lt;form&gt;</code> element</a>: <ul> <li>Server Components support progressive enhancement by default, meaning the form will be submitted even if JavaScript hasn't loaded yet or is disabled.</li> <li>In Client Components, forms invoking Server Actions will queue submissions if JavaScript isn't loaded yet, prioritizing client hydration.</li> <li>After hydration, the browser does not refresh on form submission.</li> </ul> </li> <li>Server Actions are not limited to <code>&lt;form&gt;</code> and can be invoked from event handlers, <code>useEffect</code>, third-party libraries, and other form elements like <code>&lt;button&gt;</code>.</li> <li>Server Actions integrate with the Next.js <a href=\"../caching\">caching and revalidation</a> architecture. When an action is invoked, Next.js can return both the updated UI and new data in a single server roundtrip.</li> <li>Behind the scenes, actions use the <code>POST</code> method, and only this HTTP method can invoke them.</li> <li>The arguments and return value of Server Actions must be serializable by React. See the React docs for a list of <a href=\"https://react.dev/reference/react/use-server#serializable-parameters-and-return-values\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">serializable arguments and values</a>.</li> <li>Server Actions are functions. This means they can be reused anywhere in your application.</li> <li>Server Actions inherit the <a href=\"../rendering/edge-and-nodejs-runtimes\">runtime</a> from the page or layout they are used on.</li> <li>Server Actions inherit the <a href=\"../../api-reference/file-conventions/route-segment-config\">Route Segment Config</a> from the page or layout they are used on, including fields like <code>maxDuration</code>.</li> </ul> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"forms\" data-docs-heading=\"\">Forms     </h3> <p>React extends the HTML <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/form\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>&lt;form&gt;</code></a> element to allow Server Actions to be invoked with the <code>action</code> prop.</p> <p>When invoked in a form, the action automatically receives the <a href=\"https://developer.mozilla.org/docs/Web/API/FormData/FormData\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>FormData</code></a> object. You don't need to use React <code>useState</code> to manage fields, instead, you can extract the data using the native <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/FormData#instance_methods\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>FormData</code> methods</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  async function createInvoice(formData: FormData) {\n    'use server'\n \n    const rawFormData = {\n      customerId: formData.get('customerId'),\n      amount: formData.get('amount'),\n      status: formData.get('status'),\n    }\n \n    // mutate data\n    // revalidate cache\n  }\n \n  return &lt;form action={createInvoice}&gt;...&lt;/form&gt;\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>Example: <a href=\"https://github.com/vercel/next.js/tree/canary/examples/next-forms\" rel=\"noopener noreferrer\" target=\"_blank\">Form with Loading &amp; Error States</a>\n</li> <li>When working with forms that have many fields, you may want to consider using the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/FormData/entries\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>entries()</code></a> method with JavaScript's <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Object.fromEntries()</code></a>. For example: <code>const rawFormData = Object.fromEntries(formData)</code>. One thing to note is that the <code>formData</code> will include additional <code>$ACTION_</code> properties.</li> <li>See <a href=\"https://react.dev/reference/react-dom/components/form#handle-form-submission-with-a-server-action\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React <code>&lt;form&gt;</code> documentation</a> to learn more.</li> </ul> </blockquote> <h4 id=\"passing-additional-arguments\" data-docs-heading=\"\">Passing Additional Arguments     </h4> <p>You can pass additional arguments to a Server Action using the JavaScript <code>bind</code> method.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { updateUser } from './actions'\n \nexport function UserProfile({ userId }: { userId: string }) {\n  const updateUserWithId = updateUser.bind(null, userId)\n \n  return (\n    &lt;form action={updateUserWithId}&gt;\n      &lt;input type=\"text\" name=\"name\" /&gt;\n      &lt;button type=\"submit\"&gt;Update User Name&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre></div>  <p>The Server Action will receive the <code>userId</code> argument, in addition to the form data:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nexport async function updateUser(userId, formData) {\n  // ...\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>An alternative is to pass arguments as hidden input fields in the form (e.g. <code>&lt;input type=\"hidden\" name=\"userId\" value={userId} /&gt;</code>). However, the value will be part of the rendered HTML and will not be encoded.</li> <li>\n<code>.bind</code> works in both Server and Client Components. It also supports progressive enhancement.</li> </ul> </blockquote> <h4 id=\"pending-states\" data-docs-heading=\"\">Pending states     </h4> <p>You can use the React <a href=\"https://react.dev/reference/react-dom/hooks/useFormStatus\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useFormStatus</code></a> hook to show a pending state while the form is being submitted.</p> <ul> <li>\n<code>useFormStatus</code> returns the status for a specific <code>&lt;form&gt;</code>, so it <strong>must be defined as a child of the <code>&lt;form&gt;</code> element</strong>.</li> <li>\n<code>useFormStatus</code> is a React hook and therefore must be used in a Client Component.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useFormStatus } from 'react-dom'\n \nexport function SubmitButton() {\n  const { pending } = useFormStatus()\n \n  return (\n    &lt;button type=\"submit\" disabled={pending}&gt;\n      Add\n    &lt;/button&gt;\n  )\n}</pre></div>  <p><code>&lt;SubmitButton /&gt;</code> can then be nested in any form:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { SubmitButton } from '@/app/submit-button'\nimport { createItem } from '@/app/actions'\n \n// Server Component\nexport default async function Home() {\n  return (\n    &lt;form action={createItem}&gt;\n      &lt;input type=\"text\" name=\"field-name\" /&gt;\n      &lt;SubmitButton /&gt;\n    &lt;/form&gt;\n  )\n}</pre></div>  <h4 id=\"server-side-validation-and-error-handling\" data-docs-heading=\"\">Server-side validation and error handling     </h4> <p>We recommend using HTML validation like <code>required</code> and <code>type=\"email\"</code> for basic client-side form validation.</p> <p>For more advanced server-side validation, you can use a library like <a href=\"https://zod.dev/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">zod</a> to validate the form fields before mutating the data:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { z } from 'zod'\n \nconst schema = z.object({\n  email: z.string({\n    invalid_type_error: 'Invalid Email',\n  }),\n})\n \nexport default async function createUser(formData: FormData) {\n  const validatedFields = schema.safeParse({\n    email: formData.get('email'),\n  })\n \n  // Return early if the form data is invalid\n  if (!validatedFields.success) {\n    return {\n      errors: validatedFields.error.flatten().fieldErrors,\n    }\n  }\n \n  // Mutate data\n}</pre></div>  <p>Once the fields have been validated on the server, you can return a serializable object in your action and use the React <a href=\"https://react.dev/reference/react-dom/hooks/useFormState\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useFormState</code></a> hook to show a message to the user.</p> <ul> <li>By passing the action to <code>useFormState</code>, the action's function signature changes to receive a new <code>prevState</code> or <code>initialState</code> parameter as its first argument.</li> <li>\n<code>useFormState</code> is a React hook and therefore must be used in a Client Component.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nexport async function createUser(prevState: any, formData: FormData) {\n  // ...\n  return {\n    message: 'Please enter a valid email',\n  }\n}</pre></div>  <p>Then, you can pass your action to the <code>useFormState</code> hook and use the returned <code>state</code> to display an error message.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useFormState } from 'react-dom'\nimport { createUser } from '@/app/actions'\n \nconst initialState = {\n  message: '',\n}\n \nexport function Signup() {\n  const [state, formAction] = useFormState(createUser, initialState)\n \n  return (\n    &lt;form action={formAction}&gt;\n      &lt;label htmlFor=\"email\"&gt;Email&lt;/label&gt;\n      &lt;input type=\"text\" id=\"email\" name=\"email\" required /&gt;\n      {/* ... */}\n      &lt;p aria-live=\"polite\" className=\"sr-only\"&gt;\n        {state?.message}\n      &lt;/p&gt;\n      &lt;button&gt;Sign up&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>Before mutating data, you should always ensure a user is also authorized to perform the action. See <a href=\"#authentication-and-authorization\">Authentication and Authorization</a>.</li> </ul> </blockquote> <h4 id=\"optimistic-updates\" data-docs-heading=\"\">Optimistic updates     </h4> <p>You can use the React <a href=\"https://react.dev/reference/react/useOptimistic\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useOptimistic</code></a> hook to optimistically update the UI before the Server Action finishes, rather than waiting for the response:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useOptimistic } from 'react'\nimport { send } from './actions'\n \ntype Message = {\n  message: string\n}\n \nexport function Thread({ messages }: { messages: Message[] }) {\n  const [optimisticMessages, addOptimisticMessage] = useOptimistic&lt;\n    Message[],\n    string\n  &gt;(messages, (state, newMessage) =&gt; [...state, { message: newMessage }])\n \n  return (\n    &lt;div&gt;\n      {optimisticMessages.map((m, k) =&gt; (\n        &lt;div key={k}&gt;{m.message}&lt;/div&gt;\n      ))}\n      &lt;form\n        action={async (formData: FormData) =&gt; {\n          const message = formData.get('message')\n          addOptimisticMessage(message)\n          await send(message)\n        }}\n      &gt;\n        &lt;input type=\"text\" name=\"message\" /&gt;\n        &lt;button type=\"submit\"&gt;Send&lt;/button&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <h4 id=\"nested-elements\" data-docs-heading=\"\">Nested elements     </h4> <p>You can invoke a Server Action in elements nested inside <code>&lt;form&gt;</code> such as <code>&lt;button&gt;</code>, <code>&lt;input type=\"submit\"&gt;</code>, and <code>&lt;input type=\"image\"&gt;</code>. These elements accept the <code>formAction</code> prop or <a href=\"#event-handlers\">event handlers</a>.</p> <p>This is useful in cases where you want to call multiple server actions within a form. For example, you can create a specific <code>&lt;button&gt;</code> element for saving a post draft in addition to publishing it. See the <a href=\"https://react.dev/reference/react-dom/components/form#handling-multiple-submission-types\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React <code>&lt;form&gt;</code> docs</a> for more information.</p> <h4 id=\"programmatic-form-submission\" data-docs-heading=\"\">Programmatic form submission     </h4> <p>You can trigger a form submission using the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/requestSubmit\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>requestSubmit()</code></a> method. For example, when the user presses <code></code> + <code>Enter</code>, you can listen for the <code>onKeyDown</code> event:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nexport function Entry() {\n  const handleKeyDown = (e: React.KeyboardEvent&lt;HTMLTextAreaElement&gt;) =&gt; {\n    if (\n      (e.ctrlKey || e.metaKey) &amp;&amp;\n      (e.key === 'Enter' || e.key === 'NumpadEnter')\n    ) {\n      e.preventDefault()\n      e.currentTarget.form?.requestSubmit()\n    }\n  }\n \n  return (\n    &lt;div&gt;\n      &lt;textarea name=\"entry\" rows={20} required onKeyDown={handleKeyDown} /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>This will trigger the submission of the nearest <code>&lt;form&gt;</code> ancestor, which will invoke the Server Action.</p> <h3 id=\"non-form-elements\" data-docs-heading=\"\">Non-form Elements     </h3> <p>While it's common to use Server Actions within <code>&lt;form&gt;</code> elements, they can also be invoked from other parts of your code such as event handlers and <code>useEffect</code>.</p> <h4 id=\"event-handlers\" data-docs-heading=\"\">Event Handlers     </h4> <p>You can invoke a Server Action from event handlers such as <code>onClick</code>. For example, to increment a like count:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { incrementLike } from './actions'\nimport { useState } from 'react'\n \nexport default function LikeButton({ initialLikes }: { initialLikes: number }) {\n  const [likes, setLikes] = useState(initialLikes)\n \n  return (\n    &lt;&gt;\n      &lt;p&gt;Total Likes: {likes}&lt;/p&gt;\n      &lt;button\n        onClick={async () =&gt; {\n          const updatedLikes = await incrementLike()\n          setLikes(updatedLikes)\n        }}\n      &gt;\n        Like\n      &lt;/button&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>To improve the user experience, we recommend using other React APIs like <a href=\"https://react.dev/reference/react/useOptimistic\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useOptimistic</code></a> and <a href=\"https://react.dev/reference/react/useTransition\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useTransition</code></a> to update the UI before the Server Action finishes executing on the server, or to show a pending state.</p> <p>You can also add event handlers to form elements, for example, to save a form field <code>onChange</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { publishPost, saveDraft } from './actions'\n \nexport default function EditPost() {\n  return (\n    &lt;form action={publishPost}&gt;\n      &lt;textarea\n        name=\"content\"\n        onChange={async (e) =&gt; {\n          await saveDraft(e.target.value)\n        }}\n      /&gt;\n      &lt;button type=\"submit\"&gt;Publish&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre></div> <p>For cases like this, where multiple events might be fired in quick succession, we recommend <strong>debouncing</strong> to prevent unnecessary Server Action invocations.</p> <h4 id=\"useeffect\" data-docs-heading=\"\">useEffect     </h4> <p>You can use the React <a href=\"https://react.dev/reference/react/useEffect\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useEffect</code></a> hook to invoke a Server Action when the component mounts or a dependency changes. This is useful for mutations that depend on global events or need to be triggered automatically. For example, <code>onKeyDown</code> for app shortcuts, an intersection observer hook for infinite scrolling, or when the component mounts to update a view count:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { incrementViews } from './actions'\nimport { useState, useEffect } from 'react'\n \nexport default function ViewCount({ initialViews }: { initialViews: number }) {\n  const [views, setViews] = useState(initialViews)\n \n  useEffect(() =&gt; {\n    const updateViews = async () =&gt; {\n      const updatedViews = await incrementViews()\n      setViews(updatedViews)\n    }\n \n    updateViews()\n  }, [])\n \n  return &lt;p&gt;Total Views: {views}&lt;/p&gt;\n}</pre></div>  <p>Remember to consider the <a href=\"https://react.dev/reference/react/useEffect#caveats\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">behavior and caveats</a> of <code>useEffect</code>.</p> <h3 id=\"error-handling\" data-docs-heading=\"\">Error Handling     </h3> <p>When an error is thrown, it'll be caught by the nearest <a href=\"../routing/error-handling\"><code>error.js</code></a> or <code>&lt;Suspense&gt;</code> boundary on the client. We recommend using <code>try/catch</code> to return errors to be handled by your UI.</p> <p>For example, your Server Action might handle errors from creating a new item by returning a message:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nexport async function createTodo(prevState: any, formData: FormData) {\n  try {\n    // Mutate data\n  } catch (e) {\n    throw new Error('Failed to create task')\n  }\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>Aside from throwing the error, you can also return an object to be handled by <code>useFormState</code>. See <a href=\"#server-side-validation-and-error-handling\">Server-side validation and error handling</a>.</li> </ul> </blockquote> <h3 id=\"revalidating-data\" data-docs-heading=\"\">Revalidating data     </h3> <p>You can revalidate the <a href=\"../caching\">Next.js Cache</a> inside your Server Actions with the <a href=\"../../api-reference/functions/revalidatepath\"><code>revalidatePath</code></a> API:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { revalidatePath } from 'next/cache'\n \nexport async function createPost() {\n  try {\n    // ...\n  } catch (error) {\n    // ...\n  }\n \n  revalidatePath('/posts')\n}</pre></div>  <p>Or invalidate a specific data fetch with a cache tag using <a href=\"../../api-reference/functions/revalidatetag\"><code>revalidateTag</code></a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { revalidateTag } from 'next/cache'\n \nexport async function createPost() {\n  try {\n    // ...\n  } catch (error) {\n    // ...\n  }\n \n  revalidateTag('posts')\n}</pre></div>  <h3 id=\"redirecting\" data-docs-heading=\"\">Redirecting     </h3> <p>If you would like to redirect the user to a different route after the completion of a Server Action, you can use <a href=\"../../api-reference/functions/redirect\"><code>redirect</code></a> API. <code>redirect</code> needs to be called outside of the <code>try/catch</code> block:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { redirect } from 'next/navigation'\nimport { revalidateTag } from 'next/cache'\n \nexport async function createPost(id: string) {\n  try {\n    // ...\n  } catch (error) {\n    // ...\n  }\n \n  revalidateTag('posts') // Update cached posts\n  redirect(`/post/${id}`) // Navigate to the new post page\n}</pre></div>  <h3 id=\"cookies\" data-docs-heading=\"\">Cookies     </h3> <p>You can <code>get</code>, <code>set</code>, and <code>delete</code> cookies inside a Server Action using the <a href=\"../../api-reference/functions/cookies\"><code>cookies</code></a> API:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { cookies } from 'next/headers'\n \nexport async function exampleAction() {\n  // Get cookie\n  const value = cookies().get('name')?.value\n \n  // Set cookie\n  cookies().set('name', 'Delba')\n \n  // Delete cookie\n  cookies().delete('name')\n}</pre></div>  <p>See <a href=\"../../api-reference/functions/cookies#deleting-cookies\">additional examples</a> for deleting cookies from Server Actions.</p> <h2 id=\"security\" data-docs-heading=\"\">Security     </h2> <h3 id=\"authentication-and-authorization\" data-docs-heading=\"\">Authentication and authorization     </h3> <p>You should treat Server Actions as you would public-facing API endpoints, and ensure that the user is authorized to perform the action. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { auth } from './lib'\n \nexport function addItem() {\n  const { user } = auth()\n  if (!user) {\n    throw new Error('You must be signed in to perform this action')\n  }\n \n  // ...\n}</pre></div> <h3 id=\"closures-and-encryption\" data-docs-heading=\"\">Closures and encryption     </h3> <p>Defining a Server Action inside a component creates a <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">closure</a> where the action has access to the outer function's scope. For example, the <code>publish</code> action has access to the <code>publishVersion</code> variable:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  const publishVersion = await getLatestVersion();\n \n  async function publish(formData: FormData) {\n    \"use server\";\n    if (publishVersion !== await getLatestVersion()) {\n      throw new Error('The version has changed since pressing publish');\n    }\n    ...\n  }\n \n  return &lt;button action={publish}&gt;Publish&lt;/button&gt;;\n}</pre></div>  <p>Closures are useful when you need to capture a <em>snapshot</em> of data (e.g. <code>publishVersion</code>) at the time of rendering so that it can be used later when the action is invoked.</p> <p>However, for this to happen, the captured variables are sent to the client and back to the server when the action is invoked. To prevent sensitive data from being exposed to the client, Next.js automatically encrypts the closed-over variables. A new private key is generated for each action every time a Next.js application is built. This means actions can only be invoked for a specific build.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> We don't recommend relying on encryption alone to prevent sensitive values from being exposed on the client. Instead, you should use the <a href=\"patterns#preventing-sensitive-data-from-being-exposed-to-the-client\">React taint APIs</a> to proactively prevent specific data from being sent to the client.</p> </blockquote> <h3 id=\"overwriting-encryption-keys-advanced\" data-docs-heading=\"\">Overwriting encryption keys (advanced)     </h3> <p>When self-hosting your Next.js application across multiple servers, each server instance may end up with a different encryption key, leading to potential inconsistencies.</p> <p>To mitigate this, you can overwrite the encryption key using the <code>process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY</code> environment variable. Specifying this variable ensures that your encryption keys are persistent across builds, and all server instances use the same key.</p> <p>This is an advanced use case where consistent encryption behavior across multiple deployments is critical for your application. You should consider standard security practices such key rotation and signing.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> Next.js applications deployed to Vercel automatically handle this.</p> </blockquote> <h3 id=\"allowed-origins-advanced\" data-docs-heading=\"\">Allowed origins (advanced)     </h3> <p>Since Server Actions can be invoked in a <code>&lt;form&gt;</code> element, this opens them up to <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/CSRF\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">CSRF attacks</a>.</p> <p>Behind the scenes, Server Actions use the <code>POST</code> method, and only this HTTP method is allowed to invoke them. This prevents most CSRF vulnerabilities in modern browsers, particularly with <a href=\"https://web.dev/articles/samesite-cookies-explained\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SameSite cookies</a> being the default.</p> <p>As an additional protection, Server Actions in Next.js also compare the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Origin header</a> to the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Host\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Host header</a> (or <code>X-Forwarded-Host</code>). If these don't match, the request will be aborted. In other words, Server Actions can only be invoked on the same host as the page that hosts it.</p> <p>For large applications that use reverse proxies or multi-layered backend architectures (where the server API differs from the production domain), it's recommended to use the configuration option <a href=\"../../api-reference/next-config-js/serveractions\"><code>serverActions.allowedOrigins</code></a> option to specify a list of safe origins. The option accepts an array of strings.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nmodule.exports = {\n  experimental: {\n    serverActions: {\n      allowedOrigins: ['my-proxy.com', '*.my-proxy.com'],\n    },\n  },\n}</pre></div> <p>Learn more about <a href=\"https://nextjs.org/blog/security-nextjs-server-components-actions\" rel=\"noopener noreferrer\" target=\"_blank\">Security and Server Actions</a>.</p> <h2 id=\"additional-resources\" data-docs-heading=\"\">Additional resources     </h2> <p>For more information on Server Actions, check out the following React docs:</p> <ul> <li><a href=\"https://react.dev/reference/react/use-server\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>\"use server\"</code></a></li> <li><a href=\"https://react.dev/reference/react-dom/components/form\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>&lt;form&gt;</code></a></li> <li><a href=\"https://react.dev/reference/react-dom/hooks/useFormStatus\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useFormStatus</code></a></li> <li><a href=\"https://react.dev/reference/react-dom/hooks/useFormState\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useFormState</code></a></li> <li><a href=\"https://react.dev/reference/react/useOptimistic\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>useOptimistic</code></a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations</a>\n  </p>\n</div>\n","app/building-your-application/data-fetching/patterns":"<h1 class=\"break-words\">Patterns and Best Practices</h1>\n<p>There are a few recommended patterns and best practices for fetching data in React and Next.js. This page will go over some of the most common patterns and how to use them.</p> <h2 id=\"fetching-data-on-the-server\" data-docs-heading=\"\">Fetching data on the server     </h2> <p>Whenever possible, we recommend fetching data on the server with Server Components. This allows you to:</p> <ul> <li>Have direct access to backend data resources (e.g. databases).</li> <li>Keep your application more secure by preventing sensitive information, such as access tokens and API keys, from being exposed to the client.</li> <li>Fetch data and render in the same environment. This reduces both the back-and-forth communication between client and server, as well as the <a href=\"https://vercel.com/blog/how-react-18-improves-application-performance\" rel=\"noopener noreferrer\" target=\"_blank\">work on the main thread</a> on the client.</li> <li>Perform multiple data fetches with single round-trip instead of multiple individual requests on the client.</li> <li>Reduce client-server <a href=\"#parallel-and-sequential-data-fetching\">waterfalls</a>.</li> <li>Depending on your region, data fetching can also happen closer to your data source, reducing latency and improving performance.</li> </ul> <p>Then, you can mutate or update data with <a href=\"server-actions-and-mutations\">Server Actions</a>.</p> <h2 id=\"fetching-data-where-its-needed\" data-docs-heading=\"\">Fetching data where it's needed     </h2> <p>If you need to use the same data (e.g. current user) in multiple components in a tree, you do not have to fetch data globally, nor forward props between components. Instead, you can use <code>fetch</code> or React <code>cache</code> in the component that needs the data without worrying about the performance implications of making multiple requests for the same data.</p> <p>This is possible because <code>fetch</code> requests are automatically memoized. Learn more about <a href=\"../caching#request-memoization\">request memoization</a></p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This also applies to layouts, since it's not possible to pass data between a parent layout and its children.</p> </blockquote> <h2 id=\"streaming\" data-docs-heading=\"\">Streaming     </h2> <p>Streaming and <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Suspense</a> are React features that allow you to progressively render and incrementally stream rendered units of the UI to the client.</p> <p>With Server Components and <a href=\"../routing/pages-and-layouts\">nested layouts</a>, you're able to instantly render parts of the page that do not specifically require data, and show a <a href=\"../routing/loading-ui-and-streaming\">loading state</a> for parts of the page that are fetching data. This means the user does not have to wait for the entire page to load before they can start interacting with it.</p> <figure><img alt=\"Server Rendering with Streaming\" loading=\"lazy\" width=\"1600\" height=\"785\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75\"><img alt=\"Server Rendering with Streaming\" loading=\"lazy\" width=\"1600\" height=\"785\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75\"></figure> <p>To learn more about Streaming and Suspense, see the <a href=\"../routing/loading-ui-and-streaming\">Loading UI</a> and <a href=\"../routing/loading-ui-and-streaming#streaming-with-suspense\">Streaming and Suspense</a> pages.</p> <h2 id=\"parallel-and-sequential-data-fetching\" data-docs-heading=\"\">Parallel and sequential data fetching     </h2> <p>When fetching data inside React components, you need to be aware of two data fetching patterns: Parallel and Sequential.</p> <figure><img alt=\"Sequential and Parallel Data Fetching\" loading=\"lazy\" width=\"1600\" height=\"525\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fsequential-parallel-data-fetching.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fsequential-parallel-data-fetching.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fsequential-parallel-data-fetching.png&amp;w=3840&amp;q=75\"><img alt=\"Sequential and Parallel Data Fetching\" loading=\"lazy\" width=\"1600\" height=\"525\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fsequential-parallel-data-fetching.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fsequential-parallel-data-fetching.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fsequential-parallel-data-fetching.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>With <strong>sequential data fetching</strong>, requests in a route are dependent on each other and therefore create waterfalls. There may be cases where you want this pattern because one fetch depends on the result of the other, or you want a condition to be satisfied before the next fetch to save resources. However, this behavior can also be unintentional and lead to longer loading times.</li> <li>With <strong>parallel data fetching</strong>, requests in a route are eagerly initiated and will load data at the same time. This reduces client-server waterfalls and the total time it takes to load data.</li> </ul> <h3 id=\"sequential-data-fetching\" data-docs-heading=\"\">Sequential Data Fetching     </h3> <p>If you have nested components, and each component fetches its own data, then data fetching will happen sequentially if those data requests are different (this doesn't apply to requests for the same data as they are automatically <a href=\"../caching#request-memoization\">memoized</a>).</p> <p>For example, the <code>Playlists</code> component will only start fetching data once the <code>Artist</code> component has finished fetching data because <code>Playlists</code> depends on the <code>artistID</code> prop:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// ...\n \nasync function Playlists({ artistID }: { artistID: string }) {\n  // Wait for the playlists\n  const playlists = await getArtistPlaylists(artistID)\n \n  return (\n    &lt;ul&gt;\n      {playlists.map((playlist) =&gt; (\n        &lt;li key={playlist.id}&gt;{playlist.name}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}\n \nexport default async function Page({\n  params: { username },\n}: {\n  params: { username: string }\n}) {\n  // Wait for the artist\n  const artist = await getArtist(username)\n \n  return (\n    &lt;&gt;\n      &lt;h1&gt;{artist.name}&lt;/h1&gt;\n      &lt;Suspense fallback={&lt;div&gt;Loading...&lt;/div&gt;}&gt;\n        &lt;Playlists artistID={artist.id} /&gt;\n      &lt;/Suspense&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>In cases like this, you can use <a href=\"../routing/loading-ui-and-streaming\"><code>loading.js</code></a> (for route segments) or <a href=\"../routing/loading-ui-and-streaming#streaming-with-suspense\">React <code>&lt;Suspense&gt;</code></a> (for nested components) to show an instant loading state while React streams in the result.</p> <p>This will prevent the whole route from being blocked by data fetching, and the user will be able to interact with the parts of the page that are not blocked.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Blocking Data Requests:</strong></p> <p>An alternative approach to prevent waterfalls is to fetch data globally, at the root of your application, but this will block rendering for all route segments beneath it until the data has finished loading. This can be described as \"all or nothing\" data fetching. Either you have the entire data for your page or application, or none.</p> <p>Any fetch requests with <code>await</code> will block rendering and data fetching for the entire tree beneath it, unless they are wrapped in a <code>&lt;Suspense&gt;</code> boundary or <code>loading.js</code> is used. Another alternative is to use <a href=\"#parallel-data-fetching\">parallel data fetching</a> or the <a href=\"#preloading-data\">preload pattern</a>.</p> </blockquote> <h3 id=\"parallel-data-fetching\" data-docs-heading=\"\">Parallel Data Fetching     </h3> <p>To fetch data in parallel, you can eagerly initiate requests by defining them outside the components that use the data, then calling them from inside the component. This saves time by initiating both requests in parallel, however, the user won't see the rendered result until both promises are resolved.</p> <p>In the example below, the <code>getArtist</code> and <code>getArtistAlbums</code> functions are defined outside the <code>Page</code> component, then called inside the component, and we wait for both promises to resolve:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Albums from './albums'\n \nasync function getArtist(username: string) {\n  const res = await fetch(`https://api.example.com/artist/${username}`)\n  return res.json()\n}\n \nasync function getArtistAlbums(username: string) {\n  const res = await fetch(`https://api.example.com/artist/${username}/albums`)\n  return res.json()\n}\n \nexport default async function Page({\n  params: { username },\n}: {\n  params: { username: string }\n}) {\n  // Initiate both requests in parallel\n  const artistData = getArtist(username)\n  const albumsData = getArtistAlbums(username)\n \n  // Wait for the promises to resolve\n  const [artist, albums] = await Promise.all([artistData, albumsData])\n \n  return (\n    &lt;&gt;\n      &lt;h1&gt;{artist.name}&lt;/h1&gt;\n      &lt;Albums list={albums}&gt;&lt;/Albums&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>To improve the user experience, you can add a <a href=\"../routing/loading-ui-and-streaming\">Suspense Boundary</a> to break up the rendering work and show part of the result as soon as possible.</p> <h2 id=\"preloading-data\" data-docs-heading=\"\">Preloading Data     </h2> <p>Another way to prevent waterfalls is to use the preload pattern. You can optionally create a <code>preload</code> function to further optimize parallel data fetching. With this approach, you don't have to pass promises down as props. The <code>preload</code> function can also have any name as it's a pattern, not an API.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getItem } from '@/utils/get-item'\n \nexport const preload = (id: string) =&gt; {\n  // void evaluates the given expression and returns undefined\n  // https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/void\n  void getItem(id)\n}\nexport default async function Item({ id }: { id: string }) {\n  const result = await getItem(id)\n  // ...\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Item, { preload, checkIsAvailable } from '@/components/Item'\n \nexport default async function Page({\n  params: { id },\n}: {\n  params: { id: string }\n}) {\n  // starting loading item data\n  preload(id)\n  // perform another asynchronous task\n  const isAvailable = await checkIsAvailable()\n \n  return isAvailable ? &lt;Item id={id} /&gt; : null\n}</pre></div>  <h3 id=\"using-react-cache-server-only-and-the-preload-pattern\" data-docs-heading=\"\">Using React cache, server-only, and the Preload Pattern     </h3> <p>You can combine the <code>cache</code> function, the <code>preload</code> pattern, and the <code>server-only</code> package to create a data fetching utility that can be used throughout your app.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cache } from 'react'\nimport 'server-only'\n \nexport const preload = (id: string) =&gt; {\n  void getItem(id)\n}\n \nexport const getItem = cache(async (id: string) =&gt; {\n  // ...\n})</pre></div>  <p>With this approach, you can eagerly fetch data, cache responses, and guarantee that this data fetching <a href=\"../rendering/composition-patterns#keeping-server-only-code-out-of-the-client-environment\">only happens on the server</a>.</p> <p>The <code>utils/get-item</code> exports can be used by Layouts, Pages, or other components to give them control over when an item's data is fetched.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>We recommend using the <a href=\"../rendering/composition-patterns#keeping-server-only-code-out-of-the-client-environment\"><code>server-only</code> package</a> to make sure server data fetching functions are never used on the client.</li> </ul> </blockquote> <h2 id=\"preventing-sensitive-data-from-being-exposed-to-the-client\" data-docs-heading=\"\">Preventing sensitive data from being exposed to the client     </h2> <p>We recommend using React's taint APIs, <a href=\"https://react.dev/reference/react/experimental_taintObjectReference\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>taintObjectReference</code></a> and <a href=\"https://react.dev/reference/react/experimental_taintUniqueValue\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>taintUniqueValue</code></a>, to prevent whole object instances or sensitive values from being passed to the client.</p> <p>To enable tainting in your application, set the Next.js Config <code>experimental.taint</code> option to <code>true</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    taint: true,\n  },\n}</pre></div> <p>Then pass the object or value you want to taint to the <code>experimental_taintObjectReference</code> or <code>experimental_taintUniqueValue</code> functions:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { queryDataFromDB } from './api'\nimport {\n  experimental_taintObjectReference,\n  experimental_taintUniqueValue,\n} from 'react'\n \nexport async function getUserData() {\n  const data = await queryDataFromDB()\n  experimental_taintObjectReference(\n    'Do not pass the whole user object to the client',\n    data\n  )\n  experimental_taintUniqueValue(\n    \"Do not pass the user's address to the client\",\n    data,\n    data.address\n  )\n  return data\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getUserData } from './data'\n \nexport async function Page() {\n  const userData = getUserData()\n  return (\n    &lt;ClientComponent\n      user={userData} // this will cause an error because of taintObjectReference\n      address={userData.address} // this will cause an error because of taintUniqueValue\n    /&gt;\n  )\n}</pre></div>  <p>Learn more about <a href=\"https://nextjs.org/blog/security-nextjs-server-components-actions\" rel=\"noopener noreferrer\" target=\"_blank\">Security and Server Actions</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching/patterns\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/data-fetching/patterns</a>\n  </p>\n</div>\n","app/building-your-application/rendering/server-components":"<h1 class=\"break-words\">Server Components</h1>\n<p>React Server Components allow you to write UI that can be rendered and optionally cached on the server. In Next.js, the rendering work is further split by route segments to enable streaming and partial rendering, and there are three different server rendering strategies:</p> <ul> <li><a href=\"#static-rendering-default\">Static Rendering</a></li> <li><a href=\"#dynamic-rendering\">Dynamic Rendering</a></li> <li><a href=\"#streaming\">Streaming</a></li> </ul> <p>This page will go through how Server Components work, when you might use them, and the different server rendering strategies.</p> <h2 id=\"benefits-of-server-rendering\" data-docs-heading=\"\">Benefits of Server Rendering     </h2> <p>There are a couple of benefits to doing the rendering work on the server, including:</p> <ul> <li>\n<strong>Data Fetching</strong>: Server Components allow you to move data fetching to the server, closer to your data source. This can improve performance by reducing time it takes to fetch data needed for rendering, and the number of requests the client needs to make.</li> <li>\n<strong>Security</strong>: Server Components allow you to keep sensitive data and logic on the server, such as tokens and API keys, without the risk of exposing them to the client.</li> <li>\n<strong>Caching</strong>: By rendering on the server, the result can be cached and reused on subsequent requests and across users. This can improve performance and reduce cost by reducing the amount of rendering and data fetching done on each request.</li> <li>\n<strong>Performance</strong>: Server Components give you additional tools to optimize performance from the baseline. For example, if you start with an app composed of entirely Client Components, moving non-interactive pieces of your UI to Server Components can reduce the amount of client-side JavaScript needed. This is beneficial for users with slower internet or less powerful devices, as the browser has less client-side JavaScript to download, parse, and execute.</li> <li>\n<strong>Initial Page Load and <a href=\"https://web.dev/fcp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Contentful Paint (FCP)</a></strong>: On the server, we can generate HTML to allow users to view the page immediately, without waiting for the client to download, parse and execute the JavaScript needed to render the page.</li> <li>\n<strong>Search Engine Optimization and Social Network Shareability</strong>: The rendered HTML can be used by search engine bots to index your pages and social network bots to generate social card previews for your pages.</li> <li>\n<strong>Streaming</strong>: Server Components allow you to split the rendering work into chunks and stream them to the client as they become ready. This allows the user to see parts of the page earlier without having to wait for the entire page to be rendered on the server.</li> </ul> <h2 id=\"using-server-components-in-nextjs\" data-docs-heading=\"\">Using Server Components in Next.js     </h2> <p>By default, Next.js uses Server Components. This allows you to automatically implement server rendering with no additional configuration, and you can opt into using Client Components when needed, see <a href=\"client-components\">Client Components</a>.</p> <h2 id=\"how-are-server-components-rendered\" data-docs-heading=\"\">How are Server Components rendered?     </h2> <p>On the server, Next.js uses React's APIs to orchestrate rendering. The rendering work is split into chunks: by individual route segments and <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Suspense Boundaries</a>.</p> <p>Each chunk is rendered in two steps:</p> <ol> <li>React renders Server Components into a special data format called the <strong>React Server Component Payload (RSC Payload)</strong>.</li> <li>Next.js uses the RSC Payload and Client Component JavaScript instructions to render <strong>HTML</strong> on the server.</li> </ol>  <p>Then, on the client:</p> <ol> <li>The HTML is used to immediately show a fast non-interactive preview of the route - this is for the initial page load only.</li> <li>The React Server Components Payload is used to reconcile the Client and Server Component trees, and update the DOM.</li> <li>The JavaScript instructions are used to <a href=\"https://react.dev/reference/react-dom/client/hydrateRoot\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">hydrate</a> Client Components and make the application interactive.</li> </ol> <blockquote class=\"p-3 text-sm\"> <p><strong>What is the React Server Component Payload (RSC)?</strong></p> <p>The RSC Payload is a compact binary representation of the rendered React Server Components tree. It's used by React on the client to update the browser's DOM. The RSC Payload contains:</p> <ul> <li>The rendered result of Server Components</li> <li>Placeholders for where Client Components should be rendered and references to their JavaScript files</li> <li>Any props passed from a Server Component to a Client Component</li> </ul> </blockquote> <h2 id=\"server-rendering-strategies\" data-docs-heading=\"\">Server Rendering Strategies     </h2> <p>There are three subsets of server rendering: Static, Dynamic, and Streaming.</p> <h3 id=\"static-rendering-default\" data-docs-heading=\"\">Static Rendering (Default)     </h3>  <p>With Static Rendering, routes are rendered at <strong>build time</strong>, or in the background after <a href=\"../data-fetching/fetching-caching-and-revalidating#revalidating-data\">data revalidation</a>. The result is cached and can be pushed to a <a href=\"https://developer.mozilla.org/docs/Glossary/CDN\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Content Delivery Network (CDN)</a>. This optimization allows you to share the result of the rendering work between users and server requests.</p> <p>Static rendering is useful when a route has data that is not personalized to the user and can be known at build time, such as a static blog post or a product page.</p> <h3 id=\"dynamic-rendering\" data-docs-heading=\"\">Dynamic Rendering     </h3>  <p>With Dynamic Rendering, routes are rendered for each user at <strong>request time</strong>.</p> <p>Dynamic rendering is useful when a route has data that is personalized to the user or has information that can only be known at request time, such as cookies or the URL's search params.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Dynamic Routes with Cached Data</strong></p> <p>In most websites, routes are not fully static or fully dynamic - it's a spectrum. For example, you can have an e-commerce page that uses cached product data that's revalidated at an interval, but also has uncached, personalized customer data.</p> <p>In Next.js, you can have dynamically rendered routes that have both cached and uncached data. This is because the RSC Payload and data are cached separately. This allows you to opt into dynamic rendering without worrying about the performance impact of fetching all the data at request time.</p> <p>Learn more about the <a href=\"../caching#full-route-cache\">full-route cache</a> and <a href=\"../caching#data-cache\">Data Cache</a>.</p> </blockquote> <h4 id=\"switching-to-dynamic-rendering\" data-docs-heading=\"\">Switching to Dynamic Rendering     </h4> <p>During rendering, if a <a href=\"#dynamic-functions\">dynamic function</a> or <a href=\"../data-fetching/fetching-caching-and-revalidating#opting-out-of-data-caching\">uncached data request</a> is discovered, Next.js will switch to dynamically rendering the whole route. This table summarizes how dynamic functions and data caching affect whether a route is statically or dynamically rendered:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Dynamic Functions</th>\n<th>Data</th>\n<th>Route</th>\n</tr></thead>\n<tbody>\n<tr>\n<td>No</td>\n<td>Cached</td>\n<td>Statically Rendered</td>\n</tr>\n<tr>\n<td>Yes</td>\n<td>Cached</td>\n<td>Dynamically Rendered</td>\n</tr>\n<tr>\n<td>No</td>\n<td>Not Cached</td>\n<td>Dynamically Rendered</td>\n</tr>\n<tr>\n<td>Yes</td>\n<td>Not Cached</td>\n<td>Dynamically Rendered</td>\n</tr>\n</tbody>\n</table></div> <p>In the table above, for a route to be fully static, all data must be cached. However, you can have a dynamically rendered route that uses both cached and uncached data fetches.</p> <p>As a developer, you do not need to choose between static and dynamic rendering as Next.js will automatically choose the best rendering strategy for each route based on the features and APIs used. Instead, you choose when to <a href=\"../data-fetching/fetching-caching-and-revalidating\">cache or revalidate specific data</a>, and you may choose to <a href=\"#streaming\">stream</a> parts of your UI.</p> <h4 id=\"dynamic-functions\" data-docs-heading=\"\">Dynamic Functions     </h4> <p>Dynamic functions rely on information that can only be known at request time such as a user's cookies, current requests headers, or the URL's search params. In Next.js, these dynamic functions are:</p> <ul> <li>\n<strong><a href=\"../../api-reference/functions/cookies\"><code>cookies()</code></a> and <a href=\"../../api-reference/functions/headers\"><code>headers()</code></a></strong>: Using these in a Server Component will opt the whole route into dynamic rendering at request time.</li> <li>\n<strong><a href=\"../../api-reference/file-conventions/page#searchparams-optional\"><code>searchParams</code></a></strong>: Using the <code>searchParams</code> prop on a <a href=\"../../api-reference/file-conventions/page\">Page</a> will opt the page into dynamic rendering at request time.</li> </ul> <p>Using any of these functions will opt the whole route into dynamic rendering at request time.</p> <h3 id=\"streaming\" data-docs-heading=\"\">Streaming     </h3> <figure><img alt=\"Diagram showing parallelization of route segments during streaming, showing data fetching, rendering, and hydration of individual chunks.\" loading=\"lazy\" width=\"1600\" height=\"525\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fsequential-parallel-data-fetching.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fsequential-parallel-data-fetching.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fsequential-parallel-data-fetching.png&amp;w=3840&amp;q=75\"><img alt=\"Diagram showing parallelization of route segments during streaming, showing data fetching, rendering, and hydration of individual chunks.\" loading=\"lazy\" width=\"1600\" height=\"525\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fsequential-parallel-data-fetching.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fsequential-parallel-data-fetching.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fsequential-parallel-data-fetching.png&amp;w=3840&amp;q=75\"></figure> <p>Streaming enables you to progressively render UI from the server. Work is split into chunks and streamed to the client as it becomes ready. This allows the user to see parts of the page immediately, before the entire content has finished rendering.</p> <figure><img alt=\"Diagram showing partially rendered page on the client, with loading UI for chunks that are being streamed.\" loading=\"lazy\" width=\"1600\" height=\"785\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75\"><img alt=\"Diagram showing partially rendered page on the client, with loading UI for chunks that are being streamed.\" loading=\"lazy\" width=\"1600\" height=\"785\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fserver-rendering-with-streaming.png&amp;w=3840&amp;q=75\"></figure> <p>Streaming is built into the Next.js App Router by default. This helps improve both the initial page loading performance, as well as UI that depends on slower data fetches that would block rendering the whole route. For example, reviews on a product page.</p> <p>You can start streaming route segments using <code>loading.js</code> and UI components with <a href=\"../routing/loading-ui-and-streaming\">React Suspense</a>. See the <a href=\"../routing/loading-ui-and-streaming\">Loading UI and Streaming</a> section for more information.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/rendering/server-components\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/rendering/server-components</a>\n  </p>\n</div>\n","app/building-your-application/rendering/client-components":"<h1 class=\"break-words\">Client Components</h1>\n<p>Client Components allow you to write interactive UI that is <a href=\"https://github.com/reactwg/server-components/discussions/4\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">prerendered on the server</a> and can use client JavaScript to run in the browser.</p> <p>This page will go through how Client Components work, how they're rendered, and when you might use them.</p> <h2 id=\"benefits-of-client-rendering\" data-docs-heading=\"\">Benefits of Client Rendering     </h2> <p>There are a couple of benefits to doing the rendering work on the client, including:</p> <ul> <li>\n<strong>Interactivity</strong>: Client Components can use state, effects, and event listeners, meaning they can provide immediate feedback to the user and update the UI.</li> <li>\n<strong>Browser APIs</strong>: Client Components have access to browser APIs, like <a href=\"https://developer.mozilla.org/docs/Web/API/Geolocation_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">geolocation</a> or <a href=\"https://developer.mozilla.org/docs/Web/API/Window/localStorage\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">localStorage</a>.</li> </ul> <h2 id=\"using-client-components-in-nextjs\" data-docs-heading=\"\">Using Client Components in Next.js     </h2> <p>To use Client Components, you can add the React <a href=\"https://react.dev/reference/react/use-client\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>\"use client\"</code> directive</a> at the top of a file, above your imports.</p> <p><code>\"use client\"</code> is used to declare a <a href=\"../rendering#network-boundary\">boundary</a> between a Server and Client Component modules. This means that by defining a <code>\"use client\"</code> in a file, all other modules imported into it, including child components, are considered part of the client bundle.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useState } from 'react'\n \nexport default function Counter() {\n  const [count, setCount] = useState(0)\n \n  return (\n    &lt;div&gt;\n      &lt;p&gt;You clicked {count} times&lt;/p&gt;\n      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;Click me&lt;/button&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>The diagram below shows that using <code>onClick</code> and <code>useState</code> in a nested component (<code>toggle.js</code>) will cause an error if the <code>\"use client\"</code> directive is not defined. This is because, by default, all components in the App Router are Server Components where these APIs are not available. By defining the <code>\"use client\"</code> directive in <code>toggle.js</code>, you can tell React to enter the client boundary where these APIs are available.</p> <figure><img alt=\"Use Client Directive and Network Boundary\" loading=\"lazy\" width=\"1600\" height=\"1320\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fuse-client-directive.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fuse-client-directive.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fuse-client-directive.png&amp;w=3840&amp;q=75\"><img alt=\"Use Client Directive and Network Boundary\" loading=\"lazy\" width=\"1600\" height=\"1320\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fuse-client-directive.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fuse-client-directive.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fuse-client-directive.png&amp;w=3840&amp;q=75\"></figure> <blockquote class=\"p-3 text-sm\"> <p><strong>Defining multiple <code>use client</code> entry points</strong>:</p> <p>You can define multiple \"use client\" entry points in your React Component tree. This allows you to split your application into multiple client bundles.</p> <p>However, <code>\"use client\"</code> doesn't need to be defined in every component that needs to be rendered on the client. Once you define the boundary, all child components and modules imported into it are considered part of the client bundle.</p> </blockquote> <h2 id=\"how-are-client-components-rendered\" data-docs-heading=\"\">How are Client Components Rendered?     </h2> <p>In Next.js, Client Components are rendered differently depending on whether the request is part of a full page load (an initial visit to your application or a page reload triggered by a browser refresh) or a subsequent navigation.</p> <h3 id=\"full-page-load\" data-docs-heading=\"\">Full page load     </h3> <p>To optimize the initial page load, Next.js will use React's APIs to render a static HTML preview on the server for both Client and Server Components. This means, when the user first visits your application, they will see the content of the page immediately, without having to wait for the client to download, parse, and execute the Client Component JavaScript bundle.</p> <p>On the server:</p> <ol> <li>React renders Server Components into a special data format called the <strong>React Server Component Payload (RSC Payload)</strong>, which includes references to Client Components.</li> <li>Next.js uses the RSC Payload and Client Component JavaScript instructions to render <strong>HTML</strong> for the route on the server.</li> </ol> <p>Then, on the client:</p> <ol> <li>The HTML is used to immediately show a fast non-interactive initial preview of the route.</li> <li>The React Server Components Payload is used to reconcile the Client and Server Component trees, and update the DOM.</li> <li>The JavaScript instructions are used to <a href=\"https://react.dev/reference/react-dom/client/hydrateRoot\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">hydrate</a> Client Components and make their UI interactive.</li> </ol> <blockquote class=\"p-3 text-sm\"> <p><strong>What is hydration?</strong></p> <p>Hydration is the process of attaching event listeners to the DOM, to make the static HTML interactive. Behind the scenes, hydration is done with the <a href=\"https://react.dev/reference/react-dom/client/hydrateRoot\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>hydrateRoot</code></a> React API.</p> </blockquote> <h3 id=\"subsequent-navigations\" data-docs-heading=\"\">Subsequent Navigations     </h3> <p>On subsequent navigations, Client Components are rendered entirely on the client, without the server-rendered HTML.</p> <p>This means the Client Component JavaScript bundle is downloaded and parsed. Once the bundle is ready, React will use the RSC Payload to reconcile the Client and Server Component trees, and update the DOM.</p> <h2 id=\"going-back-to-the-server-environment\" data-docs-heading=\"\">Going back to the Server Environment     </h2> <p>Sometimes, after you've declared the <code>\"use client\"</code> boundary, you may want to go back to the server environment. For example, you may want to reduce the client bundle size, fetch data on the server, or use an API that is only available on the server.</p> <p>You can keep code on the server even though it's theoretically nested inside Client Components by interleaving Client and Server Components and <a href=\"../data-fetching/server-actions-and-mutations\">Server Actions</a>. See the <a href=\"composition-patterns\">Composition Patterns</a> page for more information.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/rendering/client-components\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/rendering/client-components</a>\n  </p>\n</div>\n","app/building-your-application/rendering/composition-patterns":"<h1 class=\"break-words\">Server and Client Composition Patterns</h1>\n<p>When building React applications, you will need to consider what parts of your application should be rendered on the server or the client. This page covers some recommended composition patterns when using Server and Client Components.</p> <h2 id=\"when-to-use-server-and-client-components\" data-docs-heading=\"\">When to use Server and Client Components?     </h2> <p>Here's a quick summary of the different use cases for Server and Client Components:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>What do you need to do?</th>\n<th>Server Component</th>\n<th>Client Component</th>\n</tr></thead>\n<tbody>\n<tr>\n<td>Fetch data</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Access backend resources (directly)</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Keep sensitive information on the server (access tokens, API keys, etc)</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Keep large dependencies on the server / Reduce client-side JavaScript</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Add interactivity and event listeners (<code>onClick()</code>, <code>onChange()</code>, etc)</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Use State and Lifecycle Effects (<code>useState()</code>, <code>useReducer()</code>, <code>useEffect()</code>, etc)</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Use browser-only APIs</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Use custom hooks that depend on state, effects, or browser-only APIs</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>Use <a href=\"https://react.dev/reference/react/Component\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Class components</a>\n</td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"server-component-patterns\" data-docs-heading=\"\">Server Component Patterns     </h2> <p>Before opting into client-side rendering, you may wish to do some work on the server like fetching data, or accessing your database or backend services.</p> <p>Here are some common patterns when working with Server Components:</p> <h3 id=\"sharing-data-between-components\" data-docs-heading=\"\">Sharing data between components     </h3> <p>When fetching data on the server, there may be cases where you need to share data across different components. For example, you may have a layout and a page that depend on the same data.</p> <p>Instead of using <a href=\"https://react.dev/learn/passing-data-deeply-with-context\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Context</a> (which is not available on the server) or passing data as props, you can use <a href=\"../data-fetching/fetching-caching-and-revalidating#fetching-data-on-the-server-with-fetch\"><code>fetch</code></a> or React's <code>cache</code> function to fetch the same data in the components that need it, without worrying about making duplicate requests for the same data. This is because React extends <code>fetch</code> to automatically memoize data requests, and the <code>cache</code> function can be used when <code>fetch</code> is not available.</p> <p>Learn more about <a href=\"../caching#request-memoization\">memoization</a> in React.</p> <h3 id=\"keeping-server-only-code-out-of-the-client-environment\" data-docs-heading=\"\">Keeping Server-only Code out of the Client Environment     </h3> <p>Since JavaScript modules can be shared between both Server and Client Components modules, it's possible for code that was only ever intended to be run on the server to sneak its way into the client.</p> <p>For example, take the following data-fetching function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getData() {\n  const res = await fetch('https://external-service.com/data', {\n    headers: {\n      authorization: process.env.API_KEY,\n    },\n  })\n \n  return res.json()\n}</pre></div>  <p>At first glance, it appears that <code>getData</code> works on both the server and the client. However, this function contains an <code>API_KEY</code>, written with the intention that it would only ever be executed on the server.</p> <p>Since the environment variable <code>API_KEY</code> is not prefixed with <code>NEXT_PUBLIC</code>, it's a private variable that can only be accessed on the server. To prevent your environment variables from being leaked to the client, Next.js replaces private environment variables with an empty string.</p> <p>As a result, even though <code>getData()</code> can be imported and executed on the client, it won't work as expected. And while making the variable public would make the function work on the client, you may not want to expose sensitive information to the client.</p> <p>To prevent this sort of unintended client usage of server code, we can use the <code>server-only</code> package to give other developers a build-time error if they ever accidentally import one of these modules into a Client Component.</p> <p>To use <code>server-only</code>, first install the package:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install server-only</pre></div> <p>Then import the package into any module that contains server-only code:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import 'server-only'\n \nexport async function getData() {\n  const res = await fetch('https://external-service.com/data', {\n    headers: {\n      authorization: process.env.API_KEY,\n    },\n  })\n \n  return res.json()\n}</pre></div> <p>Now, any Client Component that imports <code>getData()</code> will receive a build-time error explaining that this module can only be used on the server.</p> <p>The corresponding package <code>client-only</code> can be used to mark modules that contain client-only code  for example, code that accesses the <code>window</code> object.</p> <h3 id=\"using-third-party-packages-and-providers\" data-docs-heading=\"\">Using Third-party Packages and Providers     </h3> <p>Since Server Components are a new React feature, third-party packages and providers in the ecosystem are just beginning to add the <code>\"use client\"</code> directive to components that use client-only features like <code>useState</code>, <code>useEffect</code>, and <code>createContext</code>.</p> <p>Today, many components from <code>npm</code> packages that use client-only features do not yet have the directive. These third-party components will work as expected within Client Components since they have the <code>\"use client\"</code> directive, but they won't work within Server Components.</p> <p>For example, let's say you've installed the hypothetical <code>acme-carousel</code> package which has a <code>&lt;Carousel /&gt;</code> component. This component uses <code>useState</code>, but it doesn't yet have the <code>\"use client\"</code> directive.</p> <p>If you use <code>&lt;Carousel /&gt;</code> within a Client Component, it will work as expected:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useState } from 'react'\nimport { Carousel } from 'acme-carousel'\n \nexport default function Gallery() {\n  let [isOpen, setIsOpen] = useState(false)\n \n  return (\n    &lt;div&gt;\n      &lt;button onClick={() =&gt; setIsOpen(true)}&gt;View pictures&lt;/button&gt;\n \n      {/* Works, since Carousel is used within a Client Component */}\n      {isOpen &amp;&amp; &lt;Carousel /&gt;}\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>However, if you try to use it directly within a Server Component, you'll see an error:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Carousel } from 'acme-carousel'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;p&gt;View pictures&lt;/p&gt;\n \n      {/* Error: `useState` can not be used within Server Components */}\n      &lt;Carousel /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>This is because Next.js doesn't know <code>&lt;Carousel /&gt;</code> is using client-only features.</p> <p>To fix this, you can wrap third-party components that rely on client-only features in your own Client Components:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { Carousel } from 'acme-carousel'\n \nexport default Carousel</pre></div>  <p>Now, you can use <code>&lt;Carousel /&gt;</code> directly within a Server Component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Carousel from './carousel'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;p&gt;View pictures&lt;/p&gt;\n \n      {/*  Works, since Carousel is a Client Component */}\n      &lt;Carousel /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>We don't expect you to need to wrap most third-party components since it's likely you'll be using them within Client Components. However, one exception is providers, since they rely on React state and context, and are typically needed at the root of an application. <a href=\"#using-context-providers\">Learn more about third-party context providers below</a>.</p> <h4 id=\"using-context-providers\" data-docs-heading=\"\">Using Context Providers     </h4> <p>Context providers are typically rendered near the root of an application to share global concerns, like the current theme. Since <a href=\"https://react.dev/learn/passing-data-deeply-with-context\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React context</a> is not supported in Server Components, trying to create a context at the root of your application will cause an error:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { createContext } from 'react'\n \n//  createContext is not supported in Server Components\nexport const ThemeContext = createContext({})\n \nexport default function RootLayout({ children }) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;ThemeContext.Provider value=\"dark\"&gt;{children}&lt;/ThemeContext.Provider&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>To fix this, create your context and render its provider inside of a Client Component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { createContext } from 'react'\n \nexport const ThemeContext = createContext({})\n \nexport default function ThemeProvider({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return &lt;ThemeContext.Provider value=\"dark\"&gt;{children}&lt;/ThemeContext.Provider&gt;\n}</pre></div>  <p>Your Server Component will now be able to directly render your provider since it's been marked as a Client Component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import ThemeProvider from './theme-provider'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;ThemeProvider&gt;{children}&lt;/ThemeProvider&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>With the provider rendered at the root, all other Client Components throughout your app will be able to consume this context.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You should render providers as deep as possible in the tree  notice how <code>ThemeProvider</code> only wraps <code>{children}</code> instead of the entire <code>&lt;html&gt;</code> document. This makes it easier for Next.js to optimize the static parts of your Server Components.</p> </blockquote> <h4 id=\"advice-for-library-authors\" data-docs-heading=\"\">Advice for Library Authors     </h4> <p>In a similar fashion, library authors creating packages to be consumed by other developers can use the <code>\"use client\"</code> directive to mark client entry points of their package. This allows users of the package to import package components directly into their Server Components without having to create a wrapping boundary.</p> <p>You can optimize your package by using <a href=\"#moving-client-components-down-the-tree\">'use client' deeper in the tree</a>, allowing the imported modules to be part of the Server Component module graph.</p> <p>It's worth noting some bundlers might strip out <code>\"use client\"</code> directives. You can find an example of how to configure esbuild to include the <code>\"use client\"</code> directive in the <a href=\"https://github.com/shuding/react-wrap-balancer/blob/main/tsup.config.ts#L10-L13\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Wrap Balancer</a> and <a href=\"https://github.com/vercel/analytics/blob/main/packages/web/tsup.config.js#L26-L30\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Analytics</a> repositories.</p> <h2 id=\"client-components\" data-docs-heading=\"\">Client Components     </h2> <h3 id=\"moving-client-components-down-the-tree\" data-docs-heading=\"\">Moving Client Components Down the Tree     </h3> <p>To reduce the Client JavaScript bundle size, we recommend moving Client Components down your component tree.</p> <p>For example, you may have a Layout that has static elements (e.g. logo, links, etc) and an interactive search bar that uses state.</p> <p>Instead of making the whole layout a Client Component, move the interactive logic to a Client Component (e.g. <code>&lt;SearchBar /&gt;</code>) and keep your layout as a Server Component. This means you don't have to send all the component Javascript of the layout to the client.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// SearchBar is a Client Component\nimport SearchBar from './searchbar'\n// Logo is a Server Component\nimport Logo from './logo'\n \n// Layout is a Server Component by default\nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    &lt;&gt;\n      &lt;nav&gt;\n        &lt;Logo /&gt;\n        &lt;SearchBar /&gt;\n      &lt;/nav&gt;\n      &lt;main&gt;{children}&lt;/main&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"passing-props-from-server-to-client-components-serialization\" data-docs-heading=\"\">Passing props from Server to Client Components (Serialization)     </h3> <p>If you fetch data in a Server Component, you may want to pass data down as props to Client Components. Props passed from the Server to Client Components need to be <a href=\"https://react.dev/reference/react/use-server#serializable-parameters-and-return-values\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">serializable</a> by React.</p> <p>If your Client Components depend on data that is not serializable, you can <a href=\"../data-fetching/fetching-caching-and-revalidating#fetching-data-on-the-client-with-third-party-libraries\">fetch data on the client with a third party library</a> or on the server via a <a href=\"../routing/route-handlers\">Route Handler</a>.</p> <h2 id=\"interleaving-server-and-client-components\" data-docs-heading=\"\">Interleaving Server and Client Components     </h2> <p>When interleaving Client and Server Components, it may be helpful to visualize your UI as a tree of components. Starting with the <a href=\"../routing/pages-and-layouts#root-layout-required\">root layout</a>, which is a Server Component, you can then render certain subtrees of components on the client by adding the <code>\"use client\"</code> directive.</p>  <p>Within those client subtrees, you can still nest Server Components or call Server Actions, however there are some things to keep in mind:</p> <ul> <li>During a request-response lifecycle, your code moves from the server to the client. If you need to access data or resources on the server while on the client, you'll be making a <strong>new</strong> request to the server - not switching back and forth.</li> <li>When a new request is made to the server, all Server Components are rendered first, including those nested inside Client Components. The rendered result (RSC Payload) will contain references to the locations of Client Components. Then, on the client, React uses the RSC Payload to reconcile Server and Client Components into a single tree.</li> </ul>  <ul> <li>Since Client Components are rendered after Server Components, you cannot import a Server Component into a Client Component module (since it would require a new request back to the server). Instead, you can pass a Server Component as <code>props</code> to a Client Component. See the <a href=\"#unsupported-pattern-importing-server-components-into-client-components\">unsupported pattern</a> and <a href=\"#supported-pattern-passing-server-components-to-client-components-as-props\">supported pattern</a> sections below.</li> </ul> <h3 id=\"unsupported-pattern-importing-server-components-into-client-components\" data-docs-heading=\"\">Unsupported Pattern: Importing Server Components into Client Components     </h3> <p>The following pattern is not supported. You cannot import a Server Component into a Client Component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \n// You cannot import a Server Component into a Client Component.\nimport ServerComponent from './Server-Component'\n \nexport default function ClientComponent({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const [count, setCount] = useState(0)\n \n  return (\n    &lt;&gt;\n      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;{count}&lt;/button&gt;\n \n      &lt;ServerComponent /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"supported-pattern-passing-server-components-to-client-components-as-props\" data-docs-heading=\"\">Supported Pattern: Passing Server Components to Client Components as Props     </h3> <p>The following pattern is supported. You can pass Server Components as a prop to a Client Component.</p> <p>A common pattern is to use the React <code>children</code> prop to create a <em>\"slot\"</em> in your Client Component.</p> <p>In the example below, <code>&lt;ClientComponent&gt;</code> accepts a <code>children</code> prop:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useState } from 'react'\n \nexport default function ClientComponent({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const [count, setCount] = useState(0)\n \n  return (\n    &lt;&gt;\n      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;{count}&lt;/button&gt;\n      {children}\n    &lt;/&gt;\n  )\n}</pre></div>  <p><code>&lt;ClientComponent&gt;</code> doesn't know that <code>children</code> will eventually be filled in by the result of a Server Component. The only responsibility <code>&lt;ClientComponent&gt;</code> has is to decide <strong>where</strong> <code>children</code> will eventually be placed.</p> <p>In a parent Server Component, you can import both the <code>&lt;ClientComponent&gt;</code> and <code>&lt;ServerComponent&gt;</code> and pass <code>&lt;ServerComponent&gt;</code> as a child of <code>&lt;ClientComponent&gt;</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// This pattern works:\n// You can pass a Server Component as a child or prop of a\n// Client Component.\nimport ClientComponent from './client-component'\nimport ServerComponent from './server-component'\n \n// Pages in Next.js are Server Components by default\nexport default function Page() {\n  return (\n    &lt;ClientComponent&gt;\n      &lt;ServerComponent /&gt;\n    &lt;/ClientComponent&gt;\n  )\n}</pre></div>  <p>With this approach, <code>&lt;ClientComponent&gt;</code> and <code>&lt;ServerComponent&gt;</code> are decoupled and can be rendered independently. In this case, the child <code>&lt;ServerComponent&gt;</code> can be rendered on the server, well before <code>&lt;ClientComponent&gt;</code> is rendered on the client.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>The pattern of \"lifting content up\" has been used to avoid re-rendering a nested child component when a parent component re-renders.</li> <li>You're not limited to the <code>children</code> prop. You can use any prop to pass JSX.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/rendering/composition-patterns\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/rendering/composition-patterns</a>\n  </p>\n</div>\n","app/building-your-application/rendering/edge-and-nodejs-runtimes":"<h1 class=\"break-words\">Edge and Node.js Runtimes</h1> <p>In the context of Next.js, runtime refers to the set of libraries, APIs, and general functionality available to your code during execution.</p> <p>On the server, there are two runtimes where parts of your application code can be rendered:</p> <ul> <li>The <strong>Node.js Runtime</strong> (default) has access to all Node.js APIs and compatible packages from the ecosystem.</li> <li>The <strong>Edge Runtime</strong> is based on <a href=\"../../api-reference/edge\">Web APIs</a>.</li> </ul> <h2 id=\"runtime-differences\" data-docs-heading=\"\">Runtime Differences     </h2> <p>There are many considerations to make when choosing a runtime. This table shows the major differences at a glance. If you want a more in-depth analysis of the differences, check out the sections below.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th>Node</th>\n<th>Serverless</th>\n<th>Edge</th>\n</tr></thead>\n<tbody>\n<tr>\n<td>Cold Boot</td>\n<td>/</td>\n<td>Normal</td>\n<td>Low</td>\n</tr>\n<tr>\n<td><a href=\"../routing/loading-ui-and-streaming\">HTTP Streaming</a></td>\n<td>Yes</td>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td>IO</td>\n<td>All</td>\n<td>All</td>\n<td><code>fetch</code></td>\n</tr>\n<tr>\n<td>Scalability</td>\n<td>/</td>\n<td>High</td>\n<td>Highest</td>\n</tr>\n<tr>\n<td>Security</td>\n<td>Normal</td>\n<td>High</td>\n<td>High</td>\n</tr>\n<tr>\n<td>Latency</td>\n<td>Normal</td>\n<td>Low</td>\n<td>Lowest</td>\n</tr>\n<tr>\n<td>npm Packages</td>\n<td>All</td>\n<td>All</td>\n<td>A smaller subset</td>\n</tr>\n<tr>\n<td><a href=\"server-components#static-rendering-default\">Static Rendering</a></td>\n<td>Yes</td>\n<td>Yes</td>\n<td>No</td>\n</tr>\n<tr>\n<td><a href=\"server-components#dynamic-rendering\">Dynamic Rendering</a></td>\n<td>Yes</td>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"../data-fetching/fetching-caching-and-revalidating#revalidating-data\">Data Revalidation w/ <code>fetch</code></a></td>\n<td>Yes</td>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"edge-runtime\" data-docs-heading=\"\">Edge Runtime     </h3> <p>In Next.js, the lightweight Edge Runtime is a subset of available Node.js APIs.</p> <p>The Edge Runtime is ideal if you need to deliver dynamic, personalized content at low latency with small, simple functions. The Edge Runtime's speed comes from its minimal use of resources, but that can be limiting in many scenarios.</p> <p>For example, code executed in the Edge Runtime <a href=\"https://vercel.com/docs/concepts/limits/overview#edge-middleware-and-edge-functions-size\" rel=\"noopener noreferrer\" target=\"_blank\">on Vercel cannot exceed between 1 MB and 4 MB</a>, this limit includes imported packages, fonts and files, and will vary depending on your deployment infrastructure. In addition, the Edge Runtime does not support all Node.js APIs meaning some <code>npm</code> packages may not work. For example, \"Module not found: Can't resolve 'fs'\" or similar errors. We recommend using the Node.js runtime if you need to use these APIs or packages.</p> <h3 id=\"nodejs-runtime\" data-docs-heading=\"\">Node.js Runtime     </h3> <p>Using the Node.js runtime gives you access to all Node.js APIs, and all npm packages that rely on them. However, it's not as fast to start up as routes using the Edge runtime.</p> <p>Deploying your Next.js application to a Node.js server will require managing, scaling, and configuring your infrastructure. Alternatively, you can consider deploying your Next.js application to a serverless platform like Vercel, which will handle this for you.</p> <h3 id=\"serverless-nodejs\" data-docs-heading=\"\">Serverless Node.js     </h3> <p>Serverless is ideal if you need a scalable solution that can handle more complex computational loads than the Edge Runtime. With Serverless Functions on Vercel, for example, your overall code size is <a href=\"https://vercel.com/docs/concepts/limits/overview#serverless-function-size\" rel=\"noopener noreferrer\" target=\"_blank\">50MB</a> including imported packages, fonts, and files.</p> <p>The downside compared to routes using the <a href=\"https://vercel.com/docs/concepts/functions/edge-functions\" rel=\"noopener noreferrer\" target=\"_blank\">Edge</a> is that it can take hundreds of milliseconds for Serverless Functions to boot up before they begin processing requests. Depending on the amount of traffic your site receives, this could be a frequent occurrence as the functions are not frequently \"warm\".</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2>\n<h3 id=\"segment-runtime-option\" data-docs-heading=\"\">Segment Runtime Option     </h3>\n<p>You can specify a runtime for individual route segments in your Next.js application. To do so, <a href=\"../../api-reference/file-conventions/route-segment-config\">declare a variable called <code>runtime</code> and export it</a>. The variable must be a string, and must have a value of either <code>'nodejs'</code> or <code>'edge'</code> runtime.</p>\n<p>The following example demonstrates a page route segment that exports a <code>runtime</code> with a value of <code>'edge'</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const runtime = 'edge' // 'nodejs' (default) | 'edge'</pre></div>\n<p>You can also define <code>runtime</code> on a layout level, which will make all routes under the layout run on the edge runtime:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const runtime = 'edge' // 'nodejs' (default) | 'edge'</pre></div>\n<p>If the segment runtime is <em>not</em> set, the default <code>nodejs</code> runtime will be used. You do not need to use the <code>runtime</code> option if you do not plan to change from the Node.js runtime.</p> <blockquote class=\"p-3 text-sm\"> <p>Please refer to the <a href=\"https://nodejs.org/docs/latest/api/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.js Docs</a> and <a href=\"../../api-reference/edge\">Edge Docs</a> for the full list of available APIs. Both runtimes can also support <a href=\"../routing/loading-ui-and-streaming\">streaming</a> depending on your deployment infrastructure.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/rendering/edge-and-nodejs-runtimes\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/rendering/edge-and-nodejs-runtimes</a>\n  </p>\n</div>\n","app/building-your-application/styling":"<h1 class=\"break-words\">Styling</h1> <p>Next.js supports different ways of styling your application, including:</p> <ul> <li>\n<strong>Global CSS</strong>: Simple to use and familiar for those experienced with traditional CSS, but can lead to larger CSS bundles and difficulty managing styles as the application grows.</li> <li>\n<strong>CSS Modules</strong>: Create locally scoped CSS classes to avoid naming conflicts and improve maintainability.</li> <li>\n<strong>Tailwind CSS</strong>: A utility-first CSS framework that allows for rapid custom designs by composing utility classes.</li> <li>\n<strong>Sass</strong>: A popular CSS preprocessor that extends CSS with features like variables, nested rules, and mixins.</li> <li>\n<strong>CSS-in-JS</strong>: Embed CSS directly in your JavaScript components, enabling dynamic and scoped styling.</li> </ul> <p>Learn more about each approach by exploring their respective documentation:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/styling\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/styling</a>\n  </p>\n</div>\n","app/building-your-application/caching":"<h1 class=\"break-words\">Caching in Next.js</h1>\n<p>Next.js improves your application's performance and reduces costs by caching rendering work and data requests. This page provides an in-depth look at Next.js caching mechanisms, the APIs you can use to configure them, and how they interact with each other.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This page helps you understand how Next.js works under the hood but is <strong>not</strong> essential knowledge to be productive with Next.js. Most of Next.js' caching heuristics are determined by your API usage and have defaults for the best performance with zero or minimal configuration.</p> </blockquote> <h2 id=\"overview\" data-docs-heading=\"\">Overview     </h2> <p>Here's a high-level overview of the different caching mechanisms and their purpose:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Mechanism</th>\n<th>What</th>\n<th>Where</th>\n<th>Purpose</th>\n<th>Duration</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#request-memoization\">Request Memoization</a></td>\n<td>Return values of functions</td>\n<td>Server</td>\n<td>Re-use data in a React Component tree</td>\n<td>Per-request lifecycle</td>\n</tr>\n<tr>\n<td><a href=\"#data-cache\">Data Cache</a></td>\n<td>Data</td>\n<td>Server</td>\n<td>Store data across user requests and deployments</td>\n<td>Persistent (can be revalidated)</td>\n</tr>\n<tr>\n<td><a href=\"#full-route-cache\">Full Route Cache</a></td>\n<td>HTML and RSC payload</td>\n<td>Server</td>\n<td>Reduce rendering cost and improve performance</td>\n<td>Persistent (can be revalidated)</td>\n</tr>\n<tr>\n<td><a href=\"#router-cache\">Router Cache</a></td>\n<td>RSC Payload</td>\n<td>Client</td>\n<td>Reduce server requests on navigation</td>\n<td>User session or time-based</td>\n</tr>\n</tbody>\n</table></div> <p>By default, Next.js will cache as much as possible to improve performance and reduce cost. This means routes are <strong>statically rendered</strong> and data requests are <strong>cached</strong> unless you opt out. The diagram below shows the default caching behavior: when a route is statically rendered at build time and when a static route is first visited.</p> <figure><img alt=\"Diagram showing the default caching behavior in Next.js for the four mechanisms, with HIT, MISS and SET at build time and when a route is first visited.\" loading=\"lazy\" width=\"1600\" height=\"1179\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fcaching-overview.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fcaching-overview.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fcaching-overview.png&amp;w=3840&amp;q=75\"><img alt=\"Diagram showing the default caching behavior in Next.js for the four mechanisms, with HIT, MISS and SET at build time and when a route is first visited.\" loading=\"lazy\" width=\"1600\" height=\"1179\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fcaching-overview.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fcaching-overview.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fcaching-overview.png&amp;w=3840&amp;q=75\"></figure> <p>Caching behavior changes depending on whether the route is statically or dynamically rendered, data is cached or uncached, and whether a request is part of an initial visit or a subsequent navigation. Depending on your use case, you can configure the caching behavior for individual routes and data requests.</p> <h2 id=\"request-memoization\" data-docs-heading=\"\">Request Memoization     </h2> <p>React extends the <a href=\"#fetch\"><code>fetch</code> API</a> to automatically <strong>memoize</strong> requests that have the same URL and options. This means you can call a fetch function for the same data in multiple places in a React component tree while only executing it once.</p> <figure><img alt=\"Deduplicated Fetch Requests\" loading=\"lazy\" width=\"1600\" height=\"857\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fdeduplicated-fetch-requests.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fdeduplicated-fetch-requests.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fdeduplicated-fetch-requests.png&amp;w=3840&amp;q=75\"><img alt=\"Deduplicated Fetch Requests\" loading=\"lazy\" width=\"1600\" height=\"857\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fdeduplicated-fetch-requests.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fdeduplicated-fetch-requests.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fdeduplicated-fetch-requests.png&amp;w=3840&amp;q=75\"></figure> <p>For example, if you need to use the same data across a route (e.g. in a Layout, Page, and multiple components), you do not have to fetch data at the top of the tree, and forward props between components. Instead, you can fetch data in the components that need it without worrying about the performance implications of making multiple requests across the network for the same data.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">async function getItem() {\n  // The `fetch` function is automatically memoized and the result\n  // is cached\n  const res = await fetch('https://.../item/1')\n  return res.json()\n}\n \n// This function is called twice, but only executed the first time\nconst item = await getItem() // cache MISS\n \n// The second call could be anywhere in your route\nconst item = await getItem() // cache HIT</pre></div>  <p><strong>How Request Memoization Works</strong></p> <figure><img alt=\"Diagram showing how fetch memoization works during React rendering.\" loading=\"lazy\" width=\"1600\" height=\"742\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Frequest-memoization.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Frequest-memoization.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Frequest-memoization.png&amp;w=3840&amp;q=75\"><img alt=\"Diagram showing how fetch memoization works during React rendering.\" loading=\"lazy\" width=\"1600\" height=\"742\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Frequest-memoization.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Frequest-memoization.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Frequest-memoization.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>While rendering a route, the first time a particular request is called, its result will not be in memory and it'll be a cache <code>MISS</code>.</li> <li>Therefore, the function will be executed, and the data will be fetched from the external source, and the result will be stored in memory.</li> <li>Subsequent function calls of the request in the same render pass will be a cache <code>HIT</code>, and the data will be returned from memory without executing the function.</li> <li>Once the route has been rendered and the rendering pass is complete, memory is \"reset\" and all request memoization entries are cleared.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Request memoization is a React feature, not a Next.js feature. It's included here to show how it interacts with the other caching mechanisms.</li> <li>Memoization only applies to the <code>GET</code> method in <code>fetch</code> requests.</li> <li>Memoization only applies to the React Component tree, this means: <ul> <li>It applies to <code>fetch</code> requests in <code>generateMetadata</code>, <code>generateStaticParams</code>, Layouts, Pages, and other Server Components.</li> <li>It doesn't apply to <code>fetch</code> requests in Route Handlers as they are not a part of the React component tree.</li> </ul> </li> <li>For cases where <code>fetch</code> is not suitable (e.g. some database clients, CMS clients, or GraphQL clients), you can use the <a href=\"#react-cache-function\">React <code>cache</code> function</a> to memoize functions.</li> </ul> </blockquote> <h3 id=\"duration\" data-docs-heading=\"\">Duration     </h3> <p>The cache lasts the lifetime of a server request until the React component tree has finished rendering.</p> <h3 id=\"revalidating\" data-docs-heading=\"\">Revalidating     </h3> <p>Since the memoization is not shared across server requests and only applies during rendering, there is no need to revalidate it.</p> <h3 id=\"opting-out\" data-docs-heading=\"\">Opting out     </h3> <p>Memoization only applies to the <code>GET</code> method in <code>fetch</code> requests, other methods, such as <code>POST</code> and <code>DELETE</code>, are not memoized. This default behavior is a React optimization and we do not recommend opting out of it.</p> <p>To manage individual requests, you can use the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/AbortController/signal\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>signal</code></a> property from <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/AbortController\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>AbortController</code></a>. However, this will not opt requests out of memoization, rather, abort in-flight requests.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const { signal } = new AbortController()\nfetch(url, { signal })</pre></div> <h2 id=\"data-cache\" data-docs-heading=\"\">Data Cache     </h2> <p>Next.js has a built-in Data Cache that <strong>persists</strong> the result of data fetches across incoming <strong>server requests</strong> and <strong>deployments</strong>. This is possible because Next.js extends the native <code>fetch</code> API to allow each request on the server to set its own persistent caching semantics.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: In the browser, the <code>cache</code> option of <code>fetch</code> indicates how a request will interact with the browser's HTTP cache, in Next.js, the <code>cache</code> option indicates how a server-side request will interact with the server's Data Cache.</p> </blockquote> <p>By default, data requests that use <code>fetch</code> are <strong>cached</strong>. You can use the <a href=\"#fetch-optionscache\"><code>cache</code></a> and <a href=\"#fetch-optionsnextrevalidate\"><code>next.revalidate</code></a> options of <code>fetch</code> to configure the caching behavior.</p> <p><strong>How the Data Cache Works</strong></p> <figure><img alt=\"Diagram showing how cached and uncached fetch requests interact with the Data Cache. Cached requests are stored in the Data Cache, and memoized, uncached requests are fetched from the data source, not stored in the Data Cache, and memoized.\" loading=\"lazy\" width=\"1600\" height=\"661\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fdata-cache.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fdata-cache.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fdata-cache.png&amp;w=3840&amp;q=75\"><img alt=\"Diagram showing how cached and uncached fetch requests interact with the Data Cache. Cached requests are stored in the Data Cache, and memoized, uncached requests are fetched from the data source, not stored in the Data Cache, and memoized.\" loading=\"lazy\" width=\"1600\" height=\"661\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fdata-cache.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fdata-cache.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fdata-cache.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>The first time a <code>fetch</code> request is called during rendering, Next.js checks the Data Cache for a cached response.</li> <li>If a cached response is found, it's returned immediately and <a href=\"#request-memoization\">memoized</a>.</li> <li>If a cached response is not found, the request is made to the data source, the result is stored in the Data Cache, and memoized.</li> <li>For uncached data (e.g. <code>{ cache: 'no-store' }</code>), the result is always fetched from the data source, and memoized.</li> <li>Whether the data is cached or uncached, the requests are always memoized to avoid making duplicate requests for the same data during a React render pass.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Differences between the Data Cache and Request Memoization</strong></p> <p>While both caching mechanisms help improve performance by re-using cached data, the Data Cache is persistent across incoming requests and deployments, whereas memoization only lasts the lifetime of a request.</p> <p>With memoization, we reduce the number of <strong>duplicate</strong> requests in the same render pass that have to cross the network boundary from the rendering server to the Data Cache server (e.g. a CDN or Edge Network) or data source (e.g. a database or CMS). With the Data Cache, we reduce the number of requests made to our origin data source.</p> </blockquote> <h3 id=\"duration-1\" data-docs-heading=\"\">Duration     </h3> <p>The Data Cache is persistent across incoming requests and deployments unless you revalidate or opt-out.</p> <h3 id=\"revalidating-1\" data-docs-heading=\"\">Revalidating     </h3> <p>Cached data can be revalidated in two ways, with:</p> <ul> <li>\n<strong>Time-based Revalidation</strong>: Revalidate data after a certain amount of time has passed and a new request is made. This is useful for data that changes infrequently and freshness is not as critical.</li> <li>\n<strong>On-demand Revalidation:</strong> Revalidate data based on an event (e.g. form submission). On-demand revalidation can use a tag-based or path-based approach to revalidate groups of data at once. This is useful when you want to ensure the latest data is shown as soon as possible (e.g. when content from your headless CMS is updated).</li> </ul> <h4 id=\"time-based-revalidation\" data-docs-heading=\"\">Time-based Revalidation     </h4> <p>To revalidate data at a timed interval, you can use the <code>next.revalidate</code> option of <code>fetch</code> to set the cache lifetime of a resource (in seconds).</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Revalidate at most every hour\nfetch('https://...', { next: { revalidate: 3600 } })</pre>\n</div> <p>Alternatively, you can use <a href=\"#segment-config-options\">Route Segment Config options</a> to configure all <code>fetch</code> requests in a segment or for cases where you're not able to use <code>fetch</code>.</p> <p><strong>How Time-based Revalidation Works</strong></p> <figure><img alt=\"Diagram showing how time-based revalidation works, after the revalidation period, stale data is returned for the first request, then data is revalidated.\" loading=\"lazy\" width=\"1600\" height=\"1252\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ftime-based-revalidation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ftime-based-revalidation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ftime-based-revalidation.png&amp;w=3840&amp;q=75\"><img alt=\"Diagram showing how time-based revalidation works, after the revalidation period, stale data is returned for the first request, then data is revalidated.\" loading=\"lazy\" width=\"1600\" height=\"1252\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ftime-based-revalidation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ftime-based-revalidation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ftime-based-revalidation.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>The first time a fetch request with <code>revalidate</code> is called, the data will be fetched from the external data source and stored in the Data Cache.</li> <li>Any requests that are called within the specified timeframe (e.g. 60-seconds) will return the cached data.</li> <li>After the timeframe, the next request will still return the cached (now stale) data. <ul> <li>Next.js will trigger a revalidation of the data in the background.</li> <li>Once the data is fetched successfully, Next.js will update the Data Cache with the fresh data.</li> <li>If the background revalidation fails, the previous data will be kept unaltered.</li> </ul> </li> </ul> <p>This is similar to <a href=\"https://web.dev/stale-while-revalidate/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><strong>stale-while-revalidate</strong></a> behavior.</p> <h4 id=\"on-demand-revalidation\" data-docs-heading=\"\">On-demand Revalidation     </h4> <p>Data can be revalidated on-demand by path (<a href=\"#revalidatepath\"><code>revalidatePath</code></a>) or by cache tag (<a href=\"#fetch-optionsnexttags-and-revalidatetag\"><code>revalidateTag</code></a>).</p> <p><strong>How On-Demand Revalidation Works</strong></p> <figure><img alt=\"Diagram showing how on-demand revalidation works, the Data Cache is updated with fresh data after a revalidation request.\" loading=\"lazy\" width=\"1600\" height=\"1082\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fon-demand-revalidation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fon-demand-revalidation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fon-demand-revalidation.png&amp;w=3840&amp;q=75\"><img alt=\"Diagram showing how on-demand revalidation works, the Data Cache is updated with fresh data after a revalidation request.\" loading=\"lazy\" width=\"1600\" height=\"1082\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fon-demand-revalidation.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fon-demand-revalidation.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fon-demand-revalidation.png&amp;w=3840&amp;q=75\"></figure> <ul> <li>The first time a <code>fetch</code> request is called, the data will be fetched from the external data source and stored in the Data Cache.</li> <li>When an on-demand revalidation is triggered, the appropriate cache entries will be purged from the cache. <ul> <li>This is different from time-based revalidation, which keeps the stale data in the cache until the fresh data is fetched.</li> </ul> </li> <li>The next time a request is made, it will be a cache <code>MISS</code> again, and the data will be fetched from the external data source and stored in the Data Cache.</li> </ul> <h3 id=\"opting-out-1\" data-docs-heading=\"\">Opting out     </h3> <p>For individual data fetches, you can opt out of caching by setting the <a href=\"#fetch-optionscache\"><code>cache</code></a> option to <code>no-store</code>. This means data will be fetched whenever <code>fetch</code> is called.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Opt out of caching for an individual `fetch` request\nfetch(`https://...`, { cache: 'no-store' })</pre>\n</div> <p>Alternatively, you can also use the <a href=\"#segment-config-options\">Route Segment Config options</a> to opt out of caching for a specific route segment. This will affect all data requests in the route segment, including third-party libraries.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Opt out of caching for all data requests in the route segment\nexport const dynamic = 'force-dynamic'</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: Data Cache is currently only available in pages/routes, not middleware. Any fetches done inside of your middleware will be uncached by default.</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p><strong>Vercel Data Cache</strong></p> <p>If your Next.js application is deployed to Vercel, we recommend reading the <a href=\"https://vercel.com/docs/infrastructure/data-cache\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Data Cache</a> documentation for a better understanding of Vercel specific features.</p> </blockquote> <h2 id=\"full-route-cache\" data-docs-heading=\"\">Full Route Cache     </h2> <blockquote class=\"p-3 text-sm\"> <p><strong>Related terms</strong>:</p> <p>You may see the terms <strong>Automatic Static Optimization</strong>, <strong>Static Site Generation</strong>, or <strong>Static Rendering</strong> being used interchangeably to refer to the process of rendering and caching routes of your application at build time.</p> </blockquote> <p>Next.js automatically renders and caches routes at build time. This is an optimization that allows you to serve the cached route instead of rendering on the server for every request, resulting in faster page loads.</p> <p>To understand how the Full Route Cache works, it's helpful to look at how React handles rendering, and how Next.js caches the result:</p> <h3 id=\"1-react-rendering-on-the-server\" data-docs-heading=\"\">1. React Rendering on the Server     </h3> <p>On the server, Next.js uses React's APIs to orchestrate rendering. The rendering work is split into chunks: by individual routes segments and Suspense boundaries.</p> <p>Each chunk is rendered in two steps:</p> <ol> <li>React renders Server Components into a special data format, optimized for streaming, called the <strong>React Server Component Payload</strong>.</li> <li>Next.js uses the React Server Component Payload and Client Component JavaScript instructions to render <strong>HTML</strong> on the server.</li> </ol> <p>This means we don't have to wait for everything to render before caching the work or sending a response. Instead, we can stream a response as work is completed.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>What is the React Server Component Payload?</strong></p> <p>The React Server Component Payload is a compact binary representation of the rendered React Server Components tree. It's used by React on the client to update the browser's DOM. The React Server Component Payload contains:</p> <ul> <li>The rendered result of Server Components</li> <li>Placeholders for where Client Components should be rendered and references to their JavaScript files</li> <li>Any props passed from a Server Component to a Client Component</li> </ul> <p>To learn more, see the <a href=\"rendering/server-components\">Server Components</a> documentation.</p> </blockquote> <h3 id=\"2-nextjs-caching-on-the-server-full-route-cache\" data-docs-heading=\"\">2. Next.js Caching on the Server (Full Route Cache)     </h3> <figure><img alt=\"Default behavior of the Full Route Cache, showing how the React Server Component Payload and HTML are cached on the server for statically rendered routes.\" loading=\"lazy\" width=\"1600\" height=\"888\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ffull-route-cache.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ffull-route-cache.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ffull-route-cache.png&amp;w=3840&amp;q=75\"><img alt=\"Default behavior of the Full Route Cache, showing how the React Server Component Payload and HTML are cached on the server for statically rendered routes.\" loading=\"lazy\" width=\"1600\" height=\"888\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ffull-route-cache.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ffull-route-cache.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ffull-route-cache.png&amp;w=3840&amp;q=75\"></figure> <p>The default behavior of Next.js is to cache the rendered result (React Server Component Payload and HTML) of a route on the server. This applies to statically rendered routes at build time, or during revalidation.</p> <h3 id=\"3-react-hydration-and-reconciliation-on-the-client\" data-docs-heading=\"\">3. React Hydration and Reconciliation on the Client     </h3> <p>At request time, on the client:</p> <ol> <li>The HTML is used to immediately show a fast non-interactive initial preview of the Client and Server Components.</li> <li>The React Server Components Payload is used to reconcile the Client and rendered Server Component trees, and update the DOM.</li> <li>The JavaScript instructions are used to <a href=\"https://react.dev/reference/react-dom/client/hydrateRoot\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">hydrate</a> Client Components and make the application interactive.</li> </ol> <h3 id=\"4-nextjs-caching-on-the-client-router-cache\" data-docs-heading=\"\">4. Next.js Caching on the Client (Router Cache)     </h3> <p>The React Server Component Payload is stored in the client-side <a href=\"#router-cache\">Router Cache</a> - a separate in-memory cache, split by individual route segment. This Router Cache is used to improve the navigation experience by storing previously visited routes and prefetching future routes.</p> <h3 id=\"5-subsequent-navigations\" data-docs-heading=\"\">5. Subsequent Navigations     </h3> <p>On subsequent navigations or during prefetching, Next.js will check if the React Server Components Payload is stored in the Router Cache. If so, it will skip sending a new request to the server.</p> <p>If the route segments are not in the cache, Next.js will fetch the React Server Components Payload from the server, and populate the Router Cache on the client.</p> <h3 id=\"static-and-dynamic-rendering\" data-docs-heading=\"\">Static and Dynamic Rendering     </h3> <p>Whether a route is cached or not at build time depends on whether it's statically or dynamically rendered. Static routes are cached by default, whereas dynamic routes are rendered at request time, and not cached.</p> <p>This diagram shows the difference between statically and dynamically rendered routes, with cached and uncached data:</p> <figure><img alt=\"How static and dynamic rendering affects the Full Route Cache. Static routes are cached at build time or after data revalidation, whereas dynamic routes are never cached\" loading=\"lazy\" width=\"1600\" height=\"1314\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fstatic-and-dynamic-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fstatic-and-dynamic-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fstatic-and-dynamic-routes.png&amp;w=3840&amp;q=75\"><img alt=\"How static and dynamic rendering affects the Full Route Cache. Static routes are cached at build time or after data revalidation, whereas dynamic routes are never cached\" loading=\"lazy\" width=\"1600\" height=\"1314\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fstatic-and-dynamic-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fstatic-and-dynamic-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fstatic-and-dynamic-routes.png&amp;w=3840&amp;q=75\"></figure> <p>Learn more about <a href=\"rendering/server-components#server-rendering-strategies\">static and dynamic rendering</a>.</p> <h3 id=\"duration-2\" data-docs-heading=\"\">Duration     </h3> <p>By default, the Full Route Cache is persistent. This means that the render output is cached across user requests.</p> <h3 id=\"invalidation\" data-docs-heading=\"\">Invalidation     </h3> <p>There are two ways you can invalidate the Full Route Cache:</p> <ul> <li>\n<strong><a href=\"caching#revalidating\">Revalidating Data</a></strong>: Revalidating the <a href=\"#data-cache\">Data Cache</a>, will in turn invalidate the Router Cache by re-rendering components on the server and caching the new render output.</li> <li>\n<strong>Redeploying</strong>: Unlike the Data Cache, which persists across deployments, the Full Route Cache is cleared on new deployments.</li> </ul> <h3 id=\"opting-out-2\" data-docs-heading=\"\">Opting out     </h3> <p>You can opt out of the Full Route Cache, or in other words, dynamically render components for every incoming request, by:</p> <ul> <li>\n<strong>Using a <a href=\"#dynamic-functions\">Dynamic Function</a></strong>: This will opt the route out from the Full Route Cache and dynamically render it at request time. The Data Cache can still be used.</li> <li>\n<strong>Using the <code>dynamic = 'force-dynamic'</code> or <code>revalidate = 0</code> route segment config options</strong>: This will skip the Full Route Cache and the Data Cache. Meaning components will be rendered and data fetched on every incoming request to the server. The Router Cache will still apply as it's a client-side cache.</li> <li>\n<strong>Opting out of the <a href=\"#data-cache\">Data Cache</a></strong>: If a route has a <code>fetch</code> request that is not cached, this will opt the route out of the Full Route Cache. The data for the specific <code>fetch</code> request will be fetched for every incoming request. Other <code>fetch</code> requests that do not opt out of caching will still be cached in the Data Cache. This allows for a hybrid of cached and uncached data.</li> </ul> <h2 id=\"router-cache\" data-docs-heading=\"\">Router Cache     </h2> <blockquote class=\"p-3 text-sm\"> <p><strong>Related Terms:</strong></p> <p>You may see the Router Cache being referred to as <strong>Client-side Cache</strong> or <strong>Prefetch Cache</strong>. While <strong>Prefetch Cache</strong> refers to the prefetched route segments, <strong>Client-side Cache</strong> refers to the whole Router cache, which includes both visited and prefetched segments. This cache specifically applies to Next.js and Server Components, and is different to the browser's <a href=\"https://web.dev/bfcache/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">bfcache</a>, though it has a similar result.</p> </blockquote> <p>Next.js has an in-memory client-side cache that stores the React Server Component Payload, split by individual route segments, for the duration of a user session. This is called the Router Cache.</p> <p><strong>How the Router Cache Works</strong></p> <figure><img alt=\"How the Router cache works for static and dynamic routes, showing MISS and HIT for initial and subsequent navigations.\" loading=\"lazy\" width=\"1600\" height=\"1375\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Frouter-cache.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Frouter-cache.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Frouter-cache.png&amp;w=3840&amp;q=75\"><img alt=\"How the Router cache works for static and dynamic routes, showing MISS and HIT for initial and subsequent navigations.\" loading=\"lazy\" width=\"1600\" height=\"1375\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Frouter-cache.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Frouter-cache.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Frouter-cache.png&amp;w=3840&amp;q=75\"></figure> <p>As a user navigates between routes, Next.js caches visited route segments and <a href=\"routing/linking-and-navigating#2-prefetching\">prefetches</a> the routes the user is likely to navigate to (based on <code>&lt;Link&gt;</code> components in their viewport).</p> <p>This results in an improved navigation experience for the user:</p> <ul> <li>Instant backward/forward navigation because visited routes are cached and fast navigation to new routes because of prefetching and <a href=\"routing/linking-and-navigating#4-partial-rendering\">partial rendering</a>.</li> <li>No full-page reload between navigations, and React state and browser state are preserved.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Difference between the Router Cache and Full Route Cache</strong>:</p> <p>The Router Cache temporarily stores the React Server Component Payload in the browser for the duration of a user session, whereas the Full Route Cache persistently stores the React Server Component Payload and HTML on the server across multiple user requests.</p> <p>While the Full Route Cache only caches statically rendered routes, the Router Cache applies to both statically and dynamically rendered routes.</p> </blockquote> <h3 id=\"duration-3\" data-docs-heading=\"\">Duration     </h3> <p>The cache is stored in the browser's temporary memory. Two factors determine how long the router cache lasts:</p> <ul> <li>\n<strong>Session</strong>: The cache persists across navigation. However, it's cleared on page refresh.</li> <li>\n<strong>Automatic Invalidation Period</strong>: The cache of an individual segment is automatically invalidated after a specific time. The duration depends on how the resource was <a href=\"../api-reference/components/link#prefetch\">prefetched</a>: <ul> <li>\n<strong>Default Prefetching</strong> (<code>prefetch={null}</code> or unspecified): 30 seconds</li> <li>\n<strong>Full Prefetching</strong>: (<code>prefetch={true}</code> or <code>router.prefetch</code>): 5 minutes</li> </ul> </li> </ul> <p>While a page refresh will clear <strong>all</strong> cached segments, the automatic invalidation period only affects the individual segment from the time it was prefetched.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: There is <a href=\"../api-reference/next-config-js/staletimes\">experimental support</a> for configuring these values as of v14.2.0-canary.53.</p> </blockquote> <h3 id=\"invalidation-1\" data-docs-heading=\"\">Invalidation     </h3> <p>There are two ways you can invalidate the Router Cache:</p> <ul> <li>In a <strong>Server Action</strong>: <ul> <li>Revalidating data on-demand by path with (<a href=\"../api-reference/functions/revalidatepath\"><code>revalidatePath</code></a>) or by cache tag with (<a href=\"../api-reference/functions/revalidatetag\"><code>revalidateTag</code></a>)</li> <li>Using <a href=\"../api-reference/functions/cookies#cookiessetname-value-options\"><code>cookies.set</code></a> or <a href=\"../api-reference/functions/cookies#deleting-cookies\"><code>cookies.delete</code></a> invalidates the Router Cache to prevent routes that use cookies from becoming stale (e.g. authentication).</li> </ul> </li> <li>Calling <a href=\"../api-reference/functions/use-router\"><code>router.refresh</code></a> will invalidate the Router Cache and make a new request to the server for the current route.</li> </ul> <h3 id=\"opting-out-3\" data-docs-heading=\"\">Opting out     </h3> <p>It's not possible to opt out of the Router Cache. However, you can invalidate it by calling <a href=\"../api-reference/functions/use-router\"><code>router.refresh</code></a>, <a href=\"../api-reference/functions/revalidatepath\"><code>revalidatePath</code></a>, or <a href=\"../api-reference/functions/revalidatetag\"><code>revalidateTag</code></a> (see above). This will clear the cache and make a new request to the server, ensuring the latest data is shown.</p> <p>You can also opt out of <strong>prefetching</strong> by setting the <code>prefetch</code> prop of the <code>&lt;Link&gt;</code> component to <code>false</code>. However, this will still temporarily store the route segments for 30s to allow instant navigation between nested segments, such as tab bars, or back and forward navigation. Visited routes will still be cached.</p> <h2 id=\"cache-interactions\" data-docs-heading=\"\">Cache Interactions     </h2> <p>When configuring the different caching mechanisms, it's important to understand how they interact with each other:</p> <h3 id=\"data-cache-and-full-route-cache\" data-docs-heading=\"\">Data Cache and Full Route Cache     </h3> <ul> <li>Revalidating or opting out of the Data Cache <strong>will</strong> invalidate the Full Route Cache, as the render output depends on data.</li> <li>Invalidating or opting out of the Full Route Cache <strong>does not</strong> affect the Data Cache. You can dynamically render a route that has both cached and uncached data. This is useful when most of your page uses cached data, but you have a few components that rely on data that needs to be fetched at request time. You can dynamically render without worrying about the performance impact of re-fetching all the data.</li> </ul> <h3 id=\"data-cache-and-client-side-router-cache\" data-docs-heading=\"\">Data Cache and Client-side Router cache     </h3> <ul> <li>Revalidating the Data Cache in a <a href=\"routing/route-handlers\">Route Handler</a> <strong>will not</strong> immediately invalidate the Router Cache as the Route Handler isn't tied to a specific route. This means Router Cache will continue to serve the previous payload until a hard refresh, or the automatic invalidation period has elapsed.</li> <li>To immediately invalidate the Data Cache and Router cache, you can use <a href=\"#revalidatepath\"><code>revalidatePath</code></a> or <a href=\"#fetch-optionsnexttags-and-revalidatetag\"><code>revalidateTag</code></a> in a <a href=\"data-fetching/server-actions-and-mutations\">Server Action</a>.</li> </ul> <h2 id=\"apis\" data-docs-heading=\"\">APIs     </h2> <p>The following table provides an overview of how different Next.js APIs affect caching:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Router Cache</th>\n<th>Full Route Cache</th>\n<th>Data Cache</th>\n<th>React Cache</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#link\"><code>&lt;Link prefetch&gt;</code></a></td>\n<td>Cache</td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#routerprefetch\"><code>router.prefetch</code></a></td>\n<td>Cache</td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#routerrefresh\"><code>router.refresh</code></a></td>\n<td>Revalidate</td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#fetch\"><code>fetch</code></a></td>\n<td></td>\n<td></td>\n<td>Cache</td>\n<td>Cache</td>\n</tr>\n<tr>\n<td><a href=\"#fetch-optionscache\"><code>fetch</code> <code>options.cache</code></a></td>\n<td></td>\n<td></td>\n<td>Cache or Opt out</td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#fetch-optionsnextrevalidate\"><code>fetch</code> <code>options.next.revalidate</code></a></td>\n<td></td>\n<td>Revalidate</td>\n<td>Revalidate</td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#fetch-optionsnexttags-and-revalidatetag\"><code>fetch</code> <code>options.next.tags</code></a></td>\n<td></td>\n<td>Cache</td>\n<td>Cache</td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#fetch-optionsnexttags-and-revalidatetag\"><code>revalidateTag</code></a></td>\n<td>Revalidate (Server Action)</td>\n<td>Revalidate</td>\n<td>Revalidate</td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#revalidatepath\"><code>revalidatePath</code></a></td>\n<td>Revalidate (Server Action)</td>\n<td>Revalidate</td>\n<td>Revalidate</td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#segment-config-options\"><code>const revalidate</code></a></td>\n<td></td>\n<td>Revalidate or Opt out</td>\n<td>Revalidate or Opt out</td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#segment-config-options\"><code>const dynamic</code></a></td>\n<td></td>\n<td>Cache or Opt out</td>\n<td>Cache or Opt out</td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#cookies\"><code>cookies</code></a></td>\n<td>Revalidate (Server Action)</td>\n<td>Opt out</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#dynamic-functions\"><code>headers</code>, <code>searchParams</code></a></td>\n<td></td>\n<td>Opt out</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#generatestaticparams\"><code>generateStaticParams</code></a></td>\n<td></td>\n<td>Cache</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><a href=\"#react-cache-function\"><code>React.cache</code></a></td>\n<td></td>\n<td></td>\n<td></td>\n<td>Cache</td>\n</tr>\n<tr>\n<td><a href=\"../api-reference/functions/unstable_cache\"><code>unstable_cache</code></a></td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"link\" data-docs-heading=\"\">&lt;Link&gt;     </h3> <p>By default, the <code>&lt;Link&gt;</code> component automatically prefetches routes from the Full Route Cache and adds the React Server Component Payload to the Router Cache.</p> <p>To disable prefetching, you can set the <code>prefetch</code> prop to <code>false</code>. But this will not skip the cache permanently, the route segment will still be cached client-side when the user visits the route.</p> <p>Learn more about the <a href=\"../api-reference/components/link\"><code>&lt;Link&gt;</code> component</a>.</p> <h3 id=\"routerprefetch\" data-docs-heading=\"\">router.prefetch     </h3> <p>The <code>prefetch</code> option of the <code>useRouter</code> hook can be used to manually prefetch a route. This adds the React Server Component Payload to the Router Cache.</p> <p>See the <a href=\"../api-reference/functions/use-router\"><code>useRouter</code> hook</a> API reference.</p> <h3 id=\"routerrefresh\" data-docs-heading=\"\">router.refresh     </h3> <p>The <code>refresh</code> option of the <code>useRouter</code> hook can be used to manually refresh a route. This completely clears the Router Cache, and makes a new request to the server for the current route. <code>refresh</code> does not affect the Data or Full Route Cache.</p> <p>The rendered result will be reconciled on the client while preserving React state and browser state.</p> <p>See the <a href=\"../api-reference/functions/use-router\"><code>useRouter</code> hook</a> API reference.</p> <h3 id=\"fetch\" data-docs-heading=\"\">fetch     </h3> <p>Data returned from <code>fetch</code> is automatically cached in the Data Cache.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Cached by default. `force-cache` is the default option and can be omitted.\nfetch(`https://...`, { cache: 'force-cache' })</pre>\n</div> <p>See the <a href=\"../api-reference/functions/fetch\"><code>fetch</code> API Reference</a> for more options.</p> <h3 id=\"fetch-optionscache\" data-docs-heading=\"\">fetch options.cache     </h3> <p>You can opt out individual <code>fetch</code> requests of data caching by setting the <code>cache</code> option to <code>no-store</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Opt out of caching\nfetch(`https://...`, { cache: 'no-store' })</pre>\n</div> <p>Since the render output depends on data, using <code>cache: 'no-store'</code> will also skip the Full Route Cache for the route where the <code>fetch</code> request is used. That is, the route will be dynamically rendered every request, but you can still have other cached data requests in the same route.</p> <p>See the <a href=\"../api-reference/functions/fetch\"><code>fetch</code> API Reference</a> for more options.</p> <h3 id=\"fetch-optionsnextrevalidate\" data-docs-heading=\"\">fetch options.next.revalidate     </h3> <p>You can use the <code>next.revalidate</code> option of <code>fetch</code> to set the revalidation period (in seconds) of an individual <code>fetch</code> request. This will revalidate the Data Cache, which in turn will revalidate the Full Route Cache. Fresh data will be fetched, and components will be re-rendered on the server.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Revalidate at most after 1 hour\nfetch(`https://...`, { next: { revalidate: 3600 } })</pre>\n</div> <p>See the <a href=\"../api-reference/functions/fetch\"><code>fetch</code> API reference</a> for more options.</p> <h3 id=\"fetch-optionsnexttags-and-revalidatetag\" data-docs-heading=\"\">fetch options.next.tags and revalidateTag     </h3> <p>Next.js has a cache tagging system for fine-grained data caching and revalidation.</p> <ol> <li>When using <code>fetch</code> or <a href=\"../api-reference/functions/unstable_cache\"><code>unstable_cache</code></a>, you have the option to tag cache entries with one or more tags.</li> <li>Then, you can call <code>revalidateTag</code> to purge the cache entries associated with that tag.</li> </ol> <p>For example, you can set a tag when fetching data:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Cache data with a tag\nfetch(`https://...`, { next: { tags: ['a', 'b', 'c'] } })</pre>\n</div> <p>Then, call <code>revalidateTag</code> with a tag to purge the cache entry:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Revalidate entries with a specific tag\nrevalidateTag('a')</pre>\n</div> <p>There are two places you can use <code>revalidateTag</code>, depending on what you're trying to achieve:</p> <ol> <li>\n<a href=\"routing/route-handlers\">Route Handlers</a> - to revalidate data in response of a third party event (e.g. webhook). This will not invalidate the Router Cache immediately as the Router Handler isn't tied to a specific route.</li> <li>\n<a href=\"data-fetching/server-actions-and-mutations\">Server Actions</a> - to revalidate data after a user action (e.g. form submission). This will invalidate the Router Cache for the associated route.</li> </ol> <h3 id=\"revalidatepath\" data-docs-heading=\"\">revalidatePath     </h3> <p><code>revalidatePath</code> allows you manually revalidate data <strong>and</strong> re-render the route segments below a specific path in a single operation. Calling the <code>revalidatePath</code> method revalidates the Data Cache, which in turn invalidates the Full Route Cache.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">revalidatePath('/')</pre>\n</div> <p>There are two places you can use <code>revalidatePath</code>, depending on what you're trying to achieve:</p> <ol> <li>\n<a href=\"routing/route-handlers\">Route Handlers</a> - to revalidate data in response to a third party event (e.g. webhook).</li> <li>\n<a href=\"data-fetching/server-actions-and-mutations\">Server Actions</a> - to revalidate data after a user interaction (e.g. form submission, clicking a button).</li> </ol> <p>See the <a href=\"../api-reference/functions/revalidatepath\"><code>revalidatePath</code> API reference</a> for more information.</p> <blockquote class=\"p-3 text-sm\"> <p><strong><code>revalidatePath</code></strong> vs. <strong><code>router.refresh</code></strong>:</p> <p>Calling <code>router.refresh</code> will clear the Router cache, and re-render route segments on the server without invalidating the Data Cache or the Full Route Cache.</p> <p>The difference is that <code>revalidatePath</code> purges the Data Cache and Full Route Cache, whereas <code>router.refresh()</code> does not change the Data Cache and Full Route Cache, as it is a client-side API.</p> </blockquote> <h3 id=\"dynamic-functions\" data-docs-heading=\"\">Dynamic Functions     </h3> <p>Dynamic functions like <code>cookies</code> and <code>headers</code>, and the <code>searchParams</code> prop in Pages depend on runtime incoming request information. Using them will opt a route out of the Full Route Cache, in other words, the route will be dynamically rendered.</p> <h4 id=\"cookies\" data-docs-heading=\"\">cookies     </h4> <p>Using <code>cookies.set</code> or <code>cookies.delete</code> in a Server Action invalidates the Router Cache to prevent routes that use cookies from becoming stale (e.g. to reflect authentication changes).</p> <p>See the <a href=\"../api-reference/functions/cookies\"><code>cookies</code></a> API reference.</p> <h3 id=\"segment-config-options\" data-docs-heading=\"\">Segment Config Options     </h3> <p>The Route Segment Config options can be used to override the route segment defaults or when you're not able to use the <code>fetch</code> API (e.g. database client or 3rd party libraries).</p> <p>The following Route Segment Config options will opt out of the Data Cache and Full Route Cache:</p> <ul> <li><code>const dynamic = 'force-dynamic'</code></li> <li><code>const revalidate = 0</code></li> </ul> <p>See the <a href=\"../api-reference/file-conventions/route-segment-config\">Route Segment Config</a> documentation for more options.</p> <h3 id=\"generatestaticparams\" data-docs-heading=\"\">generateStaticParams     </h3> <p>For <a href=\"routing/dynamic-routes\">dynamic segments</a> (e.g. <code>app/blog/[slug]/page.js</code>), paths provided by <code>generateStaticParams</code> are cached in the Full Route Cache at build time. At request time, Next.js will also cache paths that weren't known at build time the first time they're visited.</p> <p>You can disable caching at request time by using <code>export const dynamicParams = false</code> option in a route segment. When this config option is used, only paths provided by <code>generateStaticParams</code> will be served, and other routes will 404 or match (in the case of <a href=\"routing/dynamic-routes#catch-all-segments\">catch-all routes</a>).</p> <p>See the <a href=\"../api-reference/functions/generate-static-params\"><code>generateStaticParams</code> API reference</a>.</p> <h3 id=\"react-cache-function\" data-docs-heading=\"\">React cache function     </h3> <p>The React <code>cache</code> function allows you to memoize the return value of a function, allowing you to call the same function multiple times while only executing it once.</p> <p>Since <code>fetch</code> requests are automatically memoized, you do not need to wrap it in React <code>cache</code>. However, you can use <code>cache</code> to manually memoize data requests for use cases when the <code>fetch</code> API is not suitable. For example, some database clients, CMS clients, or GraphQL clients.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cache } from 'react'\nimport db from '@/lib/db'\n \nexport const getItem = cache(async (id: string) =&gt; {\n  const item = await db.item.findUnique({ id })\n  return item\n})</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/caching\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/caching</a>\n  </p>\n</div>\n","app/building-your-application/styling/css-modules":"<h1 class=\"break-words\">CSS Modules and Global Styles</h1>  <p>Next.js supports different types of stylesheets, including:</p> <ul> <li><a href=\"#css-modules\">CSS Modules</a></li> <li><a href=\"#global-styles\">Global Styles</a></li> <li><a href=\"#external-stylesheets\">External Stylesheets</a></li> </ul> <h2 id=\"css-modules\" data-docs-heading=\"\">CSS Modules     </h2> <p>Next.js has built-in support for CSS Modules using the <code>.module.css</code> extension.</p> <p>CSS Modules locally scope CSS by automatically creating a unique class name. This allows you to use the same class name in different files without worrying about collisions. This behavior makes CSS Modules the ideal way to include component-level CSS.</p> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <p>CSS Modules can be imported into any file inside the <code>app</code> directory:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import styles from './styles.module.css'\n \nexport default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return &lt;section className={styles.dashboard}&gt;{children}&lt;/section&gt;\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.dashboard {\n  padding: 24px;\n}</pre></div>  <p>CSS Modules are <strong>only enabled for files with the <code>.module.css</code> and <code>.module.sass</code> extensions</strong>.</p> <p>In production, all CSS Module files will be automatically concatenated into <strong>many minified and code-split</strong> <code>.css</code> files. These <code>.css</code> files represent hot execution paths in your application, ensuring the minimal amount of CSS is loaded for your application to paint.</p> <h2 id=\"global-styles\" data-docs-heading=\"\">Global Styles     </h2> <p>Global styles can be imported into any layout, page, or component inside the <code>app</code> directory.</p>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This is different from the <code>pages</code> directory, where you can only import global styles inside the <code>_app.js</code> file.</p> </blockquote>\n<p>For example, consider a stylesheet named <code>app/global.css</code>:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">body {\n  padding: 20px 20px 60px;\n  max-width: 680px;\n  margin: 0 auto;\n}</pre>\n</div>\n<p>Inside the root layout (<code>app/layout.js</code>), import the <code>global.css</code> stylesheet to apply the styles to every route in your application:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// These styles apply to every route in the application\nimport './global.css'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <h2 id=\"external-stylesheets\" data-docs-heading=\"\">External Stylesheets     </h2> <p>Stylesheets published by external packages can be imported anywhere in the <code>app</code> directory, including colocated components:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import 'bootstrap/dist/css/bootstrap.css'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body className=\"container\"&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: External stylesheets must be directly imported from an npm package or downloaded and colocated with your codebase. You cannot use <code>&lt;link rel=\"stylesheet\" /&gt;</code>.</p> </blockquote>  <h2 id=\"ordering-and-merging\" data-docs-heading=\"\">Ordering and Merging     </h2>\n<p>Next.js optimizes CSS during production builds by automatically chunking (merging) stylesheets. The CSS order is determined by the order in which you import the stylesheets into your application code.</p>\n<p>For example, <code>base-button.module.css</code> will be ordered before <code>page.module.css</code> since <code>&lt;BaseButton&gt;</code> is imported first in <code>&lt;Page&gt;</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import styles from './base-button.module.css'\n \nexport function BaseButton() {\n  return &lt;button className={styles.primary} /&gt;\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { BaseButton } from './base-button'\nimport styles from './page.module.css'\n \nexport function Page() {\n  return &lt;BaseButton className={styles.primary} /&gt;\n}</pre></div>\n<p>To maintain a predictable order, we recommend the following:</p>\n<ul> <li>Only import a CSS file in a single JS/TS file. <ul> <li>If using global class names, import the global styles in the same file in the order you want them to be applied.</li> </ul> </li> <li>Prefer CSS Modules over global styles. <ul> <li>Use a consistent naming convention for your CSS modules. For example, using <code>&lt;name&gt;.module.css</code> over <code>&lt;name&gt;.tsx</code>.</li> </ul> </li> <li>Extract shared styles into a separate shared component.</li> <li>If using <a href=\"tailwind-css\">Tailwind</a>, import the stylesheet at the top of the file, preferably in the <a href=\"../routing/pages-and-layouts#root-layout-required\">Root Layout</a>.</li> </ul>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> CSS ordering behaves differently in development mode, always ensure to check preview deployments to verify the final CSS order in your production build.</p> </blockquote> <h2 id=\"additional-features\" data-docs-heading=\"\">Additional Features     </h2> <p>Next.js includes additional features to improve the authoring experience of adding styles:</p> <ul> <li>When running locally with <code>next dev</code>, local stylesheets (either global or CSS modules) will take advantage of <a href=\"../../../architecture/fast-refresh\">Fast Refresh</a> to instantly reflect changes as edits are saved.</li> <li>When building for production with <code>next build</code>, CSS files will be bundled into fewer minified <code>.css</code> files to reduce the number of network requests needed to retrieve styles.</li> <li>If you disable JavaScript, styles will still be loaded in the production build (<code>next start</code>). However, JavaScript is still required for <code>next dev</code> to enable <a href=\"../../../architecture/fast-refresh\">Fast Refresh</a>.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/styling/css-modules\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/styling/css-modules</a>\n  </p>\n</div>\n","app/building-your-application/styling/tailwind-css":"<h1 class=\"break-words\">Tailwind CSS</h1>  <p><a href=\"https://tailwindcss.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Tailwind CSS</a> is a utility-first CSS framework that works exceptionally well with Next.js.</p> <h2 id=\"installing-tailwind\" data-docs-heading=\"\">Installing Tailwind     </h2> <p>Install the Tailwind CSS packages and run the <code>init</code> command to generate both the <code>tailwind.config.js</code> and <code>postcss.config.js</code> files:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D tailwindcss postcss autoprefixer\nnpx tailwindcss init -p</pre></div> <h2 id=\"configuring-tailwind\" data-docs-heading=\"\">Configuring Tailwind     </h2> <p>Inside <code>tailwind.config.js</code>, add paths to the files that will use Tailwind CSS class names:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    './app/**/*.{js,ts,jsx,tsx,mdx}', // Note the addition of the `app` directory.\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n \n    // Or if using `src` directory:\n    './src/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n}</pre></div> <p>You do not need to modify <code>postcss.config.js</code>.</p> <h2 id=\"importing-styles\" data-docs-heading=\"\">Importing Styles     </h2>\n<p>Add the <a href=\"https://tailwindcss.com/docs/functions-and-directives#directives\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Tailwind CSS directives</a> that Tailwind will use to inject its generated styles to a <a href=\"css-modules#global-styles\">Global Stylesheet</a> in your application, for example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">@tailwind base;\n@tailwind components;\n@tailwind utilities;</pre></div>\n<p>Inside the <a href=\"../routing/pages-and-layouts#root-layout-required\">root layout</a> (<code>app/layout.tsx</code>), import the <code>globals.css</code> stylesheet to apply the styles to every route in your application.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \n// These styles apply to every route in the application\nimport './globals.css'\n \nexport const metadata: Metadata = {\n  title: 'Create Next App',\n  description: 'Generated by create next app',\n}\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>\n<h2 id=\"using-classes\" data-docs-heading=\"\">Using Classes     </h2>\n<p>After installing Tailwind CSS and adding the global styles, you can use Tailwind's utility classes in your application.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return &lt;h1 className=\"text-3xl font-bold underline\"&gt;Hello, Next.js!&lt;/h1&gt;\n}</pre></div>  <h2 id=\"usage-with-turbopack\" data-docs-heading=\"\">Usage with Turbopack     </h2> <p>As of Next.js 13.1, Tailwind CSS and PostCSS are supported with <a href=\"https://turbo.build/pack/docs/features/css#tailwind-css\" rel=\"noopener noreferrer\" target=\"_blank\">Turbopack</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/styling/tailwind-css\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/styling/tailwind-css</a>\n  </p>\n</div>\n","app/building-your-application/styling/css-in-js":"<h1 class=\"break-words\">CSS-in-JS</h1> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> CSS-in-JS libraries which require runtime JavaScript are not currently supported in Server Components. Using CSS-in-JS with newer React features like Server Components and Streaming requires library authors to support the latest version of React, including <a href=\"https://react.dev/blog/2022/03/29/react-v18#what-is-concurrent-react\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">concurrent rendering</a>.</p> <p>We're working with the React team on upstream APIs to handle CSS and JavaScript assets with support for React Server Components and streaming architecture.</p> </blockquote>\n<p>The following libraries are supported in Client Components in the <code>app</code> directory (alphabetical):</p>\n<ul> <li><a href=\"https://chakra-ui.com/getting-started/nextjs-app-guide\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>chakra-ui</code></a></li> <li><a href=\"https://kuma-ui.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>kuma-ui</code></a></li> <li><a href=\"https://mui.com/material-ui/guides/next-js-app-router/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@mui/material</code></a></li> <li><a href=\"https://mui.com/joy-ui/integrations/next-js-app-router/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@mui/joy</code></a></li> <li><a href=\"https://panda-css.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>pandacss</code></a></li> <li><a href=\"#styled-jsx\"><code>styled-jsx</code></a></li> <li><a href=\"#styled-components\"><code>styled-components</code></a></li> <li><a href=\"https://stylexjs.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>stylex</code></a></li> <li><a href=\"https://tamagui.dev/docs/guides/next-js#server-components\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>tamagui</code></a></li> <li><a href=\"https://tss-react.dev/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>tss-react</code></a></li> <li><a href=\"https://vanilla-extract.style\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>vanilla-extract</code></a></li> </ul>\n<p>The following are currently working on support:</p>\n<ul> <li><a href=\"https://github.com/emotion-js/emotion/issues/2928\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>emotion</code></a></li> </ul>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: We're testing out different CSS-in-JS libraries and we'll be adding more examples for libraries that support React 18 features and/or the <code>app</code> directory.</p> </blockquote>\n<p>If you want to style Server Components, we recommend using <a href=\"css-modules\">CSS Modules</a> or other solutions that output CSS files, like PostCSS or <a href=\"tailwind-css\">Tailwind CSS</a>.</p>\n<h2 id=\"configuring-css-in-js-in-app\" data-docs-heading=\"\">Configuring CSS-in-JS in app     </h2>\n<p>Configuring CSS-in-JS is a three-step opt-in process that involves:</p>\n<ol> <li>A <strong>style registry</strong> to collect all CSS rules in a render.</li> <li>The new <code>useServerInsertedHTML</code> hook to inject rules before any content that might use them.</li> <li>A Client Component that wraps your app with the style registry during initial server-side rendering.</li> </ol>\n<h3 id=\"styled-jsx\" data-docs-heading=\"\">styled-jsx     </h3>\n<p>Using <code>styled-jsx</code> in Client Components requires using <code>v5.1.0</code>. First, create a new registry:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport React, { useState } from 'react'\nimport { useServerInsertedHTML } from 'next/navigation'\nimport { StyleRegistry, createStyleRegistry } from 'styled-jsx'\n \nexport default function StyledJsxRegistry({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  // Only create stylesheet once with lazy initial state\n  // x-ref: https://reactjs.org/docs/hooks-reference.html#lazy-initial-state\n  const [jsxStyleRegistry] = useState(() =&gt; createStyleRegistry())\n \n  useServerInsertedHTML(() =&gt; {\n    const styles = jsxStyleRegistry.styles()\n    jsxStyleRegistry.flush()\n    return &lt;&gt;{styles}&lt;/&gt;\n  })\n \n  return &lt;StyleRegistry registry={jsxStyleRegistry}&gt;{children}&lt;/StyleRegistry&gt;\n}</pre></div>\n<p>Then, wrap your <a href=\"../routing/pages-and-layouts#root-layout-required\">root layout</a> with the registry:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import StyledJsxRegistry from './registry'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;StyledJsxRegistry&gt;{children}&lt;/StyledJsxRegistry&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>\n<p><a href=\"https://github.com/vercel/app-playground/tree/main/app/styling/styled-jsx\" rel=\"noopener noreferrer\" target=\"_blank\">View an example here</a>.</p>\n<h3 id=\"styled-components\" data-docs-heading=\"\">Styled Components     </h3>\n<p>Below is an example of how to configure <code>styled-components@6</code> or newer:</p>\n<p>First, enable styled-components in <code>next.config.js</code>.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compiler: {\n    styledComponents: true,\n  },\n}</pre></div>\n<p>Then, use the <code>styled-components</code> API to create a global registry component to collect all CSS style rules generated during a render, and a function to return those rules. Then use the <code>useServerInsertedHTML</code> hook to inject the styles collected in the registry into the <code>&lt;head&gt;</code> HTML tag in the root layout.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport React, { useState } from 'react'\nimport { useServerInsertedHTML } from 'next/navigation'\nimport { ServerStyleSheet, StyleSheetManager } from 'styled-components'\n \nexport default function StyledComponentsRegistry({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  // Only create stylesheet once with lazy initial state\n  // x-ref: https://reactjs.org/docs/hooks-reference.html#lazy-initial-state\n  const [styledComponentsStyleSheet] = useState(() =&gt; new ServerStyleSheet())\n \n  useServerInsertedHTML(() =&gt; {\n    const styles = styledComponentsStyleSheet.getStyleElement()\n    styledComponentsStyleSheet.instance.clearTag()\n    return &lt;&gt;{styles}&lt;/&gt;\n  })\n \n  if (typeof window !== 'undefined') return &lt;&gt;{children}&lt;/&gt;\n \n  return (\n    &lt;StyleSheetManager sheet={styledComponentsStyleSheet.instance}&gt;\n      {children}\n    &lt;/StyleSheetManager&gt;\n  )\n}</pre></div>\n<p>Wrap the <code>children</code> of the root layout with the style registry component:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import StyledComponentsRegistry from './lib/registry'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;StyledComponentsRegistry&gt;{children}&lt;/StyledComponentsRegistry&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>\n<p><a href=\"https://github.com/vercel/app-playground/tree/main/app/styling/styled-components\" rel=\"noopener noreferrer\" target=\"_blank\">View an example here</a>.</p>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>During server rendering, styles will be extracted to a global registry and flushed to the <code>&lt;head&gt;</code> of your HTML. This ensures the style rules are placed before any content that might use them. In the future, we may use an upcoming React feature to determine where to inject the styles.</li> <li>During streaming, styles from each chunk will be collected and appended to existing styles. After client-side hydration is complete, <code>styled-components</code> will take over as usual and inject any further dynamic styles.</li> <li>We specifically use a Client Component at the top level of the tree for the style registry because it's more efficient to extract CSS rules this way. It avoids re-generating styles on subsequent server renders, and prevents them from being sent in the Server Component payload.</li> <li>For advanced use cases where you need to configure individual properties of styled-components compilation, you can read our <a href=\"../../../architecture/nextjs-compiler#styled-components\">Next.js styled-components API reference</a> to learn more.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/styling/css-in-js\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/styling/css-in-js</a>\n  </p>\n</div>\n","app/building-your-application/styling/sass":"<h1 class=\"break-words\">Sass</h1> <p>Next.js has built-in support for integrating with Sass after the package is installed using both the <code>.scss</code> and <code>.sass</code> extensions. You can use component-level Sass via CSS Modules and the <code>.module.scss</code>or <code>.module.sass</code> extension.</p> <p>First, install <a href=\"https://github.com/sass/sass\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>sass</code></a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install --save-dev sass</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <p>Sass supports <a href=\"https://sass-lang.com/documentation/syntax\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">two different syntaxes</a>, each with their own extension. The <code>.scss</code> extension requires you use the <a href=\"https://sass-lang.com/documentation/syntax#scss\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SCSS syntax</a>, while the <code>.sass</code> extension requires you use the <a href=\"https://sass-lang.com/documentation/syntax#the-indented-syntax\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Indented Syntax (\"Sass\")</a>.</p> <p>If you're not sure which to choose, start with the <code>.scss</code> extension which is a superset of CSS, and doesn't require you learn the Indented Syntax (\"Sass\").</p> </blockquote> <h3 id=\"customizing-sass-options\" data-docs-heading=\"\">Customizing Sass Options     </h3> <p>If you want to configure the Sass compiler, use <code>sassOptions</code> in <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const path = require('path')\n \nmodule.exports = {\n  sassOptions: {\n    includePaths: [path.join(__dirname, 'styles')],\n  },\n}</pre></div> <h3 id=\"sass-variables\" data-docs-heading=\"\">Sass Variables     </h3> <p>Next.js supports Sass variables exported from CSS Module files.</p> <p>For example, using the exported <code>primaryColor</code> Sass variable:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">$primary-color: #64ff00;\n \n:export {\n  primaryColor: $primary-color;\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// maps to root `/` URL\n \nimport variables from './variables.module.scss'\n \nexport default function Page() {\n  return &lt;h1 style={{ color: variables.primaryColor }}&gt;Hello, Next.js!&lt;/h1&gt;\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/styling/sass\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/styling/sass</a>\n  </p>\n</div>\n","app/building-your-application/optimizing":"<h1 class=\"break-words\">Optimizations</h1> <p>Next.js comes with a variety of built-in optimizations designed to improve your application's speed and <a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Core Web Vitals</a>. This guide will cover the optimizations you can leverage to enhance your user experience.</p> <h2 id=\"built-in-components\" data-docs-heading=\"\">Built-in Components     </h2> <p>Built-in components abstract away the complexity of implementing common UI optimizations. These components are:</p> <ul> <li>\n<strong>Images</strong>: Built on the native <code>&lt;img&gt;</code> element. The Image Component optimizes images for performance by lazy loading and automatically resizing images based on device size.</li> <li>\n<strong>Link</strong>: Built on the native <code>&lt;a&gt;</code> tags. The Link Component prefetches pages in the background, for faster and smoother page transitions.</li> <li>\n<strong>Scripts</strong>: Built on the native <code>&lt;script&gt;</code> tags. The Script Component gives you control over loading and execution of third-party scripts.</li> </ul> <h2 id=\"metadata\" data-docs-heading=\"\">Metadata     </h2> <p>Metadata helps search engines understand your content better (which can result in better SEO), and allows you to customize how your content is presented on social media, helping you create a more engaging and consistent user experience across various platforms.</p> <p>The Metadata API in Next.js allows you to modify the <code>&lt;head&gt;</code> element of a page. You can configure metadata in two ways:</p>\n<ul> <li>\n<strong>Config-based Metadata</strong>: Export a <a href=\"../api-reference/functions/generate-metadata#metadata-object\">static <code>metadata</code> object</a> or a dynamic <a href=\"../api-reference/functions/generate-metadata#generatemetadata-function\"><code>generateMetadata</code> function</a> in a <code>layout.js</code> or <code>page.js</code> file.</li> <li>\n<strong>File-based Metadata</strong>: Add static or dynamically generated special files to route segments.</li> </ul>\n<p>Additionally, you can create dynamic Open Graph Images using JSX and CSS with <a href=\"../api-reference/functions/image-response\">imageResponse</a> constructor.</p>  <h2 id=\"static-assets\" data-docs-heading=\"\">Static Assets     </h2> <p>Next.js <code>/public</code> folder can be used to serve static assets like images, fonts, and other files. Files inside <code>/public</code> can also be cached by CDN providers so that they are delivered efficiently.</p> <h2 id=\"analytics-and-monitoring\" data-docs-heading=\"\">Analytics and Monitoring     </h2> <p>For large applications, Next.js integrates with popular analytics and monitoring tools to help you understand how your application is performing. Learn more in the  <a href=\"../../pages/building-your-application/optimizing/open-telemetry\">OpenTelemetry</a> and <a href=\"../../pages/building-your-application/optimizing/instrumentation\">Instrumentation</a> guides.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/images":"<h1 class=\"break-words\">Image Optimization</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/image-component\" rel=\"noopener noreferrer\" target=\"_blank\">Image Component</a></li> </ul></details> <p>According to <a href=\"https://almanac.httparchive.org\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Almanac</a>, images account for a huge portion of the typical websites <a href=\"https://almanac.httparchive.org/en/2022/page-weight#content-type-and-file-formats\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">page weight</a> and can have a sizable impact on your website's <a href=\"https://almanac.httparchive.org/en/2022/performance#lcp-image-optimization\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">LCP performance</a>.</p> <p>The Next.js Image component extends the HTML <code>&lt;img&gt;</code> element with features for automatic image optimization:</p> <ul> <li>\n<strong>Size Optimization:</strong> Automatically serve correctly sized images for each device, using modern image formats like WebP and AVIF.</li> <li>\n<strong>Visual Stability:</strong> Prevent <a href=\"https://nextjs.org/learn/seo/web-performance/cls\">layout shift</a> automatically when images are loading.</li> <li>\n<strong>Faster Page Loads:</strong> Images are only loaded when they enter the viewport using native browser lazy loading, with optional blur-up placeholders.</li> <li>\n<strong>Asset Flexibility:</strong> On-demand image resizing, even for images stored on remote servers</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn more about how to use <code>next/image</code>  <a href=\"https://youtu.be/IU_qq_c_lKA\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (9 minutes)</a>.</p> </blockquote> <h2 id=\"usage\" data-docs-heading=\"\">Usage     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'</pre>\n</div> <p>You can then define the <code>src</code> for your image (either local or remote).</p> <h3 id=\"local-images\" data-docs-heading=\"\">Local Images     </h3> <p>To use a local image, <code>import</code> your <code>.jpg</code>, <code>.png</code>, or <code>.webp</code> image files.</p> <p>Next.js will <a href=\"#image-sizing\">automatically determine</a> the <code>width</code> and <code>height</code> of your image based on the imported file. These values are used to prevent <a href=\"https://nextjs.org/learn/seo/web-performance/cls\" rel=\"noopener noreferrer\" target=\"_blank\">Cumulative Layout Shift</a> while your image is loading.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport profilePic from './me.png'\n \nexport default function Page() {\n  return (\n    &lt;Image\n      src={profilePic}\n      alt=\"Picture of the author\"\n      // width={500} automatically provided\n      // height={500} automatically provided\n      // blurDataURL=\"data:...\" automatically provided\n      // placeholder=\"blur\" // Optional blur-up while loading\n    /&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> Dynamic <code>await import()</code> or <code>require()</code> are <em>not</em> supported. The <code>import</code> must be static so it can be analyzed at build time.</p> </blockquote> <h3 id=\"remote-images\" data-docs-heading=\"\">Remote Images     </h3> <p>To use a remote image, the <code>src</code> property should be a URL string.</p> <p>Since Next.js does not have access to remote files during the build process, you'll need to provide the <a href=\"../../api-reference/components/image#width\"><code>width</code></a>, <a href=\"../../api-reference/components/image#height\"><code>height</code></a> and optional <a href=\"../../api-reference/components/image#blurdataurl\"><code>blurDataURL</code></a> props manually.</p> <p>The <code>width</code> and <code>height</code> attributes are used to infer the correct aspect ratio of image and avoid layout shift from the image loading in. The <code>width</code> and <code>height</code> do <em>not</em> determine the rendered size of the image file. Learn more about <a href=\"#image-sizing\">Image Sizing</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return (\n    &lt;Image\n      src=\"https://s3.amazonaws.com/my-bucket/profile.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    /&gt;\n  )\n}</pre></div> <p>To safely allow optimizing images, define a list of supported URL patterns in <code>next.config.js</code>. Be as specific as possible to prevent malicious usage. For example, the following configuration will only allow images from a specific AWS S3 bucket:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 's3.amazonaws.com',\n        port: '',\n        pathname: '/my-bucket/**',\n      },\n    ],\n  },\n}</pre></div> <p>Learn more about <a href=\"../../api-reference/components/image#remotepatterns\"><code>remotePatterns</code></a> configuration. If you want to use relative URLs for the image <code>src</code>, use a <a href=\"../../api-reference/components/image#loader\"><code>loader</code></a>.</p> <h3 id=\"domains\" data-docs-heading=\"\">Domains     </h3> <p>Sometimes you may want to optimize a remote image, but still use the built-in Next.js Image Optimization API. To do this, leave the <code>loader</code> at its default setting and enter an absolute URL for the Image <code>src</code> prop.</p> <p>To protect your application from malicious users, you must define a list of remote hostnames you intend to use with the <code>next/image</code> component.</p> <blockquote class=\"p-3 text-sm\"> <p>Learn more about <a href=\"../../api-reference/components/image#remotepatterns\"><code>remotePatterns</code></a> configuration.</p> </blockquote> <h3 id=\"loaders\" data-docs-heading=\"\">Loaders     </h3> <p>Note that in the <a href=\"#local-images\">example earlier</a>, a partial URL (<code>\"/me.png\"</code>) is provided for a local image. This is possible because of the loader architecture.</p> <p>A loader is a function that generates the URLs for your image. It modifies the provided <code>src</code>, and generates multiple URLs to request the image at different sizes. These multiple URLs are used in the automatic <a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/srcset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">srcset</a> generation, so that visitors to your site will be served an image that is the right size for their viewport.</p> <p>The default loader for Next.js applications uses the built-in Image Optimization API, which optimizes images from anywhere on the web, and then serves them directly from the Next.js web server. If you would like to serve your images directly from a CDN or image server, you can write your own loader function with a few lines of JavaScript.</p> <p>You can define a loader per-image with the <a href=\"../../api-reference/components/image#loader\"><code>loader</code> prop</a>, or at the application level with the <a href=\"../../api-reference/components/image#loaderfile\"><code>loaderFile</code> configuration</a>.</p> <h2 id=\"priority\" data-docs-heading=\"\">Priority     </h2> <p>You should add the <code>priority</code> property to the image that will be the <a href=\"https://web.dev/lcp/#what-elements-are-considered\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Largest Contentful Paint (LCP) element</a> for each page. Doing so allows Next.js to specially prioritize the image for loading (e.g. through preload tags or priority hints), leading to a meaningful boost in LCP.</p> <p>The LCP element is typically the largest image or text block visible within the viewport of the page. When you run <code>next dev</code>, you'll see a console warning if the LCP element is an <code>&lt;Image&gt;</code> without the <code>priority</code> property.</p> <p>Once you've identified the LCP image, you can add the property like this:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport profilePic from '../public/me.png'\n \nexport default function Page() {\n  return &lt;Image src={profilePic} alt=\"Picture of the author\" priority /&gt;\n}</pre></div> <p>See more about priority in the <a href=\"../../api-reference/components/image#priority\"><code>next/image</code> component documentation</a>.</p> <h2 id=\"image-sizing\" data-docs-heading=\"\">Image Sizing     </h2> <p>One of the ways that images most commonly hurt performance is through <em>layout shift</em>, where the image pushes other elements around on the page as it loads in. This performance problem is so annoying to users that it has its own Core Web Vital, called <a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a>. The way to avoid image-based layout shifts is to <a href=\"https://web.dev/optimize-cls/#images-without-dimensions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">always size your images</a>. This allows the browser to reserve precisely enough space for the image before it loads.</p> <p>Because <code>next/image</code> is designed to guarantee good performance results, it cannot be used in a way that will contribute to layout shift, and <strong>must</strong> be sized in one of three ways:</p> <ol> <li>Automatically, using a <a href=\"#local-images\">static import</a>\n</li> <li>Explicitly, by including a <a href=\"../../api-reference/components/image#width\"><code>width</code></a> and <a href=\"../../api-reference/components/image#height\"><code>height</code></a> property</li> <li>Implicitly, by using <a href=\"../../api-reference/components/image#fill\">fill</a> which causes the image to expand to fill its parent element.</li> </ol> <blockquote class=\"p-3 text-sm\"> <p><strong>What if I don't know the size of my images?</strong></p> <p>If you are accessing images from a source without knowledge of the images' sizes, there are several things you can do:</p> <p><strong>Use <code>fill</code></strong></p> <p>The <a href=\"../../api-reference/components/image#fill\"><code>fill</code></a> prop allows your image to be sized by its parent element. Consider using CSS to give the image's parent element space on the page along <a href=\"../../api-reference/components/image#sizes\"><code>sizes</code></a> prop to match any media query break points. You can also use <a href=\"https://developer.mozilla.org/docs/Web/CSS/object-fit\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>object-fit</code></a> with <code>fill</code>, <code>contain</code>, or <code>cover</code>, and <a href=\"https://developer.mozilla.org/docs/Web/CSS/object-position\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>object-position</code></a> to define how the image should occupy that space.</p> <p><strong>Normalize your images</strong></p> <p>If you're serving images from a source that you control, consider modifying your image pipeline to normalize the images to a specific size.</p> <p><strong>Modify your API calls</strong></p> <p>If your application is retrieving image URLs using an API call (such as to a CMS), you may be able to modify the API call to return the image dimensions along with the URL.</p> </blockquote> <p>If none of the suggested methods works for sizing your images, the <code>next/image</code> component is designed to work well on a page alongside standard <code>&lt;img&gt;</code> elements.</p> <h2 id=\"styling\" data-docs-heading=\"\">Styling     </h2> <p>Styling the Image component is similar to styling a normal <code>&lt;img&gt;</code> element, but there are a few guidelines to keep in mind:</p> <ul> <li>Use <code>className</code> or <code>style</code>, not <code>styled-jsx</code>. <ul> <li>In most cases, we recommend using the <code>className</code> prop. This can be an imported <a href=\"../styling/css-modules\">CSS Module</a>, a <a href=\"../styling/css-modules#global-styles\">global stylesheet</a>, etc.</li> <li>You can also use the <code>style</code> prop to assign inline styles.</li> <li>You cannot use <a href=\"../styling/css-in-js\">styled-jsx</a> because it's scoped to the current component (unless you mark the style as <code>global</code>).</li> </ul> </li> <li>When using <code>fill</code>, the parent element must have <code>position: relative</code> <ul> <li>This is necessary for the proper rendering of the image element in that layout mode.</li> </ul> </li> <li>When using <code>fill</code>, the parent element must have <code>display: block</code> <ul> <li>This is the default for <code>&lt;div&gt;</code> elements but should be specified otherwise.</li> </ul> </li> </ul> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"responsive\" data-docs-heading=\"\">Responsive     </h3> <figure><img alt=\"Responsive image filling the width and height of its parent container\" loading=\"lazy\" width=\"1600\" height=\"629\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fresponsive-image.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fresponsive-image.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fresponsive-image.png&amp;w=3840&amp;q=75\"><img alt=\"Responsive image filling the width and height of its parent container\" loading=\"lazy\" width=\"1600\" height=\"629\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fresponsive-image.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fresponsive-image.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fresponsive-image.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n \nexport default function Responsive() {\n  return (\n    &lt;div style={{ display: 'flex', flexDirection: 'column' }}&gt;\n      &lt;Image\n        alt=\"Mountains\"\n        // Importing an image will\n        // automatically set the width and height\n        src={mountains}\n        sizes=\"100vw\"\n        // Make the image display full width\n        style={{\n          width: '100%',\n          height: 'auto',\n        }}\n      /&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <h3 id=\"fill-container\" data-docs-heading=\"\">Fill Container     </h3> <figure><img alt=\"Grid of images filling parent container width\" loading=\"lazy\" width=\"1600\" height=\"529\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ffill-container.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ffill-container.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ffill-container.png&amp;w=3840&amp;q=75\"><img alt=\"Grid of images filling parent container width\" loading=\"lazy\" width=\"1600\" height=\"529\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ffill-container.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ffill-container.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ffill-container.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n \nexport default function Fill() {\n  return (\n    &lt;div\n      style={{\n        display: 'grid',\n        gridGap: '8px',\n        gridTemplateColumns: 'repeat(auto-fit, minmax(400px, auto))',\n      }}\n    &gt;\n      &lt;div style={{ position: 'relative', height: '400px' }}&gt;\n        &lt;Image\n          alt=\"Mountains\"\n          src={mountains}\n          fill\n          sizes=\"(min-width: 808px) 50vw, 100vw\"\n          style={{\n            objectFit: 'cover', // cover, contain, none\n          }}\n        /&gt;\n      &lt;/div&gt;\n      {/* And more images in the grid... */}\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <h3 id=\"background-image\" data-docs-heading=\"\">Background Image     </h3> <figure><img alt=\"Background image taking full width and height of page\" loading=\"lazy\" width=\"1600\" height=\"427\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fbackground-image.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fbackground-image.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fbackground-image.png&amp;w=3840&amp;q=75\"><img alt=\"Background image taking full width and height of page\" loading=\"lazy\" width=\"1600\" height=\"427\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fbackground-image.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fbackground-image.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fbackground-image.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n \nexport default function Background() {\n  return (\n    &lt;Image\n      alt=\"Mountains\"\n      src={mountains}\n      placeholder=\"blur\"\n      quality={100}\n      fill\n      sizes=\"100vw\"\n      style={{\n        objectFit: 'cover',\n      }}\n    /&gt;\n  )\n}</pre>\n</div> <p>For examples of the Image component used with the various styles, see the <a href=\"https://image-component.nextjs.gallery\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Image Component Demo</a>.</p> <h2 id=\"other-properties\" data-docs-heading=\"\">Other Properties     </h2> <p><a href=\"../../api-reference/components/image\"><strong>View all properties available to the <code>next/image</code> component.</strong></a></p> <h2 id=\"configuration\" data-docs-heading=\"\">Configuration     </h2> <p>The <code>next/image</code> component and Next.js Image Optimization API can be configured in the <a href=\"../../api-reference/next-config-js\"><code>next.config.js</code> file</a>. These configurations allow you to <a href=\"../../api-reference/components/image#remotepatterns\">enable remote images</a>, <a href=\"../../api-reference/components/image#devicesizes\">define custom image breakpoints</a>, <a href=\"../../api-reference/components/image#caching-behavior\">change caching behavior</a> and more.</p> <p><a href=\"../../api-reference/components/image#configuration-options\"><strong>Read the full image configuration documentation for more information.</strong></a></p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/images\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/images</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/videos":"<h1 class=\"break-words\">Video Optimization</h1>\n<p>This page outlines how to use videos with Next.js applications, showing how to store and display video files without affecting performance.</p> <h2 id=\"using-video-and-iframe\" data-docs-heading=\"\">Using &lt;video&gt; and &lt;iframe&gt;     </h2> <p>Videos can be embedded on the page using the HTML <strong><code>&lt;video&gt;</code></strong> tag for direct video files and <strong><code>&lt;iframe&gt;</code></strong> for external platform-hosted videos.</p> <h3 id=\"video\" data-docs-heading=\"\">&lt;video&gt;     </h3> <p>The HTML <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>&lt;video&gt;</code></a> tag can embed self-hosted or directly served video content, allowing full control over the playback and appearance.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function Video() {\n  return (\n    &lt;video width=\"320\" height=\"240\" controls preload=\"none\"&gt;\n      &lt;source src=\"/path/to/video.mp4\" type=\"video/mp4\" /&gt;\n      &lt;track\n        src=\"/path/to/captions.vtt\"\n        kind=\"subtitles\"\n        srcLang=\"en\"\n        label=\"English\"\n      /&gt;\n      Your browser does not support the video tag.\n    &lt;/video&gt;\n  )\n}</pre></div> <h3 id=\"common-video-tag-attributes\" data-docs-heading=\"\">Common &lt;video&gt; tag attributes     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Attribute</th>\n<th>Description</th>\n<th>Example Value</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>src</code></td>\n<td>Specifies the source of the video file.</td>\n<td><code>&lt;video src=\"/path/to/video.mp4\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>width</code></td>\n<td>Sets the width of the video player.</td>\n<td><code>&lt;video width=\"320\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>height</code></td>\n<td>Sets the height of the video player.</td>\n<td><code>&lt;video height=\"240\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>controls</code></td>\n<td>If present, it displays the default set of playback controls.</td>\n<td><code>&lt;video controls /&gt;</code></td>\n</tr>\n<tr>\n<td><code>autoPlay</code></td>\n<td>Automatically starts playing the video when the page loads. Note: Autoplay policies vary across browsers.</td>\n<td><code>&lt;video autoPlay /&gt;</code></td>\n</tr>\n<tr>\n<td><code>loop</code></td>\n<td>Loops the video playback.</td>\n<td><code>&lt;video loop /&gt;</code></td>\n</tr>\n<tr>\n<td><code>muted</code></td>\n<td>Mutes the audio by default. Often used with <code>autoPlay</code>.</td>\n<td><code>&lt;video muted /&gt;</code></td>\n</tr>\n<tr>\n<td><code>preload</code></td>\n<td>Specifies how the video is preloaded. Values: <code>none</code>, <code>metadata</code>, <code>auto</code>.</td>\n<td><code>&lt;video preload=\"none\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>playsInline</code></td>\n<td>Enables inline playback on iOS devices, often necessary for autoplay to work on iOS Safari.</td>\n<td><code>&lt;video playsInline /&gt;</code></td>\n</tr>\n</tbody>\n</table></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: When using the <code>autoPlay</code> attribute, it is important to also include the <code>muted</code> attribute to ensure the video plays automatically in most browsers and the <code>playsInline</code> attribute for compatibility with iOS devices.</p> </blockquote> <p>For a comprehensive list of video attributes, refer to the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDN documentation</a>.</p> <h3 id=\"video-best-practices\" data-docs-heading=\"\">Video best practices     </h3> <ul> <li>\n<strong>Fallback Content:</strong> When using the <code>&lt;video&gt;</code> tag, include fallback content inside the tag for browsers that do not support video playback.</li> <li>\n<strong>Subtitles or Captions:</strong> Include subtitles or captions for users who are deaf or hard of hearing. Utilize the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>&lt;track&gt;</code></a> tag with your <code>&lt;video&gt;</code> elements to specify caption file sources.</li> <li>\n<strong>Accessible Controls:</strong> Standard HTML5 video controls are recommended for keyboard navigation and screen reader compatibility. For advanced needs, consider third-party players like <a href=\"https://github.com/cookpete/react-player\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">react-player</a> or <a href=\"https://videojs.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">video.js</a>, which offer accessible controls and consistent browser experience.</li> </ul> <h3 id=\"iframe\" data-docs-heading=\"\">&lt;iframe&gt;     </h3> <p>The HTML <code>&lt;iframe&gt;</code> tag allows you to embed videos from external platforms like YouTube or Vimeo.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return (\n    &lt;iframe\n      src=\"https://www.youtube.com/watch?v=gfU1iZnjRZM\"\n      frameborder=\"0\"\n      allowfullscreen\n    /&gt;\n  )\n}</pre></div> <h3 id=\"common-iframe-tag-attributes\" data-docs-heading=\"\">Common &lt;iframe&gt; tag attributes     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Attribute</th>\n<th>Description</th>\n<th>Example Value</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>src</code></td>\n<td>The URL of the page to embed.</td>\n<td><code>&lt;iframe src=\"https://example.com\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>width</code></td>\n<td>Sets the width of the iframe.</td>\n<td><code>&lt;iframe width=\"500\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>height</code></td>\n<td>Sets the height of the iframe.</td>\n<td><code>&lt;iframe height=\"300\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>frameborder</code></td>\n<td>Specifies whether or not to display a border around the iframe.</td>\n<td><code>&lt;iframe frameborder=\"0\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>allowfullscreen</code></td>\n<td>Allows the iframe content to be displayed in full-screen mode.</td>\n<td><code>&lt;iframe allowfullscreen /&gt;</code></td>\n</tr>\n<tr>\n<td><code>sandbox</code></td>\n<td>Enables an extra set of restrictions on the content within the iframe.</td>\n<td><code>&lt;iframe sandbox /&gt;</code></td>\n</tr>\n<tr>\n<td><code>loading</code></td>\n<td>Optimize loading behavior (e.g., lazy loading).</td>\n<td><code>&lt;iframe loading=\"lazy\" /&gt;</code></td>\n</tr>\n<tr>\n<td><code>title</code></td>\n<td>Provides a title for the iframe to support accessibility.</td>\n<td><code>&lt;iframe title=\"Description\" /&gt;</code></td>\n</tr>\n</tbody>\n</table></div> <p>For a comprehensive list of iframe attributes, refer to the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDN documentation</a>.</p> <h3 id=\"choosing-a-video-embedding-method\" data-docs-heading=\"\">Choosing a video embedding method     </h3> <p>There are two ways you can embed videos in your Next.js application:</p> <ul> <li>\n<strong>Self-hosted or direct video files:</strong> Embed self-hosted videos using the <code>&lt;video&gt;</code> tag for scenarios requiring detailed control over the player's functionality and appearance. This integration method within Next.js allows for customization and control of your video content.</li> <li>\n<strong>Using video hosting services (YouTube, Vimeo, etc.):</strong> For video hosting services like YouTube or Vimeo, you'll embed their iframe-based players using the <code>&lt;iframe&gt;</code> tag. While this method limits some control over the player, it offers ease of use and features provided by these platforms.</li> </ul> <p>Choose the embedding method that aligns with your application's requirements and the user experience you aim to deliver.</p> <h3 id=\"embedding-externally-hosted-videos\" data-docs-heading=\"\">Embedding externally hosted videos     </h3> <p>To embed videos from external platforms, you can use Next.js to fetch the video information and React Suspense to handle the fallback state while loading.</p> <p><strong>1. Create a Server Component for video embedding</strong></p> <p>The first step is to create a <a href=\"../rendering/server-components\" rel=\"noopener noreferrer\" target=\"_blank\">Server Component</a> that generates the appropriate iframe for embedding the video. This component will fetch the source URL for the video and render the iframe.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function VideoComponent() {\n  const src = await getVideoSrc()\n \n  return &lt;iframe src={src} frameborder=\"0\" allowfullscreen /&gt;\n}</pre></div> <p><strong>2. Stream the video component using React Suspense</strong></p> <p>After creating the Server Component to embed the video, the next step is to <a href=\"../routing/loading-ui-and-streaming\" rel=\"noopener noreferrer\" target=\"_blank\">stream</a> the component using <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Suspense</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Suspense } from 'react'\nimport VideoComponent from '../ui/VideoComponent.jsx'\n \nexport default function Page() {\n  return (\n    &lt;section&gt;\n      &lt;Suspense fallback={&lt;p&gt;Loading video...&lt;/p&gt;}&gt;\n        &lt;VideoComponent /&gt;\n      &lt;/Suspense&gt;\n      {/* Other content of the page */}\n    &lt;/section&gt;\n  )\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: When embedding videos from external platforms, consider the following best practices:</p> <ul> <li>Ensure the video embeds are responsive. Use CSS to make the iframe or video player adapt to different screen sizes.</li> <li>Implement <a href=\"https://yoast.com/site-speed-tips-for-faster-video/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">strategies for loading videos</a> based on network conditions, especially for users with limited data plans.</li> </ul> </blockquote> <p>This approach results in a better user experience as it prevents the page from blocking, meaning the user can interact with the page while the video component streams in.</p> <p>For a more engaging and informative loading experience, consider using a loading skeleton as the fallback UI. So instead of showing a simple loading message, you can show a skeleton that resembles the video player like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Suspense } from 'react'\nimport VideoComponent from '../ui/VideoComponent.jsx'\nimport VideoSkeleton from '../ui/VideoSkeleton.jsx'\n \nexport default function Page() {\n  return (\n    &lt;section&gt;\n      &lt;Suspense fallback={&lt;VideoSkeleton /&gt;}&gt;\n        &lt;VideoComponent /&gt;\n      &lt;/Suspense&gt;\n      {/* Other content of the page */}\n    &lt;/section&gt;\n  )\n}</pre></div> <h2 id=\"self-hosted-videos\" data-docs-heading=\"\">Self-hosted videos     </h2> <p>Self-hosting videos may be preferable for several reasons:</p> <ul> <li>\n<strong>Complete control and independence</strong>: Self-hosting gives you direct management over your video content, from playback to appearance, ensuring full ownership and control, free from external platform constraints.</li> <li>\n<strong>Customization for specific needs</strong>: Ideal for unique requirements, like dynamic background videos, it allows for tailored customization to align with design and functional needs.</li> <li>\n<strong>Performance and scalability considerations</strong>: Choose storage solutions that are both high-performing and scalable, to support increasing traffic and content size effectively.</li> <li>\n<strong>Cost and integration</strong>: Balance the costs of storage and bandwidth with the need for easy integration into your Next.js framework and broader tech ecosystem.</li> </ul> <h3 id=\"using-vercel-blob-for-video-hosting\" data-docs-heading=\"\">Using Vercel Blob for video hosting     </h3> <p><a href=\"https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Blob</a> offers an efficient way to host videos, providing a scalable cloud storage solution that works well with Next.js. Here's how you can host a video using Vercel Blob:</p> <p><strong>1. Uploading a video to Vercel Blob</strong></p> <p>In your Vercel dashboard, navigate to the \"Storage\" tab and select your <a href=\"https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Blob</a> store. In the Blob table's upper-right corner, find and click the \"Upload\" button. Then, choose the video file you wish to upload. After the upload completes, the video file will appear in the Blob table.</p> <p>Alternatively, you can upload your video using a server action. For detailed instructions, refer to the Vercel documentation on <a href=\"https://vercel.com/docs/storage/vercel-blob/server-upload\" rel=\"noopener noreferrer\" target=\"_blank\">server-side uploads</a>. Vercel also supports <a href=\"https://vercel.com/docs/storage/vercel-blob/client-upload\" rel=\"noopener noreferrer\" target=\"_blank\">client-side uploads</a>. This method may be preferable for certain use cases.</p> <p><strong>2. Displaying the video in Next.js</strong></p> <p>Once the video is uploaded and stored, you can display it in your Next.js application. Here's an example of how to do this using the <code>&lt;video&gt;</code> tag and React Suspense:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Suspense } from 'react'\nimport { list } from '@vercel/blob'\n \nexport default function Page() {\n  return (\n    &lt;Suspense fallback={&lt;p&gt;Loading video...&lt;/p&gt;}&gt;\n      &lt;VideoComponent fileName=\"my-video.mp4\" /&gt;\n    &lt;/Suspense&gt;\n  )\n}\n \nasync function VideoComponent({ fileName }) {\n  const { blobs } = await list({\n    prefix: fileName,\n    limit: 1,\n  })\n  const { url } = blobs[0]\n \n  return (\n    &lt;video controls preload=\"none\" aria-label=\"Video player\"&gt;\n      &lt;source src={url} type=\"video/mp4\" /&gt;\n      Your browser does not support the video tag.\n    &lt;/video&gt;\n  )\n}</pre></div> <p>In this approach, the page uses the video's <code>@vercel/blob</code> URL to display the video using the <code>VideoComponent</code>. React Suspense is used to show a fallback until the video URL is fetched and the video is ready to be displayed.</p> <h3 id=\"adding-subtitles-to-your-video\" data-docs-heading=\"\">Adding subtitles to your video     </h3> <p>If you have subtitles for your video, you can easily add them using the <code>&lt;track&gt;</code> element inside your <code>&lt;video&gt;</code> tag. You can fetch the subtitle file from <a href=\"https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Blob</a> in a similar way as the video file. Here's how you can update the <code>&lt;VideoComponent&gt;</code> to include subtitles.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">async function VideoComponent({ fileName }) {\n  const {blobs} = await list({\n    prefix: fileName,\n    limit: 2\n  });\n  const { url } = blobs[0];\n  const { url: captionsUrl } = blobs[1];\n \n  return (\n    &lt;video controls preload=\"none\" aria-label=\"Video player\"&gt;\n      &lt;source src={url} type=\"video/mp4\" /&gt;\n      &lt;track\n        src={captionsUrl}\n        kind=\"subtitles\"\n        srcLang=\"en\"\n        label=\"English\"&gt;\n      Your browser does not support the video tag.\n    &lt;/video&gt;\n  );\n};</pre></div> <p>By following this approach, you can effectively self-host and integrate videos into your Next.js applications.</p> <h2 id=\"resources\" data-docs-heading=\"\">Resources     </h2> <p>To continue learning more about video optimization and best practices, please refer to the following resources:</p> <ul> <li>\n<strong>Understanding video formats and codecs</strong>: Choose the right format and codec, like MP4 for compatibility or WebM for web optimization, for your video needs. For more details, see <a href=\"https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Video_codecs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Mozilla's guide on video codecs</a>.</li> <li>\n<strong>Video compression</strong>: Use tools like FFmpeg to effectively compress videos, balancing quality with file size. Learn about compression techniques at <a href=\"https://www.ffmpeg.org/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">FFmpeg's official website</a>.</li> <li>\n<strong>Resolution and bitrate adjustment</strong>: Adjust <a href=\"https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">resolution and bitrate</a> based on the viewing platform, with lower settings for mobile devices.</li> <li>\n<strong>Content Delivery Networks (CDNs)</strong>: Utilize a CDN to enhance video delivery speed and manage high traffic. When using some storage solutions, such as Vercel Blob, CDN functionality is automatically handled for you. <a href=\"https://vercel.com/docs/edge-network/overview?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Learn more</a> about CDNs and their benefits.</li> </ul> <p>Explore these video streaming platforms for integrating video into your Next.js projects:</p> <h3 id=\"open-source-next-video-component\" data-docs-heading=\"\">Open source next-video component     </h3> <ul> <li>Provides a <code>&lt;Video&gt;</code> component for Next.js, compatible with various hosting services including <a href=\"https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Blob</a>, S3, Backblaze, and Mux.</li> <li>\n<a href=\"https://next-video.dev/docs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Detailed documentation</a> for using <code>next-video.dev</code> with different hosting services.</li> </ul> <h3 id=\"cloudinary-integration\" data-docs-heading=\"\">Cloudinary Integration     </h3> <ul> <li>Official <a href=\"https://next.cloudinary.dev/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">documentation and integration guide</a> for using Cloudinary with Next.js.</li> <li>Includes a <code>&lt;CldVideoPlayer&gt;</code> component for <a href=\"https://next.cloudinary.dev/cldvideoplayer/basic-usage\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">drop-in video support</a>.</li> <li>Find <a href=\"https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">examples</a> of integrating Cloudinary with Next.js including <a href=\"https://github.com/cloudinary-community/cloudinary-examples/tree/main/examples/nextjs-cldvideoplayer-abr\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Adaptive Bitrate Streaming</a>.</li> <li>Other <a href=\"https://cloudinary.com/documentation\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cloudinary libraries</a> including a Node.js SDK are also available.</li> </ul> <h3 id=\"mux-video-api\" data-docs-heading=\"\">Mux Video API     </h3> <ul> <li>Mux provides a <a href=\"https://github.com/muxinc/video-course-starter-kit\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">starter template</a> for creating a video course with Mux and Next.js.</li> <li>Learn about Mux's recommendations for embedding <a href=\"https://www.mux.com/for/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">high-performance video for your Next.js application</a>.</li> <li>Explore an <a href=\"https://with-mux-video.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">example project</a> demonstrating Mux with Next.js.</li> </ul> <h3 id=\"fastly\" data-docs-heading=\"\">Fastly     </h3> <ul> <li>Learn more about integrating Fastly's solutions for <a href=\"https://www.fastly.com/products/streaming-media/video-on-demand\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">video on demand</a> and streaming media into Next.js.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/videos\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/videos</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/fonts":"<h1 class=\"break-words\">Font Optimization</h1> <p><a href=\"../../api-reference/components/font\"><strong><code>next/font</code></strong></a> will automatically optimize your fonts (including custom fonts) and remove external network requests for improved privacy and performance.</p> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn more about using <code>next/font</code>  <a href=\"https://www.youtube.com/watch?v=L8_98i_bMMA\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (6 minutes)</a>.</p> </blockquote> <p><code>next/font</code> includes <strong>built-in automatic self-hosting</strong> for <em>any</em> font file. This means you can optimally load web fonts with zero layout shift, thanks to the underlying CSS <code>size-adjust</code> property used.</p> <p>This new font system also allows you to conveniently use all Google Fonts with performance and privacy in mind. CSS and font files are downloaded at build time and self-hosted with the rest of your static assets. <strong>No requests are sent to Google by the browser.</strong></p> <h2 id=\"google-fonts\" data-docs-heading=\"\">Google Fonts     </h2> <p>Automatically self-host any Google Font. Fonts are included in the deployment and served from the same domain as your deployment. <strong>No requests are sent to Google by the browser.</strong></p> <p>Get started by importing the font you would like to use from <code>next/font/google</code> as a function. We recommend using <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable fonts</a> for the best performance and flexibility.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'\n \n// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\" className={inter.className}&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>\n<p>If you can't use a variable font, you will <strong>need to specify a weight</strong>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Roboto } from 'next/font/google'\n \nconst roboto = Roboto({\n  weight: '400',\n  subsets: ['latin'],\n  display: 'swap',\n})\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\" className={roboto.className}&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>You can specify multiple weights and/or styles by using an array:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const roboto = Roboto({\n  weight: ['400', '700'],\n  style: ['normal', 'italic'],\n  subsets: ['latin'],\n  display: 'swap',\n})</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Use an underscore (_) for font names with multiple words. E.g. <code>Roboto Mono</code> should be imported as <code>Roboto_Mono</code>.</p> </blockquote>  <h3 id=\"specifying-a-subset\" data-docs-heading=\"\">Specifying a subset     </h3> <p>Google Fonts are automatically <a href=\"https://fonts.google.com/knowledge/glossary/subsetting\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">subset</a>. This reduces the size of the font file and improves performance. You'll need to define which of these subsets you want to preload. Failing to specify any subsets while <a href=\"../../api-reference/components/font#preload\"><code>preload</code></a> is <code>true</code> will result in a warning.</p> <p>This can be done by adding it to the function call:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const inter = Inter({ subsets: ['latin'] })</pre></div>  <p>View the <a href=\"../../api-reference/components/font\">Font API Reference</a> for more information.</p> <h3 id=\"using-multiple-fonts\" data-docs-heading=\"\">Using Multiple Fonts     </h3> <p>You can import and use multiple fonts in your application. There are two approaches you can take.</p> <p>The first approach is to create a utility function that exports a font, imports it, and applies its <code>className</code> where needed. This ensures the font is preloaded only when it's rendered:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter, Roboto_Mono } from 'next/font/google'\n \nexport const inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n \nexport const roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n})</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { inter } from './fonts'\n \nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    &lt;html lang=\"en\" className={inter.className}&gt;\n      &lt;body&gt;\n        &lt;div&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { roboto_mono } from './fonts'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;h1 className={roboto_mono.className}&gt;My page&lt;/h1&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <p>In the example above, <code>Inter</code> will be applied globally, and <code>Roboto Mono</code> can be imported and applied as needed.</p> <p>Alternatively, you can create a <a href=\"../../api-reference/components/font#variable\">CSS variable</a> and use it with your preferred CSS solution:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter, Roboto_Mono } from 'next/font/google'\nimport styles from './global.css'\n \nconst inter = Inter({\n  subsets: ['latin'],\n  variable: '--font-inter',\n  display: 'swap',\n})\n \nconst roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  variable: '--font-roboto-mono',\n  display: 'swap',\n})\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\" className={`${inter.variable} ${roboto_mono.variable}`}&gt;\n      &lt;body&gt;\n        &lt;h1&gt;My App&lt;/h1&gt;\n        &lt;div&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">html {\n  font-family: var(--font-inter);\n}\n \nh1 {\n  font-family: var(--font-roboto-mono);\n}</pre></div> <p>In the example above, <code>Inter</code> will be applied globally, and any <code>&lt;h1&gt;</code> tags will be styled with <code>Roboto Mono</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: Use multiple fonts conservatively since each new font is an additional resource the client has to download.</p> </blockquote> <h2 id=\"local-fonts\" data-docs-heading=\"\">Local Fonts     </h2> <p>Import <code>next/font/local</code> and specify the <code>src</code> of your local font file. We recommend using <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable fonts</a> for the best performance and flexibility.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import localFont from 'next/font/local'\n \n// Font files can be colocated inside of `app`\nconst myFont = localFont({\n  src: './my-font.woff2',\n  display: 'swap',\n})\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\" className={myFont.className}&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>If you want to use multiple files for a single font family, <code>src</code> can be an array:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const roboto = localFont({\n  src: [\n    {\n      path: './Roboto-Regular.woff2',\n      weight: '400',\n      style: 'normal',\n    },\n    {\n      path: './Roboto-Italic.woff2',\n      weight: '400',\n      style: 'italic',\n    },\n    {\n      path: './Roboto-Bold.woff2',\n      weight: '700',\n      style: 'normal',\n    },\n    {\n      path: './Roboto-BoldItalic.woff2',\n      weight: '700',\n      style: 'italic',\n    },\n  ],\n})</pre>\n</div> <p>View the <a href=\"../../api-reference/components/font\">Font API Reference</a> for more information.</p> <h2 id=\"with-tailwind-css\" data-docs-heading=\"\">With Tailwind CSS     </h2> <p><code>next/font</code> can be used with <a href=\"https://tailwindcss.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Tailwind CSS</a> through a <a href=\"../../api-reference/components/font#css-variables\">CSS variable</a>.</p> <p>In the example below, we use the font <code>Inter</code> from <code>next/font/google</code> (you can use any font from Google or Local Fonts). Load your font with the <code>variable</code> option to define your CSS variable name and assign it to <code>inter</code>. Then, use <code>inter.variable</code> to add the CSS variable to your HTML document.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter, Roboto_Mono } from 'next/font/google'\n \nconst inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n  variable: '--font-inter',\n})\n \nconst roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n  variable: '--font-roboto-mono',\n})\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\" className={`${inter.variable} ${roboto_mono.variable}`}&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>Finally, add the CSS variable to your <a href=\"../styling/tailwind-css#configuring-tailwind\">Tailwind CSS config</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    './pages/**/*.{js,ts,jsx,tsx}',\n    './components/**/*.{js,ts,jsx,tsx}',\n    './app/**/*.{js,ts,jsx,tsx}',\n  ],\n  theme: {\n    extend: {\n      fontFamily: {\n        sans: ['var(--font-inter)'],\n        mono: ['var(--font-roboto-mono)'],\n      },\n    },\n  },\n  plugins: [],\n}</pre></div> <p>You can now use the <code>font-sans</code> and <code>font-mono</code> utility classes to apply the font to your elements.</p> <h2 id=\"preloading\" data-docs-heading=\"\">Preloading     </h2> <p>When a font function is called on a page of your site, it is not globally available and preloaded on all routes. Rather, the font is only preloaded on the related routes based on the type of file where it is used:</p>\n<ul> <li>If it's a <a href=\"../routing/pages-and-layouts#pages\">unique page</a>, it is preloaded on the unique route for that page.</li> <li>If it's a <a href=\"../routing/pages-and-layouts#layouts\">layout</a>, it is preloaded on all the routes wrapped by the layout.</li> <li>If it's the <a href=\"../routing/pages-and-layouts#root-layout-required\">root layout</a>, it is preloaded on all routes.</li> </ul>  <h2 id=\"reusing-fonts\" data-docs-heading=\"\">Reusing fonts     </h2> <p>Every time you call the <code>localFont</code> or Google font function, that font is hosted as one instance in your application. Therefore, if you load the same font function in multiple files, multiple instances of the same font are hosted. In this situation, it is recommended to do the following:</p> <ul> <li>Call the font loader function in one shared file</li> <li>Export it as a constant</li> <li>Import the constant in each file where you would like to use this font</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/fonts\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/fonts</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/metadata":"<h1 class=\"break-words\">Metadata</h1>\n<p>Next.js has a Metadata API that can be used to define your application metadata (e.g. <code>meta</code> and <code>link</code> tags inside your HTML <code>head</code> element) for improved SEO and web shareability.</p> <p>There are two ways you can add metadata to your application:</p> <ul> <li>\n<strong>Config-based Metadata</strong>: Export a <a href=\"../../api-reference/functions/generate-metadata#metadata-object\">static <code>metadata</code> object</a> or a dynamic <a href=\"../../api-reference/functions/generate-metadata#generatemetadata-function\"><code>generateMetadata</code> function</a> in a <code>layout.js</code> or <code>page.js</code> file.</li> <li>\n<strong>File-based Metadata</strong>: Add static or dynamically generated special files to route segments.</li> </ul> <p>With both these options, Next.js will automatically generate the relevant <code>&lt;head&gt;</code> elements for your pages. You can also create dynamic OG images using the <a href=\"../../api-reference/functions/image-response\"><code>ImageResponse</code></a> constructor.</p> <h2 id=\"static-metadata\" data-docs-heading=\"\">Static Metadata     </h2> <p>To define static metadata, export a <a href=\"../../api-reference/functions/generate-metadata#metadata-object\"><code>Metadata</code> object</a> from a <code>layout.js</code> or static <code>page.js</code> file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: '...',\n  description: '...',\n}\n \nexport default function Page() {}</pre></div>  <p>For all the available options, see the <a href=\"../../api-reference/functions/generate-metadata\">API Reference</a>.</p> <h2 id=\"dynamic-metadata\" data-docs-heading=\"\">Dynamic Metadata     </h2> <p>You can use <code>generateMetadata</code> function to <code>fetch</code> metadata that requires dynamic values.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata, ResolvingMetadata } from 'next'\n \ntype Props = {\n  params: { id: string }\n  searchParams: { [key: string]: string | string[] | undefined }\n}\n \nexport async function generateMetadata(\n  { params, searchParams }: Props,\n  parent: ResolvingMetadata\n): Promise&lt;Metadata&gt; {\n  // read route params\n  const id = params.id\n \n  // fetch data\n  const product = await fetch(`https://.../${id}`).then((res) =&gt; res.json())\n \n  // optionally access and extend (rather than replace) parent metadata\n  const previousImages = (await parent).openGraph?.images || []\n \n  return {\n    title: product.title,\n    openGraph: {\n      images: ['/some-specific-page-image.jpg', ...previousImages],\n    },\n  }\n}\n \nexport default function Page({ params, searchParams }: Props) {}</pre></div>  <p>For all the available params, see the <a href=\"../../api-reference/functions/generate-metadata\">API Reference</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Both static and dynamic metadata through <code>generateMetadata</code> are <strong>only supported in Server Components</strong>.</li> <li>\n<code>fetch</code> requests are automatically <a href=\"../caching#request-memoization\">memoized</a> for the same data across <code>generateMetadata</code>, <code>generateStaticParams</code>, Layouts, Pages, and Server Components. React <a href=\"../caching#request-memoization\"><code>cache</code> can be used</a> if <code>fetch</code> is unavailable.</li> <li>Next.js will wait for data fetching inside <code>generateMetadata</code> to complete before streaming UI to the client. This guarantees the first part of a <a href=\"../routing/loading-ui-and-streaming\">streamed response</a> includes <code>&lt;head&gt;</code> tags.</li> </ul> </blockquote> <h2 id=\"file-based-metadata\" data-docs-heading=\"\">File-based metadata     </h2> <p>These special files are available for metadata:</p> <ul> <li><a href=\"../../api-reference/file-conventions/metadata/app-icons\">favicon.ico, apple-icon.jpg, and icon.jpg</a></li> <li><a href=\"../../api-reference/file-conventions/metadata/opengraph-image\">opengraph-image.jpg and twitter-image.jpg</a></li> <li><a href=\"../../api-reference/file-conventions/metadata/robots\">robots.txt</a></li> <li><a href=\"../../api-reference/file-conventions/metadata/sitemap\">sitemap.xml</a></li> </ul> <p>You can use these for static metadata, or you can programmatically generate these files with code.</p> <p>For implementation and examples, see the <a href=\"../../api-reference/file-conventions/metadata\">Metadata Files</a> API Reference and <a href=\"#dynamic-image-generation\">Dynamic Image Generation</a>.</p> <h2 id=\"behavior\" data-docs-heading=\"\">Behavior     </h2> <p>File-based metadata has the higher priority and will override any config-based metadata.</p> <h3 id=\"default-fields\" data-docs-heading=\"\">Default Fields     </h3> <p>There are two default <code>meta</code> tags that are always added even if a route doesn't define metadata:</p> <ul> <li>The <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/meta#attr-charset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta charset tag</a> sets the character encoding for the website.</li> <li>The <a href=\"https://developer.mozilla.org/docs/Web/HTML/Viewport_meta_tag\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta viewport tag</a> sets the viewport width and scale for the website to adjust for different devices.</li> </ul> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta charset=\"utf-8\" /&gt;\n&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /&gt;</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You can overwrite the default <a href=\"../../api-reference/functions/generate-metadata#viewport\"><code>viewport</code></a> meta tag.</p> </blockquote> <h3 id=\"ordering\" data-docs-heading=\"\">Ordering     </h3> <p>Metadata is evaluated in order, starting from the root segment down to the segment closest to the final <code>page.js</code> segment. For example:</p> <ol> <li>\n<code>app/layout.tsx</code> (Root Layout)</li> <li>\n<code>app/blog/layout.tsx</code> (Nested Blog Layout)</li> <li>\n<code>app/blog/[slug]/page.tsx</code> (Blog Page)</li> </ol> <h3 id=\"merging\" data-docs-heading=\"\">Merging     </h3> <p>Following the <a href=\"#ordering\">evaluation order</a>, Metadata objects exported from multiple segments in the same route are <strong>shallowly</strong> merged together to form the final metadata output of a route. Duplicate keys are <strong>replaced</strong> based on their ordering.</p> <p>This means metadata with nested fields such as <a href=\"../../api-reference/functions/generate-metadata#opengraph\"><code>openGraph</code></a> and <a href=\"../../api-reference/functions/generate-metadata#robots\"><code>robots</code></a> that are defined in an earlier segment are <strong>overwritten</strong> by the last segment to define them.</p> <h4 id=\"overwriting-fields\" data-docs-heading=\"\">Overwriting fields     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'Acme',\n  openGraph: {\n    title: 'Acme',\n    description: 'Acme is a...',\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'Blog',\n  openGraph: {\n    title: 'Blog',\n  },\n}\n \n// Output:\n// &lt;title&gt;Blog&lt;/title&gt;\n// &lt;meta property=\"og:title\" content=\"Blog\" /&gt;</pre></div> <p>In the example above:</p> <ul> <li>\n<code>title</code> from <code>app/layout.js</code> is <strong>replaced</strong> by <code>title</code> in <code>app/blog/page.js</code>.</li> <li>All <code>openGraph</code> fields from <code>app/layout.js</code> are <strong>replaced</strong> in <code>app/blog/page.js</code> because <code>app/blog/page.js</code> sets <code>openGraph</code> metadata. Note the absence of <code>openGraph.description</code>.</li> </ul> <p>If you'd like to share some nested fields between segments while overwriting others, you can pull them out into a separate variable:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const openGraphImage = { images: ['http://...'] }</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { openGraphImage } from './shared-metadata'\n \nexport const metadata = {\n  openGraph: {\n    ...openGraphImage,\n    title: 'Home',\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { openGraphImage } from '../shared-metadata'\n \nexport const metadata = {\n  openGraph: {\n    ...openGraphImage,\n    title: 'About',\n  },\n}</pre></div> <p>In the example above, the OG image is shared between <code>app/layout.js</code> and <code>app/about/page.js</code> while the titles are different.</p> <h4 id=\"inheriting-fields\" data-docs-heading=\"\">Inheriting fields     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'Acme',\n  openGraph: {\n    title: 'Acme',\n    description: 'Acme is a...',\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'About',\n}\n \n// Output:\n// &lt;title&gt;About&lt;/title&gt;\n// &lt;meta property=\"og:title\" content=\"Acme\" /&gt;\n// &lt;meta property=\"og:description\" content=\"Acme is a...\" /&gt;</pre></div> <p><strong>Notes</strong></p> <ul> <li>\n<code>title</code> from <code>app/layout.js</code> is <strong>replaced</strong> by <code>title</code> in <code>app/about/page.js</code>.</li> <li>All <code>openGraph</code> fields from <code>app/layout.js</code> are <strong>inherited</strong> in <code>app/about/page.js</code> because <code>app/about/page.js</code> doesn't set <code>openGraph</code> metadata.</li> </ul> <h2 id=\"dynamic-image-generation\" data-docs-heading=\"\">Dynamic Image Generation     </h2> <p>The <code>ImageResponse</code> constructor allows you to generate dynamic images using JSX and CSS. This is useful for creating social media images such as Open Graph images, Twitter cards, and more.</p> <p><code>ImageResponse</code> uses the <a href=\"../rendering/edge-and-nodejs-runtimes#edge-runtime\">Edge Runtime</a>, and Next.js automatically adds the correct headers to cached images at the edge, helping improve performance and reducing recomputation.</p> <p>To use it, you can import <code>ImageResponse</code> from <code>next/og</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'\n \nexport const runtime = 'edge'\n \nexport async function GET() {\n  return new ImageResponse(\n    (\n      &lt;div\n        style={{\n          fontSize: 128,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          textAlign: 'center',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      &gt;\n        Hello world!\n      &lt;/div&gt;\n    ),\n    {\n      width: 1200,\n      height: 600,\n    }\n  )\n}</pre></div> <p><code>ImageResponse</code> integrates well with other Next.js APIs, including <a href=\"../routing/route-handlers\">Route Handlers</a> and file-based Metadata. For example, you can use <code>ImageResponse</code> in a <code>opengraph-image.tsx</code> file to generate Open Graph images at build time or dynamically at request time.</p> <p><code>ImageResponse</code> supports common CSS properties including flexbox and absolute positioning, custom fonts, text wrapping, centering, and nested images. <a href=\"../../api-reference/functions/image-response\">See the full list of supported CSS properties</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Examples are available in the <a href=\"https://og-playground.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Vercel OG Playground</a>.</li> <li>\n<code>ImageResponse</code> uses <a href=\"https://vercel.com/docs/concepts/functions/edge-functions/og-image-generation\" rel=\"noopener noreferrer\" target=\"_blank\">@vercel/og</a>, <a href=\"https://github.com/vercel/satori\" rel=\"noopener noreferrer\" target=\"_blank\">Satori</a>, and Resvg to convert HTML and CSS into PNG.</li> <li>Only the Edge Runtime is supported. The default Node.js runtime will not work.</li> <li>Only flexbox and a subset of CSS properties are supported. Advanced layouts (e.g. <code>display: grid</code>) will not work.</li> <li>Maximum bundle size of <code>500KB</code>. The bundle size includes your JSX, CSS, fonts, images, and any other assets. If you exceed the limit, consider reducing the size of any assets or fetching at runtime.</li> <li>Only <code>ttf</code>, <code>otf</code>, and <code>woff</code> font formats are supported. To maximize the font parsing speed, <code>ttf</code> or <code>otf</code> are preferred over <code>woff</code>.</li> </ul> </blockquote> <h2 id=\"json-ld\" data-docs-heading=\"\">JSON-LD     </h2> <p><a href=\"https://json-ld.org/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">JSON-LD</a> is a format for structured data that can be used by search engines to understand your content. For example, you can use it to describe a person, an event, an organization, a movie, a book, a recipe, and many other types of entities.</p> <p>Our current recommendation for JSON-LD is to render structured data as a <code>&lt;script&gt;</code> tag in your <code>layout.js</code> or <code>page.js</code> components. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function Page({ params }) {\n  const product = await getProduct(params.id)\n \n  const jsonLd = {\n    '@context': 'https://schema.org',\n    '@type': 'Product',\n    name: product.name,\n    image: product.image,\n    description: product.description,\n  }\n \n  return (\n    &lt;section&gt;\n      {/* Add JSON-LD to your page */}\n      &lt;script\n        type=\"application/ld+json\"\n        dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}\n      /&gt;\n      {/* ... */}\n    &lt;/section&gt;\n  )\n}</pre></div>  <p>You can validate and test your structured data with the <a href=\"https://search.google.com/test/rich-results\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Rich Results Test</a> for Google or the generic <a href=\"https://validator.schema.org/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Schema Markup Validator</a>.</p> <p>You can type your JSON-LD with TypeScript using community packages like <a href=\"https://www.npmjs.com/package/schema-dts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>schema-dts</code></a>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Product, WithContext } from 'schema-dts'\n \nconst jsonLd: WithContext&lt;Product&gt; = {\n  '@context': 'https://schema.org',\n  '@type': 'Product',\n  name: 'Next.js Sticker',\n  image: 'https://nextjs.org/imgs/sticker.png',\n  description: 'Dynamic at the speed of static.',\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/metadata\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/metadata</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/scripts":"<h1 class=\"break-words\">Script Optimization</h1> <h3 id=\"layout-scripts\" data-docs-heading=\"\">Layout Scripts     </h3>\n<p>To load a third-party script for multiple routes, import <code>next/script</code> and include the script directly in your layout component:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;&gt;\n      &lt;section&gt;{children}&lt;/section&gt;\n      &lt;Script src=\"https://example.com/script.js\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>\n<p>The third-party script is fetched when the folder route (e.g. <code>dashboard/page.js</code>) or any nested route (e.g. <code>dashboard/settings/page.js</code>) is accessed by the user. Next.js will ensure the script will <strong>only load once</strong>, even if a user navigates between multiple routes in the same layout.</p> <h3 id=\"application-scripts\" data-docs-heading=\"\">Application Scripts     </h3> <p>To load a third-party script for all routes, import <code>next/script</code> and include the script directly in your root layout:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n      &lt;Script src=\"https://example.com/script.js\" /&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>This script will load and execute when <em>any</em> route in your application is accessed. Next.js will ensure the script will <strong>only load once</strong>, even if a user navigates between multiple pages.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: We recommend only including third-party scripts in specific pages or layouts in order to minimize any unnecessary impact to performance.</p> </blockquote> <h3 id=\"strategy\" data-docs-heading=\"\">Strategy     </h3> <p>Although the default behavior of <code>next/script</code> allows you to load third-party scripts in any page or layout, you can fine-tune its loading behavior by using the <code>strategy</code> property:</p> <ul> <li>\n<code>beforeInteractive</code>: Load the script before any Next.js code and before any page hydration occurs.</li> <li>\n<code>afterInteractive</code>: (<strong>default</strong>) Load the script early but after some hydration on the page occurs.</li> <li>\n<code>lazyOnload</code>: Load the script later during browser idle time.</li> <li>\n<code>worker</code>: (experimental) Load the script in a web worker.</li> </ul> <p>Refer to the <a href=\"../../api-reference/components/script#strategy\"><code>next/script</code></a> API reference documentation to learn more about each strategy and their use cases.</p> <h3 id=\"offloading-scripts-to-a-web-worker-experimental\" data-docs-heading=\"\">Offloading Scripts To A Web Worker (Experimental)     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> The <code>worker</code> strategy is not yet stable and does not yet work with the <a href=\"../routing/defining-routes\"><code>app</code></a> directory. Use with caution.</p> </blockquote> <p>Scripts that use the <code>worker</code> strategy are offloaded and executed in a web worker with <a href=\"https://partytown.builder.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Partytown</a>. This can improve the performance of your site by dedicating the main thread to the rest of your application code.</p> <p>This strategy is still experimental and can only be used if the <code>nextScriptWorkers</code> flag is enabled in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    nextScriptWorkers: true,\n  },\n}</pre></div> <p>Then, run <code>next</code> (normally <code>npm run dev</code> or <code>yarn dev</code>) and Next.js will guide you through the installation of the required packages to finish the setup:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm run dev</pre></div> <p>You'll see instructions like these: Please install Partytown by running <code>npm install @builder.io/partytown</code></p> <p>Once setup is complete, defining <code>strategy=\"worker\"</code> will automatically instantiate Partytown in your application and offload the script to a web worker.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Home() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" strategy=\"worker\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>There are a number of trade-offs that need to be considered when loading a third-party script in a web worker. Please see Partytown's <a href=\"https://partytown.builder.io/trade-offs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">tradeoffs</a> documentation for more information.</p> <h3 id=\"inline-scripts\" data-docs-heading=\"\">Inline Scripts     </h3> <p>Inline scripts, or scripts not loaded from an external file, are also supported by the Script component. They can be written by placing the JavaScript within curly braces:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Script id=\"show-banner\"&gt;\n  {`document.getElementById('banner').classList.remove('hidden')`}\n&lt;/Script&gt;</pre>\n</div> <p>Or by using the <code>dangerouslySetInnerHTML</code> property:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Script\n  id=\"show-banner\"\n  dangerouslySetInnerHTML={{\n    __html: `document.getElementById('banner').classList.remove('hidden')`,\n  }}\n/&gt;</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: An <code>id</code> property must be assigned for inline scripts in order for Next.js to track and optimize the script.</p> </blockquote> <h3 id=\"executing-additional-code\" data-docs-heading=\"\">Executing Additional Code     </h3> <p>Event handlers can be used with the Script component to execute additional code after a certain event occurs:</p> <ul> <li>\n<code>onLoad</code>: Execute code after the script has finished loading.</li> <li>\n<code>onReady</code>: Execute code after the script has finished loading and every time the component is mounted.</li> <li>\n<code>onError</code>: Execute code if the script fails to load.</li> </ul> <p>These handlers will only work when <code>next/script</code> is imported and used inside of a <a href=\"../rendering/client-components\">Client Component</a> where <code>\"use client\"</code> is defined as the first line of code:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script\n        src=\"https://example.com/script.js\"\n        onLoad={() =&gt; {\n          console.log('Script has loaded')\n        }}\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>\n<p>Refer to the <a href=\"../../api-reference/components/script#onload\"><code>next/script</code></a> API reference to learn more about each event handler and view examples.</p>  <h3 id=\"additional-attributes\" data-docs-heading=\"\">Additional Attributes     </h3> <p>There are many DOM attributes that can be assigned to a <code>&lt;script&gt;</code> element that are not used by the Script component, like <a href=\"https://developer.mozilla.org/docs/Web/HTML/Global_attributes/nonce\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>nonce</code></a> or <a href=\"https://developer.mozilla.org/docs/Web/HTML/Global_attributes/data-*\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">custom data attributes</a>. Including any additional attributes will automatically forward it to the final, optimized <code>&lt;script&gt;</code> element that is included in the HTML.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script\n        src=\"https://example.com/script.js\"\n        id=\"example-script\"\n        nonce=\"XUENAJFW\"\n        data-test=\"script\"\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/scripts\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/scripts</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/lazy-loading":"<h1 class=\"break-words\">Lazy Loading</h1> <p><a href=\"https://developer.mozilla.org/docs/Web/Performance/Lazy_loading\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Lazy loading</a> in Next.js helps improve the initial loading performance of an application by decreasing the amount of JavaScript needed to render a route.</p> <p>It allows you to defer loading of <strong>Client Components</strong> and imported libraries, and only include them in the client bundle when they're needed. For example, you might want to defer loading a modal until a user clicks to open it.</p> <p>There are two ways you can implement lazy loading in Next.js:</p> <ol> <li>Using <a href=\"#nextdynamic\">Dynamic Imports</a> with <code>next/dynamic</code>\n</li> <li>Using <a href=\"https://react.dev/reference/react/lazy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>React.lazy()</code></a> with <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Suspense</a>\n</li> </ol> <p>By default, Server Components are automatically <a href=\"https://developer.mozilla.org/docs/Glossary/Code_splitting\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">code split</a>, and you can use <a href=\"../routing/loading-ui-and-streaming\">streaming</a> to progressively send pieces of UI from the server to the client. Lazy loading applies to Client Components.</p> <h2 id=\"nextdynamic\" data-docs-heading=\"\">next/dynamic     </h2> <p><code>next/dynamic</code> is a composite of <a href=\"https://react.dev/reference/react/lazy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>React.lazy()</code></a> and <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Suspense</a>. It behaves the same way in the <code>app</code> and <code>pages</code> directories to allow for incremental migration.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"importing-client-components\" data-docs-heading=\"\">Importing Client Components     </h3>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useState } from 'react'\nimport dynamic from 'next/dynamic'\n \n// Client Components:\nconst ComponentA = dynamic(() =&gt; import('../components/A'))\nconst ComponentB = dynamic(() =&gt; import('../components/B'))\nconst ComponentC = dynamic(() =&gt; import('../components/C'), { ssr: false })\n \nexport default function ClientComponentExample() {\n  const [showMore, setShowMore] = useState(false)\n \n  return (\n    &lt;div&gt;\n      {/* Load immediately, but in a separate client bundle */}\n      &lt;ComponentA /&gt;\n \n      {/* Load on demand, only when/if the condition is met */}\n      {showMore &amp;&amp; &lt;ComponentB /&gt;}\n      &lt;button onClick={() =&gt; setShowMore(!showMore)}&gt;Toggle&lt;/button&gt;\n \n      {/* Load only on the client side */}\n      &lt;ComponentC /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<h3 id=\"skipping-ssr\" data-docs-heading=\"\">Skipping SSR     </h3>\n<p>When using <code>React.lazy()</code> and Suspense, Client Components will be pre-rendered (SSR) by default.</p>\n<p>If you want to disable pre-rendering for a Client Component, you can use the <code>ssr</code> option set to <code>false</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const ComponentC = dynamic(() =&gt; import('../components/C'), { ssr: false })</pre>\n</div>\n<h3 id=\"importing-server-components\" data-docs-heading=\"\">Importing Server Components     </h3>\n<p>If you dynamically import a Server Component, only the Client Components that are children of the Server Component will be lazy-loaded - not the Server Component itself.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \n// Server Component:\nconst ServerComponent = dynamic(() =&gt; import('../components/ServerComponent'))\n \nexport default function ServerComponentExample() {\n  return (\n    &lt;div&gt;\n      &lt;ServerComponent /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<h3 id=\"loading-external-libraries\" data-docs-heading=\"\">Loading External Libraries     </h3>\n<p>External libraries can be loaded on demand using the <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/import\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>import()</code></a> function. This example uses the external library <code>fuse.js</code> for fuzzy search. The module is only loaded on the client after the user types in the search input.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useState } from 'react'\n \nconst names = ['Tim', 'Joe', 'Bel', 'Lee']\n \nexport default function Page() {\n  const [results, setResults] = useState()\n \n  return (\n    &lt;div&gt;\n      &lt;input\n        type=\"text\"\n        placeholder=\"Search\"\n        onChange={async (e) =&gt; {\n          const { value } = e.currentTarget\n          // Dynamically load fuse.js\n          const Fuse = (await import('fuse.js')).default\n          const fuse = new Fuse(names)\n \n          setResults(fuse.search(value))\n        }}\n      /&gt;\n      &lt;pre&gt;Results: {JSON.stringify(results, null, 2)}&lt;/pre&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<h3 id=\"adding-a-custom-loading-component\" data-docs-heading=\"\">Adding a custom loading component     </h3>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst WithCustomLoading = dynamic(\n  () =&gt; import('../components/WithCustomLoading'),\n  {\n    loading: () =&gt; &lt;p&gt;Loading...&lt;/p&gt;,\n  }\n)\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      {/* The loading component will be rendered while  &lt;WithCustomLoading/&gt; is loading */}\n      &lt;WithCustomLoading /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<h3 id=\"importing-named-exports\" data-docs-heading=\"\">Importing Named Exports     </h3>\n<p>To dynamically import a named export, you can return it from the Promise returned by <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/import\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>import()</code></a> function:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nexport function Hello() {\n  return &lt;p&gt;Hello!&lt;/p&gt;\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst ClientComponent = dynamic(() =&gt;\n  import('../components/hello').then((mod) =&gt; mod.Hello)\n)</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/lazy-loading\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/lazy-loading</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/analytics":"<h1 class=\"break-words\">Analytics</h1> <p>Next.js has built-in support for measuring and reporting performance metrics. You can either use the <code>useReportWebVitals</code> hook to manage reporting yourself, or alternatively, Vercel provides a <a href=\"https://vercel.com/analytics?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">managed service</a> to automatically collect and visualize metrics for you.</p> <h2 id=\"build-your-own\" data-docs-heading=\"\">Build Your Own     </h2>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useReportWebVitals } from 'next/web-vitals'\n \nexport function WebVitals() {\n  useReportWebVitals((metric) =&gt; {\n    console.log(metric)\n  })\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { WebVitals } from './_components/web-vitals'\n \nexport default function Layout({ children }) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;WebVitals /&gt;\n        {children}\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>\n<blockquote class=\"p-3 text-sm\"> <p>Since the <code>useReportWebVitals</code> hook requires the <code>\"use client\"</code> directive, the most performant approach is to create a separate component that the root layout imports. This confines the client boundary exclusively to the <code>WebVitals</code> component.</p> </blockquote>\n<p>View the <a href=\"../../api-reference/functions/use-report-web-vitals\">API Reference</a> for more information.</p> <h2 id=\"web-vitals\" data-docs-heading=\"\">Web Vitals     </h2> <p><a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Vitals</a> are a set of useful metrics that aim to capture the user experience of a web page. The following web vitals are all included:</p> <ul> <li>\n<a href=\"https://developer.mozilla.org/docs/Glossary/Time_to_first_byte\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Time to First Byte</a> (TTFB)</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Glossary/First_contentful_paint\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Contentful Paint</a> (FCP)</li> <li>\n<a href=\"https://web.dev/lcp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Largest Contentful Paint</a> (LCP)</li> <li>\n<a href=\"https://web.dev/fid/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Input Delay</a> (FID)</li> <li>\n<a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a> (CLS)</li> <li>\n<a href=\"https://web.dev/inp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Interaction to Next Paint</a> (INP)</li> </ul> <p>You can handle all the results of these metrics using the <code>name</code> property.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useReportWebVitals } from 'next/web-vitals'\n \nexport function WebVitals() {\n  useReportWebVitals((metric) =&gt; {\n    switch (metric.name) {\n      case 'FCP': {\n        // handle FCP results\n      }\n      case 'LCP': {\n        // handle LCP results\n      }\n      // ...\n    }\n  })\n}</pre></div>  <h2 id=\"sending-results-to-external-systems\" data-docs-heading=\"\">Sending results to external systems     </h2> <p>You can send results to any endpoint to measure and track real user performance on your site. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useReportWebVitals((metric) =&gt; {\n  const body = JSON.stringify(metric)\n  const url = 'https://example.com/analytics'\n \n  // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.\n  if (navigator.sendBeacon) {\n    navigator.sendBeacon(url, body)\n  } else {\n    fetch(url, { body, method: 'POST', keepalive: true })\n  }\n})</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you use <a href=\"https://analytics.google.com/analytics/web/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Analytics</a>, using the <code>id</code> value can allow you to construct metric distributions manually (to calculate percentiles, etc.)</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useReportWebVitals((metric) =&gt; {\n  // Use `window.gtag` if you initialized Google Analytics as this example:\n  // https://github.com/vercel/next.js/blob/canary/examples/with-google-analytics/pages/_app.js\n  window.gtag('event', metric.name, {\n    value: Math.round(\n      metric.name === 'CLS' ? metric.value * 1000 : metric.value\n    ), // values must be integers\n    event_label: metric.id, // id unique to current page load\n    non_interaction: true, // avoids affecting bounce rate.\n  })\n})</pre>\n</div> <p>Read more about <a href=\"https://github.com/GoogleChrome/web-vitals#send-the-results-to-google-analytics\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">sending results to Google Analytics</a>.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/analytics\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/analytics</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/instrumentation":"<h1 class=\"break-words\">Instrumentation</h1> <p>Instrumentation is the process of using code to integrate monitoring and logging tools into your application. This allows you to track the performance and behavior of your application, and to debug issues in production.</p> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>To set up instrumentation, create <code>instrumentation.ts|js</code> file in the <strong>root directory</strong> of your project (or inside the <a href=\"../configuring/src-directory\"><code>src</code></a> folder if using one).</p> <p>Then, export a <code>register</code> function in the file. This function will be called <strong>once</strong> when a new Next.js server instance is initiated.</p> <p>For example, to use Next.js with <a href=\"https://opentelemetry.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">OpenTelemetry</a> and <a href=\"https://vercel.com/docs/observability/otel-overview\" rel=\"noopener noreferrer\" target=\"_blank\">@vercel/otel</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { registerOTel } from '@vercel/otel'\n \nexport function register() {\n  registerOTel('next-app')\n}</pre></div>  <p>See the <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-opentelemetry\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with OpenTelemetry example</a> for a complete implementation.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>This feature is <strong>experimental</strong>. To use it, you must explicitly opt in by defining <a href=\"../../api-reference/next-config-js/instrumentationhook\"><code>experimental.instrumentationHook = true;</code></a> in your <code>next.config.js</code>.</li> <li>The <code>instrumentation</code> file should be in the root of your project and not inside the <code>app</code> or <code>pages</code> directory. If you're using the <code>src</code> folder, then place the file inside <code>src</code> alongside <code>pages</code> and <code>app</code>.</li> <li>If you use the <a href=\"../../api-reference/next-config-js/pageextensions\"><code>pageExtensions</code> config option</a> to add a suffix, you will also need to update the <code>instrumentation</code> filename to match.</li> </ul> </blockquote> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"importing-files-with-side-effects\" data-docs-heading=\"\">Importing files with side effects     </h3> <p>Sometimes, it may be useful to import a file in your code because of the side effects it will cause. For example, you might import a file that defines a set of global variables, but never explicitly use the imported file in your code. You would still have access to the global variables the package has declared.</p> <p>We recommend importing files using JavaScript <code>import</code> syntax within your <code>register</code> function. The following example demonstrates a basic usage of <code>import</code> in a <code>register</code> function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function register() {\n  await import('package-with-side-effect')\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <p>We recommend importing the file from within the <code>register</code> function, rather than at the top of the file. By doing this, you can colocate all of your side effects in one place in your code, and avoid any unintended consequences from importing globally at the top of the file.</p> </blockquote> <h3 id=\"importing-runtime-specific-code\" data-docs-heading=\"\">Importing runtime-specific code     </h3> <p>Next.js calls <code>register</code> in all environments, so it's important to conditionally import any code that doesn't support specific runtimes (e.g. <a href=\"../rendering/edge-and-nodejs-runtimes#edge-runtime\">Edge</a> or <a href=\"../rendering/edge-and-nodejs-runtimes#nodejs-runtime\">Node.js</a>). You can use the <code>NEXT_RUNTIME</code> environment variable to get the current environment:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation-node')\n  }\n \n  if (process.env.NEXT_RUNTIME === 'edge') {\n    await import('./instrumentation-edge')\n  }\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/instrumentation\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/instrumentation</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/open-telemetry":"<h1 class=\"break-words\">OpenTelemetry</h1> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This feature is <strong>experimental</strong>, you need to explicitly opt-in by providing <code>experimental.instrumentationHook = true;</code> in your <code>next.config.js</code>.</p> </blockquote> <p>Observability is crucial for understanding and optimizing the behavior and performance of your Next.js app.</p> <p>As applications become more complex, it becomes increasingly difficult to identify and diagnose issues that may arise. By leveraging observability tools, such as logging and metrics, developers can gain insights into their application's behavior and identify areas for optimization. With observability, developers can proactively address issues before they become major problems and provide a better user experience. Therefore, it is highly recommended to use observability in your Next.js applications to improve performance, optimize resources, and enhance user experience.</p> <p>We recommend using OpenTelemetry for instrumenting your apps. It's a platform-agnostic way to instrument apps that allows you to change your observability provider without changing your code. Read <a href=\"https://opentelemetry.io/docs/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Official OpenTelemetry docs</a> for more information about OpenTelemetry and how it works.</p> <p>This documentation uses terms like <em>Span</em>, <em>Trace</em> or <em>Exporter</em> throughout this doc, all of which can be found in <a href=\"https://opentelemetry.io/docs/concepts/observability-primer/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">the OpenTelemetry Observability Primer</a>.</p> <p>Next.js supports OpenTelemetry instrumentation out of the box, which means that we already instrumented Next.js itself. When you enable OpenTelemetry we will automatically wrap all your code like <code>getStaticProps</code> in <em>spans</em> with helpful attributes.</p> <h2 id=\"getting-started\" data-docs-heading=\"\">Getting Started     </h2> <p>OpenTelemetry is extensible but setting it up properly can be quite verbose. That's why we prepared a package <code>@vercel/otel</code> that helps you get started quickly.</p> <h3 id=\"using-vercelotel\" data-docs-heading=\"\">Using @vercel/otel     </h3> <p>To get started, you must install <code>@vercel/otel</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @vercel/otel</pre></div> <p>Next, create a custom <a href=\"instrumentation\"><code>instrumentation.ts</code></a> (or <code>.js</code>) file in the <strong>root directory</strong> of the project (or inside <code>src</code> folder if using one):</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { registerOTel } from '@vercel/otel'\n \nexport function register() {\n  registerOTel({ serviceName: 'next-app' })\n}</pre></div>  <p>See the <a href=\"https://www.npmjs.com/package/@vercel/otel\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@vercel/otel</code> documentation</a> for additional configuration options.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>The <code>instrumentation</code> file should be in the root of your project and not inside the <code>app</code> or <code>pages</code> directory. If you're using the <code>src</code> folder, then place the file inside <code>src</code> alongside <code>pages</code> and <code>app</code>.</li> <li>If you use the <a href=\"../../api-reference/next-config-js/pageextensions\"><code>pageExtensions</code> config option</a> to add a suffix, you will also need to update the <code>instrumentation</code> filename to match.</li> <li>We have created a basic <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-opentelemetry\" rel=\"noopener noreferrer\" target=\"_blank\">with-opentelemetry</a> example that you can use.</li> </ul> </blockquote>  <h3 id=\"manual-opentelemetry-configuration\" data-docs-heading=\"\">Manual OpenTelemetry configuration     </h3> <p>The <code>@vercel/otel</code> package provides many configuration options and should serve most of common use cases. But if it doesn't suit your needs, you can configure OpenTelemetry manually.</p> <p>Firstly you need to install OpenTelemetry packages:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @opentelemetry/sdk-node @opentelemetry/resources @opentelemetry/semantic-conventions @opentelemetry/sdk-trace-node @opentelemetry/exporter-trace-otlp-http</pre></div> <p>Now you can initialize <code>NodeSDK</code> in your <code>instrumentation.ts</code>. Unlike <code>@vercel/otel</code>, <code>NodeSDK</code> is not compatible with edge runtime, so you need to make sure that you are importing them only when <code>process.env.NEXT_RUNTIME === 'nodejs'</code>. We recommend creating a new file <code>instrumentation.node.ts</code> which you conditionally import only when using node:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation.node.ts')\n  }\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NodeSDK } from '@opentelemetry/sdk-node'\nimport { OTLPTraceExporter } from '@opentelemetry/exporter-trace-otlp-http'\nimport { Resource } from '@opentelemetry/resources'\nimport { SEMRESATTRS_SERVICE_NAME } from '@opentelemetry/semantic-conventions'\nimport { SimpleSpanProcessor } from '@opentelemetry/sdk-trace-node'\n \nconst sdk = new NodeSDK({\n  resource: new Resource({\n    [SEMRESATTRS_SERVICE_NAME]: 'next-app',\n  }),\n  spanProcessor: new SimpleSpanProcessor(new OTLPTraceExporter()),\n})\nsdk.start()</pre></div>  <p>Doing this is equivalent to using <code>@vercel/otel</code>, but it's possible to modify and extend some features that are not exposed by the <code>@vercel/otel</code>. If edge runtime support is necessary, you will have to use <code>@vercel/otel</code>.</p> <h2 id=\"testing-your-instrumentation\" data-docs-heading=\"\">Testing your instrumentation     </h2> <p>You need an OpenTelemetry collector with a compatible backend to test OpenTelemetry traces locally. We recommend using our <a href=\"https://github.com/vercel/opentelemetry-collector-dev-setup\" rel=\"noopener noreferrer\" target=\"_blank\">OpenTelemetry dev environment</a>.</p> <p>If everything works well you should be able to see the root server span labeled as <code>GET /requested/pathname</code>. All other spans from that particular trace will be nested under it.</p> <p>Next.js traces more spans than are emitted by default. To see more spans, you must set <code>NEXT_OTEL_VERBOSE=1</code>.</p> <h2 id=\"deployment\" data-docs-heading=\"\">Deployment     </h2> <h3 id=\"using-opentelemetry-collector\" data-docs-heading=\"\">Using OpenTelemetry Collector     </h3> <p>When you are deploying with OpenTelemetry Collector, you can use <code>@vercel/otel</code>. It will work both on Vercel and when self-hosted.</p> <h4 id=\"deploying-on-vercel\" data-docs-heading=\"\">Deploying on Vercel     </h4> <p>We made sure that OpenTelemetry works out of the box on Vercel.</p> <p>Follow <a href=\"https://vercel.com/docs/concepts/observability/otel-overview/quickstart\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel documentation</a> to connect your project to an observability provider.</p> <h4 id=\"self-hosting\" data-docs-heading=\"\">Self-hosting     </h4> <p>Deploying to other platforms is also straightforward. You will need to spin up your own OpenTelemetry Collector to receive and process the telemetry data from your Next.js app.</p> <p>To do this, follow the <a href=\"https://opentelemetry.io/docs/collector/getting-started/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">OpenTelemetry Collector Getting Started guide</a>, which will walk you through setting up the collector and configuring it to receive data from your Next.js app.</p> <p>Once you have your collector up and running, you can deploy your Next.js app to your chosen platform following their respective deployment guides.</p> <h3 id=\"custom-exporters\" data-docs-heading=\"\">Custom Exporters     </h3> <p>OpenTelemetry Collector is not necessary. You can use a custom OpenTelemetry exporter with <a href=\"#using-vercelotel\"><code>@vercel/otel</code></a> or <a href=\"../../../pages/building-your-application/optimizing/open-telemetry#manual-opentelemetry-configuration\">manual OpenTelemetry configuration</a>.</p> <h2 id=\"custom-spans\" data-docs-heading=\"\">Custom Spans     </h2> <p>You can add a custom span with <a href=\"https://opentelemetry.io/docs/instrumentation/js/instrumentation\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">OpenTelemetry APIs</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @opentelemetry/api</pre></div> <p>The following example demonstrates a function that fetches GitHub stars and adds a custom <code>fetchGithubStars</code> span to track the fetch request's result:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { trace } from '@opentelemetry/api'\n \nexport async function fetchGithubStars() {\n  return await trace\n    .getTracer('nextjs-example')\n    .startActiveSpan('fetchGithubStars', async (span) =&gt; {\n      try {\n        return await getValue()\n      } finally {\n        span.end()\n      }\n    })\n}</pre>\n</div> <p>The <code>register</code> function will execute before your code runs in a new environment. You can start creating new spans, and they should be correctly added to the exported trace.</p> <h2 id=\"default-spans-in-nextjs\" data-docs-heading=\"\">Default Spans in Next.js     </h2> <p>Next.js automatically instruments several spans for you to provide useful insights into your application's performance.</p> <p>Attributes on spans follow <a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">OpenTelemetry semantic conventions</a>. We also add some custom attributes under the <code>next</code> namespace:</p> <ul> <li>\n<code>next.span_name</code> - duplicates span name</li> <li>\n<code>next.span_type</code> - each span type has a unique identifier</li> <li>\n<code>next.route</code> - The route pattern of the request (e.g., <code>/[param]/user</code>).</li> <li>\n<code>next.rsc</code> (true/false) - Whether the request is an RSC request, such as prefetch.</li> <li>\n<code>next.page</code> <ul> <li>This is an internal value used by an app router.</li> <li>You can think about it as a route to a special file (like <code>page.ts</code>, <code>layout.ts</code>, <code>loading.ts</code> and others)</li> <li>It can be used as a unique identifier only when paired with <code>next.route</code> because <code>/layout</code> can be used to identify both <code>/(groupA)/layout.ts</code> and <code>/(groupB)/layout.ts</code>\n</li> </ul> </li> </ul> <h3 id=\"httpmethod-nextroute\" data-docs-heading=\"\">[http.method] [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>BaseServer.handleRequest</code>\n</li> </ul> <p>This span represents the root span for each incoming request to your Next.js application. It tracks the HTTP method, route, target, and status code of the request.</p> <p>Attributes:</p> <ul> <li>\n<a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#common-attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Common HTTP attributes</a> <ul> <li><code>http.method</code></li> <li><code>http.status_code</code></li> </ul> </li> <li>\n<a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#http-server-semantic-conventions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Server HTTP attributes</a> <ul> <li><code>http.route</code></li> <li><code>http.target</code></li> </ul> </li> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"render-route-app-nextroute\" data-docs-heading=\"\">render route (app) [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>AppRender.getBodyResult</code>.</li> </ul> <p>This span represents the process of rendering a route in the app router.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"fetch-httpmethod-httpurl\" data-docs-heading=\"\">fetch [http.method] [http.url]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>AppRender.fetch</code>\n</li> </ul> <p>This span represents the fetch request executed in your code.</p> <p>Attributes:</p> <ul> <li>\n<a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#common-attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Common HTTP attributes</a> <ul> <li><code>http.method</code></li> </ul> </li> <li>\n<a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#http-client\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Client HTTP attributes</a> <ul> <li><code>http.url</code></li> <li><code>net.peer.name</code></li> <li>\n<code>net.peer.port</code> (only if specified)</li> </ul> </li> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> </ul> <p>This span can be turned off by setting <code>NEXT_OTEL_FETCH_DISABLED=1</code> in your environment. This is useful when you want to use a custom fetch instrumentation library.</p> <h3 id=\"executing-api-route-app-nextroute\" data-docs-heading=\"\">executing api route (app) [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>AppRouteRouteHandlers.runHandler</code>.</li> </ul> <p>This span represents the execution of an API route handler in the app router.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"getserversideprops-nextroute\" data-docs-heading=\"\">getServerSideProps [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>Render.getServerSideProps</code>.</li> </ul> <p>This span represents the execution of <code>getServerSideProps</code> for a specific route.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"getstaticprops-nextroute\" data-docs-heading=\"\">getStaticProps [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>Render.getStaticProps</code>.</li> </ul> <p>This span represents the execution of <code>getStaticProps</code> for a specific route.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"render-route-pages-nextroute\" data-docs-heading=\"\">render route (pages) [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>Render.renderDocument</code>.</li> </ul> <p>This span represents the process of rendering the document for a specific route.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"generatemetadata-nextpage\" data-docs-heading=\"\">generateMetadata [next.page]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>ResolveMetadata.generateMetadata</code>.</li> </ul> <p>This span represents the process of generating metadata for a specific page (a single route can have multiple of these spans).</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.page</code></li> </ul> <h3 id=\"resolve-page-components\" data-docs-heading=\"\">resolve page components     </h3> <ul> <li>\n<code>next.span_type</code>: <code>NextNodeServer.findPageComponents</code>.</li> </ul> <p>This span represents the process of resolving page components for a specific page.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"resolve-segment-modules\" data-docs-heading=\"\">resolve segment modules     </h3> <ul> <li>\n<code>next.span_type</code>: <code>NextNodeServer.getLayoutOrPageModule</code>.</li> </ul> <p>This span represents loading of code modules for a layout or a page.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.segment</code></li> </ul> <h3 id=\"start-response\" data-docs-heading=\"\">start response     </h3> <ul> <li>\n<code>next.span_type</code>: <code>NextNodeServer.startResponse</code>.</li> </ul> <p>This zero-length span represents the time when the first byte has been sent in the response.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/open-telemetry\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/open-telemetry</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/static-assets":"<h1 class=\"break-words\">Static Assets in `public`</h1> <p>Next.js can serve static files, like images, under a folder called <code>public</code> in the root directory. Files inside <code>public</code> can then be referenced by your code starting from the base URL (<code>/</code>).</p> <p>For example, the file <code>public/avatars/me.png</code> can be viewed by visiting the <code>/avatars/me.png</code> path. The code to display that image might look like:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport function Avatar({ id, alt }) {\n  return &lt;Image src={`/avatars/${id}.png`} alt={alt} width=\"64\" height=\"64\" /&gt;\n}\n \nexport function AvatarOfMe() {\n  return &lt;Avatar id=\"me\" alt=\"A portrait of me\" /&gt;\n}</pre></div> <h2 id=\"caching\" data-docs-heading=\"\">Caching     </h2> <p>Next.js cannot safely cache assets in the <code>public</code> folder because they may change. The default caching headers applied are:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Cache-Control: public, max-age=0</pre>\n</div> <h2 id=\"robots-favicons-and-others\" data-docs-heading=\"\">Robots, Favicons, and others     </h2>  <p>For static metadata files, such as <code>robots.txt</code>, <code>favicon.ico</code>, etc, you should use <a href=\"../../api-reference/file-conventions/metadata\">special metadata files</a> inside the <code>app</code> folder.</p> <blockquote class=\"p-3 text-sm\"> <p>Good to know:</p> <ul> <li>The directory must be named <code>public</code>. The name cannot be changed and it's the only directory used to serve static assets.</li> <li>Only assets that are in the <code>public</code> directory at <a href=\"../../api-reference/next-cli#build\">build time</a> will be served by Next.js. Files added at request time won't be available. We recommend using a third-party service like <a href=\"https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Blob</a> for persistent file storage.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/static-assets\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/static-assets</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/third-party-libraries":"<h1 class=\"break-words\">Third Party Libraries</h1> <p><strong><code>@next/third-parties</code></strong> is a library that provides a collection of components and utilities that improve the performance and developer experience of loading popular third-party libraries in your Next.js application.</p> <p>All third-party integrations provided by <code>@next/third-parties</code> have been optimized for performance and ease of use.</p> <h2 id=\"getting-started\" data-docs-heading=\"\">Getting Started     </h2> <p>To get started, install the <code>@next/third-parties</code> library:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @next/third-parties@latest next@latest</pre></div>  <p><code>@next/third-parties</code> is currently an <strong>experimental</strong> library under active development. We recommend installing it with the <strong>latest</strong> or <strong>canary</strong> flags while we work on adding more third-party integrations.</p> <h2 id=\"google-third-parties\" data-docs-heading=\"\">Google Third-Parties     </h2> <p>All supported third-party libraries from Google can be imported from <code>@next/third-parties/google</code>.</p> <h3 id=\"google-tag-manager\" data-docs-heading=\"\">Google Tag Manager     </h3> <p>The <code>GoogleTagManager</code> component can be used to instantiate a <a href=\"https://developers.google.com/tag-platform/tag-manager\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Tag Manager</a> container to your page. By default, it fetches the original inline script after hydration occurs on the page.</p> <p>To load Google Tag Manager for all routes, include the component directly in your root layout and pass in your GTM container ID:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleTagManager } from '@next/third-parties/google'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;GoogleTagManager gtmId=\"GTM-XYZ\" /&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>To load Google Tag Manager for a single route, include the component in your page file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleTagManager } from '@next/third-parties/google'\n \nexport default function Page() {\n  return &lt;GoogleTagManager gtmId=\"GTM-XYZ\" /&gt;\n}</pre></div>  <h4 id=\"sending-events\" data-docs-heading=\"\">Sending Events     </h4> <p>The <code>sendGTMEvent</code> function can be used to track user interactions on your page by sending events using the <code>dataLayer</code> object. For this function to work, the <code>&lt;GoogleTagManager /&gt;</code> component must be included in either a parent layout, page, or component, or directly in the same file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { sendGTMEvent } from '@next/third-parties/google'\n \nexport function EventButton() {\n  return (\n    &lt;div&gt;\n      &lt;button\n        onClick={() =&gt; sendGTMEvent({ event: 'buttonClicked', value: 'xyz' })}\n      &gt;\n        Send Event\n      &lt;/button&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>Refer to the Tag Manager <a href=\"https://developers.google.com/tag-platform/tag-manager/datalayer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">developer documentation</a> to learn about the different variables and events that can be passed into the function.</p> <h4 id=\"options\" data-docs-heading=\"\">Options     </h4> <p>Options to pass to the Google Tag Manager. For a full list of options, read the <a href=\"https://developers.google.com/tag-platform/tag-manager/datalayer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Tag Manager docs</a>.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>gtmId</code></td>\n<td>Required</td>\n<td>Your GTM container ID. Usually starts with <code>GTM-</code>.</td>\n</tr>\n<tr>\n<td><code>dataLayer</code></td>\n<td>Optional</td>\n<td>Data layer array to instantiate the container with. Defaults to an empty array.</td>\n</tr>\n<tr>\n<td><code>dataLayerName</code></td>\n<td>Optional</td>\n<td>Name of the data layer. Defaults to <code>dataLayer</code>.</td>\n</tr>\n<tr>\n<td><code>auth</code></td>\n<td>Optional</td>\n<td>Value of authentication parameter (<code>gtm_auth</code>) for environment snippets.</td>\n</tr>\n<tr>\n<td><code>preview</code></td>\n<td>Optional</td>\n<td>Value of preview parameter (<code>gtm_preview</code>) for environment snippets.</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"google-analytics\" data-docs-heading=\"\">Google Analytics     </h3> <p>The <code>GoogleAnalytics</code> component can be used to include <a href=\"https://developers.google.com/analytics/devguides/collection/ga4\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Analytics 4</a> to your page via the Google tag (<code>gtag.js</code>). By default, it fetches the original scripts after hydration occurs on the page.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: If Google Tag Manager is already included in your application, you can configure Google Analytics directly using it, rather than including Google Analytics as a separate component. Refer to the <a href=\"https://developers.google.com/analytics/devguides/collection/ga4/tag-options#what-is-gtm\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">documentation</a> to learn more about the differences between Tag Manager and <code>gtag.js</code>.</p> </blockquote> <p>To load Google Analytics for all routes, include the component directly in your root layout and pass in your measurement ID:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleAnalytics } from '@next/third-parties/google'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n      &lt;GoogleAnalytics gaId=\"G-XYZ\" /&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>To load Google Analytics for a single route, include the component in your page file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleAnalytics } from '@next/third-parties/google'\n \nexport default function Page() {\n  return &lt;GoogleAnalytics gaId=\"G-XYZ\" /&gt;\n}</pre></div>  <h4 id=\"sending-events-1\" data-docs-heading=\"\">Sending Events     </h4> <p>The <code>sendGAEvent</code> function can be used to measure user interactions on your page by sending events using the <code>dataLayer</code> object. For this function to work, the <code>&lt;GoogleAnalytics /&gt;</code> component must be included in either a parent layout, page, or component, or directly in the same file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { sendGAEvent } from '@next/third-parties/google'\n \nexport function EventButton() {\n  return (\n    &lt;div&gt;\n      &lt;button\n        onClick={() =&gt; sendGAEvent({ event: 'buttonClicked', value: 'xyz' })}\n      &gt;\n        Send Event\n      &lt;/button&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>Refer to the Google Analytics <a href=\"https://developers.google.com/analytics/devguides/collection/ga4/event-parameters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">developer documentation</a> to learn more about event parameters.</p> <h4 id=\"tracking-pageviews\" data-docs-heading=\"\">Tracking Pageviews     </h4> <p>Google Analytics automatically tracks pageviews when the browser history state changes. This means that client-side navigations between Next.js routes will send pageview data without any configuration.</p> <p>To ensure that client-side navigations are being measured correctly, verify that the <a href=\"https://support.google.com/analytics/answer/9216061#enable_disable\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><em>Enhanced Measurement</em></a> property is enabled in your Admin panel and the <em>Page changes based on browser history events</em> checkbox is selected.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: If you decide to manually send pageview events, make sure to disable the default pageview measurement to avoid having duplicate data. Refer to the Google Analytics <a href=\"https://developers.google.com/analytics/devguides/collection/ga4/views?client_type=gtag#manual_pageviews\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">developer documentation</a> to learn more.</p> </blockquote> <h4 id=\"options-1\" data-docs-heading=\"\">Options     </h4> <p>Options to pass to the <code>&lt;GoogleAnalytics&gt;</code> component.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>gaId</code></td>\n<td>Required</td>\n<td>Your <a href=\"https://support.google.com/analytics/answer/12270356\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">measurement ID</a>. Usually starts with <code>G-</code>.</td>\n</tr>\n<tr>\n<td><code>dataLayerName</code></td>\n<td>Optional</td>\n<td>Name of the data layer. Defaults to <code>dataLayer</code>.</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"google-maps-embed\" data-docs-heading=\"\">Google Maps Embed     </h3> <p>The <code>GoogleMapsEmbed</code> component can be used to add a <a href=\"https://developers.google.com/maps/documentation/embed/embedding-map\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Maps Embed</a> to your page. By default, it uses the <code>loading</code> attribute to lazy-load the embed below the fold.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleMapsEmbed } from '@next/third-parties/google'\n \nexport default function Page() {\n  return (\n    &lt;GoogleMapsEmbed\n      apiKey=\"XYZ\"\n      height={200}\n      width=\"100%\"\n      mode=\"place\"\n      q=\"Brooklyn+Bridge,New+York,NY\"\n    /&gt;\n  )\n}</pre></div>  <h4 id=\"options-2\" data-docs-heading=\"\">Options     </h4> <p>Options to pass to the Google Maps Embed. For a full list of options, read the <a href=\"https://developers.google.com/maps/documentation/embed/embedding-map\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Map Embed docs</a>.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>apiKey</code></td>\n<td>Required</td>\n<td>Your api key.</td>\n</tr>\n<tr>\n<td><code>mode</code></td>\n<td>Required</td>\n<td><a href=\"https://developers.google.com/maps/documentation/embed/embedding-map#choosing_map_modes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Map mode</a></td>\n</tr>\n<tr>\n<td><code>height</code></td>\n<td>Optional</td>\n<td>Height of the embed. Defaults to <code>auto</code>.</td>\n</tr>\n<tr>\n<td><code>width</code></td>\n<td>Optional</td>\n<td>Width of the embed. Defaults to <code>auto</code>.</td>\n</tr>\n<tr>\n<td><code>style</code></td>\n<td>Optional</td>\n<td>Pass styles to the iframe.</td>\n</tr>\n<tr>\n<td><code>allowfullscreen</code></td>\n<td>Optional</td>\n<td>Property to allow certain map parts to go full screen.</td>\n</tr>\n<tr>\n<td><code>loading</code></td>\n<td>Optional</td>\n<td>Defaults to lazy. Consider changing if you know your embed will be above the fold.</td>\n</tr>\n<tr>\n<td><code>q</code></td>\n<td>Optional</td>\n<td>Defines map marker location. <em>This may be required depending on the map mode</em>.</td>\n</tr>\n<tr>\n<td><code>center</code></td>\n<td>Optional</td>\n<td>Defines the center of the map view.</td>\n</tr>\n<tr>\n<td><code>zoom</code></td>\n<td>Optional</td>\n<td>Sets initial zoom level of the map.</td>\n</tr>\n<tr>\n<td><code>maptype</code></td>\n<td>Optional</td>\n<td>Defines type of map tiles to load.</td>\n</tr>\n<tr>\n<td><code>language</code></td>\n<td>Optional</td>\n<td>Defines the language to use for UI elements and for the display of labels on map tiles.</td>\n</tr>\n<tr>\n<td><code>region</code></td>\n<td>Optional</td>\n<td>Defines the appropriate borders and labels to display, based on geo-political sensitivities.</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"youtube-embed\" data-docs-heading=\"\">YouTube Embed     </h3> <p>The <code>YouTubeEmbed</code> component can be used to load and display a YouTube embed. This component loads faster by using <a href=\"https://github.com/paulirish/lite-youtube-embed\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>lite-youtube-embed</code></a> under the hood.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { YouTubeEmbed } from '@next/third-parties/google'\n \nexport default function Page() {\n  return &lt;YouTubeEmbed videoid=\"ogfYd705cRs\" height={400} params=\"controls=0\" /&gt;\n}</pre></div>  <h4 id=\"options-3\" data-docs-heading=\"\">Options     </h4> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>videoid</code></td>\n<td>Required</td>\n<td>YouTube video id.</td>\n</tr>\n<tr>\n<td><code>width</code></td>\n<td>Optional</td>\n<td>Width of the video container. Defaults to <code>auto</code>\n</td>\n</tr>\n<tr>\n<td><code>height</code></td>\n<td>Optional</td>\n<td>Height of the video container. Defaults to <code>auto</code>\n</td>\n</tr>\n<tr>\n<td><code>playlabel</code></td>\n<td>Optional</td>\n<td>A visually hidden label for the play button for accessibility.</td>\n</tr>\n<tr>\n<td><code>params</code></td>\n<td>Optional</td>\n<td>The video player params defined <a href=\"https://developers.google.com/youtube/player_parameters#Parameters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">here</a>. <br> Params are passed as a query param string. <br> Eg: <code>params=\"controls=0&amp;start=10&amp;end=30\"</code>\n</td>\n</tr>\n<tr>\n<td><code>style</code></td>\n<td>Optional</td>\n<td>Used to apply styles to the video container.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/third-party-libraries\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/third-party-libraries</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/memory-usage":"<h1 class=\"break-words\">Memory Usage</h1>\n<p>As applications grow and become more feature rich, they can demand more resources when developing locally or creating production builds.</p> <p>Let's explore some strategies and techniques to optimize memory and address common memory issues in Next.js.</p> <h2 id=\"reduce-number-of-dependencies\" data-docs-heading=\"\">Reduce number of dependencies     </h2> <p>Applications with a large amount of dependencies will use more memory.</p> <p>The <a href=\"bundle-analyzer\">Bundle Analyzer</a> can help you investigate large dependencies in your application that may be able to be removed to improve performance and memory usage.</p> <h2 id=\"run-next-build-with---experimental-debug-memory-usage\" data-docs-heading=\"\">Run next build with --experimental-debug-memory-usage     </h2> <p>Starting in <code>14.2.0</code>, you can run <code>next build --experimental-debug-memory-usage</code> to run the build in a mode where Next.js will print out information about memory usage continuously throughout the build, such as heap usage and garbage collection statistics. Heap snapshots will also be taken automatically when memory usage gets close to the configured limit.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This feature is not compatible with the Webpack build worker option which is auto-enabled unless you have custom webpack config.</p> </blockquote> <h2 id=\"record-a-heap-profile\" data-docs-heading=\"\">Record a heap profile     </h2> <p>To look for memory issues, you can record a heap profile from Node.js and load it in Chrome DevTools to identify potential sources of memory leaks.</p> <p>In your terminal, pass the <code>--heap-prof</code> flag to Node.js when starting your Next.js build:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">node --heap-prof node_modules/next/dist/bin/next build</pre>\n</div> <p>At the end of the build, a <code>.heapprofile</code> file will be created by Node.js.</p> <p>In Chrome DevTools, you can open the Memory tab and click on the \"Load Profile\" button to visualize the file.</p> <h2 id=\"analyze-a-snapshot-of-the-heap\" data-docs-heading=\"\">Analyze a snapshot of the heap     </h2> <p>You can use an inspector tool to analyze the memory usage of the application.</p> <p>When running the <code>next build</code> or <code>next dev</code> command, add <code>NODE_OPTIONS=--inspect</code> to the beginning of the command. This will expose the inspector agent on the default port. If you wish to break before any user code starts, you can pass <code>--inspect-brk</code> instead. While the process is running, you can use a tool such as Chrome DevTools to connect to the debugging port to record and analyze a snapshot of the heap to see what memory is being retained.</p> <p>Starting in <code>14.2.0</code>, you can also run <code>next build</code> with the <code>--experimental-debug-memory-usage</code> flag to make it easier to take heap snapshots.</p> <p>While running in this mode, you can send a <code>SIGUSR2</code> signal to the process at any point, and the process will take a heap snapshot.</p> <p>The heap snapshot will be saved to the project root of the Next.js application and can be loaded in any heap analyzer, such as Chrome DevTools, to see what memory is retained. This mode is not yet compatible with Webpack build workers.</p> <p>See <a href=\"https://developer.chrome.com/docs/devtools/memory-problems/heap-snapshots\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">how to record and analyze heap snapshots</a> for more information.</p> <h2 id=\"webpack-build-worker\" data-docs-heading=\"\">Webpack build worker     </h2> <p>The Webpack build worker allows you to run Webpack compilations inside a separate Node.js worker which will decrease memory usage of your application during builds.</p> <p>This option is enabled by default if your application does not have a custom Webpack configuration starting in <code>v14.1.0</code>.</p> <p>If you are using an older version of Next.js or you have a custom Webpack configuration, you can enable this option by setting <code>experimental.webpackBuildWorker: true</code> inside your <code>next.config.js</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This feature may not be compatible with all custom Webpack plugins.</p> </blockquote> <h2 id=\"disable-webpack-cache\" data-docs-heading=\"\">Disable Webpack cache     </h2> <p>The <a href=\"https://webpack.js.org/configuration/cache/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Webpack cache</a> saves generated Webpack modules in memory and/or to disk to improve the speed of builds. This can help with performance, but it will also increase the memory usage of your application to store the cached data.</p> <p>You can disable this behavior by adding a <a href=\"../../api-reference/next-config-js/webpack\">custom Webpack configuration</a> to your application:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  webpack: (\n    config,\n    { buildId, dev, isServer, defaultLoaders, nextRuntime, webpack }\n  ) =&gt; {\n    if (cfg.cache &amp;&amp; !dev) {\n      cfg.cache = Object.freeze({\n        type: 'memory',\n      })\n      cfg.cache.maxMemoryGenerations = 0\n    }\n    // Important: return the modified config\n    return config\n  },\n}\n \nexport default nextConfig</pre></div> <h2 id=\"disable-source-maps\" data-docs-heading=\"\">Disable source maps     </h2> <p>Generating source maps consumes extra memory during the build process.</p> <p>You can disable source map generation by adding <code>productionBrowserSourceMaps: false</code> and <code>experimental.serverSourceMaps: false</code> to your Next.js configuration.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Some plugins may turn on source maps and may require custom configuration to disable.</p> </blockquote> <h2 id=\"edge-memory-issues\" data-docs-heading=\"\">Edge memory issues     </h2> <p>Next.js <code>v14.1.3</code> fixed a memory issue when using the Edge runtime. Please update to this version (or later) to see if it addresses your issue.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/memory-usage\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/memory-usage</a>\n  </p>\n</div>\n","app/building-your-application/configuring":"<h1 class=\"break-words\">Configuring</h1> <p>Next.js allows you to customize your project to meet specific requirements. This includes integrations with TypeScript, ESlint, and more, as well as internal configuration options such as Absolute Imports and Environment Variables.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring</a>\n  </p>\n</div>\n","app/building-your-application/optimizing/bundle-analyzer":"<h1 class=\"break-words\">Bundle Analyzer</h1>\n<p><a href=\"https://www.npmjs.com/package/@next/bundle-analyzer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@next/bundle-analyzer</code></a> is a plugin for Next.js that helps you manage the size of your JavaScript modules. It generates a visual report of the size of each module and their dependencies. You can use the information to remove large dependencies, split your code, or only load some parts when needed, reducing the amount of data transferred to the client.</p> <h2 id=\"installation\" data-docs-heading=\"\">Installation     </h2> <p>Install the plugin by running the following command:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i @next/bundle-analyzer\n# or\nyarn add @next/bundle-analyzer\n# or\npnpm add @next/bundle-analyzer</pre>\n</div> <p>Then, add the bundle analyzer's settings to your <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const withBundleAnalyzer = require('@next/bundle-analyzer')({\n  enabled: process.env.ANALYZE === 'true',\n})\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {}\n \nmodule.exports = withBundleAnalyzer(nextConfig)</pre></div> <h2 id=\"analyzing-your-bundles\" data-docs-heading=\"\">Analyzing your bundles     </h2> <p>Run the following command to analyze your bundles:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">ANALYZE=true npm run build\n# or\nANALYZE=true yarn build\n# or\nANALYZE=true pnpm build</pre>\n</div> <p>The report will open three new tabs in your browser, which you can inspect. Doing this regularly while you develop and before deploying your site can help you identify large bundles earlier, and architect your application to be more performant.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/optimizing/bundle-analyzer\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/optimizing/bundle-analyzer</a>\n  </p>\n</div>\n","app/building-your-application/configuring/typescript":"<h1 class=\"break-words\">TypeScript</h1> <p>Next.js provides a TypeScript-first development experience for building your React application.</p> <p>It comes with built-in TypeScript support for automatically installing the necessary packages and configuring the proper settings.</p> <p>As well as a <a href=\"#typescript-plugin\">TypeScript Plugin</a> for your editor.</p>\n<blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn about the built-in TypeScript plugin  <a href=\"https://www.youtube.com/watch?v=pqMqn9fKEf8\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (3 minutes)</a></p> </blockquote> <h2 id=\"new-projects\" data-docs-heading=\"\">New Projects     </h2> <p><code>create-next-app</code> now ships with TypeScript by default.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest</pre></div> <h2 id=\"existing-projects\" data-docs-heading=\"\">Existing Projects     </h2> <p>Add TypeScript to your project by renaming a file to <code>.ts</code> / <code>.tsx</code>. Run <code>next dev</code> and <code>next build</code> to automatically install the necessary dependencies and add a <code>tsconfig.json</code> file with the recommended config options.</p> <p>If you already had a <code>jsconfig.json</code> file, copy the <code>paths</code> compiler option from the old <code>jsconfig.json</code> into the new <code>tsconfig.json</code> file, and delete the old <code>jsconfig.json</code> file.</p> <h2 id=\"typescript-plugin\" data-docs-heading=\"\">TypeScript Plugin     </h2>\n<p>Next.js includes a custom TypeScript plugin and type checker, which VSCode and other code editors can use for advanced type-checking and auto-completion.</p>\n<p>You can enable the plugin in VS Code by:</p>\n<ol> <li>Opening the command palette (<code>Ctrl/</code> + <code>Shift</code> + <code>P</code>)</li> <li>Searching for \"TypeScript: Select TypeScript Version\"</li> <li>Selecting \"Use Workspace Version\"</li> </ol>\n<figure><img alt=\"TypeScript Command Palette\" loading=\"lazy\" width=\"1600\" height=\"637\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ftypescript-command-palette.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ftypescript-command-palette.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ftypescript-command-palette.png&amp;w=3840&amp;q=75\"><img alt=\"TypeScript Command Palette\" loading=\"lazy\" width=\"1600\" height=\"637\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ftypescript-command-palette.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ftypescript-command-palette.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ftypescript-command-palette.png&amp;w=3840&amp;q=75\"></figure><p>Now, when editing files, the custom plugin will be enabled. When running <code>next build</code>, the custom type checker will be used.</p>\n<h3 id=\"plugin-features\" data-docs-heading=\"\">Plugin Features     </h3>\n<p>The TypeScript plugin can help with:</p>\n<ul> <li>Warning if the invalid values for <a href=\"../../api-reference/file-conventions/route-segment-config\">segment config options</a> are passed.</li> <li>Showing available options and in-context documentation.</li> <li>Ensuring the <code>use client</code> directive is used correctly.</li> <li>Ensuring client hooks (like <code>useState</code>) are only used in Client Components.</li> </ul>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: More features will be added in the future.</p> </blockquote> <h2 id=\"minimum-typescript-version\" data-docs-heading=\"\">Minimum TypeScript Version     </h2> <p>It is highly recommended to be on at least <code>v4.5.2</code> of TypeScript to get syntax features such as <a href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-4-5/#type-on-import-names\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">type modifiers on import names</a> and <a href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-4-5/#real-path-sync-native\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">performance improvements</a>.</p> <h2 id=\"statically-typed-links\" data-docs-heading=\"\">Statically Typed Links     </h2>\n<p>Next.js can statically type links to prevent typos and other errors when using <code>next/link</code>, improving type safety when navigating between pages.</p>\n<p>To opt-into this feature, <code>experimental.typedRoutes</code> need to be enabled and the project needs to be using TypeScript.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    typedRoutes: true,\n  },\n}\n \nmodule.exports = nextConfig</pre></div>\n<p>Next.js will generate a link definition in <code>.next/types</code> that contains information about all existing routes in your application, which TypeScript can then use to provide feedback in your editor about invalid links.</p>\n<p>Currently, experimental support includes any string literal, including dynamic segments. For non-literal strings, you currently need to manually cast the <code>href</code> with <code>as Route</code>:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Route } from 'next';\nimport Link from 'next/link'\n \n// No TypeScript errors if href is a valid route\n&lt;Link href=\"/about\" /&gt;\n&lt;Link href=\"/blog/nextjs\" /&gt;\n&lt;Link href={`/blog/${slug}`} /&gt;\n&lt;Link href={('/blog' + slug) as Route} /&gt;\n \n// TypeScript errors if href is not a valid route\n&lt;Link href=\"/aboot\" /&gt;</pre>\n</div>\n<p>To accept <code>href</code> in a custom component wrapping <code>next/link</code>, use a generic:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Route } from 'next'\nimport Link from 'next/link'\n \nfunction Card&lt;T extends string&gt;({ href }: { href: Route&lt;T&gt; | URL }) {\n  return (\n    &lt;Link href={href}&gt;\n      &lt;div&gt;My Card&lt;/div&gt;\n    &lt;/Link&gt;\n  )\n}</pre>\n</div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>How does it work?</strong></p> <p>When running <code>next dev</code> or <code>next build</code>, Next.js generates a hidden <code>.d.ts</code> file inside <code>.next</code> that contains information about all existing routes in your application (all valid routes as the <code>href</code> type of <code>Link</code>). This <code>.d.ts</code> file is included in <code>tsconfig.json</code> and the TypeScript compiler will check that <code>.d.ts</code> and provide feedback in your editor about invalid links.</p> </blockquote>\n<h2 id=\"end-to-end-type-safety\" data-docs-heading=\"\">End-to-End Type Safety     </h2>\n<p>The Next.js App Router has <strong>enhanced type safety</strong>. This includes:</p>\n<ol> <li>\n<strong>No serialization of data between fetching function and page</strong>: You can <code>fetch</code> directly in components, layouts, and pages on the server. This data <em>does not</em> need to be serialized (converted to a string) to be passed to the client side for consumption in React. Instead, since <code>app</code> uses Server Components by default, we can use values like <code>Date</code>, <code>Map</code>, <code>Set</code>, and more without any extra steps. Previously, you needed to manually type the boundary between server and client with Next.js-specific types.</li> <li>\n<strong>Streamlined data flow between components</strong>: With the removal of <code>_app</code> in favor of root layouts, it is now easier to visualize the data flow between components and pages. Previously, data flowing between individual <code>pages</code> and <code>_app</code> were difficult to type and could introduce confusing bugs. With <a href=\"../data-fetching/fetching-caching-and-revalidating\">colocated data fetching</a> in the App Router, this is no longer an issue.</li> </ol>\n<p><a href=\"../data-fetching/fetching-caching-and-revalidating\">Data Fetching in Next.js</a> now provides as close to end-to-end type safety as possible without being prescriptive about your database or content provider selection.</p>\n<p>We're able to type the response data as you would expect with normal TypeScript. For example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">async function getData() {\n  const res = await fetch('https://api.example.com/...')\n  // The return value is *not* serialized\n  // You can return Date, Map, Set, etc.\n  return res.json()\n}\n \nexport default async function Page() {\n  const name = await getData()\n \n  return '...'\n}</pre></div>\n<p>For <em>complete</em> end-to-end type safety, this also requires your database or content provider to support TypeScript. This could be through using an <a href=\"https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">ORM</a> or type-safe query builder.</p>\n<h2 id=\"async-server-component-typescript-error\" data-docs-heading=\"\">Async Server Component TypeScript Error     </h2>\n<p>To use an <code>async</code> Server Component with TypeScript, ensure you are using TypeScript <code>5.1.3</code> or higher and <code>@types/react</code> <code>18.2.8</code> or higher.</p>\n<p>If you are using an older version of TypeScript, you may see a <code>'Promise&lt;Element&gt;' is not a valid JSX element</code> type error. Updating to the latest version of TypeScript and <code>@types/react</code> should resolve this issue.</p>\n<h2 id=\"passing-data-between-server--client-components\" data-docs-heading=\"\">Passing Data Between Server &amp; Client Components     </h2>\n<p>When passing data between a Server and Client Component through props, the data is still serialized (converted to a string) for use in the browser. However, it does not need a special type. Its typed the same as passing any other props between components.</p>\n<p>Further, there is less code to be serialized, as un-rendered data does not cross between the server and client (it remains on the server). This is only now possible through support for Server Components.</p>  <h2 id=\"path-aliases-and-baseurl\" data-docs-heading=\"\">Path aliases and baseUrl     </h2> <p>Next.js automatically supports the <code>tsconfig.json</code> <code>\"paths\"</code> and <code>\"baseUrl\"</code> options.</p> <p>You can learn more about this feature on the <a href=\"absolute-imports-and-module-aliases\">Module Path aliases documentation</a>.</p>  <h2 id=\"type-checking-nextconfigjs\" data-docs-heading=\"\">Type checking next.config.js     </h2> <p>The <code>next.config.js</code> file must be a JavaScript file as it does not get parsed by Babel or TypeScript, however you can add some type checking in your IDE using JSDoc as below:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \n/**\n * @type {import('next').NextConfig}\n **/\nconst nextConfig = {\n  /* config options here */\n}\n \nmodule.exports = nextConfig</pre>\n</div> <h2 id=\"incremental-type-checking\" data-docs-heading=\"\">Incremental type checking     </h2> <p>Since <code>v10.2.1</code> Next.js supports <a href=\"https://www.typescriptlang.org/tsconfig#incremental\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">incremental type checking</a> when enabled in your <code>tsconfig.json</code>, this can help speed up type checking in larger applications.</p> <h2 id=\"ignoring-typescript-errors\" data-docs-heading=\"\">Ignoring TypeScript Errors     </h2> <p>Next.js fails your <strong>production build</strong> (<code>next build</code>) when TypeScript errors are present in your project.</p> <p>If you'd like Next.js to dangerously produce production code even when your application has errors, you can disable the built-in type checking step.</p> <p>If disabled, be sure you are running type checks as part of your build or deploy process, otherwise this can be very dangerous.</p> <p>Open <code>next.config.js</code> and enable the <code>ignoreBuildErrors</code> option in the <code>typescript</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  typescript: {\n    // !! WARN !!\n    // Dangerously allow production builds to successfully complete even if\n    // your project has type errors.\n    // !! WARN !!\n    ignoreBuildErrors: true,\n  },\n}</pre></div> <h2 id=\"custom-type-declarations\" data-docs-heading=\"\">Custom Type Declarations     </h2> <p>When you need to declare custom types, you might be tempted to modify <code>next-env.d.ts</code>. However, this file is automatically generated, so any changes you make will be overwritten. Instead, you should create a new file, let's call it <code>new-types.d.ts</code>, and reference it in your <code>tsconfig.json</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"skipLibCheck\": true\n    //...truncated...\n  },\n  \"include\": [\n    \"new-types.d.ts\",\n    \"next-env.d.ts\",\n    \".next/types/**/*.ts\",\n    \"**/*.ts\",\n    \"**/*.tsx\"\n  ],\n  \"exclude\": [\"node_modules\"]\n}</pre></div> <h2 id=\"version-changes\" data-docs-heading=\"\">Version Changes     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>Statically typed links are available in beta.</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>\n<a href=\"../../../architecture/nextjs-compiler\">SWC</a> is now used by default to compile TypeScript and TSX for faster builds.</td>\n</tr>\n<tr>\n<td><code>v10.2.1</code></td>\n<td>\n<a href=\"https://www.typescriptlang.org/tsconfig#incremental\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Incremental type checking</a> support added when enabled in your <code>tsconfig.json</code>.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring/typescript\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring/typescript</a>\n  </p>\n</div>\n","app/building-your-application/configuring/eslint":"<h1 class=\"break-words\">ESLint</h1> <p>Next.js provides an integrated <a href=\"https://eslint.org/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">ESLint</a> experience out of the box. Add <code>next lint</code> as a script to <code>package.json</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"lint\": \"next lint\"\n  }\n}</pre></div> <p>Then run <code>npm run lint</code> or <code>yarn lint</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn lint</pre></div> <p>If you don't already have ESLint configured in your application, you will be guided through the installation and configuration process.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn lint</pre></div> <blockquote class=\"p-3 text-sm\"> <p>You'll see a prompt like this:</p> <p>? How would you like to configure ESLint?</p> <p> Strict (recommended)<br> Base<br> Cancel</p> </blockquote> <p>One of the following three options can be selected:</p> <ul> <li> <p><strong>Strict</strong>: Includes Next.js' base ESLint configuration along with a stricter <a href=\"#core-web-vitals\">Core Web Vitals rule-set</a>. This is the recommended configuration for developers setting up ESLint for the first time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next/core-web-vitals\"\n}</pre></div> </li> <li> <p><strong>Base</strong>: Includes Next.js' base ESLint configuration.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next\"\n}</pre></div> </li> <li> <p><strong>Cancel</strong>: Does not include any ESLint configuration. Only select this option if you plan on setting up your own custom ESLint configuration.</p> </li> </ul> <p>If either of the two configuration options are selected, Next.js will automatically install <code>eslint</code> and <code>eslint-config-next</code> as dependencies in your application and create an <code>.eslintrc.json</code> file in the root of your project that includes your selected configuration.</p> <p>You can now run <code>next lint</code> every time you want to run ESLint to catch errors. Once ESLint has been set up, it will also automatically run during every build (<code>next build</code>). Errors will fail the build, while warnings will not.</p> <blockquote class=\"p-3 text-sm\"> <p>If you do not want ESLint to run during <code>next build</code>, refer to the documentation for <a href=\"../../api-reference/next-config-js/eslint\">Ignoring ESLint</a>.</p> </blockquote>  <p>We recommend using an appropriate <a href=\"https://eslint.org/docs/user-guide/integrations#editors\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">integration</a> to view warnings and errors directly in your code editor during development.</p> <h2 id=\"eslint-config\" data-docs-heading=\"\">ESLint Config     </h2> <p>The default configuration (<code>eslint-config-next</code>) includes everything you need to have an optimal out-of-the-box linting experience in Next.js. If you do not have ESLint already configured in your application, we recommend using <code>next lint</code> to set up ESLint along with this configuration.</p> <blockquote class=\"p-3 text-sm\"> <p>If you would like to use <code>eslint-config-next</code> along with other ESLint configurations, refer to the <a href=\"#additional-configurations\">Additional Configurations</a> section to learn how to do so without causing any conflicts.</p> </blockquote> <p>Recommended rule-sets from the following ESLint plugins are all used within <code>eslint-config-next</code>:</p> <ul> <li><a href=\"https://www.npmjs.com/package/eslint-plugin-react\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eslint-plugin-react</code></a></li> <li><a href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eslint-plugin-react-hooks</code></a></li> <li><a href=\"https://www.npmjs.com/package/@next/eslint-plugin-next\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eslint-plugin-next</code></a></li> </ul> <p>This will take precedence over the configuration from <code>next.config.js</code>.</p> <h2 id=\"eslint-plugin\" data-docs-heading=\"\">ESLint Plugin     </h2> <p>Next.js provides an ESLint plugin, <a href=\"https://www.npmjs.com/package/@next/eslint-plugin-next\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eslint-plugin-next</code></a>, already bundled within the base configuration that makes it possible to catch common issues and problems in a Next.js application. The full set of rules is as follows:</p> <p> Enabled in the recommended configuration</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th align=\"center\"></th>\n<th>Rule</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/google-font-display\">@next/next/google-font-display</a></td>\n<td>Enforce font-display behavior with Google Fonts.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/google-font-preconnect\">@next/next/google-font-preconnect</a></td>\n<td>Ensure <code>preconnect</code> is used with Google Fonts.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/inline-script-id\">@next/next/inline-script-id</a></td>\n<td>Enforce <code>id</code> attribute on <code>next/script</code> components with inline content.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/next-script-for-ga\">@next/next/next-script-for-ga</a></td>\n<td>Prefer <code>next/script</code> component when using the inline script for Google Analytics.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-assign-module-variable\">@next/next/no-assign-module-variable</a></td>\n<td>Prevent assignment to the <code>module</code> variable.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-async-client-component\">@next/next/no-async-client-component</a></td>\n<td>Prevent client components from being async functions.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-before-interactive-script-outside-document\">@next/next/no-before-interactive-script-outside-document</a></td>\n<td>Prevent usage of <code>next/script</code>'s <code>beforeInteractive</code> strategy outside of <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-css-tags\">@next/next/no-css-tags</a></td>\n<td>Prevent manual stylesheet tags.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-document-import-in-page\">@next/next/no-document-import-in-page</a></td>\n<td>Prevent importing <code>next/document</code> outside of <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-duplicate-head\">@next/next/no-duplicate-head</a></td>\n<td>Prevent duplicate usage of <code>&lt;Head&gt;</code> in <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-head-element\">@next/next/no-head-element</a></td>\n<td>Prevent usage of <code>&lt;head&gt;</code> element.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-head-import-in-document\">@next/next/no-head-import-in-document</a></td>\n<td>Prevent usage of <code>next/head</code> in <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-html-link-for-pages\">@next/next/no-html-link-for-pages</a></td>\n<td>Prevent usage of <code>&lt;a&gt;</code> elements to navigate to internal Next.js pages.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-img-element\">@next/next/no-img-element</a></td>\n<td>Prevent usage of <code>&lt;img&gt;</code> element due to slower LCP and higher bandwidth.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-page-custom-font\">@next/next/no-page-custom-font</a></td>\n<td>Prevent page-only custom fonts.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-script-component-in-head\">@next/next/no-script-component-in-head</a></td>\n<td>Prevent usage of <code>next/script</code> in <code>next/head</code> component.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-styled-jsx-in-document\">@next/next/no-styled-jsx-in-document</a></td>\n<td>Prevent usage of <code>styled-jsx</code> in <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-sync-scripts\">@next/next/no-sync-scripts</a></td>\n<td>Prevent synchronous scripts.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-title-in-document-head\">@next/next/no-title-in-document-head</a></td>\n<td>Prevent usage of <code>&lt;title&gt;</code> with <code>Head</code> component from <code>next/document</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td>@next/next/no-typos</td>\n<td>Prevent common typos in <a href=\"../../../pages/building-your-application/data-fetching\">Next.js's data fetching functions</a>\n</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-unwanted-polyfillio\">@next/next/no-unwanted-polyfillio</a></td>\n<td>Prevent duplicate polyfills from Polyfill.io.</td>\n</tr>\n</tbody>\n</table></div> <p>If you already have ESLint configured in your application, we recommend extending from this plugin directly instead of including <code>eslint-config-next</code> unless a few conditions are met. Refer to the <a href=\"#recommended-plugin-ruleset\">Recommended Plugin Ruleset</a> to learn more.</p> <h3 id=\"custom-settings\" data-docs-heading=\"\">Custom Settings     </h3> <h4 id=\"rootdir\" data-docs-heading=\"\">rootDir     </h4> <p>If you're using <code>eslint-plugin-next</code> in a project where Next.js isn't installed in your root directory (such as a monorepo), you can tell <code>eslint-plugin-next</code> where to find your Next.js application using the <code>settings</code> property in your <code>.eslintrc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next\",\n  \"settings\": {\n    \"next\": {\n      \"rootDir\": \"packages/my-app/\"\n    }\n  }\n}</pre></div> <p><code>rootDir</code> can be a path (relative or absolute), a glob (i.e. <code>\"packages/*/\"</code>), or an array of paths and/or globs.</p> <h2 id=\"linting-custom-directories-and-files\" data-docs-heading=\"\">Linting Custom Directories and Files     </h2> <p>By default, Next.js will run ESLint for all files in the <code>pages/</code>, <code>app/</code>, <code>components/</code>, <code>lib/</code>, and <code>src/</code> directories. However, you can specify which directories using the <code>dirs</code> option in the <code>eslint</code> config in <code>next.config.js</code> for production builds:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  eslint: {\n    dirs: ['pages', 'utils'], // Only run ESLint on the 'pages' and 'utils' directories during production builds (next build)\n  },\n}</pre></div> <p>Similarly, the <code>--dir</code> and <code>--file</code> flags can be used for <code>next lint</code> to lint specific directories and files:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next lint --dir pages --dir utils --file bar.js</pre></div> <h2 id=\"caching\" data-docs-heading=\"\">Caching     </h2> <p>To improve performance, information of files processed by ESLint are cached by default. This is stored in <code>.next/cache</code> or in your defined <a href=\"../../api-reference/next-config-js/distdir\">build directory</a>. If you include any ESLint rules that depend on more than the contents of a single source file and need to disable the cache, use the <code>--no-cache</code> flag with <code>next lint</code>.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next lint --no-cache</pre></div> <h2 id=\"disabling-rules\" data-docs-heading=\"\">Disabling Rules     </h2> <p>If you would like to modify or disable any rules provided by the supported plugins (<code>react</code>, <code>react-hooks</code>, <code>next</code>), you can directly change them using the <code>rules</code> property in your <code>.eslintrc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next\",\n  \"rules\": {\n    \"react/no-unescaped-entities\": \"off\",\n    \"@next/next/no-page-custom-font\": \"off\"\n  }\n}</pre></div> <h3 id=\"core-web-vitals\" data-docs-heading=\"\">Core Web Vitals     </h3> <p>The <code>next/core-web-vitals</code> rule set is enabled when <code>next lint</code> is run for the first time and the <strong>strict</strong> option is selected.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next/core-web-vitals\"\n}</pre></div> <p><code>next/core-web-vitals</code> updates <code>eslint-plugin-next</code> to error on a number of rules that are warnings by default if they affect <a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Core Web Vitals</a>.</p> <blockquote class=\"p-3 text-sm\"> <p>The <code>next/core-web-vitals</code> entry point is automatically included for new applications built with <a href=\"../../api-reference/create-next-app\">Create Next App</a>.</p> </blockquote> <h2 id=\"usage-with-other-tools\" data-docs-heading=\"\">Usage With Other Tools     </h2> <h3 id=\"prettier\" data-docs-heading=\"\">Prettier     </h3> <p>ESLint also contains code formatting rules, which can conflict with your existing <a href=\"https://prettier.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Prettier</a> setup. We recommend including <a href=\"https://github.com/prettier/eslint-config-prettier\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">eslint-config-prettier</a> in your ESLint config to make ESLint and Prettier work together.</p> <p>First, install the dependency:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install --save-dev eslint-config-prettier\n \nyarn add --dev eslint-config-prettier\n \npnpm add --save-dev eslint-config-prettier\n \nbun add --dev eslint-config-prettier</pre></div> <p>Then, add <code>prettier</code> to your existing ESLint config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": [\"next\", \"prettier\"]\n}</pre></div> <h3 id=\"lint-staged\" data-docs-heading=\"\">lint-staged     </h3> <p>If you would like to use <code>next lint</code> with <a href=\"https://github.com/okonet/lint-staged\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">lint-staged</a> to run the linter on staged git files, you'll have to add the following to the <code>.lintstagedrc.js</code> file in the root of your project in order to specify usage of the <code>--file</code> flag.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const path = require('path')\n \nconst buildEslintCommand = (filenames) =&gt;\n  `next lint --fix --file ${filenames\n    .map((f) =&gt; path.relative(process.cwd(), f))\n    .join(' --file ')}`\n \nmodule.exports = {\n  '*.{js,jsx,ts,tsx}': [buildEslintCommand],\n}</pre></div> <h2 id=\"migrating-existing-config\" data-docs-heading=\"\">Migrating Existing Config     </h2> <h3 id=\"recommended-plugin-ruleset\" data-docs-heading=\"\">Recommended Plugin Ruleset     </h3> <p>If you already have ESLint configured in your application and any of the following conditions are true:</p> <ul> <li>You have one or more of the following plugins already installed (either separately or through a different config such as <code>airbnb</code> or <code>react-app</code>): <ul> <li><code>react</code></li> <li><code>react-hooks</code></li> <li><code>jsx-a11y</code></li> <li><code>import</code></li> </ul> </li> <li>You've defined specific <code>parserOptions</code> that are different from how Babel is configured within Next.js (this is not recommended unless you have <a href=\"../../../pages/building-your-application/configuring/babel\">customized your Babel configuration</a>)</li> <li>You have <code>eslint-plugin-import</code> installed with Node.js and/or TypeScript <a href=\"https://github.com/benmosher/eslint-plugin-import#resolvers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">resolvers</a> defined to handle imports</li> </ul> <p>Then we recommend either removing these settings if you prefer how these properties have been configured within <a href=\"https://github.com/vercel/next.js/blob/canary/packages/eslint-config-next/index.js\" rel=\"noopener noreferrer\" target=\"_blank\"><code>eslint-config-next</code></a> or extending directly from the Next.js ESLint plugin instead:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  extends: [\n    //...\n    'plugin:@next/next/recommended',\n  ],\n}</pre>\n</div> <p>The plugin can be installed normally in your project without needing to run <code>next lint</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install --save-dev @next/eslint-plugin-next\n \nyarn add --dev @next/eslint-plugin-next\n \npnpm add --save-dev @next/eslint-plugin-next\n \nbun add --dev @next/eslint-plugin-next</pre></div> <p>This eliminates the risk of collisions or errors that can occur due to importing the same plugin or parser across multiple configurations.</p> <h3 id=\"additional-configurations\" data-docs-heading=\"\">Additional Configurations     </h3> <p>If you already use a separate ESLint configuration and want to include <code>eslint-config-next</code>, ensure that it is extended last after other configurations. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": [\"eslint:recommended\", \"next\"]\n}</pre></div> <p>The <code>next</code> configuration already handles setting default values for the <code>parser</code>, <code>plugins</code> and <code>settings</code> properties. There is no need to manually re-declare any of these properties unless you need a different configuration for your use case.</p> <p>If you include any other shareable configurations, <strong>you will need to make sure that these properties are not overwritten or modified</strong>. Otherwise, we recommend removing any configurations that share behavior with the <code>next</code> configuration or extending directly from the Next.js ESLint plugin as mentioned above.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring/eslint\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring/eslint</a>\n  </p>\n</div>\n","app/building-your-application/configuring/absolute-imports-and-module-aliases":"<h1 class=\"break-words\">Absolute Imports and Module Path Aliases</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-absolute-imports\" rel=\"noopener noreferrer\" target=\"_blank\">Absolute Imports and Aliases</a></li> </ul></details> <p>Next.js has in-built support for the <code>\"paths\"</code> and <code>\"baseUrl\"</code> options of <code>tsconfig.json</code> and <code>jsconfig.json</code> files.</p> <p>These options allow you to alias project directories to absolute paths, making it easier to import modules. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// before\nimport { Button } from '../../../components/button'\n \n// after\nimport { Button } from '@/components/button'</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>create-next-app</code> will prompt to configure these options for you.</p> </blockquote> <h2 id=\"absolute-imports\" data-docs-heading=\"\">Absolute Imports     </h2> <p>The <code>baseUrl</code> configuration option allows you to import directly from the root of the project.</p> <p>An example of this configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"baseUrl\": \".\"\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Button() {\n  return &lt;button&gt;Click me&lt;/button&gt;\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Button from 'components/button'\n \nexport default function HomePage() {\n  return (\n    &lt;&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n      &lt;Button /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h2 id=\"module-aliases\" data-docs-heading=\"\">Module Aliases     </h2> <p>In addition to configuring the <code>baseUrl</code> path, you can use the <code>\"paths\"</code> option to \"alias\" module paths.</p> <p>For example, the following configuration maps <code>@/components/*</code> to <code>components/*</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/components/*\": [\"components/*\"]\n    }\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Button() {\n  return &lt;button&gt;Click me&lt;/button&gt;\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Button from '@/components/button'\n \nexport default function HomePage() {\n  return (\n    &lt;&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n      &lt;Button /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>Each of the <code>\"paths\"</code> are relative to the <code>baseUrl</code> location. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// tsconfig.json or jsconfig.json\n{\n  \"compilerOptions\": {\n    \"baseUrl\": \"src/\",\n    \"paths\": {\n      \"@/styles/*\": [\"styles/*\"],\n      \"@/components/*\": [\"components/*\"]\n    }\n  }\n}</pre>\n</div> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// pages/index.js\nimport Button from '@/components/button'\nimport '@/styles/styles.css'\nimport Helper from 'utils/helper'\n \nexport default function HomePage() {\n  return (\n    &lt;Helper&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n      &lt;Button /&gt;\n    &lt;/Helper&gt;\n  )\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring/absolute-imports-and-module-aliases\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring/absolute-imports-and-module-aliases</a>\n  </p>\n</div>\n","app/building-your-application/configuring/draft-mode":"<h1 class=\"break-words\">Draft Mode</h1>\n<p>Static rendering is useful when your pages fetch data from a headless CMS. However, its not ideal when youre writing a draft on your headless CMS and want to view the draft immediately on your page. Youd want Next.js to render these pages at <strong>request time</strong> instead of build time and fetch the draft content instead of the published content. Youd want Next.js to switch to <a href=\"../rendering/server-components#dynamic-rendering\">dynamic rendering</a> only for this specific case.</p> <p>Next.js has a feature called <strong>Draft Mode</strong> which solves this problem. Here are instructions on how to use it.</p> <h2 id=\"step-1-create-and-access-the-route-handler\" data-docs-heading=\"\">Step 1: Create and access the Route Handler     </h2> <p>First, create a <a href=\"../routing/route-handlers\">Route Handler</a>. It can have any name - e.g. <code>app/api/draft/route.ts</code></p> <p>Then, import <code>draftMode</code> from <code>next/headers</code> and call the <code>enable()</code> method.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// route handler enabling draft mode\nimport { draftMode } from 'next/headers'\n \nexport async function GET(request: Request) {\n  draftMode().enable()\n  return new Response('Draft mode is enabled')\n}</pre></div>  <p>This will set a <strong>cookie</strong> to enable draft mode. Subsequent requests containing this cookie will trigger <strong>Draft Mode</strong> changing the behavior for statically generated pages (more on this later).</p> <p>You can test this manually by visiting <code>/api/draft</code> and looking at your browsers developer tools. Notice the <code>Set-Cookie</code> response header with a cookie named <code>__prerender_bypass</code>.</p> <h3 id=\"securely-accessing-it-from-your-headless-cms\" data-docs-heading=\"\">Securely accessing it from your Headless CMS     </h3> <p>In practice, youd want to call this Route Handler <em>securely</em> from your headless CMS. The specific steps will vary depending on which headless CMS youre using, but here are some common steps you could take.</p> <p>These steps assume that the headless CMS youre using supports setting <strong>custom draft URLs</strong>. If it doesnt, you can still use this method to secure your draft URLs, but youll need to construct and access the draft URL manually.</p> <p><strong>First</strong>, you should create a <strong>secret token string</strong> using a token generator of your choice. This secret will only be known by your Next.js app and your headless CMS. This secret prevents people who dont have access to your CMS from accessing draft URLs.</p> <p><strong>Second</strong>, if your headless CMS supports setting custom draft URLs, specify the following as the draft URL. This assumes that your Route Handler is located at <code>app/api/draft/route.ts</code></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://&lt;your-site&gt;/api/draft?secret=&lt;token&gt;&amp;slug=&lt;path&gt;</pre></div> <ul> <li>\n<code>&lt;your-site&gt;</code> should be your deployment domain.</li> <li>\n<code>&lt;token&gt;</code> should be replaced with the secret token you generated.</li> <li>\n<code>&lt;path&gt;</code> should be the path for the page that you want to view. If you want to view <code>/posts/foo</code>, then you should use <code>&amp;slug=/posts/foo</code>.</li> </ul> <p>Your headless CMS might allow you to include a variable in the draft URL so that <code>&lt;path&gt;</code> can be set dynamically based on the CMSs data like so: <code>&amp;slug=/posts/{entry.fields.slug}</code></p> <p><strong>Finally</strong>, in the Route Handler:</p> <ul> <li>Check that the secret matches and that the <code>slug</code> parameter exists (if not, the request should fail).</li> <li>Call <code>draftMode.enable()</code> to set the cookie.</li> <li>Then redirect the browser to the path specified by <code>slug</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// route handler with secret and slug\nimport { draftMode } from 'next/headers'\nimport { redirect } from 'next/navigation'\n \nexport async function GET(request: Request) {\n  // Parse query string parameters\n  const { searchParams } = new URL(request.url)\n  const secret = searchParams.get('secret')\n  const slug = searchParams.get('slug')\n \n  // Check the secret and next parameters\n  // This secret should only be known to this route handler and the CMS\n  if (secret !== 'MY_SECRET_TOKEN' || !slug) {\n    return new Response('Invalid token', { status: 401 })\n  }\n \n  // Fetch the headless CMS to check if the provided `slug` exists\n  // getPostBySlug would implement the required fetching logic to the headless CMS\n  const post = await getPostBySlug(slug)\n \n  // If the slug doesn't exist prevent draft mode from being enabled\n  if (!post) {\n    return new Response('Invalid slug', { status: 401 })\n  }\n \n  // Enable Draft Mode by setting the cookie\n  draftMode().enable()\n \n  // Redirect to the path from the fetched post\n  // We don't redirect to searchParams.slug as that might lead to open redirect vulnerabilities\n  redirect(post.slug)\n}</pre></div>  <p>If it succeeds, then the browser will be redirected to the path you want to view with the draft mode cookie.</p> <h2 id=\"step-2-update-page\" data-docs-heading=\"\">Step 2: Update page     </h2> <p>The next step is to update your page to check the value of <code>draftMode().isEnabled</code>.</p> <p>If you request a page which has the cookie set, then data will be fetched at <strong>request time</strong> (instead of at build time).</p> <p>Furthermore, the value of <code>isEnabled</code> will be <code>true</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// page that fetches data\nimport { draftMode } from 'next/headers'\n \nasync function getData() {\n  const { isEnabled } = draftMode()\n \n  const url = isEnabled\n    ? 'https://draft.example.com'\n    : 'https://production.example.com'\n \n  const res = await fetch(url)\n \n  return res.json()\n}\n \nexport default async function Page() {\n  const { title, desc } = await getData()\n \n  return (\n    &lt;main&gt;\n      &lt;h1&gt;{title}&lt;/h1&gt;\n      &lt;p&gt;{desc}&lt;/p&gt;\n    &lt;/main&gt;\n  )\n}</pre></div>  <p>That's it! If you access the draft Route Handler (with <code>secret</code> and <code>slug</code>) from your headless CMS or manually, you should now be able to see the draft content. And if you update your draft without publishing, you should be able to view the draft.</p> <p>Set this as the draft URL on your headless CMS or access manually, and you should be able to see the draft.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://&lt;your-site&gt;/api/draft?secret=&lt;token&gt;&amp;slug=&lt;path&gt;</pre></div> <h2 id=\"more-details\" data-docs-heading=\"\">More Details     </h2> <h3 id=\"clear-the-draft-mode-cookie\" data-docs-heading=\"\">Clear the Draft Mode cookie     </h3> <p>By default, the Draft Mode session ends when the browser is closed.</p> <p>To clear the Draft Mode cookie manually, create a Route Handler that calls <code>draftMode().disable()</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { draftMode } from 'next/headers'\n \nexport async function GET(request: Request) {\n  draftMode().disable()\n  return new Response('Draft mode is disabled')\n}</pre></div>  <p>Then, send a request to <code>/api/disable-draft</code> to invoke the Route Handler. If calling this route using <a href=\"../../api-reference/components/link\"><code>next/link</code></a>, you must pass <code>prefetch={false}</code> to prevent accidentally deleting the cookie on prefetch.</p> <h3 id=\"unique-per-next-build\" data-docs-heading=\"\">Unique per next build     </h3> <p>A new bypass cookie value will be generated each time you run <code>next build</code>.</p> <p>This ensures that the bypass cookie cant be guessed.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: To test Draft Mode locally over HTTP, your browser will need to allow third-party cookies and local storage access.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring/draft-mode\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring/draft-mode</a>\n  </p>\n</div>\n","app/building-your-application/configuring/content-security-policy":"<h1 class=\"break-words\">Content Security Policy</h1> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/CSP\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Content Security Policy (CSP)</a> is important to guard your Next.js application against various security threats such as cross-site scripting (XSS), clickjacking, and other code injection attacks.</p> <p>By using CSP, developers can specify which origins are permissible for content sources, scripts, stylesheets, images, fonts, objects, media (audio, video), iframes, and more.</p> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-strict-csp\" rel=\"noopener noreferrer\" target=\"_blank\">Strict CSP</a></li> </ul></details> <h2 id=\"nonces\" data-docs-heading=\"\">Nonces     </h2> <p>A <a href=\"https://developer.mozilla.org/docs/Web/HTML/Global_attributes/nonce\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">nonce</a> is a unique, random string of characters created for a one-time use. It is used in conjunction with CSP to selectively allow certain inline scripts or styles to execute, bypassing strict CSP directives.</p> <h3 id=\"why-use-a-nonce\" data-docs-heading=\"\">Why use a nonce?     </h3> <p>Even though CSPs are designed to block malicious scripts, there are legitimate scenarios where inline scripts are necessary. In such cases, nonces offer a way to allow these scripts to execute if they have the correct nonce.</p> <h3 id=\"adding-a-nonce-with-middleware\" data-docs-heading=\"\">Adding a nonce with Middleware     </h3> <p><a href=\"../routing/middleware\">Middleware</a> enables you to add headers and generate nonces before the page renders.</p> <p>Every time a page is viewed, a fresh nonce should be generated. This means that you <strong>must use dynamic rendering to add nonces</strong>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n  const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}' 'strict-dynamic';\n    style-src 'self' 'nonce-${nonce}';\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n  // Replace newline characters and spaces\n  const contentSecurityPolicyHeaderValue = cspHeader\n    .replace(/\\s{2,}/g, ' ')\n    .trim()\n \n  const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-nonce', nonce)\n \n  requestHeaders.set(\n    'Content-Security-Policy',\n    contentSecurityPolicyHeaderValue\n  )\n \n  const response = NextResponse.next({\n    request: {\n      headers: requestHeaders,\n    },\n  })\n  response.headers.set(\n    'Content-Security-Policy',\n    contentSecurityPolicyHeaderValue\n  )\n \n  return response\n}</pre></div>  <p>By default, Middleware runs on all requests. You can filter Middleware to run on specific paths using a <a href=\"../routing/middleware#matcher\"><code>matcher</code></a>.</p> <p>We recommend ignoring matching prefetches (from <code>next/link</code>) and static assets that don't need the CSP header.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n  ],\n}</pre></div>  <h3 id=\"reading-the-nonce\" data-docs-heading=\"\">Reading the nonce     </h3> <p>You can now read the nonce from a <a href=\"../rendering/server-components\">Server Component</a> using <a href=\"../../api-reference/functions/headers\"><code>headers</code></a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { headers } from 'next/headers'\nimport Script from 'next/script'\n \nexport default function Page() {\n  const nonce = headers().get('x-nonce')\n \n  return (\n    &lt;Script\n      src=\"https://www.googletagmanager.com/gtag/js\"\n      strategy=\"afterInteractive\"\n      nonce={nonce}\n    /&gt;\n  )\n}</pre></div>  <h2 id=\"without-nonces\" data-docs-heading=\"\">Without Nonces     </h2> <p>For applications that do not require nonces, you can set the CSP header directly in your <a href=\"../../api-reference/next-config-js\"><code>next.config.js</code></a> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'unsafe-eval' 'unsafe-inline';\n    style-src 'self' 'unsafe-inline';\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n \nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'Content-Security-Policy',\n            value: cspHeader.replace(/\\n/g, ''),\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <p>We recommend using <code>v13.4.20+</code> of Next.js to properly handle and apply nonces.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring/content-security-policy\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring/content-security-policy</a>\n  </p>\n</div>\n","app/building-your-application/testing":"<h1 class=\"break-words\">Testing</h1>\n<p>In React and Next.js, there are a few different types of tests you can write, each with its own purpose and use cases. This page provides an overview of types and commonly used tools you can use to test your application.</p> <h2 id=\"types-of-tests\" data-docs-heading=\"\">Types of tests     </h2> <ul> <li>\n<strong>Unit testing</strong> involves testing individual units (or blocks of code) in isolation. In React, a unit can be a single function, hook, or component. <ul> <li>\n<strong>Component testing</strong> is a more focused version of unit testing where the primary subject of the tests is React components. This may involve testing how components are rendered, their interaction with props, and their behavior in response to user events.</li> <li>\n<strong>Integration testing</strong> involves testing how multiple units work together. This can be a combination of components, hooks, and functions.</li> </ul> </li> <li>\n<strong>End-to-End (E2E) Testing</strong> involves testing user flows in an environment that simulates real user scenarios, like the browser. This means testing specific tasks (e.g. signup flow) in a production-like environment.</li> <li>\n<strong>Snapshot testing</strong> involves capturing the rendered output of a component and saving it to a snapshot file. When tests run, the current rendered output of the component is compared against the saved snapshot. Changes in the snapshot are used to indicate unexpected changes in behavior.</li> </ul> <h2 id=\"async-server-components\" data-docs-heading=\"\">Async Server Components     </h2>\n<p>Since <code>async</code> Server Components are new to the React ecosystem, some tools do not fully support them. In the meantime, we recommend using <strong>End-to-End Testing</strong> over <strong>Unit Testing</strong> for <code>async</code> components.</p> <h2 id=\"guides\" data-docs-heading=\"\">Guides     </h2> <p>See the guides below to learn how to set up Next.js with these commonly used testing tools:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/testing\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/testing</a>\n  </p>\n</div>\n","app/building-your-application/configuring/environment-variables":"<h1 class=\"break-words\">Environment Variables</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/environment-variables\" rel=\"noopener noreferrer\" target=\"_blank\">Environment Variables</a></li> </ul></details> <p>Next.js comes with built-in support for environment variables, which allows you to do the following:</p> <ul> <li><a href=\"#loading-environment-variables\">Use <code>.env.local</code> to load environment variables</a></li> <li><a href=\"#bundling-environment-variables-for-the-browser\">Bundle environment variables for the browser by prefixing with <code>NEXT_PUBLIC_</code></a></li> </ul> <h2 id=\"loading-environment-variables\" data-docs-heading=\"\">Loading Environment Variables     </h2> <p>Next.js has built-in support for loading environment variables from <code>.env.local</code> into <code>process.env</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">DB_HOST=localhost\nDB_USER=myuser\nDB_PASS=mypassword</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: Next.js also supports multiline variables inside of your <code>.env*</code> files:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"># .env.local\n \n# you can write with line breaks\nPRIVATE_KEY=\"-----BEGIN RSA PRIVATE KEY-----\n...\nKh9NV...\n...\n-----END DSA PRIVATE KEY-----\"\n \n# or with `\\n` inside double quotes\nPRIVATE_KEY=\"-----BEGIN RSA PRIVATE KEY-----\\nKh9NV...\\n-----END DSA PRIVATE KEY-----\\n\"</pre>\n</div> </blockquote>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: If you are using a <code>/src</code> folder, please note that Next.js will load the .env files <strong>only</strong> from the parent folder and <strong>not</strong> from the <code>/src</code> folder. This loads <code>process.env.DB_HOST</code>, <code>process.env.DB_USER</code>, and <code>process.env.DB_PASS</code> into the Node.js environment automatically allowing you to use them in <a href=\"../routing/route-handlers\">Route Handlers</a>.</p> </blockquote>\n<p>For example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET() {\n  const db = await myDB.connect({\n    host: process.env.DB_HOST,\n    username: process.env.DB_USER,\n    password: process.env.DB_PASS,\n  })\n  // ...\n}</pre></div> <h3 id=\"referencing-other-variables\" data-docs-heading=\"\">Referencing Other Variables     </h3> <p>Next.js will automatically expand variables that use <code>$</code> to reference other variables e.g. <code>$VARIABLE</code> inside of your <code>.env*</code> files. This allows you to reference other secrets. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">TWITTER_USER=nextjs\nTWITTER_URL=https://twitter.com/$TWITTER_USER</pre></div> <p>In the above example, <code>process.env.TWITTER_URL</code> would be set to <code>https://twitter.com/nextjs</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you need to use variable with a <code>$</code> in the actual value, it needs to be escaped e.g. <code>\\$</code>.</p> </blockquote> <h2 id=\"bundling-environment-variables-for-the-browser\" data-docs-heading=\"\">Bundling Environment Variables for the Browser     </h2> <p>Non-<code>NEXT_PUBLIC_</code> environment variables are only available in the Node.js environment, meaning they aren't accessible to the browser (the client runs in a different <em>environment</em>).</p> <p>In order to make the value of an environment variable accessible in the browser, Next.js can \"inline\" a value, at build time, into the js bundle that is delivered to the client, replacing all references to <code>process.env.[variable]</code> with a hard-coded value. To tell it to do this, you just have to prefix the variable with <code>NEXT_PUBLIC_</code>. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">NEXT_PUBLIC_ANALYTICS_ID=abcdefghijk</pre></div> <p>This will tell Next.js to replace all references to <code>process.env.NEXT_PUBLIC_ANALYTICS_ID</code> in the Node.js environment with the value from the environment in which you run <code>next build</code>, allowing you to use it anywhere in your code. It will be inlined into any JavaScript sent to the browser.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: After being built, your app will no longer respond to changes to these environment variables. For instance, if you use a Heroku pipeline to promote slugs built in one environment to another environment, or if you build and deploy a single Docker image to multiple environments, all <code>NEXT_PUBLIC_</code> variables will be frozen with the value evaluated at build time, so these values need to be set appropriately when the project is built. If you need access to runtime environment values, you'll have to setup your own API to provide them to the client (either on demand or during initialization).</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import setupAnalyticsService from '../lib/my-analytics-service'\n \n// 'NEXT_PUBLIC_ANALYTICS_ID' can be used here as it's prefixed by 'NEXT_PUBLIC_'.\n// It will be transformed at build time to `setupAnalyticsService('abcdefghijk')`.\nsetupAnalyticsService(process.env.NEXT_PUBLIC_ANALYTICS_ID)\n \nfunction HomePage() {\n  return &lt;h1&gt;Hello World&lt;/h1&gt;\n}\n \nexport default HomePage</pre></div> <p>Note that dynamic lookups will <em>not</em> be inlined, such as:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// This will NOT be inlined, because it uses a variable\nconst varName = 'NEXT_PUBLIC_ANALYTICS_ID'\nsetupAnalyticsService(process.env[varName])\n \n// This will NOT be inlined, because it uses a variable\nconst env = process.env\nsetupAnalyticsService(env.NEXT_PUBLIC_ANALYTICS_ID)</pre>\n</div> <h3 id=\"runtime-environment-variables\" data-docs-heading=\"\">Runtime Environment Variables     </h3> <p>Next.js can support both build time and runtime environment variables.</p> <p><strong>By default, environment variables are only available on the server</strong>. To expose an environment variable to the browser, it must be prefixed with <code>NEXT_PUBLIC_</code>. However, these public environment variables will be inlined into the JavaScript bundle during <code>next build</code>.</p> <p>To read runtime environment variables, we recommend using <code>getServerSideProps</code> or <a href=\"../upgrading/app-router-migration\">incrementally adopting the App Router</a>. With the App Router, we can safely read environment variables on the server during dynamic rendering. This allows you to use a singular Docker image that can be promoted through multiple environments with different values.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { unstable_noStore as noStore } from 'next/cache'\n \nexport default function Component() {\n  noStore()\n  // cookies(), headers(), and other dynamic functions\n  // will also opt into dynamic rendering, meaning\n  // this env variable is evaluated at runtime\n  const value = process.env.MY_VALUE\n  // ...\n}</pre>\n</div> <p><strong>Good to know:</strong></p> <ul> <li>You can run code on server startup using the <a href=\"../optimizing/instrumentation\"><code>register</code> function</a>.</li> <li>We do not recommend using the <a href=\"../../../pages/api-reference/next-config-js/runtime-configuration\">runtimeConfig</a> option, as this does not work with the standalone output mode. Instead, we recommend <a href=\"../upgrading/app-router-migration\">incrementally adopting</a> the App Router.</li> </ul> <h2 id=\"default-environment-variables\" data-docs-heading=\"\">Default Environment Variables     </h2> <p>In general only one <code>.env.local</code> file is needed. However, sometimes you might want to add some defaults for the <code>development</code> (<code>next dev</code>) or <code>production</code> (<code>next start</code>) environment.</p> <p>Next.js allows you to set defaults in <code>.env</code> (all environments), <code>.env.development</code> (development environment), and <code>.env.production</code> (production environment).</p> <p><code>.env.local</code> always overrides the defaults set.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.env</code>, <code>.env.development</code>, and <code>.env.production</code> files should be included in your repository as they define defaults. <strong><code>.env*.local</code> should be added to <code>.gitignore</code></strong>, as those files are intended to be ignored. <code>.env.local</code> is where secrets can be stored.</p> </blockquote> <h2 id=\"environment-variables-on-vercel\" data-docs-heading=\"\">Environment Variables on Vercel     </h2> <p>When deploying your Next.js application to <a href=\"https://vercel.com\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, Environment Variables can be configured <a href=\"https://vercel.com/docs/projects/environment-variables?utm_medium=docs&amp;utm_source=next-site&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">in the Project Settings</a>.</p> <p>All types of Environment Variables should be configured there. Even Environment Variables used in Development  which can be <a href=\"https://vercel.com/docs/concepts/projects/environment-variables#development-environment-variables?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">downloaded onto your local device</a> afterwards.</p> <p>If you've configured <a href=\"https://vercel.com/docs/concepts/projects/environment-variables#development-environment-variables?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Development Environment Variables</a> you can pull them into a <code>.env.local</code> for usage on your local machine using the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">vercel env pull .env.local</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: When deploying your Next.js application to <a href=\"https://vercel.com\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, your environment variables in <code>.env*</code> files will not be made available to Edge Runtime, unless their name are prefixed with <code>NEXT_PUBLIC_</code>. We strongly recommend managing your environment variables in <a href=\"https://vercel.com/docs/projects/environment-variables?utm_medium=docs&amp;utm_source=next-site&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Project Settings</a> instead, from where all environment variables are available.</p> </blockquote> <h2 id=\"test-environment-variables\" data-docs-heading=\"\">Test Environment Variables     </h2> <p>Apart from <code>development</code> and <code>production</code> environments, there is a 3rd option available: <code>test</code>. In the same way you can set defaults for development or production environments, you can do the same with a <code>.env.test</code> file for the <code>testing</code> environment (though this one is not as common as the previous two). Next.js will not load environment variables from <code>.env.development</code> or <code>.env.production</code> in the <code>testing</code> environment.</p> <p>This one is useful when running tests with tools like <code>jest</code> or <code>cypress</code> where you need to set specific environment vars only for testing purposes. Test default values will be loaded if <code>NODE_ENV</code> is set to <code>test</code>, though you usually don't need to do this manually as testing tools will address it for you.</p> <p>There is a small difference between <code>test</code> environment, and both <code>development</code> and <code>production</code> that you need to bear in mind: <code>.env.local</code> won't be loaded, as you expect tests to produce the same results for everyone. This way every test execution will use the same env defaults across different executions by ignoring your <code>.env.local</code> (which is intended to override the default set).</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: similar to Default Environment Variables, <code>.env.test</code> file should be included in your repository, but <code>.env.test.local</code> shouldn't, as <code>.env*.local</code> are intended to be ignored through <code>.gitignore</code>.</p> </blockquote> <p>While running unit tests you can make sure to load your environment variables the same way Next.js does by leveraging the <code>loadEnvConfig</code> function from the <code>@next/env</code> package.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// The below can be used in a Jest global setup file or similar for your testing set-up\nimport { loadEnvConfig } from '@next/env'\n \nexport default async () =&gt; {\n  const projectDir = process.cwd()\n  loadEnvConfig(projectDir)\n}</pre>\n</div> <h2 id=\"environment-variable-load-order\" data-docs-heading=\"\">Environment Variable Load Order     </h2> <p>Environment variables are looked up in the following places, in order, stopping once the variable is found.</p> <ol> <li><code>process.env</code></li> <li><code>.env.$(NODE_ENV).local</code></li> <li>\n<code>.env.local</code> (Not checked when <code>NODE_ENV</code> is <code>test</code>.)</li> <li><code>.env.$(NODE_ENV)</code></li> <li><code>.env</code></li> </ol> <p>For example, if <code>NODE_ENV</code> is <code>development</code> and you define a variable in both <code>.env.development.local</code> and <code>.env</code>, the value in <code>.env.development.local</code> will be used.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The allowed values for <code>NODE_ENV</code> are <code>production</code>, <code>development</code> and <code>test</code>.</p> </blockquote> <h2 id=\"good-to-know\" data-docs-heading=\"\">Good to know     </h2> <ul> <li>If you are using a <a href=\"src-directory\"><code>/src</code> directory</a>, <code>.env.*</code> files should remain in the root of your project.</li> <li>If the environment variable <code>NODE_ENV</code> is unassigned, Next.js automatically assigns <code>development</code> when running the <code>next dev</code> command, or <code>production</code> for all other commands.</li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v9.4.0</code></td>\n<td>Support <code>.env</code> and <code>NEXT_PUBLIC_</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring/environment-variables\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring/environment-variables</a>\n  </p>\n</div>\n","app/building-your-application/configuring/src-directory":"<h1 class=\"break-words\">src Directory</h1> <p>As an alternative to having the special Next.js <code>app</code> or <code>pages</code> directories in the root of your project, Next.js also supports the common pattern of placing application code under the <code>src</code> directory.</p> <p>This separates application code from project configuration files which mostly live in the root of a project, which is preferred by some individuals and teams.</p> <p>To use the <code>src</code> directory, move the <code>app</code> Router folder or <code>pages</code> Router folder to <code>src/app</code> or <code>src/pages</code> respectively.</p> <figure><img alt=\"An example folder structure with the `src` directory\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure with the `src` directory\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75\"></figure> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>The <code>/public</code> directory should remain in the root of your project.</li> <li>Config files like <code>package.json</code>, <code>next.config.js</code> and <code>tsconfig.json</code> should remain in the root of your project.</li> <li>\n<code>.env.*</code> files should remain in the root of your project.</li> <li>\n<code>src/app</code> or <code>src/pages</code> will be ignored if <code>app</code> or <code>pages</code> are present in the root directory.</li> <li>If you're using <code>src</code>, you'll probably also move other application folders such as <code>/components</code> or <code>/lib</code>.</li> <li>If you're using Middleware, ensure it is placed inside the <code>src</code> directory.</li> <li>If you're using Tailwind CSS, you'll need to add the <code>/src</code> prefix to the <code>tailwind.config.js</code> file in the <a href=\"https://tailwindcss.com/docs/content-configuration\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">content section</a>.</li> <li>If you are using TypeScript paths for imports such as <code>@/*</code>, you should update the <code>paths</code> object in <code>tsconfig.json</code> to include <code>src/</code>.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring/src-directory\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring/src-directory</a>\n  </p>\n</div>\n","app/building-your-application/testing/vitest":"<h1 class=\"break-words\">Setting up Vitest with Next.js</h1>\n<p>Vite and React Testing Library are frequently used together for <strong>Unit Testing</strong>. This guide will show you how to setup Vitest with Next.js and write your first tests.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> Since <code>async</code> Server Components are new to the React ecosystem, Vitest currently does not support them. While you can still run <strong>unit tests</strong> for synchronous Server and Client Components, we recommend using an <strong>E2E tests</strong> for <code>async</code> components.</p> </blockquote> <h2 id=\"quickstart\" data-docs-heading=\"\">Quickstart     </h2> <p>You can use <code>create-next-app</code> with the Next.js <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-vitest\" rel=\"noopener noreferrer\" target=\"_blank\">with-vitest</a> example to quickly get started:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest --example with-vitest with-vitest-app</pre></div> <h2 id=\"manual-setup\" data-docs-heading=\"\">Manual Setup     </h2> <p>To manually set up Vitest, install <code>vitest</code> and the following packages as dev dependencies:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D vitest @vitejs/plugin-react jsdom @testing-library/react\n# or\nyarn add -D vitest @vitejs/plugin-react jsdom @testing-library/react\n# or\npnpm install -D vitest @vitejs/plugin-react jsdom @testing-library/react\n# or\nbun add -D vitest @vitejs/plugin-react jsdom @testing-library/react</pre></div> <p>Create a <code>vitest.config.ts|js</code> file in the root of your project, and add the following options:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { defineConfig } from 'vitest/config'\nimport react from '@vitejs/plugin-react'\n \nexport default defineConfig({\n  plugins: [react()],\n  test: {\n    environment: 'jsdom',\n  },\n})</pre></div>  <p>For more information on configuring Vitest, please refer to the <a href=\"https://vitest.dev/config/#configuration\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Vitest Configuration</a> docs.</p> <p>Then, add a <code>test</code> script to your <code>package.json</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"test\": \"vitest\"\n  }\n}</pre></div> <p>When you run <code>npm run test</code>, Vitest will <strong>watch</strong> for changes in your project by default.</p> <h2 id=\"creating-your-first-vitest-unit-test\" data-docs-heading=\"\">Creating your first Vitest Unit Test     </h2> <p>Check that everything is working by creating a test to check if the <code>&lt;Page /&gt;</code> component successfully renders a heading:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Home&lt;/h1&gt;\n      &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { expect, test } from 'vitest'\nimport { render, screen } from '@testing-library/react'\nimport Page from '../app/page'\n \ntest('Page', () =&gt; {\n  render(&lt;Page /&gt;)\n  expect(screen.getByRole('heading', { level: 1, name: 'Home' })).toBeDefined()\n})</pre></div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The example above uses the common <code>__tests__</code> convention, but test files can also be colocated inside the <code>app</code> router.</p> </blockquote>  <h2 id=\"running-your-tests\" data-docs-heading=\"\">Running your tests     </h2> <p>Then, run the following command to run your tests:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm run test\n# or\nyarn test\n# or\npnpm test\n# or\nbun test</pre></div> <h2 id=\"additional-resources\" data-docs-heading=\"\">Additional Resources     </h2> <p>You may find these resources helpful:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-vitest\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with Vitest example</a></li> <li><a href=\"https://vitest.dev/guide/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Vitest Docs</a></li> <li><a href=\"https://testing-library.com/docs/react-testing-library/intro/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Testing Library Docs</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/testing/vitest\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/testing/vitest</a>\n  </p>\n</div>\n","app/building-your-application/authentication":"<h1 class=\"break-words\">Authentication</h1>\n<p>To implement authentication in Next.js, familiarize yourself with three foundational concepts:</p> <ul> <li>\n<strong><a href=\"#authentication\">Authentication</a></strong> verifies if the user is who they say they are. It requires the user to prove their identity with something they have, such as a username and password.</li> <li>\n<strong><a href=\"#session-management\">Session Management</a></strong> tracks the user's state (e.g. logged in) across multiple requests.</li> <li>\n<strong><a href=\"#authorization\">Authorization</a></strong> decides what parts of the application the user is allowed to access.</li> </ul> <p>This page demonstrates how to use Next.js features to implement common authentication, authorization, and session management patterns so you can choose the best solutions based on your application's needs.</p> <h2 id=\"authentication\" data-docs-heading=\"\">Authentication     </h2> <p>Authentication verifies a user's identity. This happens when a user logs in, either with a username and password or through a service like Google. It's all about confirming that users are really who they claim to be, protecting both the user's data and the application from unauthorized access or fraudulent activities.</p> <h3 id=\"authentication-strategies\" data-docs-heading=\"\">Authentication Strategies     </h3> <p>Modern web applications commonly use several authentication strategies:</p> <ol> <li>\n<strong>OAuth/OpenID Connect (OIDC)</strong>: Enable third-party access without sharing user credentials. Ideal for social media logins and Single Sign-On (SSO) solutions. They add an identity layer with OpenID Connect.</li> <li>\n<strong>Credentials-based login (Email + Password)</strong>: A standard choice for web applications, where users log in with an email and password. Familiar and easy to implement, it requires robust security measures against threats like phishing.</li> <li>\n<strong>Passwordless/Token-based authentication</strong>: Use email magic links or SMS one-time codes for secure, password-free access. Popular for its convenience and enhanced security, this method helps reduce password fatigue. Its limitation is the dependency on the user's email or phone availability.</li> <li>\n<strong>Passkeys/WebAuthn</strong>: Use cryptographic credentials unique to each site, offering high security against phishing. Secure but new, this strategy can be difficult to implement.</li> </ol> <p>Selecting an authentication strategy should align with your application's specific requirements, user interface considerations, and security objectives.</p> <h3 id=\"implementing-authentication\" data-docs-heading=\"\">Implementing Authentication     </h3> <p>In this section, we'll explore the process of adding basic email-password authentication to a web application. While this method provides a fundamental level of security, it's worth considering more advanced options like OAuth or passwordless logins for enhanced protection against common security threats. The authentication flow we'll discuss is as follows:</p>  <ol> <li>The user submits their credentials through a login form.</li> <li>The form calls a Server Action.</li> <li>Upon successful verification, the process is completed, indicating the user's successful authentication.</li> <li>If verification is unsuccessful, an error message is shown.</li> </ol>\n<p>Consider a login form where users can input their credentials:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { authenticate } from '@/app/lib/actions'\n \nexport default function Page() {\n  return (\n    &lt;form action={authenticate}&gt;\n      &lt;input type=\"email\" name=\"email\" placeholder=\"Email\" required /&gt;\n      &lt;input type=\"password\" name=\"password\" placeholder=\"Password\" required /&gt;\n      &lt;button type=\"submit\"&gt;Login&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre></div>\n<p>The form above has two input fields for capturing the user's email and password. On submission, it calls the <code>authenticate</code> Server Action.</p>\n<p>You can then call your Authentication Provider's API in the Server Action to handle authentication:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { signIn } from '@/auth'\n \nexport async function authenticate(_currentState: unknown, formData: FormData) {\n  try {\n    await signIn('credentials', formData)\n  } catch (error) {\n    if (error) {\n      switch (error.type) {\n        case 'CredentialsSignin':\n          return 'Invalid credentials.'\n        default:\n          return 'Something went wrong.'\n      }\n    }\n    throw error\n  }\n}</pre></div> <p>In this code, the <code>signIn</code> method checks the credentials against stored user data. After the authentication provider processes the credentials, there are two possible outcomes:</p> <ul> <li>\n<strong>Successful Authentication</strong>: This outcome implies that the login was successful. Further actions, such as accessing protected routes and fetching user information, can then be initiated.</li> <li>\n<strong>Failed Authentication</strong>: In cases where the credentials are incorrect or an error is encountered, the function returns a corresponding error message to indicate the authentication failure.</li> </ul> <p>Finally, in your <code>login-form.tsx</code> component, you can use React's <code>useFormState</code> to call the Server Action and handle form errors, and use <code>useFormStatus</code> to handle the pending state of the form:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { authenticate } from '@/app/lib/actions'\nimport { useFormState, useFormStatus } from 'react-dom'\n \nexport default function Page() {\n  const [errorMessage, dispatch] = useFormState(authenticate, undefined)\n \n  return (\n    &lt;form action={dispatch}&gt;\n      &lt;input type=\"email\" name=\"email\" placeholder=\"Email\" required /&gt;\n      &lt;input type=\"password\" name=\"password\" placeholder=\"Password\" required /&gt;\n      &lt;div&gt;{errorMessage &amp;&amp; &lt;p&gt;{errorMessage}&lt;/p&gt;}&lt;/div&gt;\n      &lt;LoginButton /&gt;\n    &lt;/form&gt;\n  )\n}\n \nfunction LoginButton() {\n  const { pending } = useFormStatus()\n \n  const handleClick = (event) =&gt; {\n    if (pending) {\n      event.preventDefault()\n    }\n  }\n \n  return (\n    &lt;button aria-disabled={pending} type=\"submit\" onClick={handleClick}&gt;\n      Login\n    &lt;/button&gt;\n  )\n}</pre></div> <p>For a more streamlined authentication setup in Next.js projects, especially when offering multiple login methods, consider using a comprehensive <a href=\"#examples\">authentication solution</a>.</p> <h2 id=\"authorization\" data-docs-heading=\"\">Authorization     </h2> <p>Once a user is authenticated, you'll need to ensure the user is allowed to visit certain routes, and perform operations such as mutating data with Server Actions and calling Route Handlers.</p> <h3 id=\"protecting-routes-with-middleware\" data-docs-heading=\"\">Protecting Routes with Middleware     </h3> <p><a href=\"routing/middleware\">Middleware</a> in Next.js helps you control who can access different parts of your website. This is important for keeping areas like the user dashboard protected while having other pages like marketing pages be public. It's recommended to apply Middleware across all routes and specify exclusions for public access.</p> <p>Here's how to implement Middleware for authentication in Next.js:</p> <h4 id=\"setting-up-middleware\" data-docs-heading=\"\">Setting Up Middleware:     </h4> <ul> <li>Create a <code>middleware.ts</code> or <code>.js</code> file in your project's root directory.</li> <li>Include logic to authorize user access, such as checking for authentication tokens.</li> </ul> <h4 id=\"defining-protected-routes\" data-docs-heading=\"\">Defining Protected Routes:     </h4> <ul> <li>Not all routes require authorization. Use the <code>matcher</code> option in your Middleware to specify any routes that do not require authorization checks.</li> </ul> <h4 id=\"middleware-logic\" data-docs-heading=\"\">Middleware Logic:     </h4> <ul> <li>Write logic to verify if a user is authenticated. Check user roles or permissions for route authorization.</li> </ul> <h4 id=\"handling-unauthorized-access\" data-docs-heading=\"\">Handling Unauthorized Access:     </h4> <ul> <li>Redirect unauthorized users to a login or error page as appropriate.</li> </ul> <p>Example Middleware file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  const currentUser = request.cookies.get('currentUser')?.value\n \n  if (currentUser &amp;&amp; !request.nextUrl.pathname.startsWith('/dashboard')) {\n    return Response.redirect(new URL('/dashboard', request.url))\n  }\n \n  if (!currentUser &amp;&amp; !request.nextUrl.pathname.startsWith('/login')) {\n    return Response.redirect(new URL('/login', request.url))\n  }\n}\n \nexport const config = {\n  matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)'],\n}</pre></div>  <p>This example uses <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Response/redirect_static\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Response.redirect</code></a> for handling redirects early in the request pipeline, making it efficient and centralizing access control.</p> <p>For specific redirection needs, the <code>redirect</code> function can be used in Server Components, Route Handlers, and Server Actions to provide more control. This is useful for role-based navigation or context-sensitive scenarios.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { redirect } from 'next/navigation'\n \nexport default function Page() {\n  // Logic to determine if a redirect is needed\n  const accessDenied = true\n  if (accessDenied) {\n    redirect('/login')\n  }\n \n  // Define other routes and logic\n}</pre></div> <p>After successful authentication, it's important to manage user navigation based on their roles. For example, an admin user might be redirected to an admin dashboard, while a regular user is sent to a different page. This is important for role-specific experiences and conditional navigation, such as prompting users to complete their profile if needed.</p> <p>When setting up authorization, it's important to ensure that the main security checks happen where your app accesses or changes data. While Middleware can be useful for initial validation, it should not be the sole line of defense in protecting your data. The bulk of security checks should be performed in the Data Access Layer (DAL).</p>  <p>This approach, highlighted in <a href=\"https://nextjs.org/blog/security-nextjs-server-components-actions\">this security blog</a>, advocates for consolidating all data access within a dedicated DAL. This strategy ensures consistent data access, minimizes authorization bugs, and simplifies maintenance. To ensure comprehensive security, consider the following key areas:</p>\n<ul> <li>Server Actions: Implement security checks in server-side processes, especially for sensitive operations.</li> <li>Route Handlers: Manage incoming requests with security measures to ensure access is limited to authorized users.</li> <li>Data Access Layer (DAL): Directly interacts with the database and is crucial for validating and authorizing data transactions. It's vital to perform critical checks within the DAL to secure data at its most crucial interaction pointaccess or modification.</li> </ul>\n<p>For a detailed guide on securing the DAL, including example code snippets and advanced security practices, refer to our <a href=\"https://nextjs.org/blog/security-nextjs-server-components-actions#data-access-layer\">Data Access Layer section</a> of the security guide.</p>\n<h3 id=\"protecting-server-actions\" data-docs-heading=\"\">Protecting Server Actions     </h3>\n<p>It is important to treat <a href=\"data-fetching/server-actions-and-mutations\">Server Actions</a> with the same security considerations as public-facing API endpoints. Verifying user authorization for each action is crucial. Implement checks within Server Actions to determine user permissions, such as restricting certain actions to admin users.</p>\n<p>In the example below, we check the user's role before allowing the action to proceed:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \n// ...\n \nexport async function serverAction() {\n  const session = await getSession()\n  const userRole = session?.user?.role\n \n  // Check if user is authorized to perform the action\n  if (userRole !== 'admin') {\n    throw new Error('Unauthorized access: User does not have admin privileges.')\n  }\n \n  // Proceed with the action for authorized users\n  // ... implementation of the action\n}</pre></div>\n<h3 id=\"protecting-route-handlers\" data-docs-heading=\"\">Protecting Route Handlers     </h3>\n<p>Route Handlers in Next.js play a vital role in managing incoming requests. Just like Server Actions, they should be secured to ensure that only authorized users can access certain functionalities. This often involves verifying the user's authentication status and their permissions.</p>\n<p>Here's an example of securing a Route Handler:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET() {\n  // User authentication and role verification\n  const session = await getSession()\n \n  // Check if the user is authenticated\n  if (!session) {\n    return new Response(null, { status: 401 }) // User is not authenticated\n  }\n \n  // Check if the user has the 'admin' role\n  if (session.user.role !== 'admin') {\n    return new Response(null, { status: 403 }) // User is authenticated but does not have the right permissions\n  }\n \n  // Data fetching for authorized users\n}</pre></div>\n<p>This example demonstrates a Route Handler with a two-tier security check for authentication and authorization. It first checks for an active session, and then verifies if the logged-in user is an 'admin'. This approach ensures secure access, limited to authenticated and authorized users, maintaining robust security for request processing.</p>\n<h3 id=\"authorization-using-server-components\" data-docs-heading=\"\">Authorization Using Server Components     </h3>\n<p><a href=\"rendering/server-components\">Server Components</a> in Next.js are designed for server-side execution and offer a secure environment for integrating complex logic like authorization. They enable direct access to back-end resources, optimizing performance for data-heavy tasks and enhancing security for sensitive operations.</p>\n<p>In Server Components, a common practice is to conditionally render UI elements based on the user's role. This approach enhances user experience and security by ensuring users only access content they are authorized to view.</p>\n<p><strong>Example:</strong></p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function Dashboard() {\n  const session = await getSession()\n  const userRole = session?.user?.role // Assuming 'role' is part of the session object\n \n  if (userRole === 'admin') {\n    return &lt;AdminDashboard /&gt; // Component for admin users\n  } else if (userRole === 'user') {\n    return &lt;UserDashboard /&gt; // Component for regular users\n  } else {\n    return &lt;AccessDenied /&gt; // Component shown for unauthorized access\n  }\n}</pre></div>\n<p>In this example, the Dashboard component renders different UIs for 'admin', 'user', and unauthorized roles. This pattern ensures that each user interacts only with components appropriate to their role, enhancing both security and user experience.</p> <h3 id=\"best-practices\" data-docs-heading=\"\">Best Practices     </h3> <ul> <li>\n<strong>Secure Session Management</strong>: Prioritize the security of session data to prevent unauthorized access and data breaches. Use encryption and secure storage practices.</li> <li>\n<strong>Dynamic Role Management</strong>: Use a flexible system for user roles to easily adjust to changes in permissions and roles, avoiding hardcoded roles.</li> <li>\n<strong>Security-First Approach</strong>: In all aspects of authorization logic, prioritize security to safeguard user data and maintain the integrity of your application. This includes thorough testing and considering potential security vulnerabilities.</li> </ul> <h2 id=\"session-management\" data-docs-heading=\"\">Session Management     </h2> <p>Session management involves tracking and managing a user's interaction with the application over time, ensuring that their authenticated state is preserved across different parts of the application.</p> <p>This prevents the need for repeated logins, enhancing both security and user convenience. There are two primary methods used for session management: cookie-based and database sessions.</p> <h3 id=\"cookie-based-sessions\" data-docs-heading=\"\">Cookie-Based Sessions     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn more about cookie-based sessions and authentication with Next.js  <a href=\"https://www.youtube.com/watch?v=DJvM2lSPn6w\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (11 minutes)</a>.</p> </blockquote> <p>Cookie-based sessions manage user data by storing encrypted session information directly in browser cookies. Upon user login, this encrypted data is stored in the cookie. Each subsequent server request includes this cookie, minimizing the need for repeated server queries and enhancing client-side efficiency.</p> <p>However, this method requires careful encryption to protect sensitive data, as cookies are susceptible to client-side security risks. Encrypting session data in cookies is key to safeguarding user information from unauthorized access. It ensures that even if a cookie is stolen, the data inside remains unreadable.</p> <p>Additionally, while individual cookies are limited in size (typically around 4KB), techniques like cookie-chunking can overcome this limitation by dividing large session data into multiple cookies.</p> <p>Setting a cookie in a Next.js project might look something like this:</p> <p><strong>Setting a cookie on the server:</strong></p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { cookies } from 'next/headers'\n \nexport async function handleLogin(sessionData) {\n  const encryptedSessionData = encrypt(sessionData) // Encrypt your session data\n  cookies().set('session', encryptedSessionData, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    maxAge: 60 * 60 * 24 * 7, // One week\n    path: '/',\n  })\n  // Redirect or handle the response after setting the cookie\n}</pre></div>\n<p><strong>Accessing the session data stored in the cookie in a server component:</strong></p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cookies } from 'next/headers'\n \nexport async function getSessionData(req) {\n  const encryptedSessionData = cookies().get('session')?.value\n  return encryptedSessionData ? JSON.parse(decrypt(encryptedSessionData)) : null\n}</pre></div> <h3 id=\"database-sessions\" data-docs-heading=\"\">Database Sessions     </h3> <p>Database session management involves storing session data on the server, with the user's browser only receiving a session ID. This ID references the session data stored server-side, without containing the data itself. This method enhances security, as it keeps sensitive session data away from the client-side environment, reducing the risk of exposure to client-side attacks. Database sessions are also more scalable, accommodating larger data storage needs.</p> <p>However, this approach has its tradeoffs. It can increase performance overhead due to the need for database lookups at each user interaction. Strategies like session data caching can help mitigate this. Additionally, reliance on the database means that session management is as reliable as the database's performance and availability.</p> <p>Here's a simplified example of implementing database sessions in a Next.js application:</p> <p><strong>Creating a Session on the Server</strong>:</p>  <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import db from './lib/db'\n \nexport async function createSession(user) {\n  const sessionId = generateSessionId() // Generate a unique session ID\n  await db.insertSession({ sessionId, userId: user.id, createdAt: new Date() })\n  return sessionId\n}</pre>\n</div>\n<p><strong>Retrieving a Session in Middleware or Server-Side Logic</strong>:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cookies } from 'next/headers'\nimport db from './lib/db'\n \nexport async function getSession() {\n  const sessionId = cookies().get('sessionId')?.value\n  return sessionId ? await db.findSession(sessionId) : null\n}</pre>\n</div> <h3 id=\"selecting-session-management-in-nextjs\" data-docs-heading=\"\">Selecting Session Management in Next.js     </h3> <p>Deciding between cookie-based and database sessions in Next.js depends on your application's needs. Cookie-based sessions are simpler and suit smaller applications with lower server load but may offer less security. Database sessions, while more complex, provide better security and scalability, ideal for larger, data-sensitive applications.</p> <p>With <a href=\"#examples\">authentication solutions</a> such as <a href=\"https://authjs.dev/guides/upgrade-to-v5\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">NextAuth.js</a>, session management becomes more efficient, using either cookies or database storage. This automation simplifies the development process, but it's important to understand the session management method used by your chosen solution. Ensure it aligns with your application's security and performance requirements.</p> <p>Regardless of your choice, prioritize security in your session management strategy. For cookie-based sessions, using secure and HTTP-only cookies is crucial to protect session data. For database sessions, regular backups and secure handling of session data are essential. Implementing session expiry and cleanup mechanisms is vital in both approaches to prevent unauthorized access and maintain application performance and reliability.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <p>Here are authentication solutions compatible with Next.js, please refer to the quickstart guides below to learn how to configure them in your Next.js application:</p>  <ul> <li><a href=\"https://auth0.com/docs/quickstart/webapp/nextjs/01-login\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Auth0</a></li> <li><a href=\"https://clerk.com/docs/quickstarts/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Clerk</a></li> <li><a href=\"https://kinde.com/docs/developer-tools/nextjs-sdk\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Kinde</a></li> <li><a href=\"https://lucia-auth.com/getting-started/nextjs-app\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Lucia</a></li> <li><a href=\"https://authjs.dev/guides/upgrade-to-v5\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">NextAuth.js</a></li> <li><a href=\"https://supabase.com/docs/guides/getting-started/quickstarts/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Supabase</a></li> <li><a href=\"https://stytch.com/docs/guides/quickstarts/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Stytch</a></li> <li><a href=\"https://github.com/vvo/iron-session\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Iron Session</a></li> </ul> <h2 id=\"further-reading\" data-docs-heading=\"\">Further Reading     </h2> <p>To continue learning about authentication and security, check out the following resources:</p> <ul> <li><a href=\"https://vercel.com/guides/understanding-xss-attacks\" rel=\"noopener noreferrer\" target=\"_blank\">Understanding XSS Attacks</a></li> <li><a href=\"https://vercel.com/guides/understanding-csrf-attacks\" rel=\"noopener noreferrer\" target=\"_blank\">Understanding CSRF Attacks</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/authentication\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/authentication</a>\n  </p>\n</div>\n","app/building-your-application/configuring/mdx":"<h1 class=\"break-words\">Markdown and MDX</h1> <p><a href=\"https://daringfireball.net/projects/markdown/syntax\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Markdown</a> is a lightweight markup language used to format text. It allows you to write using plain text syntax and convert it to structurally valid HTML. It's commonly used for writing content on websites and blogs.</p> <p>You write...</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">I **love** using [Next.js](https://nextjs.org/)</pre>\n</div> <p>Output:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;p&gt;I &lt;strong&gt;love&lt;/strong&gt; using &lt;a href=\"https://nextjs.org/\"&gt;Next.js&lt;/a&gt;&lt;/p&gt;</pre>\n</div> <p><a href=\"https://mdxjs.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDX</a> is a superset of markdown that lets you write <a href=\"https://react.dev/learn/writing-markup-with-jsx\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">JSX</a> directly in your markdown files. It is a powerful way to add dynamic interactivity and embed React components within your content.</p> <p>Next.js can support both local MDX content inside your application, as well as remote MDX files fetched dynamically on the server. The Next.js plugin handles transforming markdown and React components into HTML, including support for usage in Server Components (the default in App Router).</p> <h2 id=\"nextmdx\" data-docs-heading=\"\">@next/mdx     </h2> <p>The <code>@next/mdx</code> package is used to configure Next.js so it can process markdown and MDX. <strong>It sources data from local files</strong>, allowing you to create pages with a <code>.mdx</code> extension, directly in your <code>/pages</code> or <code>/app</code> directory.</p> <p>Let's walk through how to configure and use MDX with Next.js.</p> <h2 id=\"getting-started\" data-docs-heading=\"\">Getting Started     </h2> <p>Install packages needed to render MDX:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @next/mdx @mdx-js/loader @mdx-js/react @types/mdx</pre></div> <p>Create a <code>mdx-components.tsx</code> file at the root of your application (<code>src/</code> or the parent folder of <code>app/</code>):</p>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>mdx-components.tsx</code> is required to use MDX with App Router and will not work without it.</p> </blockquote>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { MDXComponents } from 'mdx/types'\n \nexport function useMDXComponents(components: MDXComponents): MDXComponents {\n  return {\n    ...components,\n  }\n}</pre></div> <p>Update the <code>next.config.js</code> file at your project's root to configure it to use MDX:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const withMDX = require('@next/mdx')()\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Configure `pageExtensions` to include MDX files\n  pageExtensions: ['js', 'jsx', 'mdx', 'ts', 'tsx'],\n  // Optionally, add any other Next.js config below\n}\n \nmodule.exports = withMDX(nextConfig)</pre></div> <p>Then, create a new MDX page within the <code>/app</code> directory:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">  your-project\n   app\n      my-mdx-page\n          page.mdx\n   package.json</pre>\n</div>  <p>Now you can use markdown and import React components directly inside your MDX page:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { MyComponent } from 'my-components'\n \n# Welcome to my MDX page!\n \nThis is some **bold** and _italics_ text.\n \nThis is a list in markdown:\n \n- One\n- Two\n- Three\n \nCheckout my React component:\n \n&lt;MyComponent /&gt;</pre>\n</div> <p>Navigating to the <code>/my-mdx-page</code> route should display your rendered MDX.</p> <h2 id=\"remote-mdx\" data-docs-heading=\"\">Remote MDX     </h2> <p>If your markdown or MDX files or content lives <em>somewhere else</em>, you can fetch it dynamically on the server. This is useful for content stored in a separate local folder, CMS, database, or anywhere else. A popular community package for this use is <a href=\"https://github.com/hashicorp/next-mdx-remote#react-server-components-rsc--nextjs-app-directory-support\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>next-mdx-remote</code></a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Please proceed with caution. MDX compiles to JavaScript and is executed on the server. You should only fetch MDX content from a trusted source, otherwise this can lead to remote code execution (RCE).</p> </blockquote> <p>The following example uses <code>next-mdx-remote</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { MDXRemote } from 'next-mdx-remote/rsc'\n \nexport default async function RemoteMdxPage() {\n  // MDX text - can be from a local file, database, CMS, fetch, anywhere...\n  const res = await fetch('https://...')\n  const markdown = await res.text()\n  return &lt;MDXRemote source={markdown} /&gt;\n}</pre></div>  <p>Navigating to the <code>/my-mdx-page-remote</code> route should display your rendered MDX.</p> <h2 id=\"layouts\" data-docs-heading=\"\">Layouts     </h2> <p>To share a layout across MDX pages, you can use the <a href=\"../routing/pages-and-layouts#layouts\">built-in layouts support</a> with the App Router.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function MdxLayout({ children }: { children: React.ReactNode }) {\n  // Create any shared layout or styles here\n  return &lt;div style={{ color: 'blue' }}&gt;{children}&lt;/div&gt;\n}</pre></div>  <h2 id=\"remark-and-rehype-plugins\" data-docs-heading=\"\">Remark and Rehype Plugins     </h2> <p>You can optionally provide <code>remark</code> and <code>rehype</code> plugins to transform the MDX content.</p> <p>For example, you can use <code>remark-gfm</code> to support GitHub Flavored Markdown.</p> <p>Since the <code>remark</code> and <code>rehype</code> ecosystem is ESM only, you'll need to use <code>next.config.mjs</code> as the configuration file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import remarkGfm from 'remark-gfm'\nimport createMDX from '@next/mdx'\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Configure `pageExtensions`` to include MDX files\n  pageExtensions: ['js', 'jsx', 'mdx', 'ts', 'tsx'],\n  // Optionally, add any other Next.js config below\n}\n \nconst withMDX = createMDX({\n  // Add markdown plugins here, as desired\n  options: {\n    remarkPlugins: [remarkGfm],\n    rehypePlugins: [],\n  },\n})\n \n// Wrap MDX and Next.js config with each other\nexport default withMDX(nextConfig)</pre></div> <h2 id=\"frontmatter\" data-docs-heading=\"\">Frontmatter     </h2> <p>Frontmatter is a YAML like key/value pairing that can be used to store data about a page. <code>@next/mdx</code> does <strong>not</strong> support frontmatter by default, though there are many solutions for adding frontmatter to your MDX content, such as:</p> <ul> <li><a href=\"https://github.com/remarkjs/remark-frontmatter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">remark-frontmatter</a></li> <li><a href=\"https://github.com/remcohaszing/remark-mdx-frontmatter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">remark-mdx-frontmatter</a></li> <li>\n<a href=\"https://github.com/jonschlinkert/gray-matter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">gray-matter</a>.</li> </ul> <p>To access page metadata with <code>@next/mdx</code>, you can export a metadata object from within the <code>.mdx</code> file:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  author: 'John Doe',\n}\n \n# My MDX page</pre>\n</div> <h2 id=\"custom-elements\" data-docs-heading=\"\">Custom Elements     </h2> <p>One of the pleasant aspects of using markdown, is that it maps to native <code>HTML</code> elements, making writing fast, and intuitive:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">This is a list in markdown:\n \n- One\n- Two\n- Three</pre>\n</div> <p>The above generates the following <code>HTML</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;p&gt;This is a list in markdown:&lt;/p&gt;\n \n&lt;ul&gt;\n  &lt;li&gt;One&lt;/li&gt;\n  &lt;li&gt;Two&lt;/li&gt;\n  &lt;li&gt;Three&lt;/li&gt;\n&lt;/ul&gt;</pre>\n</div> <p>When you want to style your own elements for a custom feel to your website or application, you can pass in shortcodes. These are your own custom components that map to <code>HTML</code> elements.</p> <p>To do this, open the <code>mdx-components.tsx</code> file at the root of your application and add custom elements:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { MDXComponents } from 'mdx/types'\nimport Image, { ImageProps } from 'next/image'\n \n// This file allows you to provide custom React components\n// to be used in MDX files. You can import and use any\n// React component you want, including inline styles,\n// components from other libraries, and more.\n \nexport function useMDXComponents(components: MDXComponents): MDXComponents {\n  return {\n    // Allows customizing built-in components, e.g. to add styling.\n    h1: ({ children }) =&gt; &lt;h1 style={{ fontSize: '100px' }}&gt;{children}&lt;/h1&gt;,\n    img: (props) =&gt; (\n      &lt;Image\n        sizes=\"100vw\"\n        style={{ width: '100%', height: 'auto' }}\n        {...(props as ImageProps)}\n      /&gt;\n    ),\n    ...components,\n  }\n}</pre></div>  <h2 id=\"deep-dive-how-do-you-transform-markdown-into-html\" data-docs-heading=\"\">Deep Dive: How do you transform markdown into HTML?     </h2> <p>React does not natively understand markdown. The markdown plaintext needs to first be transformed into HTML. This can be accomplished with <code>remark</code> and <code>rehype</code>.</p> <p><code>remark</code> is an ecosystem of tools around markdown. <code>rehype</code> is the same, but for HTML. For example, the following code snippet transforms markdown into HTML:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { unified } from 'unified'\nimport remarkParse from 'remark-parse'\nimport remarkRehype from 'remark-rehype'\nimport rehypeSanitize from 'rehype-sanitize'\nimport rehypeStringify from 'rehype-stringify'\n \nmain()\n \nasync function main() {\n  const file = await unified()\n    .use(remarkParse) // Convert into markdown AST\n    .use(remarkRehype) // Transform to HTML AST\n    .use(rehypeSanitize) // Sanitize HTML input\n    .use(rehypeStringify) // Convert AST into serialized HTML\n    .process('Hello, Next.js!')\n \n  console.log(String(file)) // &lt;p&gt;Hello, Next.js!&lt;/p&gt;\n}</pre>\n</div> <p>The <code>remark</code> and <code>rehype</code> ecosystem contains plugins for <a href=\"https://github.com/atomiks/rehype-pretty-code\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">syntax highlighting</a>, <a href=\"https://github.com/rehypejs/rehype-autolink-headings\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">linking headings</a>, <a href=\"https://github.com/remarkjs/remark-toc\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">generating a table of contents</a>, and more.</p> <p>When using <code>@next/mdx</code> as shown above, you <strong>do not</strong> need to use <code>remark</code> or <code>rehype</code> directly, as it is handled for you. We're describing it here for a deeper understanding of what the <code>@next/mdx</code> package is doing underneath.</p> <h2 id=\"using-the-rust-based-mdx-compiler-experimental\" data-docs-heading=\"\">Using the Rust-based MDX compiler (Experimental)     </h2> <p>Next.js supports a new MDX compiler written in Rust. This compiler is still experimental and is not recommended for production use. To use the new compiler, you need to configure <code>next.config.js</code> when you pass it to <code>withMDX</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = withMDX({\n  experimental: {\n    mdxRs: true,\n  },\n})</pre></div> <h2 id=\"helpful-links\" data-docs-heading=\"\">Helpful Links     </h2> <ul> <li><a href=\"https://mdxjs.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDX</a></li> <li><a href=\"https://www.npmjs.com/package/@next/mdx\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@next/mdx</code></a></li> <li><a href=\"https://github.com/remarkjs/remark\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">remark</a></li> <li><a href=\"https://github.com/rehypejs/rehype\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">rehype</a></li> <li><a href=\"https://markdoc.dev/docs/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Markdoc</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/configuring/mdx\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/configuring/mdx</a>\n  </p>\n</div>\n","app/building-your-application/deploying":"<h1 class=\"break-words\">Deploying</h1> <p>Congratulations, it's time to ship to production.</p> <p>You can deploy <a href=\"#managed-nextjs-with-vercel\">managed Next.js with Vercel</a>, or self-host on a Node.js server, Docker image, or even static HTML files. When deploying using <code>next start</code>, all Next.js features are supported.</p> <h2 id=\"production-builds\" data-docs-heading=\"\">Production Builds     </h2> <p>Running <code>next build</code> generates an optimized version of your application for production. HTML, CSS, and JavaScript files are created based on your pages. JavaScript is <strong>compiled</strong> and browser bundles are <strong>minified</strong> using the <a href=\"../../architecture/nextjs-compiler\">Next.js Compiler</a> to help achieve the best performance and support <a href=\"../../architecture/supported-browsers\">all modern browsers</a>.</p> <p>Next.js produces a standard deployment output used by managed and self-hosted Next.js. This ensures all features are supported across both methods of deployment. In the next major version, we will be transforming this output into our <a href=\"https://vercel.com/docs/build-output-api/v3?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Build Output API specification</a>.</p> <h2 id=\"managed-nextjs-with-vercel\" data-docs-heading=\"\">Managed Next.js with Vercel     </h2> <p><a href=\"https://vercel.com/docs/frameworks/nextjs?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, the creators and maintainers of Next.js, provide managed infrastructure and a developer experience platform for your Next.js applications.</p> <p>Deploying to Vercel is zero-configuration and provides additional enhancements for scalability, availability, and performance globally. However, all Next.js features are still supported when self-hosted.</p> <p>Learn more about <a href=\"https://vercel.com/docs/frameworks/nextjs?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js on Vercel</a> or <a href=\"https://vercel.com/templates/next.js?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">deploy a template for free</a> to try it out.</p> <h2 id=\"self-hosting\" data-docs-heading=\"\">Self-Hosting     </h2> <p>You can self-host Next.js in three different ways:</p> <ul> <li><a href=\"#nodejs-server\">A Node.js server</a></li> <li><a href=\"#docker-image\">A Docker container</a></li> <li><a href=\"#static-html-export\">A static export</a></li> </ul> <h3 id=\"nodejs-server\" data-docs-heading=\"\">Node.js Server     </h3> <p>Next.js can be deployed to any hosting provider that supports Node.js. Ensure your <code>package.json</code> has the <code>\"build\"</code> and <code>\"start\"</code> scripts:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}</pre></div> <p>Then, run <code>npm run build</code> to build your application. Finally, run <code>npm run start</code> to start the Node.js server. This server supports all Next.js features.</p> <h3 id=\"docker-image\" data-docs-heading=\"\">Docker Image     </h3> <p>Next.js can be deployed to any hosting provider that supports <a href=\"https://www.docker.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Docker</a> containers. You can use this approach when deploying to container orchestrators such as <a href=\"https://kubernetes.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Kubernetes</a> or when running inside a container in any cloud provider.</p> <ol> <li>\n<a href=\"https://docs.docker.com/get-docker/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Install Docker</a> on your machine</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-docker\" rel=\"noopener noreferrer\" target=\"_blank\">Clone our example</a> (or the <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-docker-multi-env\" rel=\"noopener noreferrer\" target=\"_blank\">multi-environment example</a>)</li> <li>Build your container: <code>docker build -t nextjs-docker .</code>\n</li> <li>Run your container: <code>docker run -p 3000:3000 nextjs-docker</code>\n</li> </ol> <p>Next.js through Docker supports all Next.js features.</p> <h3 id=\"static-html-export\" data-docs-heading=\"\">Static HTML Export     </h3> <p>Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server.</p> <p>Since Next.js supports this <a href=\"deploying/static-exports\">static export</a>, it can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets. This includes tools like AWS S3, Nginx, or Apache.</p> <p>Running as a <a href=\"deploying/static-exports\">static export</a> does not support Next.js features that require a server. <a href=\"deploying/static-exports#unsupported-features\">Learn more</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>\n<a href=\"rendering/server-components\">Server Components</a> are supported with static exports.</li> </ul> </blockquote> <h2 id=\"features\" data-docs-heading=\"\">Features     </h2> <h3 id=\"image-optimization\" data-docs-heading=\"\">Image Optimization     </h3> <p><a href=\"optimizing/images\">Image Optimization</a> through <code>next/image</code> works self-hosted with zero configuration when deploying using <code>next start</code>. If you would prefer to have a separate service to optimize images, you can <a href=\"optimizing/images#loaders\">configure an image loader</a>.</p> <p>Image Optimization can be used with a <a href=\"deploying/static-exports#image-optimization\">static export</a> by defining a custom image loader in <code>next.config.js</code>. Note that images are optimized at runtime, not during the build.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>When self-hosting, consider installing <code>sharp</code> for more performant <a href=\"../../pages/building-your-application/optimizing/images\">Image Optimization</a> in your production environment by running <code>npm install sharp</code> in your project directory. On Linux platforms, <code>sharp</code> may require <a href=\"https://sharp.pixelplumbing.com/install#linux-memory-allocator\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">additional configuration</a> to prevent excessive memory usage.</li> <li>Learn more about the <a href=\"../api-reference/components/image#caching-behavior\">caching behavior of optimized images</a> and how to configure the TTL.</li> <li>You can also <a href=\"../api-reference/components/image#unoptimized\">disable Image Optimization</a> and still retain other benefits of using <code>next/image</code> if you prefer. For example, if you are optimizing images yourself separately.</li> </ul> </blockquote> <h3 id=\"middleware\" data-docs-heading=\"\">Middleware     </h3> <p><a href=\"routing/middleware\">Middleware</a> works self-hosted with zero configuration when deploying using <code>next start</code>. Since it requires access to the incoming request, it is not supported when using a <a href=\"deploying/static-exports\">static export</a>.</p> <p>Middleware uses a <a href=\"rendering/edge-and-nodejs-runtimes\">runtime</a> that is a subset of all available Node.js APIs to help ensure low latency, since it may run in front of every route or asset in your application. This runtime does not require running at the edge and works in a single-region server. Additional configuration and infrastructure are required to run Middleware in multiple regions.</p> <p>If you are looking to add logic (or use an external package) that requires all Node.js APIs, you might be able to move this logic to a <a href=\"routing/pages-and-layouts#layouts\">layout</a> as a <a href=\"rendering/server-components\">Server Component</a>. For example, checking <a href=\"../api-reference/functions/headers\">headers</a> and <a href=\"../api-reference/functions/redirect\">redirecting</a>. You can also use headers, cookies, or query parameters to <a href=\"../api-reference/next-config-js/redirects#header-cookie-and-query-matching\">redirect</a> or <a href=\"../api-reference/next-config-js/rewrites#header-cookie-and-query-matching\">rewrite</a> through <code>next.config.js</code>. If that does not work, you can also use a <a href=\"../../pages/building-your-application/configuring/custom-server\">custom server</a>.</p> <h3 id=\"environment-variables\" data-docs-heading=\"\">Environment Variables     </h3> <p>Next.js can support both build time and runtime environment variables.</p> <p><strong>By default, environment variables are only available on the server</strong>. To expose an environment variable to the browser, it must be prefixed with <code>NEXT_PUBLIC_</code>. However, these public environment variables will be inlined into the JavaScript bundle during <code>next build</code>.</p> <p>To read runtime environment variables, we recommend using <code>getServerSideProps</code> or <a href=\"upgrading/app-router-migration\">incrementally adopting the App Router</a>. With the App Router, we can safely read environment variables on the server during dynamic rendering. This allows you to use a singular Docker image that can be promoted through multiple environments with different values.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { unstable_noStore as noStore } from 'next/cache';\n \nexport default function Component() {\n  noStore();\n  // cookies(), headers(), and other dynamic functions\n  // will also opt into dynamic rendering, making\n  // this env variable is evaluated at runtime\n  const value = process.env.MY_VALUE\n  ...\n}</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>You can run code on server startup using the <a href=\"optimizing/instrumentation\"><code>register</code> function</a>.</li> <li>We do not recommend using the <a href=\"../../pages/api-reference/next-config-js/runtime-configuration\">runtimeConfig</a> option, as this does not work with the standalone output mode. Instead, we recommend <a href=\"upgrading/app-router-migration\">incrementally adopting</a> the App Router.</li> </ul> </blockquote> <h3 id=\"caching-and-isr\" data-docs-heading=\"\">Caching and ISR     </h3> <p>Next.js can cache responses, generated static pages, build outputs, and other static assets like images, fonts, and scripts.</p> <p>Caching and revalidating pages (using Incremental Static Regeneration (ISR) or newer functions in the App Router) use the <strong>same shared cache</strong>. By default, this cache is stored to the filesystem (on disk) on your Next.js server. <strong>This works automatically when self-hosting</strong> using both the Pages and App Router.</p> <p>You can configure the Next.js cache location if you want to persist cached pages and data to durable storage, or share the cache across multiple containers or instances of your Next.js application.</p> <h4 id=\"automatic-caching\" data-docs-heading=\"\">Automatic Caching     </h4> <ul> <li>Next.js sets the <code>Cache-Control</code> header of <code>public, max-age=31536000, immutable</code> to truly immutable assets. It cannot be overridden. These immutable files contain a SHA-hash in the file name, so they can be safely cached indefinitely. For example, <a href=\"optimizing/images#local-images\">Static Image Imports</a>. You can <a href=\"../api-reference/components/image#caching-behavior\">configure the TTL</a> for images.</li> <li>Incremental Static Regeneration (ISR) sets the <code>Cache-Control</code> header of <code>s-maxage: &lt;revalidate in getStaticProps&gt;, stale-while-revalidate</code>. This revalidation time is defined in your <a href=\"../../pages/building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code> function</a> in seconds. If you set <code>revalidate: false</code>, it will default to a one-year cache duration.</li> <li>Dynamically rendered pages set a <code>Cache-Control</code> header of <code>private, no-cache, no-store, max-age=0, must-revalidate</code> to prevent user-specific data from being cached. This applies to both the App Router and Pages Router. This also includes <a href=\"configuring/draft-mode\">Draft Mode</a>.</li> </ul> <h4 id=\"static-assets\" data-docs-heading=\"\">Static Assets     </h4> <p>If you want to host static assets on a different domain or CDN, you can use the <code>assetPrefix</code> <a href=\"../api-reference/next-config-js/assetprefix\">configuration</a> in <code>next.config.js</code>. Next.js will use this asset prefix when retrieving JavaScript or CSS files. Separating your assets to a different domain does come with the downside of extra time spent on DNS and TLS resolution.</p> <p><a href=\"../api-reference/next-config-js/assetprefix\">Learn more about <code>assetPrefix</code></a>.</p> <h4 id=\"configuring-caching\" data-docs-heading=\"\">Configuring Caching     </h4> <p>By default, generated cache assets will be stored in memory (defaults to 50mb) and on disk. If you are hosting Next.js using a container orchestration platform like Kubernetes, each pod will have a copy of the cache. To prevent stale data from being shown since the cache is not shared between pods by default, you can configure the Next.js cache to provide a cache handler and disable in-memory caching.</p> <p>To configure the ISR/Data Cache location when self-hosting, you can configure a custom handler in your <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  cacheHandler: require.resolve('./cache-handler.js'),\n  cacheMaxMemorySize: 0, // disable default in-memory caching\n}</pre></div> <p>Then, create <code>cache-handler.js</code> in the root of your project, for example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const cache = new Map()\n \nmodule.exports = class CacheHandler {\n  constructor(options) {\n    this.options = options\n  }\n \n  async get(key) {\n    // This could be stored anywhere, like durable storage\n    return cache.get(key)\n  }\n \n  async set(key, data, ctx) {\n    // This could be stored anywhere, like durable storage\n    cache.set(key, {\n      value: data,\n      lastModified: Date.now(),\n      tags: ctx.tags,\n    })\n  }\n \n  async revalidateTag(tag) {\n    // Iterate over all entries in the cache\n    for (let [key, value] of cache) {\n      // If the value's tags include the specified tag, delete this entry\n      if (value.tags.includes(tag)) {\n        cache.delete(key)\n      }\n    }\n  }\n}</pre></div> <p>Using a custom cache handler will allow you to ensure consistency across all pods hosting your Next.js application. For instance, you can save the cached values anywhere, like <a href=\"https://github.com/vercel/next.js/tree/canary/examples/cache-handler-redis\" rel=\"noopener noreferrer\" target=\"_blank\">Redis</a> or AWS S3.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>\n<code>revalidatePath</code> is a convenience layer on top of cache tags. Calling <code>revalidatePath</code> will call the <code>revalidateTag</code> function with a special default tag for the provided page.</li> </ul> </blockquote> <h3 id=\"build-cache\" data-docs-heading=\"\">Build Cache     </h3> <p>Next.js generates an ID during <code>next build</code> to identify which version of your application is being served. The same build should be used and boot up multiple containers.</p> <p>If you are rebuilding for each stage of your environment, you will need to generate a consistent build ID to use between containers. Use the <code>generateBuildId</code> command in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  generateBuildId: async () =&gt; {\n    // This could be anything, using the latest git hash\n    return process.env.GIT_HASH\n  },\n}</pre></div> <h3 id=\"version-skew\" data-docs-heading=\"\">Version Skew     </h3> <p>Next.js will automatically mitigate most instances of <a href=\"https://www.industrialempathy.com/posts/version-skew/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">version skew</a> and automatically reload the application to retrieve new assets when detected. For example, if there is a mismatch in the <code>deploymentId</code>, transitions between pages will perform a hard navigation versus using a prefetched value.</p> <p>When the application is reloaded, there may be a loss of application state if it's not designed to persist between page navigations. For example, using URL state or local storage would persist state after a page refresh. However, component state like <code>useState</code> would be lost in such navigations.</p> <p>Vercel provides additional <a href=\"https://vercel.com/docs/deployments/skew-protection?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">skew protection</a> for Next.js applications to ensure assets and functions from the previous version are still available to older clients, even after the new version is deployed.</p> <p>You can manually configure the <code>deploymentId</code> property in your <code>next.config.js</code> file to ensure each request uses either <code>?dpl</code> query string or <code>x-deployment-id</code> header.</p> <h3 id=\"streaming-and-suspense\" data-docs-heading=\"\">Streaming and Suspense     </h3>\n<p>The Next.js App Router supports <a href=\"routing/loading-ui-and-streaming\">streaming responses</a> when self-hosting. If you are using Nginx or a similar proxy, you will need to configure it to disable buffering to enable streaming.</p>\n<p>For example, you can disable buffering in Nginx by setting <code>X-Accel-Buffering</code> to <code>no</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/:path*{/}?',\n        headers: [\n          {\n            key: 'X-Accel-Buffering',\n            value: 'no',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/deploying\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/deploying</a>\n  </p>\n</div>\n","app/building-your-application/deploying/static-exports":"<h1 class=\"break-words\">Static Exports</h1> <p>Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server.</p> <p>When running <code>next build</code>, Next.js generates an HTML file per route. By breaking a strict SPA into individual HTML files, Next.js can avoid loading unnecessary JavaScript code on the client-side, reducing the bundle size and enabling faster page loads.</p> <p>Since Next.js supports this static export, it can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets.</p>  <h2 id=\"configuration\" data-docs-heading=\"\">Configuration     </h2> <p>To enable a static export, change the output mode inside <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/**\n * @type {import('next').NextConfig}\n */\nconst nextConfig = {\n  output: 'export',\n \n  // Optional: Change links `/me` -&gt; `/me/` and emit `/me.html` -&gt; `/me/index.html`\n  // trailingSlash: true,\n \n  // Optional: Prevent automatic `/me` -&gt; `/me/`, instead preserve `href`\n  // skipTrailingSlashRedirect: true,\n \n  // Optional: Change the output directory `out` -&gt; `dist`\n  // distDir: 'dist',\n}\n \nmodule.exports = nextConfig</pre></div> <p>After running <code>next build</code>, Next.js will produce an <code>out</code> folder which contains the HTML/CSS/JS assets for your application.</p>  <h2 id=\"supported-features\" data-docs-heading=\"\">Supported Features     </h2>\n<p>The core of Next.js has been designed to support static exports.</p>\n<h3 id=\"server-components\" data-docs-heading=\"\">Server Components     </h3>\n<p>When you run <code>next build</code> to generate a static export, Server Components consumed inside the <code>app</code> directory will run during the build, similar to traditional static-site generation.</p>\n<p>The resulting component will be rendered into static HTML for the initial page load and a static payload for client navigation between routes. No changes are required for your Server Components when using the static export, unless they consume <a href=\"#unsupported-features\">dynamic server functions</a>.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function Page() {\n  // This fetch will run on the server during `next build`\n  const res = await fetch('https://api.example.com/...')\n  const data = await res.json()\n \n  return &lt;main&gt;...&lt;/main&gt;\n}</pre></div>\n<h3 id=\"client-components\" data-docs-heading=\"\">Client Components     </h3>\n<p>If you want to perform data fetching on the client, you can use a Client Component with <a href=\"https://github.com/vercel/swr\" rel=\"noopener noreferrer\" target=\"_blank\">SWR</a> to memoize requests.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport useSWR from 'swr'\n \nconst fetcher = (url: string) =&gt; fetch(url).then((r) =&gt; r.json())\n \nexport default function Page() {\n  const { data, error } = useSWR(\n    `https://jsonplaceholder.typicode.com/posts/1`,\n    fetcher\n  )\n  if (error) return 'Failed to load'\n  if (!data) return 'Loading...'\n \n  return data.title\n}</pre></div>\n<p>Since route transitions happen client-side, this behaves like a traditional SPA. For example, the following index route allows you to navigate to different posts on the client:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;h1&gt;Index Page&lt;/h1&gt;\n      &lt;hr /&gt;\n      &lt;ul&gt;\n        &lt;li&gt;\n          &lt;Link href=\"/post/1\"&gt;Post 1&lt;/Link&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n          &lt;Link href=\"/post/2\"&gt;Post 2&lt;/Link&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"image-optimization\" data-docs-heading=\"\">Image Optimization     </h3> <p><a href=\"../optimizing/images\">Image Optimization</a> through <code>next/image</code> can be used with a static export by defining a custom image loader in <code>next.config.js</code>. For example, you can optimize images with a service like Cloudinary:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export',\n  images: {\n    loader: 'custom',\n    loaderFile: './my-loader.ts',\n  },\n}\n \nmodule.exports = nextConfig</pre></div> <p>This custom loader will define how to fetch images from a remote source. For example, the following loader will construct the URL for Cloudinary:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function cloudinaryLoader({\n  src,\n  width,\n  quality,\n}: {\n  src: string\n  width: number\n  quality?: number\n}) {\n  const params = ['f_auto', 'c_limit', `w_${width}`, `q_${quality || 'auto'}`]\n  return `https://res.cloudinary.com/demo/image/upload/${params.join(\n    ','\n  )}${src}`\n}</pre></div>  <p>You can then use <code>next/image</code> in your application, defining relative paths to the image in Cloudinary:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return &lt;Image alt=\"turtles\" src=\"/turtles.jpg\" width={300} height={300} /&gt;\n}</pre></div>  <h3 id=\"route-handlers\" data-docs-heading=\"\">Route Handlers     </h3>\n<p>Route Handlers will render a static response when running <code>next build</code>. Only the <code>GET</code> HTTP verb is supported. This can be used to generate static HTML, JSON, TXT, or other files from cached or uncached data. For example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET() {\n  return Response.json({ name: 'Lee' })\n}</pre></div>\n<p>The above file <code>app/data.json/route.ts</code> will render to a static file during <code>next build</code>, producing <code>data.json</code> containing <code>{ name: 'Lee' }</code>.</p>\n<p>If you need to read dynamic values from the incoming request, you cannot use a static export.</p>\n<h3 id=\"browser-apis\" data-docs-heading=\"\">Browser APIs     </h3>\n<p>Client Components are pre-rendered to HTML during <code>next build</code>. Because <a href=\"https://developer.mozilla.org/docs/Web/API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web APIs</a> like <code>window</code>, <code>localStorage</code>, and <code>navigator</code> are not available on the server, you need to safely access these APIs only when running in the browser. For example:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client';\n \nimport { useEffect } from 'react';\n \nexport default function ClientComponent() {\n  useEffect(() =&gt; {\n    // You now have access to `window`\n    console.log(window.innerHeight);\n  }, [])\n \n  return ...;\n}</pre>\n</div> <h2 id=\"unsupported-features\" data-docs-heading=\"\">Unsupported Features     </h2> <p>Features that require a Node.js server, or dynamic logic that cannot be computed during the build process, are <strong>not</strong> supported:</p> <ul> <li>\n<a href=\"../routing/dynamic-routes\">Dynamic Routes</a> with <code>dynamicParams: true</code>\n</li> <li>\n<a href=\"../routing/dynamic-routes\">Dynamic Routes</a> without <code>generateStaticParams()</code>\n</li> <li>\n<a href=\"../routing/route-handlers\">Route Handlers</a> that rely on Request</li> <li><a href=\"../../api-reference/functions/cookies\">Cookies</a></li> <li><a href=\"../../api-reference/next-config-js/rewrites\">Rewrites</a></li> <li><a href=\"../../api-reference/next-config-js/redirects\">Redirects</a></li> <li><a href=\"../../api-reference/next-config-js/headers\">Headers</a></li> <li><a href=\"../routing/middleware\">Middleware</a></li> <li><a href=\"../data-fetching/fetching-caching-and-revalidating\">Incremental Static Regeneration</a></li> <li>\n<a href=\"../optimizing/images\">Image Optimization</a> with the default <code>loader</code>\n</li> <li><a href=\"../configuring/draft-mode\">Draft Mode</a></li> </ul>\n<p>Attempting to use any of these features with <code>next dev</code> will result in an error, similar to setting the <a href=\"../../api-reference/file-conventions/route-segment-config#dynamic\"><code>dynamic</code></a> option to <code>error</code> in the root layout.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const dynamic = 'error'</pre>\n</div>  <h2 id=\"deploying\" data-docs-heading=\"\">Deploying     </h2> <p>With a static export, Next.js can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets.</p> <p>When running <code>next build</code>, Next.js generates the static export into the <code>out</code> folder. For example, let's say you have the following routes:</p> <ul> <li><code>/</code></li> <li><code>/blog/[id]</code></li> </ul> <p>After running <code>next build</code>, Next.js will generate the following files:</p> <ul> <li><code>/out/index.html</code></li> <li><code>/out/404.html</code></li> <li><code>/out/blog/post-1.html</code></li> <li><code>/out/blog/post-2.html</code></li> </ul> <p>If you are using a static host like Nginx, you can configure rewrites from incoming requests to the correct files:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">server {\n  listen 80;\n  server_name acme.com;\n \n  root /var/www/out;\n \n  location / {\n      try_files $uri $uri.html $uri/ =404;\n  }\n \n  # This is necessary when `trailingSlash: false`.\n  # You can omit this when `trailingSlash: true`.\n  location /blog/ {\n      rewrite ^/blog/(.*)$ /blog/$1.html break;\n  }\n \n  error_page 404 /404.html;\n  location = /404.html {\n      internal;\n  }\n}</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v14.0.0</code></td>\n<td>\n<code>next export</code> has been removed in favor of <code>\"output\": \"export\"</code>\n</td>\n</tr>\n<tr>\n<td><code>v13.4.0</code></td>\n<td>App Router (Stable) adds enhanced static export support, including using React Server Components and Route Handlers.</td>\n</tr>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>next export</code> is deprecated and replaced with <code>\"output\": \"export\"</code>\n</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/deploying/static-exports\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/deploying/static-exports</a>\n  </p>\n</div>\n","app/building-your-application/upgrading":"<h1 class=\"break-words\">Upgrade Guide</h1>\n<p>Upgrade your application to newer versions of Next.js or migrate from the Pages Router to the App Router.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/upgrading\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/upgrading</a>\n  </p>\n</div>\n","app/building-your-application/upgrading/codemods":"<h1 class=\"break-words\">Codemods</h1>\n<p>Codemods are transformations that run on your codebase programmatically. This allows a large number of changes to be programmatically applied without having to manually go through every file.</p> <p>Next.js provides Codemod transformations to help upgrade your Next.js codebase when an API is updated or deprecated.</p> <h2 id=\"usage\" data-docs-heading=\"\">Usage     </h2> <p>In your terminal, navigate (<code>cd</code>) into your project's folder, then run:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod &lt;transform&gt; &lt;path&gt;</pre></div> <p>Replacing <code>&lt;transform&gt;</code> and <code>&lt;path&gt;</code> with appropriate values.</p> <ul> <li>\n<code>transform</code> - name of transform</li> <li>\n<code>path</code> - files or directory to transform</li> <li>\n<code>--dry</code> Do a dry-run, no code will be edited</li> <li>\n<code>--print</code> Prints the changed output for comparison</li> </ul> <h2 id=\"nextjs-codemods\" data-docs-heading=\"\">Next.js Codemods     </h2> <h3 id=\"140\" data-docs-heading=\"\">14.0     </h3> <h4 id=\"migrate-imageresponse-imports\" data-docs-heading=\"\">Migrate ImageResponse imports     </h4> <h5 id=\"next-og-import\" data-docs-heading=\"\"><a href=\"#next-og-import\"><code>next-og-import</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest next-og-import .</pre></div> <p>This codemod moves transforms imports from <code>next/server</code> to <code>next/og</code> for usage of <a href=\"../optimizing/metadata#dynamic-image-generation\">Dynamic OG Image Generation</a>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/server'</pre>\n</div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'</pre>\n</div> <h4 id=\"use-viewport-export\" data-docs-heading=\"\">Use viewport export     </h4> <h5 id=\"metadata-to-viewport-export\" data-docs-heading=\"\"><a href=\"#metadata-to-viewport-export\"><code>metadata-to-viewport-export</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest metadata-to-viewport-export .</pre></div> <p>This codemod migrates certain viewport metadata to <code>viewport</code> export.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'My App',\n  themeColor: 'dark',\n  viewport: {\n    width: 1,\n  },\n}</pre>\n</div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'My App',\n}\n \nexport const viewport = {\n  width: 1,\n  themeColor: 'dark',\n}</pre>\n</div> <h3 id=\"132\" data-docs-heading=\"\">13.2     </h3> <h4 id=\"use-built-in-font\" data-docs-heading=\"\">Use Built-in Font     </h4> <h5 id=\"built-in-next-font\" data-docs-heading=\"\"><a href=\"#built-in-next-font\"><code>built-in-next-font</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest built-in-next-font .</pre></div> <p>This codemod uninstalls the <code>@next/font</code> package and transforms <code>@next/font</code> imports into the built-in <code>next/font</code>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from '@next/font/google'</pre>\n</div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'</pre>\n</div> <h3 id=\"130\" data-docs-heading=\"\">13.0     </h3> <h4 id=\"rename-next-image-imports\" data-docs-heading=\"\">Rename Next Image Imports     </h4> <h5 id=\"next-image-to-legacy-image\" data-docs-heading=\"\"><a href=\"#next-image-to-legacy-image\"><code>next-image-to-legacy-image</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest next-image-to-legacy-image .</pre></div> <p>Safely renames <code>next/image</code> imports in existing Next.js 10, 11, or 12 applications to <code>next/legacy/image</code> in Next.js 13. Also renames <code>next/future/image</code> to <code>next/image</code>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image1 from 'next/image'\nimport Image2 from 'next/future/image'\n \nexport default function Home() {\n  return (\n    &lt;div&gt;\n      &lt;Image1 src=\"/test.jpg\" width=\"200\" height=\"300\" /&gt;\n      &lt;Image2 src=\"/test.png\" width=\"500\" height=\"400\" /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// 'next/image' becomes 'next/legacy/image'\nimport Image1 from 'next/legacy/image'\n// 'next/future/image' becomes 'next/image'\nimport Image2 from 'next/image'\n \nexport default function Home() {\n  return (\n    &lt;div&gt;\n      &lt;Image1 src=\"/test.jpg\" width=\"200\" height=\"300\" /&gt;\n      &lt;Image2 src=\"/test.png\" width=\"500\" height=\"400\" /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <h4 id=\"migrate-to-the-new-image-component\" data-docs-heading=\"\">Migrate to the New Image Component     </h4> <h5 id=\"next-image-experimental\" data-docs-heading=\"\"><a href=\"#next-image-experimental\"><code>next-image-experimental</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest next-image-experimental .</pre></div> <p>Dangerously migrates from <code>next/legacy/image</code> to the new <code>next/image</code> by adding inline styles and removing unused props.</p> <ul> <li>Removes <code>layout</code> prop and adds <code>style</code>.</li> <li>Removes <code>objectFit</code> prop and adds <code>style</code>.</li> <li>Removes <code>objectPosition</code> prop and adds <code>style</code>.</li> <li>Removes <code>lazyBoundary</code> prop.</li> <li>Removes <code>lazyRoot</code> prop.</li> </ul> <h4 id=\"remove-a-tags-from-link-components\" data-docs-heading=\"\">Remove &lt;a&gt; Tags From Link Components     </h4> <h5 id=\"new-link\" data-docs-heading=\"\"><a href=\"#new-link\"><code>new-link</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest new-link .</pre></div> <p>Remove <code>&lt;a&gt;</code> tags inside <a href=\"../../api-reference/components/link\">Link Components</a>, or add a <code>legacyBehavior</code> prop to Links that cannot be auto-fixed.</p>  <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/about\"&gt;\n  &lt;a&gt;About&lt;/a&gt;\n&lt;/Link&gt;\n// transforms into\n&lt;Link href=\"/about\"&gt;\n  About\n&lt;/Link&gt;\n \n&lt;Link href=\"/about\"&gt;\n  &lt;a onClick={() =&gt; console.log('clicked')}&gt;About&lt;/a&gt;\n&lt;/Link&gt;\n// transforms into\n&lt;Link href=\"/about\" onClick={() =&gt; console.log('clicked')}&gt;\n  About\n&lt;/Link&gt;</pre>\n</div> <p>In cases where auto-fixing can't be applied, the <code>legacyBehavior</code> prop is added. This allows your app to keep functioning using the old behavior for that particular link.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const Component = () =&gt; &lt;a&gt;About&lt;/a&gt;\n \n&lt;Link href=\"/about\"&gt;\n  &lt;Component /&gt;\n&lt;/Link&gt;\n// becomes\n&lt;Link href=\"/about\" legacyBehavior&gt;\n  &lt;Component /&gt;\n&lt;/Link&gt;</pre>\n</div> <h3 id=\"11\" data-docs-heading=\"\">11     </h3> <h4 id=\"migrate-from-cra\" data-docs-heading=\"\">Migrate from CRA     </h4> <h5 id=\"cra-to-next\" data-docs-heading=\"\"><a href=\"#cra-to-next\"><code>cra-to-next</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod cra-to-next</pre></div> <p>Migrates a Create React App project to Next.js; creating a Pages Router and necessary config to match behavior. Client-side only rendering is leveraged initially to prevent breaking compatibility due to <code>window</code> usage during SSR and can be enabled seamlessly to allow the gradual adoption of Next.js specific features.</p> <p>Please share any feedback related to this transform <a href=\"https://github.com/vercel/next.js/discussions/25858\" rel=\"noopener noreferrer\" target=\"_blank\">in this discussion</a>.</p> <h3 id=\"10\" data-docs-heading=\"\">10     </h3> <h4 id=\"add-react-imports\" data-docs-heading=\"\">Add React imports     </h4> <h5 id=\"add-missing-react-import\" data-docs-heading=\"\"><a href=\"#add-missing-react-import\"><code>add-missing-react-import</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod add-missing-react-import</pre></div> <p>Transforms files that do not import <code>React</code> to include the import in order for the new <a href=\"https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React JSX transform</a> to work.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default class Home extends React.Component {\n  render() {\n    return &lt;div&gt;Hello World&lt;/div&gt;\n  }\n}</pre></div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nexport default class Home extends React.Component {\n  render() {\n    return &lt;div&gt;Hello World&lt;/div&gt;\n  }\n}</pre></div> <h3 id=\"9\" data-docs-heading=\"\">9     </h3> <h4 id=\"transform-anonymous-components-into-named-components\" data-docs-heading=\"\">Transform Anonymous Components into Named Components     </h4> <h5 id=\"name-default-component\" data-docs-heading=\"\"><a href=\"#name-default-component\"><code>name-default-component</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod name-default-component</pre></div> <p><strong>Versions 9 and above.</strong></p> <p>Transforms anonymous components into named components to make sure they work with <a href=\"https://nextjs.org/blog/next-9-4#fast-refresh\" rel=\"noopener noreferrer\" target=\"_blank\">Fast Refresh</a>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function () {\n  return &lt;div&gt;Hello World&lt;/div&gt;\n}</pre></div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function MyComponent() {\n  return &lt;div&gt;Hello World&lt;/div&gt;\n}</pre></div> <p>The component will have a camel-cased name based on the name of the file, and it also works with arrow functions.</p> <h3 id=\"8\" data-docs-heading=\"\">8     </h3> <h4 id=\"transform-amp-hoc-into-page-config\" data-docs-heading=\"\">Transform AMP HOC into page config     </h4> <h5 id=\"withamp-to-config\" data-docs-heading=\"\"><a href=\"#withamp-to-config\"><code>withamp-to-config</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod withamp-to-config</pre></div> <p>Transforms the <code>withAmp</code> HOC into Next.js 9 page configuration.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\nimport { withAmp } from 'next/amp'\n \nfunction Home() {\n  return &lt;h1&gt;My AMP Page&lt;/h1&gt;\n}\n \nexport default withAmp(Home)</pre>\n</div> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// After\nexport default function Home() {\n  return &lt;h1&gt;My AMP Page&lt;/h1&gt;\n}\n \nexport const config = {\n  amp: true,\n}</pre>\n</div> <h3 id=\"6\" data-docs-heading=\"\">6     </h3> <h4 id=\"use-withrouter\" data-docs-heading=\"\">Use withRouter     </h4> <h5 id=\"url-to-withrouter\" data-docs-heading=\"\"><a href=\"#url-to-withrouter\"><code>url-to-withrouter</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod url-to-withrouter</pre></div> <p>Transforms the deprecated automatically injected <code>url</code> property on top level pages to using <code>withRouter</code> and the <code>router</code> property it injects. Read more here: <a href=\"../../../messages/url-deprecated\">https://nextjs.org/docs/messages/url-deprecated</a></p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nexport default class extends React.Component {\n  render() {\n    const { pathname } = this.props.url\n    return &lt;div&gt;Current pathname: {pathname}&lt;/div&gt;\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nimport { withRouter } from 'next/router'\nexport default withRouter(\n  class extends React.Component {\n    render() {\n      const { pathname } = this.props.router\n      return &lt;div&gt;Current pathname: {pathname}&lt;/div&gt;\n    }\n  }\n)</pre></div> <p>This is one case. All the cases that are transformed (and tested) can be found in the <a href=\"https://github.com/vercel/next.js/tree/canary/packages/next-codemod/transforms/__testfixtures__/url-to-withrouter\" rel=\"noopener noreferrer\" target=\"_blank\"><code>__testfixtures__</code> directory</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/codemods\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/upgrading/codemods</a>\n  </p>\n</div>\n","app/building-your-application/testing/jest":"<h1 class=\"break-words\">Setting up Jest with Next.js</h1>\n<p>Jest and React Testing Library are frequently used together for <strong>Unit Testing</strong> and <strong>Snapshot Testing</strong>. This guide will show you how to set up Jest with Next.js and write your first tests.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> Since <code>async</code> Server Components are new to the React ecosystem, Jest currently does not support them. While you can still run <strong>unit tests</strong> for synchronous Server and Client Components, we recommend using an <strong>E2E tests</strong> for <code>async</code> components.</p> </blockquote> <h2 id=\"quickstart\" data-docs-heading=\"\">Quickstart     </h2> <p>You can use <code>create-next-app</code> with the Next.js <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-jest\" rel=\"noopener noreferrer\" target=\"_blank\">with-jest</a> example to quickly get started:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest --example with-jest with-jest-app</pre></div> <h2 id=\"manual-setup\" data-docs-heading=\"\">Manual setup     </h2> <p>Since the release of <a href=\"https://nextjs.org/blog/next-12\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js 12</a>, Next.js now has built-in configuration for Jest.</p> <p>To set up Jest, install <code>jest</code> and the following packages as dev dependencies:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D jest jest-environment-jsdom @testing-library/react @testing-library/jest-dom\n# or\nyarn add -D jest jest-environment-jsdom @testing-library/react @testing-library/jest-dom\n# or\npnpm install -D jest jest-environment-jsdom @testing-library/react @testing-library/jest-dom</pre></div> <p>Generate a basic Jest configuration file by running the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm init jest@latest\n# or\nyarn create jest@latest\n# or\npnpm create jest@latest</pre></div> <p>This will take you through a series of prompts to setup Jest for your project, including automatically creating a <code>jest.config.ts|js</code> file.</p> <p>Update your config file to use <code>next/jest</code>. This transformer has all the necessary configuration options for Jest to work with Next.js:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Config } from 'jest'\nimport nextJest from 'next/jest.js'\n \nconst createJestConfig = nextJest({\n  // Provide the path to your Next.js app to load next.config.js and .env files in your test environment\n  dir: './',\n})\n \n// Add any custom config to be passed to Jest\nconst config: Config = {\n  coverageProvider: 'v8',\n  testEnvironment: 'jsdom',\n  // Add more setup options before each test is run\n  // setupFilesAfterEnv: ['&lt;rootDir&gt;/jest.setup.ts'],\n}\n \n// createJestConfig is exported this way to ensure that next/jest can load the Next.js config which is async\nexport default createJestConfig(config)</pre></div>  <p>Under the hood, <code>next/jest</code> is automatically configuring Jest for you, including:</p> <ul> <li>Setting up <code>transform</code> using the <a href=\"../../../architecture/nextjs-compiler\">Next.js Compiler</a>\n</li> <li>Auto mocking stylesheets (<code>.css</code>, <code>.module.css</code>, and their scss variants), image imports and <a href=\"../../../pages/building-your-application/optimizing/fonts\"><code>next/font</code></a>\n</li> <li>Loading <code>.env</code> (and all variants) into <code>process.env</code>\n</li> <li>Ignoring <code>node_modules</code> from test resolving and transforms</li> <li>Ignoring <code>.next</code> from test resolving</li> <li>Loading <code>next.config.js</code> for flags that enable SWC transforms</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: To test environment variables directly, load them manually in a separate setup script or in your <code>jest.config.ts</code> file. For more information, please see <a href=\"../../../pages/building-your-application/configuring/environment-variables#test-environment-variables\">Test Environment Variables</a>.</p> </blockquote>  <h2 id=\"optional-handling-absolute-imports-and-module-path-aliases\" data-docs-heading=\"\">Optional: Handling Absolute Imports and Module Path Aliases     </h2> <p>If your project is using <a href=\"../../../pages/building-your-application/configuring/absolute-imports-and-module-aliases\">Module Path Aliases</a>, you will need to configure Jest to resolve the imports by matching the paths option in the <code>jsconfig.json</code> file with the <code>moduleNameMapper</code> option in the <code>jest.config.js</code> file. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"bundler\",\n    \"baseUrl\": \"./\",\n    \"paths\": {\n      \"@/components/*\": [\"components/*\"]\n    }\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">moduleNameMapper: {\n  // ...\n  '^@/components/(.*)$': '&lt;rootDir&gt;/components/$1',\n}</pre></div> <h2 id=\"optional-extend-jest-with-custom-matchers\" data-docs-heading=\"\">Optional: Extend Jest with custom matchers     </h2> <p><code>@testing-library/jest-dom</code> includes a set of convenient <a href=\"https://github.com/testing-library/jest-dom#custom-matchers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">custom matchers</a> such as <code>.toBeInTheDocument()</code> making it easier to write tests. You can import the custom matchers for every test by adding the following option to the Jest configuration file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">setupFilesAfterEnv: ['&lt;rootDir&gt;/jest.setup.ts']</pre></div>  <p>Then, inside <code>jest.setup.ts</code>, add the following import:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '@testing-library/jest-dom'</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong><a href=\"https://github.com/testing-library/jest-dom/releases/tag/v6.0.0\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>extend-expect</code> was removed in <code>v6.0</code></a>, so if you are using <code>@testing-library/jest-dom</code> before version 6, you will need to import <code>@testing-library/jest-dom/extend-expect</code> instead.</p> </blockquote> <p>If you need to add more setup options before each test, you can add them to the <code>jest.setup.js</code> file above.</p> <h2 id=\"add-a-test-script-to-packagejson\" data-docs-heading=\"\">Add a test script to package.json:     </h2> <p>Finally, add a Jest <code>test</code> script to your <code>package.json</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"test\": \"jest\",\n    \"test:watch\": \"jest --watch\"\n  }\n}</pre></div> <p><code>jest --watch</code> will re-run tests when a file is changed. For more Jest CLI options, please refer to the <a href=\"https://jestjs.io/docs/cli#reference\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Jest Docs</a>.</p> <h3 id=\"creating-your-first-test\" data-docs-heading=\"\">Creating your first test:     </h3> <p>Your project is now ready to run tests. Create a folder called <code>__tests__</code> in your project's root directory.</p>  <p>For example, we can add a test to check if the <code>&lt;Page /&gt;</code> component successfully renders a heading:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Home() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Home&lt;/h1&gt;\n      &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '@testing-library/jest-dom'\nimport { render, screen } from '@testing-library/react'\nimport Page from '../app/page'\n \ndescribe('Page', () =&gt; {\n  it('renders a heading', () =&gt; {\n    render(&lt;Page /&gt;)\n \n    const heading = screen.getByRole('heading', { level: 1 })\n \n    expect(heading).toBeInTheDocument()\n  })\n})</pre></div> <p>Optionally, add a <a href=\"https://jestjs.io/docs/snapshot-testing\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">snapshot test</a> to keep track of any unexpected changes in your component:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { render } from '@testing-library/react'\nimport Page from '../app/page'\n \nit('renders homepage unchanged', () =&gt; {\n  const { container } = render(&lt;Page /&gt;)\n  expect(container).toMatchSnapshot()\n})</pre></div> <h2 id=\"running-your-tests\" data-docs-heading=\"\">Running your tests     </h2> <p>Then, run the following command to run your tests:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm run test\n# or\nyarn test\n# or\npnpm test</pre></div> <h2 id=\"additional-resources\" data-docs-heading=\"\">Additional Resources     </h2> <p>For further reading, you may find these resources helpful:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-jest\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with Jest example</a></li> <li><a href=\"https://jestjs.io/docs/getting-started\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Jest Docs</a></li> <li><a href=\"https://testing-library.com/docs/react-testing-library/intro/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Testing Library Docs</a></li> <li>\n<a href=\"https://testing-playground.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Testing Playground</a> - use good testing practices to match elements.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/testing/jest\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/testing/jest</a>\n  </p>\n</div>\n","app/building-your-application/testing/playwright":"<h1 class=\"break-words\">Setting up Playwright with Next.js</h1>\n<p>Playwright is a testing framework that lets you automate Chromium, Firefox, and WebKit with a single API. You can use it to write <strong>End-to-End (E2E)</strong> testing. This guide will show you how to set up Playwright with Next.js and write your first tests.</p> <h2 id=\"quickstart\" data-docs-heading=\"\">Quickstart     </h2> <p>The fastest way to get started is to use <code>create-next-app</code> with the <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-playwright\" rel=\"noopener noreferrer\" target=\"_blank\">with-playwright example</a>. This will create a Next.js project complete with Playwright configured.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest --example with-playwright with-playwright-app</pre></div> <h2 id=\"manual-setup\" data-docs-heading=\"\">Manual setup     </h2> <p>To install Playwright, run the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm init playwright\n# or\nyarn create playwright\n# or\npnpm create playwright</pre></div> <p>This will take you through a series of prompts to setup and configure Playwright for your project, including adding a <code>playwright.config.ts</code> file. Please refer to the <a href=\"https://playwright.dev/docs/intro#installation\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Playwright installation guide</a> for the step-by-step guide.</p> <h2 id=\"creating-your-first-playwright-e2e-test\" data-docs-heading=\"\">Creating your first Playwright E2E test     </h2> <p>Create two new Next.js pages:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Home&lt;/h1&gt;\n      &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;About&lt;/h1&gt;\n      &lt;Link href=\"/\"&gt;Home&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>Then, add a test to verify that your navigation is working correctly:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { test, expect } from '@playwright/test'\n \ntest('should navigate to the about page', async ({ page }) =&gt; {\n  // Start from the index page (the baseURL is set via the webServer in the playwright.config.ts)\n  await page.goto('http://localhost:3000/')\n  // Find an element with the text 'About' and click on it\n  await page.click('text=About')\n  // The new URL should be \"/about\" (baseURL is used there)\n  await expect(page).toHaveURL('http://localhost:3000/about')\n  // The new page should contain an h1 with \"About\"\n  await expect(page.locator('h1')).toContainText('About')\n})</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <p>You can use <code>page.goto(\"/\")</code> instead of <code>page.goto(\"http://localhost:3000/\")</code>, if you add <a href=\"https://playwright.dev/docs/api/class-testoptions#test-options-base-url\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>\"baseURL\": \"http://localhost:3000\"</code></a> to the <code>playwright.config.ts</code> <a href=\"https://playwright.dev/docs/test-configuration\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">configuration file</a>.</p> </blockquote> <h3 id=\"running-your-playwright-tests\" data-docs-heading=\"\">Running your Playwright tests     </h3> <p>Playwright will simulate a user navigating your application using three browsers: Chromium, Firefox and Webkit, this requires your Next.js server to be running. We recommend running your tests against your production code to more closely resemble how your application will behave.</p> <p>Run <code>npm run build</code> and <code>npm run start</code>, then run <code>npx playwright test</code> in another terminal window to run the Playwright tests.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Alternatively, you can use the <a href=\"https://playwright.dev/docs/test-webserver/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>webServer</code></a> feature to let Playwright start the development server and wait until it's fully available.</p> </blockquote> <h3 id=\"running-playwright-on-continuous-integration-ci\" data-docs-heading=\"\">Running Playwright on Continuous Integration (CI)     </h3> <p>Playwright will by default run your tests in the <a href=\"https://playwright.dev/docs/ci#running-headed\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">headless mode</a>. To install all the Playwright dependencies, run <code>npx playwright install-deps</code>.</p> <p>You can learn more about Playwright and Continuous Integration from these resources:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-playwright\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with Playwright example</a></li> <li><a href=\"https://playwright.dev/docs/ci\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Playwright on your CI provider</a></li> <li><a href=\"https://discord.com/invite/playwright-807756831384403968\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Playwright Discord</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/testing/playwright\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/testing/playwright</a>\n  </p>\n</div>\n","app/building-your-application/testing/cypress":"<h1 class=\"break-words\">Setting up Cypress with Next.js</h1>\n<p><a href=\"https://www.cypress.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cypress</a> is a test runner used for <strong>End-to-End (E2E)</strong> and <strong>Component Testing</strong>. This page will show you how to set up Cypress with Next.js and write your first tests.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong></p> <ul> <li>For <strong>component testing</strong>, Cypress currently does not support <a href=\"https://github.com/cypress-io/cypress/issues/28185\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Next.js version 14</a> and <code>async</code> Server Components. These issues are being tracked. For now, component testing works with Next.js version 13, and we recommend E2E testing for <code>async</code> Server Components.</li> <li>Cypress currently does not support <a href=\"https://github.com/cypress-io/cypress/issues/27731\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">TypeScript version 5</a> with <code>moduleResolution:\"bundler\"</code>. This issue is being tracked.</li> </ul> </blockquote> <h2 id=\"quickstart\" data-docs-heading=\"\">Quickstart     </h2>\n<p>You can use <code>create-next-app</code> with the <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-cypress\" rel=\"noopener noreferrer\" target=\"_blank\">with-cypress example</a> to quickly get started.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest --example with-cypress with-cypress-app</pre></div> <h2 id=\"manual-setup\" data-docs-heading=\"\">Manual setup     </h2> <p>To manually set up Cypress, install <code>cypress</code> as a dev dependency:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D cypress\n# or\nyarn add -D cypress\n# or\npnpm install -D cypress</pre></div> <p>Add the Cypress <code>open</code> command to the <code>package.json</code> scripts field:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\",\n    \"cypress:open\": \"cypress open\"\n  }\n}</pre></div> <p>Run Cypress for the first time to open the Cypress testing suite:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm run cypress:open</pre></div> <p>You can choose to configure <strong>E2E Testing</strong> and/or <strong>Component Testing</strong>. Selecting any of these options will automatically create a <code>cypress.config.js</code> file and a <code>cypress</code> folder in your project.</p> <h2 id=\"creating-your-first-cypress-e2e-test\" data-docs-heading=\"\">Creating your first Cypress E2E test     </h2> <p>Ensure your <code>cypress.config.js</code> file has the following configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { defineConfig } from 'cypress'\n \nexport default defineConfig({\n  e2e: {\n    setupNodeEvents(on, config) {},\n  },\n})</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const { defineConfig } = require('cypress')\n \nmodule.exports = defineConfig({\n  e2e: {\n    setupNodeEvents(on, config) {},\n  },\n})</pre></div> <p>Then, create two new Next.js files:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Home&lt;/h1&gt;\n      &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;About&lt;/h1&gt;\n      &lt;Link href=\"/\"&gt;Home&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>Add a test to check your navigation is working correctly:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">describe('Navigation', () =&gt; {\n  it('should navigate to the about page', () =&gt; {\n    // Start from the index page\n    cy.visit('http://localhost:3000/')\n \n    // Find a link with an href attribute containing \"about\" and click it\n    cy.get('a[href*=\"about\"]').click()\n \n    // The new url should include \"/about\"\n    cy.url().should('include', '/about')\n \n    // The new page should contain an h1 with \"About\"\n    cy.get('h1').contains('About')\n  })\n})</pre></div> <h3 id=\"running-e2e-tests\" data-docs-heading=\"\">Running E2E Tests     </h3> <p>Cypress will simulate a user navigating your application, this requires your Next.js server to be running. We recommend running your tests against your production code to more closely resemble how your application will behave.</p> <p>Run <code>npm run build &amp;&amp; npm run start</code> to build your Next.js application, then run <code>npm run cypress:open</code> in another terminal window to start Cypress and run your E2E testing suite.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>You can use <code>cy.visit(\"/\")</code> instead of <code>cy.visit(\"http://localhost:3000/\")</code> by adding <code>baseUrl: 'http://localhost:3000'</code> to the <code>cypress.config.js</code> configuration file.</li> <li>Alternatively, you can install the <code>start-server-and-test</code> package to run the Next.js production server in conjunction with Cypress. After installation, add <code>\"test\": \"start-server-and-test start http://localhost:3000 cypress\"</code> to your <code>package.json</code> scripts field. Remember to rebuild your application after new changes.</li> </ul> </blockquote> <h2 id=\"creating-your-first-cypress-component-test\" data-docs-heading=\"\">Creating your first Cypress component test     </h2> <p>Component tests build and mount a specific component without having to bundle your whole application or start a server.</p> <p>Select <strong>Component Testing</strong> in the Cypress app, then select <strong>Next.js</strong> as your front-end framework. A <code>cypress/component</code> folder will be created in your project, and a <code>cypress.config.js</code> file will be updated to enable component testing.</p> <p>Ensure your <code>cypress.config.js</code> file has the following configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { defineConfig } from 'cypress'\n \nexport default defineConfig({\n  component: {\n    devServer: {\n      framework: 'next',\n      bundler: 'webpack',\n    },\n  },\n})</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const { defineConfig } = require('cypress')\n \nmodule.exports = defineConfig({\n  component: {\n    devServer: {\n      framework: 'next',\n      bundler: 'webpack',\n    },\n  },\n})</pre></div> <p>Assuming the same components from the previous section, add a test to validate a component is rendering the expected output:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Page from '../../app/page'\n \ndescribe('&lt;Page /&gt;', () =&gt; {\n  it('should render and display expected content', () =&gt; {\n    // Mount the React component for the Home page\n    cy.mount(&lt;Page /&gt;)\n \n    // The new page should contain an h1 with \"Home\"\n    cy.get('h1').contains('Home')\n \n    // Validate that a link with the expected URL is present\n    // Following the link is better suited to an E2E test\n    cy.get('a[href=\"/about\"]').should('be.visible')\n  })\n})</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Cypress currently doesn't support component testing for <code>async</code> Server Components. We recommend using E2E testing.</li> <li>Since component tests do not require a Next.js server, features like <code>&lt;Image /&gt;</code> that rely on a server being available may not function out-of-the-box.</li> </ul> </blockquote> <h3 id=\"running-component-tests\" data-docs-heading=\"\">Running Component Tests     </h3> <p>Run <code>npm run cypress:open</code> in your terminal to start Cypress and run your component testing suite.</p> <h2 id=\"continuous-integration-ci\" data-docs-heading=\"\">Continuous Integration (CI)     </h2> <p>In addition to interactive testing, you can also run Cypress headlessly using the <code>cypress run</code> command, which is better suited for CI environments:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    //...\n    \"e2e\": \"start-server-and-test dev http://localhost:3000 \\\"cypress open --e2e\\\"\",\n    \"e2e:headless\": \"start-server-and-test dev http://localhost:3000 \\\"cypress run --e2e\\\"\",\n    \"component\": \"cypress open --component\",\n    \"component:headless\": \"cypress run --component\"\n  }\n}</pre></div> <p>You can learn more about Cypress and Continuous Integration from these resources:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-cypress\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with Cypress example</a></li> <li><a href=\"https://docs.cypress.io/guides/continuous-integration/introduction\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cypress Continuous Integration Docs</a></li> <li><a href=\"https://on.cypress.io/github-actions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cypress GitHub Actions Guide</a></li> <li><a href=\"https://github.com/cypress-io/github-action\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Official Cypress GitHub Action</a></li> <li><a href=\"https://discord.com/invite/cypress\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cypress Discord</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/testing/cypress\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/testing/cypress</a>\n  </p>\n</div>\n","app/building-your-application/deploying/production-checklist":"<h1 class=\"break-words\">Production Checklist</h1>\n<p>Before taking your Next.js application to production, there are some optimizations and patterns you should consider implementing for the best user experience, performance, and security.</p> <p>This page provides best practices that you can use as a reference when <a href=\"#during-development\">building your application</a>, <a href=\"#before-going-to-production\">before going to production</a>, and <a href=\"#after-deployment\">after deployment</a> - as well as the <a href=\"#automatic-optimizations\">automatic Next.js optimizations</a> you should be aware of.</p> <h2 id=\"automatic-optimizations\" data-docs-heading=\"\">Automatic optimizations     </h2> <p>These Next.js optimizations are enabled by default and require no configuration:</p> <ul> <li>\n<strong><a href=\"../rendering/server-components\">Server Components</a>:</strong> Next.js uses Server Components by default. Server Components run on the server, and don't require JavaScript to render on the client. As such, they have no impact on the size of your client-side JavaScript bundles. You can then use <a href=\"../rendering/client-components\">Client Components</a> as needed for interactivity.</li> <li>\n<strong><a href=\"../routing/linking-and-navigating#how-routing-and-navigation-works\">Code-splitting</a>:</strong> Server Components enable automatic code-splitting by route segments. You may also consider <a href=\"../optimizing/lazy-loading\">lazy loading</a> Client Components and third-party libraries, where appropriate.</li> <li>\n<strong><a href=\"../routing/linking-and-navigating#2-prefetching\">Prefetching</a>:</strong> When a link to a new route enters the user's viewport, Next.js prefetches the route in background. This makes navigation to new routes almost instant. You can opt out of prefetching, where appropriate.</li> <li>\n<strong><a href=\"../rendering/server-components#static-rendering-default\">Static Rendering</a>:</strong> Next.js statically renders Server and Client Components on the server at build time and caches the rendered result to improve your application's performance. You can opt into <a href=\"../rendering/server-components#dynamic-rendering\">Dynamic Rendering</a> for specific routes, where appropriate. </li> <li>\n<strong><a href=\"../caching\">Caching</a>:</strong> Next.js caches data requests, the rendered result of Server and Client Components, static assets, and more, to reduce the number of network requests to your server, database, and backend services. You may opt out of caching, where appropriate.</li> </ul>  <p>These defaults aim to improve your application's performance, and reduce the cost and amount of data transferred on each network request.</p> <h2 id=\"during-development\" data-docs-heading=\"\">During development     </h2> <p>While building your application, we recommend using the following features to ensure the best performance and user experience:</p> <h3 id=\"routing-and-rendering\" data-docs-heading=\"\">Routing and rendering     </h3> <ul> <li>\n<strong><a href=\"../routing/pages-and-layouts#layouts\">Layouts</a>:</strong> Use layouts to share UI across pages and enable <a href=\"../routing/linking-and-navigating#4-partial-rendering\">partial rendering</a> on navigation.</li> <li>\n<strong><a href=\"../routing/linking-and-navigating#link-component\"><code>&lt;Link&gt;</code> component</a>:</strong> Use the <code>&lt;Link&gt;</code> component for <a href=\"../routing/linking-and-navigating#how-routing-and-navigation-works\">client-side navigation and prefetching</a>.</li> <li>\n<strong><a href=\"../routing/error-handling\">Error Handling</a>:</strong> Gracefully handle <a href=\"../routing/error-handling\">catch-all errors</a> and <a href=\"../../api-reference/file-conventions/not-found\">404 errors</a> in production by creating custom error pages.</li> <li>\n<strong><a href=\"../rendering/composition-patterns\">Composition Patterns</a>:</strong> Follow the recommended composition patterns for Server and Client Components, and check the placement of your <a href=\"../rendering/composition-patterns#moving-client-components-down-the-tree\"><code>\"use client\"</code> boundaries</a> to avoid unnecessarily increasing your client-side JavaScript bundle.</li> <li>\n<strong><a href=\"../rendering/server-components#dynamic-functions\">Dynamic Functions</a>:</strong> Be aware that dynamic functions like <a href=\"../../api-reference/functions/cookies\"><code>cookies()</code></a> and the <a href=\"../../api-reference/file-conventions/page#searchparams-optional\"><code>searchParams</code></a> prop will opt the entire route into <a href=\"../rendering/server-components#dynamic-rendering\">Dynamic Rendering</a> (or your whole application if used in the <a href=\"../routing/pages-and-layouts#root-layout-required\">Root Layout</a>). Ensure dynamic function usage is intentional and wrap them in <code>&lt;Suspense&gt;</code> boundaries where appropriate.</li> </ul>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <a href=\"https://nextjs.org/blog/next-14#partial-prerendering-preview\">Partial Prerendering (Experimental)</a> will allow parts of a route to be dynamic without opting the whole route into dynamic rendering.</p> </blockquote>  <h3 id=\"data-fetching-and-caching\" data-docs-heading=\"\">Data fetching and caching     </h3> <ul> <li>\n<strong><a href=\"../data-fetching/patterns#fetching-data-on-the-server\">Server Components</a>:</strong> Leverage the benefits of fetching data on the server using Server Components.</li> <li>\n<strong><a href=\"../routing/route-handlers\">Route Handlers</a>:</strong> Use Route Handlers to access your backend resources from Client Components. But do not call Route Handlers from Server Components to avoid an additional server request.</li> <li>\n<strong><a href=\"../routing/loading-ui-and-streaming\">Streaming</a>:</strong> Use Loading UI and React Suspense to progressively send UI from the server to the client, and prevent the whole route from blocking while data is being fetched.</li> <li>\n<strong><a href=\"../data-fetching/patterns#parallel-and-sequential-data-fetching\">Parallel Data Fetching</a>:</strong> Reduce network waterfalls by fetching data in parallel, where appropriate. Also, consider <a href=\"../data-fetching/patterns#preloading-data\">preloading data</a> where appropriate.</li> <li>\n<strong><a href=\"../caching#data-cache\">Data Caching</a>:</strong> Verify whether your data requests are being cached or not, and opt into caching, where appropriate. Ensure requests that don't use <code>fetch</code> are <a href=\"../../api-reference/functions/unstable_cache\">cached</a>.</li> <li>\n<strong><a href=\"../optimizing/static-assets\">Static Images</a>:</strong> Use the <code>public</code> directory to automatically cache your application's static assets, e.g. images.</li> </ul>  <h3 id=\"ui-and-accessibility\" data-docs-heading=\"\">UI and accessibility     </h3> <ul> <li>\n<strong><a href=\"../data-fetching/server-actions-and-mutations#forms\">Forms and Validation</a>:</strong> Use Server Actions to handle form submissions, server-side validation, and handle errors.</li> </ul> <ul> <li>\n<strong><a href=\"../optimizing/fonts\">Font Module</a>:</strong> Optimize fonts by using the Font Module, which automatically hosts your font files with other static assets, removes external network requests, and reduces <a href=\"https://web.dev/articles/cls\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">layout shift</a>.</li> <li>\n<strong><a href=\"../optimizing/images\"><code>&lt;Image&gt;</code> Component</a>:</strong> Optimize images by using the Image Component, which automatically optimizes images, prevents layout shift, and serves them in modern formats like WebP or AVIF.</li> <li>\n<strong><a href=\"../optimizing/scripts\"><code>&lt;Script&gt;</code> Component</a>:</strong> Optimize third-party scripts by using the Script Component, which automatically defers scripts and prevents them from blocking the main thread.</li> <li>\n<strong><a href=\"../../../architecture/accessibility#linting\">ESLint</a>:</strong> Use the built-in <code>eslint-plugin-jsx-a11y</code> plugin to catch accessibility issues early.</li> </ul> <h3 id=\"security\" data-docs-heading=\"\">Security     </h3> <ul> <li>\n<strong><a href=\"../data-fetching/patterns#preventing-sensitive-data-from-being-exposed-to-the-client\">Tainting</a>:</strong> Prevent sensitive data from being exposed to the client by tainting data objects and/or specific values.</li> <li>\n<strong><a href=\"../data-fetching/server-actions-and-mutations#authentication-and-authorization\">Server Actions</a>:</strong> Ensure users are authorized to call Server Actions. Review the the recommended <a href=\"https://nextjs.org/blog/security-nextjs-server-components-actions\">security practices</a>.</li> </ul> <ul> <li>\n<strong><a href=\"../configuring/environment-variables\">Environment Variables</a>:</strong> Ensure your <code>.env.*</code> files are added to <code>.gitignore</code> and only public variables are prefixed with <code>NEXT_PUBLIC_</code>.</li> <li>\n<strong><a href=\"../configuring/content-security-policy\">Content Security Policy</a>:</strong> Consider adding a Content Security Policy to protect your application against various security threats such as cross-site scripting, clickjacking, and other code injection attacks.</li> </ul> <h3 id=\"metadata-and-seo\" data-docs-heading=\"\">Metadata and SEO     </h3> <ul> <li>\n<strong><a href=\"../optimizing/metadata\">Metadata API</a>:</strong> Use the Metadata API to improve your application's Search Engine Optimization (SEO) by adding page titles, descriptions, and more.</li> <li>\n<strong><a href=\"../../api-reference/file-conventions/metadata/opengraph-image\">Open Graph (OG) images</a>:</strong> Create OG images to prepare your application for social sharing.</li> <li>\n<strong><a href=\"../../api-reference/functions/generate-sitemaps\">Sitemaps</a> and <a href=\"../../api-reference/file-conventions/metadata/robots\">Robots</a>:</strong> Help Search Engines crawl and index your pages by generating sitemaps and robots files.</li> </ul>  <h3 id=\"type-safety\" data-docs-heading=\"\">Type safety     </h3> <ul> <li>\n<strong>TypeScript and <a href=\"../configuring/typescript\">TS Plugin</a>:</strong> Use TypeScript and the TypeScript plugin for better type-safety, and to help you catch errors early.</li> </ul> <h2 id=\"before-going-to-production\" data-docs-heading=\"\">Before going to production     </h2> <p>Before going to production, you can run <code>next build</code> to build your application locally and catch any build errors, then run <code>next start</code> to measure the performance of your application in a production-like environment.</p> <h3 id=\"core-web-vitals\" data-docs-heading=\"\">Core Web Vitals     </h3> <ul> <li>\n<strong><a href=\"https://developers.google.com/web/tools/lighthouse\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Lighthouse</a>:</strong> Run lighthouse in incognito to gain a better understanding of how your users will experience your site, and to identify areas for improvement. This is a simulated test and should be paired with looking at field data (such as Core Web Vitals).</li> </ul> <ul> <li>\n<strong><a href=\"../../api-reference/functions/use-report-web-vitals\"><code>useReportWebVitals</code> hook</a>:</strong> Use this hook to send <a href=\"https://web.dev/articles/vitals\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Core Web Vitals</a> data to analytics tools.</li> </ul> <h3 id=\"analyzing-bundles\" data-docs-heading=\"\">Analyzing bundles     </h3> <p>Use the <a href=\"../optimizing/bundle-analyzer\"><code>@next/bundle-analyzer</code> plugin</a> to analyze the size of your JavaScript bundles and identify large modules and dependencies that might be impacting your application's performance.</p> <p>Additionally, the following tools can you understand the impact of adding new dependencies to your application:</p> <ul> <li><a href=\"https://marketplace.visualstudio.com/items?itemName=wix.vscode-import-cost\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Import Cost</a></li> <li><a href=\"https://packagephobia.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Package Phobia</a></li> <li><a href=\"https://bundlephobia.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Bundle Phobia</a></li> <li><a href=\"https://bundlejs.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">bundlejs</a></li> </ul> <h2 id=\"after-deployment\" data-docs-heading=\"\">After deployment     </h2> <p>Depending on where you deploy your application, you might have access to additional tools and integrations to help you monitor and improve your application's performance.</p> <p>For Vercel deployments, we recommend the following:</p> <ul> <li>\n<strong><a href=\"https://vercel.com/analytics?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">Analytics</a>:</strong> A built-in analytics dashboard to help you understand your application's traffic, including the number of unique visitors, page views, and more.</li> <li>\n<strong><a href=\"https://vercel.com/docs/speed-insights?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">Speed Insights</a>:</strong> Real-world performance insights based on visitor data, offering a practical view of how your website is performing in the field.</li> <li>\n<strong><a href=\"https://vercel.com/docs/observability/runtime-logs?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">Logging</a>:</strong> Runtime and Activity logs to help you debug issues and monitor your application in production. Alternatively, see the <a href=\"https://vercel.com/integrations?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">integrations page</a> for a list of third-party tools and services.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <p>To get a comprehensive understanding of the best practices for production deployments on Vercel, including detailed strategies for improving website performance, refer to the <a href=\"https://vercel.com/docs/production-checklist?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Production Checklist</a>.</p> </blockquote> <p>Following these recommendations will help you build a faster, more reliable, and secure application for your users.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/deploying/production-checklist\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/deploying/production-checklist</a>\n  </p>\n</div>\n","app/building-your-application/upgrading/version-14":"<h1 class=\"break-words\">Version 14</h1> <h2 id=\"upgrading-from-13-to-14\" data-docs-heading=\"\">Upgrading from 13 to 14     </h2> <p>To update to Next.js version 14, run the following command using your preferred package manager:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i next@latest react@latest react-dom@latest eslint-config-next@latest</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add next@latest react@latest react-dom@latest eslint-config-next@latest</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm up next react react-dom eslint-config-next --latest</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add next@latest react@latest react-dom@latest eslint-config-next@latest</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> If you are using TypeScript, ensure you also upgrade <code>@types/react</code> and <code>@types/react-dom</code> to their latest versions.</p> </blockquote> <h3 id=\"v14-summary\" data-docs-heading=\"\">v14 Summary     </h3> <ul> <li>The minimum Node.js version has been bumped from 16.14 to 18.17, since 16.x has reached end-of-life.</li> <li>The <code>next export</code> command has been removed in favor of <code>output: 'export'</code> config. Please see the <a href=\"../deploying/static-exports\" rel=\"noopener noreferrer\" target=\"_blank\">docs</a> for more information.</li> <li>The <code>next/server</code> import for <code>ImageResponse</code> was renamed to <code>next/og</code>. A <a href=\"codemods#next-og-import\">codemod is available</a> to safely and automatically rename your imports.</li> <li>The <code>@next/font</code> package has been fully removed in favor of the built-in <code>next/font</code>. A <a href=\"codemods#built-in-next-font\">codemod is available</a> to safely and automatically rename your imports.</li> <li>The WASM target for <code>next-swc</code> has been removed.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/version-14\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/upgrading/version-14</a>\n  </p>\n</div>\n","app/api-reference":"<h1 class=\"break-words\">API Reference</h1>\n<p>The Next.js API reference is divided into the following sections:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference</a>\n  </p>\n</div>\n","app/api-reference/components":"<h1 class=\"break-words\">Components</h1><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/components\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/components</a>\n  </p>\n</div>\n","app/api-reference/components/font":"<h1 class=\"break-words\">Font Module</h1> <p>This API reference will help you understand how to use <a href=\"../../building-your-application/optimizing/fonts#google-fonts\"><code>next/font/google</code></a> and <a href=\"../../building-your-application/optimizing/fonts#local-fonts\"><code>next/font/local</code></a>. For features and usage, please see the <a href=\"../../building-your-application/optimizing/fonts\">Optimizing Fonts</a> page.</p> <h3 id=\"font-function-arguments\" data-docs-heading=\"\">Font Function Arguments     </h3> <p>For usage, review <a href=\"../../building-your-application/optimizing/fonts#google-fonts\">Google Fonts</a> and <a href=\"../../building-your-application/optimizing/fonts#local-fonts\">Local Fonts</a>.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Key</th>\n<th><code>font/google</code></th>\n<th><code>font/local</code></th>\n<th>Type</th>\n<th>Required</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#src\"><code>src</code></a></td>\n<td></td>\n<td></td>\n<td>String or Array of Objects</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"#weight\"><code>weight</code></a></td>\n<td></td>\n<td></td>\n<td>String or Array</td>\n<td>Required/Optional</td>\n</tr>\n<tr>\n<td><a href=\"#style\"><code>style</code></a></td>\n<td></td>\n<td></td>\n<td>String or Array</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#subsets\"><code>subsets</code></a></td>\n<td></td>\n<td></td>\n<td>Array of Strings</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#axes\"><code>axes</code></a></td>\n<td></td>\n<td></td>\n<td>Array of Strings</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#display\"><code>display</code></a></td>\n<td></td>\n<td></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#preload\"><code>preload</code></a></td>\n<td></td>\n<td></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#fallback\"><code>fallback</code></a></td>\n<td></td>\n<td></td>\n<td>Array of Strings</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#adjustfontfallback\"><code>adjustFontFallback</code></a></td>\n<td></td>\n<td></td>\n<td>Boolean or String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#variable\"><code>variable</code></a></td>\n<td></td>\n<td></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#declarations\"><code>declarations</code></a></td>\n<td></td>\n<td></td>\n<td>Array of Objects</td>\n<td>-</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"src\" data-docs-heading=\"\">src     </h3> <p>The path of the font file as a string or an array of objects (with type <code>Array&lt;{path: string, weight?: string, style?: string}&gt;</code>) relative to the directory where the font loader function is called.</p> <p>Used in <code>next/font/local</code></p> <ul> <li>Required</li> </ul> <p>Examples:</p> <ul> <li>\n<code>src:'./fonts/my-font.woff2'</code> where <code>my-font.woff2</code> is placed in a directory named <code>fonts</code> inside the <code>app</code> directory</li> <li><code>src:[{path: './inter/Inter-Thin.ttf', weight: '100',},{path: './inter/Inter-Regular.ttf',weight: '400',},{path: './inter/Inter-Bold-Italic.ttf', weight: '700',style: 'italic',},]</code></li> <li>if the font loader function is called in <code>app/page.tsx</code> using <code>src:'../styles/fonts/my-font.ttf'</code>, then <code>my-font.ttf</code> is placed in <code>styles/fonts</code> at the root of the project</li> </ul> <h3 id=\"weight\" data-docs-heading=\"\">weight     </h3> <p>The font <a href=\"https://fonts.google.com/knowledge/glossary/weight\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>weight</code></a> with the following possibilities:</p> <ul> <li>A string with possible values of the weights available for the specific font or a range of values if it's a <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable</a> font</li> <li>An array of weight values if the font is not a <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable google font</a>. It applies to <code>next/font/google</code> only.</li> </ul> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Required if the font being used is <strong>not</strong> <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable</a>\n</li> </ul> <p>Examples:</p> <ul> <li>\n<code>weight: '400'</code>: A string for a single weight value - for the font <a href=\"https://fonts.google.com/specimen/Inter?query=inter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Inter</code></a>, the possible values are <code>'100'</code>, <code>'200'</code>, <code>'300'</code>, <code>'400'</code>, <code>'500'</code>, <code>'600'</code>, <code>'700'</code>, <code>'800'</code>, <code>'900'</code> or <code>'variable'</code> where <code>'variable'</code> is the default)</li> <li>\n<code>weight: '100 900'</code>: A string for the range between <code>100</code> and <code>900</code> for a variable font</li> <li>\n<code>weight: ['100','400','900']</code>: An array of 3 possible values for a non variable font</li> </ul> <h3 id=\"style\" data-docs-heading=\"\">style     </h3> <p>The font <a href=\"https://developer.mozilla.org/docs/Web/CSS/font-style\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>style</code></a> with the following possibilities:</p> <ul> <li>A string <a href=\"https://developer.mozilla.org/docs/Web/CSS/font-style#values\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">value</a> with default value of <code>'normal'</code>\n</li> <li>An array of style values if the font is not a <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable google font</a>. It applies to <code>next/font/google</code> only.</li> </ul> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>style: 'italic'</code>: A string - it can be <code>normal</code> or <code>italic</code> for <code>next/font/google</code>\n</li> <li>\n<code>style: 'oblique'</code>: A string - it can take any value for <code>next/font/local</code> but is expected to come from <a href=\"https://developer.mozilla.org/docs/Web/CSS/font-style\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">standard font styles</a>\n</li> <li>\n<code>style: ['italic','normal']</code>: An array of 2 values for <code>next/font/google</code> - the values are from <code>normal</code> and <code>italic</code>\n</li> </ul> <h3 id=\"subsets\" data-docs-heading=\"\">subsets     </h3> <p>The font <a href=\"https://fonts.google.com/knowledge/glossary/subsetting\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>subsets</code></a> defined by an array of string values with the names of each subset you would like to be <a href=\"../../building-your-application/optimizing/fonts#specifying-a-subset\">preloaded</a>. Fonts specified via <code>subsets</code> will have a link preload tag injected into the head when the <a href=\"#preload\"><code>preload</code></a> option is true, which is the default.</p> <p>Used in <code>next/font/google</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>subsets: ['latin']</code>: An array with the subset <code>latin</code>\n</li> </ul> <p>You can find a list of all subsets on the Google Fonts page for your font.</p> <h3 id=\"axes\" data-docs-heading=\"\">axes     </h3> <p>Some variable fonts have extra <code>axes</code> that can be included. By default, only the font weight is included to keep the file size down. The possible values of <code>axes</code> depend on the specific font.</p> <p>Used in <code>next/font/google</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>axes: ['slnt']</code>: An array with value <code>slnt</code> for the <code>Inter</code> variable font which has <code>slnt</code> as additional <code>axes</code> as shown <a href=\"https://fonts.google.com/variablefonts?vfquery=inter#font-families\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">here</a>. You can find the possible <code>axes</code> values for your font by using the filter on the <a href=\"https://fonts.google.com/variablefonts#font-families\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google variable fonts page</a> and looking for axes other than <code>wght</code>\n</li> </ul> <h3 id=\"display\" data-docs-heading=\"\">display     </h3> <p>The font <a href=\"https://developer.mozilla.org/docs/Web/CSS/@font-face/font-display\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>display</code></a> with possible string <a href=\"https://developer.mozilla.org/docs/Web/CSS/@font-face/font-display#values\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">values</a> of <code>'auto'</code>, <code>'block'</code>, <code>'swap'</code>, <code>'fallback'</code> or <code>'optional'</code> with default value of <code>'swap'</code>.</p> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>display: 'optional'</code>: A string assigned to the <code>optional</code> value</li> </ul> <h3 id=\"preload\" data-docs-heading=\"\">preload     </h3> <p>A boolean value that specifies whether the font should be <a href=\"../../building-your-application/optimizing/fonts#preloading\">preloaded</a> or not. The default is <code>true</code>.</p> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li><code>preload: false</code></li> </ul> <h3 id=\"fallback\" data-docs-heading=\"\">fallback     </h3> <p>The fallback font to use if the font cannot be loaded. An array of strings of fallback fonts with no default.</p> <ul> <li>Optional</li> </ul> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <p>Examples:</p> <ul> <li>\n<code>fallback: ['system-ui', 'arial']</code>: An array setting the fallback fonts to <code>system-ui</code> or <code>arial</code>\n</li> </ul> <h3 id=\"adjustfontfallback\" data-docs-heading=\"\">adjustFontFallback     </h3> <ul> <li>For <code>next/font/google</code>: A boolean value that sets whether an automatic fallback font should be used to reduce <a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a>. The default is <code>true</code>.</li> <li>For <code>next/font/local</code>: A string or boolean <code>false</code> value that sets whether an automatic fallback font should be used to reduce <a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a>. The possible values are <code>'Arial'</code>, <code>'Times New Roman'</code> or <code>false</code>. The default is <code>'Arial'</code>.</li> </ul> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>adjustFontFallback: false</code>: for <code>next/font/google</code>\n</li> <li>\n<code>adjustFontFallback: 'Times New Roman'</code>: for <code>next/font/local</code>\n</li> </ul> <h3 id=\"variable\" data-docs-heading=\"\">variable     </h3> <p>A string value to define the CSS variable name to be used if the style is applied with the <a href=\"#css-variables\">CSS variable method</a>.</p> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>variable: '--my-font'</code>: The CSS variable <code>--my-font</code> is declared</li> </ul> <h3 id=\"declarations\" data-docs-heading=\"\">declarations     </h3> <p>An array of font face <a href=\"https://developer.mozilla.org/docs/Web/CSS/@font-face#descriptors\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">descriptor</a> key-value pairs that define the generated <code>@font-face</code> further.</p> <p>Used in <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li><code>declarations: [{ prop: 'ascent-override', value: '90%' }]</code></li> </ul> <h2 id=\"applying-styles\" data-docs-heading=\"\">Applying Styles     </h2> <p>You can apply the font styles in three ways:</p> <ul> <li><a href=\"#classname\"><code>className</code></a></li> <li><a href=\"#style-1\"><code>style</code></a></li> <li><a href=\"#css-variables\">CSS Variables</a></li> </ul> <h3 id=\"classname\" data-docs-heading=\"\">className     </h3> <p>Returns a read-only CSS <code>className</code> for the loaded font to be passed to an HTML element.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;p className={inter.className}&gt;Hello, Next.js!&lt;/p&gt;</pre>\n</div> <h3 id=\"style-1\" data-docs-heading=\"\">style     </h3> <p>Returns a read-only CSS <code>style</code> object for the loaded font to be passed to an HTML element, including <code>style.fontFamily</code> to access the font family name and fallback fonts.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;p style={inter.style}&gt;Hello World&lt;/p&gt;</pre>\n</div> <h3 id=\"css-variables\" data-docs-heading=\"\">CSS Variables     </h3> <p>If you would like to set your styles in an external style sheet and specify additional options there, use the CSS variable method.</p> <p>In addition to importing the font, also import the CSS file where the CSS variable is defined and set the variable option of the font loader object as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'\nimport styles from '../styles/component.module.css'\n \nconst inter = Inter({\n  variable: '--font-inter',\n})</pre></div>  <p>To use the font, set the <code>className</code> of the parent container of the text you would like to style to the font loader's <code>variable</code> value and the <code>className</code> of the text to the <code>styles</code> property from the external CSS file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;main className={inter.variable}&gt;\n  &lt;p className={styles.text}&gt;Hello World&lt;/p&gt;\n&lt;/main&gt;</pre></div>  <p>Define the <code>text</code> selector class in the <code>component.module.css</code> CSS file as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.text {\n  font-family: var(--font-inter);\n  font-weight: 200;\n  font-style: italic;\n}</pre></div> <p>In the example above, the text <code>Hello World</code> is styled using the <code>Inter</code> font and the generated font fallback with <code>font-weight: 200</code> and <code>font-style: italic</code>.</p> <h2 id=\"using-a-font-definitions-file\" data-docs-heading=\"\">Using a font definitions file     </h2> <p>Every time you call the <code>localFont</code> or Google font function, that font will be hosted as one instance in your application. Therefore, if you need to use the same font in multiple places, you should load it in one place and import the related font object where you need it. This is done using a font definitions file.</p> <p>For example, create a <code>fonts.ts</code> file in a <code>styles</code> folder at the root of your app directory.</p> <p>Then, specify your font definitions as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter, Lora, Source_Sans_3 } from 'next/font/google'\nimport localFont from 'next/font/local'\n \n// define your variable fonts\nconst inter = Inter()\nconst lora = Lora()\n// define 2 weights of a non-variable font\nconst sourceCodePro400 = Source_Sans_3({ weight: '400' })\nconst sourceCodePro700 = Source_Sans_3({ weight: '700' })\n// define a custom local font where GreatVibes-Regular.ttf is stored in the styles folder\nconst greatVibes = localFont({ src: './GreatVibes-Regular.ttf' })\n \nexport { inter, lora, sourceCodePro400, sourceCodePro700, greatVibes }</pre></div>  <p>You can now use these definitions in your code as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { inter, lora, sourceCodePro700, greatVibes } from '../styles/fonts'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;p className={inter.className}&gt;Hello world using Inter font&lt;/p&gt;\n      &lt;p style={lora.style}&gt;Hello world using Lora font&lt;/p&gt;\n      &lt;p className={sourceCodePro700.className}&gt;\n        Hello world using Source_Sans_3 font with weight 700\n      &lt;/p&gt;\n      &lt;p className={greatVibes.className}&gt;My title in Great Vibes font&lt;/p&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>To make it easier to access the font definitions in your code, you can define a path alias in your <code>tsconfig.json</code> or <code>jsconfig.json</code> files as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@/fonts\": [\"./styles/fonts\"]\n    }\n  }\n}</pre></div> <p>You can now import any font definition as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { greatVibes, sourceCodePro400 } from '@/fonts'</pre></div>  <h2 id=\"version-changes\" data-docs-heading=\"\">Version Changes     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>\n<code>@next/font</code> renamed to <code>next/font</code>. Installation no longer required.</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>@next/font</code> was added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/components/font\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/components/font</a>\n  </p>\n</div>\n","app/api-reference/components/link":"<h1 class=\"break-words\">&lt;Link&gt;</h1>  <p><code>&lt;Link&gt;</code> is a React component that extends the HTML <code>&lt;a&gt;</code> element to provide <a href=\"../../building-your-application/routing/linking-and-navigating#2-prefetching\">prefetching</a> and client-side navigation between routes. It is the primary way to navigate between routes in Next.js.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return &lt;Link href=\"/dashboard\"&gt;Dashboard&lt;/Link&gt;\n}</pre></div>  <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <p>Here's a summary of the props available for the Link Component:</p>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Prop</th>\n<th>Example</th>\n<th>Type</th>\n<th>Required</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#href-required\"><code>href</code></a></td>\n<td><code>href=\"/dashboard\"</code></td>\n<td>String or Object</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"#replace\"><code>replace</code></a></td>\n<td><code>replace={false}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#scroll\"><code>scroll</code></a></td>\n<td><code>scroll={false}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#prefetch\"><code>prefetch</code></a></td>\n<td><code>prefetch={false}</code></td>\n<td>Boolean or null</td>\n<td>-</td>\n</tr>\n</tbody>\n</table></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>&lt;a&gt;</code> tag attributes such as <code>className</code> or <code>target=\"_blank\"</code> can be added to <code>&lt;Link&gt;</code> as props and will be passed to the underlying <code>&lt;a&gt;</code> element.</p> </blockquote> <h3 id=\"href-required\" data-docs-heading=\"\">href (required)     </h3> <p>The path or URL to navigate to.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/dashboard\"&gt;Dashboard&lt;/Link&gt;</pre>\n</div> <p><code>href</code> can also accept an object, for example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Navigate to /about?name=test\n&lt;Link\n  href={{\n    pathname: '/about',\n    query: { name: 'test' },\n  }}\n&gt;\n  About\n&lt;/Link&gt;</pre>\n</div> <h3 id=\"replace\" data-docs-heading=\"\">replace     </h3> <p><strong>Defaults to <code>false</code>.</strong> When <code>true</code>, <code>next/link</code> will replace the current history state instead of adding a new URL into the <a href=\"https://developer.mozilla.org/docs/Web/API/History_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">browsers history</a> stack.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;Link href=\"/dashboard\" replace&gt;\n      Dashboard\n    &lt;/Link&gt;\n  )\n}</pre></div>  <h3 id=\"scroll\" data-docs-heading=\"\">scroll     </h3> <p><strong>Defaults to <code>true</code>.</strong> The default behavior of <code>&lt;Link&gt;</code> <strong>is to scroll to the top of a new route or to maintain the scroll position for backwards and forwards navigation.</strong> When <code>false</code>, <code>next/link</code> will <em>not</em> scroll to the top of the page after a navigation.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;Link href=\"/dashboard\" scroll={false}&gt;\n      Dashboard\n    &lt;/Link&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Next.js will scroll to the <a href=\"../../building-your-application/routing/pages-and-layouts#pages\">Page</a> if it is not visible in the viewport upon navigation.</li> </ul> </blockquote> <h3 id=\"prefetch\" data-docs-heading=\"\">prefetch     </h3> <p>Prefetching happens when a <code>&lt;Link /&gt;</code> component enters the user's viewport (initially or through scroll). Next.js prefetches and loads the linked route (denoted by the <code>href</code>) and its data in the background to improve the performance of client-side navigations. Prefetching is only enabled in production.</p>\n<ul> <li>\n<strong><code>null</code> (default)</strong>: Prefetch behavior depends on whether the route is static or dynamic. For static routes, the full route will be prefetched (including all its data). For dynamic routes, the partial route down to the nearest segment with a <a href=\"../../building-your-application/routing/loading-ui-and-streaming#instant-loading-states\"><code>loading.js</code></a> boundary will be prefetched.</li> <li>\n<code>true</code>: The full route will be prefetched for both static and dynamic routes.</li> <li>\n<code>false</code>: Prefetching will never happen both on entering the viewport and on hover.</li> </ul>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;Link href=\"/dashboard\" prefetch={false}&gt;\n      Dashboard\n    &lt;/Link&gt;\n  )\n}</pre></div>  <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"linking-to-dynamic-routes\" data-docs-heading=\"\">Linking to Dynamic Routes     </h3> <p>For dynamic routes, it can be handy to use template literals to create the link's path.</p>  <p>For example, you can generate a list of links to the dynamic route <code>app/blog/[slug]/page.js</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Page({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li key={post.id}&gt;\n          &lt;Link href={`/blog/${post.slug}`}&gt;{post.title}&lt;/Link&gt;\n        &lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}</pre></div> <h3 id=\"if-the-child-is-a-custom-component-that-wraps-an-a-tag\" data-docs-heading=\"\">If the child is a custom component that wraps an &lt;a&gt; tag     </h3> <p>If the child of <code>Link</code> is a custom component that wraps an <code>&lt;a&gt;</code> tag, you must add <code>passHref</code> to <code>Link</code>. This is necessary if youre using libraries like <a href=\"https://styled-components.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">styled-components</a>. Without this, the <code>&lt;a&gt;</code> tag will not have the <code>href</code> attribute, which hurts your site's accessibility and might affect SEO. If you're using <a href=\"../../building-your-application/configuring/eslint#eslint-plugin\">ESLint</a>, there is a built-in rule <code>next/link-passhref</code> to ensure correct usage of <code>passHref</code>.</p>  <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\nimport styled from 'styled-components'\n \n// This creates a custom component that wraps an &lt;a&gt; tag\nconst RedLink = styled.a`\n  color: red;\n`\n \nfunction NavLink({ href, name }) {\n  return (\n    &lt;Link href={href} passHref legacyBehavior&gt;\n      &lt;RedLink&gt;{name}&lt;/RedLink&gt;\n    &lt;/Link&gt;\n  )\n}\n \nexport default NavLink</pre>\n</div> <ul> <li>If youre using <a href=\"https://emotion.sh/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">emotion</a>s JSX pragma feature (<code>@jsx jsx</code>), you must use <code>passHref</code> even if you use an <code>&lt;a&gt;</code> tag directly.</li> <li>The component should support <code>onClick</code> property to trigger navigation correctly</li> </ul> <h3 id=\"if-the-child-is-a-functional-component\" data-docs-heading=\"\">If the child is a functional component     </h3> <p>If the child of <code>Link</code> is a functional component, in addition to using <code>passHref</code> and <code>legacyBehavior</code>, you must wrap the component in <a href=\"https://react.dev/reference/react/forwardRef\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>React.forwardRef</code></a>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \n// `onClick`, `href`, and `ref` need to be passed to the DOM element\n// for proper handling\nconst MyButton = React.forwardRef(({ onClick, href }, ref) =&gt; {\n  return (\n    &lt;a href={href} onClick={onClick} ref={ref}&gt;\n      Click Me\n    &lt;/a&gt;\n  )\n})\n \nfunction Home() {\n  return (\n    &lt;Link href=\"/about\" passHref legacyBehavior&gt;\n      &lt;MyButton /&gt;\n    &lt;/Link&gt;\n  )\n}\n \nexport default Home</pre>\n</div> <h3 id=\"with-url-object\" data-docs-heading=\"\">With URL Object     </h3> <p><code>Link</code> can also receive a URL object and it will automatically format it to create the URL string. Here's how to do it:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Home() {\n  return (\n    &lt;ul&gt;\n      &lt;li&gt;\n        &lt;Link\n          href={{\n            pathname: '/about',\n            query: { name: 'test' },\n          }}\n        &gt;\n          About us\n        &lt;/Link&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;Link\n          href={{\n            pathname: '/blog/[slug]',\n            query: { slug: 'my-post' },\n          }}\n        &gt;\n          Blog Post\n        &lt;/Link&gt;\n      &lt;/li&gt;\n    &lt;/ul&gt;\n  )\n}\n \nexport default Home</pre>\n</div> <p>The above example has a link to:</p> <ul> <li>A predefined route: <code>/about?name=test</code>\n</li> <li>A <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route</a>: <code>/blog/my-post</code>\n</li> </ul> <p>You can use every property as defined in the <a href=\"https://nodejs.org/api/url.html#url_url_strings_and_url_objects\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.js URL module documentation</a>.</p> <h3 id=\"replace-the-url-instead-of-push\" data-docs-heading=\"\">Replace the URL instead of push     </h3> <p>The default behavior of the <code>Link</code> component is to <code>push</code> a new URL into the <code>history</code> stack. You can use the <code>replace</code> prop to prevent adding a new entry, as in the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/about\" replace&gt;\n  About us\n&lt;/Link&gt;</pre>\n</div> <h3 id=\"disable-scrolling-to-the-top-of-the-page\" data-docs-heading=\"\">Disable scrolling to the top of the page     </h3> <p>The default behavior of <code>Link</code> is to scroll to the top of the page. When there is a hash defined it will scroll to the specific id, like a normal <code>&lt;a&gt;</code> tag. To prevent scrolling to the top / hash <code>scroll={false}</code> can be added to <code>Link</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/#hashid\" scroll={false}&gt;\n  Disables scrolling to the top\n&lt;/Link&gt;</pre>\n</div> <h3 id=\"middleware\" data-docs-heading=\"\">Middleware     </h3> <p>It's common to use <a href=\"../../building-your-application/routing/middleware\">Middleware</a> for authentication or other purposes that involve rewriting the user to a different page. In order for the <code>&lt;Link /&gt;</code> component to properly prefetch links with rewrites via Middleware, you need to tell Next.js both the URL to display and the URL to prefetch. This is required to avoid un-necessary fetches to middleware to know the correct route to prefetch.</p> <p>For example, if you want to serve a <code>/dashboard</code> route that has authenticated and visitor views, you may add something similar to the following in your Middleware to redirect the user to the correct page:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function middleware(req) {\n  const nextUrl = req.nextUrl\n  if (nextUrl.pathname === '/dashboard') {\n    if (req.cookies.authToken) {\n      return NextResponse.rewrite(new URL('/auth/dashboard', req.url))\n    } else {\n      return NextResponse.rewrite(new URL('/public/dashboard', req.url))\n    }\n  }\n}</pre></div> <p>In this case, you would want to use the following code in your <code>&lt;Link /&gt;</code> component:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\nimport useIsAuthed from './hooks/useIsAuthed'\n \nexport default function Page() {\n  const isAuthed = useIsAuthed()\n  const path = isAuthed ? '/auth/dashboard' : '/public/dashboard'\n  return (\n    &lt;Link as=\"/dashboard\" href={path}&gt;\n      Dashboard\n    &lt;/Link&gt;\n  )\n}</pre>\n</div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>No longer requires a child <code>&lt;a&gt;</code> tag. A <a href=\"../../building-your-application/upgrading/codemods#remove-a-tags-from-link-components\">codemod</a> is provided to automatically update your codebase.</td>\n</tr>\n<tr>\n<td><code>v10.0.0</code></td>\n<td>\n<code>href</code> props pointing to a dynamic route are automatically resolved and no longer require an <code>as</code> prop.</td>\n</tr>\n<tr>\n<td><code>v8.0.0</code></td>\n<td>Improved prefetching performance.</td>\n</tr>\n<tr>\n<td><code>v1.0.0</code></td>\n<td>\n<code>next/link</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/components/link\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/components/link</a>\n  </p>\n</div>\n","app/api-reference/components/script":"<h1 class=\"break-words\">&lt;Script&gt;</h1> <p>This API reference will help you understand how to use <a href=\"#props\">props</a> available for the Script Component. For features and usage, please see the <a href=\"../../building-your-application/optimizing/scripts\">Optimizing Scripts</a> page.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Dashboard() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <p>Here's a summary of the props available for the Script Component:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Prop</th>\n<th>Example</th>\n<th>Type</th>\n<th>Required</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#src\"><code>src</code></a></td>\n<td><code>src=\"http://example.com/script\"</code></td>\n<td>String</td>\n<td>Required unless inline script is used</td>\n</tr>\n<tr>\n<td><a href=\"#strategy\"><code>strategy</code></a></td>\n<td><code>strategy=\"lazyOnload\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onload\"><code>onLoad</code></a></td>\n<td><code>onLoad={onLoadFunc}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onready\"><code>onReady</code></a></td>\n<td><code>onReady={onReadyFunc}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onerror\"><code>onError</code></a></td>\n<td><code>onError={onErrorFunc}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"required-props\" data-docs-heading=\"\">Required Props     </h2> <p>The <code>&lt;Script /&gt;</code> component requires the following properties.</p> <h3 id=\"src\" data-docs-heading=\"\">src     </h3> <p>A path string specifying the URL of an external script. This can be either an absolute external URL or an internal path. The <code>src</code> property is required unless an inline script is used.</p> <h2 id=\"optional-props\" data-docs-heading=\"\">Optional Props     </h2> <p>The <code>&lt;Script /&gt;</code> component accepts a number of additional properties beyond those which are required.</p> <h3 id=\"strategy\" data-docs-heading=\"\">strategy     </h3> <p>The loading strategy of the script. There are four different strategies that can be used:</p> <ul> <li>\n<code>beforeInteractive</code>: Load before any Next.js code and before any page hydration occurs.</li> <li>\n<code>afterInteractive</code>: (<strong>default</strong>) Load early but after some hydration on the page occurs.</li> <li>\n<code>lazyOnload</code>: Load during browser idle time.</li> <li>\n<code>worker</code>: (experimental) Load in a web worker.</li> </ul> <h3 id=\"beforeinteractive\" data-docs-heading=\"\">beforeInteractive     </h3> <p>Scripts that load with the <code>beforeInteractive</code> strategy are injected into the initial HTML from the server, downloaded before any Next.js module, and executed in the order they are placed before <em>any</em> hydration occurs on the page.</p> <p>Scripts denoted with this strategy are preloaded and fetched before any first-party code, but their execution does not block page hydration from occurring.</p> <p><code>beforeInteractive</code> scripts must be placed inside the root layout (<code>app/layout.tsx</code>) and are designed to load scripts that are needed by the entire site (i.e. the script will load when any page in the application has been loaded server-side).</p>  <p><strong>This strategy should only be used for critical scripts that need to be fetched before any part of the page becomes interactive.</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;\n        {children}\n        &lt;Script\n          src=\"https://example.com/script.js\"\n          strategy=\"beforeInteractive\"\n        /&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Scripts with <code>beforeInteractive</code> will always be injected inside the <code>head</code> of the HTML document regardless of where it's placed in the component.</p> </blockquote> <p>Some examples of scripts that should be loaded as soon as possible with <code>beforeInteractive</code> include:</p> <ul> <li>Bot detectors</li> <li>Cookie consent managers</li> </ul> <h3 id=\"afterinteractive\" data-docs-heading=\"\">afterInteractive     </h3> <p>Scripts that use the <code>afterInteractive</code> strategy are injected into the HTML client-side and will load after some (or all) hydration occurs on the page. <strong>This is the default strategy</strong> of the Script component and should be used for any script that needs to load as soon as possible but not before any first-party Next.js code.</p> <p><code>afterInteractive</code> scripts can be placed inside of any page or layout and will only load and execute when that page (or group of pages) is opened in the browser.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" strategy=\"afterInteractive\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <p>Some examples of scripts that are good candidates for <code>afterInteractive</code> include:</p> <ul> <li>Tag managers</li> <li>Analytics</li> </ul> <h3 id=\"lazyonload\" data-docs-heading=\"\">lazyOnload     </h3> <p>Scripts that use the <code>lazyOnload</code> strategy are injected into the HTML client-side during browser idle time and will load after all resources on the page have been fetched. This strategy should be used for any background or low priority scripts that do not need to load early.</p> <p><code>lazyOnload</code> scripts can be placed inside of any page or layout and will only load and execute when that page (or group of pages) is opened in the browser.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" strategy=\"lazyOnload\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <p>Examples of scripts that do not need to load immediately and can be fetched with <code>lazyOnload</code> include:</p> <ul> <li>Chat support plugins</li> <li>Social media widgets</li> </ul> <h3 id=\"worker\" data-docs-heading=\"\">worker     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> The <code>worker</code> strategy is not yet stable and does not yet work with the <a href=\"../../building-your-application/routing/defining-routes\"><code>app</code></a> directory. Use with caution.</p> </blockquote> <p>Scripts that use the <code>worker</code> strategy are off-loaded to a web worker in order to free up the main thread and ensure that only critical, first-party resources are processed on it. While this strategy can be used for any script, it is an advanced use case that is not guaranteed to support all third-party scripts.</p> <p>To use <code>worker</code> as a strategy, the <code>nextScriptWorkers</code> flag must be enabled in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    nextScriptWorkers: true,\n  },\n}</pre></div> <p><code>worker</code> scripts can <strong>only currently be used in the <code>pages/</code> directory</strong>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Home() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" strategy=\"worker\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"onload\" data-docs-heading=\"\">onLoad     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> <code>onLoad</code> does not yet work with Server Components and can only be used in Client Components. Further, <code>onLoad</code> can't be used with <code>beforeInteractive</code>  consider using <code>onReady</code> instead.</p> </blockquote> <p>Some third-party scripts require users to run JavaScript code once after the script has finished loading in order to instantiate content or call a function. If you are loading a script with either afterInteractive or lazyOnload as a loading strategy, you can execute code after it has loaded using the onLoad property.</p> <p>Here's an example of executing a lodash method only after the library has been loaded.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script\n        src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.min.js\"\n        onLoad={() =&gt; {\n          console.log(_.sample([1, 2, 3, 4]))\n        }}\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"onready\" data-docs-heading=\"\">onReady     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> <code>onReady</code> does not yet work with Server Components and can only be used in Client Components.</p> </blockquote> <p>Some third-party scripts require users to run JavaScript code after the script has finished loading and every time the component is mounted (after a route navigation for example). You can execute code after the script's load event when it first loads and then after every subsequent component re-mount using the onReady property.</p> <p>Here's an example of how to re-instantiate a Google Maps JS embed every time the component is mounted:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useRef } from 'react'\nimport Script from 'next/script'\n \nexport default function Page() {\n  const mapRef = useRef()\n \n  return (\n    &lt;&gt;\n      &lt;div ref={mapRef}&gt;&lt;/div&gt;\n      &lt;Script\n        id=\"google-maps\"\n        src=\"https://maps.googleapis.com/maps/api/js\"\n        onReady={() =&gt; {\n          new google.maps.Map(mapRef.current, {\n            center: { lat: -34.397, lng: 150.644 },\n            zoom: 8,\n          })\n        }}\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"onerror\" data-docs-heading=\"\">onError     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> <code>onError</code> does not yet work with Server Components and can only be used in Client Components. <code>onError</code> cannot be used with the <code>beforeInteractive</code> loading strategy.</p> </blockquote> <p>Sometimes it is helpful to catch when a script fails to load. These errors can be handled with the onError property:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script\n        src=\"https://example.com/script.js\"\n        onError={(e: Error) =&gt; {\n          console.error('Script failed to load', e)\n        }}\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>beforeInteractive</code> and <code>afterInteractive</code> is modified to support <code>app</code>.</td>\n</tr>\n<tr>\n<td><code>v12.2.4</code></td>\n<td>\n<code>onReady</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v12.2.2</code></td>\n<td>Allow <code>next/script</code> with <code>beforeInteractive</code> to be placed in <code>_document</code>.</td>\n</tr>\n<tr>\n<td><code>v11.0.0</code></td>\n<td>\n<code>next/script</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/components/script\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/components/script</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/layout":"<h1 class=\"break-words\">layout.js</h1>\n<p>A <strong>layout</strong> is UI that is shared between routes.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return &lt;section&gt;{children}&lt;/section&gt;\n}</pre></div>  <p>A <strong>root layout</strong> is the top-most layout in the root <code>app</code> directory. It is used to define the <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags and other globally shared UI.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <h3 id=\"children-required\" data-docs-heading=\"\">children (required)     </h3> <p>Layout components should accept and use a <code>children</code> prop. During rendering, <code>children</code> will be populated with the route segments the layout is wrapping. These will primarily be the component of a child <a href=\"../../building-your-application/routing/pages-and-layouts#pages\">Layout</a> (if it exists) or <a href=\"../../building-your-application/routing/pages-and-layouts#pages\">Page</a>, but could also be other special files like <a href=\"../../building-your-application/routing/loading-ui-and-streaming\">Loading</a> or <a href=\"../../building-your-application/routing/error-handling\">Error</a> when applicable.</p> <h3 id=\"params-optional\" data-docs-heading=\"\">params (optional)     </h3> <p>The <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route parameters</a> object from the root segment down to that layout.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Example</th>\n<th>URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/dashboard/[team]/layout.js</code></td>\n<td><code>/dashboard/1</code></td>\n<td><code>{ team: '1' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[tag]/[item]/layout.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ tag: '1', item: '2' }</code></td>\n</tr>\n<tr>\n<td><code>app/blog/[...slug]/layout.js</code></td>\n<td><code>/blog/1/2</code></td>\n<td><code>{ slug: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function ShopLayout({\n  children,\n  params,\n}: {\n  children: React.ReactNode\n  params: {\n    tag: string\n    item: string\n  }\n}) {\n  // URL -&gt; /shop/shoes/nike-air-max-97\n  // `params` -&gt; { tag: 'shoes', item: 'nike-air-max-97' }\n  return &lt;section&gt;{children}&lt;/section&gt;\n}</pre></div>  <h2 id=\"good-to-know\" data-docs-heading=\"\">Good to know     </h2> <h3 id=\"layouts-do-not-receive-searchparams\" data-docs-heading=\"\">Layouts do not receive searchParams     </h3> <p>Unlike <a href=\"page\">Pages</a>, Layout components <strong>do not</strong> receive the <code>searchParams</code> prop. This is because a shared layout is <a href=\"../../building-your-application/routing/linking-and-navigating#4-partial-rendering\">not re-rendered during navigation</a> which could lead to stale <code>searchParams</code> between navigations.</p> <p>When using client-side navigation, Next.js automatically only renders the part of the page below the common layout between two routes.</p> <p>For example, in the following directory structure, <code>dashboard/layout.tsx</code> is the common layout for both <code>/dashboard/settings</code> and <code>/dashboard/analytics</code>:</p> <figure><img alt=\"File structure showing a dashboard folder nesting a layout.tsx file, and settings and analytics folders with their own pages\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fshared-dashboard-layout.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fshared-dashboard-layout.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fshared-dashboard-layout.png&amp;w=3840&amp;q=75\"><img alt=\"File structure showing a dashboard folder nesting a layout.tsx file, and settings and analytics folders with their own pages\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fshared-dashboard-layout.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fshared-dashboard-layout.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fshared-dashboard-layout.png&amp;w=3840&amp;q=75\"></figure> <p>When navigating from <code>/dashboard/settings</code> to <code>/dashboard/analytics</code>, <code>page.tsx</code> in <code>/dashboard/analytics</code> will rerender on the server, while <code>dashboard/layout.tsx</code> will <strong>not</strong> rerender because it's a common UI shared between the two routes.</p> <p>This performance optimization allows navigation between pages that share a layout to be quicker as only the data fetching and rendering for the page has to run, instead of the entire route that could include shared layouts that fetch their own data.</p> <p>Because <code>dashboard/layout.tsx</code> doesn't re-render, the <code>searchParams</code> prop in the layout Server Component might become <strong>stale</strong> after navigation.</p> <ul> <li>Instead, use the Page <a href=\"page#searchparams-optional\"><code>searchParams</code></a> prop or the <a href=\"../functions/use-search-params\"><code>useSearchParams</code></a> hook in a Client Component, which is re-rendered on the client with the latest <code>searchParams</code>.</li> </ul> <h3 id=\"root-layouts\" data-docs-heading=\"\">Root Layouts     </h3> <ul> <li>The <code>app</code> directory <strong>must</strong> include a root <code>app/layout.js</code>.</li> <li>The root layout <strong>must</strong> define <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags. <ul> <li>You should <strong>not</strong> manually add <code>&lt;head&gt;</code> tags such as <code>&lt;title&gt;</code> and <code>&lt;meta&gt;</code> to root layouts. Instead, you should use the <a href=\"../functions/generate-metadata\">Metadata API</a> which automatically handles advanced requirements such as streaming and de-duplicating <code>&lt;head&gt;</code> elements.</li> </ul> </li> <li>You can use <a href=\"../../building-your-application/routing/route-groups\">route groups</a> to create multiple root layouts. <ul> <li>Navigating <strong>across multiple root layouts</strong> will cause a <strong>full page load</strong> (as opposed to a client-side navigation). For example, navigating from <code>/cart</code> that uses <code>app/(shop)/layout.js</code> to <code>/blog</code> that uses <code>app/(marketing)/layout.js</code> will cause a full page load. This <strong>only</strong> applies to multiple root layouts.</li> </ul> </li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>layout</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/layout\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/layout</a>\n  </p>\n</div>\n","app/building-your-application/upgrading/app-router-migration":"<h1 class=\"break-words\">App Router Incremental Adoption Guide</h1>\n<p>This guide will help you:</p> <ul> <li><a href=\"#nextjs-version\">Update your Next.js application from version 12 to version 13</a></li> <li><a href=\"#upgrading-new-features\">Upgrade features that work in both the <code>pages</code> and the <code>app</code> directories</a></li> <li><a href=\"#migrating-from-pages-to-app\">Incrementally migrate your existing application from <code>pages</code> to <code>app</code></a></li> </ul> <h2 id=\"upgrading\" data-docs-heading=\"\">Upgrading     </h2> <h3 id=\"nodejs-version\" data-docs-heading=\"\">Node.js Version     </h3> <p>The minimum Node.js version is now <strong>v18.17</strong>. See the <a href=\"https://nodejs.org/docs/latest-v18.x/api/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.js documentation</a> for more information.</p> <h3 id=\"nextjs-version\" data-docs-heading=\"\">Next.js Version     </h3> <p>To update to Next.js version 13, run the following command using your preferred package manager:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest react@latest react-dom@latest</pre></div> <h3 id=\"eslint-version\" data-docs-heading=\"\">ESLint Version     </h3> <p>If you're using ESLint, you need to upgrade your ESLint version:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D eslint-config-next@latest</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You may need to restart the ESLint server in VS Code for the ESLint changes to take effect. Open the Command Palette (<code>cmd+shift+p</code> on Mac; <code>ctrl+shift+p</code> on Windows) and search for <code>ESLint: Restart ESLint Server</code>.</p> </blockquote> <h2 id=\"next-steps\" data-docs-heading=\"\">Next Steps     </h2> <p>After you've updated, see the following sections for next steps:</p> <ul> <li>\n<a href=\"#upgrading-new-features\">Upgrade new features</a>: A guide to help you upgrade to new features such as the improved Image and Link Components.</li> <li>\n<a href=\"#migrating-from-pages-to-app\">Migrate from the <code>pages</code> to <code>app</code> directory</a>: A step-by-step guide to help you incrementally migrate from the <code>pages</code> to the <code>app</code> directory.</li> </ul> <h2 id=\"upgrading-new-features\" data-docs-heading=\"\">Upgrading New Features     </h2> <p>Next.js 13 introduced the new <a href=\"../routing\">App Router</a> with new features and conventions. The new Router is available in the <code>app</code> directory and co-exists with the <code>pages</code> directory.</p> <p>Upgrading to Next.js 13 does <strong>not</strong> require using the new <a href=\"../routing#the-app-router\">App Router</a>. You can continue using <code>pages</code> with new features that work in both directories, such as the updated <a href=\"#image-component\">Image component</a>, <a href=\"#link-component\">Link component</a>, <a href=\"#script-component\">Script component</a>, and <a href=\"#font-optimization\">Font optimization</a>.</p> <h3 id=\"image-component\" data-docs-heading=\"\">&lt;Image/&gt; Component     </h3> <p>Next.js 12 introduced new improvements to the Image Component with a temporary import: <code>next/future/image</code>. These improvements included less client-side JavaScript, easier ways to extend and style images, better accessibility, and native browser lazy loading.</p> <p>In version 13, this new behavior is now the default for <code>next/image</code>.</p> <p>There are two codemods to help you migrate to the new Image Component:</p> <ul> <li>\n<a href=\"codemods#next-image-to-legacy-image\"><strong><code>next-image-to-legacy-image</code> codemod</strong></a>: Safely and automatically renames <code>next/image</code> imports to <code>next/legacy/image</code>. Existing components will maintain the same behavior.</li> <li>\n<a href=\"codemods#next-image-experimental\"><strong><code>next-image-experimental</code> codemod</strong></a>: Dangerously adds inline styles and removes unused props. This will change the behavior of existing components to match the new defaults. To use this codemod, you need to run the <code>next-image-to-legacy-image</code> codemod first.</li> </ul> <h3 id=\"link-component\" data-docs-heading=\"\">&lt;Link&gt; Component     </h3> <p>The <a href=\"../routing/linking-and-navigating#link-component\"><code>&lt;Link&gt;</code> Component</a> no longer requires manually adding an <code>&lt;a&gt;</code> tag as a child. This behavior was added as an experimental option in <a href=\"https://nextjs.org/blog/next-12-2\" rel=\"noopener noreferrer\" target=\"_blank\">version 12.2</a> and is now the default. In Next.js 13, <code>&lt;Link&gt;</code> always renders <code>&lt;a&gt;</code> and allows you to forward props to the underlying tag.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \n// Next.js 12: `&lt;a&gt;` has to be nested otherwise it's excluded\n&lt;Link href=\"/about\"&gt;\n  &lt;a&gt;About&lt;/a&gt;\n&lt;/Link&gt;\n \n// Next.js 13: `&lt;Link&gt;` always renders `&lt;a&gt;` under the hood\n&lt;Link href=\"/about\"&gt;\n  About\n&lt;/Link&gt;</pre>\n</div> <p>To upgrade your links to Next.js 13, you can use the <a href=\"codemods#new-link\"><code>new-link</code> codemod</a>.</p> <h3 id=\"script-component\" data-docs-heading=\"\">&lt;Script&gt; Component     </h3> <p>The behavior of <a href=\"../../api-reference/components/script\"><code>next/script</code></a> has been updated to support both <code>pages</code> and <code>app</code>, but some changes need to be made to ensure a smooth migration:</p> <ul> <li>Move any <code>beforeInteractive</code> scripts you previously included in <code>_document.js</code> to the root layout file (<code>app/layout.tsx</code>).</li> <li>The experimental <code>worker</code> strategy does not yet work in <code>app</code> and scripts denoted with this strategy will either have to be removed or modified to use a different strategy (e.g. <code>lazyOnload</code>).</li> <li>\n<code>onLoad</code>, <code>onReady</code>, and <code>onError</code> handlers will not work in Server Components so make sure to move them to a <a href=\"../rendering/server-components\">Client Component</a> or remove them altogether.</li> </ul> <h3 id=\"font-optimization\" data-docs-heading=\"\">Font Optimization     </h3> <p>Previously, Next.js helped you optimize fonts by <a href=\"../optimizing/fonts\">inlining font CSS</a>. Version 13 introduces the new <a href=\"../optimizing/fonts\"><code>next/font</code></a> module which gives you the ability to customize your font loading experience while still ensuring great performance and privacy. <code>next/font</code> is supported in both the <code>pages</code> and <code>app</code> directories.</p> <p>While <a href=\"../optimizing/fonts\">inlining CSS</a> still works in <code>pages</code>, it does not work in <code>app</code>. You should use <a href=\"../optimizing/fonts\"><code>next/font</code></a> instead.</p> <p>See the <a href=\"../optimizing/fonts\">Font Optimization</a> page to learn how to use <code>next/font</code>.</p> <h2 id=\"migrating-from-pages-to-app\" data-docs-heading=\"\">Migrating from pages to app     </h2> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn how to incrementally adopt the App Router  <a href=\"https://www.youtube.com/watch?v=YQMSietiFm0\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (16 minutes)</a>.</p> </blockquote> <p>Moving to the App Router may be the first time using React features that Next.js builds on top of such as Server Components, Suspense, and more. When combined with new Next.js features such as <a href=\"../routing#file-conventions\">special files</a> and <a href=\"../routing/pages-and-layouts#layouts\">layouts</a>, migration means new concepts, mental models, and behavioral changes to learn.</p> <p>We recommend reducing the combined complexity of these updates by breaking down your migration into smaller steps. The <code>app</code> directory is intentionally designed to work simultaneously with the <code>pages</code> directory to allow for incremental page-by-page migration.</p> <ul> <li>The <code>app</code> directory supports nested routes <em>and</em> layouts. <a href=\"../routing\">Learn more</a>.</li> <li>Use nested folders to <a href=\"../routing/defining-routes\">define routes</a> and a special <code>page.js</code> file to make a route segment publicly accessible. <a href=\"#step-4-migrating-pages\">Learn more</a>.</li> <li>\n<a href=\"../routing#file-conventions\">Special file conventions</a> are used to create UI for each route segment. The most common special files are <code>page.js</code> and <code>layout.js</code>. <ul> <li>Use <code>page.js</code> to define UI unique to a route.</li> <li>Use <code>layout.js</code> to define UI that is shared across multiple routes.</li> <li>\n<code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> file extensions can be used for special files.</li> </ul> </li> <li>You can colocate other files inside the <code>app</code> directory such as components, styles, tests, and more. <a href=\"../routing\">Learn more</a>.</li> <li>Data fetching functions like <code>getServerSideProps</code> and <code>getStaticProps</code> have been replaced with <a href=\"../data-fetching\">a new API</a> inside <code>app</code>. <code>getStaticPaths</code> has been replaced with <a href=\"../../api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a>.</li> <li>\n<code>pages/_app.js</code> and <code>pages/_document.js</code> have been replaced with a single <code>app/layout.js</code> root layout. <a href=\"../routing/pages-and-layouts#root-layout-required\">Learn more</a>.</li> <li>\n<code>pages/_error.js</code> has been replaced with more granular <code>error.js</code> special files. <a href=\"../routing/error-handling\">Learn more</a>.</li> <li>\n<code>pages/404.js</code> has been replaced with the <a href=\"../../api-reference/file-conventions/not-found\"><code>not-found.js</code></a> file.</li> <li>\n<code>pages/api/*</code> API Routes have been replaced with the <a href=\"../../api-reference/file-conventions/route\"><code>route.js</code></a> (Route Handler) special file.</li> </ul> <h3 id=\"step-1-creating-the-app-directory\" data-docs-heading=\"\">Step 1: Creating the app directory     </h3> <p>Update to the latest Next.js version (requires 13.4 or greater):</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest</pre>\n</div> <p>Then, create a new <code>app</code> directory at the root of your project (or <code>src/</code> directory).</p> <h3 id=\"step-2-creating-a-root-layout\" data-docs-heading=\"\">Step 2: Creating a Root Layout     </h3> <p>Create a new <code>app/layout.tsx</code> file inside the <code>app</code> directory. This is a <a href=\"../routing/pages-and-layouts#root-layout-required\">root layout</a> that will apply to all routes inside <code>app</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  // Layouts must accept a children prop.\n  // This will be populated with nested layouts or pages\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <ul> <li>The <code>app</code> directory <strong>must</strong> include a root layout.</li> <li>The root layout must define <code>&lt;html&gt;</code>, and <code>&lt;body&gt;</code> tags since Next.js does not automatically create them</li> <li>The root layout replaces the <code>pages/_app.tsx</code> and <code>pages/_document.tsx</code> files.</li> <li>\n<code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> extensions can be used for layout files.</li> </ul> <p>To manage <code>&lt;head&gt;</code> HTML elements, you can use the <a href=\"../optimizing/metadata\">built-in SEO support</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'Home',\n  description: 'Welcome to Next.js',\n}</pre></div>  <h4 id=\"migrating-_documentjs-and-_appjs\" data-docs-heading=\"\">Migrating _document.js and _app.js     </h4> <p>If you have an existing <code>_app</code> or <code>_document</code> file, you can copy the contents (e.g. global styles) to the root layout (<code>app/layout.tsx</code>). Styles in <code>app/layout.tsx</code> will <em>not</em> apply to <code>pages/*</code>. You should keep <code>_app</code>/<code>_document</code> while migrating to prevent your <code>pages/*</code> routes from breaking. Once fully migrated, you can then safely delete them.</p> <p>If you are using any React Context providers, they will need to be moved to a <a href=\"../rendering/client-components\">Client Component</a>.</p> <h4 id=\"migrating-the-getlayout-pattern-to-layouts-optional\" data-docs-heading=\"\">Migrating the getLayout() pattern to Layouts (Optional)     </h4> <p>Next.js recommended adding a <a href=\"#\">property to Page components</a> to achieve per-page layouts in the <code>pages</code> directory. This pattern can be replaced with native support for <a href=\"../routing/pages-and-layouts#layouts\">nested layouts</a> in the <code>app</code> directory.</p> <details><summary>See before and after example</summary><p><strong>Before</strong></p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function DashboardLayout({ children }) {\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;My Dashboard&lt;/h2&gt;\n      {children}\n    &lt;/div&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import DashboardLayout from '../components/DashboardLayout'\n \nexport default function Page() {\n  return &lt;p&gt;My Page&lt;/p&gt;\n}\n \nPage.getLayout = function getLayout(page) {\n  return &lt;DashboardLayout&gt;{page}&lt;/DashboardLayout&gt;\n}</pre></div>\n<p><strong>After</strong></p>\n<ul> <li> <p>Remove the <code>Page.getLayout</code> property from <code>pages/dashboard/index.js</code> and follow the <a href=\"#step-4-migrating-pages\">steps for migrating pages</a> to the <code>app</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return &lt;p&gt;My Page&lt;/p&gt;\n}</pre></div> </li> <li> <p>Move the contents of <code>DashboardLayout</code> into a new <a href=\"../rendering/client-components\">Client Component</a> to retain <code>pages</code> directory behavior.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client' // this directive should be at top of the file, before any imports.\n \n// This is a Client Component\nexport default function DashboardLayout({ children }) {\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;My Dashboard&lt;/h2&gt;\n      {children}\n    &lt;/div&gt;\n  )\n}</pre></div> </li> <li> <p>Import the <code>DashboardLayout</code> into a new <code>layout.js</code> file inside the <code>app</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import DashboardLayout from './DashboardLayout'\n \n// This is a Server Component\nexport default function Layout({ children }) {\n  return &lt;DashboardLayout&gt;{children}&lt;/DashboardLayout&gt;\n}</pre></div> </li> <li> <p>You can incrementally move non-interactive parts of <code>DashboardLayout.js</code> (Client Component) into <code>layout.js</code> (Server Component) to reduce the amount of component JavaScript you send to the client.</p> </li> </ul></details> <h3 id=\"step-3-migrating-nexthead\" data-docs-heading=\"\">Step 3: Migrating next/head     </h3> <p>In the <code>pages</code> directory, the <code>next/head</code> React component is used to manage <code>&lt;head&gt;</code> HTML elements such as <code>title</code> and <code>meta</code> . In the <code>app</code> directory, <code>next/head</code> is replaced with the new <a href=\"../optimizing/metadata\">built-in SEO support</a>.</p> <p><strong>Before:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Head from 'next/head'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Head&gt;\n        &lt;title&gt;My page title&lt;/title&gt;\n      &lt;/Head&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p><strong>After:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'My Page Title',\n}\n \nexport default function Page() {\n  return '...'\n}</pre></div>  <p><a href=\"../../api-reference/functions/generate-metadata\">See all metadata options</a>.</p> <h3 id=\"step-4-migrating-pages\" data-docs-heading=\"\">Step 4: Migrating Pages     </h3> <ul> <li>Pages in the <a href=\"../routing\"><code>app</code> directory</a> are <a href=\"../rendering/server-components\">Server Components</a> by default. This is different from the <code>pages</code> directory where pages are <a href=\"../rendering/client-components\">Client Components</a>.</li> <li>\n<a href=\"../data-fetching\">Data fetching</a> has changed in <code>app</code>. <code>getServerSideProps</code>, <code>getStaticProps</code> and <code>getInitialProps</code> have been replaced with a simpler API.</li> <li>The <code>app</code> directory uses nested folders to <a href=\"../routing/defining-routes\">define routes</a> and a special <code>page.js</code> file to make a route segment publicly accessible.</li> <li> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>\n<code>pages</code> Directory</th>\n<th>\n<code>app</code> Directory</th>\n<th>Route</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>index.js</code></td>\n<td><code>page.js</code></td>\n<td><code>/</code></td>\n</tr>\n<tr>\n<td><code>about.js</code></td>\n<td><code>about/page.js</code></td>\n<td><code>/about</code></td>\n</tr>\n<tr>\n<td><code>blog/[slug].js</code></td>\n<td><code>blog/[slug]/page.js</code></td>\n<td><code>/blog/post-1</code></td>\n</tr>\n</tbody>\n</table></div> </li> </ul> <p>We recommend breaking down the migration of a page into two main steps:</p> <ul> <li>Step 1: Move the default exported Page Component into a new Client Component.</li> <li>Step 2: Import the new Client Component into a new <code>page.js</code> file inside the <code>app</code> directory.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This is the easiest migration path because it has the most comparable behavior to the <code>pages</code> directory.</p> </blockquote> <p><strong>Step 1: Create a new Client Component</strong></p> <ul> <li>Create a new separate file inside the <code>app</code> directory (i.e. <code>app/home-page.tsx</code> or similar) that exports a Client Component. To define Client Components, add the <code>'use client'</code> directive to the top of the file (before any imports). <ul> <li>Similar to the Pages Router, there is an <a href=\"../rendering/client-components#full-page-load\">optimization step</a> to prerender Client Components to static HTML on the initial page load.</li> </ul> </li> <li>Move the default exported page component from <code>pages/index.js</code> to <code>app/home-page.tsx</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \n// This is a Client Component (same as components in the `pages` directory)\n// It receives data as props, has access to state and effects, and is\n// prerendered on the server during the initial page load.\nexport default function HomePage({ recentPosts }) {\n  return (\n    &lt;div&gt;\n      {recentPosts.map((post) =&gt; (\n        &lt;div key={post.id}&gt;{post.title}&lt;/div&gt;\n      ))}\n    &lt;/div&gt;\n  )\n}</pre></div>  <p><strong>Step 2: Create a new page</strong></p> <ul> <li> <p>Create a new <code>app/page.tsx</code> file inside the <code>app</code> directory. This is a Server Component by default.</p> </li> <li> <p>Import the <code>home-page.tsx</code> Client Component into the page.</p> </li> <li> <p>If you were fetching data in <code>pages/index.js</code>, move the data fetching logic directly into the Server Component using the new <a href=\"../data-fetching/fetching-caching-and-revalidating\">data fetching APIs</a>. See the <a href=\"#step-6-migrating-data-fetching-methods\">data fetching upgrade guide</a> for more details.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Import your Client Component\nimport HomePage from './home-page'\n \nasync function getPosts() {\n  const res = await fetch('https://...')\n  const posts = await res.json()\n  return posts\n}\n \nexport default async function Page() {\n  // Fetch data directly in a Server Component\n  const recentPosts = await getPosts()\n  // Forward fetched data to your Client Component\n  return &lt;HomePage recentPosts={recentPosts} /&gt;\n}</pre></div>  </li> <li> <p>If your previous page used <code>useRouter</code>, you'll need to update to the new routing hooks. <a href=\"../../api-reference/functions/use-router\">Learn more</a>.</p> </li> <li> <p>Start your development server and visit <a href=\"http://localhost:3000\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>http://localhost:3000</code></a>. You should see your existing index route, now served through the app directory.</p> </li> </ul> <h3 id=\"step-5-migrating-routing-hooks\" data-docs-heading=\"\">Step 5: Migrating Routing Hooks     </h3> <p>A new router has been added to support the new behavior in the <code>app</code> directory.</p> <p>In <code>app</code>, you should use the three new hooks imported from <code>next/navigation</code>: <a href=\"../../api-reference/functions/use-router\"><code>useRouter()</code></a>, <a href=\"../../api-reference/functions/use-pathname\"><code>usePathname()</code></a>, and <a href=\"../../api-reference/functions/use-search-params\"><code>useSearchParams()</code></a>.</p> <ul> <li>The new <code>useRouter</code> hook is imported from <code>next/navigation</code> and has different behavior to the <code>useRouter</code> hook in <code>pages</code> which is imported from <code>next/router</code>. <ul> <li>The <a href=\"../../../pages/api-reference/functions/use-router\"><code>useRouter</code> hook imported from <code>next/router</code></a> is not supported in the <code>app</code> directory but can continue to be used in the <code>pages</code> directory.</li> </ul> </li> <li>The new <code>useRouter</code> does not return the <code>pathname</code> string. Use the separate <code>usePathname</code> hook instead.</li> <li>The new <code>useRouter</code> does not return the <code>query</code> object. Use the separate <code>useSearchParams</code> hook instead.</li> <li>You can use <code>useSearchParams</code> and <code>usePathname</code> together to listen to page changes. See the <a href=\"../../api-reference/functions/use-router#router-events\">Router Events</a> section for more details.</li> <li>These new hooks are only supported in Client Components. They cannot be used in Server Components.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useRouter, usePathname, useSearchParams } from 'next/navigation'\n \nexport default function ExampleClientComponent() {\n  const router = useRouter()\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n \n  // ...\n}</pre></div>  <p>In addition, the new <code>useRouter</code> hook has the following changes:</p> <ul> <li>\n<code>isFallback</code> has been removed because <code>fallback</code> has <a href=\"#replacing-fallback\">been replaced</a>.</li> <li>The <code>locale</code>, <code>locales</code>, <code>defaultLocales</code>, <code>domainLocales</code> values have been removed because built-in i18n Next.js features are no longer necessary in the <code>app</code> directory. <a href=\"../routing/internationalization\">Learn more about i18n</a>.</li> <li>\n<code>basePath</code> has been removed. The alternative will not be part of <code>useRouter</code>. It has not yet been implemented.</li> <li>\n<code>asPath</code> has been removed because the concept of <code>as</code> has been removed from the new router.</li> <li>\n<code>isReady</code> has been removed because it is no longer necessary. During <a href=\"../rendering/server-components#static-rendering-default\">static rendering</a>, any component that uses the <a href=\"../../api-reference/functions/use-search-params\"><code>useSearchParams()</code></a> hook will skip the prerendering step and instead be rendered on the client at runtime.</li> </ul> <p><a href=\"../../api-reference/functions/use-router\">View the <code>useRouter()</code> API reference</a>.</p> <h3 id=\"step-6-migrating-data-fetching-methods\" data-docs-heading=\"\">Step 6: Migrating Data Fetching Methods     </h3> <p>The <code>pages</code> directory uses <code>getServerSideProps</code> and <code>getStaticProps</code> to fetch data for pages. Inside the <code>app</code> directory, these previous data fetching functions are replaced with a <a href=\"../data-fetching\">simpler API</a> built on top of <code>fetch()</code> and <code>async</code> React Server Components.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function Page() {\n  // This request should be cached until manually invalidated.\n  // Similar to `getStaticProps`.\n  // `force-cache` is the default and can be omitted.\n  const staticData = await fetch(`https://...`, { cache: 'force-cache' })\n \n  // This request should be refetched on every request.\n  // Similar to `getServerSideProps`.\n  const dynamicData = await fetch(`https://...`, { cache: 'no-store' })\n \n  // This request should be cached with a lifetime of 10 seconds.\n  // Similar to `getStaticProps` with the `revalidate` option.\n  const revalidatedData = await fetch(`https://...`, {\n    next: { revalidate: 10 },\n  })\n \n  return &lt;div&gt;...&lt;/div&gt;\n}</pre></div>  <h4 id=\"server-side-rendering-getserversideprops\" data-docs-heading=\"\">Server-side Rendering (getServerSideProps)     </h4> <p>In the <code>pages</code> directory, <code>getServerSideProps</code> is used to fetch data on the server and forward props to the default exported React component in the file. The initial HTML for the page is prerendered from the server, followed by \"hydrating\" the page in the browser (making it interactive).</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getServerSideProps() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n \n  return { props: { projects } }\n}\n \nexport default function Dashboard({ projects }) {\n  return (\n    &lt;ul&gt;\n      {projects.map((project) =&gt; (\n        &lt;li key={project.id}&gt;{project.name}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}</pre></div> <p>In the <code>app</code> directory, we can colocate our data fetching inside our React components using <a href=\"../rendering/server-components\">Server Components</a>. This allows us to send less JavaScript to the client, while maintaining the rendered HTML from the server.</p> <p>By setting the <code>cache</code> option to <code>no-store</code>, we can indicate that the fetched data should <a href=\"../data-fetching/fetching-caching-and-revalidating\">never be cached</a>. This is similar to <code>getServerSideProps</code> in the <code>pages</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\n \n// This function can be named anything\nasync function getProjects() {\n  const res = await fetch(`https://...`, { cache: 'no-store' })\n  const projects = await res.json()\n \n  return projects\n}\n \nexport default async function Dashboard() {\n  const projects = await getProjects()\n \n  return (\n    &lt;ul&gt;\n      {projects.map((project) =&gt; (\n        &lt;li key={project.id}&gt;{project.name}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}</pre></div>  <h4 id=\"accessing-request-object\" data-docs-heading=\"\">Accessing Request Object     </h4> <p>In the <code>pages</code> directory, you can retrieve request-based data based on the Node.js HTTP API.</p> <p>For example, you can retrieve the <code>req</code> object from <code>getServerSideProps</code> and use it to retrieve the request's cookies and headers.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getServerSideProps({ req, query }) {\n  const authHeader = req.getHeaders()['authorization'];\n  const theme = req.cookies['theme'];\n \n  return { props: { ... }}\n}\n \nexport default function Page(props) {\n  return ...\n}</pre></div> <p>The <code>app</code> directory exposes new read-only functions to retrieve request data:</p> <ul> <li>\n<a href=\"../../api-reference/functions/headers\"><code>headers()</code></a>: Based on the Web Headers API, and can be used inside <a href=\"../rendering/server-components\">Server Components</a> to retrieve request headers.</li> <li>\n<a href=\"../../api-reference/functions/cookies\"><code>cookies()</code></a>: Based on the Web Cookies API, and can be used inside <a href=\"../rendering/server-components\">Server Components</a> to retrieve cookies.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\nimport { cookies, headers } from 'next/headers'\n \nasync function getData() {\n  const authHeader = headers().get('authorization')\n \n  return '...'\n}\n \nexport default async function Page() {\n  // You can use `cookies()` or `headers()` inside Server Components\n  // directly or in your data fetching function\n  const theme = cookies().get('theme')\n  const data = await getData()\n  return '...'\n}</pre></div>  <h4 id=\"static-site-generation-getstaticprops\" data-docs-heading=\"\">Static Site Generation (getStaticProps)     </h4> <p>In the <code>pages</code> directory, the <code>getStaticProps</code> function is used to pre-render a page at build time. This function can be used to fetch data from an external API or directly from a database, and pass this data down to the entire page as it's being generated during the build.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getStaticProps() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n \n  return { props: { projects } }\n}\n \nexport default function Index({ projects }) {\n  return projects.map((project) =&gt; &lt;div&gt;{project.name}&lt;/div&gt;)\n}</pre></div> <p>In the <code>app</code> directory, data fetching with <a href=\"../../api-reference/functions/fetch\"><code>fetch()</code></a> will default to <code>cache: 'force-cache'</code>, which will cache the request data until manually invalidated. This is similar to <code>getStaticProps</code> in the <code>pages</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\n \n// This function can be named anything\nasync function getProjects() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n \n  return projects\n}\n \nexport default async function Index() {\n  const projects = await getProjects()\n \n  return projects.map((project) =&gt; &lt;div&gt;{project.name}&lt;/div&gt;)\n}</pre></div> <h4 id=\"dynamic-paths-getstaticpaths\" data-docs-heading=\"\">Dynamic paths (getStaticPaths)     </h4> <p>In the <code>pages</code> directory, the <code>getStaticPaths</code> function is used to define the dynamic paths that should be pre-rendered at build time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\nimport PostLayout from '@/components/post-layout'\n \nexport async function getStaticPaths() {\n  return {\n    paths: [{ params: { id: '1' } }, { params: { id: '2' } }],\n  }\n}\n \nexport async function getStaticProps({ params }) {\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n \n  return { props: { post } }\n}\n \nexport default function Post({ post }) {\n  return &lt;PostLayout post={post} /&gt;\n}</pre></div> <p>In the <code>app</code> directory, <code>getStaticPaths</code> is replaced with <a href=\"../../api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a>.</p> <p><a href=\"../../api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a> behaves similarly to <code>getStaticPaths</code>, but has a simplified API for returning route parameters and can be used inside <a href=\"../routing/pages-and-layouts\">layouts</a>. The return shape of <code>generateStaticParams</code> is an array of segments instead of an array of nested <code>param</code> objects or a string of resolved paths.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\nimport PostLayout from '@/components/post-layout'\n \nexport async function generateStaticParams() {\n  return [{ id: '1' }, { id: '2' }]\n}\n \nasync function getPost(params) {\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n \n  return post\n}\n \nexport default async function Post({ params }) {\n  const post = await getPost(params)\n \n  return &lt;PostLayout post={post} /&gt;\n}</pre></div> <p>Using the name <code>generateStaticParams</code> is more appropriate than <code>getStaticPaths</code> for the new model in the <code>app</code> directory. The <code>get</code> prefix is replaced with a more descriptive <code>generate</code>, which sits better alone now that <code>getStaticProps</code> and <code>getServerSideProps</code> are no longer necessary. The <code>Paths</code> suffix is replaced by <code>Params</code>, which is more appropriate for nested routing with multiple dynamic segments.</p> <hr> <h4 id=\"replacing-fallback\" data-docs-heading=\"\">Replacing fallback     </h4> <p>In the <code>pages</code> directory, the <code>fallback</code> property returned from <code>getStaticPaths</code> is used to define the behavior of a page that isn't pre-rendered at build time. This property can be set to <code>true</code> to show a fallback page while the page is being generated, <code>false</code> to show a 404 page, or <code>blocking</code> to generate the page at request time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getStaticPaths() {\n  return {\n    paths: [],\n    fallback: 'blocking'\n  };\n}\n \nexport async function getStaticProps({ params }) {\n  ...\n}\n \nexport default function Post({ post }) {\n  return ...\n}</pre></div> <p>In the <code>app</code> directory the <a href=\"../../api-reference/file-conventions/route-segment-config#dynamicparams\"><code>config.dynamicParams</code> property</a> controls how params outside of <a href=\"../../api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a> are handled:</p> <ul> <li>\n<strong><code>true</code></strong>: (default) Dynamic segments not included in <code>generateStaticParams</code> are generated on demand.</li> <li>\n<strong><code>false</code></strong>: Dynamic segments not included in <code>generateStaticParams</code> will return a 404.</li> </ul> <p>This replaces the <code>fallback: true | false | 'blocking'</code> option of <code>getStaticPaths</code> in the <code>pages</code> directory. The <code>fallback: 'blocking'</code> option is not included in <code>dynamicParams</code> because the difference between <code>'blocking'</code> and <code>true</code> is negligible with streaming.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\n \nexport const dynamicParams = true;\n \nexport async function generateStaticParams() {\n  return [...]\n}\n \nasync function getPost(params) {\n  ...\n}\n \nexport default async function Post({ params }) {\n  const post = await getPost(params);\n \n  return ...\n}</pre></div> <p>With <a href=\"../../api-reference/file-conventions/route-segment-config#dynamicparams\"><code>dynamicParams</code></a> set to <code>true</code> (the default), when a route segment is requested that hasn't been generated, it will be server-rendered and cached.</p> <h4 id=\"incremental-static-regeneration-getstaticprops-with-revalidate\" data-docs-heading=\"\">Incremental Static Regeneration (getStaticProps with revalidate)     </h4> <p>In the <code>pages</code> directory, the <code>getStaticProps</code> function allows you to add a <code>revalidate</code> field to automatically regenerate a page after a certain amount of time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getStaticProps() {\n  const res = await fetch(`https://.../posts`)\n  const posts = await res.json()\n \n  return {\n    props: { posts },\n    revalidate: 60,\n  }\n}\n \nexport default function Index({ posts }) {\n  return (\n    &lt;Layout&gt;\n      &lt;PostList posts={posts} /&gt;\n    &lt;/Layout&gt;\n  )\n}</pre></div> <p>In the <code>app</code> directory, data fetching with <a href=\"../../api-reference/functions/fetch\"><code>fetch()</code></a> can use <code>revalidate</code>, which will cache the request for the specified amount of seconds.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\n \nasync function getPosts() {\n  const res = await fetch(`https://.../posts`, { next: { revalidate: 60 } })\n  const data = await res.json()\n \n  return data.posts\n}\n \nexport default async function PostList() {\n  const posts = await getPosts()\n \n  return posts.map((post) =&gt; &lt;div&gt;{post.name}&lt;/div&gt;)\n}</pre></div> <h4 id=\"api-routes\" data-docs-heading=\"\">API Routes     </h4> <p>API Routes continue to work in the <code>pages/api</code> directory without any changes. However, they have been replaced by <a href=\"../routing/route-handlers\">Route Handlers</a> in the <code>app</code> directory.</p> <p>Route Handlers allow you to create custom request handlers for a given route using the Web <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Request</a> and <a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Response</a> APIs.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET(request: Request) {}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you previously used API routes to call an external API from the client, you can now use <a href=\"../rendering/server-components\">Server Components</a> instead to securely fetch data. Learn more about <a href=\"../data-fetching/fetching-caching-and-revalidating\">data fetching</a>.</p> </blockquote> <h3 id=\"step-7-styling\" data-docs-heading=\"\">Step 7: Styling     </h3> <p>In the <code>pages</code> directory, global stylesheets are restricted to only <code>pages/_app.js</code>. With the <code>app</code> directory, this restriction has been lifted. Global styles can be added to any layout, page, or component.</p> <ul> <li><a href=\"../styling/css-modules\">CSS Modules</a></li> <li><a href=\"../styling/tailwind-css\">Tailwind CSS</a></li> <li><a href=\"../styling/css-modules#global-styles\">Global Styles</a></li> <li><a href=\"../styling/css-in-js\">CSS-in-JS</a></li> <li><a href=\"../styling/css-modules#external-stylesheets\">External Stylesheets</a></li> <li><a href=\"../styling/sass\">Sass</a></li> </ul> <h4 id=\"tailwind-css\" data-docs-heading=\"\">Tailwind CSS     </h4> <p>If you're using Tailwind CSS, you'll need to add the <code>app</code> directory to your <code>tailwind.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  content: [\n    './app/**/*.{js,ts,jsx,tsx,mdx}', // &lt;-- Add this line\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n}</pre></div> <p>You'll also need to import your global styles in your <code>app/layout.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../styles/globals.css'\n \nexport default function RootLayout({ children }) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div> <p>Learn more about <a href=\"../styling/tailwind-css\">styling with Tailwind CSS</a></p> <h2 id=\"codemods\" data-docs-heading=\"\">Codemods     </h2> <p>Next.js provides Codemod transformations to help upgrade your codebase when a feature is deprecated. See <a href=\"codemods\">Codemods</a> for more information.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/app-router-migration\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/upgrading/app-router-migration</a>\n  </p>\n</div>\n","app/building-your-application/upgrading/from-vite":"<h1 class=\"break-words\">Migrating from Vite</h1>\n<p>This guide will help you migrate an existing Vite application to Next.js.</p> <h2 id=\"why-switch\" data-docs-heading=\"\">Why Switch?     </h2> <p>There are several reasons why you might want to switch from Vite to Next.js:</p> <h3 id=\"slow-initial-page-loading-time\" data-docs-heading=\"\">Slow initial page loading time     </h3> <p>If you have built your application with the <a href=\"https://github.com/vitejs/vite-plugin-react/tree/main/packages/plugin-react\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">default Vite plugin for React</a>, your application is a purely client-side application. Client-side only applications, also known as single-page applications (SPAs), often experience slow initial page loading time. This happens due to a couple of reasons:</p> <ol> <li>The browser needs to wait for the React code and your entire application bundle to download and run before your code is able to send requests to load some data.</li> <li>Your application code grows with every new feature and extra dependency you add.</li> </ol> <h3 id=\"no-automatic-code-splitting\" data-docs-heading=\"\">No automatic code splitting     </h3> <p>The previous issue of slow loading times can be somewhat managed with code splitting. However, if you try to do code splitting manually, you'll often make performance worse. It's easy to inadvertently introduce network waterfalls when code-splitting manually. Next.js provides automatic code splitting built into its router.</p> <h3 id=\"network-waterfalls\" data-docs-heading=\"\">Network waterfalls     </h3> <p>A common cause of poor performance occurs when applications make sequential client-server requests to fetch data. One common pattern for data fetching in an SPA is to initially render a placeholder, and then fetch data after the component has mounted. Unfortunately, this means that a child component that fetches data can't start fetching until the parent component has finished loading its own data.</p> <p>While fetching data on the client is supported with Next.js, it also gives you the option to shift data fetching to the server, which can eliminate client-server waterfalls.</p> <h3 id=\"fast-and-intentional-loading-states\" data-docs-heading=\"\">Fast and intentional loading states     </h3> <p>With built-in support for <a href=\"../routing/loading-ui-and-streaming#streaming-with-suspense\">streaming through React Suspense</a>, you can be more intentional about which parts of your UI you want to load first and in what order without introducing network waterfalls.</p> <p>This enables you to build pages that are faster to load and eliminate <a href=\"https://vercel.com/blog/how-core-web-vitals-affect-seo\" rel=\"noopener noreferrer\" target=\"_blank\">layout shifts</a>.</p> <h3 id=\"choose-the-data-fetching-strategy\" data-docs-heading=\"\">Choose the data fetching strategy     </h3> <p>Depending on your needs, Next.js allows you to choose your data fetching strategy on a page and component basis. You can decide to fetch at build time, at request time on the server, or on the client. For example, you can fetch data from your CMS and render your blog posts at build time, which can then be efficiently cached on a CDN.</p> <h3 id=\"middleware\" data-docs-heading=\"\">Middleware     </h3> <p><a href=\"../routing/middleware\">Next.js Middleware</a> allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The middleware is also useful for experimentation and <a href=\"../routing/internationalization\">internationalization</a>.</p> <h3 id=\"built-in-optimizations\" data-docs-heading=\"\">Built-in Optimizations     </h3> <p><a href=\"../optimizing/images\">Images</a>, <a href=\"../optimizing/fonts\">fonts</a>, and <a href=\"../optimizing/scripts\">third-party scripts</a> often have significant impact on an application's performance. Next.js comes with built-in components that automatically optimize those for you.</p> <h2 id=\"migration-steps\" data-docs-heading=\"\">Migration Steps     </h2> <p>Our goal with this migration is to get a working Next.js application as quickly as possible, so that you can then adopt Next.js features incrementally. To begin with, we'll keep it as a purely client-side application (SPA) without migrating your existing router. This helps minimize the chances of encountering issues during the migration process and reduces merge conflicts.</p> <h3 id=\"step-1-install-the-nextjs-dependency\" data-docs-heading=\"\">Step 1: Install the Next.js Dependency     </h3> <p>The first thing you need to do is to install <code>next</code> as a dependency:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest</pre></div> <h3 id=\"step-2-create-the-nextjs-configuration-file\" data-docs-heading=\"\">Step 2: Create the Next.js Configuration File     </h3> <p>Create a <code>next.config.mjs</code> at the root of your project. This file will hold your <a href=\"../../api-reference/next-config-js\">Next.js configuration options</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA).\n  distDir: './dist', // Changes the build output directory to `./dist/`.\n}\n \nexport default nextConfig</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> You can use either <code>.js</code> or <code>.mjs</code> for your Next.js configuration file.</p> </blockquote> <h3 id=\"step-3-update-typescript-configuration\" data-docs-heading=\"\">Step 3: Update TypeScript Configuration     </h3> <p>If you're using TypeScript, you need to update your <code>tsconfig.json</code> file with the following changes to make it compatible with Next.js. If you're not using TypeScript, you can skip this step.</p> <ol> <li>Remove the <a href=\"https://www.typescriptlang.org/tsconfig#references\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">project reference</a> to <code>tsconfig.node.json</code>\n</li> <li>Add <code>./dist/types/**/*.ts</code> and <code>./next-env.d.ts</code> to the <a href=\"https://www.typescriptlang.org/tsconfig#include\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>include</code> array</a>\n</li> <li>Add <code>./node_modules</code> to the <a href=\"https://www.typescriptlang.org/tsconfig#exclude\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>exclude</code> array</a>\n</li> <li>Add <code>{ \"name\": \"next\" }</code> to the <a href=\"https://www.typescriptlang.org/tsconfig#plugins\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>plugins</code> array in <code>compilerOptions</code></a>: <code>\"plugins\": [{ \"name\": \"next\" }]</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#esModuleInterop\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>esModuleInterop</code></a> to <code>true</code>: <code>\"esModuleInterop\": true</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#jsx\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>jsx</code></a> to <code>preserve</code>: <code>\"jsx\": \"preserve\"</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#allowJs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>allowJs</code></a> to <code>true</code>: <code>\"allowJs\": true</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#forceConsistentCasingInFileNames\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>forceConsistentCasingInFileNames</code></a> to <code>true</code>: <code>\"forceConsistentCasingInFileNames\": true</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#incremental\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>incremental</code></a> to <code>true</code>: <code>\"incremental\": true</code>\n</li> </ol> <p>Here's an example of a working <code>tsconfig.json</code> with those changes:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true,\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"preserve\",\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"allowJs\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"incremental\": true,\n    \"plugins\": [{ \"name\": \"next\" }]\n  },\n  \"include\": [\"./src\", \"./dist/types/**/*.ts\", \"./next-env.d.ts\"],\n  \"exclude\": [\"./node_modules\"]\n}</pre></div> <p>You can find more information about configuring TypeScript on the <a href=\"../configuring/typescript#typescript-plugin\">Next.js docs</a>.</p> <h3 id=\"step-4-create-the-root-layout\" data-docs-heading=\"\">Step 4: Create the Root Layout     </h3> <p>A Next.js <a href=\"../../../app\">App Router</a> application must include a <a href=\"../routing/pages-and-layouts#root-layout-required\">root layout</a> file, which is a <a href=\"../rendering/server-components\">React Server Component</a> that will wrap all pages in your application. This file is defined at the top level of the <code>app</code> directory.</p> <p>The closest equivalent to the root layout file in a Vite application is the <a href=\"https://vitejs.dev/guide/#index-html-and-project-root\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>index.html</code> file</a>, which contains your <code>&lt;html&gt;</code>, <code>&lt;head&gt;</code>, and <code>&lt;body&gt;</code> tags.</p> <p>In this step, you'll convert your <code>index.html</code> file into a root layout file:</p> <ol> <li>Create a new <code>app</code> directory in your <code>src</code> directory.</li> <li>Create a new <code>layout.tsx</code> file inside that <code>app</code> directory:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return null\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> extensions can be used for Layout files.</p> </blockquote> <ol start=\"3\"> <li>Copy the content of your <code>index.html</code> file into the previously created <code>&lt;RootLayout&gt;</code> component while replacing the <code>body.div#root</code> and <code>body.script</code> tags with <code>&lt;div id=\"root\"&gt;{children}&lt;/div&gt;</code>:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;meta charset=\"UTF-8\" /&gt;\n        &lt;link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" /&gt;\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n        &lt;title&gt;My App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"My App is a...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <ol start=\"4\"> <li>Next.js already includes by default the <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/meta#charset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta charset</a> and <a href=\"https://developer.mozilla.org/docs/Web/HTML/Viewport_meta_tag\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta viewport</a> tags, so you can safely remove those from your <code>&lt;head&gt;</code>:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" /&gt;\n        &lt;title&gt;My App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"My App is a...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <ol start=\"5\"> <li>Any <a href=\"../optimizing/metadata#file-based-metadata\">metadata files</a> such as <code>favicon.ico</code>, <code>icon.png</code>, <code>robots.txt</code> are automatically added to the application <code>&lt;head&gt;</code> tag as long as you have them placed into the top level of the <code>app</code> directory. After moving <a href=\"../optimizing/metadata#file-based-metadata\">all supported files</a> into the <code>app</code> directory you can safely delete their <code>&lt;link&gt;</code> tags:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;title&gt;My App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"My App is a...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <ol start=\"6\"> <li>Finally, Next.js can manage your last <code>&lt;head&gt;</code> tags with the <a href=\"../optimizing/metadata\">Metadata API</a>. Move your final metadata info into an exported <a href=\"../../api-reference/functions/generate-metadata#metadata-object\"><code>metadata</code> object</a>:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'My App',\n  description: 'My App is a...',\n}\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>With the above changes, you shifted from declaring everything in your <code>index.html</code> to using Next.js' convention-based approach built into the framework (<a href=\"../optimizing/metadata\">Metadata API</a>). This approach enables you to more easily improve your SEO and web shareability of your pages.</p> <h3 id=\"step-5-create-the-entrypoint-page\" data-docs-heading=\"\">Step 5: Create the Entrypoint Page     </h3> <p>On Next.js you declare an entrypoint for your application by creating a <code>page.tsx</code> file. The closest equivalent of this file on Vite is your <code>main.tsx</code> file. In this step, youll set up the entrypoint of your application.</p> <ol> <li><strong>Create a <code>[[...slug]]</code> directory in your <code>app</code> directory.</strong></li> </ol> <p>Since in this guide we're aiming first to set up our Next.js as an SPA (Single Page Application), you need your page entrypoint to catch all possible routes of your application. For that, create a new <code>[[...slug]]</code> directory in your <code>app</code> directory.</p> <p>This directory is what is called an <a href=\"../routing/dynamic-routes#optional-catch-all-segments\">optional catch-all route segment</a>. Next.js uses a file-system based router where <a href=\"../routing/defining-routes#creating-routes\">directories are used to define routes</a>. This special directory will make sure that all routes of your application will be directed to its containing <code>page.tsx</code> file.</p> <ol start=\"2\"> <li><strong>Create a new <code>page.tsx</code> file inside the <code>app/[[...slug]]</code> directory with the following content:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../../index.css'\n \nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n \nexport default function Page() {\n  return '...' // We'll update this\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> extensions can be used for Page files.</p> </blockquote> <p>This file is a <a href=\"../rendering/server-components\">Server Component</a>. When you run <code>next build</code>, the file is prerendered into a static asset. It does <em>not</em> require any dynamic code.</p> <p>This file imports our global CSS and tells <a href=\"../../api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a> we are only going to generate one route, the index route at <code>/</code>.</p> <p>Now, let's move the rest of our Vite application which will run client-only.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport React from 'react'\nimport dynamic from 'next/dynamic'\n \nconst App = dynamic(() =&gt; import('../../App'), { ssr: false })\n \nexport function ClientOnly() {\n  return &lt;App /&gt;\n}</pre></div>  <p>This file is a <a href=\"../rendering/client-components\">Client Component</a>, defined by the <code>'use client'</code> directive. Client Components are still <a href=\"../rendering/client-components#how-are-client-components-rendered\">prerendered to HTML</a> on the server before being sent to the client.</p> <p>Since we want a client-only application to start, we can configure Next.js to disable prerendering from the <code>App</code> component down.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const App = dynamic(() =&gt; import('../../App'), { ssr: false })</pre>\n</div> <p>Now, update your entrypoint page to use the new component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../../index.css'\nimport { ClientOnly } from './client'\n \nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n \nexport default function Page() {\n  return &lt;ClientOnly /&gt;\n}</pre></div>  <h3 id=\"step-6-update-static-image-imports\" data-docs-heading=\"\">Step 6: Update Static Image Imports     </h3> <p>Next.js handles static image imports slightly different from Vite. With Vite, importing an image file will return its public URL as a string:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import image from './img.png' // `image` will be '/assets/img.2d8efhg.png' in production\n \nexport default function App() {\n  return &lt;img src={image} /&gt;\n}</pre></div> <p>With Next.js, static image imports return an object. The object can then be used directly with the Next.js <a href=\"../../api-reference/components/image\"><code>&lt;Image&gt;</code> component</a>, or you can use the object's <code>src</code> property with your existing <code>&lt;img&gt;</code> tag.</p> <p>The <code>&lt;Image&gt;</code> component has the added benefits of <a href=\"../optimizing/images\">automatic image optimization</a>. The <code>&lt;Image&gt;</code> component automatically sets the <code>width</code> and <code>height</code> attributes of the resulting <code>&lt;img&gt;</code> based on the image's dimensions. This prevents layout shifts when the image loads. However, this can cause issues if your app contains images with only one of their dimensions being styled without the other styled to <code>auto</code>. When not styled to <code>auto</code>, the dimension will default to the <code>&lt;img&gt;</code> dimension attribute's value, which can cause the image to appear distorted.</p> <p>Keeping the <code>&lt;img&gt;</code> tag will reduce the amount of changes in your application and prevent the above issues. You can then optionally later migrate to the <code>&lt;Image&gt;</code> component to take advantage of optimizing images by <a href=\"../optimizing/images#loaders\">configuring a loader</a>, or moving to the default Next.js server which has automatic image optimization.</p> <ol> <li><strong>Convert absolute import paths for images imported from <code>/public</code> into relative imports:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\nimport logo from '/logo.png'\n \n// After\nimport logo from '../public/logo.png'</pre>\n</div> <ol start=\"2\"> <li><strong>Pass the image <code>src</code> property instead of the whole image object to your <code>&lt;img&gt;</code> tag:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\n&lt;img src={logo} /&gt;\n \n// After\n&lt;img src={logo.src} /&gt;</pre>\n</div> <p>Alternatively, you can reference the public URL for the image asset based on the filename. For example, <code>public/logo.png</code> will serve the image at <code>/logo.png</code> for your application, which would be the <code>src</code> value.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> If you're using TypeScript, you might encounter type errors when accessing the <code>src</code> property. You can safely ignore those for now. They will be fixed by the end of this guide.</p> </blockquote> <h3 id=\"step-7-migrate-the-environment-variables\" data-docs-heading=\"\">Step 7: Migrate the Environment Variables     </h3> <p>Next.js has support for <code>.env</code> <a href=\"../configuring/environment-variables\">environment variables</a> similar to Vite. The main difference is the prefix used to expose environment variables on the client-side.</p> <ul> <li>Change all environment variables with the <code>VITE_</code> prefix to <code>NEXT_PUBLIC_</code>.</li> </ul> <p>Vite exposes a few built-in environment variables on the special <code>import.meta.env</code> object which arent supported by Next.js. You need to update their usage as follows:</p> <ul> <li>\n<code>import.meta.env.MODE</code>  <code>process.env.NODE_ENV</code>\n</li> <li>\n<code>import.meta.env.PROD</code>  <code>process.env.NODE_ENV === 'production'</code>\n</li> <li>\n<code>import.meta.env.DEV</code>  <code>process.env.NODE_ENV !== 'production'</code>\n</li> <li>\n<code>import.meta.env.SSR</code>  <code>typeof window !== 'undefined'</code>\n</li> </ul> <p>Next.js also doesn't provide a built-in <code>BASE_URL</code> environment variable. However, you can still configure one, if you need it:</p> <ol> <li><strong>Add the following to your <code>.env</code> file:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"># ...\nNEXT_PUBLIC_BASE_PATH=\"/some-base-path\"</pre></div> <ol start=\"2\"> <li><strong>Set <a href=\"../../api-reference/next-config-js/basepath\"><code>basePath</code></a> to <code>process.env.NEXT_PUBLIC_BASE_PATH</code> in your <code>next.config.mjs</code> file:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA).\n  distDir: './dist', // Changes the build output directory to `./dist/`.\n  basePath: process.env.NEXT_PUBLIC_BASE_PATH, // Sets the base path to `/some-base-path`.\n}\n \nexport default nextConfig</pre></div> <ol start=\"3\"> <li><strong>Update <code>import.meta.env.BASE_URL</code> usages to <code>process.env.NEXT_PUBLIC_BASE_PATH</code></strong></li> </ol> <h3 id=\"step-8-update-scripts-in-packagejson\" data-docs-heading=\"\">Step 8: Update Scripts in package.json     </h3> <p>You should now be able to run your application to test if you successfully migrated to Next.js. But before that, you need to update your <code>scripts</code> in your <code>package.json</code> with Next.js related commands, and add <code>.next</code> and <code>next-env.d.ts</code> to your <code>.gitignore</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"># ...\n.next\nnext-env.d.ts\ndist</pre></div> <p>Now run <code>npm run dev</code>, and open <a href=\"http://localhost:3000\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>http://localhost:3000</code></a>. You should see your application now running on Next.js.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Example:</strong> Check out <a href=\"https://github.com/inngest/vite-to-nextjs/pull/1\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">this pull request</a> for a working example of a Vite application migrated to Next.js.</p> </blockquote> <h3 id=\"step-9-clean-up\" data-docs-heading=\"\">Step 9: Clean Up     </h3> <p>You can now clean up your codebase from Vite related artifacts:</p> <ul> <li>Delete <code>main.tsx</code>\n</li> <li>Delete <code>index.html</code>\n</li> <li>Delete <code>vite-env.d.ts</code>\n</li> <li>Delete <code>tsconfig.node.json</code>\n</li> <li>Delete <code>vite.config.ts</code>\n</li> <li>Uninstall Vite dependencies</li> </ul> <h2 id=\"next-steps\" data-docs-heading=\"\">Next Steps     </h2> <p>If everything went according to plan, you now have a functioning Next.js application running as a single-page application. However, you aren't yet taking advantage of most of Next.js' benefits, but you can now start making incremental changes to reap all the benefits. Here's what you might want to do next:</p> <ul> <li>Migrate from React Router to the <a href=\"../routing\">Next.js App Router</a> to get: <ul> <li>Automatic code splitting</li> <li><a href=\"../routing/loading-ui-and-streaming\">Streaming Server-Rendering</a></li> <li><a href=\"../rendering/server-components\">React Server Components</a></li> </ul> </li> <li><a href=\"../optimizing/images\">Optimize images with the <code>&lt;Image&gt;</code> component</a></li> <li><a href=\"../optimizing/fonts\">Optimize fonts with <code>next/font</code></a></li> <li><a href=\"../optimizing/scripts\">Optimize third-party scripts with the <code>&lt;Script&gt;</code> component</a></li> <li><a href=\"../configuring/eslint\">Update your ESLint configuration to support Next.js rules</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/from-vite\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/upgrading/from-vite</a>\n  </p>\n</div>\n","app/building-your-application/upgrading/from-create-react-app":"<h1 class=\"break-words\">Migrating from Create React App</h1>\n<p>This guide will help you migrate an existing Create React App site to Next.js.</p> <h2 id=\"why-switch\" data-docs-heading=\"\">Why Switch?     </h2> <p>There are several reasons why you might want to switch from Create React App to Next.js:</p> <h3 id=\"slow-initial-page-loading-time\" data-docs-heading=\"\">Slow initial page loading time     </h3> <p>Create React App uses purely client-side React. Client-side only applications, also known as single-page applications (SPAs), often experience slow initial page loading time. This happens due to a couple of reasons:</p> <ol> <li>The browser needs to wait for the React code and your entire application bundle to download and run before your code is able to send requests to load data.</li> <li>Your application code grows with every new feature and dependency you add.</li> </ol> <h3 id=\"no-automatic-code-splitting\" data-docs-heading=\"\">No automatic code splitting     </h3> <p>The previous issue of slow loading times can be somewhat managed with code splitting. However, if you try to do code splitting manually, you'll often make performance worse. It's easy to inadvertently introduce network waterfalls when code-splitting manually. Next.js provides automatic code splitting built into its router.</p> <h3 id=\"network-waterfalls\" data-docs-heading=\"\">Network waterfalls     </h3> <p>A common cause of poor performance occurs when applications make sequential client-server requests to fetch data. One common pattern for data fetching in an SPA is to initially render a placeholder, and then fetch data after the component has mounted. Unfortunately, this means that a child component that fetches data can't start fetching until the parent component has finished loading its own data.</p> <p>While fetching data on the client is supported with Next.js, it also gives you the option to shift data fetching to the server, which can eliminate client-server waterfalls.</p> <h3 id=\"fast-and-intentional-loading-states\" data-docs-heading=\"\">Fast and intentional loading states     </h3> <p>With built-in support for <a href=\"../routing/loading-ui-and-streaming#streaming-with-suspense\">streaming through React Suspense</a>, you can be more intentional about which parts of your UI you want to load first and in what order without introducing network waterfalls.</p> <p>This enables you to build pages that are faster to load and eliminate <a href=\"https://vercel.com/blog/how-core-web-vitals-affect-seo\" rel=\"noopener noreferrer\" target=\"_blank\">layout shifts</a>.</p> <h3 id=\"choose-the-data-fetching-strategy\" data-docs-heading=\"\">Choose the data fetching strategy     </h3> <p>Depending on your needs, Next.js allows you to choose your data fetching strategy on a page and component basis. You can decide to fetch at build time, at request time on the server, or on the client. For example, you can fetch data from your CMS and render your blog posts at build time, which can then be efficiently cached on a CDN.</p> <h3 id=\"middleware\" data-docs-heading=\"\">Middleware     </h3> <p><a href=\"../routing/middleware\">Next.js Middleware</a> allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The middleware is also useful for experimentation and <a href=\"../routing/internationalization\">internationalization</a>.</p> <h3 id=\"built-in-optimizations\" data-docs-heading=\"\">Built-in Optimizations     </h3> <p><a href=\"../optimizing/images\">Images</a>, <a href=\"../optimizing/fonts\">fonts</a>, and <a href=\"../optimizing/scripts\">third-party scripts</a> often have significant impact on an application's performance. Next.js comes with built-in components that automatically optimize those for you.</p> <h2 id=\"migration-steps\" data-docs-heading=\"\">Migration Steps     </h2> <p>Our goal with this migration is to get a working Next.js application as quickly as possible, so that you can then adopt Next.js features incrementally. To begin with, we'll keep it as a purely client-side application (SPA) without migrating your existing router. This helps minimize the chances of encountering issues during the migration process and reduces merge conflicts.</p> <h3 id=\"step-1-install-the-nextjs-dependency\" data-docs-heading=\"\">Step 1: Install the Next.js Dependency     </h3> <p>The first thing you need to do is to install <code>next</code> as a dependency:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest</pre></div> <h3 id=\"step-2-create-the-nextjs-configuration-file\" data-docs-heading=\"\">Step 2: Create the Next.js Configuration File     </h3> <p>Create a <code>next.config.mjs</code> at the root of your project. This file will hold your <a href=\"../../api-reference/next-config-js\">Next.js configuration options</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA).\n  distDir: './dist', // Changes the build output directory to `./dist/`.\n}\n \nexport default nextConfig</pre></div> <h3 id=\"step-3-update-typescript-configuration\" data-docs-heading=\"\">Step 3: Update TypeScript Configuration     </h3> <p>If you're using TypeScript, you need to update your <code>tsconfig.json</code> file with the following changes to make it compatible with Next.js:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"target\": \"es5\",\n    \"lib\": [\"dom\", \"dom.iterable\", \"esnext\"],\n    \"allowJs\": true,\n    \"skipLibCheck\": true,\n    \"strict\": false,\n    \"forceConsistentCasingInFileNames\": true,\n    \"noEmit\": true,\n    \"esModuleInterop\": true,\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"node\",\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"jsx\": \"preserve\",\n    \"baseUrl\": \".\",\n    \"incremental\": true,\n    \"plugins\": [\n      {\n        \"name\": \"next\"\n      }\n    ],\n    \"strictNullChecks\": true\n  },\n  \"include\": [\n    \"next-env.d.ts\",\n    \"**/*.ts\",\n    \"**/*.tsx\",\n    \".next/types/**/*.ts\",\n    \"./dist/types/**/*.ts\"\n  ],\n  \"exclude\": [\"node_modules\"]\n}</pre></div> <p>You can find more information about configuring TypeScript on the <a href=\"../configuring/typescript#typescript-plugin\">Next.js docs</a>.</p> <h3 id=\"step-4-create-the-root-layout\" data-docs-heading=\"\">Step 4: Create the Root Layout     </h3> <p>A Next.js <a href=\"../../../app\">App Router</a> application must include a <a href=\"../routing/pages-and-layouts#root-layout-required\">root layout</a> file, which is a <a href=\"../rendering/server-components\">React Server Component</a> that will wrap all pages in your application. This file is defined at the top level of the <code>app</code> directory.</p> <p>The closest equivalent to the root layout file in a CRA application is the <code>index.html</code> file, which contains your <code>&lt;html&gt;</code>, <code>&lt;head&gt;</code>, and <code>&lt;body&gt;</code> tags.</p> <p>In this step, you'll convert your <code>index.html</code> file into a root layout file:</p> <ol> <li>Create a new <code>app</code> directory in your <code>src</code> directory.</li> <li>Create a new <code>layout.tsx</code> file inside that <code>app</code> directory:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return null\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> extensions can be used for Layout files.</p> </blockquote> <p>Copy the content of your <code>index.html</code> file into the previously created <code>&lt;RootLayout&gt;</code> component while replacing the <code>body.div#root</code> and <code>body.script</code> tags with <code>&lt;div id=\"root\"&gt;{children}&lt;/div&gt;</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;meta charset=\"UTF-8\" /&gt;\n        &lt;link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" /&gt;\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /&gt;\n        &lt;title&gt;React App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"Web site created...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: We'll ignore the <a href=\"../../api-reference/file-conventions/metadata\">manifest file</a>, additional iconography other than the favicon, and <a href=\"../testing\">testing configuration</a>, but if these are requirements, Next.js also supports these options.</p> </blockquote> <h3 id=\"step-5-metadata\" data-docs-heading=\"\">Step 5: Metadata     </h3> <p>Next.js already includes by default the <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/meta#charset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta charset</a> and <a href=\"https://developer.mozilla.org/docs/Web/HTML/Viewport_meta_tag\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta viewport</a> tags, so you can safely remove those from your <code>&lt;head&gt;</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" /&gt;\n        &lt;title&gt;React App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"Web site created...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>Any <a href=\"../optimizing/metadata#file-based-metadata\">metadata files</a> such as <code>favicon.ico</code>, <code>icon.png</code>, <code>robots.txt</code> are automatically added to the application <code>&lt;head&gt;</code> tag as long as you have them placed into the top level of the <code>app</code> directory. After moving <a href=\"../optimizing/metadata#file-based-metadata\">all supported files</a> into the <code>app</code> directory you can safely delete their <code>&lt;link&gt;</code> tags:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;title&gt;React App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"Web site created...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>Finally, Next.js can manage your last <code>&lt;head&gt;</code> tags with the <a href=\"../optimizing/metadata\">Metadata API</a>. Move your final metadata info into an exported <a href=\"../../api-reference/functions/generate-metadata#metadata-object\"><code>metadata</code> object</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'React App',\n  description: 'Web site created with Next.js.',\n}\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>With the above changes, you shifted from declaring everything in your <code>index.html</code> to using Next.js' convention-based approach built into the framework (<a href=\"../optimizing/metadata\">Metadata API</a>). This approach enables you to more easily improve your SEO and web shareability of your pages.</p> <h3 id=\"step-6-styles\" data-docs-heading=\"\">Step 6: Styles     </h3> <p>Like Create React App, Next.js has built-in support for <a href=\"../styling/css-modules\">CSS Modules</a>.</p> <p>If you're using a global CSS file, import it into your <code>app/layout.tsx</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../index.css'\n \n// ...</pre></div> <p>If you're using Tailwind, you'll need to install <code>postcss</code> and <code>autoprefixer</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install postcss autoprefixer</pre></div> <p>Then, create a <code>postcss.config.js</code> file at the root of your project:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}</pre></div> <h3 id=\"step-7-create-the-entrypoint-page\" data-docs-heading=\"\">Step 7: Create the Entrypoint Page     </h3> <p>On Next.js you declare an entrypoint for your application by creating a <code>page.tsx</code> file. The closest equivalent of this file on CRA is your <code>src/index.tsx</code> file. In this step, youll set up the entry point of your application.</p> <p><strong>Create a <code>[[...slug]]</code> directory in your <code>app</code> directory.</strong></p> <p>Since this guide is aiming to first set up our Next.js as an SPA (Single Page Application), you need your page entry point to catch all possible routes of your application. For that, create a new <code>[[...slug]]</code> directory in your <code>app</code> directory.</p> <p>This directory is what is called an <a href=\"../routing/dynamic-routes#optional-catch-all-segments\">optional catch-all route segment</a>. Next.js uses a file-system based router where <a href=\"../routing/defining-routes#creating-routes\">directories are used to define routes</a>. This special directory will make sure that all routes of your application will be directed to its containing <code>page.tsx</code> file.</p> <p><strong>Create a new <code>page.tsx</code> file inside the <code>app/[[...slug]]</code> directory with the following content:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../../index.css'\n \nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n \nexport default function Page() {\n  return '...' // We'll update this\n}</pre></div>  <p>This file is a <a href=\"../rendering/server-components\">Server Component</a>. When you run <code>next build</code>, the file is prerendered into a static asset. It does <em>not</em> require any dynamic code.</p> <p>This file imports our global CSS and tells <a href=\"../../api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a> we are only going to generate one route, the index route at <code>/</code>.</p> <p>Now, let's move the rest of our CRA application which will run client-only.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport React from 'react'\nimport dynamic from 'next/dynamic'\n \nconst App = dynamic(() =&gt; import('../../App'), { ssr: false })\n \nexport function ClientOnly() {\n  return &lt;App /&gt;\n}</pre></div>  <p>This file is a <a href=\"../rendering/client-components\">Client Component</a>, defined by the <code>'use client'</code> directive. Client Components are still <a href=\"../rendering/client-components#how-are-client-components-rendered\">prerendered to HTML</a> on the server before being sent to the client.</p> <p>Since we want a client-only application to start, we can configure Next.js to disable prerendering from the <code>App</code> component down.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const App = dynamic(() =&gt; import('../../App'), { ssr: false })</pre>\n</div> <p>Now, update your entrypoint page to use the new component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../../index.css'\nimport { ClientOnly } from './client'\n \nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n \nexport default function Page() {\n  return &lt;ClientOnly /&gt;\n}</pre></div>  <h3 id=\"step-8-update-static-image-imports\" data-docs-heading=\"\">Step 8: Update Static Image Imports     </h3> <p>Next.js handles static image imports slightly different from CRA. With CRA, importing an image file will return its public URL as a string:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import image from './img.png'\n \nexport default function App() {\n  return &lt;img src={image} /&gt;\n}</pre></div> <p>With Next.js, static image imports return an object. The object can then be used directly with the Next.js <a href=\"../../api-reference/components/image\"><code>&lt;Image&gt;</code> component</a>, or you can use the object's <code>src</code> property with your existing <code>&lt;img&gt;</code> tag.</p> <p>The <code>&lt;Image&gt;</code> component has the added benefits of <a href=\"../optimizing/images\">automatic image optimization</a>. The <code>&lt;Image&gt;</code> component automatically sets the <code>width</code> and <code>height</code> attributes of the resulting <code>&lt;img&gt;</code> based on the image's dimensions. This prevents layout shifts when the image loads. However, this can cause issues if your app contains images with only one of their dimensions being styled without the other styled to <code>auto</code>. When not styled to <code>auto</code>, the dimension will default to the <code>&lt;img&gt;</code> dimension attribute's value, which can cause the image to appear distorted.</p> <p>Keeping the <code>&lt;img&gt;</code> tag will reduce the amount of changes in your application and prevent the above issues. You can then optionally later migrate to the <code>&lt;Image&gt;</code> component to take advantage of optimizing images by <a href=\"../optimizing/images#loaders\">configuring a loader</a>, or moving to the default Next.js server which has automatic image optimization.</p> <p><strong>Convert absolute import paths for images imported from <code>/public</code> into relative imports:</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\nimport logo from '/logo.png'\n \n// After\nimport logo from '../public/logo.png'</pre>\n</div> <p><strong>Pass the image <code>src</code> property instead of the whole image object to your <code>&lt;img&gt;</code> tag:</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\n&lt;img src={logo} /&gt;\n \n// After\n&lt;img src={logo.src} /&gt;</pre>\n</div> <p>Alternatively, you can reference the public URL for the image asset based on the filename. For example, <code>public/logo.png</code> will serve the image at <code>/logo.png</code> for your application, which would be the <code>src</code> value.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> If you're using TypeScript, you might encounter type errors when accessing the <code>src</code> property. You can safely ignore those for now. They will be fixed by the end of this guide.</p> </blockquote> <h3 id=\"step-9-migrate-the-environment-variables\" data-docs-heading=\"\">Step 9: Migrate the Environment Variables     </h3> <p>Next.js has support for <code>.env</code> <a href=\"../configuring/environment-variables\">environment variables</a> similar to CRA.</p> <p>The main difference is the prefix used to expose environment variables on the client-side. Change all environment variables with the <code>REACT_APP_</code> prefix to <code>NEXT_PUBLIC_</code>.</p> <h3 id=\"step-10-update-scripts-in-packagejson\" data-docs-heading=\"\">Step 10: Update Scripts in package.json     </h3> <p>You should now be able to run your application to test if you successfully migrated to Next.js. But before that, you need to update your <code>scripts</code> in your <code>package.json</code> with Next.js related commands, and add <code>.next</code>, <code>next-env.d.ts</code>, and <code>dist</code> to your <code>.gitignore</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"># ...\n.next\nnext-env.d.ts\ndist</pre></div> <p>Now run <code>npm run dev</code>, and open <a href=\"http://localhost:3000\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>http://localhost:3000</code></a>. You should see your application now running on Next.js.</p> <h3 id=\"step-11-clean-up\" data-docs-heading=\"\">Step 11: Clean Up     </h3> <p>You can now clean up your codebase from Create React App related artifacts:</p> <ul> <li>Delete <code>src/index.tsx</code>\n</li> <li>Delete <code>public/index.html</code>\n</li> <li>Delete <code>reportWebVitals</code> setup</li> <li>Uninstall CRA dependencies (<code>react-scripts</code>)</li> </ul> <h2 id=\"bundler-compatibility\" data-docs-heading=\"\">Bundler Compatibility     </h2> <p>Create React App and Next.js both default to using webpack for bundling.</p> <p>When migrating your CRA application to Next.js, you might have a custom webpack configuration you're looking to migrate. Next.js supports providing a <a href=\"../../api-reference/next-config-js/webpack\">custom webpack configuration</a>.</p> <p>Further, Next.js has support for <a href=\"../../api-reference/next-config-js/turbo\">Turbopack</a> through <code>next dev --turbo</code> to improve your local dev performance. Turbopack supports some <a href=\"../../api-reference/next-config-js/turbo\">webpack loaders</a> as well for compatibility and incremental adoption.</p> <h2 id=\"next-steps\" data-docs-heading=\"\">Next Steps     </h2> <p>If everything went according to plan, you now have a functioning Next.js application running as a single-page application. However, you aren't yet taking advantage of most of Next.js' benefits, but you can now start making incremental changes to reap all the benefits. Here's what you might want to do next:</p> <ul> <li>Migrate from React Router to the <a href=\"../routing\">Next.js App Router</a> to get: <ul> <li>Automatic code splitting</li> <li><a href=\"../routing/loading-ui-and-streaming\">Streaming Server-Rendering</a></li> <li><a href=\"../rendering/server-components\">React Server Components</a></li> </ul> </li> <li><a href=\"../optimizing/images\">Optimize images with the <code>&lt;Image&gt;</code> component</a></li> <li><a href=\"../optimizing/fonts\">Optimize fonts with <code>next/font</code></a></li> <li><a href=\"../optimizing/scripts\">Optimize third-party scripts with the <code>&lt;Script&gt;</code> component</a></li> <li><a href=\"../configuring/eslint\">Update your ESLint configuration to support Next.js rules</a></li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> Using a static export <a href=\"https://github.com/vercel/next.js/issues/54393\" rel=\"noopener noreferrer\" target=\"_blank\">does not currently support</a> using the <code>useParams</code> hook.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/building-your-application/upgrading/from-create-react-app\" class=\"_attribution-link\">https://nextjs.org/docs/app/building-your-application/upgrading/from-create-react-app</a>\n  </p>\n</div>\n","app/api-reference/components/image":"<h1 class=\"break-words\">&lt;Image&gt;</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/image-component\" rel=\"noopener noreferrer\" target=\"_blank\">Image Component</a></li> </ul></details>  <p>This API reference will help you understand how to use <a href=\"#props\">props</a> and <a href=\"#configuration-options\">configuration options</a> available for the Image Component. For features and usage, please see the <a href=\"../../building-your-application/optimizing/images\">Image Component</a> page.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return (\n    &lt;Image\n      src=\"/profile.png\"\n      width={500}\n      height={500}\n      alt=\"Picture of the author\"\n    /&gt;\n  )\n}</pre></div> <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <p>Here's a summary of the props available for the Image Component:</p> <div style=\"overflow-x:auto;width:100%\"><div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Prop</th>\n<th>Example</th>\n<th>Type</th>\n<th>Status</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#src\"><code>src</code></a></td>\n<td><code>src=\"/profile.png\"</code></td>\n<td>String</td>\n<td>Required</td>\n</tr>\n<tr>\n<td><a href=\"#width\"><code>width</code></a></td>\n<td><code>width={500}</code></td>\n<td>Integer (px)</td>\n<td>Required</td>\n</tr>\n<tr>\n<td><a href=\"#height\"><code>height</code></a></td>\n<td><code>height={500}</code></td>\n<td>Integer (px)</td>\n<td>Required</td>\n</tr>\n<tr>\n<td><a href=\"#alt\"><code>alt</code></a></td>\n<td><code>alt=\"Picture of the author\"</code></td>\n<td>String</td>\n<td>Required</td>\n</tr>\n<tr>\n<td><a href=\"#loader\"><code>loader</code></a></td>\n<td><code>loader={imageLoader}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#fill\"><code>fill</code></a></td>\n<td><code>fill={true}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#sizes\"><code>sizes</code></a></td>\n<td><code>sizes=\"(max-width: 768px) 100vw, 33vw\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#quality\"><code>quality</code></a></td>\n<td><code>quality={80}</code></td>\n<td>Integer (1-100)</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#priority\"><code>priority</code></a></td>\n<td><code>priority={true}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#placeholder\"><code>placeholder</code></a></td>\n<td><code>placeholder=\"blur\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#style\"><code>style</code></a></td>\n<td><code>style={{objectFit: \"contain\"}}</code></td>\n<td>Object</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onloadingcomplete\"><code>onLoadingComplete</code></a></td>\n<td><code>onLoadingComplete={img =&gt; done())}</code></td>\n<td>Function</td>\n<td>Deprecated</td>\n</tr>\n<tr>\n<td><a href=\"#onload\"><code>onLoad</code></a></td>\n<td><code>onLoad={event =&gt; done())}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onerror\"><code>onError</code></a></td>\n<td><code>onError(event =&gt; fail()}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#loading\"><code>loading</code></a></td>\n<td><code>loading=\"lazy\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#blurdataurl\"><code>blurDataURL</code></a></td>\n<td><code>blurDataURL=\"data:image/jpeg...\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#overridesrc\"><code>overrideSrc</code></a></td>\n<td><code>overrideSrc=\"/seo.png\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n</tbody>\n</table></div></div> <h2 id=\"required-props\" data-docs-heading=\"\">Required Props     </h2> <p>The Image Component requires the following properties: <code>src</code>, <code>width</code>, <code>height</code>, and <code>alt</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;Image\n        src=\"/profile.png\"\n        width={500}\n        height={500}\n        alt=\"Picture of the author\"\n      /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <h3 id=\"src\" data-docs-heading=\"\">src     </h3> <p>Must be one of the following:</p> <ul> <li>A <a href=\"../../building-your-application/optimizing/images#local-images\">statically imported</a> image file</li> <li>A path string. This can be either an absolute external URL, or an internal path depending on the <a href=\"#loader\">loader</a> prop.</li> </ul> <p>When using an external URL, you must add it to <a href=\"#remotepatterns\">remotePatterns</a> in <code>next.config.js</code>.</p> <h3 id=\"width\" data-docs-heading=\"\">width     </h3> <p>The <code>width</code> property represents the <em>rendered</em> width in pixels, so it will affect how large the image appears.</p> <p>Required, except for <a href=\"../../building-your-application/optimizing/images#local-images\">statically imported images</a> or images with the <a href=\"#fill\"><code>fill</code> property</a>.</p> <h3 id=\"height\" data-docs-heading=\"\">height     </h3> <p>The <code>height</code> property represents the <em>rendered</em> height in pixels, so it will affect how large the image appears.</p> <p>Required, except for <a href=\"../../building-your-application/optimizing/images#local-images\">statically imported images</a> or images with the <a href=\"#fill\"><code>fill</code> property</a>.</p> <h3 id=\"alt\" data-docs-heading=\"\">alt     </h3> <p>The <code>alt</code> property is used to describe the image for screen readers and search engines. It is also the fallback text if images have been disabled or an error occurs while loading the image.</p> <p>It should contain text that could replace the image <a href=\"https://html.spec.whatwg.org/multipage/images.html#general-guidelines\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">without changing the meaning of the page</a>. It is not meant to supplement the image and should not repeat information that is already provided in the captions above or below the image.</p> <p>If the image is <a href=\"https://html.spec.whatwg.org/multipage/images.html#a-purely-decorative-image-that-doesn't-add-any-information\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">purely decorative</a> or <a href=\"https://html.spec.whatwg.org/multipage/images.html#an-image-not-intended-for-the-user\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">not intended for the user</a>, the <code>alt</code> property should be an empty string (<code>alt=\"\"</code>).</p> <p><a href=\"https://html.spec.whatwg.org/multipage/images.html#alt\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Learn more</a></p> <h2 id=\"optional-props\" data-docs-heading=\"\">Optional Props     </h2> <p>The <code>&lt;Image /&gt;</code> component accepts a number of additional properties beyond those which are required. This section describes the most commonly-used properties of the Image component. Find details about more rarely-used properties in the <a href=\"#advanced-props\">Advanced Props</a> section.</p> <h3 id=\"loader\" data-docs-heading=\"\">loader     </h3> <p>A custom function used to resolve image URLs.</p> <p>A <code>loader</code> is a function returning a URL string for the image, given the following parameters:</p> <ul> <li><a href=\"#src\"><code>src</code></a></li> <li><a href=\"#width\"><code>width</code></a></li> <li><a href=\"#quality\"><code>quality</code></a></li> </ul> <p>Here is an example of using a custom loader:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport Image from 'next/image'\n \nconst imageLoader = ({ src, width, quality }) =&gt; {\n  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`\n}\n \nexport default function Page() {\n  return (\n    &lt;Image\n      loader={imageLoader}\n      src=\"me.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    /&gt;\n  )\n}</pre>\n</div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Using props like <code>loader</code>, which accept a function, requires using <a href=\"../../building-your-application/rendering/client-components\">Client Components</a> to serialize the provided function.</p> </blockquote>  <p>Alternatively, you can use the <a href=\"#loaderfile\">loaderFile</a> configuration in <code>next.config.js</code> to configure every instance of <code>next/image</code> in your application, without passing a prop.</p> <h3 id=\"fill\" data-docs-heading=\"\">fill     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">fill={true} // {true} | {false}</pre>\n</div> <p>A boolean that causes the image to fill the parent element, which is useful when the <a href=\"#width\"><code>width</code></a> and <a href=\"#height\"><code>height</code></a> are unknown.</p> <p>The parent element <em>must</em> assign <code>position: \"relative\"</code>, <code>position: \"fixed\"</code>, or <code>position: \"absolute\"</code> style.</p> <p>By default, the img element will automatically be assigned the <code>position: \"absolute\"</code> style.</p> <p>If no styles are applied to the image, the image will stretch to fit the container. You may prefer to set <code>object-fit: \"contain\"</code> for an image which is letterboxed to fit the container and preserve aspect ratio.</p> <p>Alternatively, <code>object-fit: \"cover\"</code> will cause the image to fill the entire container and be cropped to preserve aspect ratio. For this to look correct, the <code>overflow: \"hidden\"</code> style should be assigned to the parent element.</p> <p>For more information, see also:</p> <ul> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/position\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>position</code></a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/object-fit\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>object-fit</code></a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/object-position\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>object-position</code></a></li> </ul> <h3 id=\"sizes\" data-docs-heading=\"\">sizes     </h3> <p>A string, similar to a media query, that provides information about how wide the image will be at different breakpoints. The value of <code>sizes</code> will greatly affect performance for images using <a href=\"#fill\"><code>fill</code></a> or which are <a href=\"#responsive-images\">styled to have a responsive size</a>.</p> <p>The <code>sizes</code> property serves two important purposes related to image performance:</p> <ul> <li>First, the value of <code>sizes</code> is used by the browser to determine which size of the image to download, from <code>next/image</code>'s automatically generated <code>srcset</code>. When the browser chooses, it does not yet know the size of the image on the page, so it selects an image that is the same size or larger than the viewport. The <code>sizes</code> property allows you to tell the browser that the image will actually be smaller than full screen. If you don't specify a <code>sizes</code> value in an image with the <code>fill</code> property, a default value of <code>100vw</code> (full screen width) is used.</li> <li>Second, the <code>sizes</code> property changes the behavior of the automatically generated <code>srcset</code> value. If no <code>sizes</code> value is present, a small <code>srcset</code> is generated, suitable for a fixed-size image (1x/2x/etc). If <code>sizes</code> is defined, a large <code>srcset</code> is generated, suitable for a responsive image (640w/750w/etc). If the <code>sizes</code> property includes sizes such as <code>50vw</code>, which represent a percentage of the viewport width, then the <code>srcset</code> is trimmed to not include any values which are too small to ever be necessary.</li> </ul> <p>For example, if you know your styling will cause an image to be full-width on mobile devices, in a 2-column layout on tablets, and a 3-column layout on desktop displays, you should include a sizes property such as the following:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return (\n    &lt;div className=\"grid-element\"&gt;\n      &lt;Image\n        fill\n        src=\"/example.png\"\n        sizes=\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\"\n      /&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <p>This example <code>sizes</code> could have a dramatic effect on performance metrics. Without the <code>33vw</code> sizes, the image selected from the server would be 3 times as wide as it needs to be. Because file size is proportional to the square of the width, without <code>sizes</code> the user would download an image that's 9 times larger than necessary.</p> <p>Learn more about <code>srcset</code> and <code>sizes</code>:</p> <ul> <li><a href=\"https://web.dev/learn/design/responsive-images/#sizes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">web.dev</a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/img#sizes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">mdn</a></li> </ul> <h3 id=\"quality\" data-docs-heading=\"\">quality     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">quality={75} // {number 1-100}</pre>\n</div> <p>The quality of the optimized image, an integer between <code>1</code> and <code>100</code>, where <code>100</code> is the best quality and therefore largest file size. Defaults to <code>75</code>.</p> <h3 id=\"priority\" data-docs-heading=\"\">priority     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">priority={false} // {false} | {true}</pre>\n</div> <p>When true, the image will be considered high priority and <a href=\"https://web.dev/preload-responsive-images/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preload</a>. Lazy loading is automatically disabled for images using <code>priority</code>.</p> <p>You should use the <code>priority</code> property on any image detected as the <a href=\"https://nextjs.org/learn/seo/web-performance/lcp\" rel=\"noopener noreferrer\" target=\"_blank\">Largest Contentful Paint (LCP)</a> element. It may be appropriate to have multiple priority images, as different images may be the LCP element for different viewport sizes.</p> <p>Should only be used when the image is visible above the fold. Defaults to <code>false</code>.</p> <h3 id=\"placeholder\" data-docs-heading=\"\">placeholder     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">placeholder = 'empty' // \"empty\" | \"blur\" | \"data:image/...\"</pre>\n</div> <p>A placeholder to use while the image is loading. Possible values are <code>blur</code>, <code>empty</code>, or <code>data:image/...</code>. Defaults to <code>empty</code>.</p> <p>When <code>blur</code>, the <a href=\"#blurdataurl\"><code>blurDataURL</code></a> property will be used as the placeholder. If <code>src</code> is an object from a <a href=\"../../building-your-application/optimizing/images#local-images\">static import</a> and the imported image is <code>.jpg</code>, <code>.png</code>, <code>.webp</code>, or <code>.avif</code>, then <code>blurDataURL</code> will be automatically populated, except when the image is detected to be animated.</p> <p>For dynamic images, you must provide the <a href=\"#blurdataurl\"><code>blurDataURL</code></a> property. Solutions such as <a href=\"https://github.com/joe-bell/plaiceholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Plaiceholder</a> can help with <code>base64</code> generation.</p> <p>When <code>data:image/...</code>, the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/Data_URIs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Data URL</a> will be used as the placeholder while the image is loading.</p> <p>When <code>empty</code>, there will be no placeholder while the image is loading, only empty space.</p> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/placeholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>blur</code> placeholder</a></li> <li><a href=\"https://image-component.nextjs.gallery/shimmer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the shimmer effect with data URL <code>placeholder</code> prop</a></li> <li><a href=\"https://image-component.nextjs.gallery/color\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the color effect with <code>blurDataURL</code> prop</a></li> </ul> <h2 id=\"advanced-props\" data-docs-heading=\"\">Advanced Props     </h2> <p>In some cases, you may need more advanced usage. The <code>&lt;Image /&gt;</code> component optionally accepts the following advanced properties.</p> <h3 id=\"style\" data-docs-heading=\"\">style     </h3> <p>Allows passing CSS styles to the underlying image element.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const imageStyle = {\n  borderRadius: '50%',\n  border: '1px solid #fff',\n}\n \nexport default function ProfileImage() {\n  return &lt;Image src=\"...\" style={imageStyle} /&gt;\n}</pre></div> <p>Remember that the required width and height props can interact with your styling. If you use styling to modify an image's width, you should also style its height to <code>auto</code> to preserve its intrinsic aspect ratio, or your image will be distorted.</p> <h3 id=\"onloadingcomplete\" data-docs-heading=\"\">onLoadingComplete     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \n&lt;Image onLoadingComplete={(img) =&gt; console.log(img.naturalWidth)} /&gt;</pre>\n</div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: Deprecated since Next.js 14 in favor of <a href=\"#onload\"><code>onLoad</code></a>.</p> </blockquote> <p>A callback function that is invoked once the image is completely loaded and the <a href=\"#placeholder\">placeholder</a> has been removed.</p> <p>The callback function will be called with one argument, a reference to the underlying <code>&lt;img&gt;</code> element.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Using props like <code>onLoadingComplete</code>, which accept a function, requires using <a href=\"../../building-your-application/rendering/client-components\">Client Components</a> to serialize the provided function.</p> </blockquote> <h3 id=\"onload\" data-docs-heading=\"\">onLoad     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image onLoad={(e) =&gt; console.log(e.target.naturalWidth)} /&gt;</pre>\n</div> <p>A callback function that is invoked once the image is completely loaded and the <a href=\"#placeholder\">placeholder</a> has been removed.</p> <p>The callback function will be called with one argument, the Event which has a <code>target</code> that references the underlying <code>&lt;img&gt;</code> element.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Using props like <code>onLoad</code>, which accept a function, requires using <a href=\"../../building-your-application/rendering/client-components\">Client Components</a> to serialize the provided function.</p> </blockquote> <h3 id=\"onerror\" data-docs-heading=\"\">onError     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image onError={(e) =&gt; console.error(e.target.id)} /&gt;</pre>\n</div> <p>A callback function that is invoked if the image fails to load.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Using props like <code>onError</code>, which accept a function, requires using <a href=\"../../building-your-application/rendering/client-components\">Client Components</a> to serialize the provided function.</p> </blockquote> <h3 id=\"loading\" data-docs-heading=\"\">loading     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: This property is only meant for advanced use cases. Switching an image to load with <code>eager</code> will normally <strong>hurt performance</strong>. We recommend using the <a href=\"#priority\"><code>priority</code></a> property instead, which will eagerly preload the image.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">loading = 'lazy' // {lazy} | {eager}</pre>\n</div> <p>The loading behavior of the image. Defaults to <code>lazy</code>.</p> <p>When <code>lazy</code>, defer loading the image until it reaches a calculated distance from the viewport.</p> <p>When <code>eager</code>, load the image immediately.</p> <p>Learn more about the <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/img#loading\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>loading</code> attribute</a>.</p> <h3 id=\"blurdataurl\" data-docs-heading=\"\">blurDataURL     </h3> <p>A <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/Data_URIs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Data URL</a> to be used as a placeholder image before the <code>src</code> image successfully loads. Only takes effect when combined with <a href=\"#placeholder\"><code>placeholder=\"blur\"</code></a>.</p> <p>Must be a base64-encoded image. It will be enlarged and blurred, so a very small image (10px or less) is recommended. Including larger images as placeholders may harm your application performance.</p> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/placeholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the default <code>blurDataURL</code> prop</a></li> <li><a href=\"https://image-component.nextjs.gallery/color\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the color effect with <code>blurDataURL</code> prop</a></li> </ul> <p>You can also <a href=\"https://png-pixel.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">generate a solid color Data URL</a> to match the image.</p> <h3 id=\"unoptimized\" data-docs-heading=\"\">unoptimized     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">unoptimized = {false} // {false} | {true}</pre>\n</div> <p>When true, the source image will be served as-is instead of changing quality, size, or format. Defaults to <code>false</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nconst UnoptimizedImage = (props) =&gt; {\n  return &lt;Image {...props} unoptimized /&gt;\n}</pre>\n</div> <p>Since Next.js 12.3.0, this prop can be assigned to all images by updating <code>next.config.js</code> with the following configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    unoptimized: true,\n  },\n}</pre></div> <h3 id=\"overridesrc\" data-docs-heading=\"\">overrideSrc     </h3> <p>When providing the <code>src</code> prop to the <code>&lt;Image&gt;</code> component, both the <code>srcset</code> and <code>src</code> attributes are generated automatically for the resulting <code>&lt;img&gt;</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image src=\"/me.jpg\" /&gt;</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;img\n  srcset=\"\n    /_next/image?url=%2Fme.jpg&amp;w=640&amp;q=75 1x,\n    /_next/image?url=%2Fme.jpg&amp;w=828&amp;q=75 2x\n  \"\n  src=\"/_next/image?url=%2Fme.jpg&amp;w=828&amp;q=75\"\n/&gt;</pre></div> <p>In some cases, it is not desirable to have the <code>src</code> attribute generated and you may wish to override it using the <code>overrideSrc</code> prop.</p> <p>For example, when upgrading an existing website from <code>&lt;img&gt;</code> to <code>&lt;Image&gt;</code>, you may wish to maintain the same <code>src</code> attribute for SEO purposes such as image ranking or avoiding recrawl.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image src=\"/me.jpg\" overrideSrc=\"/override.jpg\" /&gt;</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;img\n  srcset=\"\n    /_next/image?url=%2Fme.jpg&amp;w=640&amp;q=75 1x,\n    /_next/image?url=%2Fme.jpg&amp;w=828&amp;q=75 2x\n  \"\n  src=\"/override.jpg\"\n/&gt;</pre></div> <h3 id=\"other-props\" data-docs-heading=\"\">Other Props     </h3> <p>Other properties on the <code>&lt;Image /&gt;</code> component will be passed to the underlying <code>img</code> element with the exception of the following:</p> <ul> <li>\n<code>srcSet</code>. Use <a href=\"#devicesizes\">Device Sizes</a> instead.</li> <li>\n<code>decoding</code>. It is always <code>\"async\"</code>.</li> </ul> <h2 id=\"configuration-options\" data-docs-heading=\"\">Configuration Options     </h2> <p>In addition to props, you can configure the Image Component in <code>next.config.js</code>. The following options are available:</p> <h3 id=\"remotepatterns\" data-docs-heading=\"\">remotePatterns     </h3> <p>To protect your application from malicious users, configuration is required in order to use external images. This ensures that only external images from your account can be served from the Next.js Image Optimization API. These external images can be configured with the <code>remotePatterns</code> property in your <code>next.config.js</code> file, as shown below:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 'example.com',\n        port: '',\n        pathname: '/account123/**',\n      },\n    ],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The example above will ensure the <code>src</code> property of <code>next/image</code> must start with <code>https://example.com/account123/</code>. Any other protocol, hostname, port, or unmatched path will respond with 400 Bad Request.</p> </blockquote> <p>Below is another example of the <code>remotePatterns</code> property in the <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: '**.example.com',\n        port: '',\n      },\n    ],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The example above will ensure the <code>src</code> property of <code>next/image</code> must start with <code>https://img1.example.com</code> or <code>https://me.avatar.example.com</code> or any number of subdomains. Any other protocol, port, or unmatched hostname will respond with 400 Bad Request.</p> </blockquote> <p>Wildcard patterns can be used for both <code>pathname</code> and <code>hostname</code> and have the following syntax:</p> <ul> <li>\n<code>*</code> match a single path segment or subdomain</li> <li>\n<code>**</code> match any number of path segments at the end or subdomains at the beginning</li> </ul> <p>The <code>**</code> syntax does not work in the middle of the pattern.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: When omitting <code>protocol</code>, <code>port</code> or <code>pathname</code>, then the wildcard <code>**</code> is implied. This is not recommended because it may allow malicious actors to optimize urls you did not intend.</p> </blockquote> <h3 id=\"domains\" data-docs-heading=\"\">domains     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: Deprecated since Next.js 14 in favor of strict <a href=\"#remotepatterns\"><code>remotePatterns</code></a> in order to protect your application from malicious users. Only use <code>domains</code> if you own all the content served from the domain.</p> </blockquote> <p>Similar to <a href=\"#remotepatterns\"><code>remotePatterns</code></a>, the <code>domains</code> configuration can be used to provide a list of allowed hostnames for external images.</p> <p>However, the <code>domains</code> configuration does not support wildcard pattern matching and it cannot restrict protocol, port, or pathname.</p> <p>Below is an example of the <code>domains</code> property in the <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    domains: ['assets.acme.com'],\n  },\n}</pre></div> <h3 id=\"loaderfile\" data-docs-heading=\"\">loaderFile     </h3> <p>If you want to use a cloud provider to optimize images instead of using the Next.js built-in Image Optimization API, you can configure the <code>loaderFile</code> in your <code>next.config.js</code> like the following:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    loader: 'custom',\n    loaderFile: './my/image/loader.js',\n  },\n}</pre></div> <p>This must point to a file relative to the root of your Next.js application. The file must export a default function that returns a string, for example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nexport default function myImageLoader({ src, width, quality }) {\n  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`\n}</pre></div>  <p>Alternatively, you can use the <a href=\"#loader\"><code>loader</code> prop</a> to configure each instance of <code>next/image</code>.</p> <p>Examples:</p> <ul> <li><a href=\"../next-config-js/images#example-loader-configuration\">Custom Image Loader Configuration</a></li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Customizing the image loader file, which accepts a function, requires using <a href=\"../../building-your-application/rendering/client-components\">Client Components</a> to serialize the provided function.</p> </blockquote> <h2 id=\"advanced\" data-docs-heading=\"\">Advanced     </h2> <p>The following configuration is for advanced use cases and is usually not necessary. If you choose to configure the properties below, you will override any changes to the Next.js defaults in future updates.</p> <h3 id=\"devicesizes\" data-docs-heading=\"\">deviceSizes     </h3> <p>If you know the expected device widths of your users, you can specify a list of device width breakpoints using the <code>deviceSizes</code> property in <code>next.config.js</code>. These widths are used when the <code>next/image</code> component uses <a href=\"#sizes\"><code>sizes</code></a> prop to ensure the correct image is served for user's device.</p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],\n  },\n}</pre></div> <h3 id=\"imagesizes\" data-docs-heading=\"\">imageSizes     </h3> <p>You can specify a list of image widths using the <code>images.imageSizes</code> property in your <code>next.config.js</code> file. These widths are concatenated with the array of <a href=\"#devicesizes\">device sizes</a> to form the full array of sizes used to generate image <a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/srcset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">srcset</a>s.</p> <p>The reason there are two separate lists is that imageSizes is only used for images which provide a <a href=\"#sizes\"><code>sizes</code></a> prop, which indicates that the image is less than the full width of the screen. <strong>Therefore, the sizes in imageSizes should all be smaller than the smallest size in deviceSizes.</strong></p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],\n  },\n}</pre></div> <h3 id=\"formats\" data-docs-heading=\"\">formats     </h3> <p>The default <a href=\"#loader\">Image Optimization API</a> will automatically detect the browser's supported image formats via the request's <code>Accept</code> header.</p> <p>If the <code>Accept</code> head matches more than one of the configured formats, the first match in the array is used. Therefore, the array order matters. If there is no match (or the source image is <a href=\"#animated-images\">animated</a>), the Image Optimization API will fallback to the original image's format.</p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    formats: ['image/webp'],\n  },\n}</pre></div> <p>You can enable AVIF support with the following configuration.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    formats: ['image/avif', 'image/webp'],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>AVIF generally takes 20% longer to encode but it compresses 20% smaller compared to WebP. This means that the first time an image is requested, it will typically be slower and then subsequent requests that are cached will be faster.</li> <li>If you self-host with a Proxy/CDN in front of Next.js, you must configure the Proxy to forward the <code>Accept</code> header.</li> </ul> </blockquote> <h2 id=\"caching-behavior\" data-docs-heading=\"\">Caching Behavior     </h2> <p>The following describes the caching algorithm for the default <a href=\"#loader\">loader</a>. For all other loaders, please refer to your cloud provider's documentation.</p> <p>Images are optimized dynamically upon request and stored in the <code>&lt;distDir&gt;/cache/images</code> directory. The optimized image file will be served for subsequent requests until the expiration is reached. When a request is made that matches a cached but expired file, the expired image is served stale immediately. Then the image is optimized again in the background (also called revalidation) and saved to the cache with the new expiration date.</p> <p>The cache status of an image can be determined by reading the value of the <code>x-nextjs-cache</code> response header. The possible values are the following:</p> <ul> <li>\n<code>MISS</code> - the path is not in the cache (occurs at most once, on the first visit)</li> <li>\n<code>STALE</code> - the path is in the cache but exceeded the revalidate time so it will be updated in the background</li> <li>\n<code>HIT</code> - the path is in the cache and has not exceeded the revalidate time</li> </ul> <p>The expiration (or rather Max Age) is defined by either the <a href=\"#minimumcachettl\"><code>minimumCacheTTL</code></a> configuration or the upstream image <code>Cache-Control</code> header, whichever is larger. Specifically, the <code>max-age</code> value of the <code>Cache-Control</code> header is used. If both <code>s-maxage</code> and <code>max-age</code> are found, then <code>s-maxage</code> is preferred. The <code>max-age</code> is also passed-through to any downstream clients including CDNs and browsers.</p> <ul> <li>You can configure <a href=\"#minimumcachettl\"><code>minimumCacheTTL</code></a> to increase the cache duration when the upstream image does not include <code>Cache-Control</code> header or the value is very low.</li> <li>You can configure <a href=\"#devicesizes\"><code>deviceSizes</code></a> and <a href=\"#imagesizes\"><code>imageSizes</code></a> to reduce the total number of possible generated images.</li> <li>You can configure <a href=\"#formats\">formats</a> to disable multiple formats in favor of a single image format.</li> </ul> <h3 id=\"minimumcachettl\" data-docs-heading=\"\">minimumCacheTTL     </h3> <p>You can configure the Time to Live (TTL) in seconds for cached optimized images. In many cases, it's better to use a <a href=\"../../building-your-application/optimizing/images#local-images\">Static Image Import</a> which will automatically hash the file contents and cache the image forever with a <code>Cache-Control</code> header of <code>immutable</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    minimumCacheTTL: 60,\n  },\n}</pre></div> <p>The expiration (or rather Max Age) of the optimized image is defined by either the <code>minimumCacheTTL</code> or the upstream image <code>Cache-Control</code> header, whichever is larger.</p> <p>If you need to change the caching behavior per image, you can configure <a href=\"../next-config-js/headers\"><code>headers</code></a> to set the <code>Cache-Control</code> header on the upstream image (e.g. <code>/some-asset.jpg</code>, not <code>/_next/image</code> itself).</p> <p>There is no mechanism to invalidate the cache at this time, so its best to keep <code>minimumCacheTTL</code> low. Otherwise you may need to manually change the <a href=\"#src\"><code>src</code></a> prop or delete <code>&lt;distDir&gt;/cache/images</code>.</p> <h3 id=\"disablestaticimages\" data-docs-heading=\"\">disableStaticImages     </h3> <p>The default behavior allows you to import static files such as <code>import icon from './icon.png'</code> and then pass that to the <code>src</code> property.</p> <p>In some cases, you may wish to disable this feature if it conflicts with other plugins that expect the import to behave differently.</p> <p>You can disable static image imports inside your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    disableStaticImages: true,\n  },\n}</pre></div> <h3 id=\"dangerouslyallowsvg\" data-docs-heading=\"\">dangerouslyAllowSVG     </h3> <p>The default <a href=\"#loader\">loader</a> does not optimize SVG images for a few reasons. First, SVG is a vector format meaning it can be resized losslessly. Second, SVG has many of the same features as HTML/CSS, which can lead to vulnerabilities without proper <a href=\"../next-config-js/headers#content-security-policy\">Content Security Policy (CSP) headers</a>.</p> <p>Therefore, we recommended using the <a href=\"#unoptimized\"><code>unoptimized</code></a> prop when the <a href=\"#src\"><code>src</code></a> prop is known to be SVG. This happens automatically when <code>src</code> ends with <code>\".svg\"</code>.</p> <p>However, if you need to serve SVG images with the default Image Optimization API, you can set <code>dangerouslyAllowSVG</code> inside your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    dangerouslyAllowSVG: true,\n    contentDispositionType: 'attachment',\n    contentSecurityPolicy: \"default-src 'self'; script-src 'none'; sandbox;\",\n  },\n}</pre></div> <p>In addition, it is strongly recommended to also set <code>contentDispositionType</code> to force the browser to download the image, as well as <code>contentSecurityPolicy</code> to prevent scripts embedded in the image from executing.</p> <h2 id=\"animated-images\" data-docs-heading=\"\">Animated Images     </h2> <p>The default <a href=\"#loader\">loader</a> will automatically bypass Image Optimization for animated images and serve the image as-is.</p> <p>Auto-detection for animated files is best-effort and supports GIF, APNG, and WebP. If you want to explicitly bypass Image Optimization for a given animated image, use the <a href=\"#unoptimized\">unoptimized</a> prop.</p> <h2 id=\"responsive-images\" data-docs-heading=\"\">Responsive Images     </h2> <p>The default generated <code>srcset</code> contains <code>1x</code> and <code>2x</code> images in order to support different device pixel ratios. However, you may wish to render a responsive image that stretches with the viewport. In that case, you'll need to set <a href=\"#sizes\"><code>sizes</code></a> as well as <code>style</code> (or <code>className</code>).</p> <p>You can render a responsive image using one of the following methods below.</p> <h3 id=\"responsive-image-using-a-static-import\" data-docs-heading=\"\">Responsive image using a static import     </h3> <p>If the source image is not dynamic, you can statically import to create a responsive image:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport me from '../photos/me.jpg'\n \nexport default function Author() {\n  return (\n    &lt;Image\n      src={me}\n      alt=\"Picture of the author\"\n      sizes=\"100vw\"\n      style={{\n        width: '100%',\n        height: 'auto',\n      }}\n    /&gt;\n  )\n}</pre></div> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/responsive\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the image responsive to viewport</a></li> </ul> <h3 id=\"responsive-image-with-aspect-ratio\" data-docs-heading=\"\">Responsive image with aspect ratio     </h3> <p>If the source image is a dynamic or a remote url, you will also need to provide <code>width</code> and <code>height</code> to set the correct aspect ratio of the responsive image:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page({ photoUrl }) {\n  return (\n    &lt;Image\n      src={photoUrl}\n      alt=\"Picture of the author\"\n      sizes=\"100vw\"\n      style={{\n        width: '100%',\n        height: 'auto',\n      }}\n      width={500}\n      height={300}\n    /&gt;\n  )\n}</pre></div> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/responsive\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the image responsive to viewport</a></li> </ul> <h3 id=\"responsive-image-with-fill\" data-docs-heading=\"\">Responsive image with fill     </h3> <p>If you don't know the aspect ratio, you will need to set the <a href=\"#fill\"><code>fill</code></a> prop and set <code>position: relative</code> on the parent. Optionally, you can set <code>object-fit</code> style depending on the desired stretch vs crop behavior:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page({ photoUrl }) {\n  return (\n    &lt;div style={{ position: 'relative', width: '300px', height: '500px' }}&gt;\n      &lt;Image\n        src={photoUrl}\n        alt=\"Picture of the author\"\n        sizes=\"300px\"\n        fill\n        style={{\n          objectFit: 'contain',\n        }}\n      /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/fill\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>fill</code> prop</a></li> </ul> <h2 id=\"theme-detection-css\" data-docs-heading=\"\">Theme Detection CSS     </h2> <p>If you want to display a different image for light and dark mode, you can create a new component that wraps two <code>&lt;Image&gt;</code> components and reveals the correct one based on a CSS media query.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.imgDark {\n  display: none;\n}\n \n@media (prefers-color-scheme: dark) {\n  .imgLight {\n    display: none;\n  }\n  .imgDark {\n    display: unset;\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import styles from './theme-image.module.css'\nimport Image, { ImageProps } from 'next/image'\n \ntype Props = Omit&lt;ImageProps, 'src' | 'priority' | 'loading'&gt; &amp; {\n  srcLight: string\n  srcDark: string\n}\n \nconst ThemeImage = (props: Props) =&gt; {\n  const { srcLight, srcDark, ...rest } = props\n \n  return (\n    &lt;&gt;\n      &lt;Image {...rest} src={srcLight} className={styles.imgLight} /&gt;\n      &lt;Image {...rest} src={srcDark} className={styles.imgDark} /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The default behavior of <code>loading=\"lazy\"</code> ensures that only the correct image is loaded. You cannot use <code>priority</code> or <code>loading=\"eager\"</code> because that would cause both images to load. Instead, you can use <a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/fetchPriority\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>fetchPriority=\"high\"</code></a>.</p> </blockquote> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/theme\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo light/dark mode theme detection</a></li> </ul> <h2 id=\"getimageprops\" data-docs-heading=\"\">getImageProps     </h2> <p>For more advanced use cases, you can call <code>getImageProps()</code> to get the props that would be passed to the underlying <code>&lt;img&gt;</code> element, and instead pass to them to another component, style, canvas, etc.</p> <p>This also avoid calling React <code>useState()</code> so it can lead to better performance, but it cannot be used with the <a href=\"#placeholder\"><code>placeholder</code></a> prop because the placeholder will never be removed.</p> <h3 id=\"theme-detection-picture\" data-docs-heading=\"\">Theme Detection Picture     </h3> <p>If you want to display a different image for light and dark mode, you can use the <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/picture\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>&lt;picture&gt;</code></a> element to display a different image based on the user's <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preferred color scheme</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getImageProps } from 'next/image'\n \nexport default function Page() {\n  const common = { alt: 'Theme Example', width: 800, height: 400 }\n  const {\n    props: { srcSet: dark },\n  } = getImageProps({ ...common, src: '/dark.png' })\n  const {\n    props: { srcSet: light, ...rest },\n  } = getImageProps({ ...common, src: '/light.png' })\n \n  return (\n    &lt;picture&gt;\n      &lt;source media=\"(prefers-color-scheme: dark)\" srcSet={dark} /&gt;\n      &lt;source media=\"(prefers-color-scheme: light)\" srcSet={light} /&gt;\n      &lt;img {...rest} /&gt;\n    &lt;/picture&gt;\n  )\n}</pre></div> <h3 id=\"art-direction\" data-docs-heading=\"\">Art Direction     </h3> <p>If you want to display a different image for mobile and desktop, sometimes called <a href=\"https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images#art_direction\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Art Direction</a>, you can provide different <code>src</code>, <code>width</code>, <code>height</code>, and <code>quality</code> props to <code>getImageProps()</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getImageProps } from 'next/image'\n \nexport default function Home() {\n  const common = { alt: 'Art Direction Example', sizes: '100vw' }\n  const {\n    props: { srcSet: desktop },\n  } = getImageProps({\n    ...common,\n    width: 1440,\n    height: 875,\n    quality: 80,\n    src: '/desktop.jpg',\n  })\n  const {\n    props: { srcSet: mobile, ...rest },\n  } = getImageProps({\n    ...common,\n    width: 750,\n    height: 1334,\n    quality: 70,\n    src: '/mobile.jpg',\n  })\n \n  return (\n    &lt;picture&gt;\n      &lt;source media=\"(min-width: 1000px)\" srcSet={desktop} /&gt;\n      &lt;source media=\"(min-width: 500px)\" srcSet={mobile} /&gt;\n      &lt;img {...rest} style={{ width: '100%', height: 'auto' }} /&gt;\n    &lt;/picture&gt;\n  )\n}</pre></div> <h3 id=\"background-css\" data-docs-heading=\"\">Background CSS     </h3> <p>You can even convert the <code>srcSet</code> string to the <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/image/image-set\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>image-set()</code></a> CSS function to optimize a background image.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getImageProps } from 'next/image'\n \nfunction getBackgroundImage(srcSet = '') {\n  const imageSet = srcSet\n    .split(', ')\n    .map((str) =&gt; {\n      const [url, dpi] = str.split(' ')\n      return `url(\"${url}\") ${dpi}`\n    })\n    .join(', ')\n  return `image-set(${imageSet})`\n}\n \nexport default function Home() {\n  const {\n    props: { srcSet },\n  } = getImageProps({ alt: '', width: 128, height: 128, src: '/img.png' })\n  const backgroundImage = getBackgroundImage(srcSet)\n  const style = { height: '100vh', width: '100vw', backgroundImage }\n \n  return (\n    &lt;main style={style}&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n    &lt;/main&gt;\n  )\n}</pre></div> <h2 id=\"known-browser-bugs\" data-docs-heading=\"\">Known Browser Bugs     </h2> <p>This <code>next/image</code> component uses browser native <a href=\"https://caniuse.com/loading-lazy-attr\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">lazy loading</a>, which may fallback to eager loading for older browsers before Safari 15.4. When using the blur-up placeholder, older browsers before Safari 12 will fallback to empty placeholder. When using styles with <code>width</code>/<code>height</code> of <code>auto</code>, it is possible to cause <a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Layout Shift</a> on older browsers before Safari 15 that don't <a href=\"https://caniuse.com/mdn-html_elements_img_aspect_ratio_computed_from_attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preserve the aspect ratio</a>. For more details, see <a href=\"https://www.youtube.com/watch?v=4-d_SoCHeWE\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">this MDN video</a>.</p> <ul> <li>\n<a href=\"https://bugs.webkit.org/show_bug.cgi?id=243601\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Safari 15 - 16.3</a> display a gray border while loading. Safari 16.4 <a href=\"https://webkit.org/blog/13966/webkit-features-in-safari-16-4/#:~:text=Now%20in%20Safari%2016.4%2C%20a%20gray%20line%20no%20longer%20appears%20to%20mark%20the%20space%20where%20a%20lazy%2Dloaded%20image%20will%20appear%20once%20it%E2%80%99s%20been%20loaded.\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">fixed this issue</a>. Possible solutions: <ul> <li>Use CSS <code>@supports (font: -apple-system-body) and (-webkit-appearance: none) { img[loading=\"lazy\"] { clip-path: inset(0.6px) } }</code>\n</li> <li>Use <a href=\"#priority\"><code>priority</code></a> if the image is above the fold</li> </ul> </li> <li>\n<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1556156\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Firefox 67+</a> displays a white background while loading. Possible solutions: <ul> <li>Enable <a href=\"#formats\">AVIF <code>formats</code></a>\n</li> <li>Use <a href=\"#placeholder\"><code>placeholder</code></a>\n</li> </ul> </li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v14.2.0</code></td>\n<td>\n<code>overrideSrc</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v14.1.0</code></td>\n<td>\n<code>getImageProps()</code> is stable.</td>\n</tr>\n<tr>\n<td><code>v14.0.0</code></td>\n<td>\n<code>onLoadingComplete</code> prop and <code>domains</code> config deprecated.</td>\n</tr>\n<tr>\n<td><code>v13.4.14</code></td>\n<td>\n<code>placeholder</code> prop support for <code>data:/image...</code>\n</td>\n</tr>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>\n<code>contentDispositionType</code> configuration added.</td>\n</tr>\n<tr>\n<td><code>v13.0.6</code></td>\n<td>\n<code>ref</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>The <code>next/image</code> import was renamed to <code>next/legacy/image</code>. The <code>next/future/image</code> import was renamed to <code>next/image</code>. A <a href=\"../../building-your-application/upgrading/codemods#next-image-to-legacy-image\">codemod is available</a> to safely and automatically rename your imports. <code>&lt;span&gt;</code> wrapper removed. <code>layout</code>, <code>objectFit</code>, <code>objectPosition</code>, <code>lazyBoundary</code>, <code>lazyRoot</code> props removed. <code>alt</code> is required. <code>onLoadingComplete</code> receives reference to <code>img</code> element. Built-in loader config removed.</td>\n</tr>\n<tr>\n<td><code>v12.3.0</code></td>\n<td>\n<code>remotePatterns</code> and <code>unoptimized</code> configuration is stable.</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>Experimental <code>remotePatterns</code> and experimental <code>unoptimized</code> configuration added. <code>layout=\"raw\"</code> removed.</td>\n</tr>\n<tr>\n<td><code>v12.1.1</code></td>\n<td>\n<code>style</code> prop added. Experimental support for <code>layout=\"raw\"</code> added.</td>\n</tr>\n<tr>\n<td><code>v12.1.0</code></td>\n<td>\n<code>dangerouslyAllowSVG</code> and <code>contentSecurityPolicy</code> configuration added.</td>\n</tr>\n<tr>\n<td><code>v12.0.9</code></td>\n<td>\n<code>lazyRoot</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>\n<code>formats</code> configuration added.<br>AVIF support added.<br>Wrapper <code>&lt;div&gt;</code> changed to <code>&lt;span&gt;</code>.</td>\n</tr>\n<tr>\n<td><code>v11.1.0</code></td>\n<td>\n<code>onLoadingComplete</code> and <code>lazyBoundary</code> props added.</td>\n</tr>\n<tr>\n<td><code>v11.0.0</code></td>\n<td>\n<code>src</code> prop support for static import.<br><code>placeholder</code> prop added.<br><code>blurDataURL</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v10.0.5</code></td>\n<td>\n<code>loader</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v10.0.1</code></td>\n<td>\n<code>layout</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v10.0.0</code></td>\n<td>\n<code>next/image</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/components/image\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/components/image</a>\n  </p>\n</div>\n","app/api-reference/file-conventions":"<h1 class=\"break-words\">File Conventions</h1><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/default":"<h1 class=\"break-words\">default.js</h1>\n<p>The <code>default.js</code> file is used to render a fallback within <a href=\"../../building-your-application/routing/parallel-routes\">Parallel Routes</a> when Next.js cannot recover a <a href=\"../../building-your-application/routing/parallel-routes#slots\">slot's</a> active state after a full-page load.</p> <p>During <a href=\"../../building-your-application/routing/linking-and-navigating#5-soft-navigation\">soft navigation</a>, Next.js keeps track of the active <em>state</em> (subpage) for each slot. However, for hard navigations (full-page load), Next.js cannot recover the active state. In this case, a <code>default.js</code> file can be rendered for subpages that don't match the current URL.</p> <p>Consider the following folder structure. The <code>@team</code> slot has a <code>settings</code> page, but <code>@analytics</code> does not.</p> <figure><img alt=\"Parallel Routes unmatched routes\" loading=\"lazy\" width=\"1600\" height=\"930\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-unmatched-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-unmatched-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fparallel-routes-unmatched-routes.png&amp;w=3840&amp;q=75\"><img alt=\"Parallel Routes unmatched routes\" loading=\"lazy\" width=\"1600\" height=\"930\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-unmatched-routes.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-unmatched-routes.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fparallel-routes-unmatched-routes.png&amp;w=3840&amp;q=75\"></figure> <p>When navigating to <code>/settings</code>, the <code>@team</code> slot will render the <code>settings</code> page while maintaining the currently active page for the <code>@analytics</code> slot.</p> <p>On refresh, Next.js will render a <code>default.js</code> for <code>@analytics</code>. If <code>default.js</code> doesn't exist, a <code>404</code> is rendered instead.</p> <p>Additionally, since <code>children</code> is an implicit slot, you also need to create a <code>default.js</code> file to render a fallback for <code>children</code> when Next.js cannot recover the active state of the parent page.</p> <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <h3 id=\"params-optional\" data-docs-heading=\"\">params (optional)     </h3> <p>An object containing the <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route parameters</a> from the root segment down to the slot's subpages. For example:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Example</th>\n<th>URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/@sidebar/[artist]/default.js</code></td>\n<td><code>/zack</code></td>\n<td><code>{ artist: 'zack' }</code></td>\n</tr>\n<tr>\n<td><code>app/@sidebar/[artist]/[album]/default.js</code></td>\n<td><code>/zack/next</code></td>\n<td><code>{ artist: 'zack', album: 'next' }</code></td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/default\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/default</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/loading":"<h1 class=\"break-words\">loading.js</h1>\n<p>A <strong>loading</strong> file can create instant loading states built on <a href=\"../../building-your-application/routing/loading-ui-and-streaming\">Suspense</a>.</p> <p>By default, this file is a <a href=\"../../building-your-application/rendering/server-components\">Server Component</a> - but can also be used as a Client Component through the <code>\"use client\"</code> directive.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Loading() {\n  // Or a custom loading skeleton component\n  return &lt;p&gt;Loading...&lt;/p&gt;\n}</pre></div>  <p>Loading UI components do not accept any parameters.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>While designing loading UI, you may find it helpful to use the <a href=\"https://react.dev/learn/react-developer-tools\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Developer Tools</a> to manually toggle Suspense boundaries.</li> </ul> </blockquote> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>loading</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/loading\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/loading</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/middleware":"<h1 class=\"break-words\">middleware.js</h1>\n<p>The <code>middleware.js|ts</code> file is used to write <a href=\"../../building-your-application/routing/middleware\">Middleware</a> and run code on the server before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.</p> <p>Middleware executes before routes are rendered. It's particularly useful for implementing custom server-side logic like authentication, logging, or handling redirects.</p> <p>Use the file <code>middleware.ts</code> (or .js) in the root of your project to define Middleware. For example, at the same level as <code>app</code> or <code>pages</code>, or inside <code>src</code> if applicable.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse, NextRequest } from 'next/server'\n \n// This function can be marked `async` if using `await` inside\nexport function middleware(request: NextRequest) {\n  return NextResponse.redirect(new URL('/home', request.url))\n}\n \nexport const config = {\n  matcher: '/about/:path*',\n}</pre></div>  <h2 id=\"exports\" data-docs-heading=\"\">Exports     </h2> <h3 id=\"middleware-function\" data-docs-heading=\"\">Middleware function     </h3> <p>The file must export a single function, either as a default export or named <code>middleware</code>. Note that multiple middleware from the same file are not supported.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Example of default export\nexport default function middleware(request) {\n  // Middleware logic\n}</pre></div> <h3 id=\"config-object-optional\" data-docs-heading=\"\">Config object (optional)     </h3> <p>Optionally, a config object can be exported alongside the Middleware function. This object includes the <a href=\"#matcher\">matcher</a> to specify paths where the Middleware applies.</p> <h4 id=\"matcher\" data-docs-heading=\"\">Matcher     </h4> <p>The <code>matcher</code> option allows you to target specific paths for the Middleware to run on. You can specify these paths in several ways:</p> <ul> <li>For a single path: Directly use a string to define the path, like <code>'/about'</code>.</li> <li>For multiple paths: Use an array to list multiple paths, such as <code>matcher: ['/about', '/contact']</code>, which applies the Middleware to both <code>/about</code> and <code>/contact</code>.</li> </ul> <p>Additionally, <code>matcher</code> supports complex path specifications through regular expressions, such as <code>matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)']</code>, enabling precise control over which paths to include or exclude.</p> <p>The <code>matcher</code> option also accepts an array of objects with the following keys:</p> <ul> <li>\n<code>source</code>: The path or pattern used to match the request paths. It can be a string for direct path matching or a pattern for more complex matching.</li> <li>\n<code>regexp</code> (optional): A regular expression string that fine-tunes the matching based on the source. It provides additional control over which paths are included or excluded.</li> <li>\n<code>locale</code> (optional): A boolean that, when set to <code>false</code>, ignores locale-based routing in path matching.</li> <li>\n<code>has</code> (optional): Specifies conditions based on the presence of specific request elements such as headers, query parameters, or cookies.</li> <li>\n<code>missing</code> (optional): Focuses on conditions where certain request elements are absent, like missing headers or cookies.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: [\n    {\n      source: '/api/*',\n      regexp: '^/api/(.*)',\n      locale: false,\n      has: [\n        { type: 'header', key: 'Authorization', value: 'Bearer Token' },\n        { type: 'query', key: 'userId', value: '123' },\n      ],\n      missing: [{ type: 'cookie', key: 'session', value: 'active' }],\n    },\n  ],\n}</pre></div> <h2 id=\"params\" data-docs-heading=\"\">Params     </h2> <h3 id=\"request\" data-docs-heading=\"\">request     </h3> <p>When defining Middleware, the default export function accepts a single parameter, <code>request</code>. This parameter is an instance of <code>NextRequest</code>, which represents the incoming HTTP request.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  // Middleware logic goes here\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>NextRequest</code> is a type that represents incoming HTTP requests in Next.js Middleware, whereas <a href=\"#nextresponse\"><code>NextResponse</code></a> is a class used to manipulate and send back HTTP responses.</li> </ul> </blockquote> <h2 id=\"nextresponse\" data-docs-heading=\"\">NextResponse     </h2> <p>Middleware can use the <a href=\"../../building-your-application/routing/middleware#nextresponse\"><code>NextResponse</code></a> object which extends the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Response API</a>. By returning a <code>NextResponse</code> object, you can directly manipulate cookies, set headers, implement redirects, and rewrite paths.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: For redirects, you can also use <code>Response.redirect</code> instead of <code>NextResponse.redirect</code>.</p> </blockquote> <h2 id=\"runtime\" data-docs-heading=\"\">Runtime     </h2> <p>Middleware only supports the <a href=\"../../building-your-application/rendering/edge-and-nodejs-runtimes\">Edge runtime</a>. The Node.js runtime cannot be used.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.1.0</code></td>\n<td>Advanced Middleware flags added</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>Middleware can modify request headers, response headers, and send responses</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>Middleware is stable, please see the <a href=\"../../../messages/middleware-upgrade-guide\">upgrade guide</a>\n</td>\n</tr>\n<tr>\n<td><code>v12.0.9</code></td>\n<td>Enforce absolute URLs in Edge Runtime (<a href=\"https://github.com/vercel/next.js/pull/33410\" rel=\"noopener noreferrer\" target=\"_blank\">PR</a>)</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>Middleware (Beta) added</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/middleware\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/middleware</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/not-found":"<h1 class=\"break-words\">not-found.js</h1>\n<p>The <strong>not-found</strong> file is used to render UI when the <a href=\"../functions/not-found\"><code>notFound</code></a> function is thrown within a route segment. Along with serving a custom UI, Next.js will return a <code>200</code> HTTP status code for streamed responses, and <code>404</code> for non-streamed responses.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function NotFound() {\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;Not Found&lt;/h2&gt;\n      &lt;p&gt;Could not find requested resource&lt;/p&gt;\n      &lt;Link href=\"/\"&gt;Return Home&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: In addition to catching expected <code>notFound()</code> errors, the root <code>app/not-found.js</code> file also handles any unmatched URLs for your whole application. This means users that visit a URL that is not handled by your app will be shown the UI exported by the <code>app/not-found.js</code> file.</p> </blockquote> <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <p><code>not-found.js</code> components do not accept any props.</p> <h2 id=\"data-fetching\" data-docs-heading=\"\">Data Fetching     </h2> <p>By default, <code>not-found</code> is a Server Component. You can mark it as <code>async</code> to fetch and display data:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\nimport { headers } from 'next/headers'\n \nexport default async function NotFound() {\n  const headersList = headers()\n  const domain = headersList.get('host')\n  const data = await getSiteData(domain)\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;Not Found: {data.name}&lt;/h2&gt;\n      &lt;p&gt;Could not find requested resource&lt;/p&gt;\n      &lt;p&gt;\n        View &lt;Link href=\"/blog\"&gt;all posts&lt;/Link&gt;\n      &lt;/p&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>If you need to use Client Component hooks like <code>usePathname</code> to display content based on the path, you must fetch data on the client-side instead.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>Root <code>app/not-found</code> handles global unmatched URLs.</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>not-found</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/not-found\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/not-found</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/page":"<h1 class=\"break-words\">page.js</h1>\n<p>A <strong>page</strong> is UI that is unique to a route.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page({\n  params,\n  searchParams,\n}: {\n  params: { slug: string }\n  searchParams: { [key: string]: string | string[] | undefined }\n}) {\n  return &lt;h1&gt;My Page&lt;/h1&gt;\n}</pre></div>  <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <h3 id=\"params-optional\" data-docs-heading=\"\">params (optional)     </h3> <p>An object containing the <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route parameters</a> from the root segment down to that page. For example:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Example</th>\n<th>URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/shop/[slug]/page.js</code></td>\n<td><code>/shop/1</code></td>\n<td><code>{ slug: '1' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[category]/[item]/page.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ category: '1', item: '2' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/page.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ slug: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"searchparams-optional\" data-docs-heading=\"\">searchParams (optional)     </h3> <p>An object containing the <a href=\"https://developer.mozilla.org/docs/Learn/Common_questions/What_is_a_URL#parameters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">search parameters</a> of the current URL. For example:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>URL</th>\n<th><code>searchParams</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>/shop?a=1</code></td>\n<td><code>{ a: '1' }</code></td>\n</tr>\n<tr>\n<td><code>/shop?a=1&amp;b=2</code></td>\n<td><code>{ a: '1', b: '2' }</code></td>\n</tr>\n<tr>\n<td><code>/shop?a=1&amp;a=2</code></td>\n<td><code>{ a: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>searchParams</code> is a <strong><a href=\"#\">Dynamic API</a></strong> whose values cannot be known ahead of time. Using it will opt the page into <strong><a href=\"../../building-your-application/rendering/server-components#dynamic-rendering\">dynamic rendering</a></strong> at request time.</li> <li>\n<code>searchParams</code> returns a plain JavaScript object and not a <code>URLSearchParams</code> instance.</li> </ul> </blockquote> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>page</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/page\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/page</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/route":"<h1 class=\"break-words\">route.js</h1>\n<p>Route Handlers allow you to create custom request handlers for a given route using the Web <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Request</a> and <a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Response</a> APIs.</p> <h2 id=\"http-methods\" data-docs-heading=\"\">HTTP Methods     </h2> <p>A <strong>route</strong> file allows you to create custom request handlers for a given route. The following <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Methods\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP methods</a> are supported: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, <code>DELETE</code>, <code>HEAD</code>, and <code>OPTIONS</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET(request: Request) {}\n \nexport async function HEAD(request: Request) {}\n \nexport async function POST(request: Request) {}\n \nexport async function PUT(request: Request) {}\n \nexport async function DELETE(request: Request) {}\n \nexport async function PATCH(request: Request) {}\n \n// If `OPTIONS` is not defined, Next.js will automatically implement `OPTIONS` and  set the appropriate Response `Allow` header depending on the other methods defined in the route handler.\nexport async function OPTIONS(request: Request) {}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Route Handlers are only available inside the <code>app</code> directory. You <strong>do not</strong> need to use API Routes (<code>pages</code>) and Route Handlers (<code>app</code>) together, as Route Handlers should be able to handle all use cases.</p> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <h3 id=\"request-optional\" data-docs-heading=\"\">request (optional)     </h3> <p>The <code>request</code> object is a <a href=\"../functions/next-request\">NextRequest</a> object, which is an extension of the Web <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Request</a> API. <code>NextRequest</code> gives you further control over the incoming request, including easily accessing <code>cookies</code> and an extended, parsed, URL object <code>nextUrl</code>.</p> <h3 id=\"context-optional\" data-docs-heading=\"\">context (optional)     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">type Params = {\n  team: string\n}\n \nexport async function GET(request: Request, context: { params: Params }) {\n  const team = context.params.team // '1'\n}\n \n// Define params type according to your route parameters (see table below)</pre></div>  <p>Currently, the only value of <code>context</code> is <code>params</code>, which is an object containing the <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route parameters</a> for the current route.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Example</th>\n<th>URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/dashboard/[team]/route.js</code></td>\n<td><code>/dashboard/1</code></td>\n<td><code>{ team: '1' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[tag]/[item]/route.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ tag: '1', item: '2' }</code></td>\n</tr>\n<tr>\n<td><code>app/blog/[...slug]/route.js</code></td>\n<td><code>/blog/1/2</code></td>\n<td><code>{ slug: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"nextresponse\" data-docs-heading=\"\">NextResponse     </h2> <p>Route Handlers can extend the Web Response API by returning a <code>NextResponse</code> object. This allows you to easily set cookies, headers, redirect, and rewrite. <a href=\"../functions/next-response\">View the API reference</a>.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.2.0</code></td>\n<td>Route handlers are introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/route\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/route</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/error":"<h1 class=\"break-words\">error.js</h1>\n<p>An <strong>error</strong> file defines an error UI boundary for a route segment.</p> <p>It is useful for catching <strong>unexpected</strong> errors that occur in Server Components and Client Components and displaying a fallback UI.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client' // Error components must be Client Components\n \nimport { useEffect } from 'react'\n \nexport default function Error({\n  error,\n  reset,\n}: {\n  error: Error &amp; { digest?: string }\n  reset: () =&gt; void\n}) {\n  useEffect(() =&gt; {\n    // Log the error to an error reporting service\n    console.error(error)\n  }, [error])\n \n  return (\n    &lt;div&gt;\n      &lt;h2&gt;Something went wrong!&lt;/h2&gt;\n      &lt;button\n        onClick={\n          // Attempt to recover by trying to re-render the segment\n          () =&gt; reset()\n        }\n      &gt;\n        Try again\n      &lt;/button&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <h3 id=\"error\" data-docs-heading=\"\">error     </h3> <p>An instance of an <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Error</code></a> object forwarded to the <code>error.js</code> Client Component.</p> <h4 id=\"errormessage\" data-docs-heading=\"\">error.message     </h4> <p>The error message.</p> <ul> <li>For errors forwarded from Client Components, this will be the original Error's message.</li> <li>For errors forwarded from Server Components, this will be a generic error message to avoid leaking sensitive details. <code>errors.digest</code> can be used to match the corresponding error in server-side logs.</li> </ul> <h4 id=\"errordigest\" data-docs-heading=\"\">error.digest     </h4> <p>An automatically generated hash of the error thrown in a Server Component. It can be used to match the corresponding error in server-side logs.</p> <h3 id=\"reset\" data-docs-heading=\"\">reset     </h3> <p>A function to reset the error boundary. When executed, the function will try to re-render the Error boundary's contents. If successful, the fallback error component is replaced with the result of the re-render.</p> <p>Can be used to prompt the user to attempt to recover from the error.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>error.js</code> boundaries must be <strong><a href=\"../../building-your-application/rendering/client-components\">Client Components</a></strong>.</li> <li>In Production builds, errors forwarded from Server Components will be stripped of specific error details to avoid leaking sensitive information.</li> <li>An <code>error.js</code> boundary will <strong>not</strong> handle errors thrown in a <code>layout.js</code> component in the <strong>same</strong> segment because the error boundary is nested <strong>inside</strong> that layouts component. <ul> <li>To handle errors for a specific layout, place an <code>error.js</code> file in the layouts parent segment.</li> <li>To handle errors within the root layout or template, use a variation of <code>error.js</code> called <code>app/global-error.js</code>.</li> </ul> </li> </ul> </blockquote> <h2 id=\"global-errorjs\" data-docs-heading=\"\">global-error.js     </h2> <p>To specifically handle errors in root <code>layout.js</code>, use a variation of <code>error.js</code> called <code>app/global-error.js</code> located in the root <code>app</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nexport default function GlobalError({\n  error,\n  reset,\n}: {\n  error: Error &amp; { digest?: string }\n  reset: () =&gt; void\n}) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;h2&gt;Something went wrong!&lt;/h2&gt;\n        &lt;button onClick={() =&gt; reset()}&gt;Try again&lt;/button&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>global-error.js</code> replaces the root <code>layout.js</code> when active and so <strong>must</strong> define its own <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags.</li> <li>While designing error UI, you may find it helpful to use the <a href=\"https://react.dev/learn/react-developer-tools\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Developer Tools</a> to manually toggle Error boundaries.</li> </ul> </blockquote> <h2 id=\"not-foundjs\" data-docs-heading=\"\">not-found.js     </h2> <p>The <a href=\"not-found\" rel=\"noopener noreferrer\" target=\"_blank\"><code>not-found</code></a> file is used to render UI when the <code>notFound()</code> function is thrown within a route segment.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.1.0</code></td>\n<td>\n<code>global-error</code> introduced.</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>error</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/error\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/error</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/instrumentation":"<h1 class=\"break-words\">instrumentation.js</h1>\n<p>The <code>instrumentation.js|ts</code> file is used to integrate monitoring and logging tools into your application. This allows you to track the performance and behavior of your application, and to debug issues in production.</p> <p>To use it, place the file in the <strong>root</strong> of your application or inside a <a href=\"../../building-your-application/configuring/src-directory\"><code>src</code> folder</a> if using one.</p> <h2 id=\"config-option\" data-docs-heading=\"\">Config Option     </h2> <p>Instrumentation is currently an experimental feature, to use the <code>instrumentation</code> file, you must explicitly opt-in by defining <a href=\"../next-config-js/instrumentationhook\"><code>experimental.instrumentationHook = true;</code></a> in your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    instrumentationHook: true,\n  },\n}</pre></div> <h2 id=\"exports\" data-docs-heading=\"\">Exports     </h2> <h3 id=\"register-required\" data-docs-heading=\"\">register (required)     </h3> <p>The file exports a <code>register</code> function that is called <strong>once</strong> when a new Next.js server instance is initiated. <code>register</code> can be an async function.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { registerOTel } from '@vercel/otel'\n \nexport function register() {\n  registerOTel('next-app')\n}</pre></div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v14.0.4</code></td>\n<td>Turbopack support for <code>instrumentation</code>\n</td>\n</tr>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>\n<code>instrumentation</code> introduced as an experimental feature</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/instrumentation\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/instrumentation</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/route-segment-config":"<h1 class=\"break-words\">Route Segment Config</h1>\n<p>The Route Segment options allows you to configure the behavior of a <a href=\"../../building-your-application/routing/pages-and-layouts\">Page</a>, <a href=\"../../building-your-application/routing/pages-and-layouts\">Layout</a>, or <a href=\"../../building-your-application/routing/route-handlers\">Route Handler</a> by directly exporting the following variables:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Option</th>\n<th>Type</th>\n<th>Default</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#dynamic\"><code>dynamic</code></a></td>\n<td><code>'auto' | 'force-dynamic' | 'error' | 'force-static'</code></td>\n<td><code>'auto'</code></td>\n</tr>\n<tr>\n<td><a href=\"#dynamicparams\"><code>dynamicParams</code></a></td>\n<td><code>boolean</code></td>\n<td><code>true</code></td>\n</tr>\n<tr>\n<td><a href=\"#revalidate\"><code>revalidate</code></a></td>\n<td><code>false | 0 | number</code></td>\n<td><code>false</code></td>\n</tr>\n<tr>\n<td><a href=\"#fetchcache\"><code>fetchCache</code></a></td>\n<td><code>'auto' | 'default-cache' | 'only-cache' | 'force-cache' | 'force-no-store' | 'default-no-store' | 'only-no-store'</code></td>\n<td><code>'auto'</code></td>\n</tr>\n<tr>\n<td><a href=\"#runtime\"><code>runtime</code></a></td>\n<td><code>'nodejs' | 'edge'</code></td>\n<td><code>'nodejs'</code></td>\n</tr>\n<tr>\n<td><a href=\"#preferredregion\"><code>preferredRegion</code></a></td>\n<td><code>'auto' | 'global' | 'home' | string | string[]</code></td>\n<td><code>'auto'</code></td>\n</tr>\n<tr>\n<td><a href=\"#maxduration\"><code>maxDuration</code></a></td>\n<td><code>number</code></td>\n<td>Set by deployment platform</td>\n</tr>\n</tbody>\n</table></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const dynamic = 'auto'\nexport const dynamicParams = true\nexport const revalidate = false\nexport const fetchCache = 'auto'\nexport const runtime = 'nodejs'\nexport const preferredRegion = 'auto'\nexport const maxDuration = 5\n \nexport default function MyComponent() {}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>The values of the config options currently need be statically analyzable. For example <code>revalidate = 600</code> is valid, but <code>revalidate = 60 * 10</code> is not.</li> </ul> </blockquote> <h2 id=\"options\" data-docs-heading=\"\">Options     </h2> <h3 id=\"dynamic\" data-docs-heading=\"\">dynamic     </h3> <p>Change the dynamic behavior of a layout or page to fully static or fully dynamic.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const dynamic = 'auto'\n// 'auto' | 'force-dynamic' | 'error' | 'force-static'</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The new model in the <code>app</code> directory favors granular caching control at the <code>fetch</code> request level over the binary all-or-nothing model of <code>getServerSideProps</code> and <code>getStaticProps</code> at the page-level in the <code>pages</code> directory. The <code>dynamic</code> option is a way to opt back in to the previous model as a convenience and provides a simpler migration path.</p> </blockquote> <ul> <li> <p><strong><code>'auto'</code></strong> (default): The default option to cache as much as possible without preventing any components from opting into dynamic behavior.</p> </li> <li> <p><strong><code>'force-dynamic'</code></strong>: Force <a href=\"../../building-your-application/rendering/server-components#dynamic-rendering\">dynamic rendering</a>, which will result in routes being rendered for each user at request time. This option is equivalent to <code>getServerSideProps()</code> in the <code>pages</code> directory.</p> </li> <li> <p><strong><code>'error'</code></strong>: Force static rendering and cache the data of a layout or page by causing an error if any components use <a href=\"../../building-your-application/rendering/server-components#dynamic-functions\">dynamic functions</a> or uncached data. This option is equivalent to:</p> <ul> <li>\n<code>getStaticProps()</code> in the <code>pages</code> directory.</li> <li>Setting the option of every <code>fetch()</code> request in a layout or page to <code>{ cache: 'force-cache' }</code>.</li> <li>Setting the segment config to <code>fetchCache = 'only-cache', dynamicParams = false</code>.</li> <li>\n<code>dynamic = 'error'</code> changes the default of <code>dynamicParams</code> from <code>true</code> to <code>false</code>. You can opt back into dynamically rendering pages for dynamic params not generated by <code>generateStaticParams</code> by manually setting <code>dynamicParams = true</code>.</li> </ul> </li> <li> <p><strong><code>'force-static'</code></strong>: Force static rendering and cache the data of a layout or page by forcing <a href=\"../functions/cookies\"><code>cookies()</code></a>, <a href=\"../functions/headers\"><code>headers()</code></a> and <a href=\"../functions/use-search-params\"><code>useSearchParams()</code></a> to return empty values.</p> </li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Instructions on <a href=\"../../building-your-application/upgrading/app-router-migration#step-6-migrating-data-fetching-methods\">how to migrate</a> from <code>getServerSideProps</code> and <code>getStaticProps</code> to <code>dynamic: 'force-dynamic'</code> and <code>dynamic: 'error'</code> can be found in the <a href=\"../../building-your-application/upgrading/app-router-migration#step-6-migrating-data-fetching-methods\">upgrade guide</a>.</li> </ul> </blockquote> <h3 id=\"dynamicparams\" data-docs-heading=\"\">dynamicParams     </h3> <p>Control what happens when a dynamic segment is visited that was not generated with <a href=\"../functions/generate-static-params\">generateStaticParams</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const dynamicParams = true // true | false,</pre></div>  <ul> <li>\n<strong><code>true</code></strong> (default): Dynamic segments not included in <code>generateStaticParams</code> are generated on demand.</li> <li>\n<strong><code>false</code></strong>: Dynamic segments not included in <code>generateStaticParams</code> will return a 404.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>This option replaces the <code>fallback: true | false | blocking</code> option of <code>getStaticPaths</code> in the <code>pages</code> directory.</li> <li>When <code>dynamicParams = true</code>, the segment uses <a href=\"../../building-your-application/routing/loading-ui-and-streaming#streaming-with-suspense\">Streaming Server Rendering</a>.</li> <li>If the <code>dynamic = 'error'</code> and <code>dynamic = 'force-static'</code> are used, it'll change the default of <code>dynamicParams</code> to <code>false</code>.</li> </ul> </blockquote> <h3 id=\"revalidate\" data-docs-heading=\"\">revalidate     </h3> <p>Set the default revalidation time for a layout or page. This option does not override the <code>revalidate</code> value set by individual <code>fetch</code> requests.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const revalidate = false\n// false | 0 | number</pre></div>  <ul> <li>\n<strong><code>false</code></strong> (default): The default heuristic to cache any <code>fetch</code> requests that set their <code>cache</code> option to <code>'force-cache'</code> or are discovered before a <a href=\"#\">dynamic function</a> is used. Semantically equivalent to <code>revalidate: Infinity</code> which effectively means the resource should be cached indefinitely. It is still possible for individual <code>fetch</code> requests to use <code>cache: 'no-store'</code> or <code>revalidate: 0</code> to avoid being cached and make the route dynamically rendered. Or set <code>revalidate</code> to a positive number lower than the route default to increase the revalidation frequency of a route.</li> <li>\n<strong><code>0</code></strong>: Ensure a layout or page is always <a href=\"../../building-your-application/rendering/server-components#dynamic-rendering\">dynamically rendered</a> even if no dynamic functions or uncached data fetches are discovered. This option changes the default of <code>fetch</code> requests that do not set a <code>cache</code> option to <code>'no-store'</code> but leaves <code>fetch</code> requests that opt into <code>'force-cache'</code> or use a positive <code>revalidate</code> as is.</li> <li>\n<strong><code>number</code></strong>: (in seconds) Set the default revalidation frequency of a layout or page to <code>n</code> seconds.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The <code>revalidate</code> option is only available when using the <a href=\"../../building-your-application/rendering/edge-and-nodejs-runtimes#nodejs-runtime\">Node.js Runtime</a>. This means using the <code>revalidate</code> option with <code>runtime = 'edge'</code> will not work.</p> </blockquote> <h4 id=\"revalidation-frequency\" data-docs-heading=\"\">Revalidation Frequency     </h4> <ul> <li>The lowest <code>revalidate</code> across each layout and page of a single route will determine the revalidation frequency of the <em>entire</em> route. This ensures that child pages are revalidated as frequently as their parent layouts.</li> <li>Individual <code>fetch</code> requests can set a lower <code>revalidate</code> than the route's default <code>revalidate</code> to increase the revalidation frequency of the entire route. This allows you to dynamically opt-in to more frequent revalidation for certain routes based on some criteria.</li> </ul> <h3 id=\"fetchcache\" data-docs-heading=\"\">fetchCache     </h3> <details><summary>This is an advanced option that should only be used if you specifically need to override the default behavior.</summary><p>By default, Next.js <strong>will cache</strong> any <code>fetch()</code> requests that are reachable <strong>before</strong> any <a href=\"#\">dynamic functions</a> are used and <strong>will not cache</strong> <code>fetch</code> requests that are discovered <strong>after</strong> dynamic functions are used.</p>\n<p><code>fetchCache</code> allows you to override the default <code>cache</code> option of all <code>fetch</code> requests in a layout or page.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const fetchCache = 'auto'\n// 'auto' | 'default-cache' | 'only-cache'\n// 'force-cache' | 'force-no-store' | 'default-no-store' | 'only-no-store'</pre></div>\n<ul> <li>\n<strong><code>'auto'</code></strong> (default): The default option to cache <code>fetch</code> requests before dynamic functions with the <code>cache</code> option they provide and not cache <code>fetch</code> requests after dynamic functions.</li> <li>\n<strong><code>'default-cache'</code></strong>: Allow any <code>cache</code> option to be passed to <code>fetch</code> but if no option is provided then set the <code>cache</code> option to <code>'force-cache'</code>. This means that even <code>fetch</code> requests after dynamic functions are considered static.</li> <li>\n<strong><code>'only-cache'</code></strong>: Ensure all <code>fetch</code> requests opt into caching by changing the default to <code>cache: 'force-cache'</code> if no option is provided and causing an error if any <code>fetch</code> requests use <code>cache: 'no-store'</code>.</li> <li>\n<strong><code>'force-cache'</code></strong>: Ensure all <code>fetch</code> requests opt into caching by setting the <code>cache</code> option of all <code>fetch</code> requests to <code>'force-cache'</code>.</li> <li>\n<strong><code>'default-no-store'</code></strong>: Allow any <code>cache</code> option to be passed to <code>fetch</code> but if no option is provided then set the <code>cache</code> option to <code>'no-store'</code>. This means that even <code>fetch</code> requests before dynamic functions are considered dynamic.</li> <li>\n<strong><code>'only-no-store'</code></strong>: Ensure all <code>fetch</code> requests opt out of caching by changing the default to <code>cache: 'no-store'</code> if no option is provided and causing an error if any <code>fetch</code> requests use <code>cache: 'force-cache'</code>\n</li> <li>\n<strong><code>'force-no-store'</code></strong>: Ensure all <code>fetch</code> requests opt out of caching by setting the <code>cache</code> option of all <code>fetch</code> requests to <code>'no-store'</code>. This forces all <code>fetch</code> requests to be re-fetched every request even if they provide a <code>'force-cache'</code> option.</li> </ul>\n<h4 id=\"cross-route-segment-behavior\" data-docs-heading=\"\">Cross-route segment behavior     </h4>\n<ul> <li>Any options set across each layout and page of a single route need to be compatible with each other. <ul> <li>If both the <code>'only-cache'</code> and <code>'force-cache'</code> are provided, then <code>'force-cache'</code> wins. If both <code>'only-no-store'</code> and <code>'force-no-store'</code> are provided, then <code>'force-no-store'</code> wins. The force option changes the behavior across the route so a single segment with <code>'force-*'</code> would prevent any errors caused by <code>'only-*'</code>.</li> <li>The intention of the <code>'only-*'</code> and <code>force-*'</code> options is to guarantee the whole route is either fully static or fully dynamic. This means: <ul> <li>A combination of <code>'only-cache'</code> and <code>'only-no-store'</code> in a single route is not allowed.</li> <li>A combination of <code>'force-cache'</code> and <code>'force-no-store'</code> in a single route is not allowed.</li> </ul> </li> <li>A parent cannot provide <code>'default-no-store'</code> if a child provides <code>'auto'</code> or <code>'*-cache'</code> since that could make the same fetch have different behavior.</li> </ul> </li> <li>It is generally recommended to leave shared parent layouts as <code>'auto'</code> and customize the options where child segments diverge.</li> </ul></details> <h3 id=\"runtime\" data-docs-heading=\"\">runtime     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const runtime = 'nodejs'\n// 'nodejs' | 'edge'</pre></div>  <ul> <li>\n<strong><code>'nodejs'</code></strong> (default)</li> <li><strong><code>'edge'</code></strong></li> </ul> <p>Learn more about the <a href=\"../../building-your-application/rendering/edge-and-nodejs-runtimes\">Edge and Node.js runtimes</a>.</p> <h3 id=\"preferredregion\" data-docs-heading=\"\">preferredRegion     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const preferredRegion = 'auto'\n// 'auto' | 'global' | 'home' | ['iad1', 'sfo1']</pre></div>  <p>Support for <code>preferredRegion</code>, and regions supported, is dependent on your deployment platform.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If a <code>preferredRegion</code> is not specified, it will inherit the option of the nearest parent layout.</li> <li>The root layout defaults to <code>all</code> regions.</li> </ul> </blockquote> <h3 id=\"maxduration\" data-docs-heading=\"\">maxDuration     </h3> <p>By default, Next.js does not limit the execution of server-side logic (rendering a page or handling an API). Deployment platforms can use <code>maxDuration</code> from the Next.js build output to add specific execution limits. For example, on <a href=\"https://vercel.com/docs/functions/serverless-functions/runtimes#max-duration\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>.</p> <p><strong>Note</strong>: This settings requires Next.js <code>13.4.10</code> or higher.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const maxDuration = 5</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If using <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Actions</a>, set the <code>maxDuration</code> at the page level to change the default timeout of all Server Actions used on the page.</li> </ul> </blockquote> <h3 id=\"generatestaticparams\" data-docs-heading=\"\">generateStaticParams     </h3> <p>The <code>generateStaticParams</code> function can be used in combination with <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route segments</a> to define the list of route segment parameters that will be statically generated at build time instead of on-demand at request time.</p> <p>See the <a href=\"../functions/generate-static-params\">API reference</a> for more details.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/template":"<h1 class=\"break-words\">template.js</h1>\n<p>A <strong>template</strong> file is similar to a <a href=\"../../building-your-application/routing/pages-and-layouts#layouts\">layout</a> in that it wraps each child layout or page. Unlike layouts that persist across routes and maintain state, templates create a new instance for each of their children on navigation.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Template({ children }: { children: React.ReactNode }) {\n  return &lt;div&gt;{children}&lt;/div&gt;\n}</pre></div>  <figure><img alt=\"template.js special file\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ftemplate-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ftemplate-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ftemplate-special-file.png&amp;w=3840&amp;q=75\"><img alt=\"template.js special file\" loading=\"lazy\" width=\"1600\" height=\"444\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ftemplate-special-file.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ftemplate-special-file.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ftemplate-special-file.png&amp;w=3840&amp;q=75\"></figure> <p>While less common, you might choose a template over a layout if you want:</p> <ul> <li>Features that rely on <code>useEffect</code> (e.g logging page views) and <code>useState</code> (e.g a per-page feedback form).</li> <li>To change the default framework behavior. For example, Suspense Boundaries inside layouts only show the fallback the first time the Layout is loaded and not when switching pages. For templates, the fallback is shown on each navigation.</li> </ul> <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <h3 id=\"children-required\" data-docs-heading=\"\">children (required)     </h3> <p>Template components should accept and use a <code>children</code> prop. <code>template</code> is rendered between a <a href=\"layout\">layout</a> and its children. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Layout&gt;\n  {/* Note that the template is given a unique key. */}\n  &lt;Template key={routeParam}&gt;{children}&lt;/Template&gt;\n&lt;/Layout&gt;</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>By default, <code>template</code> is a <a href=\"../../building-your-application/rendering/server-components\">Server Component</a>, but can also be used as a <a href=\"../../building-your-application/rendering/client-components\">Client Component</a> through the <code>\"use client\"</code> directive.</li> <li>When a user navigates between routes that share a <code>template</code>, a new instance of the component is mounted, DOM elements are recreated, state is <strong>not</strong> preserved, and effects are re-synchronized.</li> </ul> </blockquote> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>template</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/template\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/template</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/metadata":"<h1 class=\"break-words\">Metadata Files API Reference</h1>\n<p>This section of the docs covers <strong>Metadata file conventions</strong>. File-based metadata can be defined by adding special metadata files to route segments.</p> <p>Each file convention can be defined using a static file (e.g. <code>opengraph-image.jpg</code>), or a dynamic variant that uses code to generate the file (e.g. <code>opengraph-image.js</code>).</p> <p>Once a file is defined, Next.js will automatically serve the file (with hashes in production for caching) and update the relevant head elements with the correct metadata, such as the asset's URL, file type, and image size.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/metadata</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/metadata/app-icons":"<h1 class=\"break-words\">favicon, icon, and apple-icon</h1>\n<p>The <code>favicon</code>, <code>icon</code>, or <code>apple-icon</code> file conventions allow you to set icons for your application.</p> <p>They are useful for adding app icons that appear in places like web browser tabs, phone home screens, and search engine results.</p> <p>There are two ways to set app icons:</p> <ul> <li><a href=\"#image-files-ico-jpg-png\">Using image files (.ico, .jpg, .png)</a></li> <li><a href=\"#generate-icons-using-code-js-ts-tsx\">Using code to generate an icon (.js, .ts, .tsx)</a></li> </ul> <h2 id=\"image-files-ico-jpg-png\" data-docs-heading=\"\">Image files (.ico, .jpg, .png)     </h2> <p>Use an image file to set an app icon by placing a <code>favicon</code>, <code>icon</code>, or <code>apple-icon</code> image file within your <code>/app</code> directory. The <code>favicon</code> image can only be located in the top level of <code>app/</code>.</p> <p>Next.js will evaluate the file and automatically add the appropriate tags to your app's <code>&lt;head&gt;</code> element.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>File convention</th>\n<th>Supported file types</th>\n<th>Valid locations</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#favicon\"><code>favicon</code></a></td>\n<td><code>.ico</code></td>\n<td><code>app/</code></td>\n</tr>\n<tr>\n<td><a href=\"#icon\"><code>icon</code></a></td>\n<td>\n<code>.ico</code>, <code>.jpg</code>, <code>.jpeg</code>, <code>.png</code>, <code>.svg</code>\n</td>\n<td><code>app/**/*</code></td>\n</tr>\n<tr>\n<td><a href=\"#apple-icon\"><code>apple-icon</code></a></td>\n<td>\n<code>.jpg</code>, <code>.jpeg</code>, <code>.png</code>\n</td>\n<td><code>app/**/*</code></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"favicon\" data-docs-heading=\"\">favicon     </h3> <p>Add a <code>favicon.ico</code> image file to the root <code>/app</code> route segment.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"icon\" href=\"/favicon.ico\" sizes=\"any\" /&gt;</pre></div> <h3 id=\"icon\" data-docs-heading=\"\">icon     </h3> <p>Add an <code>icon.(ico|jpg|jpeg|png|svg)</code> image file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link\n  rel=\"icon\"\n  href=\"/icon?&lt;generated&gt;\"\n  type=\"image/&lt;generated&gt;\"\n  sizes=\"&lt;generated&gt;\"\n/&gt;</pre></div> <h3 id=\"apple-icon\" data-docs-heading=\"\">apple-icon     </h3> <p>Add an <code>apple-icon.(jpg|jpeg|png)</code> image file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link\n  rel=\"apple-touch-icon\"\n  href=\"/apple-icon?&lt;generated&gt;\"\n  type=\"image/&lt;generated&gt;\"\n  sizes=\"&lt;generated&gt;\"\n/&gt;</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>You can set multiple icons by adding a number suffix to the file name. For example, <code>icon1.png</code>, <code>icon2.png</code>, etc. Numbered files will sort lexically.</li> <li>Favicons can only be set in the root <code>/app</code> segment. If you need more granularity, you can use <a href=\"#icon\"><code>icon</code></a>.</li> <li>The appropriate <code>&lt;link&gt;</code> tags and attributes such as <code>rel</code>, <code>href</code>, <code>type</code>, and <code>sizes</code> are determined by the icon type and metadata of the evaluated file. <ul> <li>For example, a 32 by 32px <code>.png</code> file will have <code>type=\"image/png\"</code> and <code>sizes=\"32x32\"</code> attributes.</li> </ul> </li> <li>\n<code>sizes=\"any\"</code> is added to <code>favicon.ico</code> output to <a href=\"https://evilmartians.com/chronicles/how-to-favicon-in-2021-six-files-that-fit-most-needs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">avoid a browser bug</a> where an <code>.ico</code> icon is favored over <code>.svg</code>.</li> </ul> </blockquote> <h2 id=\"generate-icons-using-code-js-ts-tsx\" data-docs-heading=\"\">Generate icons using code (.js, .ts, .tsx)     </h2> <p>In addition to using <a href=\"#image-files-ico-jpg-png\">literal image files</a>, you can programmatically <strong>generate</strong> icons using code.</p> <p>Generate an app icon by creating an <code>icon</code> or <code>apple-icon</code> route that default exports a function.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>File convention</th>\n<th>Supported file types</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>icon</code></td>\n<td>\n<code>.js</code>, <code>.ts</code>, <code>.tsx</code>\n</td>\n</tr>\n<tr>\n<td><code>apple-icon</code></td>\n<td>\n<code>.js</code>, <code>.ts</code>, <code>.tsx</code>\n</td>\n</tr>\n</tbody>\n</table></div> <p>The easiest way to generate an icon is to use the <a href=\"../../functions/image-response\"><code>ImageResponse</code></a> API from <code>next/og</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'\n \n// Route segment config\nexport const runtime = 'edge'\n \n// Image metadata\nexport const size = {\n  width: 32,\n  height: 32,\n}\nexport const contentType = 'image/png'\n \n// Image generation\nexport default function Icon() {\n  return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      &lt;div\n        style={{\n          fontSize: 24,\n          background: 'black',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          color: 'white',\n        }}\n      &gt;\n        A\n      &lt;/div&gt;\n    ),\n    // ImageResponse options\n    {\n      // For convenience, we can re-use the exported icons size metadata\n      // config to also set the ImageResponse's width and height.\n      ...size,\n    }\n  )\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"icon\" href=\"/icon?&lt;generated&gt;\" type=\"image/png\" sizes=\"32x32\" /&gt;</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>By default, generated icons are <a href=\"../../../building-your-application/rendering/server-components#static-rendering-default\"><strong>statically optimized</strong></a> (generated at build time and cached) unless they use <a href=\"#\">dynamic functions</a> or uncached data.</li> <li>You can generate multiple icons in the same file using <a href=\"../../functions/generate-image-metadata\"><code>generateImageMetadata</code></a>.</li> <li>You cannot generate a <code>favicon</code> icon. Use <a href=\"#icon\"><code>icon</code></a> or a <a href=\"#favicon\">favicon.ico</a> file instead.</li> </ul> </blockquote> <h3 id=\"props\" data-docs-heading=\"\">Props     </h3> <p>The default export function receives the following props:</p> <h4 id=\"params-optional\" data-docs-heading=\"\">params (optional)     </h4> <p>An object containing the <a href=\"../../../building-your-application/routing/dynamic-routes\">dynamic route parameters</a> object from the root segment down to the segment <code>icon</code> or <code>apple-icon</code> is colocated in.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Icon({ params }: { params: { slug: string } }) {\n  // ...\n}</pre></div>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/shop/icon.js</code></td>\n<td><code>/shop</code></td>\n<td><code>undefined</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[slug]/icon.js</code></td>\n<td><code>/shop/1</code></td>\n<td><code>{ slug: '1' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[tag]/[item]/icon.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ tag: '1', item: '2' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/icon.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ slug: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"returns\" data-docs-heading=\"\">Returns     </h3> <p>The default export function should return a <code>Blob</code> | <code>ArrayBuffer</code> | <code>TypedArray</code> | <code>DataView</code> | <code>ReadableStream</code> | <code>Response</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>ImageResponse</code> satisfies this return type.</p> </blockquote> <h3 id=\"config-exports\" data-docs-heading=\"\">Config exports     </h3> <p>You can optionally configure the icon's metadata by exporting <code>size</code> and <code>contentType</code> variables from the <code>icon</code> or <code>apple-icon</code> route.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Option</th>\n<th>Type</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#size\"><code>size</code></a></td>\n<td><code>{ width: number; height: number }</code></td>\n</tr>\n<tr>\n<td><a href=\"#contenttype\"><code>contentType</code></a></td>\n<td>\n<code>string</code> - <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/MIME_types#image_types\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">image MIME type</a>\n</td>\n</tr>\n</tbody>\n</table></div> <h4 id=\"size\" data-docs-heading=\"\">size     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const size = { width: 32, height: 32 }\n \nexport default function Icon() {}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"icon\" sizes=\"32x32\" /&gt;</pre></div> <h4 id=\"contenttype\" data-docs-heading=\"\">contentType     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const contentType = 'image/png'\n \nexport default function Icon() {}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"icon\" type=\"image/png\" /&gt;</pre></div> <h4 id=\"route-segment-config\" data-docs-heading=\"\">Route Segment Config     </h4> <p><code>icon</code> and <code>apple-icon</code> are specialized <a href=\"../../../building-your-application/routing/route-handlers\">Route Handlers</a> that can use the same <a href=\"../route-segment-config\">route segment configuration</a> options as Pages and Layouts.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Option</th>\n<th>Type</th>\n<th>Default</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../route-segment-config#dynamic\"><code>dynamic</code></a></td>\n<td><code>'auto' | 'force-dynamic' | 'error' | 'force-static'</code></td>\n<td><code>'auto'</code></td>\n</tr>\n<tr>\n<td><a href=\"../route-segment-config#revalidate\"><code>revalidate</code></a></td>\n<td><code>false | 'force-cache' | 0 | number</code></td>\n<td><code>false</code></td>\n</tr>\n<tr>\n<td><a href=\"../route-segment-config#runtime\"><code>runtime</code></a></td>\n<td><code>'nodejs' | 'edge'</code></td>\n<td><code>'nodejs'</code></td>\n</tr>\n<tr>\n<td><a href=\"../route-segment-config#preferredregion\"><code>preferredRegion</code></a></td>\n<td><code>'auto' | 'global' | 'home' | string | string[]</code></td>\n<td><code>'auto'</code></td>\n</tr>\n</tbody>\n</table></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const runtime = 'edge'\n \nexport default function Icon() {}</pre></div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>favicon</code> <code>icon</code> and <code>apple-icon</code> introduced</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/metadata/manifest":"<h1 class=\"break-words\">manifest.json</h1>\n<p>Add or generate a <code>manifest.(json|webmanifest)</code> file that matches the <a href=\"https://developer.mozilla.org/docs/Web/Manifest\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Manifest Specification</a> in the <strong>root</strong> of <code>app</code> directory to provide information about your web application for the browser.</p> <h2 id=\"static-manifest-file\" data-docs-heading=\"\">Static Manifest file     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"name\": \"My Next.js Application\",\n  \"short_name\": \"Next.js App\",\n  \"description\": \"An application built with Next.js\",\n  \"start_url\": \"/\"\n  // ...\n}</pre></div> <h2 id=\"generate-a-manifest-file\" data-docs-heading=\"\">Generate a Manifest file     </h2> <p>Add a <code>manifest.js</code> or <code>manifest.ts</code> file that returns a <a href=\"#manifest-object\"><code>Manifest</code> object</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { MetadataRoute } from 'next'\n \nexport default function manifest(): MetadataRoute.Manifest {\n  return {\n    name: 'Next.js App',\n    short_name: 'Next.js App',\n    description: 'Next.js App',\n    start_url: '/',\n    display: 'standalone',\n    background_color: '#fff',\n    theme_color: '#fff',\n    icons: [\n      {\n        src: '/favicon.ico',\n        sizes: 'any',\n        type: 'image/x-icon',\n      },\n    ],\n  }\n}</pre></div>  <h3 id=\"manifest-object\" data-docs-heading=\"\">Manifest Object     </h3> <p>The manifest object contains an extensive list of options that may be updated due to new web standards. For information on all the current options, refer to the <code>MetadataRoute.Manifest</code> type in your code editor if using <a href=\"../../../building-your-application/configuring/typescript#typescript-plugin\" rel=\"noopener noreferrer\" target=\"_blank\">TypeScript</a> or see the <a href=\"https://developer.mozilla.org/docs/Web/Manifest\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDN</a> docs.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/manifest\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/metadata/manifest</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/metadata/opengraph-image":"<h1 class=\"break-words\">opengraph-image and twitter-image</h1>\n<p>The <code>opengraph-image</code> and <code>twitter-image</code> file conventions allow you to set Open Graph and Twitter images for a route segment.</p> <p>They are useful for setting the images that appear on social networks and messaging apps when a user shares a link to your site.</p> <p>There are two ways to set Open Graph and Twitter images:</p> <ul> <li><a href=\"#image-files-jpg-png-gif\">Using image files (.jpg, .png, .gif)</a></li> <li><a href=\"#generate-images-using-code-js-ts-tsx\">Using code to generate images (.js, .ts, .tsx)</a></li> </ul> <h2 id=\"image-files-jpg-png-gif\" data-docs-heading=\"\">Image files (.jpg, .png, .gif)     </h2> <p>Use an image file to set a route segment's shared image by placing an <code>opengraph-image</code> or <code>twitter-image</code> image file in the segment.</p> <p>Next.js will evaluate the file and automatically add the appropriate tags to your app's <code>&lt;head&gt;</code> element.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>File convention</th>\n<th>Supported file types</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#opengraph-image\"><code>opengraph-image</code></a></td>\n<td>\n<code>.jpg</code>, <code>.jpeg</code>, <code>.png</code>, <code>.gif</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"#twitter-image\"><code>twitter-image</code></a></td>\n<td>\n<code>.jpg</code>, <code>.jpeg</code>, <code>.png</code>, <code>.gif</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"#opengraph-imagealttxt\"><code>opengraph-image.alt</code></a></td>\n<td><code>.txt</code></td>\n</tr>\n<tr>\n<td><a href=\"#twitter-imagealttxt\"><code>twitter-image.alt</code></a></td>\n<td><code>.txt</code></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"opengraph-image\" data-docs-heading=\"\">opengraph-image     </h3> <p>Add an <code>opengraph-image.(jpg|jpeg|png|gif)</code> image file to any route segment.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"og:image\" content=\"&lt;generated&gt;\" /&gt;\n&lt;meta property=\"og:image:type\" content=\"&lt;generated&gt;\" /&gt;\n&lt;meta property=\"og:image:width\" content=\"&lt;generated&gt;\" /&gt;\n&lt;meta property=\"og:image:height\" content=\"&lt;generated&gt;\" /&gt;</pre></div> <h3 id=\"twitter-image\" data-docs-heading=\"\">twitter-image     </h3> <p>Add a <code>twitter-image.(jpg|jpeg|png|gif)</code> image file to any route segment.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"twitter:image\" content=\"&lt;generated&gt;\" /&gt;\n&lt;meta name=\"twitter:image:type\" content=\"&lt;generated&gt;\" /&gt;\n&lt;meta name=\"twitter:image:width\" content=\"&lt;generated&gt;\" /&gt;\n&lt;meta name=\"twitter:image:height\" content=\"&lt;generated&gt;\" /&gt;</pre></div> <h3 id=\"opengraph-imagealttxt\" data-docs-heading=\"\">opengraph-image.alt.txt     </h3> <p>Add an accompanying <code>opengraph-image.alt.txt</code> file in the same route segment as the <code>opengraph-image.(jpg|jpeg|png|gif)</code> image it's alt text.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">About Acme</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"og:image:alt\" content=\"About Acme\" /&gt;</pre></div> <h3 id=\"twitter-imagealttxt\" data-docs-heading=\"\">twitter-image.alt.txt     </h3> <p>Add an accompanying <code>twitter-image.alt.txt</code> file in the same route segment as the <code>twitter-image.(jpg|jpeg|png|gif)</code> image it's alt text.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">About Acme</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"twitter:image:alt\" content=\"About Acme\" /&gt;</pre></div> <h2 id=\"generate-images-using-code-js-ts-tsx\" data-docs-heading=\"\">Generate images using code (.js, .ts, .tsx)     </h2> <p>In addition to using <a href=\"#image-files-jpg-png-gif\">literal image files</a>, you can programmatically <strong>generate</strong> images using code.</p> <p>Generate a route segment's shared image by creating an <code>opengraph-image</code> or <code>twitter-image</code> route that default exports a function.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>File convention</th>\n<th>Supported file types</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>opengraph-image</code></td>\n<td>\n<code>.js</code>, <code>.ts</code>, <code>.tsx</code>\n</td>\n</tr>\n<tr>\n<td><code>twitter-image</code></td>\n<td>\n<code>.js</code>, <code>.ts</code>, <code>.tsx</code>\n</td>\n</tr>\n</tbody>\n</table></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>By default, generated images are <a href=\"../../../building-your-application/rendering/server-components#static-rendering-default\"><strong>statically optimized</strong></a> (generated at build time and cached) unless they use <a href=\"#\">dynamic functions</a> or uncached data.</li> <li>You can generate multiple Images in the same file using <a href=\"../../functions/generate-image-metadata\"><code>generateImageMetadata</code></a>.</li> </ul> </blockquote> <p>The easiest way to generate an image is to use the <a href=\"../../functions/image-response\">ImageResponse</a> API from <code>next/og</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'\n \n// Route segment config\nexport const runtime = 'edge'\n \n// Image metadata\nexport const alt = 'About Acme'\nexport const size = {\n  width: 1200,\n  height: 630,\n}\n \nexport const contentType = 'image/png'\n \n// Image generation\nexport default async function Image() {\n  // Font\n  const interSemiBold = fetch(\n    new URL('./Inter-SemiBold.ttf', import.meta.url)\n  ).then((res) =&gt; res.arrayBuffer())\n \n  return new ImageResponse(\n    (\n      // ImageResponse JSX element\n      &lt;div\n        style={{\n          fontSize: 128,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      &gt;\n        About Acme\n      &lt;/div&gt;\n    ),\n    // ImageResponse options\n    {\n      // For convenience, we can re-use the exported opengraph-image\n      // size config to also set the ImageResponse's width and height.\n      ...size,\n      fonts: [\n        {\n          name: 'Inter',\n          data: await interSemiBold,\n          style: 'normal',\n          weight: 400,\n        },\n      ],\n    }\n  )\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"og:image\" content=\"&lt;generated&gt;\" /&gt;\n&lt;meta property=\"og:image:alt\" content=\"About Acme\" /&gt;\n&lt;meta property=\"og:image:type\" content=\"image/png\" /&gt;\n&lt;meta property=\"og:image:width\" content=\"1200\" /&gt;\n&lt;meta property=\"og:image:height\" content=\"630\" /&gt;</pre></div> <h3 id=\"props\" data-docs-heading=\"\">Props     </h3> <p>The default export function receives the following props:</p> <h4 id=\"params-optional\" data-docs-heading=\"\">params (optional)     </h4> <p>An object containing the <a href=\"../../../building-your-application/routing/dynamic-routes\">dynamic route parameters</a> object from the root segment down to the segment <code>opengraph-image</code> or <code>twitter-image</code> is colocated in.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Image({ params }: { params: { slug: string } }) {\n  // ...\n}</pre></div>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/shop/opengraph-image.js</code></td>\n<td><code>/shop</code></td>\n<td><code>undefined</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[slug]/opengraph-image.js</code></td>\n<td><code>/shop/1</code></td>\n<td><code>{ slug: '1' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[tag]/[item]/opengraph-image.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ tag: '1', item: '2' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/opengraph-image.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ slug: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"returns\" data-docs-heading=\"\">Returns     </h3> <p>The default export function should return a <code>Blob</code> | <code>ArrayBuffer</code> | <code>TypedArray</code> | <code>DataView</code> | <code>ReadableStream</code> | <code>Response</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>ImageResponse</code> satisfies this return type.</p> </blockquote> <h3 id=\"config-exports\" data-docs-heading=\"\">Config exports     </h3> <p>You can optionally configure the image's metadata by exporting <code>alt</code>, <code>size</code>, and <code>contentType</code> variables from <code>opengraph-image</code> or <code>twitter-image</code> route.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Option</th>\n<th>Type</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#alt\"><code>alt</code></a></td>\n<td><code>string</code></td>\n</tr>\n<tr>\n<td><a href=\"#size\"><code>size</code></a></td>\n<td><code>{ width: number; height: number }</code></td>\n</tr>\n<tr>\n<td><a href=\"#contenttype\"><code>contentType</code></a></td>\n<td>\n<code>string</code> - <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/MIME_types#image_types\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">image MIME type</a>\n</td>\n</tr>\n</tbody>\n</table></div> <h4 id=\"alt\" data-docs-heading=\"\">alt     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const alt = 'My images alt text'\n \nexport default function Image() {}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"og:image:alt\" content=\"My images alt text\" /&gt;</pre></div> <h4 id=\"size\" data-docs-heading=\"\">size     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const size = { width: 1200, height: 630 }\n \nexport default function Image() {}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"og:image:width\" content=\"1200\" /&gt;\n&lt;meta property=\"og:image:height\" content=\"630\" /&gt;</pre></div> <h4 id=\"contenttype\" data-docs-heading=\"\">contentType     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const contentType = 'image/png'\n \nexport default function Image() {}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"og:image:type\" content=\"image/png\" /&gt;</pre></div> <h4 id=\"route-segment-config\" data-docs-heading=\"\">Route Segment Config     </h4> <p><code>opengraph-image</code> and <code>twitter-image</code> are specialized <a href=\"../../../building-your-application/routing/route-handlers\">Route Handlers</a> that can use the same <a href=\"../route-segment-config\">route segment configuration</a> options as Pages and Layouts.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Option</th>\n<th>Type</th>\n<th>Default</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"../route-segment-config#dynamic\"><code>dynamic</code></a></td>\n<td><code>'auto' | 'force-dynamic' | 'error' | 'force-static'</code></td>\n<td><code>'auto'</code></td>\n</tr>\n<tr>\n<td><a href=\"../route-segment-config#revalidate\"><code>revalidate</code></a></td>\n<td><code>false | 'force-cache' | 0 | number</code></td>\n<td><code>false</code></td>\n</tr>\n<tr>\n<td><a href=\"../route-segment-config#runtime\"><code>runtime</code></a></td>\n<td><code>'nodejs' | 'edge'</code></td>\n<td><code>'nodejs'</code></td>\n</tr>\n<tr>\n<td><a href=\"../route-segment-config#preferredregion\"><code>preferredRegion</code></a></td>\n<td><code>'auto' | 'global' | 'home' | string | string[]</code></td>\n<td><code>'auto'</code></td>\n</tr>\n</tbody>\n</table></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const runtime = 'edge'\n \nexport default function Image() {}</pre></div>  <h3 id=\"examples\" data-docs-heading=\"\">Examples     </h3> <h4 id=\"using-external-data\" data-docs-heading=\"\">Using external data     </h4> <p>This example uses the <code>params</code> object and external data to generate the image.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: By default, this generated image will be <a href=\"../../../building-your-application/rendering/server-components#static-rendering-default\">statically optimized</a>. You can configure the individual <code>fetch</code> <a href=\"../../functions/fetch\"><code>options</code></a> or route segments <a href=\"../route-segment-config#revalidate\">options</a> to change this behavior.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'\n \nexport const runtime = 'edge'\n \nexport const alt = 'About Acme'\nexport const size = {\n  width: 1200,\n  height: 630,\n}\nexport const contentType = 'image/png'\n \nexport default async function Image({ params }: { params: { slug: string } }) {\n  const post = await fetch(`https://.../posts/${params.slug}`).then((res) =&gt;\n    res.json()\n  )\n \n  return new ImageResponse(\n    (\n      &lt;div\n        style={{\n          fontSize: 48,\n          background: 'white',\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      &gt;\n        {post.title}\n      &lt;/div&gt;\n    ),\n    {\n      ...size,\n    }\n  )\n}</pre></div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>opengraph-image</code> and <code>twitter-image</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/opengraph-image\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/metadata/opengraph-image</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/metadata/robots":"<h1 class=\"break-words\">robots.txt</h1>\n<p>Add or generate a <code>robots.txt</code> file that matches the <a href=\"https://en.wikipedia.org/wiki/Robots.txt#Standard\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Robots Exclusion Standard</a> in the <strong>root</strong> of <code>app</code> directory to tell search engine crawlers which URLs they can access on your site.</p> <h2 id=\"static-robotstxt\" data-docs-heading=\"\">Static robots.txt     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">User-Agent: *\nAllow: /\nDisallow: /private/\n\nSitemap: https://acme.com/sitemap.xml</pre></div> <h2 id=\"generate-a-robots-file\" data-docs-heading=\"\">Generate a Robots file     </h2> <p>Add a <code>robots.js</code> or <code>robots.ts</code> file that returns a <a href=\"#robots-object\"><code>Robots</code> object</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { MetadataRoute } from 'next'\n \nexport default function robots(): MetadataRoute.Robots {\n  return {\n    rules: {\n      userAgent: '*',\n      allow: '/',\n      disallow: '/private/',\n    },\n    sitemap: 'https://acme.com/sitemap.xml',\n  }\n}</pre></div>  <p>Output:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">User-Agent: *\nAllow: /\nDisallow: /private/\n\nSitemap: https://acme.com/sitemap.xml</pre>\n</div> <h3 id=\"customizing-specific-user-agents\" data-docs-heading=\"\">Customizing specific user agents     </h3> <p>You can customise how individual search engine bots crawl your site by passing an array of user agents to the <code>rules</code> property. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { MetadataRoute } from 'next'\n \nexport default function robots(): MetadataRoute.Robots {\n  return {\n    rules: [\n      {\n        userAgent: 'Googlebot',\n        allow: ['/'],\n        disallow: '/private/',\n      },\n      {\n        userAgent: ['Applebot', 'Bingbot'],\n        disallow: ['/'],\n      },\n    ],\n    sitemap: 'https://acme.com/sitemap.xml',\n  }\n}</pre></div>  <p>Output:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">User-Agent: Googlebot\nAllow: /\nDisallow: /private/\n\nUser-Agent: Applebot\nDisallow: /\n\nUser-Agent: Bingbot\nDisallow: /\n\nSitemap: https://acme.com/sitemap.xml</pre>\n</div> <h3 id=\"robots-object\" data-docs-heading=\"\">Robots object     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">type Robots = {\n  rules:\n    | {\n        userAgent?: string | string[]\n        allow?: string | string[]\n        disallow?: string | string[]\n        crawlDelay?: number\n      }\n    | Array&lt;{\n        userAgent: string | string[]\n        allow?: string | string[]\n        disallow?: string | string[]\n        crawlDelay?: number\n      }&gt;\n  sitemap?: string | string[]\n  host?: string\n}</pre>\n</div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>robots</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/robots\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/metadata/robots</a>\n  </p>\n</div>\n","app/api-reference/file-conventions/metadata/sitemap":"<h1 class=\"break-words\">sitemap.xml</h1>\n<p><code>sitemap.(xml|js|ts)</code> is a special file that matches the <a href=\"https://www.sitemaps.org/protocol.html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Sitemaps XML format</a> to help search engine crawlers index your site more efficiently.</p> <h3 id=\"sitemap-files-xml\" data-docs-heading=\"\">Sitemap files (.xml)     </h3> <p>For smaller applications, you can create a <code>sitemap.xml</code> file and place it in the root of your <code>app</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com&lt;/loc&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n    &lt;changefreq&gt;yearly&lt;/changefreq&gt;\n    &lt;priority&gt;1&lt;/priority&gt;\n  &lt;/url&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com/about&lt;/loc&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n    &lt;changefreq&gt;monthly&lt;/changefreq&gt;\n    &lt;priority&gt;0.8&lt;/priority&gt;\n  &lt;/url&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com/blog&lt;/loc&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n    &lt;changefreq&gt;weekly&lt;/changefreq&gt;\n    &lt;priority&gt;0.5&lt;/priority&gt;\n  &lt;/url&gt;\n&lt;/urlset&gt;</pre></div> <h3 id=\"generating-a-sitemap-using-code-js-ts\" data-docs-heading=\"\">Generating a sitemap using code (.js, .ts)     </h3> <p>You can use the <code>sitemap.(js|ts)</code> file convention to programmatically <strong>generate</strong> a sitemap by exporting a default function that returns an array of URLs. If using TypeScript, a <a href=\"#returns\"><code>Sitemap</code></a> type is available.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { MetadataRoute } from 'next'\n \nexport default function sitemap(): MetadataRoute.Sitemap {\n  return [\n    {\n      url: 'https://acme.com',\n      lastModified: new Date(),\n      changeFrequency: 'yearly',\n      priority: 1,\n    },\n    {\n      url: 'https://acme.com/about',\n      lastModified: new Date(),\n      changeFrequency: 'monthly',\n      priority: 0.8,\n    },\n    {\n      url: 'https://acme.com/blog',\n      lastModified: new Date(),\n      changeFrequency: 'weekly',\n      priority: 0.5,\n    },\n  ]\n}</pre></div>  <p>Output:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com&lt;/loc&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n    &lt;changefreq&gt;yearly&lt;/changefreq&gt;\n    &lt;priority&gt;1&lt;/priority&gt;\n  &lt;/url&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com/about&lt;/loc&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n    &lt;changefreq&gt;monthly&lt;/changefreq&gt;\n    &lt;priority&gt;0.8&lt;/priority&gt;\n  &lt;/url&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com/blog&lt;/loc&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n    &lt;changefreq&gt;weekly&lt;/changefreq&gt;\n    &lt;priority&gt;0.5&lt;/priority&gt;\n  &lt;/url&gt;\n&lt;/urlset&gt;</pre></div> <h3 id=\"generate-a-localized-sitemap\" data-docs-heading=\"\">Generate a localized Sitemap     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { MetadataRoute } from 'next'\n \nexport default function sitemap(): MetadataRoute.Sitemap {\n  return [\n    {\n      url: 'https://acme.com',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es',\n          de: 'https://acme.com/de',\n        },\n      },\n    },\n    {\n      url: 'https://acme.com/about',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es/about',\n          de: 'https://acme.com/de/about',\n        },\n      },\n    },\n    {\n      url: 'https://acme.com/blog',\n      lastModified: new Date(),\n      alternates: {\n        languages: {\n          es: 'https://acme.com/es/blog',\n          de: 'https://acme.com/de/blog',\n        },\n      },\n    },\n  ]\n}</pre></div> <p>Output:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\"&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com&lt;/loc&gt;\n    &lt;xhtml:link\n      rel=\"alternate\"\n      hreflang=\"es\"\n      href=\"https://acme.com/es\"/&gt;\n    &lt;xhtml:link\n      rel=\"alternate\"\n      hreflang=\"de\"\n      href=\"https://acme.com/de\"/&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n  &lt;/url&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com/about&lt;/loc&gt;\n    &lt;xhtml:link\n      rel=\"alternate\"\n      hreflang=\"es\"\n      href=\"https://acme.com/es/about\"/&gt;\n    &lt;xhtml:link\n      rel=\"alternate\"\n      hreflang=\"de\"\n      href=\"https://acme.com/de/about\"/&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n  &lt;/url&gt;\n  &lt;url&gt;\n    &lt;loc&gt;https://acme.com/blog&lt;/loc&gt;\n    &lt;xhtml:link\n      rel=\"alternate\"\n      hreflang=\"es\"\n      href=\"https://acme.com/es/blog\"/&gt;\n    &lt;xhtml:link\n      rel=\"alternate\"\n      hreflang=\"de\"\n      href=\"https://acme.com/de/blog\"/&gt;\n    &lt;lastmod&gt;2023-04-06T15:02:24.021Z&lt;/lastmod&gt;\n  &lt;/url&gt;\n&lt;/urlset&gt;</pre></div> <h3 id=\"generating-multiple-sitemaps\" data-docs-heading=\"\">Generating multiple sitemaps     </h3> <p>While a single sitemap will work for most applications. For large web applications, you may need to split a sitemap into multiple files.</p> <p>There are two ways you can create multiple sitemaps:</p> <ul> <li>By nesting <code>sitemap.(xml|js|ts)</code> inside multiple route segments e.g. <code>app/sitemap.xml</code> and <code>app/products/sitemap.xml</code>.</li> <li>By using the <a href=\"../../functions/generate-sitemaps\"><code>generateSitemaps</code></a> function.</li> </ul> <p>For example, to split a sitemap using <code>generateSitemaps</code>, return an array of objects with the sitemap <code>id</code>. Then, use the <code>id</code> to generate the unique sitemaps.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { BASE_URL } from '@/app/lib/constants'\n \nexport async function generateSitemaps() {\n  // Fetch the total number of products and calculate the number of sitemaps needed\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}\n \nexport default async function sitemap({\n  id,\n}: {\n  id: number\n}): Promise&lt;MetadataRoute.Sitemap&gt; {\n  // Google's limit is 50,000 URLs per sitemap\n  const start = id * 50000\n  const end = start + 50000\n  const products = await getProducts(\n    `SELECT id, date FROM products WHERE id BETWEEN ${start} AND ${end}`\n  )\n  return products.map((product) =&gt; ({\n    url: `${BASE_URL}/product/${id}`,\n    lastModified: product.date,\n  }))\n}</pre></div>  <p>In production, your generated sitemaps will be available at <code>/.../sitemap/[id].xml</code>. For example, <code>/product/sitemap/1.xml</code>.</p> <p>In development, you can view the generated sitemap on <code>/.../sitemap.xml/[id]</code>. For example, <code>/product/sitemap.xml/1</code>. This difference is temporary and will follow the production format.</p> <p>See the <a href=\"../../functions/generate-sitemaps\"><code>generateSitemaps</code> API reference</a> for more information.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p>The default function exported from <code>sitemap.(xml|ts|js)</code> should return an array of objects with the following properties:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">type Sitemap = Array&lt;{\n  url: string\n  lastModified?: string | Date\n  changeFrequency?:\n    | 'always'\n    | 'hourly'\n    | 'daily'\n    | 'weekly'\n    | 'monthly'\n    | 'yearly'\n    | 'never'\n  priority?: number\n  alternates?: {\n    languages?: Languages&lt;string&gt;\n  }\n}&gt;</pre>\n</div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.4.5</code></td>\n<td>Add <code>changeFrequency</code> and <code>priority</code> attributes to sitemaps.</td>\n</tr>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>sitemap</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/sitemap\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/file-conventions/metadata/sitemap</a>\n  </p>\n</div>\n","app/api-reference/functions":"<h1 class=\"break-words\">Functions</h1><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions</a>\n  </p>\n</div>\n","app/api-reference/functions/cookies":"<h1 class=\"break-words\">cookies</h1>\n<p>The <code>cookies</code> function allows you to read the HTTP incoming request cookies from a <a href=\"../../building-your-application/rendering/server-components\">Server Component</a> or write outgoing request cookies in a <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Action</a> or <a href=\"../../building-your-application/routing/route-handlers\">Route Handler</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>cookies()</code> is a <strong><a href=\"#\">Dynamic Function</a></strong> whose returned values cannot be known ahead of time. Using it in a layout or page will opt a route into <strong><a href=\"../../building-your-application/rendering/server-components#dynamic-rendering\">dynamic rendering</a></strong> at request time.</p> </blockquote> <h2 id=\"cookiesgetname\" data-docs-heading=\"\">cookies().get(name)     </h2> <p>A method that takes a cookie name and returns an object with name and value. If a cookie with <code>name</code> isn't found, it returns <code>undefined</code>. If multiple cookies match, it will only return the first match.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cookies } from 'next/headers'\n \nexport default function Page() {\n  const cookieStore = cookies()\n  const theme = cookieStore.get('theme')\n  return '...'\n}</pre></div> <h2 id=\"cookiesgetall\" data-docs-heading=\"\">cookies().getAll()     </h2> <p>A method that is similar to <code>get</code>, but returns a list of all the cookies with a matching <code>name</code>. If <code>name</code> is unspecified, it returns all the available cookies.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cookies } from 'next/headers'\n \nexport default function Page() {\n  const cookieStore = cookies()\n  return cookieStore.getAll().map((cookie) =&gt; (\n    &lt;div key={cookie.name}&gt;\n      &lt;p&gt;Name: {cookie.name}&lt;/p&gt;\n      &lt;p&gt;Value: {cookie.value}&lt;/p&gt;\n    &lt;/div&gt;\n  ))\n}</pre></div> <h2 id=\"cookieshasname\" data-docs-heading=\"\">cookies().has(name)     </h2> <p>A method that takes a cookie name and returns a <code>boolean</code> based on if the cookie exists (<code>true</code>) or not (<code>false</code>).</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { cookies } from 'next/headers'\n \nexport default function Page() {\n  const cookieStore = cookies()\n  const hasCookie = cookieStore.has('theme')\n  return '...'\n}</pre></div> <h2 id=\"cookiessetname-value-options\" data-docs-heading=\"\">cookies().set(name, value, options)     </h2> <p>A method that takes a cookie name, value, and options and sets the outgoing request cookie.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: HTTP does not allow setting cookies after streaming starts, so you must use <code>.set()</code> in a <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Action</a> or <a href=\"../../building-your-application/routing/route-handlers\">Route Handler</a>.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { cookies } from 'next/headers'\n \nasync function create(data) {\n  cookies().set('name', 'lee')\n  // or\n  cookies().set('name', 'lee', { secure: true })\n  // or\n  cookies().set({\n    name: 'name',\n    value: 'lee',\n    httpOnly: true,\n    path: '/',\n  })\n}</pre></div> <h2 id=\"deleting-cookies\" data-docs-heading=\"\">Deleting cookies     </h2> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You can only delete cookies in a <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Action</a> or <a href=\"../../building-your-application/routing/route-handlers\">Route Handler</a>.</p> </blockquote> <p>There are several options for deleting a cookie:</p> <h3 id=\"cookiesdeletename\" data-docs-heading=\"\">cookies().delete(name)     </h3> <p>You can explicitly delete a cookie with a given name.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { cookies } from 'next/headers'\n \nasync function delete(data) {\n  cookies().delete('name')\n}</pre></div> <h3 id=\"cookiessetname-\" data-docs-heading=\"\">cookies().set(name, '')     </h3> <p>Alternatively, you can set a new cookie with the same name and an empty value.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { cookies } from 'next/headers'\n \nasync function delete(data) {\n  cookies().set('name', '')\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.set()</code> is only available in a <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Action</a> or <a href=\"../../building-your-application/routing/route-handlers\">Route Handler</a>.</p> </blockquote> <h3 id=\"cookiessetname-value--maxage-0-\" data-docs-heading=\"\">cookies().set(name, value, { maxAge: 0 })     </h3> <p>Setting <code>maxAge</code> to 0 will immediately expire a cookie.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { cookies } from 'next/headers'\n \nasync function delete(data) {\n  cookies().set('name', 'value', { maxAge: 0 })\n}</pre></div> <h3 id=\"cookiessetname-value--expires-timestamp-\" data-docs-heading=\"\">cookies().set(name, value, { expires: timestamp })     </h3> <p>Setting <code>expires</code> to any value in the past will immediately expire a cookie.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { cookies } from 'next/headers'\n \nasync function delete(data) {\n  const oneDay = 24 * 60 * 60 * 1000\n  cookies().set('name', 'value', { expires: Date.now() - oneDay })\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You can only delete cookies that belong to the same domain from which <code>.set()</code> is called. Additionally, the code must be executed on the same protocol (HTTP or HTTPS) as the cookie you want to delete.</p> </blockquote> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>cookies</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/cookies\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/cookies</a>\n  </p>\n</div>\n","app/api-reference/functions/fetch":"<h1 class=\"break-words\">fetch</h1>\n<p>Next.js extends the native <a href=\"https://developer.mozilla.org/docs/Web/API/Fetch_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web <code>fetch()</code> API</a> to allow each request on the server to set its own persistent caching semantics.</p> <p>In the browser, the <code>cache</code> option indicates how a fetch request will interact with the <em>browser's</em> HTTP cache. With this extension, <code>cache</code> indicates how a <em>server-side</em> fetch request will interact with the framework's persistent HTTP cache.</p> <p>You can call <code>fetch</code> with <code>async</code> and <code>await</code> directly within Server Components.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function Page() {\n  // This request should be cached until manually invalidated.\n  // Similar to `getStaticProps`.\n  // `force-cache` is the default and can be omitted.\n  const staticData = await fetch(`https://...`, { cache: 'force-cache' })\n \n  // This request should be refetched on every request.\n  // Similar to `getServerSideProps`.\n  const dynamicData = await fetch(`https://...`, { cache: 'no-store' })\n \n  // This request should be cached with a lifetime of 10 seconds.\n  // Similar to `getStaticProps` with the `revalidate` option.\n  const revalidatedData = await fetch(`https://...`, {\n    next: { revalidate: 10 },\n  })\n \n  return &lt;div&gt;...&lt;/div&gt;\n}</pre></div>  <h2 id=\"fetchurl-options\" data-docs-heading=\"\">fetch(url, options)     </h2> <p>Since Next.js extends the <a href=\"https://developer.mozilla.org/docs/Web/API/Fetch_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web <code>fetch()</code> API</a>, you can use any of the <a href=\"https://developer.mozilla.org/docs/Web/API/fetch#parameters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">native options available</a>.</p> <h3 id=\"optionscache\" data-docs-heading=\"\">options.cache     </h3> <p>Configure how the request should interact with Next.js <a href=\"../../building-your-application/caching#data-cache\">Data Cache</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">fetch(`https://...`, { cache: 'force-cache' | 'no-store' })</pre>\n</div> <ul> <li>\n<strong><code>force-cache</code></strong> (default) - Next.js looks for a matching request in its Data Cache. <ul> <li>If there is a match and it is fresh, it will be returned from the cache.</li> <li>If there is no match or a stale match, Next.js will fetch the resource from the remote server and update the cache with the downloaded resource.</li> </ul> </li> <li>\n<strong><code>no-store</code></strong> - Next.js fetches the resource from the remote server on every request without looking in the cache, and it will not update the cache with the downloaded resource.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If you don't provide a <code>cache</code> option, Next.js will default to <code>force-cache</code>, unless a <a href=\"#\">dynamic function</a> such as <code>cookies()</code> is used, in which case it will default to <code>no-store</code>.</li> <li>The <code>no-cache</code> option behaves the same way as <code>no-store</code> in Next.js.</li> </ul> </blockquote> <h3 id=\"optionsnextrevalidate\" data-docs-heading=\"\">options.next.revalidate     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">fetch(`https://...`, { next: { revalidate: false | 0 | number } })</pre>\n</div> <p>Set the cache lifetime of a resource (in seconds).</p> <ul> <li>\n<strong><code>false</code></strong> - Cache the resource indefinitely. Semantically equivalent to <code>revalidate: Infinity</code>. The HTTP cache may evict older resources over time.</li> <li>\n<strong><code>0</code></strong> - Prevent the resource from being cached.</li> <li>\n<strong><code>number</code></strong> - (in seconds) Specify the resource should have a cache lifetime of at most <code>n</code> seconds.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If an individual <code>fetch()</code> request sets a <code>revalidate</code> number lower than the <a href=\"../file-conventions/route-segment-config#revalidate\">default <code>revalidate</code></a> of a route, the whole route revalidation interval will be decreased.</li> <li>If two fetch requests with the same URL in the same route have different <code>revalidate</code> values, the lower value will be used.</li> <li>As a convenience, it is not necessary to set the <code>cache</code> option if <code>revalidate</code> is set to a number since <code>0</code> implies <code>cache: 'no-store'</code> and a positive value implies <code>cache: 'force-cache'</code>.</li> <li>Conflicting options such as <code>{ revalidate: 0, cache: 'force-cache' }</code> or <code>{ revalidate: 10, cache: 'no-store' }</code> will cause an error.</li> </ul> </blockquote> <h3 id=\"optionsnexttags\" data-docs-heading=\"\">options.next.tags     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">fetch(`https://...`, { next: { tags: ['collection'] } })</pre>\n</div> <p>Set the cache tags of a resource. Data can then be revalidated on-demand using <a href=\"revalidatetag\" rel=\"noopener noreferrer\" target=\"_blank\"><code>revalidateTag</code></a>. The max length for a custom tag is 256 characters and the max tag items is 64.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>fetch</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/fetch\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/fetch</a>\n  </p>\n</div>\n","app/api-reference/functions/generate-sitemaps":"<h1 class=\"break-words\">generateSitemaps</h1>\n<p>You can use the <code>generateSitemaps</code> function to generate multiple sitemaps for your application.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p>The <code>generateSitemaps</code> returns an array of objects with an <code>id</code> property.</p> <h2 id=\"urls\" data-docs-heading=\"\">URLs     </h2> <p>In production, your generated sitemaps will be available at <code>/.../sitemap/[id].xml</code>. For example, <code>/product/sitemap/1.xml</code>.</p> <p>In development, you can view the generated sitemap on <code>/.../sitemap.xml/[id]</code>. For example, <code>/product/sitemap.xml/1</code>. This difference is temporary and will follow the production format.</p> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <p>For example, to split a sitemap using <code>generateSitemaps</code>, return an array of objects with the sitemap <code>id</code>. Then, use the <code>id</code> to generate the unique sitemaps.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { BASE_URL } from '@/app/lib/constants'\n \nexport async function generateSitemaps() {\n  // Fetch the total number of products and calculate the number of sitemaps needed\n  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]\n}\n \nexport default async function sitemap({\n  id,\n}: {\n  id: number\n}): Promise&lt;MetadataRoute.Sitemap&gt; {\n  // Google's limit is 50,000 URLs per sitemap\n  const start = id * 50000\n  const end = start + 50000\n  const products = await getProducts(\n    `SELECT id, date FROM products WHERE id BETWEEN ${start} AND ${end}`\n  )\n  return products.map((product) =&gt; ({\n    url: `${BASE_URL}/product/${product.id}`,\n    lastModified: product.date,\n  }))\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-sitemaps\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/generate-sitemaps</a>\n  </p>\n</div>\n","app/api-reference/functions/generate-static-params":"<h1 class=\"break-words\">generateStaticParams</h1>\n<p>The <code>generateStaticParams</code> function can be used in combination with <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route segments</a> to <a href=\"../../building-your-application/rendering/server-components#static-rendering-default\"><strong>statically generate</strong></a> routes at build time instead of on-demand at request time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Return a list of `params` to populate the [slug] dynamic segment\nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) =&gt; res.json())\n \n  return posts.map((post) =&gt; ({\n    slug: post.slug,\n  }))\n}\n \n// Multiple versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\nexport default function Page({ params }) {\n  const { slug } = params\n  // ...\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>You can use the <a href=\"../file-conventions/route-segment-config#dynamicparams\"><code>dynamicParams</code></a> segment config option to control what happens when a dynamic segment is visited that was not generated with <code>generateStaticParams</code>.</li> <li>During <code>next dev</code>, <code>generateStaticParams</code> will be called when you navigate to a route.</li> <li>During <code>next build</code>, <code>generateStaticParams</code> runs before the corresponding Layouts or Pages are generated.</li> <li>During revalidation (ISR), <code>generateStaticParams</code> will not be called again.</li> <li>\n<code>generateStaticParams</code> replaces the <a href=\"../../../pages/api-reference/functions/get-static-paths\"><code>getStaticPaths</code></a> function in the Pages Router.</li> </ul> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <p><code>options.params</code> (optional)</p> <p>If multiple dynamic segments in a route use <code>generateStaticParams</code>, the child <code>generateStaticParams</code> function is executed once for each set of <code>params</code> the parent generates.</p> <p>The <code>params</code> object contains the populated <code>params</code> from the parent <code>generateStaticParams</code>, which can be used to <a href=\"#multiple-dynamic-segments-in-a-route\">generate the <code>params</code> in a child segment</a>.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>generateStaticParams</code> should return an array of objects where each object represents the populated dynamic segments of a single route.</p> <ul> <li>Each property in the object is a dynamic segment to be filled in for the route.</li> <li>The properties name is the segment's name, and the properties value is what that segment should be filled in with.</li> </ul> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Example Route</th>\n<th>\n<code>generateStaticParams</code> Return Type</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>/product/[id]</code></td>\n<td><code>{ id: string }[]</code></td>\n</tr>\n<tr>\n<td><code>/products/[category]/[product]</code></td>\n<td><code>{ category: string, product: string }[]</code></td>\n</tr>\n<tr>\n<td><code>/products/[...slug]</code></td>\n<td><code>{ slug: string[] }[]</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"single-dynamic-segment\" data-docs-heading=\"\">Single Dynamic Segment     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function generateStaticParams() {\n  return [{ id: '1' }, { id: '2' }, { id: '3' }]\n}\n \n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /product/1\n// - /product/2\n// - /product/3\nexport default function Page({ params }: { params: { id: string } }) {\n  const { id } = params\n  // ...\n}</pre></div>  <h2 id=\"multiple-dynamic-segments\" data-docs-heading=\"\">Multiple Dynamic Segments     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function generateStaticParams() {\n  return [\n    { category: 'a', product: '1' },\n    { category: 'b', product: '2' },\n    { category: 'c', product: '3' },\n  ]\n}\n \n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /products/a/1\n// - /products/b/2\n// - /products/c/3\nexport default function Page({\n  params,\n}: {\n  params: { category: string; product: string }\n}) {\n  const { category, product } = params\n  // ...\n}</pre></div>  <h2 id=\"catch-all-dynamic-segment\" data-docs-heading=\"\">Catch-all Dynamic Segment     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function generateStaticParams() {\n  return [{ slug: ['a', '1'] }, { slug: ['b', '2'] }, { slug: ['c', '3'] }]\n}\n \n// Three versions of this page will be statically generated\n// using the `params` returned by `generateStaticParams`\n// - /product/a/1\n// - /product/b/2\n// - /product/c/3\nexport default function Page({ params }: { params: { slug: string[] } }) {\n  const { slug } = params\n  // ...\n}</pre></div>  <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"multiple-dynamic-segments-in-a-route\" data-docs-heading=\"\">Multiple Dynamic Segments in a Route     </h3> <p>You can generate params for dynamic segments above the current layout or page, but <strong>not below</strong>. For example, given the <code>app/products/[category]/[product]</code> route:</p> <ul> <li>\n<code>app/products/[category]/[product]/page.js</code> can generate params for <strong>both</strong> <code>[category]</code> and <code>[product]</code>.</li> <li>\n<code>app/products/[category]/layout.js</code> can <strong>only</strong> generate params for <code>[category]</code>.</li> </ul> <p>There are two approaches to generating params for a route with multiple dynamic segments:</p> <h3 id=\"generate-params-from-the-bottom-up\" data-docs-heading=\"\">Generate params from the bottom up     </h3> <p>Generate multiple dynamic segments from the child route segment.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Generate segments for both [category] and [product]\nexport async function generateStaticParams() {\n  const products = await fetch('https://.../products').then((res) =&gt; res.json())\n \n  return products.map((product) =&gt; ({\n    category: product.category.slug,\n    product: product.id,\n  }))\n}\n \nexport default function Page({\n  params,\n}: {\n  params: { category: string; product: string }\n}) {\n  // ...\n}</pre></div>  <h3 id=\"generate-params-from-the-top-down\" data-docs-heading=\"\">Generate params from the top down     </h3> <p>Generate the parent segments first and use the result to generate the child segments.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Generate segments for [category]\nexport async function generateStaticParams() {\n  const products = await fetch('https://.../products').then((res) =&gt; res.json())\n \n  return products.map((product) =&gt; ({\n    category: product.category.slug,\n  }))\n}\n \nexport default function Layout({ params }: { params: { category: string } }) {\n  // ...\n}</pre></div>  <p>A child route segment's <code>generateStaticParams</code> function is executed once for each segment a parent <code>generateStaticParams</code> generates.</p> <p>The child <code>generateStaticParams</code> function can use the <code>params</code> returned from the parent <code>generateStaticParams</code> function to dynamically generate its own segments.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Generate segments for [product] using the `params` passed from\n// the parent segment's `generateStaticParams` function\nexport async function generateStaticParams({\n  params: { category },\n}: {\n  params: { category: string }\n}) {\n  const products = await fetch(\n    `https://.../products?category=${category}`\n  ).then((res) =&gt; res.json())\n \n  return products.map((product) =&gt; ({\n    product: product.id,\n  }))\n}\n \nexport default function Page({\n  params,\n}: {\n  params: { category: string; product: string }\n}) {\n  // ...\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>fetch</code> requests are automatically <a href=\"../../building-your-application/caching#request-memoization\">memoized</a> for the same data across all <code>generate</code>-prefixed functions, Layouts, Pages, and Server Components. React <a href=\"../../building-your-application/caching#request-memoization\"><code>cache</code> can be used</a> if <code>fetch</code> is unavailable.</p> </blockquote> <h3 id=\"generate-only-a-subset-of-params\" data-docs-heading=\"\">Generate only a subset of params     </h3> <p>You can generate a subset of params for a route by returning an array of objects with only the dynamic segments you want to generate. Then, by using the <a href=\"../file-conventions/route-segment-config#dynamicparams\"><code>dynamicParams</code></a> segment config option, you can control what happens when a dynamic segment is visited that was not generated with <code>generateStaticParams</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// All posts besides the top 10 will be a 404\nexport const dynamicParams = false\n \nexport async function generateStaticParams() {\n  const posts = await fetch('https://.../posts').then((res) =&gt; res.json())\n  const topPosts = posts.slice(0, 10)\n \n  return topPosts.map((post) =&gt; ({\n    slug: post.slug,\n  }))\n}</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>generateStaticParams</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-static-params\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/generate-static-params</a>\n  </p>\n</div>\n","app/api-reference/functions/headers":"<h1 class=\"break-words\">headers</h1>\n<p>The <code>headers</code> function allows you to read the HTTP incoming request headers from a <a href=\"../../building-your-application/rendering/server-components\">Server Component</a>.</p> <h2 id=\"headers\" data-docs-heading=\"\">headers()     </h2> <p>This API extends the <a href=\"https://developer.mozilla.org/docs/Web/API/Headers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Headers API</a>. It is <strong>read-only</strong>, meaning you cannot <code>set</code> / <code>delete</code> the outgoing request headers.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { headers } from 'next/headers'\n \nexport default function Page() {\n  const headersList = headers()\n  const referer = headersList.get('referer')\n \n  return &lt;div&gt;Referer: {referer}&lt;/div&gt;\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>headers()</code> is a <strong><a href=\"#\">Dynamic Function</a></strong> whose returned values cannot be known ahead of time. Using it in a layout or page will opt a route into <strong><a href=\"../../building-your-application/rendering/server-components#dynamic-rendering\">dynamic rendering</a></strong> at request time.</li> </ul> </blockquote> <h3 id=\"api-reference\" data-docs-heading=\"\">API Reference     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const headersList = headers()</pre>\n</div> <h4 id=\"parameters\" data-docs-heading=\"\">Parameters     </h4> <p><code>headers</code> does not take any parameters.</p> <h4 id=\"returns\" data-docs-heading=\"\">Returns     </h4> <p><code>headers</code> returns a <strong>read-only</strong> <a href=\"https://developer.mozilla.org/docs/Web/API/Headers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Headers</a> object.</p> <ul> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/API/Headers/entries\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Headers.entries()</code></a>: Returns an <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Iteration_protocols\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>iterator</code></a> allowing to go through all key/value pairs contained in this object.</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/API/Headers/forEach\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Headers.forEach()</code></a>: Executes a provided function once for each key/value pair in this <code>Headers</code> object.</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/API/Headers/get\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Headers.get()</code></a>: Returns a <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>String</code></a> sequence of all the values of a header within a <code>Headers</code> object with a given name.</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/API/Headers/has\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Headers.has()</code></a>: Returns a boolean stating whether a <code>Headers</code> object contains a certain header.</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/API/Headers/keys\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Headers.keys()</code></a>: Returns an <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Iteration_protocols\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>iterator</code></a> allowing you to go through all keys of the key/value pairs contained in this object.</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/API/Headers/values\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Headers.values()</code></a>: Returns an <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Iteration_protocols\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>iterator</code></a> allowing you to go through all values of the key/value pairs contained in this object.</li> </ul> <h3 id=\"examples\" data-docs-heading=\"\">Examples     </h3> <h4 id=\"usage-with-data-fetching\" data-docs-heading=\"\">Usage with Data Fetching     </h4> <p><code>headers()</code> can be used in combination with <a href=\"../../building-your-application/data-fetching/fetching-caching-and-revalidating\">Suspense for Data Fetching</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Suspense } from 'react'\nimport { headers } from 'next/headers'\n \nasync function User() {\n  const authorization = headers().get('authorization')\n  const res = await fetch('...', {\n    headers: { authorization }, // Forward the authorization header\n  })\n  const user = await res.json()\n \n  return &lt;h1&gt;{user.name}&lt;/h1&gt;\n}\n \nexport default function Page() {\n  return (\n    &lt;Suspense fallback={null}&gt;\n      &lt;User /&gt;\n    &lt;/Suspense&gt;\n  )\n}</pre></div> <h4 id=\"ip-address\" data-docs-heading=\"\">IP Address     </h4> <p><code>headers()</code> can be used to get the IP address of the client.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Suspense } from 'react'\nimport { headers } from 'next/headers'\n \nfunction IP() {\n  const FALLBACK_IP_ADDRESS = '0.0.0.0'\n  const forwardedFor = headers().get('x-forwarded-for')\n \n  if (forwardedFor) {\n    return forwardedFor.split(',')[0] ?? FALLBACK_IP_ADDRESS\n  }\n \n  return headers().get('x-real-ip') ?? FALLBACK_IP_ADDRESS\n}\n \nexport default function Page() {\n  return (\n    &lt;Suspense fallback={null}&gt;\n      &lt;IP /&gt;\n    &lt;/Suspense&gt;\n  )\n}</pre></div> <p>In addition to <code>x-forwarded-for</code>, <code>headers()</code> can also read:</p> <ul> <li><code>x-real-ip</code></li> <li><code>x-forwarded-host</code></li> <li><code>x-forwarded-port</code></li> <li><code>x-forwarded-proto</code></li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>headers</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/headers\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/headers</a>\n  </p>\n</div>\n","app/api-reference/functions/draft-mode":"<h1 class=\"break-words\">draftMode</h1>\n<p>The <code>draftMode</code> function allows you to detect <a href=\"../../building-your-application/configuring/draft-mode\">Draft Mode</a> inside a <a href=\"../../building-your-application/rendering/server-components\">Server Component</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { draftMode } from 'next/headers'\n \nexport default function Page() {\n  const { isEnabled } = draftMode()\n  return (\n    &lt;main&gt;\n      &lt;h1&gt;My Blog Post&lt;/h1&gt;\n      &lt;p&gt;Draft Mode is currently {isEnabled ? 'Enabled' : 'Disabled'}&lt;/p&gt;\n    &lt;/main&gt;\n  )\n}</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.4.0</code></td>\n<td>\n<code>draftMode</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/draft-mode\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/draft-mode</a>\n  </p>\n</div>\n","app/api-reference/functions/generate-image-metadata":"<h1 class=\"break-words\">generateImageMetadata</h1>\n<p>You can use <code>generateImageMetadata</code> to generate different versions of one image or return multiple images for one route segment. This is useful for when you want to avoid hard-coding metadata values, such as for icons.</p> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <p><code>generateImageMetadata</code> function accepts the following parameters:</p> <h4 id=\"params-optional\" data-docs-heading=\"\">params (optional)     </h4> <p>An object containing the <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route parameters</a> object from the root segment down to the segment <code>generateImageMetadata</code> is called from.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function generateImageMetadata({\n  params,\n}: {\n  params: { slug: string }\n}) {\n  // ...\n}</pre></div>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/shop/icon.js</code></td>\n<td><code>/shop</code></td>\n<td><code>undefined</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[slug]/icon.js</code></td>\n<td><code>/shop/1</code></td>\n<td><code>{ slug: '1' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[tag]/[item]/icon.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ tag: '1', item: '2' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/icon.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ slug: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p>The <code>generateImageMetadata</code> function should return an <code>array</code> of objects containing the image's metadata such as <code>alt</code> and <code>size</code>. In addition, each item <strong>must</strong> include an <code>id</code> value which will be passed to the props of the image generating function.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Image Metadata Object</th>\n<th>Type</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>id</code></td>\n<td>\n<code>string</code> (required)</td>\n</tr>\n<tr>\n<td><code>alt</code></td>\n<td><code>string</code></td>\n</tr>\n<tr>\n<td><code>size</code></td>\n<td><code>{ width: number; height: number }</code></td>\n</tr>\n<tr>\n<td><code>contentType</code></td>\n<td><code>string</code></td>\n</tr>\n</tbody>\n</table></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'\n \nexport function generateImageMetadata() {\n  return [\n    {\n      contentType: 'image/png',\n      size: { width: 48, height: 48 },\n      id: 'small',\n    },\n    {\n      contentType: 'image/png',\n      size: { width: 72, height: 72 },\n      id: 'medium',\n    },\n  ]\n}\n \nexport default function Icon({ id }: { id: string }) {\n  return new ImageResponse(\n    (\n      &lt;div\n        style={{\n          width: '100%',\n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          fontSize: 88,\n          background: '#000',\n          color: '#fafafa',\n        }}\n      &gt;\n        Icon {id}\n      &lt;/div&gt;\n    )\n  )\n}</pre></div>  <h3 id=\"examples\" data-docs-heading=\"\">Examples     </h3> <h4 id=\"using-external-data\" data-docs-heading=\"\">Using external data     </h4> <p>This example uses the <code>params</code> object and external data to generate multiple <a href=\"../file-conventions/metadata/opengraph-image\">Open Graph images</a> for a route segment.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'\nimport { getCaptionForImage, getOGImages } from '@/app/utils/images'\n \nexport async function generateImageMetadata({\n  params,\n}: {\n  params: { id: string }\n}) {\n  const images = await getOGImages(params.id)\n \n  return images.map((image, idx) =&gt; ({\n    id: idx,\n    size: { width: 1200, height: 600 },\n    alt: image.text,\n    contentType: 'image/png',\n  }))\n}\n \nexport default async function Image({\n  params,\n  id,\n}: {\n  params: { id: string }\n  id: number\n}) {\n  const productId = params.id\n  const imageId = id\n  const text = await getCaptionForImage(productId, imageId)\n \n  return new ImageResponse(\n    (\n      &lt;div\n        style={\n          {\n            // ...\n          }\n        }\n      &gt;\n        {text}\n      &lt;/div&gt;\n    )\n  )\n}</pre></div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>generateImageMetadata</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-image-metadata\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/generate-image-metadata</a>\n  </p>\n</div>\n","app/api-reference/functions/image-response":"<h1 class=\"break-words\">ImageResponse</h1>\n<p>The <code>ImageResponse</code> constructor allows you to generate dynamic images using JSX and CSS. This is useful for generating social media images such as Open Graph images, Twitter cards, and more.</p> <p>The following options are available for <code>ImageResponse</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'\n \nnew ImageResponse(\n  element: ReactElement,\n  options: {\n    width?: number = 1200\n    height?: number = 630\n    emoji?: 'twemoji' | 'blobmoji' | 'noto' | 'openmoji' = 'twemoji',\n    fonts?: {\n      name: string,\n      data: ArrayBuffer,\n      weight: number,\n      style: 'normal' | 'italic'\n    }[]\n    debug?: boolean = false\n \n    // Options that will be passed to the HTTP response\n    status?: number = 200\n    statusText?: string\n    headers?: Record&lt;string, string&gt;\n  },\n)</pre>\n</div> <h2 id=\"supported-css-properties\" data-docs-heading=\"\">Supported CSS Properties     </h2> <p>Please refer to <a href=\"https://github.com/vercel/satori#css\" rel=\"noopener noreferrer\" target=\"_blank\">Satoris documentation</a> for a list of supported HTML and CSS features.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v14.0.0</code></td>\n<td>\n<code>ImageResponse</code> moved from <code>next/server</code> to <code>next/og</code>\n</td>\n</tr>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>ImageResponse</code> can be imported from <code>next/server</code>.</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>ImageResponse</code> introduced via <code>@vercel/og</code> package.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/image-response\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/image-response</a>\n  </p>\n</div>\n","app/api-reference/functions/not-found":"<h1 class=\"break-words\">notFound</h1>\n<p>The <code>notFound</code> function allows you to render the <a href=\"../file-conventions/not-found\"><code>not-found file</code></a> within a route segment as well as inject a <code>&lt;meta name=\"robots\" content=\"noindex\" /&gt;</code> tag.</p> <h2 id=\"notfound\" data-docs-heading=\"\">notFound()     </h2> <p>Invoking the <code>notFound()</code> function throws a <code>NEXT_NOT_FOUND</code> error and terminates rendering of the route segment in which it was thrown. Specifying a <a href=\"../file-conventions/not-found\"><strong>not-found</strong> file</a> allows you to gracefully handle such errors by rendering a Not Found UI within the segment.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { notFound } from 'next/navigation'\n \nasync function fetchUser(id) {\n  const res = await fetch('https://...')\n  if (!res.ok) return undefined\n  return res.json()\n}\n \nexport default async function Profile({ params }) {\n  const user = await fetchUser(params.id)\n \n  if (!user) {\n    notFound()\n  }\n \n  // ...\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>notFound()</code> does not require you to use <code>return notFound()</code> due to using the TypeScript <a href=\"https://www.typescriptlang.org/docs/handbook/2/functions.html#never\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>never</code></a> type.</p> </blockquote> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>notFound</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/not-found\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/not-found</a>\n  </p>\n</div>\n","app/api-reference/functions/revalidatepath":"<h1 class=\"break-words\">revalidatePath</h1>\n<p><code>revalidatePath</code> allows you to purge <a href=\"../../building-your-application/caching\">cached data</a> on-demand for a specific path.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>revalidatePath</code> is available in both <a href=\"../../building-your-application/rendering/edge-and-nodejs-runtimes\">Node.js and Edge runtimes</a>.</li> <li>\n<code>revalidatePath</code> only invalidates the cache when the included path is next visited. This means calling <code>revalidatePath</code> with a dynamic route segment will not immediately trigger many revalidations at once. The invalidation only happens when the path is next visited.</li> <li>Currently, <code>revalidatePath</code> invalidates all the routes in the <a href=\"../../building-your-application/caching#router-cache\">client-side Router Cache</a>. This behavior is temporary and will be updated in the future to apply only to the specific path.</li> <li>Using <code>revalidatePath</code> invalidates <strong>only the specific path</strong> in the <a href=\"../../building-your-application/caching#full-route-cache\">server-side Route Cache</a>.</li> </ul> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">revalidatePath(path: string, type?: 'page' | 'layout'): void;</pre>\n</div> <ul> <li>\n<code>path</code>: Either a string representing the filesystem path associated with the data you want to revalidate (for example, <code>/product/[slug]/page</code>), or the literal route segment (for example, <code>/product/123</code>). Must be less than 1024 characters. This value is case-sensitive.</li> <li>\n<code>type</code>: (optional) <code>'page'</code> or <code>'layout'</code> string to change the type of path to revalidate. If <code>path</code> contains a dynamic segment (for example, <code>/product/[slug]/page</code>), this parameter is required.</li> </ul> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>revalidatePath</code> does not return any value.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"revalidating-a-specific-url\" data-docs-heading=\"\">Revalidating A Specific URL     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { revalidatePath } from 'next/cache'\nrevalidatePath('/blog/post-1')</pre>\n</div> <p>This will revalidate one specific URL on the next page visit.</p> <h3 id=\"revalidating-a-page-path\" data-docs-heading=\"\">Revalidating A Page Path     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { revalidatePath } from 'next/cache'\nrevalidatePath('/blog/[slug]', 'page')\n// or with route groups\nrevalidatePath('/(main)/post/[slug]', 'page')</pre>\n</div> <p>This will revalidate any URL that matches the provided <code>page</code> file on the next page visit. This will <em>not</em> invalidate pages beneath the specific page. For example, <code>/blog/[slug]</code> won't invalidate <code>/blog/[slug]/[author]</code>.</p> <h3 id=\"revalidating-a-layout-path\" data-docs-heading=\"\">Revalidating A Layout Path     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { revalidatePath } from 'next/cache'\nrevalidatePath('/blog/[slug]', 'layout')\n// or with route groups\nrevalidatePath('/(main)/post/[slug]', 'layout')</pre>\n</div> <p>This will revalidate any URL that matches the provided <code>layout</code> file on the next page visit. This will cause pages beneath with the same layout to revalidate on the next visit. For example, in the above case, <code>/blog/[slug]/[another]</code> would also revalidate on the next visit.</p> <h3 id=\"revalidating-all-data\" data-docs-heading=\"\">Revalidating All Data     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { revalidatePath } from 'next/cache'\n \nrevalidatePath('/', 'layout')</pre>\n</div> <p>This will purge the Client-side Router Cache, and revalidate the Data Cache on the next page visit.</p> <h3 id=\"server-action\" data-docs-heading=\"\">Server Action     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { revalidatePath } from 'next/cache'\n \nexport default async function submit() {\n  await submitForm()\n  revalidatePath('/')\n}</pre></div> <h3 id=\"route-handler\" data-docs-heading=\"\">Route Handler     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { revalidatePath } from 'next/cache'\nimport { NextRequest } from 'next/server'\n \nexport async function GET(request: NextRequest) {\n  const path = request.nextUrl.searchParams.get('path')\n \n  if (path) {\n    revalidatePath(path)\n    return Response.json({ revalidated: true, now: Date.now() })\n  }\n \n  return Response.json({\n    revalidated: false,\n    now: Date.now(),\n    message: 'Missing path to revalidate',\n  })\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/revalidatePath\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/revalidatePath</a>\n  </p>\n</div>\n","app/api-reference/functions/revalidatetag":"<h1 class=\"break-words\">revalidateTag</h1>\n<p><code>revalidateTag</code> allows you to purge <a href=\"../../building-your-application/caching\">cached data</a> on-demand for a specific cache tag.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>revalidateTag</code> is available in both <a href=\"../../building-your-application/rendering/edge-and-nodejs-runtimes\">Node.js and Edge runtimes</a>.</li> <li>\n<code>revalidateTag</code> only invalidates the cache when the path is next visited. This means calling <code>revalidateTag</code> with a dynamic route segment will not immediately trigger many revalidations at once. The invalidation only happens when the path is next visited.</li> </ul> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">revalidateTag(tag: string): void;</pre>\n</div> <ul> <li>\n<code>tag</code>: A string representing the cache tag associated with the data you want to revalidate. Must be less than or equal to 256 characters. This value is case-sensitive.</li> </ul> <p>You can add tags to <code>fetch</code> as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">fetch(url, { next: { tags: [...] } });</pre>\n</div> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>revalidateTag</code> does not return any value.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"server-action\" data-docs-heading=\"\">Server Action     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { revalidateTag } from 'next/cache'\n \nexport default async function submit() {\n  await addPost()\n  revalidateTag('posts')\n}</pre></div>  <h3 id=\"route-handler\" data-docs-heading=\"\">Route Handler     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest } from 'next/server'\nimport { revalidateTag } from 'next/cache'\n \nexport async function GET(request: NextRequest) {\n  const tag = request.nextUrl.searchParams.get('tag')\n  revalidateTag(tag)\n  return Response.json({ revalidated: true, now: Date.now() })\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/revalidateTag\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/revalidateTag</a>\n  </p>\n</div>\n","app/api-reference/functions/next-request":"<h1 class=\"break-words\">NextRequest</h1> <p>NextRequest extends the <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Request API</a> with additional convenience methods.</p> <h2 id=\"cookies\" data-docs-heading=\"\">cookies     </h2> <p>Read or mutate the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Set-Cookie</code></a> header of the request.</p> <h3 id=\"setname-value\" data-docs-heading=\"\">set(name, value)     </h3> <p>Given a name, set a cookie with the given value on the request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\n// Set a cookie to hide the banner\n// request will have a `Set-Cookie:show-banner=false;path=/home` header\nrequest.cookies.set('show-banner', 'false')</pre>\n</div> <h3 id=\"getname\" data-docs-heading=\"\">get(name)     </h3> <p>Given a cookie name, return the value of the cookie. If the cookie is not found, <code>undefined</code> is returned. If multiple cookies are found, the first one is returned.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\n// { name: 'show-banner', value: 'false', Path: '/home' }\nrequest.cookies.get('show-banner')</pre>\n</div> <h3 id=\"getall\" data-docs-heading=\"\">getAll()     </h3> <p>Given a cookie name, return the values of the cookie. If no name is given, return all cookies on the request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\n// [\n//   { name: 'experiments', value: 'new-pricing-page', Path: '/home' },\n//   { name: 'experiments', value: 'winter-launch', Path: '/home' },\n// ]\nrequest.cookies.getAll('experiments')\n// Alternatively, get all cookies for the request\nrequest.cookies.getAll()</pre>\n</div> <h3 id=\"deletename\" data-docs-heading=\"\">delete(name)     </h3> <p>Given a cookie name, delete the cookie from the request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Returns true for deleted, false is nothing is deleted\nrequest.cookies.delete('experiments')</pre>\n</div> <h3 id=\"hasname\" data-docs-heading=\"\">has(name)     </h3> <p>Given a cookie name, return <code>true</code> if the cookie exists on the request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Returns true if cookie exists, false if it does not\nrequest.cookies.has('experiments')</pre>\n</div> <h3 id=\"clear\" data-docs-heading=\"\">clear()     </h3> <p>Remove the <code>Set-Cookie</code> header from the request.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">request.cookies.clear()</pre>\n</div> <h2 id=\"nexturl\" data-docs-heading=\"\">nextUrl     </h2> <p>Extends the native <a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URL</code></a> API with additional convenience methods, including Next.js specific properties.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given a request to /home, pathname is /home\nrequest.nextUrl.pathname\n// Given a request to /home?name=lee, searchParams is { 'name': 'lee' }\nrequest.nextUrl.searchParams</pre>\n</div> <p>The following options are available:</p>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Property</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>basePath</code></td>\n<td><code>string</code></td>\n<td>The <a href=\"../next-config-js/basepath\">base path</a> of the URL.</td>\n</tr>\n<tr>\n<td><code>buildId</code></td>\n<td>\n<code>string</code> | <code>undefined</code>\n</td>\n<td>The build identifier of the Next.js application. Can be <a href=\"../next-config-js/generatebuildid\">customized</a>.</td>\n</tr>\n<tr>\n<td><code>pathname</code></td>\n<td><code>string</code></td>\n<td>The pathname of the URL.</td>\n</tr>\n<tr>\n<td><code>searchParams</code></td>\n<td><code>Object</code></td>\n<td>The search parameters of the URL.</td>\n</tr>\n</tbody>\n</table></div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Note:</strong> The internationalization properties from the Pages Router are not available for usage in the App Router. Learn more about <a href=\"../../building-your-application/routing/internationalization\">internationalization with the App Router</a>.</p> </blockquote> <h2 id=\"ip\" data-docs-heading=\"\">ip     </h2> <p>The <code>ip</code> property is a string that contains the IP address of the request. This value can optionally be provided by your hosting platform.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> On <a href=\"https://vercel.com/docs/frameworks/nextjs?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, this value is provided by default. On other platforms, you can use the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Forwarded-For\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>X-Forwarded-For</code></a> header to provide the IP address.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Provided by Vercel\nrequest.ip\n// Self-hosting\nrequest.headers.get('X-Forwarded-For')</pre>\n</div> <h2 id=\"geo\" data-docs-heading=\"\">geo     </h2> <p>The <code>geo</code> property is an object that contains the geographic information of the request. This value can optionally be provided by your hosting platform.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> On <a href=\"https://vercel.com/docs/frameworks/nextjs?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, this value is provided by default. On other platforms, you can use the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Forwarded-For\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>X-Forwarded-For</code></a> header to provide the IP address, then use a <a href=\"https://ip-api.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">third-party service</a> to lookup the geographic information.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Provided by Vercel\nrequest.geo.city\nrequest.geo.country\nrequest.geo.region\nrequest.geo.latitude\nrequest.geo.longitude\n \n// Self-hosting\nfunction getGeo(request) {\n  let ip = request.headers.get('X-Forwarded-For')\n  // Use a third-party service to lookup the geographic information\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/next-request\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/next-request</a>\n  </p>\n</div>\n","app/api-reference/functions/next-response":"<h1 class=\"break-words\">NextResponse</h1> <p>NextResponse extends the <a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Response API</a> with additional convenience methods.</p> <h2 id=\"cookies\" data-docs-heading=\"\">cookies     </h2> <p>Read or mutate the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Set-Cookie</code></a> header of the response.</p> <h3 id=\"setname-value\" data-docs-heading=\"\">set(name, value)     </h3> <p>Given a name, set a cookie with the given value on the response.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\nlet response = NextResponse.next()\n// Set a cookie to hide the banner\nresponse.cookies.set('show-banner', 'false')\n// Response will have a `Set-Cookie:show-banner=false;path=/home` header\nreturn response</pre>\n</div> <h3 id=\"getname\" data-docs-heading=\"\">get(name)     </h3> <p>Given a cookie name, return the value of the cookie. If the cookie is not found, <code>undefined</code> is returned. If multiple cookies are found, the first one is returned.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\nlet response = NextResponse.next()\n// { name: 'show-banner', value: 'false', Path: '/home' }\nresponse.cookies.get('show-banner')</pre>\n</div> <h3 id=\"getall\" data-docs-heading=\"\">getAll()     </h3> <p>Given a cookie name, return the values of the cookie. If no name is given, return all cookies on the response.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\nlet response = NextResponse.next()\n// [\n//   { name: 'experiments', value: 'new-pricing-page', Path: '/home' },\n//   { name: 'experiments', value: 'winter-launch', Path: '/home' },\n// ]\nresponse.cookies.getAll('experiments')\n// Alternatively, get all cookies for the response\nresponse.cookies.getAll()</pre>\n</div> <h3 id=\"deletename\" data-docs-heading=\"\">delete(name)     </h3> <p>Given a cookie name, delete the cookie from the response.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\nlet response = NextResponse.next()\n// Returns true for deleted, false is nothing is deleted\nresponse.cookies.delete('experiments')</pre>\n</div> <h2 id=\"json\" data-docs-heading=\"\">json()     </h2> <p>Produce a response with the given JSON body.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \nexport async function GET(request: Request) {\n  return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 })\n}</pre></div>  <h2 id=\"redirect\" data-docs-heading=\"\">redirect()     </h2> <p>Produce a response that redirects to a <a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">URL</a>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \nreturn NextResponse.redirect(new URL('/new', request.url))</pre>\n</div> <p>The <a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">URL</a> can be created and modified before being used in the <code>NextResponse.redirect()</code> method. For example, you can use the <code>request.nextUrl</code> property to get the current URL, and then modify it to redirect to a different URL.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \n// Given an incoming request...\nconst loginUrl = new URL('/login', request.url)\n// Add ?from=/incoming-url to the /login URL\nloginUrl.searchParams.set('from', request.nextUrl.pathname)\n// And redirect to the new URL\nreturn NextResponse.redirect(loginUrl)</pre>\n</div> <h2 id=\"rewrite\" data-docs-heading=\"\">rewrite()     </h2> <p>Produce a response that rewrites (proxies) the given <a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">URL</a> while preserving the original URL.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \n// Incoming request: /about, browser shows /about\n// Rewritten request: /proxy, browser shows /about\nreturn NextResponse.rewrite(new URL('/proxy', request.url))</pre>\n</div> <h2 id=\"next\" data-docs-heading=\"\">next()     </h2> <p>The <code>next()</code> method is useful for Middleware, as it allows you to return early and continue routing.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \nreturn NextResponse.next()</pre>\n</div> <p>You can also forward <code>headers</code> when producing the response:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \n// Given an incoming request...\nconst newHeaders = new Headers(request.headers)\n// Add a new header\nnewHeaders.set('x-version', '123')\n// And produce a response with the new headers\nreturn NextResponse.next({\n  request: {\n    // New request headers\n    headers: newHeaders,\n  },\n})</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/next-response\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/next-response</a>\n  </p>\n</div>\n","app/api-reference/functions/permanentredirect":"<h1 class=\"break-words\">permanentRedirect</h1>\n<p>The <code>permanentRedirect</code> function allows you to redirect the user to another URL. <code>permanentRedirect</code> can be used in Server Components, Client Components, <a href=\"../../building-your-application/routing/route-handlers\">Route Handlers</a>, and <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Actions</a>.</p> <p>When used in a streaming context, this will insert a meta tag to emit the redirect on the client side. When used in a server action, it will serve a 303 HTTP redirect response to the caller. Otherwise, it will serve a 308 (Permanent) HTTP redirect response to the caller.</p> <p>If a resource doesn't exist, you can use the <a href=\"not-found\"><code>notFound</code> function</a> instead.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you prefer to return a 307 (Temporary) HTTP redirect instead of 308 (Permanent), you can use the <a href=\"redirect\"><code>redirect</code> function</a> instead.</p> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <p>The <code>permanentRedirect</code> function accepts two arguments:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">permanentRedirect(path, type)</pre>\n</div> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>path</code></td>\n<td><code>string</code></td>\n<td>The URL to redirect to. Can be a relative or absolute path.</td>\n</tr>\n<tr>\n<td><code>type</code></td>\n<td>\n<code>'replace'</code> (default) or <code>'push'</code> (default in Server Actions)</td>\n<td>The type of redirect to perform.</td>\n</tr>\n</tbody>\n</table></div> <p>By default, <code>permanentRedirect</code> will use <code>push</code> (adding a new entry to the browser history stack) in <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Actions</a> and <code>replace</code> (replacing the current URL in the browser history stack) everywhere else. You can override this behavior by specifying the <code>type</code> parameter.</p> <p>The <code>type</code> parameter has no effect when used in Server Components.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>permanentRedirect</code> does not return any value.</p> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <p>Invoking the <code>permanentRedirect()</code> function throws a <code>NEXT_REDIRECT</code> error and terminates rendering of the route segment in which it was thrown.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { permanentRedirect } from 'next/navigation'\n \nasync function fetchTeam(id) {\n  const res = await fetch('https://...')\n  if (!res.ok) return undefined\n  return res.json()\n}\n \nexport default async function Profile({ params }) {\n  const team = await fetchTeam(params.id)\n  if (!team) {\n    permanentRedirect('/login')\n  }\n \n  // ...\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>permanentRedirect</code> does not require you to use <code>return permanentRedirect()</code> as it uses the TypeScript <a href=\"https://www.typescriptlang.org/docs/handbook/2/functions.html#never\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>never</code></a> type.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/permanentRedirect\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/permanentRedirect</a>\n  </p>\n</div>\n","app/api-reference/functions/redirect":"<h1 class=\"break-words\">redirect</h1>\n<p>The <code>redirect</code> function allows you to redirect the user to another URL. <code>redirect</code> can be used in <a href=\"../../building-your-application/rendering/server-components\">Server Components</a>, <a href=\"../../building-your-application/routing/route-handlers\">Route Handlers</a>, and <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Actions</a>.</p> <p>When used in a <a href=\"../../building-your-application/routing/loading-ui-and-streaming#what-is-streaming\">streaming context</a>, this will insert a meta tag to emit the redirect on the client side. When used in a server action, it will serve a 303 HTTP redirect response to the caller. Otherwise, it will serve a 307 HTTP redirect response to the caller.</p> <p>If a resource doesn't exist, you can use the <a href=\"not-found\"><code>notFound</code> function</a> instead.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>In Server Actions and Route Handlers, <code>redirect</code> should be called after the <code>try/catch</code> block.</li> <li>If you prefer to return a 308 (Permanent) HTTP redirect instead of 307 (Temporary), you can use the <a href=\"permanentredirect\"><code>permanentRedirect</code> function</a> instead.</li> </ul> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <p>The <code>redirect</code> function accepts two arguments:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">redirect(path, type)</pre>\n</div> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>path</code></td>\n<td><code>string</code></td>\n<td>The URL to redirect to. Can be a relative or absolute path.</td>\n</tr>\n<tr>\n<td><code>type</code></td>\n<td>\n<code>'replace'</code> (default) or <code>'push'</code> (default in Server Actions)</td>\n<td>The type of redirect to perform.</td>\n</tr>\n</tbody>\n</table></div> <p>By default, <code>redirect</code> will use <code>push</code> (adding a new entry to the browser history stack) in <a href=\"../../building-your-application/data-fetching/server-actions-and-mutations\">Server Actions</a> and <code>replace</code> (replacing the current URL in the browser history stack) everywhere else. You can override this behavior by specifying the <code>type</code> parameter.</p> <p>The <code>type</code> parameter has no effect when used in Server Components.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>redirect</code> does not return any value.</p> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <h3 id=\"server-component\" data-docs-heading=\"\">Server Component     </h3> <p>Invoking the <code>redirect()</code> function throws a <code>NEXT_REDIRECT</code> error and terminates rendering of the route segment in which it was thrown.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { redirect } from 'next/navigation'\n \nasync function fetchTeam(id) {\n  const res = await fetch('https://...')\n  if (!res.ok) return undefined\n  return res.json()\n}\n \nexport default async function Profile({ params }) {\n  const team = await fetchTeam(params.id)\n  if (!team) {\n    redirect('/login')\n  }\n \n  // ...\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>redirect</code> does not require you to use <code>return redirect()</code> as it uses the TypeScript <a href=\"https://www.typescriptlang.org/docs/handbook/2/functions.html#never\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>never</code></a> type.</p> </blockquote> <h3 id=\"client-component\" data-docs-heading=\"\">Client Component     </h3> <p><code>redirect</code> can be used in a Client Component through a Server Action. If you need to use an event handler to redirect the user, you can use the <a href=\"use-router\"><code>useRouter</code></a> hook.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { navigate } from './actions'\n \nexport function ClientRedirect() {\n  return (\n    &lt;form action={navigate}&gt;\n      &lt;input type=\"text\" name=\"id\" /&gt;\n      &lt;button&gt;Submit&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use server'\n \nimport { redirect } from 'next/navigation'\n \nexport async function navigate(data: FormData) {\n  redirect(`/posts/${data.get('id')}`)\n}</pre></div>  <h2 id=\"faq\" data-docs-heading=\"\">FAQ     </h2> <h3 id=\"why-does-redirect-use-307-and-308\" data-docs-heading=\"\">Why does redirect use 307 and 308?     </h3> <p>When using <code>redirect()</code> you may notice that the status codes used are <code>307</code> for a temporary redirect, and <code>308</code> for a permanent redirect. While traditionally a <code>302</code> was used for a temporary redirect, and a <code>301</code> for a permanent redirect, many browsers changed the request method of the redirect, from a <code>POST</code> to <code>GET</code> request when using a <code>302</code>, regardless of the origins request method.</p> <p>Taking the following example of a redirect from <code>/users</code> to <code>/people</code>, if you make a <code>POST</code> request to <code>/users</code> to create a new user, and are conforming to a <code>302</code> temporary redirect, the request method will be changed from a <code>POST</code> to a <code>GET</code> request. This doesn't make sense, as to create a new user, you should be making a <code>POST</code> request to <code>/people</code>, and not a <code>GET</code> request.</p> <p>The introduction of the <code>307</code> status code means that the request method is preserved as <code>POST</code>.</p> <ul> <li>\n<code>302</code> - Temporary redirect, will change the request method from <code>POST</code> to <code>GET</code>\n</li> <li>\n<code>307</code> - Temporary redirect, will preserve the request method as <code>POST</code>\n</li> </ul> <p>The <code>redirect()</code> method uses a <code>307</code> by default, instead of a <code>302</code> temporary redirect, meaning your requests will <em>always</em> be preserved as <code>POST</code> requests.</p> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Redirections\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Learn more</a> about HTTP Redirects.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>redirect</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/redirect\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/redirect</a>\n  </p>\n</div>\n","app/api-reference/functions/unstable_cache":"<h1 class=\"break-words\">unstable_cache</h1>\n<p><code>unstable_cache</code> allows you to cache the results of expensive operations, like database queries, and reuse them across multiple requests.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getUser } from './data';\nimport { unstable_cache } from 'next/cache';\n \nconst getCachedUser = unstable_cache(\n  async (id) =&gt; getUser(id),\n  ['my-app-user']\n);\n \nexport default async function Component({ userID }) {\n  const user = await getCachedUser(userID);\n  ...\n}</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Accessing dynamic data sources such as <code>headers</code> or <code>cookies</code> inside a cache scope is not supported. If you need this data inside a cached function use <code>headers</code> outside of the cached function and pass the required dynamic data in as an argument.</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: This API is unstable and may change in the future. We will provide migration documentation and codemods, if needed, as this API stabilizes.</p> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const data = unstable_cache(fetchData, keyParts, options)()</pre>\n</div> <ul> <li>\n<code>fetchData</code>: This is an asynchronous function that fetches the data you want to cache. It must be a function that returns a <code>Promise</code>.</li> <li>\n<code>keyParts</code>: This is an array that identifies the cached key. It must contain globally unique values that together identify the key of the data being cached. The cache key also includes the arguments passed to the function.</li> <li>\n<code>options</code>: This is an object that controls how the cache behaves. It can contain the following properties: <ul> <li>\n<code>tags</code>: An array of tags that can be used to control cache invalidation.</li> <li>\n<code>revalidate</code>: The number of seconds after which the cache should be revalidated. Omit or pass <code>false</code> to cache indefinitely or until matching <code>revalidateTag()</code> or <code>revalidatePath()</code> methods are called.</li> </ul> </li> </ul> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>unstable_cache</code> returns a function that when invoked, returns a Promise that resolves to the cached data. If the data is not in the cache, the provided function will be invoked, and its result will be cached and returned.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v14.0.0</code></td>\n<td>\n<code>unstable_cache</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/unstable_cache\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/unstable_cache</a>\n  </p>\n</div>\n","app/api-reference/functions/use-params":"<h1 class=\"break-words\">useParams</h1>\n<p><code>useParams</code> is a <strong>Client Component</strong> hook that lets you read a route's <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic params</a> filled in by the current URL.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useParams } from 'next/navigation'\n \nexport default function ExampleClientComponent() {\n  const params = useParams&lt;{ tag: string; item: string }&gt;()\n \n  // Route -&gt; /shop/[tag]/[item]\n  // URL -&gt; /shop/shoes/nike-air-max-97\n  // `params` -&gt; { tag: 'shoes', item: 'nike-air-max-97' }\n  console.log(params)\n \n  return &lt;&gt;&lt;/&gt;\n}</pre></div>  <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const params = useParams()</pre>\n</div> <p><code>useParams</code> does not take any parameters.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>useParams</code> returns an object containing the current route's filled in <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic parameters</a>.</p> <ul> <li>Each property in the object is an active dynamic segment.</li> <li>The properties name is the segment's name, and the properties value is what the segment is filled in with.</li> <li>The properties value will either be a <code>string</code> or array of <code>string</code>'s depending on the <a href=\"../../building-your-application/routing/dynamic-routes\">type of dynamic segment</a>.</li> <li>If the route contains no dynamic parameters, <code>useParams</code> returns an empty object.</li> <li>If used in Pages Router, <code>useParams</code> will return <code>null</code> on the initial render and updates with properties following the rules above once the router is ready.</li> </ul> <p>For example:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>URL</th>\n<th><code>useParams()</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/shop/page.js</code></td>\n<td><code>/shop</code></td>\n<td><code>{}</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[slug]/page.js</code></td>\n<td><code>/shop/1</code></td>\n<td><code>{ slug: '1' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[tag]/[item]/page.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ tag: '1', item: '2' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/page.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ slug: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>useParams</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-params\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/use-params</a>\n  </p>\n</div>\n","app/api-reference/functions/generate-metadata":"<h1 class=\"break-words\">Metadata Object and generateMetadata Options</h1>\n<p>This page covers all <strong>Config-based Metadata</strong> options with <code>generateMetadata</code> and the static metadata object.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \n// either Static metadata\nexport const metadata: Metadata = {\n  title: '...',\n}\n \n// or Dynamic metadata\nexport async function generateMetadata({ params }) {\n  return {\n    title: '...',\n  }\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>The <code>metadata</code> object and <code>generateMetadata</code> function exports are <strong>only supported in Server Components</strong>.</li> <li>You cannot export both the <code>metadata</code> object and <code>generateMetadata</code> function from the same route segment.</li> </ul> </blockquote> <h2 id=\"the-metadata-object\" data-docs-heading=\"\">The metadata object     </h2> <p>To define static metadata, export a <a href=\"#metadata-fields\"><code>Metadata</code> object</a> from a <code>layout.js</code> or <code>page.js</code> file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: '...',\n  description: '...',\n}\n \nexport default function Page() {}</pre></div>  <p>See the <a href=\"#metadata-fields\">Metadata Fields</a> for a complete list of supported options.</p> <h2 id=\"generatemetadata-function\" data-docs-heading=\"\">generateMetadata function     </h2> <p>Dynamic metadata depends on <strong>dynamic information</strong>, such as the current route parameters, external data, or <code>metadata</code> in parent segments, can be set by exporting a <code>generateMetadata</code> function that returns a <a href=\"#metadata-fields\"><code>Metadata</code> object</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata, ResolvingMetadata } from 'next'\n \ntype Props = {\n  params: { id: string }\n  searchParams: { [key: string]: string | string[] | undefined }\n}\n \nexport async function generateMetadata(\n  { params, searchParams }: Props,\n  parent: ResolvingMetadata\n): Promise&lt;Metadata&gt; {\n  // read route params\n  const id = params.id\n \n  // fetch data\n  const product = await fetch(`https://.../${id}`).then((res) =&gt; res.json())\n \n  // optionally access and extend (rather than replace) parent metadata\n  const previousImages = (await parent).openGraph?.images || []\n \n  return {\n    title: product.title,\n    openGraph: {\n      images: ['/some-specific-page-image.jpg', ...previousImages],\n    },\n  }\n}\n \nexport default function Page({ params, searchParams }: Props) {}</pre></div>  <h3 id=\"parameters\" data-docs-heading=\"\">Parameters     </h3> <p><code>generateMetadata</code> function accepts the following parameters:</p> <ul> <li> <p><code>props</code> - An object containing the parameters of the current route:</p> <ul> <li> <p><code>params</code> - An object containing the <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route parameters</a> object from the root segment down to the segment <code>generateMetadata</code> is called from. Examples:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/shop/[slug]/page.js</code></td>\n<td><code>/shop/1</code></td>\n<td><code>{ slug: '1' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[tag]/[item]/page.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ tag: '1', item: '2' }</code></td>\n</tr>\n<tr>\n<td><code>app/shop/[...slug]/page.js</code></td>\n<td><code>/shop/1/2</code></td>\n<td><code>{ slug: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> </li> <li> <p><code>searchParams</code> - An object containing the current URL's <a href=\"https://developer.mozilla.org/docs/Learn/Common_questions/What_is_a_URL#parameters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">search params</a>. Examples:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>URL</th>\n<th><code>searchParams</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>/shop?a=1</code></td>\n<td><code>{ a: '1' }</code></td>\n</tr>\n<tr>\n<td><code>/shop?a=1&amp;b=2</code></td>\n<td><code>{ a: '1', b: '2' }</code></td>\n</tr>\n<tr>\n<td><code>/shop?a=1&amp;a=2</code></td>\n<td><code>{ a: ['1', '2'] }</code></td>\n</tr>\n</tbody>\n</table></div> </li> </ul> </li> <li> <p><code>parent</code> - A promise of the resolved metadata from parent route segments.</p> </li> </ul> <h3 id=\"returns\" data-docs-heading=\"\">Returns     </h3> <p><code>generateMetadata</code> should return a <a href=\"#metadata-fields\"><code>Metadata</code> object</a> containing one or more metadata fields.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If metadata doesn't depend on runtime information, it should be defined using the static <a href=\"#the-metadata-object\"><code>metadata</code> object</a> rather than <code>generateMetadata</code>.</li> <li>\n<code>fetch</code> requests are automatically <a href=\"../../building-your-application/caching#request-memoization\">memoized</a> for the same data across <code>generateMetadata</code>, <code>generateStaticParams</code>, Layouts, Pages, and Server Components. React <a href=\"../../building-your-application/caching#request-memoization\"><code>cache</code> can be used</a> if <code>fetch</code> is unavailable.</li> <li>\n<code>searchParams</code> are only available in <code>page.js</code> segments.</li> <li>The <a href=\"redirect\"><code>redirect()</code></a> and <a href=\"not-found\"><code>notFound()</code></a> Next.js methods can also be used inside <code>generateMetadata</code>.</li> </ul> </blockquote> <h2 id=\"metadata-fields\" data-docs-heading=\"\">Metadata Fields     </h2> <h3 id=\"title\" data-docs-heading=\"\">title     </h3> <p>The <code>title</code> attribute is used to set the title of the document. It can be defined as a simple <a href=\"#string\">string</a> or an optional <a href=\"#template-object\">template object</a>.</p> <h4 id=\"string\" data-docs-heading=\"\">String     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'Next.js',\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;title&gt;Next.js&lt;/title&gt;</pre></div> <h4 id=\"template-object\" data-docs-heading=\"\">Template object     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: {\n    template: '...',\n    default: '...',\n    absolute: '...',\n  },\n}</pre></div>  <h5 id=\"default\" data-docs-heading=\"\"><a href=\"#default\">Default</a></h5> <p><code>title.default</code> can be used to provide a <strong>fallback title</strong> to child route segments that don't define a <code>title</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: {\n    default: 'Acme',\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {}\n \n// Output: &lt;title&gt;Acme&lt;/title&gt;</pre></div> <h5 id=\"template\" data-docs-heading=\"\"><a href=\"#template\">Template</a></h5> <p><code>title.template</code> can be used to add a prefix or a suffix to <code>titles</code> defined in <strong>child</strong> route segments.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: {\n    template: '%s | Acme',\n    default: 'Acme', // a default is required when creating a template\n  },\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'About',\n}\n \n// Output: &lt;title&gt;About | Acme&lt;/title&gt;</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li> <p><code>title.template</code> applies to <strong>child</strong> route segments and <strong>not</strong> the segment it's defined in. This means:</p> <ul> <li>\n<code>title.default</code> is <strong>required</strong> when you add a <code>title.template</code>.</li> <li>\n<code>title.template</code> defined in <code>layout.js</code> will not apply to a <code>title</code> defined in a <code>page.js</code> of the same route segment.</li> <li>\n<code>title.template</code> defined in <code>page.js</code> has no effect because a page is always the terminating segment (it doesn't have any children route segments).</li> </ul> </li> <li> <p><code>title.template</code> has <strong>no effect</strong> if a route has not defined a <code>title</code> or <code>title.default</code>.</p> </li> </ul> </blockquote> <h5 id=\"absolute\" data-docs-heading=\"\"><a href=\"#absolute\">Absolute</a></h5> <p><code>title.absolute</code> can be used to provide a title that <strong>ignores</strong> <code>title.template</code> set in parent segments.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: {\n    template: '%s | Acme',\n  },\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: {\n    absolute: 'About',\n  },\n}\n \n// Output: &lt;title&gt;About&lt;/title&gt;</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li> <p><code>layout.js</code></p> <ul> <li>\n<code>title</code> (string) and <code>title.default</code> define the default title for child segments (that do not define their own <code>title</code>). It will augment <code>title.template</code> from the closest parent segment if it exists.</li> <li>\n<code>title.absolute</code> defines the default title for child segments. It ignores <code>title.template</code> from parent segments.</li> <li>\n<code>title.template</code> defines a new title template for child segments.</li> </ul> </li> <li> <p><code>page.js</code></p> <ul> <li>If a page does not define its own title the closest parents resolved title will be used.</li> <li>\n<code>title</code> (string) defines the routes title. It will augment <code>title.template</code> from the closest parent segment if it exists.</li> <li>\n<code>title.absolute</code> defines the route title. It ignores <code>title.template</code> from parent segments.</li> <li>\n<code>title.template</code> has no effect in <code>page.js</code> because a page is always the terminating segment of a route.</li> </ul> </li> </ul> </blockquote> <h3 id=\"description\" data-docs-heading=\"\">description     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  description: 'The React Framework for the Web',\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"description\" content=\"The React Framework for the Web\" /&gt;</pre></div> <h3 id=\"basic-fields\" data-docs-heading=\"\">Basic Fields     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  generator: 'Next.js',\n  applicationName: 'Next.js',\n  referrer: 'origin-when-cross-origin',\n  keywords: ['Next.js', 'React', 'JavaScript'],\n  authors: [{ name: 'Seb' }, { name: 'Josh', url: 'https://nextjs.org' }],\n  creator: 'Jiachi Liu',\n  publisher: 'Sebastian Markbge',\n  formatDetection: {\n    email: false,\n    address: false,\n    telephone: false,\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"application-name\" content=\"Next.js\" /&gt;\n&lt;meta name=\"author\" content=\"Seb\" /&gt;\n&lt;link rel=\"author\" href=\"https://nextjs.org\" /&gt;\n&lt;meta name=\"author\" content=\"Josh\" /&gt;\n&lt;meta name=\"generator\" content=\"Next.js\" /&gt;\n&lt;meta name=\"keywords\" content=\"Next.js,React,JavaScript\" /&gt;\n&lt;meta name=\"referrer\" content=\"origin-when-cross-origin\" /&gt;\n&lt;meta name=\"color-scheme\" content=\"dark\" /&gt;\n&lt;meta name=\"creator\" content=\"Jiachi Liu\" /&gt;\n&lt;meta name=\"publisher\" content=\"Sebastian Markbge\" /&gt;\n&lt;meta name=\"format-detection\" content=\"telephone=no, address=no, email=no\" /&gt;</pre></div> <h3 id=\"metadatabase\" data-docs-heading=\"\">metadataBase     </h3> <p><code>metadataBase</code> is a convenience option to set a base URL prefix for <code>metadata</code> fields that require a fully qualified URL.</p> <ul> <li>\n<code>metadataBase</code> allows URL-based <code>metadata</code> fields defined in the <strong>current route segment and below</strong> to use a <strong>relative path</strong> instead of an otherwise required absolute URL.</li> <li>The field's relative path will be composed with <code>metadataBase</code> to form a fully qualified URL.</li> <li>If not configured, <code>metadataBase</code> is <strong>automatically populated</strong> with a <a href=\"#default-value\">default value</a>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  metadataBase: new URL('https://acme.com'),\n  alternates: {\n    canonical: '/',\n    languages: {\n      'en-US': '/en-US',\n      'de-DE': '/de-DE',\n    },\n  },\n  openGraph: {\n    images: '/og-image.png',\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"canonical\" href=\"https://acme.com\" /&gt;\n&lt;link rel=\"alternate\" hreflang=\"en-US\" href=\"https://acme.com/en-US\" /&gt;\n&lt;link rel=\"alternate\" hreflang=\"de-DE\" href=\"https://acme.com/de-DE\" /&gt;\n&lt;meta property=\"og:image\" content=\"https://acme.com/og-image.png\" /&gt;</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>metadataBase</code> is typically set in root <code>app/layout.js</code> to apply to URL-based <code>metadata</code> fields across all routes.</li> <li>All URL-based <code>metadata</code> fields that require absolute URLs can be configured with a <code>metadataBase</code> option.</li> <li>\n<code>metadataBase</code> can contain a subdomain e.g. <code>https://app.acme.com</code> or base path e.g. <code>https://acme.com/start/from/here</code>\n</li> <li>If a <code>metadata</code> field provides an absolute URL, <code>metadataBase</code> will be ignored.</li> <li>Using a relative path in a URL-based <code>metadata</code> field without configuring a <code>metadataBase</code> will cause a build error.</li> <li>Next.js will normalize duplicate slashes between <code>metadataBase</code> (e.g. <code>https://acme.com/</code>) and a relative field (e.g. <code>/path</code>) to a single slash (e.g. <code>https://acme.com/path</code>)</li> </ul> </blockquote> <h4 id=\"default-value\" data-docs-heading=\"\">Default value     </h4> <p>If not configured, <code>metadataBase</code> has a <strong>default value</strong></p> <ul> <li>When <a href=\"https://vercel.com/docs/concepts/projects/environment-variables/system-environment-variables#:~:text=.-,VERCEL_URL,-The%20domain%20name\" rel=\"noopener noreferrer\" target=\"_blank\"><code>VERCEL_URL</code></a> is detected: <code>https://${process.env.VERCEL_URL}</code> otherwise it falls back to <code>http://localhost:${process.env.PORT || 3000}</code>.</li> <li>When overriding the default, we recommend using environment variables to compute the URL. This allows configuring a URL for local development, staging, and production environments.</li> </ul> <h4 id=\"url-composition\" data-docs-heading=\"\">URL Composition     </h4> <p>URL composition favors developer intent over default directory traversal semantics.</p> <ul> <li>Trailing slashes between <code>metadataBase</code> and <code>metadata</code> fields are normalized.</li> <li>An \"absolute\" path in a <code>metadata</code> field (that typically would replace the whole URL path) is treated as a \"relative\" path (starting from the end of <code>metadataBase</code>).</li> </ul> <p>For example, given the following <code>metadataBase</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  metadataBase: new URL('https://acme.com'),\n}</pre></div>  <p>Any <code>metadata</code> fields that inherit the above <code>metadataBase</code> and set their own value will be resolved as follows:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>\n<code>metadata</code> field</th>\n<th>Resolved URL</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>/</code></td>\n<td><code>https://acme.com</code></td>\n</tr>\n<tr>\n<td><code>./</code></td>\n<td><code>https://acme.com</code></td>\n</tr>\n<tr>\n<td><code>payments</code></td>\n<td><code>https://acme.com/payments</code></td>\n</tr>\n<tr>\n<td><code>/payments</code></td>\n<td><code>https://acme.com/payments</code></td>\n</tr>\n<tr>\n<td><code>./payments</code></td>\n<td><code>https://acme.com/payments</code></td>\n</tr>\n<tr>\n<td><code>../payments</code></td>\n<td><code>https://acme.com/payments</code></td>\n</tr>\n<tr>\n<td><code>https://beta.acme.com/payments</code></td>\n<td><code>https://beta.acme.com/payments</code></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"opengraph\" data-docs-heading=\"\">openGraph     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  openGraph: {\n    title: 'Next.js',\n    description: 'The React Framework for the Web',\n    url: 'https://nextjs.org',\n    siteName: 'Next.js',\n    images: [\n      {\n        url: 'https://nextjs.org/og.png', // Must be an absolute URL\n        width: 800,\n        height: 600,\n      },\n      {\n        url: 'https://nextjs.org/og-alt.png', // Must be an absolute URL\n        width: 1800,\n        height: 1600,\n        alt: 'My custom alt',\n      },\n    ],\n    locale: 'en_US',\n    type: 'website',\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"og:title\" content=\"Next.js\" /&gt;\n&lt;meta property=\"og:description\" content=\"The React Framework for the Web\" /&gt;\n&lt;meta property=\"og:url\" content=\"https://nextjs.org/\" /&gt;\n&lt;meta property=\"og:site_name\" content=\"Next.js\" /&gt;\n&lt;meta property=\"og:locale\" content=\"en_US\" /&gt;\n&lt;meta property=\"og:image:url\" content=\"https://nextjs.org/og.png\" /&gt;\n&lt;meta property=\"og:image:width\" content=\"800\" /&gt;\n&lt;meta property=\"og:image:height\" content=\"600\" /&gt;\n&lt;meta property=\"og:image:url\" content=\"https://nextjs.org/og-alt.png\" /&gt;\n&lt;meta property=\"og:image:width\" content=\"1800\" /&gt;\n&lt;meta property=\"og:image:height\" content=\"1600\" /&gt;\n&lt;meta property=\"og:image:alt\" content=\"My custom alt\" /&gt;\n&lt;meta property=\"og:type\" content=\"website\" /&gt;</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  openGraph: {\n    title: 'Next.js',\n    description: 'The React Framework for the Web',\n    type: 'article',\n    publishedTime: '2023-01-01T00:00:00.000Z',\n    authors: ['Seb', 'Josh'],\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"og:title\" content=\"Next.js\" /&gt;\n&lt;meta property=\"og:description\" content=\"The React Framework for the Web\" /&gt;\n&lt;meta property=\"og:type\" content=\"article\" /&gt;\n&lt;meta property=\"article:published_time\" content=\"2023-01-01T00:00:00.000Z\" /&gt;\n&lt;meta property=\"article:author\" content=\"Seb\" /&gt;\n&lt;meta property=\"article:author\" content=\"Josh\" /&gt;</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>It may be more convenient to use the <a href=\"../file-conventions/metadata/opengraph-image#image-files-jpg-png-gif\">file-based Metadata API</a> for Open Graph images. Rather than having to sync the config export with actual files, the file-based API will automatically generate the correct metadata for you.</li> </ul> </blockquote> <h3 id=\"robots\" data-docs-heading=\"\">robots     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  robots: {\n    index: false,\n    follow: true,\n    nocache: true,\n    googleBot: {\n      index: true,\n      follow: false,\n      noimageindex: true,\n      'max-video-preview': -1,\n      'max-image-preview': 'large',\n      'max-snippet': -1,\n    },\n  },\n}</pre>\n</div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"robots\" content=\"noindex, follow, nocache\" /&gt;\n&lt;meta\n  name=\"googlebot\"\n  content=\"index, nofollow, noimageindex, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"\n/&gt;</pre></div> <h3 id=\"icons\" data-docs-heading=\"\">icons     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: We recommend using the <a href=\"../file-conventions/metadata/app-icons#image-files-ico-jpg-png\">file-based Metadata API</a> for icons where possible. Rather than having to sync the config export with actual files, the file-based API will automatically generate the correct metadata for you.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  icons: {\n    icon: '/icon.png',\n    shortcut: '/shortcut-icon.png',\n    apple: '/apple-icon.png',\n    other: {\n      rel: 'apple-touch-icon-precomposed',\n      url: '/apple-touch-icon-precomposed.png',\n    },\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"shortcut icon\" href=\"/shortcut-icon.png\" /&gt;\n&lt;link rel=\"icon\" href=\"/icon.png\" /&gt;\n&lt;link rel=\"apple-touch-icon\" href=\"/apple-icon.png\" /&gt;\n&lt;link\n  rel=\"apple-touch-icon-precomposed\"\n  href=\"/apple-touch-icon-precomposed.png\"\n/&gt;</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  icons: {\n    icon: [\n      { url: '/icon.png' },\n      new URL('/icon.png', 'https://example.com'),\n      { url: '/icon-dark.png', media: '(prefers-color-scheme: dark)' },\n    ],\n    shortcut: ['/shortcut-icon.png'],\n    apple: [\n      { url: '/apple-icon.png' },\n      { url: '/apple-icon-x3.png', sizes: '180x180', type: 'image/png' },\n    ],\n    other: [\n      {\n        rel: 'apple-touch-icon-precomposed',\n        url: '/apple-touch-icon-precomposed.png',\n      },\n    ],\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"shortcut icon\" href=\"/shortcut-icon.png\" /&gt;\n&lt;link rel=\"icon\" href=\"/icon.png\" /&gt;\n&lt;link rel=\"icon\" href=\"https://example.com/icon.png\" /&gt;\n&lt;link rel=\"icon\" href=\"/icon-dark.png\" media=\"(prefers-color-scheme: dark)\" /&gt;\n&lt;link rel=\"apple-touch-icon\" href=\"/apple-icon.png\" /&gt;\n&lt;link\n  rel=\"apple-touch-icon-precomposed\"\n  href=\"/apple-touch-icon-precomposed.png\"\n/&gt;\n&lt;link\n  rel=\"apple-touch-icon\"\n  href=\"/apple-icon-x3.png\"\n  sizes=\"180x180\"\n  type=\"image/png\"\n/&gt;</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The <code>msapplication-*</code> meta tags are no longer supported in Chromium builds of Microsoft Edge, and thus no longer needed.</p> </blockquote> <h3 id=\"themecolor\" data-docs-heading=\"\">themeColor     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Deprecated</strong>: The <code>themeColor</code> option in <code>metadata</code> is deprecated as of Next.js 14. Please use the <a href=\"generate-viewport\"><code>viewport</code> configuration</a> instead.</p> </blockquote> <h3 id=\"manifest\" data-docs-heading=\"\">manifest     </h3> <p>A web application manifest, as defined in the <a href=\"https://developer.mozilla.org/docs/Web/Manifest\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Application Manifest specification</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  manifest: 'https://nextjs.org/manifest.json',\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"manifest\" href=\"https://nextjs.org/manifest.json\" /&gt;</pre></div> <h3 id=\"twitter\" data-docs-heading=\"\">twitter     </h3> <p>The Twitter specification is (surprisingly) used for more than just X (formerly known as Twitter).</p> <p>Learn more about the <a href=\"https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/markup\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Twitter Card markup reference</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  twitter: {\n    card: 'summary_large_image',\n    title: 'Next.js',\n    description: 'The React Framework for the Web',\n    siteId: '1467726470533754880',\n    creator: '@nextjs',\n    creatorId: '1467726470533754880',\n    images: ['https://nextjs.org/og.png'], // Must be an absolute URL\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"twitter:card\" content=\"summary_large_image\" /&gt;\n&lt;meta name=\"twitter:site:id\" content=\"1467726470533754880\" /&gt;\n&lt;meta name=\"twitter:creator\" content=\"@nextjs\" /&gt;\n&lt;meta name=\"twitter:creator:id\" content=\"1467726470533754880\" /&gt;\n&lt;meta name=\"twitter:title\" content=\"Next.js\" /&gt;\n&lt;meta name=\"twitter:description\" content=\"The React Framework for the Web\" /&gt;\n&lt;meta name=\"twitter:image\" content=\"https://nextjs.org/og.png\" /&gt;</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  twitter: {\n    card: 'app',\n    title: 'Next.js',\n    description: 'The React Framework for the Web',\n    siteId: '1467726470533754880',\n    creator: '@nextjs',\n    creatorId: '1467726470533754880',\n    images: {\n      url: 'https://nextjs.org/og.png',\n      alt: 'Next.js Logo',\n    },\n    app: {\n      name: 'twitter_app',\n      id: {\n        iphone: 'twitter_app://iphone',\n        ipad: 'twitter_app://ipad',\n        googleplay: 'twitter_app://googleplay',\n      },\n      url: {\n        iphone: 'https://iphone_url',\n        ipad: 'https://ipad_url',\n      },\n    },\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"twitter:site:id\" content=\"1467726470533754880\" /&gt;\n&lt;meta name=\"twitter:creator\" content=\"@nextjs\" /&gt;\n&lt;meta name=\"twitter:creator:id\" content=\"1467726470533754880\" /&gt;\n&lt;meta name=\"twitter:title\" content=\"Next.js\" /&gt;\n&lt;meta name=\"twitter:description\" content=\"The React Framework for the Web\" /&gt;\n&lt;meta name=\"twitter:card\" content=\"app\" /&gt;\n&lt;meta name=\"twitter:image\" content=\"https://nextjs.org/og.png\" /&gt;\n&lt;meta name=\"twitter:image:alt\" content=\"Next.js Logo\" /&gt;\n&lt;meta name=\"twitter:app:name:iphone\" content=\"twitter_app\" /&gt;\n&lt;meta name=\"twitter:app:id:iphone\" content=\"twitter_app://iphone\" /&gt;\n&lt;meta name=\"twitter:app:id:ipad\" content=\"twitter_app://ipad\" /&gt;\n&lt;meta name=\"twitter:app:id:googleplay\" content=\"twitter_app://googleplay\" /&gt;\n&lt;meta name=\"twitter:app:url:iphone\" content=\"https://iphone_url\" /&gt;\n&lt;meta name=\"twitter:app:url:ipad\" content=\"https://ipad_url\" /&gt;\n&lt;meta name=\"twitter:app:name:ipad\" content=\"twitter_app\" /&gt;\n&lt;meta name=\"twitter:app:name:googleplay\" content=\"twitter_app\" /&gt;</pre></div> <h3 id=\"viewport\" data-docs-heading=\"\">viewport     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Deprecated</strong>: The <code>viewport</code> option in <code>metadata</code> is deprecated as of Next.js 14. Please use the <a href=\"generate-viewport\"><code>viewport</code> configuration</a> instead.</p> </blockquote> <h3 id=\"verification\" data-docs-heading=\"\">verification     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  verification: {\n    google: 'google',\n    yandex: 'yandex',\n    yahoo: 'yahoo',\n    other: {\n      me: ['my-email', 'my-link'],\n    },\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"google-site-verification\" content=\"google\" /&gt;\n&lt;meta name=\"y_key\" content=\"yahoo\" /&gt;\n&lt;meta name=\"yandex-verification\" content=\"yandex\" /&gt;\n&lt;meta name=\"me\" content=\"my-email\" /&gt;\n&lt;meta name=\"me\" content=\"my-link\" /&gt;</pre></div> <h3 id=\"applewebapp\" data-docs-heading=\"\">appleWebApp     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  itunes: {\n    appId: 'myAppStoreID',\n    appArgument: 'myAppArgument',\n  },\n  appleWebApp: {\n    title: 'Apple Web App',\n    statusBarStyle: 'black-translucent',\n    startupImage: [\n      '/assets/startup/apple-touch-startup-image-768x1004.png',\n      {\n        url: '/assets/startup/apple-touch-startup-image-1536x2008.png',\n        media: '(device-width: 768px) and (device-height: 1024px)',\n      },\n    ],\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta\n  name=\"apple-itunes-app\"\n  content=\"app-id=myAppStoreID, app-argument=myAppArgument\"\n/&gt;\n&lt;meta name=\"apple-mobile-web-app-capable\" content=\"yes\" /&gt;\n&lt;meta name=\"apple-mobile-web-app-title\" content=\"Apple Web App\" /&gt;\n&lt;link\n  href=\"/assets/startup/apple-touch-startup-image-768x1004.png\"\n  rel=\"apple-touch-startup-image\"\n/&gt;\n&lt;link\n  href=\"/assets/startup/apple-touch-startup-image-1536x2008.png\"\n  media=\"(device-width: 768px) and (device-height: 1024px)\"\n  rel=\"apple-touch-startup-image\"\n/&gt;\n&lt;meta\n  name=\"apple-mobile-web-app-status-bar-style\"\n  content=\"black-translucent\"\n/&gt;</pre></div> <h3 id=\"alternates\" data-docs-heading=\"\">alternates     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  alternates: {\n    canonical: 'https://nextjs.org',\n    languages: {\n      'en-US': 'https://nextjs.org/en-US',\n      'de-DE': 'https://nextjs.org/de-DE',\n    },\n    media: {\n      'only screen and (max-width: 600px)': 'https://nextjs.org/mobile',\n    },\n    types: {\n      'application/rss+xml': 'https://nextjs.org/rss',\n    },\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"canonical\" href=\"https://nextjs.org\" /&gt;\n&lt;link rel=\"alternate\" hreflang=\"en-US\" href=\"https://nextjs.org/en-US\" /&gt;\n&lt;link rel=\"alternate\" hreflang=\"de-DE\" href=\"https://nextjs.org/de-DE\" /&gt;\n&lt;link\n  rel=\"alternate\"\n  media=\"only screen and (max-width: 600px)\"\n  href=\"https://nextjs.org/mobile\"\n/&gt;\n&lt;link\n  rel=\"alternate\"\n  type=\"application/rss+xml\"\n  href=\"https://nextjs.org/rss\"\n/&gt;</pre></div> <h3 id=\"applinks\" data-docs-heading=\"\">appLinks     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  appLinks: {\n    ios: {\n      url: 'https://nextjs.org/ios',\n      app_store_id: 'app_store_id',\n    },\n    android: {\n      package: 'com.example.android/package',\n      app_name: 'app_name_android',\n    },\n    web: {\n      url: 'https://nextjs.org/web',\n      should_fallback: true,\n    },\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta property=\"al:ios:url\" content=\"https://nextjs.org/ios\" /&gt;\n&lt;meta property=\"al:ios:app_store_id\" content=\"app_store_id\" /&gt;\n&lt;meta property=\"al:android:package\" content=\"com.example.android/package\" /&gt;\n&lt;meta property=\"al:android:app_name\" content=\"app_name_android\" /&gt;\n&lt;meta property=\"al:web:url\" content=\"https://nextjs.org/web\" /&gt;\n&lt;meta property=\"al:web:should_fallback\" content=\"true\" /&gt;</pre></div> <h3 id=\"archives\" data-docs-heading=\"\">archives     </h3> <p>Describes a collection of records, documents, or other materials of historical interest (<a href=\"https://www.w3.org/TR/2011/WD-html5-20110113/links.html#rel-archives\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">source</a>).</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  archives: ['https://nextjs.org/13'],\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"archives\" href=\"https://nextjs.org/13\" /&gt;</pre></div> <h3 id=\"assets\" data-docs-heading=\"\">assets     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  assets: ['https://nextjs.org/assets'],\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"assets\" href=\"https://nextjs.org/assets\" /&gt;</pre></div> <h3 id=\"bookmarks\" data-docs-heading=\"\">bookmarks     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  bookmarks: ['https://nextjs.org/13'],\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"bookmarks\" href=\"https://nextjs.org/13\" /&gt;</pre></div> <h3 id=\"category\" data-docs-heading=\"\">category     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  category: 'technology',\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"category\" content=\"technology\" /&gt;</pre></div> <h3 id=\"other\" data-docs-heading=\"\">other     </h3> <p>All metadata options should be covered using the built-in support. However, there may be custom metadata tags specific to your site, or brand new metadata tags just released. You can use the <code>other</code> option to render any custom metadata tag.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  other: {\n    custom: 'meta',\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"custom\" content=\"meta\" /&gt;</pre></div> <p>If you want to generate multiple same key meta tags you can use array value.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  other: {\n    custom: ['meta1', 'meta2'],\n  },\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"custom\" content=\"meta1\" /&gt; &lt;meta name=\"custom\" content=\"meta2\" /&gt;</pre></div> <h2 id=\"unsupported-metadata\" data-docs-heading=\"\">Unsupported Metadata     </h2> <p>The following metadata types do not currently have built-in support. However, they can still be rendered in the layout or page itself.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Metadata</th>\n<th>Recommendation</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>&lt;meta http-equiv=\"...\"&gt;</code></td>\n<td>Use appropriate HTTP Headers via <a href=\"redirect\"><code>redirect()</code></a>, <a href=\"../../building-your-application/routing/middleware#nextresponse\">Middleware</a>, <a href=\"../next-config-js/headers\">Security Headers</a>\n</td>\n</tr>\n<tr>\n<td><code>&lt;base&gt;</code></td>\n<td>Render the tag in the layout or page itself.</td>\n</tr>\n<tr>\n<td><code>&lt;noscript&gt;</code></td>\n<td>Render the tag in the layout or page itself.</td>\n</tr>\n<tr>\n<td><code>&lt;style&gt;</code></td>\n<td>Learn more about <a href=\"../../building-your-application/styling/css-modules\">styling in Next.js</a>.</td>\n</tr>\n<tr>\n<td><code>&lt;script&gt;</code></td>\n<td>Learn more about <a href=\"../../building-your-application/optimizing/scripts\">using scripts</a>.</td>\n</tr>\n<tr>\n<td><code>&lt;link rel=\"stylesheet\" /&gt;</code></td>\n<td>\n<code>import</code> stylesheets directly in the layout or page itself.</td>\n</tr>\n<tr>\n<td><code>&lt;link rel=\"preload /&gt;</code></td>\n<td>Use <a href=\"#link-relpreload\">ReactDOM preload method</a>\n</td>\n</tr>\n<tr>\n<td><code>&lt;link rel=\"preconnect\" /&gt;</code></td>\n<td>Use <a href=\"#link-relpreconnect\">ReactDOM preconnect method</a>\n</td>\n</tr>\n<tr>\n<td><code>&lt;link rel=\"dns-prefetch\" /&gt;</code></td>\n<td>Use <a href=\"#link-reldns-prefetch\">ReactDOM prefetchDNS method</a>\n</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"resource-hints\" data-docs-heading=\"\">Resource hints     </h3> <p>The <code>&lt;link&gt;</code> element has a number of <code>rel</code> keywords that can be used to hint to the browser that an external resource is likely to be needed. The browser uses this information to apply preloading optimizations depending on the keyword.</p> <p>While the Metadata API doesn't directly support these hints, you can use new <a href=\"https://github.com/facebook/react/pull/26237\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReactDOM</code> methods</a> to safely insert them into the <code>&lt;head&gt;</code> of the document.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport ReactDOM from 'react-dom'\n \nexport function PreloadResources() {\n  ReactDOM.preload('...', { as: '...' })\n  ReactDOM.preconnect('...', { crossOrigin: '...' })\n  ReactDOM.prefetchDNS('...')\n \n  return null\n}</pre></div>  <h5 id=\"link-relpreload\" data-docs-heading=\"\"><a href=\"#link-relpreload\"><code>&lt;link rel=\"preload\"&gt;</code></a></h5> <p>Start loading a resource early in the page rendering (browser) lifecycle. <a href=\"https://developer.mozilla.org/docs/Web/HTML/Attributes/rel/preload\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDN Docs</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">ReactDOM.preload(href: string, options: { as: string })</pre>\n</div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"preload\" href=\"...\" as=\"...\" /&gt;</pre></div> <h5 id=\"link-relpreconnect\" data-docs-heading=\"\"><a href=\"#link-relpreconnect\"><code>&lt;link rel=\"preconnect\"&gt;</code></a></h5> <p>Preemptively initiate a connection to an origin. <a href=\"https://developer.mozilla.org/docs/Web/HTML/Attributes/rel/preconnect\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDN Docs</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">ReactDOM.preconnect(href: string, options?: { crossOrigin?: string })</pre>\n</div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"preconnect\" href=\"...\" crossorigin /&gt;</pre></div> <h5 id=\"link-reldns-prefetch\" data-docs-heading=\"\"><a href=\"#link-reldns-prefetch\"><code>&lt;link rel=\"dns-prefetch\"&gt;</code></a></h5> <p>Attempt to resolve a domain name before resources get requested. <a href=\"https://developer.mozilla.org/docs/Web/HTML/Attributes/rel/dns-prefetch\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDN Docs</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">ReactDOM.prefetchDNS(href: string)</pre>\n</div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"dns-prefetch\" href=\"...\" /&gt;</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>These methods are currently only supported in Client Components, which are still Server Side Rendered on initial page load.</li> <li>Next.js in-built features such as <code>next/font</code>, <code>next/image</code> and <code>next/script</code> automatically handle relevant resource hints.</li> <li>React 18.3 does not yet include type definitions for <code>ReactDOM.preload</code>, <code>ReactDOM.preconnect</code>, and <code>ReactDOM.preconnectDNS</code>. You can use <code>// @ts-ignore</code> as a temporary solution to avoid type errors.</li> </ul> </blockquote> <h2 id=\"types\" data-docs-heading=\"\">Types     </h2> <p>You can add type safety to your metadata by using the <code>Metadata</code> type. If you are using the <a href=\"../../building-your-application/configuring/typescript\">built-in TypeScript plugin</a> in your IDE, you do not need to manually add the type, but you can still explicitly add it if you want.</p> <h3 id=\"metadata-object\" data-docs-heading=\"\">metadata object     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'Next.js',\n}</pre>\n</div> <h3 id=\"generatemetadata-function-1\" data-docs-heading=\"\">generateMetadata function     </h3> <h4 id=\"regular-function\" data-docs-heading=\"\">Regular function     </h4> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport function generateMetadata(): Metadata {\n  return {\n    title: 'Next.js',\n  }\n}</pre>\n</div> <h4 id=\"async-function\" data-docs-heading=\"\">Async function     </h4> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport async function generateMetadata(): Promise&lt;Metadata&gt; {\n  return {\n    title: 'Next.js',\n  }\n}</pre>\n</div> <h4 id=\"with-segment-props\" data-docs-heading=\"\">With segment props     </h4> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \ntype Props = {\n  params: { id: string }\n  searchParams: { [key: string]: string | string[] | undefined }\n}\n \nexport function generateMetadata({ params, searchParams }: Props): Metadata {\n  return {\n    title: 'Next.js',\n  }\n}\n \nexport default function Page({ params, searchParams }: Props) {}</pre>\n</div> <h4 id=\"with-parent-metadata\" data-docs-heading=\"\">With parent metadata     </h4> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata, ResolvingMetadata } from 'next'\n \nexport async function generateMetadata(\n  { params, searchParams }: Props,\n  parent: ResolvingMetadata\n): Promise&lt;Metadata&gt; {\n  return {\n    title: 'Next.js',\n  }\n}</pre>\n</div> <h4 id=\"javascript-projects\" data-docs-heading=\"\">JavaScript Projects     </h4> <p>For JavaScript projects, you can use JSDoc to add type safety.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import(\"next\").Metadata} */\nexport const metadata = {\n  title: 'Next.js',\n}</pre>\n</div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>\n<code>viewport</code>, <code>themeColor</code>, and <code>colorScheme</code> deprecated in favor of the <a href=\"generate-viewport\"><code>viewport</code> configuration</a>.</td>\n</tr>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>\n<code>metadata</code> and <code>generateMetadata</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-metadata\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/generate-metadata</a>\n  </p>\n</div>\n","app/api-reference/functions/generate-viewport":"<h1 class=\"break-words\">generateViewport</h1>\n<p>You can customize the initial viewport of the page with the static <code>viewport</code> object or the dynamic <code>generateViewport</code> function.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>The <code>viewport</code> object and <code>generateViewport</code> function exports are <strong>only supported in Server Components</strong>.</li> <li>You cannot export both the <code>viewport</code> object and <code>generateViewport</code> function from the same route segment.</li> <li>If you're coming from migrating <code>metadata</code> exports, you can use <a href=\"../../building-your-application/upgrading/codemods#metadata-to-viewport-export\">metadata-to-viewport-export codemod</a> to update your changes.</li> </ul> </blockquote> <h2 id=\"the-viewport-object\" data-docs-heading=\"\">The viewport object     </h2> <p>To define the viewport options, export a <code>viewport</code> object from a <code>layout.jsx</code> or <code>page.jsx</code> file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Viewport } from 'next'\n \nexport const viewport: Viewport = {\n  themeColor: 'black',\n}\n \nexport default function Page() {}</pre></div>  <h2 id=\"generateviewport-function\" data-docs-heading=\"\">generateViewport function     </h2> <p><code>generateViewport</code> should return a <a href=\"#viewport-fields\"><code>Viewport</code> object</a> containing one or more viewport fields.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function generateViewport({ params }) {\n  return {\n    themeColor: '...',\n  }\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If the viewport doesn't depend on runtime information, it should be defined using the static <a href=\"#the-viewport-object\"><code>viewport</code> object</a> rather than <code>generateMetadata</code>.</li> </ul> </blockquote> <h2 id=\"viewport-fields\" data-docs-heading=\"\">Viewport Fields     </h2> <h3 id=\"themecolor\" data-docs-heading=\"\">themeColor     </h3> <p>Learn more about <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/meta/name/theme-color\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>theme-color</code></a>.</p> <p><strong>Simple theme color</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Viewport } from 'next'\n \nexport const viewport: Viewport = {\n  themeColor: 'black',\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"theme-color\" content=\"black\" /&gt;</pre></div> <p><strong>With media attribute</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Viewport } from 'next'\n \nexport const viewport: Viewport = {\n  themeColor: [\n    { media: '(prefers-color-scheme: light)', color: 'cyan' },\n    { media: '(prefers-color-scheme: dark)', color: 'black' },\n  ],\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"theme-color\" media=\"(prefers-color-scheme: light)\" content=\"cyan\" /&gt;\n&lt;meta name=\"theme-color\" media=\"(prefers-color-scheme: dark)\" content=\"black\" /&gt;</pre></div> <h3 id=\"width-initialscale-maximumscale-and-userscalable\" data-docs-heading=\"\">width, initialScale, maximumScale and userScalable     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The <code>viewport</code> meta tag is automatically set, and manual configuration is usually unnecessary as the default is sufficient. However, the information is provided for completeness.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Viewport } from 'next'\n \nexport const viewport: Viewport = {\n  width: 'device-width',\n  initialScale: 1,\n  maximumScale: 1,\n  userScalable: false,\n  // Also supported by less commonly used\n  // interactiveWidget: 'resizes-visual',\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta\n  name=\"viewport\"\n  content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\"\n/&gt;</pre></div> <h3 id=\"colorscheme\" data-docs-heading=\"\">colorScheme     </h3> <p>Learn more about <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta/name#:~:text=color%2Dscheme%3A%20specifies,of%20the%20following%3A\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>color-scheme</code></a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Viewport } from 'next'\n \nexport const viewport: Viewport = {\n  colorScheme: 'dark',\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;meta name=\"color-scheme\" content=\"dark\" /&gt;</pre></div> <h2 id=\"types\" data-docs-heading=\"\">Types     </h2> <p>You can add type safety to your viewport object by using the <code>Viewport</code> type. If you are using the <a href=\"../../building-your-application/configuring/typescript\">built-in TypeScript plugin</a> in your IDE, you do not need to manually add the type, but you can still explicitly add it if you want.</p> <h3 id=\"viewport-object\" data-docs-heading=\"\">viewport object     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Viewport } from 'next'\n \nexport const viewport: Viewport = {\n  themeColor: 'black',\n}</pre>\n</div> <h3 id=\"generateviewport-function-1\" data-docs-heading=\"\">generateViewport function     </h3> <h4 id=\"regular-function\" data-docs-heading=\"\">Regular function     </h4> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Viewport } from 'next'\n \nexport function generateViewport(): Viewport {\n  return {\n    themeColor: 'black',\n  }\n}</pre>\n</div> <h4 id=\"with-segment-props\" data-docs-heading=\"\">With segment props     </h4> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Viewport } from 'next'\n \ntype Props = {\n  params: { id: string }\n  searchParams: { [key: string]: string | string[] | undefined }\n}\n \nexport function generateViewport({ params, searchParams }: Props): Viewport {\n  return {\n    themeColor: 'black',\n  }\n}\n \nexport default function Page({ params, searchParams }: Props) {}</pre>\n</div> <h4 id=\"javascript-projects\" data-docs-heading=\"\">JavaScript Projects     </h4> <p>For JavaScript projects, you can use JSDoc to add type safety.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import(\"next\").Viewport} */\nexport const viewport = {\n  themeColor: 'black',\n}</pre>\n</div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v14.0.0</code></td>\n<td>\n<code>viewport</code> and <code>generateViewport</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-viewport\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/generate-viewport</a>\n  </p>\n</div>\n","app/api-reference/functions/use-pathname":"<h1 class=\"break-words\">usePathname</h1>\n<p><code>usePathname</code> is a <strong>Client Component</strong> hook that lets you read the current URL's <strong>pathname</strong>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { usePathname } from 'next/navigation'\n \nexport default function ExampleClientComponent() {\n  const pathname = usePathname()\n  return &lt;p&gt;Current pathname: {pathname}&lt;/p&gt;\n}</pre></div>  <p><code>usePathname</code> intentionally requires using a <a href=\"../../building-your-application/rendering/client-components\">Client Component</a>. It's important to note Client Components are not a de-optimization. They are an integral part of the <a href=\"../../building-your-application/rendering/server-components\">Server Components</a> architecture.</p> <p>For example, a Client Component with <code>usePathname</code> will be rendered into HTML on the initial page load. When navigating to a new route, this component does not need to be re-fetched. Instead, the component is downloaded once (in the client JavaScript bundle), and re-renders based on the current state.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Reading the current URL from a <a href=\"../../building-your-application/rendering/server-components\">Server Component</a> is not supported. This design is intentional to support layout state being preserved across page navigations.</li> <li>Compatibility mode: <ul> <li>\n<code>usePathname</code> can return <code>null</code> when a <a href=\"../../../pages/api-reference/functions/get-static-paths#fallback-true\">fallback route</a> is being rendered or when a <code>pages</code> directory page has been <a href=\"../../../pages/building-your-application/rendering/automatic-static-optimization\">automatically statically optimized</a> by Next.js and the router is not ready.</li> <li>Next.js will automatically update your types if it detects both an <code>app</code> and <code>pages</code> directory in your project.</li> </ul> </li> </ul> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const pathname = usePathname()</pre>\n</div> <p><code>usePathname</code> does not take any parameters.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>usePathname</code> returns a string of the current URL's pathname. For example:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>URL</th>\n<th>Returned value</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>/</code></td>\n<td><code>'/'</code></td>\n</tr>\n<tr>\n<td><code>/dashboard</code></td>\n<td><code>'/dashboard'</code></td>\n</tr>\n<tr>\n<td><code>/dashboard?v=2</code></td>\n<td><code>'/dashboard'</code></td>\n</tr>\n<tr>\n<td><code>/blog/hello-world</code></td>\n<td><code>'/blog/hello-world'</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"do-something-in-response-to-a-route-change\" data-docs-heading=\"\">Do something in response to a route change     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { usePathname, useSearchParams } from 'next/navigation'\n \nfunction ExampleClientComponent() {\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n  useEffect(() =&gt; {\n    // Do something here...\n  }, [pathname, searchParams])\n}</pre></div>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>usePathname</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-pathname\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/use-pathname</a>\n  </p>\n</div>\n","app/api-reference/functions/use-report-web-vitals":"<h1 class=\"break-words\">useReportWebVitals</h1> <p>The <code>useReportWebVitals</code> hook allows you to report <a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Core Web Vitals</a>, and can be used in combination with your analytics service.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useReportWebVitals } from 'next/web-vitals'\n \nexport function WebVitals() {\n  useReportWebVitals((metric) =&gt; {\n    console.log(metric)\n  })\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { WebVitals } from './_components/web-vitals'\n \nexport default function Layout({ children }) {\n  return (\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;WebVitals /&gt;\n        {children}\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>\n<blockquote class=\"p-3 text-sm\"> <p>Since the <code>useReportWebVitals</code> hook requires the <code>\"use client\"</code> directive, the most performant approach is to create a separate component that the root layout imports. This confines the client boundary exclusively to the <code>WebVitals</code> component.</p> </blockquote> <h2 id=\"usereportwebvitals\" data-docs-heading=\"\">useReportWebVitals     </h2> <p>The <code>metric</code> object passed as the hook's argument consists of a number of properties:</p> <ul> <li>\n<code>id</code>: Unique identifier for the metric in the context of the current page load</li> <li>\n<code>name</code>: The name of the performance metric. Possible values include names of <a href=\"#web-vitals\">Web Vitals</a> metrics (TTFB, FCP, LCP, FID, CLS) specific to a web application.</li> <li>\n<code>delta</code>: The difference between the current value and the previous value of the metric. The value is typically in milliseconds and represents the change in the metric's value over time.</li> <li>\n<code>entries</code>: An array of <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceEntry\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Performance Entries</a> associated with the metric. These entries provide detailed information about the performance events related to the metric.</li> <li>\n<code>navigationType</code>: Indicates the <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceNavigationTiming/type\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">type of navigation</a> that triggered the metric collection. Possible values include <code>\"navigate\"</code>, <code>\"reload\"</code>, <code>\"back_forward\"</code>, and <code>\"prerender\"</code>.</li> <li>\n<code>rating</code>: A qualitative rating of the metric value, providing an assessment of the performance. Possible values are <code>\"good\"</code>, <code>\"needs-improvement\"</code>, and <code>\"poor\"</code>. The rating is typically determined by comparing the metric value against predefined thresholds that indicate acceptable or suboptimal performance.</li> <li>\n<code>value</code>: The actual value or duration of the performance entry, typically in milliseconds. The value provides a quantitative measure of the performance aspect being tracked by the metric. The source of the value depends on the specific metric being measured and can come from various <a href=\"https://developer.mozilla.org/docs/Web/API/Performance_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Performance API</a>s.</li> </ul> <h2 id=\"web-vitals\" data-docs-heading=\"\">Web Vitals     </h2> <p><a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Vitals</a> are a set of useful metrics that aim to capture the user experience of a web page. The following web vitals are all included:</p> <ul> <li>\n<a href=\"https://developer.mozilla.org/docs/Glossary/Time_to_first_byte\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Time to First Byte</a> (TTFB)</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Glossary/First_contentful_paint\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Contentful Paint</a> (FCP)</li> <li>\n<a href=\"https://web.dev/lcp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Largest Contentful Paint</a> (LCP)</li> <li>\n<a href=\"https://web.dev/fid/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Input Delay</a> (FID)</li> <li>\n<a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a> (CLS)</li> <li>\n<a href=\"https://web.dev/inp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Interaction to Next Paint</a> (INP)</li> </ul> <p>You can handle all the results of these metrics using the <code>name</code> property.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useReportWebVitals } from 'next/web-vitals'\n \nexport function WebVitals() {\n  useReportWebVitals((metric) =&gt; {\n    switch (metric.name) {\n      case 'FCP': {\n        // handle FCP results\n      }\n      case 'LCP': {\n        // handle LCP results\n      }\n      // ...\n    }\n  })\n}</pre></div>  <h2 id=\"usage-on-vercel\" data-docs-heading=\"\">Usage on Vercel     </h2> <p><a href=\"https://vercel.com/docs/concepts/speed-insights\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Speed Insights</a> are automatically configured on Vercel deployments, and don't require the use of <code>useReportWebVitals</code>. This hook is useful in local development, or if you're using a different analytics service.</p> <h2 id=\"sending-results-to-external-systems\" data-docs-heading=\"\">Sending results to external systems     </h2> <p>You can send results to any endpoint to measure and track real user performance on your site. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useReportWebVitals((metric) =&gt; {\n  const body = JSON.stringify(metric)\n  const url = 'https://example.com/analytics'\n \n  // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.\n  if (navigator.sendBeacon) {\n    navigator.sendBeacon(url, body)\n  } else {\n    fetch(url, { body, method: 'POST', keepalive: true })\n  }\n})</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you use <a href=\"https://analytics.google.com/analytics/web/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Analytics</a>, using the <code>id</code> value can allow you to construct metric distributions manually (to calculate percentiles, etc.)</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useReportWebVitals(metric =&gt; {\n  // Use `window.gtag` if you initialized Google Analytics as this example:\n  // https://github.com/vercel/next.js/blob/canary/examples/with-google-analytics/pages/_app.js\n  window.gtag('event', metric.name, {\n    value: Math.round(metric.name === 'CLS' ? metric.value * 1000 : metric.value), // values must be integers\n    event_label: metric.id, // id unique to current page load\n    non_interaction: true, // avoids affecting bounce rate.\n  });\n}</pre>\n</div> <p>Read more about <a href=\"https://github.com/GoogleChrome/web-vitals#send-the-results-to-google-analytics\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">sending results to Google Analytics</a>.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-report-web-vitals\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/use-report-web-vitals</a>\n  </p>\n</div>\n","app/api-reference/functions/use-router":"<h1 class=\"break-words\">useRouter</h1>\n<p>The <code>useRouter</code> hook allows you to programmatically change routes inside <a href=\"../../building-your-application/rendering/client-components\">Client Components</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation:</strong> Use the <a href=\"../../building-your-application/routing/linking-and-navigating#link-component\"><code>&lt;Link&gt;</code> component</a> for navigation unless you have a specific requirement for using <code>useRouter</code>.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useRouter } from 'next/navigation'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.push('/dashboard')}&gt;\n      Dashboard\n    &lt;/button&gt;\n  )\n}</pre></div>  <h2 id=\"userouter\" data-docs-heading=\"\">useRouter()     </h2> <ul> <li>\n<code>router.push(href: string, { scroll: boolean })</code>: Perform a client-side navigation to the provided route. Adds a new entry into the <a href=\"https://developer.mozilla.org/docs/Web/API/History_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">browsers history</a> stack.</li> <li>\n<code>router.replace(href: string, { scroll: boolean })</code>: Perform a client-side navigation to the provided route without adding a new entry into the <a href=\"https://developer.mozilla.org/docs/Web/API/History_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">browsers history stack</a>.</li> <li>\n<code>router.refresh()</code>: Refresh the current route. Making a new request to the server, re-fetching data requests, and re-rendering Server Components. The client will merge the updated React Server Component payload without losing unaffected client-side React (e.g. <code>useState</code>) or browser state (e.g. scroll position).</li> <li>\n<code>router.prefetch(href: string)</code>: <a href=\"../../building-your-application/routing/linking-and-navigating#2-prefetching\">Prefetch</a> the provided route for faster client-side transitions.</li> <li>\n<code>router.back()</code>: Navigate back to the previous route in the browsers history stack.</li> <li>\n<code>router.forward()</code>: Navigate forwards to the next page in the browsers history stack.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>The <code>&lt;Link&gt;</code> component automatically prefetch routes as they become visible in the viewport.</li> <li>\n<code>refresh()</code> could re-produce the same result if fetch requests are cached. Other dynamic functions like <code>cookies</code> and <code>headers</code> could also change the response.</li> </ul> </blockquote> <h3 id=\"migrating-from-nextrouter\" data-docs-heading=\"\">Migrating from next/router     </h3> <ul> <li>The <code>useRouter</code> hook should be imported from <code>next/navigation</code> and not <code>next/router</code> when using the App Router</li> <li>The <code>pathname</code> string has been removed and is replaced by <a href=\"use-pathname\"><code>usePathname()</code></a>\n</li> <li>The <code>query</code> object has been removed and is replaced by <a href=\"use-search-params\"><code>useSearchParams()</code></a>\n</li> <li>\n<code>router.events</code> has been replaced. <a href=\"#router-events\">See below.</a>\n</li> </ul> <p><a href=\"../../building-your-application/upgrading/app-router-migration\">View the full migration guide</a>.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"router-events\" data-docs-heading=\"\">Router events     </h3> <p>You can listen for page changes by composing other Client Component hooks like <code>usePathname</code> and <code>useSearchParams</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useEffect } from 'react'\nimport { usePathname, useSearchParams } from 'next/navigation'\n \nexport function NavigationEvents() {\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n \n  useEffect(() =&gt; {\n    const url = `${pathname}?${searchParams}`\n    console.log(url)\n    // You can now use the current URL\n    // ...\n  }, [pathname, searchParams])\n \n  return null\n}</pre></div> <p>Which can be imported into a layout.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Suspense } from 'react'\nimport { NavigationEvents } from './components/navigation-events'\n \nexport default function Layout({ children }) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;\n        {children}\n \n        &lt;Suspense fallback={null}&gt;\n          &lt;NavigationEvents /&gt;\n        &lt;/Suspense&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>&lt;NavigationEvents&gt;</code> is wrapped in a <a href=\"../../building-your-application/routing/loading-ui-and-streaming#example\"><code>Suspense</code> boundary</a> because<a href=\"use-search-params\"><code>useSearchParams()</code></a> causes client-side rendering up to the closest <code>Suspense</code> boundary during <a href=\"../../building-your-application/rendering/server-components#static-rendering-default\">static rendering</a>. <a href=\"use-search-params#behavior\">Learn more</a>.</p> </blockquote> <h3 id=\"disabling-scroll-restoration\" data-docs-heading=\"\">Disabling scroll restoration     </h3> <p>By default, Next.js will scroll to the top of the page when navigating to a new route. You can disable this behavior by passing <code>scroll: false</code> to <code>router.push()</code> or <code>router.replace()</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useRouter } from 'next/navigation'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button\n      type=\"button\"\n      onClick={() =&gt; router.push('/dashboard', { scroll: false })}\n    &gt;\n      Dashboard\n    &lt;/button&gt;\n  )\n}</pre></div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>useRouter</code> from <code>next/navigation</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-router\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/use-router</a>\n  </p>\n</div>\n","app/api-reference/functions/use-search-params":"<h1 class=\"break-words\">useSearchParams</h1>\n<p><code>useSearchParams</code> is a <strong>Client Component</strong> hook that lets you read the current URL's <strong>query string</strong>.</p> <p><code>useSearchParams</code> returns a <strong>read-only</strong> version of the <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams</code></a> interface.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useSearchParams } from 'next/navigation'\n \nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n \n  const search = searchParams.get('search')\n \n  // URL -&gt; `/dashboard?search=my-project`\n  // `search` -&gt; 'my-project'\n  return &lt;&gt;Search: {search}&lt;/&gt;\n}</pre></div>  <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const searchParams = useSearchParams()</pre>\n</div> <p><code>useSearchParams</code> does not take any parameters.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>useSearchParams</code> returns a <strong>read-only</strong> version of the <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams</code></a> interface, which includes utility methods for reading the URL's query string:</p> <ul> <li> <p><a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/get\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams.get()</code></a>: Returns the first value associated with the search parameter. For example:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>URL</th>\n<th><code>searchParams.get(\"a\")</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>/dashboard?a=1</code></td>\n<td><code>'1'</code></td>\n</tr>\n<tr>\n<td><code>/dashboard?a=</code></td>\n<td><code>''</code></td>\n</tr>\n<tr>\n<td><code>/dashboard?b=3</code></td>\n<td><code>null</code></td>\n</tr>\n<tr>\n<td><code>/dashboard?a=1&amp;a=2</code></td>\n<td>\n<code>'1'</code> <em>- use <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/getAll\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>getAll()</code></a> to get all values</em>\n</td>\n</tr>\n</tbody>\n</table></div> </li> <li> <p><a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/has\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams.has()</code></a>: Returns a boolean value indicating if the given parameter exists. For example:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>URL</th>\n<th><code>searchParams.has(\"a\")</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>/dashboard?a=1</code></td>\n<td><code>true</code></td>\n</tr>\n<tr>\n<td><code>/dashboard?b=3</code></td>\n<td><code>false</code></td>\n</tr>\n</tbody>\n</table></div> </li> <li> <p>Learn more about other <strong>read-only</strong> methods of <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams</code></a>, including the <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/getAll\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>getAll()</code></a>, <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/keys\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>keys()</code></a>, <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/values\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>values()</code></a>, <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/entries\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>entries()</code></a>, <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/forEach\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>forEach()</code></a>, and <a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams/toString\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>toString()</code></a>.</p> </li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>useSearchParams</code> is a <a href=\"../../building-your-application/rendering/client-components\">Client Component</a> hook and is <strong>not supported</strong> in <a href=\"../../building-your-application/rendering/server-components\">Server Components</a> to prevent stale values during <a href=\"../../building-your-application/routing/linking-and-navigating#4-partial-rendering\">partial rendering</a>.</li> <li>If an application includes the <code>/pages</code> directory, <code>useSearchParams</code> will return <code>ReadonlyURLSearchParams | null</code>. The <code>null</code> value is for compatibility during migration since search params cannot be known during pre-rendering of a page that doesn't use <code>getServerSideProps</code>\n</li> </ul> </blockquote> <h3 id=\"static-rendering\" data-docs-heading=\"\">Static Rendering     </h3> <p>If a route is <a href=\"../../building-your-application/rendering/server-components#static-rendering-default\">statically rendered</a>, calling <code>useSearchParams</code> will cause the Client Component tree up to the closest <a href=\"../../building-your-application/routing/loading-ui-and-streaming#example\"><code>Suspense</code> boundary</a> to be client-side rendered.</p> <p>This allows a part of the route to be statically rendered while the dynamic part that uses <code>useSearchParams</code> is client-side rendered.</p> <p>We recommend wrapping the Client Component that uses <code>useSearchParams</code> in a <code>&lt;Suspense/&gt;</code> boundary. This will allow any Client Components above it to be statically rendered and sent as part of initial HTML. <a href=\"use-search-params#static-rendering\">Example</a>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useSearchParams } from 'next/navigation'\n \nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n \n  const search = searchParams.get('search')\n \n  // This will not be logged on the server when using static rendering\n  console.log(search)\n \n  return &lt;&gt;Search: {search}&lt;/&gt;\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Suspense } from 'react'\nimport SearchBar from './search-bar'\n \n// This component passed as a fallback to the Suspense boundary\n// will be rendered in place of the search bar in the initial HTML.\n// When the value is available during React hydration the fallback\n// will be replaced with the `&lt;SearchBar&gt;` component.\nfunction SearchBarFallback() {\n  return &lt;&gt;placeholder&lt;/&gt;\n}\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;nav&gt;\n        &lt;Suspense fallback={&lt;SearchBarFallback /&gt;}&gt;\n          &lt;SearchBar /&gt;\n        &lt;/Suspense&gt;\n      &lt;/nav&gt;\n      &lt;h1&gt;Dashboard&lt;/h1&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h2 id=\"behavior\" data-docs-heading=\"\">Behavior     </h2> <h3 id=\"dynamic-rendering\" data-docs-heading=\"\">Dynamic Rendering     </h3> <p>If a route is <a href=\"../../building-your-application/rendering/server-components#dynamic-rendering\">dynamically rendered</a>, <code>useSearchParams</code> will be available on the server during the initial server render of the Client Component.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useSearchParams } from 'next/navigation'\n \nexport default function SearchBar() {\n  const searchParams = useSearchParams()\n \n  const search = searchParams.get('search')\n \n  // This will be logged on the server during the initial render\n  // and on the client on subsequent navigations.\n  console.log(search)\n \n  return &lt;&gt;Search: {search}&lt;/&gt;\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import SearchBar from './search-bar'\n \nexport const dynamic = 'force-dynamic'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;nav&gt;\n        &lt;SearchBar /&gt;\n      &lt;/nav&gt;\n      &lt;h1&gt;Dashboard&lt;/h1&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Setting the <a href=\"../file-conventions/route-segment-config#dynamic\"><code>dynamic</code> route segment config option</a> to <code>force-dynamic</code> can be used to force dynamic rendering.</p> </blockquote> <h3 id=\"server-components\" data-docs-heading=\"\">Server Components     </h3> <h4 id=\"pages\" data-docs-heading=\"\">Pages     </h4> <p>To access search params in <a href=\"../file-conventions/page\">Pages</a> (Server Components), use the <a href=\"../file-conventions/page#searchparams-optional\"><code>searchParams</code></a> prop.</p> <h4 id=\"layouts\" data-docs-heading=\"\">Layouts     </h4> <p>Unlike Pages, <a href=\"../file-conventions/layout\">Layouts</a> (Server Components) <strong>do not</strong> receive the <code>searchParams</code> prop. This is because a shared layout is <a href=\"../../building-your-application/routing/linking-and-navigating#4-partial-rendering\">not re-rendered during navigation</a> which could lead to stale <code>searchParams</code> between navigations. View <a href=\"../file-conventions/layout#layouts-do-not-receive-searchparams\">detailed explanation</a>.</p> <p>Instead, use the Page <a href=\"../file-conventions/page\"><code>searchParams</code></a> prop or the <a href=\"use-search-params\"><code>useSearchParams</code></a> hook in a Client Component, which is re-rendered on the client with the latest <code>searchParams</code>.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"updating-searchparams\" data-docs-heading=\"\">Updating searchParams     </h3> <p>You can use <a href=\"use-router\"><code>useRouter</code></a> or <a href=\"../components/link\"><code>Link</code></a> to set new <code>searchParams</code>. After a navigation is performed, the current <a href=\"../file-conventions/page\"><code>page.js</code></a> will receive an updated <a href=\"../file-conventions/page#searchparams-optional\"><code>searchParams</code> prop</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function ExampleClientComponent() {\n  const router = useRouter()\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n \n  // Get a new searchParams string by merging the current\n  // searchParams with a provided key/value pair\n  const createQueryString = useCallback(\n    (name: string, value: string) =&gt; {\n      const params = new URLSearchParams(searchParams.toString())\n      params.set(name, value)\n \n      return params.toString()\n    },\n    [searchParams]\n  )\n \n  return (\n    &lt;&gt;\n      &lt;p&gt;Sort By&lt;/p&gt;\n \n      {/* using useRouter */}\n      &lt;button\n        onClick={() =&gt; {\n          // &lt;pathname&gt;?sort=asc\n          router.push(pathname + '?' + createQueryString('sort', 'asc'))\n        }}\n      &gt;\n        ASC\n      &lt;/button&gt;\n \n      {/* using &lt;Link&gt; */}\n      &lt;Link\n        href={\n          // &lt;pathname&gt;?sort=desc\n          pathname + '?' + createQueryString('sort', 'desc')\n        }\n      &gt;\n        DESC\n      &lt;/Link&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>useSearchParams</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-search-params\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/use-search-params</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/assetprefix":"<h1 class=\"break-words\">assetPrefix</h1> <blockquote class=\"p-3 text-sm\"> <p><strong>Attention</strong>: <a href=\"../../building-your-application/deploying\">Deploying to Vercel</a> automatically configures a global CDN for your Next.js project. You do not need to manually setup an Asset Prefix.</p> </blockquote>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Next.js 9.5+ added support for a customizable <a href=\"basepath\">Base Path</a>, which is better suited for hosting your application on a sub-path like <code>/docs</code>. We do not suggest you use a custom Asset Prefix for this use case.</p> </blockquote> <p>To set up a <a href=\"https://en.wikipedia.org/wiki/Content_delivery_network\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">CDN</a>, you can set up an asset prefix and configure your CDN's origin to resolve to the domain that Next.js is hosted on.</p> <p>Open <code>next.config.js</code> and add the <code>assetPrefix</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const isProd = process.env.NODE_ENV === 'production'\n \nmodule.exports = {\n  // Use the CDN in production and localhost for development.\n  assetPrefix: isProd ? 'https://cdn.mydomain.com' : undefined,\n}</pre></div> <p>Next.js will automatically use your asset prefix for the JavaScript and CSS files it loads from the <code>/_next/</code> path (<code>.next/static/</code> folder). For example, with the above configuration, the following request for a JS chunk:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/_next/static/chunks/4b9b41aaa062cbbfeff4add70f256968c51ece5d.4d708494b3aed70c04f0.js\n</pre>\n</div> <p>Would instead become:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://cdn.mydomain.com/_next/static/chunks/4b9b41aaa062cbbfeff4add70f256968c51ece5d.4d708494b3aed70c04f0.js\n</pre>\n</div> <p>The exact configuration for uploading your files to a given CDN will depend on your CDN of choice. The only folder you need to host on your CDN is the contents of <code>.next/static/</code>, which should be uploaded as <code>_next/static/</code> as the above URL request indicates. <strong>Do not upload the rest of your <code>.next/</code> folder</strong>, as you should not expose your server code and other configuration to the public.</p> <p>While <code>assetPrefix</code> covers requests to <code>_next/static</code>, it does not influence the following paths:</p> <ul> <li>Files in the <a href=\"../../building-your-application/optimizing/static-assets\">public</a> folder; if you want to serve those assets over a CDN, you'll have to introduce the prefix yourself</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/assetPrefix\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/assetPrefix</a>\n  </p>\n</div>\n","app/api-reference/functions/unstable_nostore":"<h1 class=\"break-words\">unstable_noStore</h1>\n<p><code>unstable_noStore</code> can be used to declaratively opt out of static rendering and indicate a particular component should not be cached.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { unstable_noStore as noStore } from 'next/cache';\n \nexport default async function Component() {\n  noStore();\n  const result = await db.query(...);\n  ...\n}</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>unstable_noStore</code> is equivalent to <code>cache: 'no-store'</code> on a <code>fetch</code>\n</li> <li>\n<code>unstable_noStore</code> is preferred over <code>export const dynamic = 'force-dynamic'</code> as it is more granular and can be used on a per-component basis</li> </ul> </blockquote> <ul> <li>Using <code>unstable_noStore</code> inside <a href=\"unstable_cache\"><code>unstable_cache</code></a> will not opt out of static generation. Instead, it will defer to the cache configuration to determine whether to cache the result or not.</li> </ul> <h2 id=\"usage\" data-docs-heading=\"\">Usage     </h2> <p>If you prefer not to pass additional options to <code>fetch</code>, like <code>cache: 'no-store'</code> or <code>next: { revalidate: 0 }</code>, you can use <code>noStore()</code> as a replacement for all of these use cases.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { unstable_noStore as noStore } from 'next/cache';\n \nexport default async function Component() {\n  noStore();\n  const result = await db.query(...);\n  ...\n}</pre>\n</div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v14.0.0</code></td>\n<td>\n<code>unstable_noStore</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/unstable_noStore\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/unstable_noStore</a>\n  </p>\n</div>\n","app/api-reference/functions/use-selected-layout-segment":"<h1 class=\"break-words\">useSelectedLayoutSegment</h1>\n<p><code>useSelectedLayoutSegment</code> is a <strong>Client Component</strong> hook that lets you read the active route segment <strong>one level below</strong> the Layout it is called from.</p> <p>It is useful for navigation UI, such as tabs inside a parent layout that change style depending on the active child segment.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useSelectedLayoutSegment } from 'next/navigation'\n \nexport default function ExampleClientComponent() {\n  const segment = useSelectedLayoutSegment()\n \n  return &lt;p&gt;Active segment: {segment}&lt;/p&gt;\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Since <code>useSelectedLayoutSegment</code> is a <a href=\"../../building-your-application/rendering/client-components\">Client Component</a> hook, and Layouts are <a href=\"../../building-your-application/rendering/server-components\">Server Components</a> by default, <code>useSelectedLayoutSegment</code> is usually called via a Client Component that is imported into a Layout.</li> <li>\n<code>useSelectedLayoutSegment</code> only returns the segment one level down. To return all active segments, see <a href=\"use-selected-layout-segments\"><code>useSelectedLayoutSegments</code></a>\n</li> </ul> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const segment = useSelectedLayoutSegment(parallelRoutesKey?: string)</pre>\n</div> <p><code>useSelectedLayoutSegment</code> <em>optionally</em> accepts a <a href=\"../../building-your-application/routing/parallel-routes#useselectedlayoutsegments\"><code>parallelRoutesKey</code></a>, which allows you to read the active route segment within that slot.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>useSelectedLayoutSegment</code> returns a string of the active segment or <code>null</code> if one doesn't exist.</p> <p>For example, given the Layouts and URLs below, the returned segment would be:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Layout</th>\n<th>Visited URL</th>\n<th>Returned Segment</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/layout.js</code></td>\n<td><code>/</code></td>\n<td><code>null</code></td>\n</tr>\n<tr>\n<td><code>app/layout.js</code></td>\n<td><code>/dashboard</code></td>\n<td><code>'dashboard'</code></td>\n</tr>\n<tr>\n<td><code>app/dashboard/layout.js</code></td>\n<td><code>/dashboard</code></td>\n<td><code>null</code></td>\n</tr>\n<tr>\n<td><code>app/dashboard/layout.js</code></td>\n<td><code>/dashboard/settings</code></td>\n<td><code>'settings'</code></td>\n</tr>\n<tr>\n<td><code>app/dashboard/layout.js</code></td>\n<td><code>/dashboard/analytics</code></td>\n<td><code>'analytics'</code></td>\n</tr>\n<tr>\n<td><code>app/dashboard/layout.js</code></td>\n<td><code>/dashboard/analytics/monthly</code></td>\n<td><code>'analytics'</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"creating-an-active-link-component\" data-docs-heading=\"\">Creating an active link component     </h3> <p>You can use <code>useSelectedLayoutSegment</code> to create an active link component that changes style depending on the active segment. For example, a featured posts list in the sidebar of a blog:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport Link from 'next/link'\nimport { useSelectedLayoutSegment } from 'next/navigation'\n \n// This *client* component will be imported into a blog layout\nexport default function BlogNavLink({\n  slug,\n  children,\n}: {\n  slug: string\n  children: React.ReactNode\n}) {\n  // Navigating to `/blog/hello-world` will return 'hello-world'\n  // for the selected layout segment\n  const segment = useSelectedLayoutSegment()\n  const isActive = slug === segment\n \n  return (\n    &lt;Link\n      href={`/blog/${slug}`}\n      // Change style depending on whether the link is active\n      style={{ fontWeight: isActive ? 'bold' : 'normal' }}\n    &gt;\n      {children}\n    &lt;/Link&gt;\n  )\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Import the Client Component into a parent Layout (Server Component)\nimport { BlogNavLink } from './blog-nav-link'\nimport getFeaturedPosts from './get-featured-posts'\n \nexport default async function Layout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const featuredPosts = await getFeaturedPosts()\n  return (\n    &lt;div&gt;\n      {featuredPosts.map((post) =&gt; (\n        &lt;div key={post.id}&gt;\n          &lt;BlogNavLink slug={post.slug}&gt;{post.title}&lt;/BlogNavLink&gt;\n        &lt;/div&gt;\n      ))}\n      &lt;div&gt;{children}&lt;/div&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>useSelectedLayoutSegment</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-selected-layout-segment\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/use-selected-layout-segment</a>\n  </p>\n</div>\n","app/api-reference/functions/useragent":"<h1 class=\"break-words\">userAgent</h1> <p>The <code>userAgent</code> helper extends the <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Request API</a> with additional properties and methods to interact with the user agent object from the request.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse, userAgent } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  const url = request.nextUrl\n  const { device } = userAgent(request)\n  const viewport = device.type === 'mobile' ? 'mobile' : 'desktop'\n  url.searchParams.set('viewport', viewport)\n  return NextResponse.rewrite(url)\n}</pre></div>  <h2 id=\"isbot\" data-docs-heading=\"\">isBot     </h2> <p>A boolean indicating whether the request comes from a known bot.</p> <h2 id=\"browser\" data-docs-heading=\"\">browser     </h2> <p>An object containing information about the browser used in the request.</p> <ul> <li>\n<code>name</code>: A string representing the browser's name, or <code>undefined</code> if not identifiable.</li> <li>\n<code>version</code>: A string representing the browser's version, or <code>undefined</code>.</li> </ul> <h2 id=\"device\" data-docs-heading=\"\">device     </h2> <p>An object containing information about the device used in the request.</p> <ul> <li>\n<code>model</code>: A string representing the model of the device, or <code>undefined</code>.</li> <li>\n<code>type</code>: A string representing the type of the device, such as <code>console</code>, <code>mobile</code>, <code>tablet</code>, <code>smarttv</code>, <code>wearable</code>, <code>embedded</code>, or <code>undefined</code>.</li> <li>\n<code>vendor</code>: A string representing the vendor of the device, or <code>undefined</code>.</li> </ul> <h2 id=\"engine\" data-docs-heading=\"\">engine     </h2> <p>An object containing information about the browser's engine.</p> <ul> <li>\n<code>name</code>: A string representing the engine's name. Possible values include: <code>Amaya</code>, <code>Blink</code>, <code>EdgeHTML</code>, <code>Flow</code>, <code>Gecko</code>, <code>Goanna</code>, <code>iCab</code>, <code>KHTML</code>, <code>Links</code>, <code>Lynx</code>, <code>NetFront</code>, <code>NetSurf</code>, <code>Presto</code>, <code>Tasman</code>, <code>Trident</code>, <code>w3m</code>, <code>WebKit</code> or <code>undefined</code>.</li> <li>\n<code>version</code>: A string representing the engine's version, or <code>undefined</code>.</li> </ul> <h2 id=\"os\" data-docs-heading=\"\">os     </h2> <p>An object containing information about the operating system.</p> <ul> <li>\n<code>name</code>: A string representing the name of the OS, or <code>undefined</code>.</li> <li>\n<code>version</code>: A string representing the version of the OS, or <code>undefined</code>.</li> </ul> <h2 id=\"cpu\" data-docs-heading=\"\">cpu     </h2> <p>An object containing information about the CPU architecture.</p> <ul> <li>\n<code>architecture</code>: A string representing the architecture of the CPU. Possible values include: <code>68k</code>, <code>amd64</code>, <code>arm</code>, <code>arm64</code>, <code>armhf</code>, <code>avr</code>, <code>ia32</code>, <code>ia64</code>, <code>irix</code>, <code>irix64</code>, <code>mips</code>, <code>mips64</code>, <code>pa-risc</code>, <code>ppc</code>, <code>sparc</code>, <code>sparc64</code> or <code>undefined</code>\n</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/userAgent\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/userAgent</a>\n  </p>\n</div>\n","app/api-reference/next-config-js":"<h1 class=\"break-words\">next.config.js Options</h1> <p>Next.js can be configured through a <code>next.config.js</code> file in the root of your project directory (for example, by <code>package.json</code>) with a default export.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  /* config options here */\n}\n \nmodule.exports = nextConfig</pre></div> <p><code>next.config.js</code> is a regular Node.js module, not a JSON file. It gets used by the Next.js server and build phases, and it's not included in the browser build.</p> <p>If you need <a href=\"https://nodejs.org/api/esm.html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">ECMAScript modules</a>, you can use <code>next.config.mjs</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \n/**\n * @type {import('next').NextConfig}\n */\nconst nextConfig = {\n  /* config options here */\n}\n \nexport default nextConfig</pre></div> <p>You can also use a function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \nexport default (phase, { defaultConfig }) =&gt; {\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    /* config options here */\n  }\n  return nextConfig\n}</pre></div> <p>Since Next.js 12.1.0, you can use an async function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \nmodule.exports = async (phase, { defaultConfig }) =&gt; {\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    /* config options here */\n  }\n  return nextConfig\n}</pre></div> <p><code>phase</code> is the current context in which the configuration is loaded. You can see the <a href=\"https://github.com/vercel/next.js/blob/5e6b008b561caf2710ab7be63320a3d549474a5b/packages/next/shared/lib/constants.ts#L19-L23\" rel=\"noopener noreferrer\" target=\"_blank\">available phases</a>. Phases can be imported from <code>next/constants</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \nconst { PHASE_DEVELOPMENT_SERVER } = require('next/constants')\n \nmodule.exports = (phase, { defaultConfig }) =&gt; {\n  if (phase === PHASE_DEVELOPMENT_SERVER) {\n    return {\n      /* development only config options here */\n    }\n  }\n \n  return {\n    /* config options for all phases except development here */\n  }\n}</pre>\n</div> <p>The commented lines are the place where you can put the configs allowed by <code>next.config.js</code>, which are <a href=\"https://github.com/vercel/next.js/blob/canary/packages/next/src/server/config-shared.ts\" rel=\"noopener noreferrer\" target=\"_blank\">defined in this file</a>.</p> <p>However, none of the configs are required, and it's not necessary to understand what each config does. Instead, search for the features you need to enable or modify in this section and they will show you what to do.</p> <blockquote class=\"p-3 text-sm\"> <p>Avoid using new JavaScript features not available in your target Node.js version. <code>next.config.js</code> will not be parsed by Webpack, Babel or TypeScript.</p> </blockquote> <p>This page documents all the available configuration options:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/appdir":"<h1 class=\"break-words\">appDir</h1>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This option is <strong>no longer</strong> needed as of Next.js 13.4. The App Router is now stable.</p> </blockquote> <p>The App Router (<a href=\"../../building-your-application/routing\"><code>app</code> directory</a>) enables support for <a href=\"../../building-your-application/routing/pages-and-layouts\">layouts</a>, <a href=\"../../building-your-application/rendering/server-components\">Server Components</a>, <a href=\"../../building-your-application/routing/loading-ui-and-streaming\">streaming</a>, and <a href=\"../../building-your-application/data-fetching\">colocated data fetching</a>.</p> <p>Using the <code>app</code> directory will automatically enable <a href=\"https://react.dev/reference/react/StrictMode\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Strict Mode</a>. Learn how to <a href=\"../../building-your-application/upgrading/app-router-migration#migrating-from-pages-to-app\">incrementally adopt <code>app</code></a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/appDir\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/appDir</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/basepath":"<h1 class=\"break-words\">basePath</h1> <p>To deploy a Next.js application under a sub-path of a domain you can use the <code>basePath</code> config option.</p> <p><code>basePath</code> allows you to set a path prefix for the application. For example, to use <code>/docs</code> instead of <code>''</code> (an empty string, the default), open <code>next.config.js</code> and add the <code>basePath</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  basePath: '/docs',\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This value must be set at build time and cannot be changed without re-building as the value is inlined in the client-side bundles.</p> </blockquote> <h3 id=\"links\" data-docs-heading=\"\">Links     </h3> <p>When linking to other pages using <code>next/link</code> and <code>next/router</code> the <code>basePath</code> will be automatically applied.</p> <p>For example, using <code>/about</code> will automatically become <code>/docs/about</code> when <code>basePath</code> is set to <code>/docs</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function HomePage() {\n  return (\n    &lt;&gt;\n      &lt;Link href=\"/about\"&gt;About Page&lt;/Link&gt;\n    &lt;/&gt;\n  )\n}</pre>\n</div> <p>Output html:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;a href=\"/docs/about\"&gt;About Page&lt;/a&gt;</pre>\n</div> <p>This makes sure that you don't have to change all links in your application when changing the <code>basePath</code> value.</p> <h3 id=\"images\" data-docs-heading=\"\">Images     </h3> <p>When using the <a href=\"../components/image\"><code>next/image</code></a> component, you will need to add the <code>basePath</code> in front of <code>src</code>.</p>  <p>For example, using <code>/docs/me.png</code> will properly serve your image when <code>basePath</code> is set to <code>/docs</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nfunction Home() {\n  return (\n    &lt;&gt;\n      &lt;h1&gt;My Homepage&lt;/h1&gt;\n      &lt;Image\n        src=\"/docs/me.png\"\n        alt=\"Picture of the author\"\n        width={500}\n        height={500}\n      /&gt;\n      &lt;p&gt;Welcome to my homepage!&lt;/p&gt;\n    &lt;/&gt;\n  )\n}\n \nexport default Home</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/basePath\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/basePath</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/compress":"<h1 class=\"break-words\">compress</h1> <p>By default, Next.js uses <code>gzip</code> to compress rendered content and static files when using <code>next start</code> or a custom server. This is an optimization for applications that do not have compression configured. If compression is <em>already</em> configured in your application via a custom server, Next.js will not add compression.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>When hosting your application on <a href=\"https://vercel.com/docs/edge-network/compression\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, compression uses <code>brotli</code> first, then <code>gzip</code>.</li> <li>You can check if compression is enabled and which algorithm is used by looking at the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Accept-Encoding</code></a> (browser accepted options) and <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Encoding\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Content-Encoding</code></a> (currently used) headers in the response.</li> </ul> </blockquote> <h2 id=\"disabling-compression\" data-docs-heading=\"\">Disabling compression     </h2> <p>To disable <strong>compression</strong>, set the <code>compress</code> config option to <code>false</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compress: false,\n}</pre></div> <p>We do not recommend disabling compression unless you have compression configured on your server, as compression reduces bandwidth usage and improves the performance of your application.</p> <h2 id=\"changing-the-compression-algorithm\" data-docs-heading=\"\">Changing the compression algorithm     </h2> <p>To change your compression algorithm, you will need to configure your custom server and set the <code>compress</code> option to <code>false</code> in your <code>next.config.js</code> file.</p> <p>For example, you're using <a href=\"https://www.nginx.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">nginx</a> and want to switch to <code>brotli</code>, set the <code>compress</code> option to <code>false</code> to allow nginx to handle compression.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>For Next.js applications on Vercel, compression is handled by the Vercel's Edge Network and not Next.js. See the <a href=\"https://vercel.com/docs/edge-network/compression\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel documentation</a> for more information.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/compress\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/compress</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/crossorigin":"<h1 class=\"break-words\">crossOrigin</h1> <p>Use the <code>crossOrigin</code> option to add a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>crossOrigin</code> attribute</a> in all <code>&lt;script&gt;</code> tags generated by the <a href=\"../../building-your-application/optimizing/scripts\"><code>next/script</code></a> component , and define how cross-origin requests should be handled.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  crossOrigin: 'anonymous',\n}</pre></div> <h2 id=\"options\" data-docs-heading=\"\">Options     </h2> <ul> <li>\n<code>'anonymous'</code>: Adds <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin#anonymous\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>crossOrigin=\"anonymous\"</code></a> attribute.</li> <li>\n<code>'use-credentials'</code>: Adds <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin#use-credentials\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>crossOrigin=\"use-credentials\"</code></a>.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/crossOrigin\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/crossOrigin</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/eslint":"<h1 class=\"break-words\">eslint</h1> <p>When ESLint is detected in your project, Next.js fails your <strong>production build</strong> (<code>next build</code>) when errors are present.</p> <p>If you'd like Next.js to produce production code even when your application has ESLint errors, you can disable the built-in linting step completely. This is not recommended unless you already have ESLint configured to run in a separate part of your workflow (for example, in CI or a pre-commit hook).</p> <p>Open <code>next.config.js</code> and enable the <code>ignoreDuringBuilds</code> option in the <code>eslint</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  eslint: {\n    // Warning: This allows production builds to successfully complete even if\n    // your project has ESLint errors.\n    ignoreDuringBuilds: true,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/eslint\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/eslint</a>\n  </p>\n</div>\n","app/api-reference/functions/use-selected-layout-segments":"<h1 class=\"break-words\">useSelectedLayoutSegments</h1>\n<p><code>useSelectedLayoutSegments</code> is a <strong>Client Component</strong> hook that lets you read the active route segments <strong>below</strong> the Layout it is called from.</p> <p>It is useful for creating UI in parent Layouts that need knowledge of active child segments such as breadcrumbs.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useSelectedLayoutSegments } from 'next/navigation'\n \nexport default function ExampleClientComponent() {\n  const segments = useSelectedLayoutSegments()\n \n  return (\n    &lt;ul&gt;\n      {segments.map((segment, index) =&gt; (\n        &lt;li key={index}&gt;{segment}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Since <code>useSelectedLayoutSegments</code> is a <a href=\"../../building-your-application/rendering/client-components\">Client Component</a> hook, and Layouts are <a href=\"../../building-your-application/rendering/server-components\">Server Components</a> by default, <code>useSelectedLayoutSegments</code> is usually called via a Client Component that is imported into a Layout.</li> <li>The returned segments include <a href=\"../../building-your-application/routing/route-groups\">Route Groups</a>, which you might not want to be included in your UI. You can use the <code>filter()</code> array method to remove items that start with a bracket.</li> </ul> </blockquote> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const segments = useSelectedLayoutSegments(parallelRoutesKey?: string)</pre>\n</div> <p><code>useSelectedLayoutSegments</code> <em>optionally</em> accepts a <a href=\"../../building-your-application/routing/parallel-routes#useselectedlayoutsegments\"><code>parallelRoutesKey</code></a>, which allows you to read the active route segment within that slot.</p> <h2 id=\"returns\" data-docs-heading=\"\">Returns     </h2> <p><code>useSelectedLayoutSegments</code> returns an array of strings containing the active segments one level down from the layout the hook was called from. Or an empty array if none exist.</p> <p>For example, given the Layouts and URLs below, the returned segments would be:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Layout</th>\n<th>Visited URL</th>\n<th>Returned Segments</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>app/layout.js</code></td>\n<td><code>/</code></td>\n<td><code>[]</code></td>\n</tr>\n<tr>\n<td><code>app/layout.js</code></td>\n<td><code>/dashboard</code></td>\n<td><code>['dashboard']</code></td>\n</tr>\n<tr>\n<td><code>app/layout.js</code></td>\n<td><code>/dashboard/settings</code></td>\n<td><code>['dashboard', 'settings']</code></td>\n</tr>\n<tr>\n<td><code>app/dashboard/layout.js</code></td>\n<td><code>/dashboard</code></td>\n<td><code>[]</code></td>\n</tr>\n<tr>\n<td><code>app/dashboard/layout.js</code></td>\n<td><code>/dashboard/settings</code></td>\n<td><code>['settings']</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>useSelectedLayoutSegments</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/functions/use-selected-layout-segments\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/functions/use-selected-layout-segments</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/devindicators":"<h1 class=\"break-words\">devIndicators</h1> <p>When you edit your code, and Next.js is compiling the application, a compilation indicator appears in the bottom right corner of the page.</p>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This indicator is only present in development mode and will not appear when building and running the app in production mode.</p> </blockquote>\n<p>In some cases this indicator can be misplaced on your page, for example, when conflicting with a chat launcher. To change its position, open <code>next.config.js</code> and set the <code>buildActivityPosition</code> in the <code>devIndicators</code> object to <code>bottom-right</code> (default), <code>bottom-left</code>, <code>top-right</code> or <code>top-left</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  devIndicators: {\n    buildActivityPosition: 'bottom-right',\n  },\n}</pre></div>\n<p>In some cases this indicator might not be useful for you. To remove it, open <code>next.config.js</code> and disable the <code>buildActivity</code> config in <code>devIndicators</code> object:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  devIndicators: {\n    buildActivity: false,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/devIndicators\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/devIndicators</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/distdir":"<h1 class=\"break-words\">distDir</h1> <p>You can specify a name to use for a custom build directory to use instead of <code>.next</code>.</p> <p>Open <code>next.config.js</code> and add the <code>distDir</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  distDir: 'build',\n}</pre></div> <p>Now if you run <code>next build</code> Next.js will use <code>build</code> instead of the default <code>.next</code> folder.</p> <blockquote class=\"p-3 text-sm\"> <p><code>distDir</code> <strong>should not</strong> leave your project directory. For example, <code>../build</code> is an <strong>invalid</strong> directory.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/distDir\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/distDir</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/env":"<h1 class=\"break-words\">env</h1> <blockquote class=\"p-3 text-sm\"> <p>Since the release of <a href=\"https://nextjs.org/blog/next-9-4\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js 9.4</a> we now have a more intuitive and ergonomic experience for <a href=\"../../building-your-application/configuring/environment-variables\">adding environment variables</a>. Give it a try!</p> </blockquote>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: environment variables specified in this way will <strong>always</strong> be included in the JavaScript bundle, prefixing the environment variable name with <code>NEXT_PUBLIC_</code> only has an effect when specifying them <a href=\"../../building-your-application/configuring/environment-variables\">through the environment or .env files</a>.</p> </blockquote>  <p>To add environment variables to the JavaScript bundle, open <code>next.config.js</code> and add the <code>env</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  env: {\n    customKey: 'my-value',\n  },\n}</pre></div> <p>Now you can access <code>process.env.customKey</code> in your code. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function Page() {\n  return &lt;h1&gt;The value of customKey is: {process.env.customKey}&lt;/h1&gt;\n}\n \nexport default Page</pre>\n</div> <p>Next.js will replace <code>process.env.customKey</code> with <code>'my-value'</code> at build time. Trying to destructure <code>process.env</code> variables won't work due to the nature of webpack <a href=\"https://webpack.js.org/plugins/define-plugin/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">DefinePlugin</a>.</p> <p>For example, the following line:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">return &lt;h1&gt;The value of customKey is: {process.env.customKey}&lt;/h1&gt;</pre>\n</div> <p>Will end up being:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">return &lt;h1&gt;The value of customKey is: {'my-value'}&lt;/h1&gt;</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/env\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/env</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/generatebuildid":"<h1 class=\"break-words\">generateBuildId</h1> <p>Next.js generates an ID during <code>next build</code> to identify which version of your application is being served. The same build should be used and boot up multiple containers.</p> <p>If you are rebuilding for each stage of your environment, you will need to generate a consistent build ID to use between containers. Use the <code>generateBuildId</code> command in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  generateBuildId: async () =&gt; {\n    // This could be anything, using the latest git hash\n    return process.env.GIT_HASH\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/generateBuildId\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/generateBuildId</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/headers":"<h1 class=\"break-words\">headers</h1> <p>Headers allow you to set custom HTTP headers on the response to an incoming request on a given path.</p> <p>To set custom HTTP headers you can use the <code>headers</code> key in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/about',\n        headers: [\n          {\n            key: 'x-custom-header',\n            value: 'my custom header value',\n          },\n          {\n            key: 'x-another-custom-header',\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <p><code>headers</code> is an async function that expects an array to be returned holding objects with <code>source</code> and <code>headers</code> properties:</p> <ul> <li>\n<code>source</code> is the incoming request path pattern.</li> <li>\n<code>headers</code> is an array of response header objects, with <code>key</code> and <code>value</code> properties.</li> <li>\n<code>basePath</code>: <code>false</code> or <code>undefined</code> - if false the basePath won't be included when matching, can be used for external rewrites only.</li> <li>\n<code>locale</code>: <code>false</code> or <code>undefined</code> - whether the locale should not be included when matching.</li> <li>\n<code>has</code> is an array of <a href=\"#header-cookie-and-query-matching\">has objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> <li>\n<code>missing</code> is an array of <a href=\"#header-cookie-and-query-matching\">missing objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> </ul> <p>Headers are checked before the filesystem which includes pages and <code>/public</code> files.</p> <h2 id=\"header-overriding-behavior\" data-docs-heading=\"\">Header Overriding Behavior     </h2> <p>If two headers match the same path and set the same header key, the last header key will override the first. Using the below headers, the path <code>/hello</code> will result in the header <code>x-hello</code> being <code>world</code> due to the last header value set being <code>world</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/:path*',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'there',\n          },\n        ],\n      },\n      {\n        source: '/hello',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"path-matching\" data-docs-heading=\"\">Path Matching     </h2> <p>Path matches are allowed, for example <code>/blog/:slug</code> will match <code>/blog/hello-world</code> (no nested paths):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:slug',\n        headers: [\n          {\n            key: 'x-slug',\n            value: ':slug', // Matched parameters can be used in the value\n          },\n          {\n            key: 'x-slug-:slug', // Matched parameters can be used in the key\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"wildcard-path-matching\" data-docs-heading=\"\">Wildcard Path Matching     </h3> <p>To match a wildcard path you can use <code>*</code> after a parameter, for example <code>/blog/:slug*</code> will match <code>/blog/a/b/c/d/hello-world</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:slug*',\n        headers: [\n          {\n            key: 'x-slug',\n            value: ':slug*', // Matched parameters can be used in the value\n          },\n          {\n            key: 'x-slug-:slug*', // Matched parameters can be used in the key\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"regex-path-matching\" data-docs-heading=\"\">Regex Path Matching     </h3> <p>To match a regex path you can wrap the regex in parenthesis after a parameter, for example <code>/blog/:slug(\\\\d{1,})</code> will match <code>/blog/123</code> but not <code>/blog/abc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:post(\\\\d{1,})',\n        headers: [\n          {\n            key: 'x-post',\n            value: ':post',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <p>The following characters <code>(</code>, <code>)</code>, <code>{</code>, <code>}</code>, <code>:</code>, <code>*</code>, <code>+</code>, <code>?</code> are used for regex path matching, so when used in the <code>source</code> as non-special values they must be escaped by adding <code>\\\\</code> before them:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        headers: [\n          {\n            key: 'x-header',\n            value: 'value',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"header-cookie-and-query-matching\" data-docs-heading=\"\">Header, Cookie, and Query Matching     </h2> <p>To only apply a header when header, cookie, or query values also match the <code>has</code> field or don't match the <code>missing</code> field can be used. Both the <code>source</code> and all <code>has</code> items must match and all <code>missing</code> items must not match for the header to be applied.</p> <p><code>has</code> and <code>missing</code> items can have the following fields:</p> <ul> <li>\n<code>type</code>: <code>String</code> - must be either <code>header</code>, <code>cookie</code>, <code>host</code>, or <code>query</code>.</li> <li>\n<code>key</code>: <code>String</code> - the key from the selected type to match against.</li> <li>\n<code>value</code>: <code>String</code> or <code>undefined</code> - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value <code>first-(?&lt;paramName&gt;.*)</code> is used for <code>first-second</code> then <code>second</code> will be usable in the destination with <code>:paramName</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      // if the header `x-add-header` is present,\n      // the `x-another-header` header will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-add-header',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: 'hello',\n          },\n        ],\n      },\n      // if the header `x-no-header` is not present,\n      // the `x-another-header` header will be applied\n      {\n        source: '/:path*',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-no-header',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: 'hello',\n          },\n        ],\n      },\n      // if the source, query, and cookie are matched,\n      // the `x-authorized` header will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // header key/values since value is provided and\n            // doesn't use a named capture group e.g. (?&lt;page&gt;home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-authorized',\n            value: ':authorized',\n          },\n        ],\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, the `x-another-header` will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?&lt;authorized&gt;yes|true)',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: ':authorized',\n          },\n        ],\n      },\n      // if the host is `example.com`,\n      // this header will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: ':authorized',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"headers-with-basepath-support\" data-docs-heading=\"\">Headers with basePath support     </h2> <p>When leveraging <a href=\"basepath\"><code>basePath</code> support</a> with headers each <code>source</code> is automatically prefixed with the <code>basePath</code> unless you add <code>basePath: false</code> to the header:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  basePath: '/docs',\n \n  async headers() {\n    return [\n      {\n        source: '/with-basePath', // becomes /docs/with-basePath\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        source: '/without-basePath', // is not modified since basePath: false is set\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n        basePath: false,\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"headers-with-i18n-support\" data-docs-heading=\"\">Headers with i18n support     </h2> <p>When leveraging <a href=\"../../building-your-application/routing/internationalization\"><code>i18n</code> support</a> with headers each <code>source</code> is automatically prefixed to handle the configured <code>locales</code> unless you add <code>locale: false</code> to the header. If <code>locale: false</code> is used you must prefix the <code>source</code> with a locale for it to be matched correctly.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },\n \n  async headers() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        locale: false,\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        locale: false,\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"cache-control\" data-docs-heading=\"\">Cache-Control     </h2> <p>You cannot set <code>Cache-Control</code> headers in <code>next.config.js</code> for pages or assets, as these headers will be overwritten in production to ensure that responses and static assets are cached effectively.</p> <p>Learn more about <a href=\"../../building-your-application/caching\">caching</a> with the App Router.</p>  <h2 id=\"options\" data-docs-heading=\"\">Options     </h2> <h3 id=\"cors\" data-docs-heading=\"\">CORS     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/CORS\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cross-Origin Resource Sharing (CORS)</a> is a security feature that allows you to control which sites can access your resources. You can set the <code>Access-Control-Allow-Origin</code> header to allow a specific origin to access your Route Handlers.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">async headers() {\n    return [\n      {\n        source: \"/api/:path*\",\n        headers: [\n          {\n            key: \"Access-Control-Allow-Origin\",\n            value: \"*\", // Set your origin\n          },\n          {\n            key: \"Access-Control-Allow-Methods\",\n            value: \"GET, POST, PUT, DELETE, OPTIONS\",\n          },\n          {\n            key: \"Access-Control-Allow-Headers\",\n            value: \"Content-Type, Authorization\",\n          },\n        ],\n      },\n    ];\n  },</pre>\n</div> <h3 id=\"x-dns-prefetch-control\" data-docs-heading=\"\">X-DNS-Prefetch-Control     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> controls DNS prefetching, allowing browsers to proactively perform domain name resolution on external links, images, CSS, JavaScript, and more. This prefetching is performed in the background, so the <a href=\"https://developer.mozilla.org/docs/Glossary/DNS\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">DNS</a> is more likely to be resolved by the time the referenced items are needed. This reduces latency when the user clicks a link.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'X-DNS-Prefetch-Control',\n  value: 'on'\n}</pre>\n</div> <h3 id=\"strict-transport-security\" data-docs-heading=\"\">Strict-Transport-Security     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Strict-Transport-Security\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> informs browsers it should only be accessed using HTTPS, instead of using HTTP. Using the configuration below, all present and future subdomains will use HTTPS for a <code>max-age</code> of 2 years. This blocks access to pages or subdomains that can only be served over HTTP.</p> <p>If you're deploying to <a href=\"https://vercel.com/docs/concepts/edge-network/headers#strict-transport-security?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, this header is not necessary as it's automatically added to all deployments unless you declare <code>headers</code> in your <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'Strict-Transport-Security',\n  value: 'max-age=63072000; includeSubDomains; preload'\n}</pre>\n</div> <h3 id=\"x-frame-options\" data-docs-heading=\"\">X-Frame-Options     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> indicates whether the site should be allowed to be displayed within an <code>iframe</code>. This can prevent against clickjacking attacks.</p> <p><strong>This header has been superseded by CSP's <code>frame-ancestors</code> option</strong>, which has better support in modern browsers (see <a href=\"../../building-your-application/configuring/content-security-policy\">Content Security Policy</a> for configuration details).</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'X-Frame-Options',\n  value: 'SAMEORIGIN'\n}</pre>\n</div> <h3 id=\"permissions-policy\" data-docs-heading=\"\">Permissions-Policy     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Permissions-Policy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> allows you to control which features and APIs can be used in the browser. It was previously named <code>Feature-Policy</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'Permissions-Policy',\n  value: 'camera=(), microphone=(), geolocation=(), browsing-topics=()'\n}</pre>\n</div> <h3 id=\"x-content-type-options\" data-docs-heading=\"\">X-Content-Type-Options     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Content-Type-Options\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> prevents the browser from attempting to guess the type of content if the <code>Content-Type</code> header is not explicitly set. This can prevent XSS exploits for websites that allow users to upload and share files.</p> <p>For example, a user trying to download an image, but having it treated as a different <code>Content-Type</code> like an executable, which could be malicious. This header also applies to downloading browser extensions. The only valid value for this header is <code>nosniff</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'X-Content-Type-Options',\n  value: 'nosniff'\n}</pre>\n</div> <h3 id=\"referrer-policy\" data-docs-heading=\"\">Referrer-Policy     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Referrer-Policy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> controls how much information the browser includes when navigating from the current website (origin) to another.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'Referrer-Policy',\n  value: 'origin-when-cross-origin'\n}</pre>\n</div> <h3 id=\"content-security-policy\" data-docs-heading=\"\">Content-Security-Policy     </h3> <p>Learn more about adding a <a href=\"../../building-your-application/configuring/content-security-policy\">Content Security Policy</a> to your application.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>missing</code> added.</td>\n</tr>\n<tr>\n<td><code>v10.2.0</code></td>\n<td>\n<code>has</code> added.</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>Headers added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/headers\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/headers</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/images":"<h1 class=\"break-words\">images</h1> <p>If you want to use a cloud provider to optimize images instead of using the Next.js built-in Image Optimization API, you can configure <code>next.config.js</code> with the following:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    loader: 'custom',\n    loaderFile: './my/image/loader.js',\n  },\n}</pre></div> <p>This <code>loaderFile</code> must point to a file relative to the root of your Next.js application. The file must export a default function that returns a string, for example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nexport default function myImageLoader({ src, width, quality }) {\n  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`\n}</pre></div>\n<p>Alternatively, you can use the <a href=\"../components/image#loader\"><code>loader</code> prop</a> to pass the function to each instance of <code>next/image</code>.</p>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Customizing the image loader file, which accepts a function, requires using <a href=\"../../building-your-application/rendering/client-components\">Client Components</a> to serialize the provided function.</p> </blockquote>\n<p>To learn more about configuring the behavior of the built-in <a href=\"../../building-your-application/optimizing/images\">Image Optimization API</a> and the <a href=\"../components/image\">Image Component</a>, see <a href=\"../components/image#configuration-options\">Image Configuration Options</a> for available options.</p>  <h2 id=\"example-loader-configuration\" data-docs-heading=\"\">Example Loader Configuration     </h2> <ul> <li><a href=\"#akamai\">Akamai</a></li> <li><a href=\"#aws-cloudfront\">AWS CloudFront</a></li> <li><a href=\"#cloudinary\">Cloudinary</a></li> <li><a href=\"#cloudflare\">Cloudflare</a></li> <li><a href=\"#contentful\">Contentful</a></li> <li><a href=\"#fastly\">Fastly</a></li> <li><a href=\"#gumlet\">Gumlet</a></li> <li><a href=\"#imageengine\">ImageEngine</a></li> <li><a href=\"#imgix\">Imgix</a></li> <li><a href=\"#thumbor\">Thumbor</a></li> <li><a href=\"#sanity\">Sanity</a></li> <li><a href=\"#sirv\">Sirv</a></li> <li><a href=\"#supabase\">Supabase</a></li> </ul> <h3 id=\"akamai\" data-docs-heading=\"\">Akamai     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://techdocs.akamai.com/ivm/reference/test-images-on-demand\nexport default function akamaiLoader({ src, width, quality }) {\n  return `https://example.com/${src}?imwidth=${width}`\n}</pre>\n</div> <h3 id=\"aws-cloudfront\" data-docs-heading=\"\">AWS CloudFront     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://aws.amazon.com/developer/application-security-performance/articles/image-optimization\nexport default function cloudfrontLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('format', 'auto')\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href</pre>\n</div> <h3 id=\"cloudinary\" data-docs-heading=\"\">Cloudinary     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Demo: https://res.cloudinary.com/demo/image/upload/w_300,c_limit,q_auto/turtles.jpg\nexport default function cloudinaryLoader({ src, width, quality }) {\n  const params = ['f_auto', 'c_limit', `w_${width}`, `q_${quality || 'auto'}`]\n  return `https://example.com/${params.join(',')}${src}`\n}</pre>\n</div> <h3 id=\"cloudflare\" data-docs-heading=\"\">Cloudflare     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://developers.cloudflare.com/images/url-format\nexport default function cloudflareLoader({ src, width, quality }) {\n  const params = [`width=${width}`, `quality=${quality || 75}`, 'format=auto']\n  return `https://example.com/cdn-cgi/image/${params.join(',')}/${src}`\n}</pre>\n</div> <h3 id=\"contentful\" data-docs-heading=\"\">Contentful     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://www.contentful.com/developers/docs/references/images-api/\nexport default function contentfulLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('fm', 'webp')\n  url.searchParams.set('w', width.toString())\n  url.searchParams.set('q', (quality || 75).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"fastly\" data-docs-heading=\"\">Fastly     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://developer.fastly.com/reference/io/\nexport default function fastlyLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('auto', 'webp')\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"gumlet\" data-docs-heading=\"\">Gumlet     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://docs.gumlet.com/reference/image-transform-size\nexport default function gumletLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('format', 'auto')\n  url.searchParams.set('w', width.toString())\n  url.searchParams.set('q', (quality || 75).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"imageengine\" data-docs-heading=\"\">ImageEngine     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://support.imageengine.io/hc/en-us/articles/360058880672-Directives\nexport default function imageengineLoader({ src, width, quality }) {\n  const compression = 100 - (quality || 50)\n  const params = [`w_${width}`, `cmpr_${compression}`)]\n  return `https://example.com${src}?imgeng=/${params.join('/')`\n}</pre>\n</div> <h3 id=\"imgix\" data-docs-heading=\"\">Imgix     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Demo: https://static.imgix.net/daisy.png?format=auto&amp;fit=max&amp;w=300\nexport default function imgixLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  const params = url.searchParams\n  params.set('auto', params.getAll('auto').join(',') || 'format')\n  params.set('fit', params.get('fit') || 'max')\n  params.set('w', params.get('w') || width.toString())\n  params.set('q', (quality || 50).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"thumbor\" data-docs-heading=\"\">Thumbor     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://thumbor.readthedocs.io/en/latest/\nexport default function thumborLoader({ src, width, quality }) {\n  const params = [`${width}x0`, `filters:quality(${quality || 75})`]\n  return `https://example.com${params.join('/')}${src}`\n}</pre>\n</div> <h3 id=\"sanity\" data-docs-heading=\"\">Sanity     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://www.sanity.io/docs/image-urls\nexport default function sanityLoader({ src, width, quality }) {\n  const prj = 'zp7mbokg'\n  const dataset = 'production'\n  const url = new URL(`https://cdn.sanity.io/images/${prj}/${dataset}${src}`)\n  url.searchParams.set('auto', 'format')\n  url.searchParams.set('fit', 'max')\n  url.searchParams.set('w', width.toString())\n  if (quality) {\n    url.searchParams.set('q', quality.toString())\n  }\n  return url.href\n}</pre>\n</div> <h3 id=\"sirv\" data-docs-heading=\"\">Sirv     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://sirv.com/help/articles/dynamic-imaging/\nexport default function sirvLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  const params = url.searchParams\n  params.set('format', params.getAll('format').join(',') || 'optimal')\n  params.set('w', params.get('w') || width.toString())\n  params.set('q', (quality || 85).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"supabase\" data-docs-heading=\"\">Supabase     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://supabase.com/docs/guides/storage/image-transformations#nextjs-loader\nexport default function supabaseLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/images\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/images</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/exportpathmap":"<h1 class=\"break-words\">exportPathMap (Deprecated)</h1> <blockquote class=\"p-3 text-sm\"> <p>This feature is exclusive to <code>next export</code> and currently <strong>deprecated</strong> in favor of <code>getStaticPaths</code> with <code>pages</code> or <code>generateStaticParams</code> with <code>app</code>.</p> </blockquote> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-static-export\" rel=\"noopener noreferrer\" target=\"_blank\">Static Export</a></li> </ul></details> <p><code>exportPathMap</code> allows you to specify a mapping of request paths to page destinations, to be used during export. Paths defined in <code>exportPathMap</code> will also be available when using <a href=\"../next-cli#development\"><code>next dev</code></a>.</p> <p>Let's start with an example, to create a custom <code>exportPathMap</code> for an app with the following pages:</p> <ul> <li><code>pages/index.js</code></li> <li><code>pages/about.js</code></li> <li><code>pages/post.js</code></li> </ul> <p>Open <code>next.config.js</code> and add the following <code>exportPathMap</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  exportPathMap: async function (\n    defaultPathMap,\n    { dev, dir, outDir, distDir, buildId }\n  ) {\n    return {\n      '/': { page: '/' },\n      '/about': { page: '/about' },\n      '/p/hello-nextjs': { page: '/post', query: { title: 'hello-nextjs' } },\n      '/p/learn-nextjs': { page: '/post', query: { title: 'learn-nextjs' } },\n      '/p/deploy-nextjs': { page: '/post', query: { title: 'deploy-nextjs' } },\n    }\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: the <code>query</code> field in <code>exportPathMap</code> cannot be used with <a href=\"../../../pages/building-your-application/rendering/automatic-static-optimization\">automatically statically optimized pages</a> or <a href=\"../../../pages/building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code> pages</a> as they are rendered to HTML files at build-time and additional query information cannot be provided during <code>next export</code>.</p> </blockquote> <p>The pages will then be exported as HTML files, for example, <code>/about</code> will become <code>/about.html</code>.</p> <p><code>exportPathMap</code> is an <code>async</code> function that receives 2 arguments: the first one is <code>defaultPathMap</code>, which is the default map used by Next.js. The second argument is an object with:</p> <ul> <li>\n<code>dev</code> - <code>true</code> when <code>exportPathMap</code> is being called in development. <code>false</code> when running <code>next export</code>. In development <code>exportPathMap</code> is used to define routes.</li> <li>\n<code>dir</code> - Absolute path to the project directory</li> <li>\n<code>outDir</code> - Absolute path to the <code>out/</code> directory (<a href=\"#customizing-the-output-directory\">configurable with <code>-o</code></a>). When <code>dev</code> is <code>true</code> the value of <code>outDir</code> will be <code>null</code>.</li> <li>\n<code>distDir</code> - Absolute path to the <code>.next/</code> directory (configurable with the <a href=\"../../../pages/api-reference/next-config-js/distdir\"><code>distDir</code></a> config)</li> <li>\n<code>buildId</code> - The generated build id</li> </ul> <p>The returned object is a map of pages where the <code>key</code> is the <code>pathname</code> and the <code>value</code> is an object that accepts the following fields:</p> <ul> <li>\n<code>page</code>: <code>String</code> - the page inside the <code>pages</code> directory to render</li> <li>\n<code>query</code>: <code>Object</code> - the <code>query</code> object passed to <code>getInitialProps</code> when prerendering. Defaults to <code>{}</code>\n</li> </ul> <blockquote class=\"p-3 text-sm\"> <p>The exported <code>pathname</code> can also be a filename (for example, <code>/readme.md</code>), but you may need to set the <code>Content-Type</code> header to <code>text/html</code> when serving its content if it is different than <code>.html</code>.</p> </blockquote> <h2 id=\"adding-a-trailing-slash\" data-docs-heading=\"\">Adding a trailing slash     </h2> <p>It is possible to configure Next.js to export pages as <code>index.html</code> files and require trailing slashes, <code>/about</code> becomes <code>/about/index.html</code> and is routable via <code>/about/</code>. This was the default behavior prior to Next.js 9.</p> <p>To switch back and add a trailing slash, open <code>next.config.js</code> and enable the <code>trailingSlash</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  trailingSlash: true,\n}</pre></div> <h2 id=\"customizing-the-output-directory\" data-docs-heading=\"\">Customizing the output directory     </h2> <p><a href=\"../../building-your-application/deploying/static-exports\"><code>next export</code></a> will use <code>out</code> as the default output directory, you can customize this using the <code>-o</code> argument, like so:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next export -o outdir</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: Using <code>exportPathMap</code> is deprecated and is overridden by <code>getStaticPaths</code> inside <code>pages</code>. We don't recommend using them together.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/exportPathMap\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/exportPathMap</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/generateetags":"<h1 class=\"break-words\">generateEtags</h1> <p>Next.js will generate <a href=\"https://en.wikipedia.org/wiki/HTTP_ETag\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">etags</a> for every page by default. You may want to disable etag generation for HTML pages depending on your cache strategy.</p> <p>Open <code>next.config.js</code> and disable the <code>generateEtags</code> option:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  generateEtags: false,\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/generateEtags\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/generateEtags</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/httpagentoptions":"<h1 class=\"break-words\">httpAgentOptions</h1> <p>In Node.js versions prior to 18, Next.js automatically polyfills <code>fetch()</code> with <a href=\"../../../architecture/supported-browsers#polyfills\">undici</a> and enables <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Keep-Alive\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP Keep-Alive</a> by default.</p> <p>To disable HTTP Keep-Alive for all <code>fetch()</code> calls on the server-side, open <code>next.config.js</code> and add the <code>httpAgentOptions</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  httpAgentOptions: {\n    keepAlive: false,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/httpAgentOptions\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/httpAgentOptions</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/incrementalcachehandlerpath":"<h1 class=\"break-words\">Custom Next.js Cache Handler</h1>\n<p>In Next.js, the <a href=\"../../building-your-application/data-fetching/fetching-caching-and-revalidating\">default cache handler</a> for the Pages and App Router uses the filesystem cache. This requires no configuration, however, you can customize the cache handler by using the <code>cacheHandler</code> field in <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  cacheHandler: require.resolve('./cache-handler.js'),\n  cacheMaxMemorySize: 0, // disable default in-memory caching\n}</pre></div> <p>View an example of a <a href=\"../../building-your-application/deploying#configuring-caching\">custom cache handler</a> and learn more about implementation.</p> <h2 id=\"api-reference\" data-docs-heading=\"\">API Reference     </h2> <p>The cache handler can implement the following methods: <code>get</code>, <code>set</code>, and <code>revalidateTag</code>.</p> <h3 id=\"get\" data-docs-heading=\"\">get()     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody><tr>\n<td><code>key</code></td>\n<td><code>string</code></td>\n<td>The key to the cached value.</td>\n</tr></tbody>\n</table></div> <p>Returns the cached value or <code>null</code> if not found.</p> <h3 id=\"set\" data-docs-heading=\"\">set()     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>key</code></td>\n<td><code>string</code></td>\n<td>The key to store the data under.</td>\n</tr>\n<tr>\n<td><code>data</code></td>\n<td>Data or <code>null</code>\n</td>\n<td>The data to be cached.</td>\n</tr>\n<tr>\n<td><code>ctx</code></td>\n<td><code>{ tags: [] }</code></td>\n<td>The cache tags provided.</td>\n</tr>\n</tbody>\n</table></div> <p>Returns <code>Promise&lt;void&gt;</code>.</p> <h3 id=\"revalidatetag\" data-docs-heading=\"\">revalidateTag()     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody><tr>\n<td><code>tag</code></td>\n<td><code>string</code></td>\n<td>The cache tag to revalidate.</td>\n</tr></tbody>\n</table></div> <p>Returns <code>Promise&lt;void&gt;</code>. Learn more about <a href=\"../../building-your-application/data-fetching/fetching-caching-and-revalidating\">revalidating data</a> or the <a href=\"../functions/revalidatetag\"><code>revalidateTag()</code></a> function.</p> <p><strong>Good to know:</strong></p> <ul> <li>\n<code>revalidatePath</code> is a convenience layer on top of cache tags. Calling <code>revalidatePath</code> will call your <code>revalidateTag</code> function, which you can then choose if you want to tag cache keys based on the path.</li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v14.1.0</code></td>\n<td>Renamed <code>cacheHandler</code> is stable.</td>\n</tr>\n<tr>\n<td><code>v13.4.0</code></td>\n<td>\n<code>incrementalCacheHandlerPath</code> (experimental) supports <code>revalidateTag</code>.</td>\n</tr>\n<tr>\n<td><code>v13.4.0</code></td>\n<td>\n<code>incrementalCacheHandlerPath</code> (experimental) supports standalone output.</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>\n<code>incrementalCacheHandlerPath</code> (experimental) is added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/incrementalCacheHandlerPath\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/incrementalCacheHandlerPath</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/instrumentationhook":"<h1 class=\"break-words\">instrumentationHook</h1> <p>The experimental <code>instrumentationHook</code> option allows you to set up instrumentation via the <a href=\"../file-conventions/instrumentation\"><code>instrumentation</code> file</a> in your Next.js App.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    instrumentationHook: true,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/instrumentationHook\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/instrumentationHook</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/logging":"<h1 class=\"break-words\">logging</h1> <p>You can configure the logging level and whether the full URL is logged to the console when running Next.js in development mode.</p> <p>Currently, <code>logging</code> only applies to data fetching using the <code>fetch</code> API. It does not yet apply to other logs inside of Next.js.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  logging: {\n    fetches: {\n      fullUrl: true,\n    },\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/logging\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/logging</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/mdxrs":"<h1 class=\"break-words\">mdxRs</h1>\n<p>For use with <code>@next/mdx</code>. Compile MDX files using the new Rust compiler.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const withMDX = require('@next/mdx')()\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  pageExtensions: ['ts', 'tsx', 'mdx'],\n  experimental: {\n    mdxRs: true,\n  },\n}\n \nmodule.exports = withMDX(nextConfig)</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/mdxRs\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/mdxRs</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/partial-prerendering":"<h1 class=\"break-words\">Partial Prerendering (experimental)</h1>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: Partial Prerendering is an experimental feature and is currently <strong>not suitable for production environments</strong>.</p> </blockquote> <p>Partial Prerendering is an experimental feature that allows static portions of a route to be prerendered and served from the cache with dynamic holes streamed in, all in a single HTTP request.</p> <p>Partial Prerendering is available in <code>next@canary</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@canary</pre></div> <p>You can enable Partial Prerendering by setting the experimental <code>ppr</code> flag:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    ppr: true,\n  },\n}\n \nmodule.exports = nextConfig</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>Partial Prerendering does not yet apply to client-side navigations. We are actively working on this.</li> <li>Partial Prerendering is designed for the <a href=\"../../building-your-application/rendering/edge-and-nodejs-runtimes\">Node.js runtime</a> only. Using the subset of the Node.js runtime is not needed when you can instantly serve the static shell.</li> </ul> </blockquote> <p>Learn more about Partial Prerendering in the <a href=\"https://nextjs.org/learn/dashboard-app/partial-prerendering\">Next.js Learn course</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/partial-prerendering\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/partial-prerendering</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/poweredbyheader":"<h1 class=\"break-words\">poweredByHeader</h1> <p>By default Next.js will add the <code>x-powered-by</code> header. To opt-out of it, open <code>next.config.js</code> and disable the <code>poweredByHeader</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  poweredByHeader: false,\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/poweredByHeader\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/poweredByHeader</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/productionbrowsersourcemaps":"<h1 class=\"break-words\">productionBrowserSourceMaps</h1> <p>Source Maps are enabled by default during development. During production builds, they are disabled to prevent you leaking your source on the client, unless you specifically opt-in with the configuration flag.</p> <p>Next.js provides a configuration flag you can use to enable browser source map generation during the production build:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  productionBrowserSourceMaps: true,\n}</pre></div> <p>When the <code>productionBrowserSourceMaps</code> option is enabled, the source maps will be output in the same directory as the JavaScript files. Next.js will automatically serve these files when requested.</p> <ul> <li>Adding source maps can increase <code>next build</code> time</li> <li>Increases memory usage during <code>next build</code>\n</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/productionBrowserSourceMaps\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/productionBrowserSourceMaps</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/ondemandentries":"<h1 class=\"break-words\">onDemandEntries</h1> <p>Next.js exposes some options that give you some control over how the server will dispose or keep in memory built pages in development.</p> <p>To change the defaults, open <code>next.config.js</code> and add the <code>onDemandEntries</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  onDemandEntries: {\n    // period (in ms) where the server will keep pages in the buffer\n    maxInactiveAge: 25 * 1000,\n    // number of pages that should be kept simultaneously without being disposed\n    pagesBufferLength: 2,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/onDemandEntries\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/onDemandEntries</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/optimizepackageimports":"<h1 class=\"break-words\">optimizePackageImports</h1> <p>Some packages can export hundreds or thousands of modules, which can cause performance issues in development and production.</p> <p>Adding a package to <code>experimental.optimizePackageImports</code> will only load the modules you are actually using, while still giving you the convenience of writing import statements with many named exports.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    optimizePackageImports: ['package-name'],\n  },\n}</pre></div> <p>The following libraries are optimized by default:</p> <ul> <li><code>lucide-react</code></li> <li><code>date-fns</code></li> <li><code>lodash-es</code></li> <li><code>ramda</code></li> <li><code>antd</code></li> <li><code>react-bootstrap</code></li> <li><code>ahooks</code></li> <li><code>@ant-design/icons</code></li> <li><code>@headlessui/react</code></li> <li><code>@headlessui-float/react</code></li> <li><code>@heroicons/react/20/solid</code></li> <li><code>@heroicons/react/24/solid</code></li> <li><code>@heroicons/react/24/outline</code></li> <li><code>@visx/visx</code></li> <li><code>@tremor/react</code></li> <li><code>rxjs</code></li> <li><code>@mui/material</code></li> <li><code>@mui/icons-material</code></li> <li><code>recharts</code></li> <li><code>react-use</code></li> <li><code>@material-ui/core</code></li> <li><code>@material-ui/icons</code></li> <li><code>@tabler/icons-react</code></li> <li><code>mui-core</code></li> <li><code>react-icons/*</code></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/optimizePackageImports\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/optimizePackageImports</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/output":"<h1 class=\"break-words\">output</h1> <p>During a build, Next.js will automatically trace each page and its dependencies to determine all of the files that are needed for deploying a production version of your application.</p> <p>This feature helps reduce the size of deployments drastically. Previously, when deploying with Docker you would need to have all files from your package's <code>dependencies</code> installed to run <code>next start</code>. Starting with Next.js 12, you can leverage Output File Tracing in the <code>.next/</code> directory to only include the necessary files.</p> <p>Furthermore, this removes the need for the deprecated <code>serverless</code> target which can cause various issues and also creates unnecessary duplication.</p> <h2 id=\"how-it-works\" data-docs-heading=\"\">How it Works     </h2> <p>During <code>next build</code>, Next.js will use <a href=\"https://github.com/vercel/nft\" rel=\"noopener noreferrer\" target=\"_blank\"><code>@vercel/nft</code></a> to statically analyze <code>import</code>, <code>require</code>, and <code>fs</code> usage to determine all files that a page might load.</p> <p>Next.js' production server is also traced for its needed files and output at <code>.next/next-server.js.nft.json</code> which can be leveraged in production.</p> <p>To leverage the <code>.nft.json</code> files emitted to the <code>.next</code> output directory, you can read the list of files in each trace that are relative to the <code>.nft.json</code> file and then copy them to your deployment location.</p> <h2 id=\"automatically-copying-traced-files\" data-docs-heading=\"\">Automatically Copying Traced Files     </h2> <p>Next.js can automatically create a <code>standalone</code> folder that copies only the necessary files for a production deployment including select files in <code>node_modules</code>.</p> <p>To leverage this automatic copying you can enable it in your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  output: 'standalone',\n}</pre></div> <p>This will create a folder at <code>.next/standalone</code> which can then be deployed on its own without installing <code>node_modules</code>.</p> <p>Additionally, a minimal <code>server.js</code> file is also output which can be used instead of <code>next start</code>. This minimal server does not copy the <code>public</code> or <code>.next/static</code> folders by default as these should ideally be handled by a CDN instead, although these folders can be copied to the <code>standalone/public</code> and <code>standalone/.next/static</code> folders manually, after which <code>server.js</code> file will serve these automatically.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If your project needs to listen to a specific port or hostname, you can define <code>PORT</code> or <code>HOSTNAME</code> environment variables before running <code>server.js</code>. For example, run <code>PORT=8080 HOSTNAME=0.0.0.0 node server.js</code> to start the server on <code>http://0.0.0.0:8080</code>.</li> <li>If your project uses <a href=\"../../building-your-application/optimizing/images\">Image Optimization</a> with the default <code>loader</code>, you must install <code>sharp</code> as a dependency:</li> </ul> </blockquote>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i sharp</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add sharp</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm add sharp</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add sharp</pre></div> <h2 id=\"caveats\" data-docs-heading=\"\">Caveats     </h2> <ul> <li>While tracing in monorepo setups, the project directory is used for tracing by default. For <code>next build packages/web-app</code>, <code>packages/web-app</code> would be the tracing root and any files outside of that folder will not be included. To include files outside of this folder you can set <code>experimental.outputFileTracingRoot</code> in your <code>next.config.js</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    // this includes files from the monorepo base two directories up\n    outputFileTracingRoot: path.join(__dirname, '../../'),\n  },\n}</pre></div> <ul> <li>There are some cases in which Next.js might fail to include required files, or might incorrectly include unused files. In those cases, you can leverage <code>experimental.outputFileTracingExcludes</code> and <code>experimental.outputFileTracingIncludes</code> respectively in <code>next.config.js</code>. Each config accepts an object with <a href=\"https://www.npmjs.com/package/minimatch\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">minimatch globs</a> for the key to match specific pages and a value of an array with globs relative to the project's root to either include or exclude in the trace.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    outputFileTracingExcludes: {\n      '/api/hello': ['./un-necessary-folder/**/*'],\n    },\n    outputFileTracingIncludes: {\n      '/api/another': ['./necessary-folder/**/*'],\n    },\n  },\n}</pre></div> <ul> <li>Currently, Next.js does not do anything with the emitted <code>.nft.json</code> files. The files must be read by your deployment platform, for example <a href=\"https://vercel.com\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, to create a minimal deployment. In a future release, a new command is planned to utilize these <code>.nft.json</code> files.</li> </ul> <h2 id=\"experimental-turbotrace\" data-docs-heading=\"\">Experimental turbotrace     </h2> <p>Tracing dependencies can be slow because it requires very complex computations and analysis. We created <code>turbotrace</code> in Rust as a faster and smarter alternative to the JavaScript implementation.</p> <p>To enable it, you can add the following configuration to your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    turbotrace: {\n      // control the log level of the turbotrace, default is `error`\n      logLevel?:\n      | 'bug'\n      | 'fatal'\n      | 'error'\n      | 'warning'\n      | 'hint'\n      | 'note'\n      | 'suggestions'\n      | 'info',\n      // control if the log of turbotrace should contain the details of the analysis, default is `false`\n      logDetail?: boolean\n      // show all log messages without limit\n      // turbotrace only show 1 log message for each categories by default\n      logAll?: boolean\n      // control the context directory of the turbotrace\n      // files outside of the context directory will not be traced\n      // set the `experimental.outputFileTracingRoot` has the same effect\n      // if the `experimental.outputFileTracingRoot` and this option are both set, the `experimental.turbotrace.contextDirectory` will be used\n      contextDirectory?: string\n      // if there is `process.cwd()` expression in your code, you can set this option to tell `turbotrace` the value of `process.cwd()` while tracing.\n      // for example the require(process.cwd() + '/package.json') will be traced as require('/path/to/cwd/package.json')\n      processCwd?: string\n      // control the maximum memory usage of the `turbotrace`, in `MB`, default is `6000`.\n      memoryLimit?: number\n    },\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/output\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/output</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/redirects":"<h1 class=\"break-words\">redirects</h1> <p>Redirects allow you to redirect an incoming request path to a different destination path.</p> <p>To use redirects you can use the <code>redirects</code> key in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/about',\n        destination: '/',\n        permanent: true,\n      },\n    ]\n  },\n}</pre></div> <p><code>redirects</code> is an async function that expects an array to be returned holding objects with <code>source</code>, <code>destination</code>, and <code>permanent</code> properties:</p> <ul> <li>\n<code>source</code> is the incoming request path pattern.</li> <li>\n<code>destination</code> is the path you want to route to.</li> <li>\n<code>permanent</code> <code>true</code> or <code>false</code> - if <code>true</code> will use the 308 status code which instructs clients/search engines to cache the redirect forever, if <code>false</code> will use the 307 status code which is temporary and is not cached.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Why does Next.js use 307 and 308?</strong> Traditionally a 302 was used for a temporary redirect, and a 301 for a permanent redirect, but many browsers changed the request method of the redirect to <code>GET</code>, regardless of the original method. For example, if the browser made a request to <code>POST /v1/users</code> which returned status code <code>302</code> with location <code>/v2/users</code>, the subsequent request might be <code>GET /v2/users</code> instead of the expected <code>POST /v2/users</code>. Next.js uses the 307 temporary redirect, and 308 permanent redirect status codes to explicitly preserve the request method used.</p> </blockquote> <ul> <li>\n<code>basePath</code>: <code>false</code> or <code>undefined</code> - if false the <code>basePath</code> won't be included when matching, can be used for external redirects only.</li> <li>\n<code>locale</code>: <code>false</code> or <code>undefined</code> - whether the locale should not be included when matching.</li> <li>\n<code>has</code> is an array of <a href=\"#header-cookie-and-query-matching\">has objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> <li>\n<code>missing</code> is an array of <a href=\"#header-cookie-and-query-matching\">missing objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> </ul> <p>Redirects are checked before the filesystem which includes pages and <code>/public</code> files.</p> <p>When using the Pages Router, redirects are not applied to client-side routing (<code>Link</code>, <code>router.push</code>) unless <a href=\"../../building-your-application/routing/middleware\">Middleware</a> is present and matches the path.</p> <p>When a redirect is applied, any query values provided in the request will be passed through to the redirect destination. For example, see the following redirect configuration:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  source: '/old-blog/:path*',\n  destination: '/blog/:path*',\n  permanent: false\n}</pre>\n</div> <p>When <code>/old-blog/post-1?hello=world</code> is requested, the client will be redirected to <code>/blog/post-1?hello=world</code>.</p> <h2 id=\"path-matching\" data-docs-heading=\"\">Path Matching     </h2> <p>Path matches are allowed, for example <code>/old-blog/:slug</code> will match <code>/old-blog/hello-world</code> (no nested paths):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/old-blog/:slug',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n        permanent: true,\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"wildcard-path-matching\" data-docs-heading=\"\">Wildcard Path Matching     </h3> <p>To match a wildcard path you can use <code>*</code> after a parameter, for example <code>/blog/:slug*</code> will match <code>/blog/a/b/c/d/hello-world</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/blog/:slug*',\n        destination: '/news/:slug*', // Matched parameters can be used in the destination\n        permanent: true,\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"regex-path-matching\" data-docs-heading=\"\">Regex Path Matching     </h3> <p>To match a regex path you can wrap the regex in parentheses after a parameter, for example <code>/post/:slug(\\\\d{1,})</code> will match <code>/post/123</code> but not <code>/post/abc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/post/:slug(\\\\d{1,})',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n        permanent: false,\n      },\n    ]\n  },\n}</pre></div> <p>The following characters <code>(</code>, <code>)</code>, <code>{</code>, <code>}</code>, <code>:</code>, <code>*</code>, <code>+</code>, <code>?</code> are used for regex path matching, so when used in the <code>source</code> as non-special values they must be escaped by adding <code>\\\\</code> before them:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        destination: '/en-us/:slug',\n        permanent: false,\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"header-cookie-and-query-matching\" data-docs-heading=\"\">Header, Cookie, and Query Matching     </h2> <p>To only match a redirect when header, cookie, or query values also match the <code>has</code> field or don't match the <code>missing</code> field can be used. Both the <code>source</code> and all <code>has</code> items must match and all <code>missing</code> items must not match for the redirect to be applied.</p> <p><code>has</code> and <code>missing</code> items can have the following fields:</p> <ul> <li>\n<code>type</code>: <code>String</code> - must be either <code>header</code>, <code>cookie</code>, <code>host</code>, or <code>query</code>.</li> <li>\n<code>key</code>: <code>String</code> - the key from the selected type to match against.</li> <li>\n<code>value</code>: <code>String</code> or <code>undefined</code> - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value <code>first-(?&lt;paramName&gt;.*)</code> is used for <code>first-second</code> then <code>second</code> will be usable in the destination with <code>:paramName</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      // if the header `x-redirect-me` is present,\n      // this redirect will be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        has: [\n          {\n            type: 'header',\n            key: 'x-redirect-me',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n      // if the header `x-dont-redirect` is present,\n      // this redirect will NOT be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-do-not-redirect',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n      // if the source, query, and cookie are matched,\n      // this redirect will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // destination since value is provided and doesn't\n            // use a named capture group e.g. (?&lt;page&gt;home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        permanent: false,\n        destination: '/another/:path*',\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, this redirect will be applied\n      {\n        source: '/',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?&lt;authorized&gt;yes|true)',\n          },\n        ],\n        permanent: false,\n        destination: '/home?authorized=:authorized',\n      },\n      // if the host is `example.com`,\n      // this redirect will be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"redirects-with-basepath-support\" data-docs-heading=\"\">Redirects with basePath support     </h3> <p>When leveraging <a href=\"basepath\"><code>basePath</code> support</a> with redirects each <code>source</code> and <code>destination</code> is automatically prefixed with the <code>basePath</code> unless you add <code>basePath: false</code> to the redirect:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  basePath: '/docs',\n \n  async redirects() {\n    return [\n      {\n        source: '/with-basePath', // automatically becomes /docs/with-basePath\n        destination: '/another', // automatically becomes /docs/another\n        permanent: false,\n      },\n      {\n        // does not add /docs since basePath: false is set\n        source: '/without-basePath',\n        destination: 'https://example.com',\n        basePath: false,\n        permanent: false,\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"redirects-with-i18n-support\" data-docs-heading=\"\">Redirects with i18n support     </h3> <p>When leveraging <a href=\"../../building-your-application/routing/internationalization\"><code>i18n</code> support</a> with redirects each <code>source</code> and <code>destination</code> is automatically prefixed to handle the configured <code>locales</code> unless you add <code>locale: false</code> to the redirect. If <code>locale: false</code> is used you must prefix the <code>source</code> and <code>destination</code> with a locale for it to be matched correctly.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },\n \n  async redirects() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        destination: '/another', // automatically passes the locale on\n        permanent: false,\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        destination: '/nl/another',\n        locale: false,\n        permanent: false,\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        destination: '/en/another',\n        locale: false,\n        permanent: false,\n      },\n      // it's possible to match all locales even when locale: false is set\n      {\n        source: '/:locale/page',\n        destination: '/en/newpage',\n        permanent: false,\n        locale: false,\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        destination: '/another',\n        permanent: false,\n      },\n    ]\n  },\n}</pre></div> <p>In some rare cases, you might need to assign a custom status code for older HTTP Clients to properly redirect. In these cases, you can use the <code>statusCode</code> property instead of the <code>permanent</code> property, but not both. To to ensure IE11 compatibility, a <code>Refresh</code> header is automatically added for the 308 status code.</p> <h2 id=\"other-redirects\" data-docs-heading=\"\">Other Redirects     </h2> <ul> <li>Inside <a href=\"../../../pages/building-your-application/routing/api-routes\">API Routes</a> and <a href=\"../../building-your-application/routing/route-handlers\">Route Handlers</a>, you can redirect based on the incoming request.</li> <li>Inside <a href=\"../../../pages/building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code></a> and <a href=\"../../../pages/building-your-application/data-fetching/get-server-side-props\"><code>getServerSideProps</code></a>, you can redirect specific pages at request-time.</li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>missing</code> added.</td>\n</tr>\n<tr>\n<td><code>v10.2.0</code></td>\n<td>\n<code>has</code> added.</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>\n<code>redirects</code> added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/redirects\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/redirects</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/serveractions":"<h1 class=\"break-words\">serverActions</h1>\n<p>Options for configuring Server Actions behavior in your Next.js application.</p> <h2 id=\"allowedorigins\" data-docs-heading=\"\">allowedOrigins     </h2> <p>A list of extra safe origin domains from which Server Actions can be invoked. Next.js compares the origin of a Server Action request with the host domain, ensuring they match to prevent CSRF attacks. If not provided, only the same origin is allowed.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\n \nmodule.exports = {\n  experimental: {\n    serverActions: {\n      allowedOrigins: ['my-proxy.com', '*.my-proxy.com'],\n    },\n  },\n}</pre></div> <h2 id=\"bodysizelimit\" data-docs-heading=\"\">bodySizeLimit     </h2> <p>By default, the maximum size of the request body sent to a Server Action is 1MB, to prevent the consumption of excessive server resources in parsing large amounts of data, as well as potential DDoS attacks.</p> <p>However, you can configure this limit using the <code>serverActions.bodySizeLimit</code> option. It can take the number of bytes or any string format supported by bytes, for example <code>1000</code>, <code>'500kb'</code> or <code>'3mb'</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\n \nmodule.exports = {\n  experimental: {\n    serverActions: {\n      bodySizeLimit: '2mb',\n    },\n  },\n}</pre></div> <h2 id=\"enabling-server-actions-v13\" data-docs-heading=\"\">Enabling Server Actions (v13)     </h2> <p>Server Actions became a stable feature in Next.js 14, and are enabled by default. However, if you are using an earlier version of Next.js, you can enable them by setting <code>experimental.serverActions</code> to <code>true</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst config = {\n  experimental: {\n    serverActions: true,\n  },\n}\n \nmodule.exports = config</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/serverActions\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/serverActions</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/staletimes":"<h1 class=\"break-words\">StaleTimes (experimental)</h1>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: The <code>staleTimes</code> configuration is an experimental feature. This configuration strategy will likely change in the future.</p> </blockquote> <p><code>staleTimes</code> is an experimental feature that allows configuring the <a href=\"../../building-your-application/caching#duration-3\">invalidation period</a> of the client router cache.</p> <p>This configuration option is available as of v14.2.0-canary.53.</p> <p>You can enable this experimental feature &amp; provide custom revalidation times by setting the experimental <code>staleTimes</code> flag:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    staleTimes: {\n      dynamic: 30,\n      static: 180,\n    },\n  },\n}\n \nmodule.exports = nextConfig</pre></div> <p>The <code>static</code> and <code>dynamic</code> properties correspond with the time period (in seconds) based on different types of <a href=\"../components/link#prefetch\">link prefetching</a>.</p> <ul> <li>The <code>dynamic</code> property is used when the <code>prefetch</code> prop on <code>Link</code> is left unspecified. <ul> <li>Default: 30 seconds</li> </ul> </li> <li>The <code>static</code> property is used when the <code>prefetch</code> prop on <code>Link</code> is set to <code>true</code>, or when calling <a href=\"../../building-your-application/caching#routerprefetch\"><code>router.prefetch</code></a>. <ul> <li>Default: 5 minutes</li> </ul> </li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>\n<a href=\"../file-conventions/loading\">Loading boundaries</a> are considered reusable for the <code>static</code> period defined in this configuration.</li> <li>This doesn't disable <a href=\"../../building-your-application/routing/linking-and-navigating#4-partial-rendering\">partial rendering support</a>, <strong>meaning shared layouts won't automatically be refetched every navigation, only the new segment data.</strong>\n</li> <li>This doesn't change <a href=\"../../building-your-application/caching#router-cache\">back/forward caching</a> behavior to prevent layout shift &amp; to prevent losing the browser scroll position.</li> <li>The different properties of this config refer to variable levels of \"liveness\" and are unrelated to whether the segment itself is opting into static or dynamic rendering. In other words, the current <code>static</code> default of 5 minutes suggests that data feels static by virtue of it being revalidated infrequently.</li> </ul> </blockquote> <p>You can learn more about the Client Router Cache <a href=\"../../building-your-application/caching#router-cache\">here</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/staleTimes\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/staleTimes</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/pageextensions":"<h1 class=\"break-words\">pageExtensions</h1> <p>By default, Next.js accepts files with the following extensions: <code>.tsx</code>, <code>.ts</code>, <code>.jsx</code>, <code>.js</code>. This can be modified to allow other extensions like markdown (<code>.md</code>, <code>.mdx</code>).</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const withMDX = require('@next/mdx')()\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  pageExtensions: ['ts', 'tsx', 'mdx'],\n  experimental: {\n    mdxRs: true,\n  },\n}\n \nmodule.exports = withMDX(nextConfig)</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/pageExtensions\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/pageExtensions</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/reactstrictmode":"<h1 class=\"break-words\">reactStrictMode</h1> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Since Next.js 13.4, Strict Mode is <code>true</code> by default with <code>app</code> router, so the above configuration is only necessary for <code>pages</code>. You can still disable Strict Mode by setting <code>reactStrictMode: false</code>.</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p><strong>Suggested</strong>: We strongly suggest you enable Strict Mode in your Next.js application to better prepare your application for the future of React.</p> </blockquote> <p>React's <a href=\"https://react.dev/reference/react/StrictMode\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Strict Mode</a> is a development mode only feature for highlighting potential problems in an application. It helps to identify unsafe lifecycles, legacy API usage, and a number of other features.</p> <p>The Next.js runtime is Strict Mode-compliant. To opt-in to Strict Mode, configure the following option in your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  reactStrictMode: true,\n}</pre></div> <p>If you or your team are not ready to use Strict Mode in your entire application, that's OK! You can incrementally migrate on a page-by-page basis using <code>&lt;React.StrictMode&gt;</code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/reactStrictMode\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/reactStrictMode</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/servercomponentsexternalpackages":"<h1 class=\"break-words\">serverComponentsExternalPackages</h1>\n<p>Dependencies used inside <a href=\"../../building-your-application/rendering/server-components\">Server Components</a> and <a href=\"../../building-your-application/routing/route-handlers\">Route Handlers</a> will automatically be bundled by Next.js.</p> <p>If a dependency is using Node.js specific features, you can choose to opt-out specific dependencies from the Server Components bundling and use native Node.js <code>require</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    serverComponentsExternalPackages: ['@acme/ui'],\n  },\n}\n \nmodule.exports = nextConfig</pre></div> <p>Next.js includes a <a href=\"https://github.com/vercel/next.js/blob/canary/packages/next/src/lib/server-external-packages.json\" rel=\"noopener noreferrer\" target=\"_blank\">short list of popular packages</a> that currently are working on compatibility and automatically opt-ed out:</p> <ul> <li><code>@aws-sdk/client-s3</code></li> <li><code>@aws-sdk/s3-presigned-post</code></li> <li><code>@blockfrost/blockfrost-js</code></li> <li><code>@highlight-run/node</code></li> <li><code>@jpg-store/lucid-cardano</code></li> <li><code>@libsql/client</code></li> <li><code>@mikro-orm/core</code></li> <li><code>@mikro-orm/knex</code></li> <li><code>@prisma/client</code></li> <li><code>@react-pdf/renderer</code></li> <li><code>@sentry/profiling-node</code></li> <li><code>@swc/core</code></li> <li><code>argon2</code></li> <li><code>autoprefixer</code></li> <li><code>aws-crt</code></li> <li><code>bcrypt</code></li> <li><code>better-sqlite3</code></li> <li><code>canvas</code></li> <li><code>cpu-features</code></li> <li><code>cypress</code></li> <li><code>eslint</code></li> <li><code>express</code></li> <li><code>firebase-admin</code></li> <li><code>jest</code></li> <li><code>jsdom</code></li> <li><code>libsql</code></li> <li><code>mdx-bundler</code></li> <li><code>mongodb</code></li> <li><code>mongoose</code></li> <li><code>next-mdx-remote</code></li> <li><code>next-seo</code></li> <li><code>node-pty</code></li> <li><code>node-web-audio-api</code></li> <li><code>pg</code></li> <li><code>playwright</code></li> <li><code>postcss</code></li> <li><code>prettier</code></li> <li><code>prisma</code></li> <li><code>puppeteer-core</code></li> <li><code>puppeteer</code></li> <li><code>rimraf</code></li> <li><code>sharp</code></li> <li><code>shiki</code></li> <li><code>sqlite3</code></li> <li><code>tailwindcss</code></li> <li><code>ts-node</code></li> <li><code>typescript</code></li> <li><code>vscode-oniguruma</code></li> <li><code>undici</code></li> <li><code>webpack</code></li> <li><code>websocket</code></li> <li><code>zeromq</code></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/serverComponentsExternalPackages\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/serverComponentsExternalPackages</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/trailingslash":"<h1 class=\"break-words\">trailingSlash</h1> <p>By default Next.js will redirect urls with trailing slashes to their counterpart without a trailing slash. For example <code>/about/</code> will redirect to <code>/about</code>. You can configure this behavior to act the opposite way, where urls without trailing slashes are redirected to their counterparts with trailing slashes.</p> <p>Open <code>next.config.js</code> and add the <code>trailingSlash</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  trailingSlash: true,\n}</pre></div> <p>With this option set, urls like <code>/about</code> will redirect to <code>/about/</code>.</p> <p>When used with <a href=\"../../building-your-application/deploying/static-exports\"><code>output: \"export\"</code></a> configuration, the <code>/about</code> page will output <code>/about/index.html</code> (instead of the default <code>/about.html</code>).</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v9.5.0</code></td>\n<td>\n<code>trailingSlash</code> added.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/trailingSlash\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/trailingSlash</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/turbo":"<h1 class=\"break-words\">turbo (Experimental)</h1> <p>Turbopack can be customized to transform different files and change how modules are resolved.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>These features are experimental and will only work with <code>next --turbo</code>.</li> <li>Turbopack for Next.js does not require loaders nor loader configuration for built-in functionality. Turbopack has built-in support for css and compiling modern JavaScript, so there's no need for <code>css-loader</code>, <code>postcss-loader</code>, or <code>babel-loader</code> if you're using <code>@babel/preset-env</code>.</li> </ul> </blockquote> <h2 id=\"webpack-loaders\" data-docs-heading=\"\">webpack loaders     </h2> <p>If you need loader support beyond what's built in, many webpack loaders already work with Turbopack. There are currently some limitations:</p> <ul> <li>Only a core subset of the webpack loader API is implemented. Currently, there is enough coverage for some popular loaders, and we'll expand our API support in the future.</li> <li>Only loaders that return JavaScript code are supported. Loaders that transform files like stylesheets or images are not currently supported.</li> <li>Options passed to webpack loaders must be plain JavaScript primitives, objects, and arrays. For example, it's not possible to pass <code>require()</code>d plugin modules as option values.</li> </ul> <p>To configure loaders, add the names of the loaders you've installed and any options in <code>next.config.js</code>, mapping file extensions to a list of loaders:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    turbo: {\n      rules: {\n        '*.svg': {\n          loaders: ['@svgr/webpack'],\n          as: '*.js',\n        },\n      },\n    },\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Prior to Next.js version 13.4.4, <code>experimental.turbo.rules</code> was named <code>experimental.turbo.loaders</code> and only accepted file extensions like <code>.mdx</code> instead of <code>*.mdx</code>.</p> </blockquote> <h3 id=\"supported-loaders\" data-docs-heading=\"\">Supported loaders     </h3> <p>The following loaders have been tested to work with Turbopack's webpack loader implementation:</p> <ul> <li><a href=\"https://www.npmjs.com/package/babel-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>babel-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/@svgr/webpack\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@svgr/webpack</code></a></li> <li><a href=\"https://www.npmjs.com/package/svg-inline-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>svg-inline-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/yaml-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>yaml-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/string-replace-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>string-replace-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/raw-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>raw-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/sass-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">'sass-loader'</a></li> </ul> <h2 id=\"resolve-aliases\" data-docs-heading=\"\">Resolve aliases     </h2> <p>Through <code>next.config.js</code>, Turbopack can be configured to modify module resolution through aliases, similar to webpack's <a href=\"https://webpack.js.org/configuration/resolve/#resolvealias\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>resolve.alias</code></a> configuration.</p> <p>To configure resolve aliases, map imported patterns to their new destination in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    turbo: {\n      resolveAlias: {\n        underscore: 'lodash',\n        mocha: { browser: 'mocha/browser-entry.js' },\n      },\n    },\n  },\n}</pre></div> <p>This aliases imports of the <code>underscore</code> package to the <code>lodash</code> package. In other words, <code>import underscore from 'underscore'</code> will load the <code>lodash</code> module instead of <code>underscore</code>.</p> <p>Turbopack also supports conditional aliasing through this field, similar to Node.js's <a href=\"https://nodejs.org/docs/latest-v18.x/api/packages.html#conditional-exports\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">conditional exports</a>. At the moment only the <code>browser</code> condition is supported. In the case above, imports of the <code>mocha</code> module will be aliased to <code>mocha/browser-entry.js</code> when Turbopack targets browser environments.</p> <h2 id=\"resolve-extensions\" data-docs-heading=\"\">Resolve extensions     </h2> <p>Through <code>next.config.js</code>, Turbopack can be configured to resolve modules with custom extensions, similar to webpack's <a href=\"https://webpack.js.org/configuration/resolve/#resolveextensions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>resolve.extensions</code></a> configuration.</p> <p>To configure resolve extensions, use the <code>resolveExtensions</code> field in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    turbo: {\n      resolveExtensions: [\n        '.mdx',\n        '.tsx',\n        '.ts',\n        '.jsx',\n        '.js',\n        '.mjs',\n        '.json',\n      ],\n    },\n  },\n}</pre></div> <p>This overwrites the original resolve extensions with the provided list. Make sure to include the default extensions.</p> <p>For more information and guidance for how to migrate your app to Turbopack from webpack, see <a href=\"https://turbo.build/pack/docs/migrating-from-webpack\" rel=\"noopener noreferrer\" target=\"_blank\">Turbopack's documentation on webpack compatibility</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/turbo\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/turbo</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/typescript":"<h1 class=\"break-words\">typescript</h1> <p>Next.js fails your <strong>production build</strong> (<code>next build</code>) when TypeScript errors are present in your project.</p> <p>If you'd like Next.js to dangerously produce production code even when your application has errors, you can disable the built-in type checking step.</p> <p>If disabled, be sure you are running type checks as part of your build or deploy process, otherwise this can be very dangerous.</p> <p>Open <code>next.config.js</code> and enable the <code>ignoreBuildErrors</code> option in the <code>typescript</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  typescript: {\n    // !! WARN !!\n    // Dangerously allow production builds to successfully complete even if\n    // your project has type errors.\n    // !! WARN !!\n    ignoreBuildErrors: true,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/typescript\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/typescript</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/urlimports":"<h1 class=\"break-words\">urlImports</h1> <p>URL imports are an experimental feature that allows you to import modules directly from external servers (instead of from the local disk).</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: This feature is experimental. Only use domains that you trust to download and execute on your machine. Please exercise discretion, and caution until the feature is flagged as stable.</p> </blockquote> <p>To opt-in, add the allowed URL prefixes inside <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    urlImports: ['https://example.com/assets/', 'https://cdn.skypack.dev'],\n  },\n}</pre></div> <p>Then, you can import modules directly from URLs:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { a, b, c } from 'https://example.com/assets/some/module.js'</pre>\n</div> <p>URL Imports can be used everywhere normal package imports can be used.</p> <h2 id=\"security-model\" data-docs-heading=\"\">Security Model     </h2> <p>This feature is being designed with <strong>security as the top priority</strong>. To start, we added an experimental flag forcing you to explicitly allow the domains you accept URL imports from. We're working to take this further by limiting URL imports to execute in the browser sandbox using the <a href=\"../edge\">Edge Runtime</a>.</p> <h2 id=\"lockfile\" data-docs-heading=\"\">Lockfile     </h2> <p>When using URL imports, Next.js will create a <code>next.lock</code> directory containing a lockfile and fetched assets. This directory <strong>must be committed to Git</strong>, not ignored by <code>.gitignore</code>.</p> <ul> <li>When running <code>next dev</code>, Next.js will download and add all newly discovered URL Imports to your lockfile</li> <li>When running <code>next build</code>, Next.js will use only the lockfile to build the application for production</li> </ul> <p>Typically, no network requests are needed and any outdated lockfile will cause the build to fail. One exception is resources that respond with <code>Cache-Control: no-cache</code>. These resources will have a <code>no-cache</code> entry in the lockfile and will always be fetched from the network on each build.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"skypack\" data-docs-heading=\"\">Skypack     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import confetti from 'https://cdn.skypack.dev/canvas-confetti'\nimport { useEffect } from 'react'\n \nexport default () =&gt; {\n  useEffect(() =&gt; {\n    confetti()\n  })\n  return &lt;p&gt;Hello&lt;/p&gt;\n}</pre>\n</div> <h3 id=\"static-image-imports\" data-docs-heading=\"\">Static Image Imports     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport logo from 'https://example.com/assets/logo.png'\n \nexport default () =&gt; (\n  &lt;div&gt;\n    &lt;Image src={logo} placeholder=\"blur\" /&gt;\n  &lt;/div&gt;\n)</pre>\n</div> <h3 id=\"urls-in-css\" data-docs-heading=\"\">URLs in CSS     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.className {\n  background: url('https://example.com/assets/hero.jpg');\n}</pre>\n</div> <h3 id=\"asset-imports\" data-docs-heading=\"\">Asset Imports     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const logo = new URL('https://example.com/assets/file.txt', import.meta.url)\n \nconsole.log(logo.pathname)\n \n// prints \"/_next/static/media/file.a9727b5d.txt\"</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/urlImports\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/urlImports</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/webvitalsattribution":"<h1 class=\"break-words\">webVitalsAttribution</h1> <p>When debugging issues related to Web Vitals, it is often helpful if we can pinpoint the source of the problem. For example, in the case of Cumulative Layout Shift (CLS), we might want to know the first element that shifted when the single largest layout shift occurred. Or, in the case of Largest Contentful Paint (LCP), we might want to identify the element corresponding to the LCP for the page. If the LCP element is an image, knowing the URL of the image resource can help us locate the asset we need to optimize.</p> <p>Pinpointing the biggest contributor to the Web Vitals score, aka <a href=\"https://github.com/GoogleChrome/web-vitals/blob/4ca38ae64b8d1e899028c692f94d4c56acfc996c/README.md#attribution\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">attribution</a>, allows us to obtain more in-depth information like entries for <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceEventTiming\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">PerformanceEventTiming</a>, <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceNavigationTiming\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">PerformanceNavigationTiming</a> and <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceResourceTiming\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">PerformanceResourceTiming</a>.</p> <p>Attribution is disabled by default in Next.js but can be enabled <strong>per metric</strong> by specifying the following in <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">experimental: {\n  webVitalsAttribution: ['CLS', 'LCP']\n}</pre></div> <p>Valid attribution values are all <code>web-vitals</code> metrics specified in the <a href=\"https://github.com/vercel/next.js/blob/442378d21dd56d6e769863eb8c2cb521a463a2e0/packages/next/shared/lib/utils.ts#L43\" rel=\"noopener noreferrer\" target=\"_blank\"><code>NextWebVitalsMetric</code></a> type.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/webVitalsAttribution\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/webVitalsAttribution</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/rewrites":"<h1 class=\"break-words\">rewrites</h1> <p>Rewrites allow you to map an incoming request path to a different destination path.</p> <p>Rewrites act as a URL proxy and mask the destination path, making it appear the user hasn't changed their location on the site. In contrast, <a href=\"redirects\">redirects</a> will reroute to a new page and show the URL changes.</p>  <p>To use rewrites you can use the <code>rewrites</code> key in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/about',\n        destination: '/',\n      },\n    ]\n  },\n}</pre></div> <p>Rewrites are applied to client-side routing, a <code>&lt;Link href=\"/about\"&gt;</code> will have the rewrite applied in the above example.</p> <p><code>rewrites</code> is an async function that expects to return either an array or an object of arrays (see below) holding objects with <code>source</code> and <code>destination</code> properties:</p> <ul> <li>\n<code>source</code>: <code>String</code> - is the incoming request path pattern.</li> <li>\n<code>destination</code>: <code>String</code> is the path you want to route to.</li> <li>\n<code>basePath</code>: <code>false</code> or <code>undefined</code> - if false the basePath won't be included when matching, can be used for external rewrites only.</li> <li>\n<code>locale</code>: <code>false</code> or <code>undefined</code> - whether the locale should not be included when matching.</li> <li>\n<code>has</code> is an array of <a href=\"#header-cookie-and-query-matching\">has objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> <li>\n<code>missing</code> is an array of <a href=\"#header-cookie-and-query-matching\">missing objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> </ul> <p>When the <code>rewrites</code> function returns an array, rewrites are applied after checking the filesystem (pages and <code>/public</code> files) and before dynamic routes. When the <code>rewrites</code> function returns an object of arrays with a specific shape, this behavior can be changed and more finely controlled, as of <code>v10.1</code> of Next.js:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return {\n      beforeFiles: [\n        // These rewrites are checked after headers/redirects\n        // and before all files including _next/public files which\n        // allows overriding page files\n        {\n          source: '/some-page',\n          destination: '/somewhere-else',\n          has: [{ type: 'query', key: 'overrideMe' }],\n        },\n      ],\n      afterFiles: [\n        // These rewrites are checked after pages/public files\n        // are checked but before dynamic routes\n        {\n          source: '/non-existent',\n          destination: '/somewhere-else',\n        },\n      ],\n      fallback: [\n        // These rewrites are checked after both pages/public files\n        // and dynamic routes are checked\n        {\n          source: '/:path*',\n          destination: `https://my-old-site.com/:path*`,\n        },\n      ],\n    }\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: rewrites in <code>beforeFiles</code> do not check the filesystem/dynamic routes immediately after matching a source, they continue until all <code>beforeFiles</code> have been checked.</p> </blockquote> <p>The order Next.js routes are checked is:</p> <ol> <li>\n<a href=\"headers\">headers</a> are checked/applied</li> <li>\n<a href=\"redirects\">redirects</a> are checked/applied</li> <li>\n<code>beforeFiles</code> rewrites are checked/applied</li> <li>static files from the <a href=\"../../building-your-application/optimizing/static-assets\">public directory</a>, <code>_next/static</code> files, and non-dynamic pages are checked/served</li> <li>\n<code>afterFiles</code> rewrites are checked/applied, if one of these rewrites is matched we check dynamic routes/static files after each match</li> <li>\n<code>fallback</code> rewrites are checked/applied, these are applied before rendering the 404 page and after dynamic routes/all static assets have been checked. If you use <a href=\"../../../pages/api-reference/functions/get-static-paths#fallback-true\">fallback: true/'blocking'</a> in <code>getStaticPaths</code>, the fallback <code>rewrites</code> defined in your <code>next.config.js</code> will <em>not</em> be run.</li> </ol>  <h2 id=\"rewrite-parameters\" data-docs-heading=\"\">Rewrite parameters     </h2> <p>When using parameters in a rewrite the parameters will be passed in the query by default when none of the parameters are used in the <code>destination</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/old-about/:path*',\n        destination: '/about', // The :path parameter isn't used here so will be automatically passed in the query\n      },\n    ]\n  },\n}</pre></div> <p>If a parameter is used in the destination none of the parameters will be automatically passed in the query.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/docs/:path*',\n        destination: '/:path*', // The :path parameter is used here so will not be automatically passed in the query\n      },\n    ]\n  },\n}</pre></div> <p>You can still pass the parameters manually in the query if one is already used in the destination by specifying the query in the <code>destination</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/:first/:second',\n        destination: '/:first?second=:second',\n        // Since the :first parameter is used in the destination the :second parameter\n        // will not automatically be added in the query although we can manually add it\n        // as shown above\n      },\n    ]\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Static pages from <a href=\"../../../pages/building-your-application/rendering/automatic-static-optimization\">Automatic Static Optimization</a> or <a href=\"../../../pages/building-your-application/data-fetching/get-static-props\">prerendering</a> params from rewrites will be parsed on the client after hydration and provided in the query.</p> </blockquote> <h2 id=\"path-matching\" data-docs-heading=\"\">Path Matching     </h2> <p>Path matches are allowed, for example <code>/blog/:slug</code> will match <code>/blog/hello-world</code> (no nested paths):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog/:slug',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"wildcard-path-matching\" data-docs-heading=\"\">Wildcard Path Matching     </h3> <p>To match a wildcard path you can use <code>*</code> after a parameter, for example <code>/blog/:slug*</code> will match <code>/blog/a/b/c/d/hello-world</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog/:slug*',\n        destination: '/news/:slug*', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"regex-path-matching\" data-docs-heading=\"\">Regex Path Matching     </h3> <p>To match a regex path you can wrap the regex in parenthesis after a parameter, for example <code>/blog/:slug(\\\\d{1,})</code> will match <code>/blog/123</code> but not <code>/blog/abc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/old-blog/:post(\\\\d{1,})',\n        destination: '/blog/:post', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}</pre></div> <p>The following characters <code>(</code>, <code>)</code>, <code>{</code>, <code>}</code>, <code>[</code>, <code>]</code>, <code>|</code>, <code>\\</code>, <code>^</code>, <code>.</code>, <code>:</code>, <code>*</code>, <code>+</code>, <code>-</code>, <code>?</code>, <code>$</code> are used for regex path matching, so when used in the <code>source</code> as non-special values they must be escaped by adding <code>\\\\</code> before them:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        destination: '/en-us/:slug',\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"header-cookie-and-query-matching\" data-docs-heading=\"\">Header, Cookie, and Query Matching     </h2> <p>To only match a rewrite when header, cookie, or query values also match the <code>has</code> field or don't match the <code>missing</code> field can be used. Both the <code>source</code> and all <code>has</code> items must match and all <code>missing</code> items must not match for the rewrite to be applied.</p> <p><code>has</code> and <code>missing</code> items can have the following fields:</p> <ul> <li>\n<code>type</code>: <code>String</code> - must be either <code>header</code>, <code>cookie</code>, <code>host</code>, or <code>query</code>.</li> <li>\n<code>key</code>: <code>String</code> - the key from the selected type to match against.</li> <li>\n<code>value</code>: <code>String</code> or <code>undefined</code> - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value <code>first-(?&lt;paramName&gt;.*)</code> is used for <code>first-second</code> then <code>second</code> will be usable in the destination with <code>:paramName</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      // if the header `x-rewrite-me` is present,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-rewrite-me',\n          },\n        ],\n        destination: '/another-page',\n      },\n      // if the header `x-rewrite-me` is not present,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-rewrite-me',\n          },\n        ],\n        destination: '/another-page',\n      },\n      // if the source, query, and cookie are matched,\n      // this rewrite will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // destination since value is provided and doesn't\n            // use a named capture group e.g. (?&lt;page&gt;home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        destination: '/:path*/home',\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?&lt;authorized&gt;yes|true)',\n          },\n        ],\n        destination: '/home?authorized=:authorized',\n      },\n      // if the host is `example.com`,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        destination: '/another-page',\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"rewriting-to-an-external-url\" data-docs-heading=\"\">Rewriting to an external URL     </h2> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/custom-routes-proxying\" rel=\"noopener noreferrer\" target=\"_blank\">Incremental adoption of Next.js</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-zones\" rel=\"noopener noreferrer\" target=\"_blank\">Using Multiple Zones</a></li> </ul></details> <p>Rewrites allow you to rewrite to an external url. This is especially useful for incrementally adopting Next.js. The following is an example rewrite for redirecting the <code>/blog</code> route of your main app to an external site.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog',\n        destination: 'https://example.com/blog',\n      },\n      {\n        source: '/blog/:slug',\n        destination: 'https://example.com/blog/:slug', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}</pre></div> <p>If you're using <code>trailingSlash: true</code>, you also need to insert a trailing slash in the <code>source</code> parameter. If the destination server is also expecting a trailing slash it should be included in the <code>destination</code> parameter as well.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  trailingSlash: true,\n  async rewrites() {\n    return [\n      {\n        source: '/blog/',\n        destination: 'https://example.com/blog/',\n      },\n      {\n        source: '/blog/:path*/',\n        destination: 'https://example.com/blog/:path*/',\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"incremental-adoption-of-nextjs\" data-docs-heading=\"\">Incremental adoption of Next.js     </h3> <p>You can also have Next.js fall back to proxying to an existing website after checking all Next.js routes.</p> <p>This way you don't have to change the rewrites configuration when migrating more pages to Next.js</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return {\n      fallback: [\n        {\n          source: '/:path*',\n          destination: `https://custom-routes-proxying-endpoint.vercel.app/:path*`,\n        },\n      ],\n    }\n  },\n}</pre></div> <h3 id=\"rewrites-with-basepath-support\" data-docs-heading=\"\">Rewrites with basePath support     </h3> <p>When leveraging <a href=\"basepath\"><code>basePath</code> support</a> with rewrites each <code>source</code> and <code>destination</code> is automatically prefixed with the <code>basePath</code> unless you add <code>basePath: false</code> to the rewrite:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  basePath: '/docs',\n \n  async rewrites() {\n    return [\n      {\n        source: '/with-basePath', // automatically becomes /docs/with-basePath\n        destination: '/another', // automatically becomes /docs/another\n      },\n      {\n        // does not add /docs to /without-basePath since basePath: false is set\n        // Note: this can not be used for internal rewrites e.g. `destination: '/another'`\n        source: '/without-basePath',\n        destination: 'https://example.com',\n        basePath: false,\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"rewrites-with-i18n-support\" data-docs-heading=\"\">Rewrites with i18n support     </h3> <p>When leveraging <a href=\"../../building-your-application/routing/internationalization\"><code>i18n</code> support</a> with rewrites each <code>source</code> and <code>destination</code> is automatically prefixed to handle the configured <code>locales</code> unless you add <code>locale: false</code> to the rewrite. If <code>locale: false</code> is used you must prefix the <code>source</code> and <code>destination</code> with a locale for it to be matched correctly.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },\n \n  async rewrites() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        destination: '/another', // automatically passes the locale on\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        destination: '/nl/another',\n        locale: false,\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        destination: '/en/another',\n        locale: false,\n      },\n      {\n        // it's possible to match all locales even when locale: false is set\n        source: '/:locale/api-alias/:path*',\n        destination: '/api/:path*',\n        locale: false,\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        destination: '/another',\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>missing</code> added.</td>\n</tr>\n<tr>\n<td><code>v10.2.0</code></td>\n<td>\n<code>has</code> added.</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>Headers added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/rewrites\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/rewrites</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/transpilepackages":"<h1 class=\"break-words\">transpilePackages</h1> <p>Next.js can automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (<code>node_modules</code>). This replaces the <code>next-transpile-modules</code> package.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  transpilePackages: ['@acme/ui', 'lodash-es'],\n}\n \nmodule.exports = nextConfig</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>transpilePackages</code> added.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/transpilePackages\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/transpilePackages</a>\n  </p>\n</div>\n","app/api-reference/create-next-app":"<h1 class=\"break-words\">create-next-app</h1> <p>The easiest way to get started with Next.js is by using <code>create-next-app</code>. This CLI tool enables you to quickly start building a new Next.js application, with everything set up for you.</p> <p>You can create a new app using the default Next.js template, or by using one of the <a href=\"https://github.com/vercel/next.js/tree/canary/examples\" rel=\"noopener noreferrer\" target=\"_blank\">official Next.js examples</a>.</p> <h3 id=\"interactive\" data-docs-heading=\"\">Interactive     </h3> <p>You can create a new project interactively by running:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn create next-app</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm create next-app</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bunx create-next-app</pre></div> <p>You will then be asked the following prompts:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">What is your project named?  my-app\nWould you like to use TypeScript?  No / Yes\nWould you like to use ESLint?  No / Yes\nWould you like to use Tailwind CSS?  No / Yes\nWould you like to use `src/` directory?  No / Yes\nWould you like to use App Router? (recommended)  No / Yes\nWould you like to customize the default import alias (@/*)?  No / Yes</pre></div> <p>Once you've answered the prompts, a new project will be created with the correct configuration depending on your answers.</p> <h3 id=\"non-interactive\" data-docs-heading=\"\">Non-interactive     </h3> <p>You can also pass command line arguments to set up a new project non-interactively.</p> <p>Further, you can negate default options by prefixing them with <code>--no-</code> (e.g. <code>--no-eslint</code>).</p> <p>See <code>create-next-app --help</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: create-next-app &lt;project-directory&gt; [options]\n \nOptions:\n  -V, --version                        output the version number\n  --ts, --typescript\n \n    Initialize as a TypeScript project. (default)\n \n  --js, --javascript\n \n    Initialize as a JavaScript project.\n \n  --tailwind\n \n    Initialize with Tailwind CSS config. (default)\n \n  --eslint\n \n    Initialize with ESLint config.\n \n  --app\n \n    Initialize as an App Router project.\n \n  --src-dir\n \n    Initialize inside a `src/` directory.\n \n  --import-alias &lt;alias-to-configure&gt;\n \n    Specify import alias to use (default \"@/*\").\n \n  --use-npm\n \n    Explicitly tell the CLI to bootstrap the app using npm\n \n  --use-pnpm\n \n    Explicitly tell the CLI to bootstrap the app using pnpm\n \n  --use-yarn\n \n    Explicitly tell the CLI to bootstrap the app using Yarn\n \n  --use-bun\n \n    Explicitly tell the CLI to bootstrap the app using Bun\n \n  -e, --example [name]|[github-url]\n \n    An example to bootstrap the app with. You can use an example name\n    from the official Next.js repo or a public GitHub URL. The URL can use\n    any branch and/or subdirectory\n \n  --example-path &lt;path-to-example&gt;\n \n    In a rare case, your GitHub URL might contain a branch name with\n    a slash (e.g. bug/fix-1) and the path to the example (e.g. foo/bar).\n    In this case, you must specify the path to the example separately:\n    --example-path foo/bar\n \n  --reset-preferences\n \n    Explicitly tell the CLI to reset any stored preferences\n \n  -h, --help                           output usage information</pre></div> <h3 id=\"why-use-create-next-app\" data-docs-heading=\"\">Why use Create Next App?     </h3> <p><code>create-next-app</code> allows you to create a new Next.js app within seconds. It is officially maintained by the creators of Next.js, and includes a number of benefits:</p> <ul> <li>\n<strong>Interactive Experience</strong>: Running <code>npx create-next-app@latest</code> (with no arguments) launches an interactive experience that guides you through setting up a project.</li> <li>\n<strong>Zero Dependencies</strong>: Initializing a project is as quick as one second. Create Next App has zero dependencies.</li> <li>\n<strong>Offline Support</strong>: Create Next App will automatically detect if you're offline and bootstrap your project using your local package cache.</li> <li>\n<strong>Support for Examples</strong>: Create Next App can bootstrap your application using an example from the Next.js examples collection (e.g. <code>npx create-next-app --example api-routes</code>) or any public GitHub repository.</li> <li>\n<strong>Tested</strong>: The package is part of the Next.js monorepo and tested using the same integration test suite as Next.js itself, ensuring it works as expected with every release.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/create-next-app\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/create-next-app</a>\n  </p>\n</div>\n","app/api-reference/edge":"<h1 class=\"break-words\">Edge Runtime</h1> <p>The Next.js Edge Runtime is based on standard Web APIs, it supports the following APIs:</p> <h2 id=\"network-apis\" data-docs-heading=\"\">Network APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Blob\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Blob</code></a></td>\n<td>Represents a blob</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Fetch_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>fetch</code></a></td>\n<td>Fetches a resource</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/FetchEvent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>FetchEvent</code></a></td>\n<td>Represents a fetch event</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/File\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>File</code></a></td>\n<td>Represents a file</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/FormData\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>FormData</code></a></td>\n<td>Represents form data</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Headers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Headers</code></a></td>\n<td>Represents HTTP headers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Request</code></a></td>\n<td>Represents an HTTP request</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Response</code></a></td>\n<td>Represents an HTTP response</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams</code></a></td>\n<td>Represents URL search parameters</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WebSocket\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WebSocket</code></a></td>\n<td>Represents a websocket connection</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"encoding-apis\" data-docs-heading=\"\">Encoding APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/atob\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>atob</code></a></td>\n<td>Decodes a base-64 encoded string</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/btoa\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>btoa</code></a></td>\n<td>Encodes a string in base-64</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TextDecoder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TextDecoder</code></a></td>\n<td>Decodes a Uint8Array into a string</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TextDecoderStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TextDecoderStream</code></a></td>\n<td>Chainable decoder for streams</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TextEncoder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TextEncoder</code></a></td>\n<td>Encodes a string into a Uint8Array</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TextEncoderStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TextEncoderStream</code></a></td>\n<td>Chainable encoder for streams</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"stream-apis\" data-docs-heading=\"\">Stream APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/ReadableStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReadableStream</code></a></td>\n<td>Represents a readable stream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/ReadableStreamBYOBReader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReadableStreamBYOBReader</code></a></td>\n<td>Represents a reader of a ReadableStream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/ReadableStreamDefaultReader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReadableStreamDefaultReader</code></a></td>\n<td>Represents a reader of a ReadableStream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TransformStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TransformStream</code></a></td>\n<td>Represents a transform stream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WritableStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WritableStream</code></a></td>\n<td>Represents a writable stream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WritableStreamDefaultWriter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WritableStreamDefaultWriter</code></a></td>\n<td>Represents a writer of a WritableStream</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"crypto-apis\" data-docs-heading=\"\">Crypto APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Window/crypto\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>crypto</code></a></td>\n<td>Provides access to the cryptographic functionality of the platform</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/CryptoKey\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>CryptoKey</code></a></td>\n<td>Represents a cryptographic key</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/SubtleCrypto\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>SubtleCrypto</code></a></td>\n<td>Provides access to common cryptographic primitives, like hashing, signing, encryption or decryption</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"web-standard-apis\" data-docs-heading=\"\">Web Standard APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/AbortController\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>AbortController</code></a></td>\n<td>Allows you to abort one or more DOM requests as and when desired</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Array</code></a></td>\n<td>Represents an array of values</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ArrayBuffer</code></a></td>\n<td>Represents a generic, fixed-length raw binary data buffer</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Atomics\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Atomics</code></a></td>\n<td>Provides atomic operations as static methods</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigInt\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>BigInt</code></a></td>\n<td>Represents a whole number with arbitrary precision</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigInt64Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>BigInt64Array</code></a></td>\n<td>Represents a typed array of 64-bit signed integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigUint64Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>BigUint64Array</code></a></td>\n<td>Represents a typed array of 64-bit unsigned integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Boolean</code></a></td>\n<td>Represents a logical entity and can have two values: <code>true</code> and <code>false</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/clearInterval\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>clearInterval</code></a></td>\n<td>Cancels a timed, repeating action which was previously established by a call to <code>setInterval()</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/clearTimeout\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>clearTimeout</code></a></td>\n<td>Cancels a timed, repeating action which was previously established by a call to <code>setTimeout()</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Console\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>console</code></a></td>\n<td>Provides access to the browser's debugging console</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/DataView\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>DataView</code></a></td>\n<td>Represents a generic view of an <code>ArrayBuffer</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Date\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Date</code></a></td>\n<td>Represents a single moment in time in a platform-independent format</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/decodeURI\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>decodeURI</code></a></td>\n<td>Decodes a Uniform Resource Identifier (URI) previously created by <code>encodeURI</code> or by a similar routine</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/decodeURIComponent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>decodeURIComponent</code></a></td>\n<td>Decodes a Uniform Resource Identifier (URI) component previously created by <code>encodeURIComponent</code> or by a similar routine</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/DOMException\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>DOMException</code></a></td>\n<td>Represents an error that occurs in the DOM</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURI\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>encodeURI</code></a></td>\n<td>Encodes a Uniform Resource Identifier (URI) by replacing each instance of certain characters by one, two, three, or four escape sequences representing the UTF-8 encoding of the character</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>encodeURIComponent</code></a></td>\n<td>Encodes a Uniform Resource Identifier (URI) component by replacing each instance of certain characters by one, two, three, or four escape sequences representing the UTF-8 encoding of the character</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Error</code></a></td>\n<td>Represents an error when trying to execute a statement or accessing a property</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/EvalError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>EvalError</code></a></td>\n<td>Represents an error that occurs regarding the global function <code>eval()</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Float32Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Float32Array</code></a></td>\n<td>Represents a typed array of 32-bit floating point numbers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Float64Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Float64Array</code></a></td>\n<td>Represents a typed array of 64-bit floating point numbers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Function</code></a></td>\n<td>Represents a function</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Infinity\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Infinity</code></a></td>\n<td>Represents the mathematical Infinity value</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int8Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Int8Array</code></a></td>\n<td>Represents a typed array of 8-bit signed integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int16Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Int16Array</code></a></td>\n<td>Represents a typed array of 16-bit signed integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int32Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Int32Array</code></a></td>\n<td>Represents a typed array of 32-bit signed integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Intl\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Intl</code></a></td>\n<td>Provides access to internationalization and localization functionality</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/isFinite\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>isFinite</code></a></td>\n<td>Determines whether a value is a finite number</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/isNaN\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>isNaN</code></a></td>\n<td>Determines whether a value is <code>NaN</code> or not</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>JSON</code></a></td>\n<td>Provides functionality to convert JavaScript values to and from the JSON format</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Map</code></a></td>\n<td>Represents a collection of values, where each value may occur only once</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Math\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Math</code></a></td>\n<td>Provides access to mathematical functions and constants</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Number</code></a></td>\n<td>Represents a numeric value</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Object</code></a></td>\n<td>Represents the object that is the base of all JavaScript objects</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/parseFloat\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>parseFloat</code></a></td>\n<td>Parses a string argument and returns a floating point number</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/parseInt\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>parseInt</code></a></td>\n<td>Parses a string argument and returns an integer of the specified radix</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Promise</code></a></td>\n<td>Represents the eventual completion (or failure) of an asynchronous operation, and its resulting value</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Proxy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Proxy</code></a></td>\n<td>Represents an object that is used to define custom behavior for fundamental operations (e.g. property lookup, assignment, enumeration, function invocation, etc)</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/queueMicrotask\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>queueMicrotask</code></a></td>\n<td>Queues a microtask to be executed</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RangeError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>RangeError</code></a></td>\n<td>Represents an error when a value is not in the set or range of allowed values</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReferenceError</code></a></td>\n<td>Represents an error when a non-existent variable is referenced</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Reflect\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Reflect</code></a></td>\n<td>Provides methods for interceptable JavaScript operations</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RegExp\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>RegExp</code></a></td>\n<td>Represents a regular expression, allowing you to match combinations of characters</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Set\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Set</code></a></td>\n<td>Represents a collection of values, where each value may occur only once</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/setInterval\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>setInterval</code></a></td>\n<td>Repeatedly calls a function, with a fixed time delay between each call</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/setTimeout\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>setTimeout</code></a></td>\n<td>Calls a function or evaluates an expression after a specified number of milliseconds</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>SharedArrayBuffer</code></a></td>\n<td>Represents a generic, fixed-length raw binary data buffer</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>String</code></a></td>\n<td>Represents a sequence of characters</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>structuredClone</code></a></td>\n<td>Creates a deep copy of a value</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Symbol\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Symbol</code></a></td>\n<td>Represents a unique and immutable data type that is used as the key of an object property</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>SyntaxError</code></a></td>\n<td>Represents an error when trying to interpret syntactically invalid code</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/TypeError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TypeError</code></a></td>\n<td>Represents an error when a value is not of the expected type</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Uint8Array</code></a></td>\n<td>Represents a typed array of 8-bit unsigned integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Uint8ClampedArray</code></a></td>\n<td>Represents a typed array of 8-bit unsigned integers clamped to 0-255</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Uint32Array</code></a></td>\n<td>Represents a typed array of 32-bit unsigned integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/URIError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URIError</code></a></td>\n<td>Represents an error when a global URI handling function was used in a wrong way</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URL</code></a></td>\n<td>Represents an object providing static methods used for creating object URLs</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/URLPattern\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLPattern</code></a></td>\n<td>Represents a URL pattern</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams</code></a></td>\n<td>Represents a collection of key/value pairs</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakMap\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WeakMap</code></a></td>\n<td>Represents a collection of key/value pairs in which the keys are weakly referenced</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakSet\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WeakSet</code></a></td>\n<td>Represents a collection of objects in which each object may occur only once</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WebAssembly</code></a></td>\n<td>Provides access to WebAssembly</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"nextjs-specific-polyfills\" data-docs-heading=\"\">Next.js Specific Polyfills     </h2> <ul> <li><a href=\"https://nodejs.org/api/async_context.html#class-asynclocalstorage\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>AsyncLocalStorage</code></a></li> </ul> <h2 id=\"environment-variables\" data-docs-heading=\"\">Environment Variables     </h2> <p>You can use <code>process.env</code> to access <a href=\"../building-your-application/configuring/environment-variables\">Environment Variables</a> for both <code>next dev</code> and <code>next build</code>.</p> <h2 id=\"unsupported-apis\" data-docs-heading=\"\">Unsupported APIs     </h2> <p>The Edge Runtime has some restrictions including:</p> <ul> <li>Native Node.js APIs <strong>are not supported</strong>. For example, you can't read or write to the filesystem.</li> <li>\n<code>node_modules</code> <em>can</em> be used, as long as they implement ES Modules and do not use native Node.js APIs.</li> <li>Calling <code>require</code> directly is <strong>not allowed</strong>. Use ES Modules instead.</li> </ul> <p>The following JavaScript language features are disabled, and <strong>will not work:</strong></p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/eval\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eval</code></a></td>\n<td>Evaluates JavaScript code represented as a string</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>new Function(evalString)</code></a></td>\n<td>Creates a new function with the code provided as an argument</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/compile\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WebAssembly.compile</code></a></td>\n<td>Compiles a WebAssembly module from a buffer source</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/instantiate\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WebAssembly.instantiate</code></a></td>\n<td>Compiles and instantiates a WebAssembly module from a buffer source</td>\n</tr>\n</tbody>\n</table></div> <p>In rare cases, your code could contain (or import) some dynamic code evaluation statements which <em>can not be reached at runtime</em> and which can not be removed by treeshaking. You can relax the check to allow specific files with your Middleware or Edge API Route exported configuration:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  runtime: 'edge', // for Edge API Routes only\n  unstable_allowDynamic: [\n    // allows a single file\n    '/lib/utilities.js',\n    // use a glob to allow anything in the function-bind 3rd party module\n    '/node_modules/function-bind/**',\n  ],\n}</pre>\n</div> <p><code>unstable_allowDynamic</code> is a <a href=\"https://github.com/micromatch/micromatch#matching-features\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">glob</a>, or an array of globs, ignoring dynamic code evaluation for specific files. The globs are relative to your application root folder.</p> <p>Be warned that if these statements are executed on the Edge, <em>they will throw and cause a runtime error</em>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/edge\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/edge</a>\n  </p>\n</div>\n","app/api-reference/next-cli":"<h1 class=\"break-words\">Next.js CLI</h1> <p>The Next.js CLI allows you to develop, build, start your application, and more.</p> <p>To get a list of the available CLI commands, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage next [options] [command]\n \nThe Next.js CLI allows you to develop, build, start your application, and more.\n \nOptions:\n  -v, --version                Outputs the Next.js version.\n  -h, --help                   Displays this message.\n \nCommands:\n  build [directory] [options]  Creates an optimized production build of your application.\n                               The output displays information about each route.\n  dev [directory] [options]    Starts Next.js in development mode with hot-code reloading,\n                               error reporting, and more.\n  info [options]               Prints relevant details about the current system which can be\n                               used to report Next.js bugs.\n  lint [directory] [options]   Runs ESLint for all files in the `/src`, `/app`, `/pages`,\n                               `/components`, and `/lib` directories. It also provides a\n                               guided setup to install any required dependencies if ESLint\n                               is not already configured in your application.\n  start [directory] [options]  Starts Next.js in production mode. The application should be\n                               compiled with `next build` first.\n  telemetry [options]          Allows you to enable or disable Next.js' completely\n                               anonymous telemetry collection.</pre></div> <p>You can pass any <a href=\"https://nodejs.org/api/cli.html#cli_node_options_options\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">node arguments</a> to <code>next</code> commands:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">NODE_OPTIONS='--throw-deprecation' next\nNODE_OPTIONS='-r esm' next\nNODE_OPTIONS='--inspect' next</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Running <code>next</code> without a command is the same as running <code>next dev</code></p> </blockquote> <h2 id=\"development\" data-docs-heading=\"\">Development     </h2> <p><code>next dev</code> starts the application in development mode with hot-code reloading, error reporting, and more.</p> <p>To get a list of the available options with <code>next dev</code>, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next dev [directory] [options]\n \nStarts Next.js in development mode with hot-code reloading, error reporting, and more.\n \nArguments:\n  [directory]                              A directory on which to build the application.\n                                           If no directory is provided, the current\n                                           directory will be used.\n \nOptions:\n  --turbo                                  Starts development mode using Turbopack (beta).\n  -p, --port &lt;port&gt;                        Specify a port number on which to start the\n                                           application. (default: 3000, env: PORT)\n  -H, --hostname &lt;hostname&gt;                Specify a hostname on which to start the\n                                           application (default: 0.0.0.0).\n  --experimental-https                     Starts the server with HTTPS and generates a\n                                           self-signed certificate.\n  --experimental-https-key, &lt;path&gt;         Path to a HTTPS key file.\n  --experimental-https-cert, &lt;path&gt;        Path to a HTTPS certificate file.\n  --experimental-https-ca, &lt;path&gt;          Path to a HTTPS certificate authority file.\n  --experimental-upload-trace, &lt;traceUrl&gt;  Reports a subset of the debugging trace to a\n                                           remote HTTP URL. Includes sensitive data.\n  -h, --help                               Displays this message.</pre></div> <p>The application will start at <code>http://localhost:3000</code> by default. The default port can be changed with <code>-p</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev -p 4000</pre></div> <p>Or using the <code>PORT</code> environment variable:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">PORT=4000 next dev</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>PORT</code> cannot be set in <code>.env</code> as booting up the HTTP server happens before any other code is initialized.</li> <li>Next.js will automatically retry with another port until a port is available if a port is not specified with the CLI option <code>--port</code> or the <code>PORT</code> environment variable.</li> </ul> </blockquote> <p>You can also set the hostname to be different from the default of <code>0.0.0.0</code>, this can be useful for making the application available for other devices on the network. The default hostname can be changed with <code>-H</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev -H 192.168.1.2</pre></div> <h3 id=\"turbopack\" data-docs-heading=\"\">Turbopack     </h3> <p><a href=\"../../architecture/turbopack\">Turbopack</a> (beta), our new bundler, which is being tested and stabilized in Next.js, helps speed up local iterations while working on your application.</p> <p>To use Turbopack in development mode, add the <code>--turbo</code> option:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev --turbo</pre></div> <h3 id=\"https-for-local-development\" data-docs-heading=\"\">HTTPS for Local Development     </h3> <p>For certain use cases like webhooks or authentication, it may be required to use HTTPS to have a secure environment on <code>localhost</code>. Next.js can generate a self-signed certificate with <code>next dev</code> as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev --experimental-https</pre></div> <p>You can also provide a custom certificate and key with <code>--experimental-https-key</code> and <code>--experimental-https-cert</code>. Optionally, you can provide a custom CA certificate with <code>--experimental-https-ca</code> as well.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev --experimental-https --experimental-https-key ./certificates/localhost-key.pem --experimental-https-cert ./certificates/localhost.pem</pre></div> <p><code>next dev --experimental-https</code> is only intended for development and creates a locally-trusted certificate with <code>mkcert</code>. In production, use properly issued certificates from trusted authorities. When deploying to Vercel, HTTPS is <a href=\"https://vercel.com/docs/security/encryption\" rel=\"noopener noreferrer\" target=\"_blank\">automatically configured</a> for your Next.js application.</p> <h2 id=\"build\" data-docs-heading=\"\">Build     </h2> <p><code>next build</code> creates an optimized production build of your application. The output displays information about each route:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Route (app)                               Size     First Load JS\n  /                                     5.3 kB         89.5 kB\n  /_not-found                           885 B          85.1 kB\n  /about                                137 B          84.4 kB\n+ First Load JS shared by all             84.2 kB\n   chunks/184-d3bb186aac44da98.js        28.9 kB\n   chunks/30b509c0-f3503c24f98f3936.js   53.4 kB\n   other shared chunks (total)\n \n \n  (Static)  prerendered as static content</pre></div> <ul> <li>\n<strong>Size</strong>: The number of assets downloaded when navigating to the page client-side. The size for each route only includes its dependencies.</li> <li>\n<strong>First Load JS</strong>: The number of assets downloaded when visiting the page from the server. The amount of JS shared by all is shown as a separate metric.</li> </ul> <p>Both of these values are <a href=\"next-config-js/compress\"><strong>compressed with gzip</strong></a>. The first load is indicated by green, yellow, or red. Aim for green for performant applications.</p> <p>To get a list of the available options with <code>next build</code>, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next build [directory] [options]\n \nCreates an optimized production build of your application. The output displays information\nabout each route.\n \nArguments:\n  [directory]                       A directory on which to build the application. If no\n                                    provided, the current directory will be\n                                    used.\n \nOptions:\n  -d, --debug                       Enables a more verbose build output.\n  --profile                         Enables production profiling for React.\n  --no-lint                         Disables linting.\n  --no-mangling                     Disables mangling.\n  --experimental-app-only           Builds only App Router routes.\n  --experimental-build-mode [mode]  Uses an experimental build mode. (choices: \"compile\"\n                                    \"generate\", default: \"default\")\n  -h, --help                        Displays this message.</pre></div> <h3 id=\"debug\" data-docs-heading=\"\">Debug     </h3> <p>You can enable more verbose build output with the <code>--debug</code> flag in <code>next build</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build --debug</pre></div> <p>With this flag enabled additional build output like rewrites, redirects, and headers will be shown.</p> <h3 id=\"linting\" data-docs-heading=\"\">Linting     </h3> <p>You can disable linting for builds like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build --no-lint</pre></div> <h3 id=\"mangling\" data-docs-heading=\"\">Mangling     </h3> <p>You can disable <a href=\"https://en.wikipedia.org/wiki/Name_mangling\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">mangling</a> for builds like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build --no-mangling</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This may affect performance and should only be used for debugging purposes.</p> </blockquote> <h3 id=\"profiling\" data-docs-heading=\"\">Profiling     </h3> <p>You can enable production profiling for React with the <code>--profile</code> flag in <code>next build</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build --profile</pre></div> <p>After that, you can use the profiler in the same way as you would in development.</p> <h2 id=\"production\" data-docs-heading=\"\">Production     </h2> <p><code>next start</code> starts the application in production mode. The application should be compiled with <a href=\"#build\"><code>next build</code></a> first.</p> <p>To get a list of the available options with <code>next start</code>, run the follow command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next start -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next start [directory] [options]\n \nStarts Next.js in production mode. The application should be compiled with `next build`\nfirst.\n \nArguments:\n  [directory]                           A directory on which to start the application.\n                                        If not directory is provided, the current\n                                        directory will be used.\n \nOptions:\n  -p, --port &lt;port&gt;                     Specify a port number on which to start the\n                                        application. (default: 3000, env: PORT)\n  -H, --hostname &lt;hostname&gt;             Specify a hostname on which to start the\n                                        application (default: 0.0.0.0).\n  --keepAliveTimeout &lt;keepAliveTimeout&gt; Specify the maximum amount of milliseconds to wait\n                                        before closing the inactive connections.\n  -h, --help                            Displays this message.</pre></div> <p>The application will start at <code>http://localhost:3000</code> by default. The default port can be changed with <code>-p</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next start -p 4000</pre></div> <p>Or using the <code>PORT</code> environment variable:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">PORT=4000 next start</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>PORT</code> cannot be set in <code>.env</code> as booting up the HTTP server happens before any other code is initialized.</li> <li>\n<code>next start</code> cannot be used with <code>output: 'standalone'</code> or <code>output: 'export'</code>.</li> </ul> </blockquote> <h3 id=\"keep-alive-timeout\" data-docs-heading=\"\">Keep Alive Timeout     </h3> <p>When deploying Next.js behind a downstream proxy (e.g. a load-balancer like AWS ELB/ALB) it's important to configure Next's underlying HTTP server with <a href=\"https://nodejs.org/api/http.html#http_server_keepalivetimeout\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">keep-alive timeouts</a> that are <em>larger</em> than the downstream proxy's timeouts. Otherwise, once a keep-alive timeout is reached for a given TCP connection, Node.js will immediately terminate that connection without notifying the downstream proxy. This results in a proxy error whenever it attempts to reuse a connection that Node.js has already terminated.</p> <p>To configure the timeout values for the production Next.js server, pass <code>--keepAliveTimeout</code> (in milliseconds) to <code>next start</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next start --keepAliveTimeout 70000</pre></div> <h2 id=\"info\" data-docs-heading=\"\">Info     </h2> <p><code>next info</code> prints relevant details about the current system which can be used to report Next.js bugs. This information includes Operating System platform/arch/version, Binaries (Node.js, npm, Yarn, pnpm) and npm package versions (<code>next</code>, <code>react</code>, <code>react-dom</code>).</p> <p>To get a list of the available options with <code>next info</code>, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next info -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next info [options]\n \nPrints relevant details about the current system which can be used to report Next.js bugs.\n \nOptions:\n  --verbose   Collections additional information for debugging.\n  -h, --help  Displays this message.</pre></div> <p>Running <code>next info</code> will give you information like this example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"> \nOperating System:\n  Platform: linux\n  Arch: x64\n  Version: #22-Ubuntu SMP Fri Nov 5 13:21:36 UTC 2021\n  Available memory (MB): 31795\n  Available CPU cores: 16\nBinaries:\n  Node: 16.13.0\n  npm: 8.1.0\n  Yarn: 1.22.17\n  pnpm: 6.24.2\nRelevant Packages:\n  next: 14.1.1-canary.61 // Latest available version is detected (14.1.1-canary.61).\n  react: 18.2.0\n  react-dom: 18.2.0\nNext.js Config:\n  output: N/A\n </pre></div> <p>This information should then be pasted into GitHub Issues.</p> <p>You can also run <code>next info --verbose</code> which will print additional information about the system and the installation of packages related to <code>next</code>.</p> <h2 id=\"lint\" data-docs-heading=\"\">Lint     </h2> <p><code>next lint</code> runs ESLint for all files in the <code>pages/</code>, <code>app/</code>, <code>components/</code>, <code>lib/</code>, and <code>src/</code> directories. It also provides a guided setup to install any required dependencies if ESLint is not already configured in your application.</p> <p>To get a list of the available options with <code>next lint</code>, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next lint -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next lint [directory] [options]\n \nRuns ESLint for all files in the `/src`, `/app`, `/pages`, `/components`, and `/lib` directories. It also\nprovides a guided setup to install any required dependencies if ESLint is not already configured in your\napplication.\n \nArguments:\n  [directory]                                         A base directory on which to lint the application.\n                                                      If no directory is provided, the current directory\n                                                      will be used.\n \nOptions:\n  -d, --dir, &lt;dirs...&gt;                                Include directory, or directories, to run ESLint.\n  --file, &lt;files...&gt;                                  Include file, or files, to run ESLint.\n  --ext, [exts...]                                    Specify JavaScript file extensions. (default:\n                                                      [\".js\", \".mjs\", \".cjs\", \".jsx\", \".ts\", \".mts\", \".cts\", \".tsx\"])\n  -c, --config, &lt;config&gt;                              Uses this configuration file, overriding all other\n                                                      configuration options.\n  --resolve-plugins-relative-to, &lt;rprt&gt;               Specify a directory where plugins should be resolved\n                                                      from.\n  --strict                                            Creates a `.eslintrc.json` file using the Next.js\n                                                      strict configuration.\n  --rulesdir, &lt;rulesdir...&gt;                           Uses additional rules from this directory(s).\n  --fix                                               Automatically fix linting issues.\n  --fix-type &lt;fixType&gt;                                Specify the types of fixes to apply (e.g., problem,\n                                                      suggestion, layout).\n  --ignore-path &lt;path&gt;                                Specify a file to ignore.\n  --no-ignore &lt;path&gt;                                  Disables the `--ignore-path` option.\n  --quiet                                             Reports errors only.\n  --max-warnings [maxWarnings]                        Specify the number of warnings before triggering a\n                                                      non-zero exit code. (default: -1)\n  -o, --output-file, &lt;outputFile&gt;                     Specify a file to write report to.\n  -f, --format, &lt;format&gt;                              Uses a specifc output format.\n  --no-inline-config                                  Prevents comments from changing config or rules.\n  --report-unused-disable-directives-severity &lt;level&gt; Specify severity level for unused eslint-disable\n                                                      directives. (choices: \"error\", \"off\", \"warn\")\n  --no-cache                                          Disables caching.\n  --cache-location, &lt;cacheLocation&gt;                   Specify a location for cache.\n  --cache-strategy, [cacheStrategy]                   Specify a strategy to use for detecting changed files\n                                                      in the cache. (default: \"metadata\")\n  --error-on-unmatched-pattern                        Reports errors when any file patterns are unmatched.\n  -h, --help                                          Displays this message.</pre></div> <p>If you have other directories that you would like to lint, you can specify them using the <code>--dir</code> flag:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next lint --dir utils</pre></div> <p>For more information on the other options, check out our <a href=\"../building-your-application/configuring/eslint\">ESLint</a> configuration documentation.</p> <h2 id=\"telemetry\" data-docs-heading=\"\">Telemetry     </h2> <p>Next.js collects <strong>completely anonymous</strong> telemetry data about general usage. Participation in this anonymous program is optional, and you may opt-out if you'd not like to share any information.</p> <p>To get a list of the available options with <code>next telemetry</code>, run the following command in your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next telemetry -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next telemetry [options]\n \nAllows you to enable or disable Next.js' completely anonymous telemetry collection.\n \nOptions:\n  --enable    Eanbles Next.js' telemetry collection.\n  --disable   Disables Next.js' telemetry collection.\n  -h, --help  Displays this message.\n \nLearn more: https://nextjs.org/telemetry</pre></div> <p>Learn more about <a href=\"https://nextjs.org/telemetry\">Telemetry</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-cli\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-cli</a>\n  </p>\n</div>\n","pages/building-your-application/routing/pages-and-layouts":"<h1 class=\"break-words\">Pages and Layouts</h1>\n<p>The Pages Router has a file-system based router built on the concept of pages.</p> <p>When a file is added to the <code>pages</code> directory, it's automatically available as a route.</p> <p>In Next.js, a <strong>page</strong> is a <a href=\"https://react.dev/learn/your-first-component\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Component</a> exported from a <code>.js</code>, <code>.jsx</code>, <code>.ts</code>, or <code>.tsx</code> file in the <code>pages</code> directory. Each page is associated with a route based on its file name.</p> <p><strong>Example</strong>: If you create <code>pages/about.js</code> that exports a React component like below, it will be accessible at <code>/about</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function About() {\n  return &lt;div&gt;About&lt;/div&gt;\n}</pre>\n</div> <h2 id=\"index-routes\" data-docs-heading=\"\">Index routes     </h2> <p>The router will automatically route files named <code>index</code> to the root of the directory.</p> <ul> <li>\n<code>pages/index.js</code>  <code>/</code>\n</li> <li>\n<code>pages/blog/index.js</code>  <code>/blog</code>\n</li> </ul> <h2 id=\"nested-routes\" data-docs-heading=\"\">Nested routes     </h2> <p>The router supports nested files. If you create a nested folder structure, files will automatically be routed in the same way still.</p> <ul> <li>\n<code>pages/blog/first-post.js</code>  <code>/blog/first-post</code>\n</li> <li>\n<code>pages/dashboard/settings/username.js</code>  <code>/dashboard/settings/username</code>\n</li> </ul> <h2 id=\"pages-with-dynamic-routes\" data-docs-heading=\"\">Pages with Dynamic Routes     </h2> <p>Next.js supports pages with dynamic routes. For example, if you create a file called <code>pages/posts/[id].js</code>, then it will be accessible at <code>posts/1</code>, <code>posts/2</code>, etc.</p> <blockquote class=\"p-3 text-sm\"> <p>To learn more about dynamic routing, check the <a href=\"dynamic-routes\">Dynamic Routing documentation</a>.</p> </blockquote> <h2 id=\"layout-pattern\" data-docs-heading=\"\">Layout Pattern     </h2> <p>The React model allows us to deconstruct a <a href=\"pages-and-layouts\">page</a> into a series of components. Many of these components are often reused between pages. For example, you might have the same navigation bar and footer on every page.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Navbar from './navbar'\nimport Footer from './footer'\n \nexport default function Layout({ children }) {\n  return (\n    &lt;&gt;\n      &lt;Navbar /&gt;\n      &lt;main&gt;{children}&lt;/main&gt;\n      &lt;Footer /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"single-shared-layout-with-custom-app\" data-docs-heading=\"\">Single Shared Layout with Custom App     </h3> <p>If you only have one layout for your entire application, you can create a <a href=\"custom-app\">Custom App</a> and wrap your application with the layout. Since the <code>&lt;Layout /&gt;</code> component is re-used when changing pages, its component state will be preserved (e.g. input values).</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Layout from '../components/layout'\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;Layout&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/Layout&gt;\n  )\n}</pre></div> <h3 id=\"per-page-layouts\" data-docs-heading=\"\">Per-Page Layouts     </h3> <p>If you need multiple layouts, you can add a property <code>getLayout</code> to your page, allowing you to return a React component for the layout. This allows you to define the layout on a <em>per-page basis</em>. Since we're returning a function, we can have complex nested layouts if desired.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"> \nimport Layout from '../components/layout'\nimport NestedLayout from '../components/nested-layout'\n \nexport default function Page() {\n  return (\n    /** Your content */\n  )\n}\n \nPage.getLayout = function getLayout(page) {\n  return (\n    &lt;Layout&gt;\n      &lt;NestedLayout&gt;{page}&lt;/NestedLayout&gt;\n    &lt;/Layout&gt;\n  )\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function MyApp({ Component, pageProps }) {\n  // Use the layout defined at the page level, if available\n  const getLayout = Component.getLayout ?? ((page) =&gt; page)\n \n  return getLayout(&lt;Component {...pageProps} /&gt;)\n}</pre></div> <p>When navigating between pages, we want to <em>persist</em> page state (input values, scroll position, etc.) for a Single-Page Application (SPA) experience.</p> <p>This layout pattern enables state persistence because the React component tree is maintained between page transitions. With the component tree, React can understand which elements have changed to preserve state.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This process is called <a href=\"https://react.dev/learn/preserving-and-resetting-state\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">reconciliation</a>, which is how React understands which elements have changed.</p> </blockquote> <h3 id=\"with-typescript\" data-docs-heading=\"\">With TypeScript     </h3> <p>When using TypeScript, you must first create a new type for your pages which includes a <code>getLayout</code> function. Then, you must create a new type for your <code>AppProps</code> which overrides the <code>Component</code> property to use the previously created type.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { ReactElement } from 'react'\nimport Layout from '../components/layout'\nimport NestedLayout from '../components/nested-layout'\nimport type { NextPageWithLayout } from './_app'\n \nconst Page: NextPageWithLayout = () =&gt; {\n  return &lt;p&gt;hello world&lt;/p&gt;\n}\n \nPage.getLayout = function getLayout(page: ReactElement) {\n  return (\n    &lt;Layout&gt;\n      &lt;NestedLayout&gt;{page}&lt;/NestedLayout&gt;\n    &lt;/Layout&gt;\n  )\n}\n \nexport default Page</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { ReactElement, ReactNode } from 'react'\nimport type { NextPage } from 'next'\nimport type { AppProps } from 'next/app'\n \nexport type NextPageWithLayout&lt;P = {}, IP = P&gt; = NextPage&lt;P, IP&gt; &amp; {\n  getLayout?: (page: ReactElement) =&gt; ReactNode\n}\n \ntype AppPropsWithLayout = AppProps &amp; {\n  Component: NextPageWithLayout\n}\n \nexport default function MyApp({ Component, pageProps }: AppPropsWithLayout) {\n  // Use the layout defined at the page level, if available\n  const getLayout = Component.getLayout ?? ((page) =&gt; page)\n \n  return getLayout(&lt;Component {...pageProps} /&gt;)\n}</pre></div>  <h3 id=\"data-fetching\" data-docs-heading=\"\">Data Fetching     </h3> <p>Inside your layout, you can fetch data on the client-side using <code>useEffect</code> or a library like <a href=\"https://swr.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SWR</a>. Because this file is not a <a href=\"pages-and-layouts\">Page</a>, you cannot use <code>getStaticProps</code> or <code>getServerSideProps</code> currently.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import useSWR from 'swr'\nimport Navbar from './navbar'\nimport Footer from './footer'\n \nexport default function Layout({ children }) {\n  const { data, error } = useSWR('/api/navigation', fetcher)\n \n  if (error) return &lt;div&gt;Failed to load&lt;/div&gt;\n  if (!data) return &lt;div&gt;Loading...&lt;/div&gt;\n \n  return (\n    &lt;&gt;\n      &lt;Navbar links={data.links} /&gt;\n      &lt;main&gt;{children}&lt;/main&gt;\n      &lt;Footer /&gt;\n    &lt;/&gt;\n  )\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/pages-and-layouts\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/pages-and-layouts</a>\n  </p>\n</div>\n","pages/building-your-application/routing/dynamic-routes":"<h1 class=\"break-words\">Dynamic Routes</h1>\n<p>When you don't know the exact segment names ahead of time and want to create routes from dynamic data, you can use Dynamic Segments that are filled in at request time or <a href=\"../data-fetching/get-static-paths\">prerendered</a> at build time.</p> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>A Dynamic Segment can be created by wrapping a file or folder name in square brackets: <code>[segmentName]</code>. For example, <code>[id]</code> or <code>[slug]</code>.</p> <p>Dynamic Segments can be accessed from <a href=\"../../api-reference/functions/use-router\"><code>useRouter</code></a>.</p> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <p>For example, a blog could include the following route <code>pages/blog/[slug].js</code> where <code>[slug]</code> is the Dynamic Segment for blog posts.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function Page() {\n  const router = useRouter()\n  return &lt;p&gt;Post: {router.query.slug}&lt;/p&gt;\n}</pre>\n</div> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>Example URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>pages/blog/[slug].js</code></td>\n<td><code>/blog/a</code></td>\n<td><code>{ slug: 'a' }</code></td>\n</tr>\n<tr>\n<td><code>pages/blog/[slug].js</code></td>\n<td><code>/blog/b</code></td>\n<td><code>{ slug: 'b' }</code></td>\n</tr>\n<tr>\n<td><code>pages/blog/[slug].js</code></td>\n<td><code>/blog/c</code></td>\n<td><code>{ slug: 'c' }</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"catch-all-segments\" data-docs-heading=\"\">Catch-all Segments     </h2> <p>Dynamic Segments can be extended to <strong>catch-all</strong> subsequent segments by adding an ellipsis inside the brackets <code>[...segmentName]</code>.</p> <p>For example, <code>pages/shop/[...slug].js</code> will match <code>/shop/clothes</code>, but also <code>/shop/clothes/tops</code>, <code>/shop/clothes/tops/t-shirts</code>, and so on.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>Example URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>pages/shop/[...slug].js</code></td>\n<td><code>/shop/a</code></td>\n<td><code>{ slug: ['a'] }</code></td>\n</tr>\n<tr>\n<td><code>pages/shop/[...slug].js</code></td>\n<td><code>/shop/a/b</code></td>\n<td><code>{ slug: ['a', 'b'] }</code></td>\n</tr>\n<tr>\n<td><code>pages/shop/[...slug].js</code></td>\n<td><code>/shop/a/b/c</code></td>\n<td><code>{ slug: ['a', 'b', 'c'] }</code></td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"optional-catch-all-segments\" data-docs-heading=\"\">Optional Catch-all Segments     </h2> <p>Catch-all Segments can be made <strong>optional</strong> by including the parameter in double square brackets: <code>[[...segmentName]]</code>.</p> <p>For example, <code>pages/shop/[[...slug]].js</code> will <strong>also</strong> match <code>/shop</code>, in addition to <code>/shop/clothes</code>, <code>/shop/clothes/tops</code>, <code>/shop/clothes/tops/t-shirts</code>.</p> <p>The difference between <strong>catch-all</strong> and <strong>optional catch-all</strong> segments is that with optional, the route without the parameter is also matched (<code>/shop</code> in the example above).</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Route</th>\n<th>Example URL</th>\n<th><code>params</code></th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>pages/shop/[[...slug]].js</code></td>\n<td><code>/shop</code></td>\n<td><code>{ slug: [] }</code></td>\n</tr>\n<tr>\n<td><code>pages/shop/[[...slug]].js</code></td>\n<td><code>/shop/a</code></td>\n<td><code>{ slug: ['a'] }</code></td>\n</tr>\n<tr>\n<td><code>pages/shop/[[...slug]].js</code></td>\n<td><code>/shop/a/b</code></td>\n<td><code>{ slug: ['a', 'b'] }</code></td>\n</tr>\n<tr>\n<td><code>pages/shop/[[...slug]].js</code></td>\n<td><code>/shop/a/b/c</code></td>\n<td><code>{ slug: ['a', 'b', 'c'] }</code></td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/dynamic-routes\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/dynamic-routes</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/typedroutes":"<h1 class=\"break-words\">typedRoutes (experimental)</h1>\n<p>Experimental support for <a href=\"../../building-your-application/configuring/typescript#statically-typed-links\">statically typed links</a>. This feature requires using the App Router as well as TypeScript in your project.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  experimental: {\n    typedRoutes: true,\n  },\n}\n \nmodule.exports = nextConfig</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/typedRoutes\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/typedRoutes</a>\n  </p>\n</div>\n","app/api-reference/next-config-js/webpack":"<h1 class=\"break-words\">Custom Webpack Config</h1> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: changes to webpack config are not covered by semver so proceed at your own risk</p> </blockquote> <p>Before continuing to add custom webpack configuration to your application make sure Next.js doesn't already support your use-case:</p> <ul> <li><a href=\"../../building-your-application/styling\">CSS imports</a></li> <li><a href=\"../../building-your-application/styling/css-modules\">CSS modules</a></li> <li><a href=\"../../building-your-application/styling/sass\">Sass/SCSS imports</a></li> <li><a href=\"../../building-your-application/styling/sass\">Sass/SCSS modules</a></li> </ul>  <p>Some commonly asked for features are available as plugins:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/packages/next-mdx\" rel=\"noopener noreferrer\" target=\"_blank\">@next/mdx</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/packages/next-bundle-analyzer\" rel=\"noopener noreferrer\" target=\"_blank\">@next/bundle-analyzer</a></li> </ul> <p>In order to extend our usage of <code>webpack</code>, you can define a function that extends its config inside <code>next.config.js</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  webpack: (\n    config,\n    { buildId, dev, isServer, defaultLoaders, nextRuntime, webpack }\n  ) =&gt; {\n    // Important: return the modified config\n    return config\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p>The <code>webpack</code> function is executed three times, twice for the server (nodejs / edge runtime) and once for the client. This allows you to distinguish between client and server configuration using the <code>isServer</code> property.</p> </blockquote> <p>The second argument to the <code>webpack</code> function is an object with the following properties:</p> <ul> <li>\n<code>buildId</code>: <code>String</code> - The build id, used as a unique identifier between builds</li> <li>\n<code>dev</code>: <code>Boolean</code> - Indicates if the compilation will be done in development</li> <li>\n<code>isServer</code>: <code>Boolean</code> - It's <code>true</code> for server-side compilation, and <code>false</code> for client-side compilation</li> <li>\n<code>nextRuntime</code>: <code>String | undefined</code> - The target runtime for server-side compilation; either <code>\"edge\"</code> or <code>\"nodejs\"</code>, it's <code>undefined</code> for client-side compilation.</li> <li>\n<code>defaultLoaders</code>: <code>Object</code> - Default loaders used internally by Next.js: <ul> <li>\n<code>babel</code>: <code>Object</code> - Default <code>babel-loader</code> configuration</li> </ul> </li> </ul> <p>Example usage of <code>defaultLoaders.babel</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Example config for adding a loader that depends on babel-loader\n// This source was taken from the @next/mdx plugin source:\n// https://github.com/vercel/next.js/tree/canary/packages/next-mdx\nmodule.exports = {\n  webpack: (config, options) =&gt; {\n    config.module.rules.push({\n      test: /\\.mdx/,\n      use: [\n        options.defaultLoaders.babel,\n        {\n          loader: '@mdx-js/loader',\n          options: pluginOptions.options,\n        },\n      ],\n    })\n \n    return config\n  },\n}</pre>\n</div> <h4 id=\"nextruntime\" data-docs-heading=\"\">nextRuntime     </h4> <p>Notice that <code>isServer</code> is <code>true</code> when <code>nextRuntime</code> is <code>\"edge\"</code> or <code>\"nodejs\"</code>, nextRuntime \"<code>edge</code>\" is currently for middleware and Server Components in edge runtime only.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app/api-reference/next-config-js/webpack\" class=\"_attribution-link\">https://nextjs.org/docs/app/api-reference/next-config-js/webpack</a>\n  </p>\n</div>\n","pages/building-your-application":"<h1 class=\"break-words\">Building Your Application</h1> <p>Next.js provides the building blocks to create flexible, full-stack web applications. The guides in <strong>Building Your Application</strong> explain how to use these features and how to customize your application's behavior.</p> <p>The sections and pages are organized sequentially, from basic to advanced, so you can follow them step-by-step when building your Next.js application. However, you can read them in any order or skip to the pages that apply to your use case.</p>  <p>If you're new to Next.js, we recommend starting with the <a href=\"building-your-application/routing\">Routing</a>, <a href=\"building-your-application/rendering\">Rendering</a>, <a href=\"building-your-application/data-fetching\">Data Fetching</a> and <a href=\"building-your-application/styling\">Styling</a> sections, as they introduce the fundamental Next.js and web concepts to help you get started. Then, you can dive deeper into the other sections such as <a href=\"building-your-application/optimizing\">Optimizing</a> and <a href=\"building-your-application/configuring\">Configuring</a>. Finally, once you're ready, checkout the <a href=\"building-your-application/deploying\">Deploying</a> and <a href=\"building-your-application/upgrading\">Upgrading</a> sections.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application</a>\n  </p>\n</div>\n","pages/building-your-application/routing":"<h1 class=\"break-words\">Routing</h1>\n<p>The Pages Router has a file-system based router built on concepts of pages. When a file is added to the <code>pages</code> directory it's automatically available as a route. Learn more about routing in the Pages Router:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing</a>\n  </p>\n</div>\n","pages/building-your-application/routing/redirecting":"<h1 class=\"break-words\">Redirecting</h1>\n<p>There are a few ways you can handle redirects in Next.js. This page will go through each available option, use cases, and how to manage large numbers of redirects.</p>  <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Purpose</th>\n<th>Where</th>\n<th>Status Code</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#userouter-hook\"><code>useRouter</code></a></td>\n<td>Perform a client-side navigation</td>\n<td>Components</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td><a href=\"#redirects-in-nextconfigjs\"><code>redirects</code> in <code>next.config.js</code></a></td>\n<td>Redirect an incoming request based on a path</td>\n<td>\n<code>next.config.js</code> file</td>\n<td>307 (Temporary) or 308 (Permanent)</td>\n</tr>\n<tr>\n<td><a href=\"#nextresponseredirect-in-middleware\"><code>NextResponse.redirect</code></a></td>\n<td>Redirect an incoming request based on a condition</td>\n<td>Middleware</td>\n<td>Any</td>\n</tr>\n</tbody>\n</table></div>  <h2 id=\"userouter-hook\" data-docs-heading=\"\">useRouter() hook     </h2>  <p>If you need to redirect inside a component, you can use the <code>push</code> method from the <code>useRouter</code> hook. For example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.push('/dashboard')}&gt;\n      Dashboard\n    &lt;/button&gt;\n  )\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>If you don't need to programmatically navigate a user, you should use a <a href=\"../../../app/api-reference/components/link\"><code>&lt;Link&gt;</code></a> component.</li> </ul> </blockquote>  <p>See the <a href=\"../../api-reference/functions/use-router\"><code>useRouter</code> API reference</a> for more information.</p> <h2 id=\"redirects-in-nextconfigjs\" data-docs-heading=\"\">redirects in next.config.js     </h2> <p>The <code>redirects</code> option in the <code>next.config.js</code> file allows you to redirect an incoming request path to a different destination path. This is useful when you change the URL structure of pages or have a list of redirects that are known ahead of time.</p> <p><code>redirects</code> supports <a href=\"../../../app/api-reference/next-config-js/redirects#path-matching\">path</a>, <a href=\"../../../app/api-reference/next-config-js/redirects#header-cookie-and-query-matching\">header, cookie, and query matching</a>, giving you the flexibility to redirect users based on an incoming request.</p> <p>To use <code>redirects</code>, add the option to your <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      // Basic redirect\n      {\n        source: '/about',\n        destination: '/',\n        permanent: true,\n      },\n      // Wildcard path matching\n      {\n        source: '/blog/:slug',\n        destination: '/news/:slug',\n        permanent: true,\n      },\n    ]\n  },\n}</pre></div> <p>See the <a href=\"../../../app/api-reference/next-config-js/redirects\"><code>redirects</code> API reference</a> for more information.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>redirects</code> can return a 307 (Temporary Redirect) or 308 (Permanent Redirect) status code with the <code>permanent</code> option.</li> <li>\n<code>redirects</code> may have a limit on platforms. For example, on Vercel, there's a limit of 1,024 redirects. To manage a large number of redirects (1000+), consider creating a custom solution using <a href=\"../../../app/building-your-application/routing/middleware\">Middleware</a>. See <a href=\"#managing-redirects-at-scale-advanced\">managing redirects at scale</a> for more.</li> <li>\n<code>redirects</code> runs <strong>before</strong> Middleware.</li> </ul> </blockquote> <h2 id=\"nextresponseredirect-in-middleware\" data-docs-heading=\"\">NextResponse.redirect in Middleware     </h2> <p>Middleware allows you to run code before a request is completed. Then, based on the incoming request, redirect to a different URL using <code>NextResponse.redirect</code>. This is useful if you want to redirect users based on a condition (e.g. authentication, session management, etc) or have <a href=\"#managing-redirects-at-scale-advanced\">a large number of redirects</a>.</p> <p>For example, to redirect the user to a <code>/login</code> page if they are not authenticated:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse, NextRequest } from 'next/server'\nimport { authenticate } from 'auth-provider'\n \nexport function middleware(request: NextRequest) {\n  const isAuthenticated = authenticate(request)\n \n  // If the user is authenticated, continue as normal\n  if (isAuthenticated) {\n    return NextResponse.next()\n  }\n \n  // Redirect to login page if not authenticated\n  return NextResponse.redirect(new URL('/login', request.url))\n}\n \nexport const config = {\n  matcher: '/dashboard/:path*',\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Middleware runs <strong>after</strong> <code>redirects</code> in <code>next.config.js</code> and <strong>before</strong> rendering.</li> </ul> </blockquote> <p>See the <a href=\"../../../app/building-your-application/routing/middleware\">Middleware</a> documentation for more information.</p> <h2 id=\"managing-redirects-at-scale-advanced\" data-docs-heading=\"\">Managing redirects at scale (advanced)     </h2> <p>To manage a large number of redirects (1000+), you may consider creating a custom solution using Middleware. This allows you to handle redirects programmatically without having to redeploy your application.</p> <p>To do this, you'll need to consider:</p> <ol> <li>Creating and storing a redirect map.</li> <li>Optimizing data lookup performance.</li> </ol> <blockquote class=\"p-3 text-sm\"> <p><strong>Next.js Example</strong>: See our <a href=\"https://redirects-bloom-filter.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Middleware with Bloom filter</a> example for an implementation of the recommendations below.</p> </blockquote> <h3 id=\"1-creating-and-storing-a-redirect-map\" data-docs-heading=\"\">1. Creating and storing a redirect map     </h3> <p>A redirect map is a list of redirects that you can store in a database (usually a key-value store) or JSON file.</p> <p>Consider the following data structure:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"/old\": {\n    \"destination\": \"/new\",\n    \"permanent\": true\n  },\n  \"/blog/post-old\": {\n    \"destination\": \"/blog/post-new\",\n    \"permanent\": true\n  }\n}</pre>\n</div> <p>In <a href=\"../../../app/building-your-application/routing/middleware\">Middleware</a>, you can read from a database such as Vercel's <a href=\"https://vercel.com/docs/storage/edge-config/get-started?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Edge Config</a> or <a href=\"https://vercel.com/docs/storage/vercel-kv?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Redis</a>, and redirect the user based on the incoming request:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse, NextRequest } from 'next/server'\nimport { get } from '@vercel/edge-config'\n \ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n \nexport async function middleware(request: NextRequest) {\n  const pathname = request.nextUrl.pathname\n  const redirectData = await get(pathname)\n \n  if (redirectData &amp;&amp; typeof redirectData === 'string') {\n    const redirectEntry: RedirectEntry = JSON.parse(redirectData)\n    const statusCode = redirectEntry.permanent ? 308 : 307\n    return NextResponse.redirect(redirectEntry.destination, statusCode)\n  }\n \n  // No redirect found, continue without redirecting\n  return NextResponse.next()\n}</pre></div>  <h3 id=\"2-optimizing-data-lookup-performance\" data-docs-heading=\"\">2. Optimizing data lookup performance     </h3> <p>Reading a large dataset for every incoming request can be slow and expensive. There are two ways you can optimize data lookup performance:</p> <ul> <li>Use a database that is optimized for fast reads, such as <a href=\"https://vercel.com/docs/storage/edge-config/get-started?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Edge Config</a> or <a href=\"https://vercel.com/docs/storage/vercel-kv?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Redis</a>.</li> <li>Use a data lookup strategy such as a <a href=\"https://en.wikipedia.org/wiki/Bloom_filter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Bloom filter</a> to efficiently check if a redirect exists <strong>before</strong> reading the larger redirects file or database.</li> </ul> <p>Considering the previous example, you can import a generated bloom filter file into Middleware, then, check if the incoming request pathname exists in the bloom filter.</p> <p>If it does, forward the request to a  <a href=\"api-routes\">API Routes</a> which will check the actual file and redirect the user to the appropriate URL. This avoids importing a large redirects file into Middleware, which can slow down every incoming request.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse, NextRequest } from 'next/server'\nimport { ScalableBloomFilter } from 'bloom-filters'\nimport GeneratedBloomFilter from './redirects/bloom-filter.json'\n \ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n \n// Initialize bloom filter from a generated JSON file\nconst bloomFilter = ScalableBloomFilter.fromJSON(GeneratedBloomFilter as any)\n \nexport async function middleware(request: NextRequest) {\n  // Get the path for the incoming request\n  const pathname = request.nextUrl.pathname\n \n  // Check if the path is in the bloom filter\n  if (bloomFilter.has(pathname)) {\n    // Forward the pathname to the Route Handler\n    const api = new URL(\n      `/api/redirects?pathname=${encodeURIComponent(request.nextUrl.pathname)}`,\n      request.nextUrl.origin\n    )\n \n    try {\n      // Fetch redirect data from the Route Handler\n      const redirectData = await fetch(api)\n \n      if (redirectData.ok) {\n        const redirectEntry: RedirectEntry | undefined =\n          await redirectData.json()\n \n        if (redirectEntry) {\n          // Determine the status code\n          const statusCode = redirectEntry.permanent ? 308 : 307\n \n          // Redirect to the destination\n          return NextResponse.redirect(redirectEntry.destination, statusCode)\n        }\n      }\n    } catch (error) {\n      console.error(error)\n    }\n  }\n \n  // No redirect found, continue the request without redirecting\n  return NextResponse.next()\n}</pre></div>   <p>Then, in the API Route:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextApiRequest, NextApiResponse } from 'next'\nimport redirects from '@/app/redirects/redirects.json'\n \ntype RedirectEntry = {\n  destination: string\n  permanent: boolean\n}\n \nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  const pathname = req.query.pathname\n  if (!pathname) {\n    return res.status(400).json({ message: 'Bad Request' })\n  }\n \n  // Get the redirect entry from the redirects.json file\n  const redirect = (redirects as Record&lt;string, RedirectEntry&gt;)[pathname]\n \n  // Account for bloom filter false positives\n  if (!redirect) {\n    return res.status(400).json({ message: 'No redirect' })\n  }\n \n  // Return the redirect entry\n  return res.json(redirect)\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>To generate a bloom filter, you can use a library like <a href=\"https://www.npmjs.com/package/bloom-filters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>bloom-filters</code></a>.</li> <li>You should validate requests made to your Route Handler to prevent malicious requests.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/redirecting\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/redirecting</a>\n  </p>\n</div>\n","pages/building-your-application/routing/custom-app":"<h1 class=\"break-words\">Custom App</h1>\n<p>Next.js uses the <code>App</code> component to initialize pages. You can override it and control the page initialization and:</p> <ul> <li>Create a shared layout between page changes</li> <li>Inject additional data into pages</li> <li><a href=\"../styling\">Add global CSS</a></li> </ul> <h2 id=\"usage\" data-docs-heading=\"\">Usage     </h2> <p>To override the default <code>App</code>, create the file <code>pages/_app</code> as shown below:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { AppProps } from 'next/app'\n \nexport default function MyApp({ Component, pageProps }: AppProps) {\n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>  <p>The <code>Component</code> prop is the active <code>page</code>, so whenever you navigate between routes, <code>Component</code> will change to the new <code>page</code>. Therefore, any props you send to <code>Component</code> will be received by the <code>page</code>.</p> <p><code>pageProps</code> is an object with the initial props that were preloaded for your page by one of our <a href=\"../data-fetching\">data fetching methods</a>, otherwise it's an empty object.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>If your app is running and you added a custom <code>App</code>, you'll need to restart the development server. Only required if <code>pages/_app.js</code> didn't exist before.</li> <li>\n<code>App</code> does not support Next.js <a href=\"../data-fetching\">Data Fetching methods</a> like <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a> or <a href=\"../data-fetching/get-server-side-props\"><code>getServerSideProps</code></a>.</li> </ul> </blockquote> <h2 id=\"getinitialprops-with-app\" data-docs-heading=\"\">getInitialProps with App     </h2> <p>Using <a href=\"../../api-reference/functions/get-initial-props\"><code>getInitialProps</code></a> in <code>App</code> will disable <a href=\"../rendering/automatic-static-optimization\">Automatic Static Optimization</a> for pages without <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a>.</p> <p><strong>We do not recommend using this pattern.</strong> Instead, consider <a href=\"../../../app/building-your-application/upgrading/app-router-migration\">incrementally adopting</a> the App Router, which allows you to more easily fetch data for <a href=\"../../../app/building-your-application/routing/pages-and-layouts\">pages and layouts</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import App, { AppContext, AppInitialProps, AppProps } from 'next/app'\n \ntype AppOwnProps = { example: string }\n \nexport default function MyApp({\n  Component,\n  pageProps,\n  example,\n}: AppProps &amp; AppOwnProps) {\n  return (\n    &lt;&gt;\n      &lt;p&gt;Data: {example}&lt;/p&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/&gt;\n  )\n}\n \nMyApp.getInitialProps = async (\n  context: AppContext\n): Promise&lt;AppOwnProps &amp; AppInitialProps&gt; =&gt; {\n  const ctx = await App.getInitialProps(context)\n \n  return { ...ctx, example: 'data' }\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/custom-app\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/custom-app</a>\n  </p>\n</div>\n","pages/building-your-application/routing/custom-document":"<h1 class=\"break-words\">Custom Document</h1>\n<p>A custom <code>Document</code> can update the <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags used to render a <a href=\"pages-and-layouts\">Page</a>.</p> <p>To override the default <code>Document</code>, create the file <code>pages/_document</code> as shown below:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Html, Head, Main, NextScript } from 'next/document'\n \nexport default function Document() {\n  return (\n    &lt;Html lang=\"en\"&gt;\n      &lt;Head /&gt;\n      &lt;body&gt;\n        &lt;Main /&gt;\n        &lt;NextScript /&gt;\n      &lt;/body&gt;\n    &lt;/Html&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>\n<code>_document</code> is only rendered on the server, so event handlers like <code>onClick</code> cannot be used in this file.</li> <li>\n<code>&lt;Html&gt;</code>, <code>&lt;Head /&gt;</code>, <code>&lt;Main /&gt;</code> and <code>&lt;NextScript /&gt;</code> are required for the page to be properly rendered.</li> </ul> </blockquote> <h2 id=\"caveats\" data-docs-heading=\"\">Caveats     </h2> <ul> <li>The <code>&lt;Head /&gt;</code> component used in <code>_document</code> is not the same as <a href=\"../../api-reference/components/head\"><code>next/head</code></a>. The <code>&lt;Head /&gt;</code> component used here should only be used for any <code>&lt;head&gt;</code> code that is common for all pages. For all other cases, such as <code>&lt;title&gt;</code> tags, we recommend using <a href=\"../../api-reference/components/head\"><code>next/head</code></a> in your pages or components.</li> <li>React components outside of <code>&lt;Main /&gt;</code> will not be initialized by the browser. Do <em>not</em> add application logic here or custom CSS (like <code>styled-jsx</code>). If you need shared components in all your pages (like a menu or a toolbar), read <a href=\"pages-and-layouts#layout-pattern\">Layouts</a> instead.</li> <li>\n<code>Document</code> currently does not support Next.js <a href=\"../data-fetching\">Data Fetching methods</a> like <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a> or <a href=\"../data-fetching/get-server-side-props\"><code>getServerSideProps</code></a>.</li> </ul> <h2 id=\"customizing-renderpage\" data-docs-heading=\"\">Customizing renderPage     </h2> <p>Customizing <code>renderPage</code> is advanced and only needed for libraries like CSS-in-JS to support server-side rendering. This is not needed for built-in <code>styled-jsx</code> support.</p> <p><strong>We do not recommend using this pattern.</strong> Instead, consider <a href=\"../../../app/building-your-application/upgrading/app-router-migration\">incrementally adopting</a> the App Router, which allows you to more easily fetch data for <a href=\"../../../app/building-your-application/routing/pages-and-layouts\">pages and layouts</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Document, {\n  Html,\n  Head,\n  Main,\n  NextScript,\n  DocumentContext,\n  DocumentInitialProps,\n} from 'next/document'\n \nclass MyDocument extends Document {\n  static async getInitialProps(\n    ctx: DocumentContext\n  ): Promise&lt;DocumentInitialProps&gt; {\n    const originalRenderPage = ctx.renderPage\n \n    // Run the React rendering logic synchronously\n    ctx.renderPage = () =&gt;\n      originalRenderPage({\n        // Useful for wrapping the whole react tree\n        enhanceApp: (App) =&gt; App,\n        // Useful for wrapping in a per-page basis\n        enhanceComponent: (Component) =&gt; Component,\n      })\n \n    // Run the parent `getInitialProps`, it now includes the custom `renderPage`\n    const initialProps = await Document.getInitialProps(ctx)\n \n    return initialProps\n  }\n \n  render() {\n    return (\n      &lt;Html lang=\"en\"&gt;\n        &lt;Head /&gt;\n        &lt;body&gt;\n          &lt;Main /&gt;\n          &lt;NextScript /&gt;\n        &lt;/body&gt;\n      &lt;/Html&gt;\n    )\n  }\n}\n \nexport default MyDocument</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>\n<code>getInitialProps</code> in <code>_document</code> is not called during client-side transitions.</li> <li>The <code>ctx</code> object for <code>_document</code> is equivalent to the one received in <a href=\"../../api-reference/functions/get-initial-props#context-object\"><code>getInitialProps</code></a>, with the addition of <code>renderPage</code>.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/custom-document\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/custom-document</a>\n  </p>\n</div>\n","pages/building-your-application/routing/api-routes":"<h1 class=\"break-words\">API Routes</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/api-routes\" rel=\"noopener noreferrer\" target=\"_blank\">Basic API Routes</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/api-routes-middleware\" rel=\"noopener noreferrer\" target=\"_blank\">API Routes Request Helpers</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/api-routes-graphql\" rel=\"noopener noreferrer\" target=\"_blank\">API Routes with GraphQL</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/api-routes-rest\" rel=\"noopener noreferrer\" target=\"_blank\">API Routes with REST</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/api-routes-cors\" rel=\"noopener noreferrer\" target=\"_blank\">API Routes with CORS</a></li> </ul></details> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you are using the App Router, you can use <a href=\"../../../app/building-your-application/data-fetching/fetching-caching-and-revalidating\">Server Components</a> or <a href=\"../../../app/building-your-application/routing/route-handlers\">Route Handlers</a> instead of API Routes.</p> </blockquote> <p>API routes provide a solution to build a <strong>public API</strong> with Next.js.</p> <p>Any file inside the folder <code>pages/api</code> is mapped to <code>/api/*</code> and will be treated as an API endpoint instead of a <code>page</code>. They are server-side only bundles and won't increase your client-side bundle size.</p> <p>For example, the following API route returns a JSON response with a status code of <code>200</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \ntype ResponseData = {\n  message: string\n}\n \nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse&lt;ResponseData&gt;\n) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>API Routes <a href=\"https://developer.mozilla.org/docs/Web/HTTP/CORS\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">do not specify CORS headers</a>, meaning they are <strong>same-origin only</strong> by default. You can customize such behavior by wrapping the request handler with the <a href=\"https://github.com/vercel/next.js/tree/canary/examples/api-routes-cors\" rel=\"noopener noreferrer\" target=\"_blank\">CORS request helpers</a>.</li> </ul> </blockquote> <ul> <li>API Routes can't be used with <a href=\"../deploying/static-exports\">static exports</a>. However, <a href=\"../../../app/building-your-application/routing/route-handlers\">Route Handlers</a> in the App Router can. <blockquote class=\"p-3 text-sm\"> <ul> <li>API Routes will be affected by <a href=\"../../api-reference/next-config-js/pageextensions\"><code>pageExtensions</code> configuration</a> in <code>next.config.js</code>.</li> </ul> </blockquote> </li> </ul> <h2 id=\"parameters\" data-docs-heading=\"\">Parameters     </h2> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function handler(req: NextApiRequest, res: NextApiResponse) {\n  // ...\n}</pre>\n</div> <ul> <li>\n<code>req</code>: An instance of <a href=\"https://nodejs.org/api/http.html#class-httpincomingmessage\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">http.IncomingMessage</a>\n</li> <li>\n<code>res</code>: An instance of <a href=\"https://nodejs.org/api/http.html#class-httpserverresponse\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">http.ServerResponse</a>\n</li> </ul> <h2 id=\"http-methods\" data-docs-heading=\"\">HTTP Methods     </h2> <p>To handle different HTTP methods in an API route, you can use <code>req.method</code> in your request handler, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  if (req.method === 'POST') {\n    // Process a POST request\n  } else {\n    // Handle any other HTTP method\n  }\n}</pre></div>  <h2 id=\"request-helpers\" data-docs-heading=\"\">Request Helpers     </h2> <p>API Routes provide built-in request helpers which parse the incoming request (<code>req</code>):</p> <ul> <li>\n<code>req.cookies</code> - An object containing the cookies sent by the request. Defaults to <code>{}</code>\n</li> <li>\n<code>req.query</code> - An object containing the <a href=\"https://en.wikipedia.org/wiki/Query_string\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">query string</a>. Defaults to <code>{}</code>\n</li> <li>\n<code>req.body</code> - An object containing the body parsed by <code>content-type</code>, or <code>null</code> if no body was sent</li> </ul> <h3 id=\"custom-config\" data-docs-heading=\"\">Custom config     </h3> <p>Every API Route can export a <code>config</code> object to change the default configuration, which is the following:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  api: {\n    bodyParser: {\n      sizeLimit: '1mb',\n    },\n  },\n  // Specifies the maximum allowed duration for this function to execute (in seconds)\n  maxDuration: 5,\n}</pre>\n</div> <p><code>bodyParser</code> is automatically enabled. If you want to consume the body as a <code>Stream</code> or with <a href=\"https://www.npmjs.com/package/raw-body\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>raw-body</code></a>, you can set this to <code>false</code>.</p> <p>One use case for disabling the automatic <code>bodyParsing</code> is to allow you to verify the raw body of a <strong>webhook</strong> request, for example <a href=\"https://docs.github.com/en/developers/webhooks-and-events/webhooks/securing-your-webhooks#validating-payloads-from-github\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">from GitHub</a>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  api: {\n    bodyParser: false,\n  },\n}</pre>\n</div> <p><code>bodyParser.sizeLimit</code> is the maximum size allowed for the parsed body, in any format supported by <a href=\"https://github.com/visionmedia/bytes.js\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">bytes</a>, like so:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  api: {\n    bodyParser: {\n      sizeLimit: '500kb',\n    },\n  },\n}</pre>\n</div> <p><code>externalResolver</code> is an explicit flag that tells the server that this route is being handled by an external resolver like <em>express</em> or <em>connect</em>. Enabling this option disables warnings for unresolved requests.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  api: {\n    externalResolver: true,\n  },\n}</pre>\n</div> <p><code>responseLimit</code> is automatically enabled, warning when an API Routes' response body is over 4MB.</p> <p>If you are not using Next.js in a serverless environment, and understand the performance implications of not using a CDN or dedicated media host, you can set this limit to <code>false</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  api: {\n    responseLimit: false,\n  },\n}</pre>\n</div> <p><code>responseLimit</code> can also take the number of bytes or any string format supported by <code>bytes</code>, for example <code>1000</code>, <code>'500kb'</code> or <code>'3mb'</code>. This value will be the maximum response size before a warning is displayed. Default is 4MB. (see above)</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  api: {\n    responseLimit: '8mb',\n  },\n}</pre>\n</div> <h2 id=\"response-helpers\" data-docs-heading=\"\">Response Helpers     </h2> <p>The <a href=\"https://nodejs.org/api/http.html#http_class_http_serverresponse\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Server Response object</a>, (often abbreviated as <code>res</code>) includes a set of Express.js-like helper methods to improve the developer experience and increase the speed of creating new API endpoints.</p> <p>The included helpers are:</p> <ul> <li>\n<code>res.status(code)</code> - A function to set the status code. <code>code</code> must be a valid <a href=\"https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP status code</a>\n</li> <li>\n<code>res.json(body)</code> - Sends a JSON response. <code>body</code> must be a <a href=\"https://developer.mozilla.org/docs/Glossary/Serialization\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">serializable object</a>\n</li> <li>\n<code>res.send(body)</code> - Sends the HTTP response. <code>body</code> can be a <code>string</code>, an <code>object</code> or a <code>Buffer</code>\n</li> <li>\n<code>res.redirect([status,] path)</code> - Redirects to a specified path or URL. <code>status</code> must be a valid <a href=\"https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP status code</a>. If not specified, <code>status</code> defaults to \"307\" \"Temporary redirect\".</li> <li>\n<code>res.revalidate(urlPath)</code> - <a href=\"../data-fetching/incremental-static-regeneration#on-demand-revalidation\">Revalidate a page on demand</a> using <code>getStaticProps</code>. <code>urlPath</code> must be a <code>string</code>.</li> </ul> <h3 id=\"setting-the-status-code-of-a-response\" data-docs-heading=\"\">Setting the status code of a response     </h3> <p>When sending a response back to the client, you can set the status code of the response.</p> <p>The following example sets the status code of the response to <code>200</code> (<code>OK</code>) and returns a <code>message</code> property with the value of <code>Hello from Next.js!</code> as a JSON response:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \ntype ResponseData = {\n  message: string\n}\n \nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse&lt;ResponseData&gt;\n) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}</pre></div>  <h3 id=\"sending-a-json-response\" data-docs-heading=\"\">Sending a JSON response     </h3> <p>When sending a response back to the client you can send a JSON response, this must be a <a href=\"https://developer.mozilla.org/docs/Glossary/Serialization\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">serializable object</a>. In a real world application you might want to let the client know the status of the request depending on the result of the requested endpoint.</p> <p>The following example sends a JSON response with the status code <code>200</code> (<code>OK</code>) and the result of the async operation. It's contained in a try catch block to handle any errors that may occur, with the appropriate status code and error message caught and sent back to the client:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  try {\n    const result = await someAsyncOperation()\n    res.status(200).json({ result })\n  } catch (err) {\n    res.status(500).json({ error: 'failed to load data' })\n  }\n}</pre></div>  <h3 id=\"sending-a-http-response\" data-docs-heading=\"\">Sending a HTTP response     </h3> <p>Sending an HTTP response works the same way as when sending a JSON response. The only difference is that the response body can be a <code>string</code>, an <code>object</code> or a <code>Buffer</code>.</p> <p>The following example sends a HTTP response with the status code <code>200</code> (<code>OK</code>) and the result of the async operation.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  try {\n    const result = await someAsyncOperation()\n    res.status(200).send({ result })\n  } catch (err) {\n    res.status(500).send({ error: 'failed to fetch data' })\n  }\n}</pre></div>  <h3 id=\"redirects-to-a-specified-path-or-url\" data-docs-heading=\"\">Redirects to a specified path or URL     </h3> <p>Taking a form as an example, you may want to redirect your client to a specified path or URL once they have submitted the form.</p> <p>The following example redirects the client to the <code>/</code> path if the form is successfully submitted:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const { name, message } = req.body\n \n  try {\n    await handleFormInputAsync({ name, message })\n    res.redirect(307, '/')\n  } catch (err) {\n    res.status(500).send({ error: 'Failed to fetch data' })\n  }\n}</pre></div>  <h3 id=\"adding-typescript-types\" data-docs-heading=\"\">Adding TypeScript types     </h3> <p>You can make your API Routes more type-safe by importing the <code>NextApiRequest</code> and <code>NextApiResponse</code> types from <code>next</code>, in addition to those, you can also type your response data:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \ntype ResponseData = {\n  message: string\n}\n \nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse&lt;ResponseData&gt;\n) {\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The body of <code>NextApiRequest</code> is <code>any</code> because the client may include any payload. You should validate the type/shape of the body at runtime before using it.</p> </blockquote> <h2 id=\"dynamic-api-routes\" data-docs-heading=\"\">Dynamic API Routes     </h2> <p>API Routes support <a href=\"dynamic-routes\">dynamic routes</a>, and follow the same file naming rules used for <code>pages/</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  const { pid } = req.query\n  res.end(`Post: ${pid}`)\n}</pre></div>  <p>Now, a request to <code>/api/post/abc</code> will respond with the text: <code>Post: abc</code>.</p> <h3 id=\"catch-all-api-routes\" data-docs-heading=\"\">Catch all API routes     </h3> <p>API Routes can be extended to catch all paths by adding three dots (<code>...</code>) inside the brackets. For example:</p> <ul> <li>\n<code>pages/api/post/[...slug].js</code> matches <code>/api/post/a</code>, but also <code>/api/post/a/b</code>, <code>/api/post/a/b/c</code> and so on.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You can use names other than <code>slug</code>, such as: <code>[...param]</code></p> </blockquote> <p>Matched parameters will be sent as a query parameter (<code>slug</code> in the example) to the page, and it will always be an array, so, the path <code>/api/post/a</code> will have the following <code>query</code> object:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{ \"slug\": [\"a\"] }</pre>\n</div> <p>And in the case of <code>/api/post/a/b</code>, and any other matching path, new parameters will be added to the array, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{ \"slug\": [\"a\", \"b\"] }</pre>\n</div> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  const { slug } = req.query\n  res.end(`Post: ${slug.join(', ')}`)\n}</pre></div>  <p>Now, a request to <code>/api/post/a/b/c</code> will respond with the text: <code>Post: a, b, c</code>.</p> <h3 id=\"optional-catch-all-api-routes\" data-docs-heading=\"\">Optional catch all API routes     </h3> <p>Catch all routes can be made optional by including the parameter in double brackets (<code>[[...slug]]</code>).</p> <p>For example, <code>pages/api/post/[[...slug]].js</code> will match <code>/api/post</code>, <code>/api/post/a</code>, <code>/api/post/a/b</code>, and so on.</p> <p>The main difference between catch all and optional catch all routes is that with optional, the route without the parameter is also matched (<code>/api/post</code> in the example above).</p> <p>The <code>query</code> objects are as follows:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{ } // GET `/api/post` (empty object)\n{ \"slug\": [\"a\"] } // `GET /api/post/a` (single-element array)\n{ \"slug\": [\"a\", \"b\"] } // `GET /api/post/a/b` (multi-element array)</pre>\n</div> <h3 id=\"caveats\" data-docs-heading=\"\">Caveats     </h3> <ul> <li>Predefined API routes take precedence over dynamic API routes, and dynamic API routes over catch all API routes. Take a look at the following examples: <ul> <li>\n<code>pages/api/post/create.js</code> - Will match <code>/api/post/create</code>\n</li> <li>\n<code>pages/api/post/[pid].js</code> - Will match <code>/api/post/1</code>, <code>/api/post/abc</code>, etc. But not <code>/api/post/create</code>\n</li> <li>\n<code>pages/api/post/[...slug].js</code> - Will match <code>/api/post/1/2</code>, <code>/api/post/a/b/c</code>, etc. But not <code>/api/post/create</code>, <code>/api/post/abc</code>\n</li> </ul> </li> </ul> <h2 id=\"edge-api-routes\" data-docs-heading=\"\">Edge API Routes     </h2> <p>If you would like to use API Routes with the Edge Runtime, we recommend incrementally adopting the App Router and using <a href=\"../../../app/building-your-application/routing/route-handlers\">Route Handlers</a> instead.</p> <p>The Route Handlers function signature is isomorphic, meaning you can use the same function for both Edge and Node.js runtimes.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/api-routes\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/api-routes</a>\n  </p>\n</div>\n","pages/building-your-application/routing/custom-error":"<h1 class=\"break-words\">Custom Errors</h1>\n<h2 id=\"404-page\" data-docs-heading=\"\">404 Page     </h2> <p>A 404 page may be accessed very often. Server-rendering an error page for every visit increases the load of the Next.js server. This can result in increased costs and slow experiences.</p> <p>To avoid the above pitfalls, Next.js provides a static 404 page by default without having to add any additional files.</p> <h3 id=\"customizing-the-404-page\" data-docs-heading=\"\">Customizing The 404 Page     </h3> <p>To create a custom 404 page you can create a <code>pages/404.js</code> file. This file is statically generated at build time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Custom404() {\n  return &lt;h1&gt;404 - Page Not Found&lt;/h1&gt;\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You can use <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a> inside this page if you need to fetch data at build time.</p> </blockquote> <h2 id=\"500-page\" data-docs-heading=\"\">500 Page     </h2> <p>Server-rendering an error page for every visit adds complexity to responding to errors. To help users get responses to errors as fast as possible, Next.js provides a static 500 page by default without having to add any additional files.</p> <h3 id=\"customizing-the-500-page\" data-docs-heading=\"\">Customizing The 500 Page     </h3> <p>To customize the 500 page you can create a <code>pages/500.js</code> file. This file is statically generated at build time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Custom500() {\n  return &lt;h1&gt;500 - Server-side error occurred&lt;/h1&gt;\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You can use <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a> inside this page if you need to fetch data at build time.</p> </blockquote> <h3 id=\"more-advanced-error-page-customizing\" data-docs-heading=\"\">More Advanced Error Page Customizing     </h3> <p>500 errors are handled both client-side and server-side by the <code>Error</code> component. If you wish to override it, define the file <code>pages/_error.js</code> and add the following code:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function Error({ statusCode }) {\n  return (\n    &lt;p&gt;\n      {statusCode\n        ? `An error ${statusCode} occurred on server`\n        : 'An error occurred on client'}\n    &lt;/p&gt;\n  )\n}\n \nError.getInitialProps = ({ res, err }) =&gt; {\n  const statusCode = res ? res.statusCode : err ? err.statusCode : 404\n  return { statusCode }\n}\n \nexport default Error</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><code>pages/_error.js</code> is only used in production. In development youll get an error with the call stack to know where the error originated from.</p> </blockquote> <h3 id=\"reusing-the-built-in-error-page\" data-docs-heading=\"\">Reusing the built-in error page     </h3> <p>If you want to render the built-in error page you can by importing the <code>Error</code> component:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Error from 'next/error'\n \nexport async function getServerSideProps() {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const errorCode = res.ok ? false : res.status\n  const json = await res.json()\n \n  return {\n    props: { errorCode, stars: json.stargazers_count },\n  }\n}\n \nexport default function Page({ errorCode, stars }) {\n  if (errorCode) {\n    return &lt;Error statusCode={errorCode} /&gt;\n  }\n \n  return &lt;div&gt;Next stars: {stars}&lt;/div&gt;\n}</pre>\n</div> <p>The <code>Error</code> component also takes <code>title</code> as a property if you want to pass in a text message along with a <code>statusCode</code>.</p> <p>If you have a custom <code>Error</code> component be sure to import that one instead. <code>next/error</code> exports the default component used by Next.js.</p> <h3 id=\"caveats\" data-docs-heading=\"\">Caveats     </h3> <ul> <li>\n<code>Error</code> does not currently support Next.js <a href=\"../data-fetching\">Data Fetching methods</a> like <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a> or <a href=\"../data-fetching/get-server-side-props\"><code>getServerSideProps</code></a>.</li> <li>\n<code>_error</code>, like <code>_app</code>, is a reserved pathname. <code>_error</code> is used to define the customized layouts and behaviors of the error pages. <code>/_error</code> will render 404 when accessed directly via <a href=\"../routing\">routing</a> or rendering in a <a href=\"../configuring/custom-server\">custom server</a>.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/custom-error\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/custom-error</a>\n  </p>\n</div>\n","pages/building-your-application/routing/internationalization":"<h1 class=\"break-words\">Internationalization (i18n) Routing</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/i18n-routing\" rel=\"noopener noreferrer\" target=\"_blank\">i18n routing</a></li> </ul></details> <p>Next.js has built-in support for internationalized (<a href=\"https://en.wikipedia.org/wiki/Internationalization_and_localization#Naming\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">i18n</a>) routing since <code>v10.0.0</code>. You can provide a list of locales, the default locale, and domain-specific locales and Next.js will automatically handle the routing.</p> <p>The i18n routing support is currently meant to complement existing i18n library solutions like <a href=\"https://formatjs.io/docs/getting-started/installation\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>react-intl</code></a>, <a href=\"https://react.i18next.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>react-i18next</code></a>, <a href=\"https://lingui.dev/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>lingui</code></a>, <a href=\"https://github.com/lukeed/rosetta\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>rosetta</code></a>, <a href=\"https://github.com/amannn/next-intl\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>next-intl</code></a>, <a href=\"https://github.com/aralroca/next-translate\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>next-translate</code></a>, <a href=\"https://github.com/Avansai/next-multilingual\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>next-multilingual</code></a>, <a href=\"https://tolgee.io/integrations/next\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>tolgee</code></a>, and others by streamlining the routes and locale parsing.</p> <h2 id=\"getting-started\" data-docs-heading=\"\">Getting started     </h2> <p>To get started, add the <code>i18n</code> config to your <code>next.config.js</code> file.</p> <p>Locales are <a href=\"https://www.unicode.org/reports/tr35/tr35-59/tr35.html#Identifiers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">UTS Locale Identifiers</a>, a standardized format for defining locales.</p> <p>Generally a Locale Identifier is made up of a language, region, and script separated by a dash: <code>language-region-script</code>. The region and script are optional. An example:</p> <ul> <li>\n<code>en-US</code> - English as spoken in the United States</li> <li>\n<code>nl-NL</code> - Dutch as spoken in the Netherlands</li> <li>\n<code>nl</code> - Dutch, no specific region</li> </ul> <p>If user locale is <code>nl-BE</code> and it is not listed in your configuration, they will be redirected to <code>nl</code> if available, or to the default locale otherwise. If you don't plan to support all regions of a country, it is therefore a good practice to include country locales that will act as fallbacks.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    // These are all the locales you want to support in\n    // your application\n    locales: ['en-US', 'fr', 'nl-NL'],\n    // This is the default locale you want to be used when visiting\n    // a non-locale prefixed path e.g. `/hello`\n    defaultLocale: 'en-US',\n    // This is a list of locale domains and the default locale they\n    // should handle (these are only required when setting up domain routing)\n    // Note: subdomains must be included in the domain value to be matched e.g. \"fr.example.com\".\n    domains: [\n      {\n        domain: 'example.com',\n        defaultLocale: 'en-US',\n      },\n      {\n        domain: 'example.nl',\n        defaultLocale: 'nl-NL',\n      },\n      {\n        domain: 'example.fr',\n        defaultLocale: 'fr',\n        // an optional http field can also be used to test\n        // locale domains locally with http instead of https\n        http: true,\n      },\n    ],\n  },\n}</pre></div> <h2 id=\"locale-strategies\" data-docs-heading=\"\">Locale Strategies     </h2> <p>There are two locale handling strategies: Sub-path Routing and Domain Routing.</p> <h3 id=\"sub-path-routing\" data-docs-heading=\"\">Sub-path Routing     </h3> <p>Sub-path Routing puts the locale in the url path.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['en-US', 'fr', 'nl-NL'],\n    defaultLocale: 'en-US',\n  },\n}</pre></div> <p>With the above configuration <code>en-US</code>, <code>fr</code>, and <code>nl-NL</code> will be available to be routed to, and <code>en-US</code> is the default locale. If you have a <code>pages/blog.js</code> the following urls would be available:</p> <ul> <li><code>/blog</code></li> <li><code>/fr/blog</code></li> <li><code>/nl-nl/blog</code></li> </ul> <p>The default locale does not have a prefix.</p> <h3 id=\"domain-routing\" data-docs-heading=\"\">Domain Routing     </h3> <p>By using domain routing you can configure locales to be served from different domains:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['en-US', 'fr', 'nl-NL', 'nl-BE'],\n    defaultLocale: 'en-US',\n \n    domains: [\n      {\n        // Note: subdomains must be included in the domain value to be matched\n        // e.g. www.example.com should be used if that is the expected hostname\n        domain: 'example.com',\n        defaultLocale: 'en-US',\n      },\n      {\n        domain: 'example.fr',\n        defaultLocale: 'fr',\n      },\n      {\n        domain: 'example.nl',\n        defaultLocale: 'nl-NL',\n        // specify other locales that should be redirected\n        // to this domain\n        locales: ['nl-BE'],\n      },\n    ],\n  },\n}</pre></div> <p>For example if you have <code>pages/blog.js</code> the following urls will be available:</p> <ul> <li><code>example.com/blog</code></li> <li><code>www.example.com/blog</code></li> <li><code>example.fr/blog</code></li> <li><code>example.nl/blog</code></li> <li><code>example.nl/nl-BE/blog</code></li> </ul> <h2 id=\"automatic-locale-detection\" data-docs-heading=\"\">Automatic Locale Detection     </h2> <p>When a user visits the application root (generally <code>/</code>), Next.js will try to automatically detect which locale the user prefers based on the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Accept-Language\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Accept-Language</code></a> header and the current domain.</p> <p>If a locale other than the default locale is detected, the user will be redirected to either:</p> <ul> <li>\n<strong>When using Sub-path Routing:</strong> The locale prefixed path</li> <li>\n<strong>When using Domain Routing:</strong> The domain with that locale specified as the default</li> </ul> <p>When using Domain Routing, if a user with the <code>Accept-Language</code> header <code>fr;q=0.9</code> visits <code>example.com</code>, they will be redirected to <code>example.fr</code> since that domain handles the <code>fr</code> locale by default.</p> <p>When using Sub-path Routing, the user would be redirected to <code>/fr</code>.</p> <h3 id=\"prefixing-the-default-locale\" data-docs-heading=\"\">Prefixing the Default Locale     </h3> <p>With Next.js 12 and <a href=\"middleware\">Middleware</a>, we can add a prefix to the default locale with a <a href=\"https://github.com/vercel/next.js/discussions/18419\" rel=\"noopener noreferrer\" target=\"_blank\">workaround</a>.</p> <p>For example, here's a <code>next.config.js</code> file with support for a few languages. Note the <code>\"default\"</code> locale has been added intentionally.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['default', 'en', 'de', 'fr'],\n    defaultLocale: 'default',\n    localeDetection: false,\n  },\n  trailingSlash: true,\n}</pre></div> <p>Next, we can use <a href=\"middleware\">Middleware</a> to add custom routing rules:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse } from 'next/server'\n \nconst PUBLIC_FILE = /\\.(.*)$/\n \nexport async function middleware(req: NextRequest) {\n  if (\n    req.nextUrl.pathname.startsWith('/_next') ||\n    req.nextUrl.pathname.includes('/api/') ||\n    PUBLIC_FILE.test(req.nextUrl.pathname)\n  ) {\n    return\n  }\n \n  if (req.nextUrl.locale === 'default') {\n    const locale = req.cookies.get('NEXT_LOCALE')?.value || 'en'\n \n    return NextResponse.redirect(\n      new URL(`/${locale}${req.nextUrl.pathname}${req.nextUrl.search}`, req.url)\n    )\n  }\n}</pre></div> <p>This <a href=\"middleware\">Middleware</a> skips adding the default prefix to <a href=\"api-routes\">API Routes</a> and <a href=\"../optimizing/static-assets\">public</a> files like fonts or images. If a request is made to the default locale, we redirect to our prefix <code>/en</code>.</p> <h3 id=\"disabling-automatic-locale-detection\" data-docs-heading=\"\">Disabling Automatic Locale Detection     </h3> <p>The automatic locale detection can be disabled with:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    localeDetection: false,\n  },\n}</pre></div> <p>When <code>localeDetection</code> is set to <code>false</code> Next.js will no longer automatically redirect based on the user's preferred locale and will only provide locale information detected from either the locale based domain or locale path as described above.</p> <h2 id=\"accessing-the-locale-information\" data-docs-heading=\"\">Accessing the locale information     </h2> <p>You can access the locale information via the Next.js router. For example, using the <a href=\"../../api-reference/functions/use-router\"><code>useRouter()</code></a> hook the following properties are available:</p> <ul> <li>\n<code>locale</code> contains the currently active locale.</li> <li>\n<code>locales</code> contains all configured locales.</li> <li>\n<code>defaultLocale</code> contains the configured default locale.</li> </ul> <p>When <a href=\"../rendering/static-site-generation\">pre-rendering</a> pages with <code>getStaticProps</code> or <code>getServerSideProps</code>, the locale information is provided in <a href=\"../data-fetching/get-static-props\">the context</a> provided to the function.</p> <p>When leveraging <code>getStaticPaths</code>, the configured locales are provided in the context parameter of the function under <code>locales</code> and the configured defaultLocale under <code>defaultLocale</code>.</p> <h2 id=\"transition-between-locales\" data-docs-heading=\"\">Transition between locales     </h2> <p>You can use <code>next/link</code> or <code>next/router</code> to transition between locales.</p> <p>For <code>next/link</code>, a <code>locale</code> prop can be provided to transition to a different locale from the currently active one. If no <code>locale</code> prop is provided, the currently active <code>locale</code> is used during client-transitions. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function IndexPage(props) {\n  return (\n    &lt;Link href=\"/another\" locale=\"fr\"&gt;\n      To /fr/another\n    &lt;/Link&gt;\n  )\n}</pre>\n</div> <p>When using the <code>next/router</code> methods directly, you can specify the <code>locale</code> that should be used via the transition options. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function IndexPage(props) {\n  const router = useRouter()\n \n  return (\n    &lt;div\n      onClick={() =&gt; {\n        router.push('/another', '/another', { locale: 'fr' })\n      }}\n    &gt;\n      to /fr/another\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <p>Note that to handle switching only the <code>locale</code> while preserving all routing information such as <a href=\"dynamic-routes\">dynamic route</a> query values or hidden href query values, you can provide the <code>href</code> parameter as an object:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\nconst router = useRouter()\nconst { pathname, asPath, query } = router\n// change just the locale and maintain all other route information including href's query\nrouter.push({ pathname, query }, asPath, { locale: nextLocale })</pre>\n</div> <p>See <a href=\"../../api-reference/functions/use-router#with-url-object\">here</a> for more information on the object structure for <code>router.push</code>.</p> <p>If you have a <code>href</code> that already includes the locale you can opt-out of automatically handling the locale prefixing:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function IndexPage(props) {\n  return (\n    &lt;Link href=\"/fr/another\" locale={false}&gt;\n      To /fr/another\n    &lt;/Link&gt;\n  )\n}</pre>\n</div> <h2 id=\"leveraging-the-next_locale-cookie\" data-docs-heading=\"\">Leveraging the NEXT_LOCALE cookie     </h2> <p>Next.js supports overriding the accept-language header with a <code>NEXT_LOCALE=the-locale</code> cookie. This cookie can be set using a language switcher and then when a user comes back to the site it will leverage the locale specified in the cookie when redirecting from <code>/</code> to the correct locale location.</p> <p>For example, if a user prefers the locale <code>fr</code> in their accept-language header but a <code>NEXT_LOCALE=en</code> cookie is set the <code>en</code> locale when visiting <code>/</code> the user will be redirected to the <code>en</code> locale location until the cookie is removed or expired.</p> <h2 id=\"search-engine-optimization\" data-docs-heading=\"\">Search Engine Optimization     </h2> <p>Since Next.js knows what language the user is visiting it will automatically add the <code>lang</code> attribute to the <code>&lt;html&gt;</code> tag.</p> <p>Next.js doesn't know about variants of a page so it's up to you to add the <code>hreflang</code> meta tags using <a href=\"../../api-reference/components/head\"><code>next/head</code></a>. You can learn more about <code>hreflang</code> in the <a href=\"https://support.google.com/webmasters/answer/189077\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Webmasters documentation</a>.</p> <h2 id=\"how-does-this-work-with-static-generation\" data-docs-heading=\"\">How does this work with Static Generation?     </h2> <blockquote class=\"p-3 text-sm\"> <p>Note that Internationalized Routing does not integrate with <a href=\"../deploying/static-exports\"><code>output: 'export'</code></a> as it does not leverage the Next.js routing layer. Hybrid Next.js applications that do not use <code>output: 'export'</code> are fully supported.</p> </blockquote> <h3 id=\"dynamic-routes-and-getstaticprops-pages\" data-docs-heading=\"\">Dynamic Routes and getStaticProps Pages     </h3> <p>For pages using <code>getStaticProps</code> with <a href=\"dynamic-routes\">Dynamic Routes</a>, all locale variants of the page desired to be prerendered need to be returned from <a href=\"../data-fetching/get-static-paths\"><code>getStaticPaths</code></a>. Along with the <code>params</code> object returned for <code>paths</code>, you can also return a <code>locale</code> field specifying which locale you want to render. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const getStaticPaths = ({ locales }) =&gt; {\n  return {\n    paths: [\n      // if no `locale` is provided only the defaultLocale will be generated\n      { params: { slug: 'post-1' }, locale: 'en-US' },\n      { params: { slug: 'post-1' }, locale: 'fr' },\n    ],\n    fallback: true,\n  }\n}</pre></div> <p>For <a href=\"../rendering/automatic-static-optimization\">Automatically Statically Optimized</a> and non-dynamic <code>getStaticProps</code> pages, <strong>a version of the page will be generated for each locale</strong>. This is important to consider because it can increase build times depending on how many locales are configured inside <code>getStaticProps</code>.</p> <p>For example, if you have 50 locales configured with 10 non-dynamic pages using <code>getStaticProps</code>, this means <code>getStaticProps</code> will be called 500 times. 50 versions of the 10 pages will be generated during each build.</p> <p>To decrease the build time of dynamic pages with <code>getStaticProps</code>, use a <a href=\"../../api-reference/functions/get-static-paths#fallback-true\"><code>fallback</code> mode</a>. This allows you to return only the most popular paths and locales from <code>getStaticPaths</code> for prerendering during the build. Then, Next.js will build the remaining pages at runtime as they are requested.</p> <h3 id=\"automatically-statically-optimized-pages\" data-docs-heading=\"\">Automatically Statically Optimized Pages     </h3> <p>For pages that are <a href=\"../rendering/automatic-static-optimization\">automatically statically optimized</a>, a version of the page will be generated for each locale.</p> <h3 id=\"non-dynamic-getstaticprops-pages\" data-docs-heading=\"\">Non-dynamic getStaticProps Pages     </h3> <p>For non-dynamic <code>getStaticProps</code> pages, a version is generated for each locale like above. <code>getStaticProps</code> is called with each <code>locale</code> that is being rendered. If you would like to opt-out of a certain locale from being pre-rendered, you can return <code>notFound: true</code> from <code>getStaticProps</code> and this variant of the page will not be generated.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps({ locale }) {\n  // Call an external API endpoint to get posts.\n  // You can use any data fetching library\n  const res = await fetch(`https://.../posts?locale=${locale}`)\n  const posts = await res.json()\n \n  if (posts.length === 0) {\n    return {\n      notFound: true,\n    }\n  }\n \n  // By returning { props: posts }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts,\n    },\n  }\n}</pre>\n</div> <h2 id=\"limits-for-the-i18n-config\" data-docs-heading=\"\">Limits for the i18n config     </h2> <ul> <li>\n<code>locales</code>: 100 total locales</li> <li>\n<code>domains</code>: 100 total locale domain items</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: These limits have been added initially to prevent potential <a href=\"#dynamic-routes-and-getstaticprops-pages\">performance issues at build time</a>. You can workaround these limits with custom routing using <a href=\"middleware\">Middleware</a> in Next.js 12.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/internationalization\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/internationalization</a>\n  </p>\n</div>\n","pages/building-your-application/routing/middleware":"<h1 class=\"break-words\">Middleware</h1> <p>Middleware allows you to run code before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.</p> <p>Middleware runs before cached content and routes are matched. See <a href=\"#matching-paths\">Matching Paths</a> for more details.</p> <h2 id=\"use-cases\" data-docs-heading=\"\">Use Cases     </h2> <p>Integrating Middleware into your application can lead to significant improvements in performance, security, and user experience. Some common scenarios where Middleware is particularly effective include:</p> <ul> <li>Authentication and Authorization: Ensure user identity and check session cookies before granting access to specific pages or API routes.</li> <li>Server-Side Redirects: Redirect users at the server level based on certain conditions (e.g., locale, user role).</li> <li>Path Rewriting: Support A/B testing, feature rollouts, or legacy paths by dynamically rewriting paths to API routes or pages based on request properties.</li> <li>Bot Detection: Protect your resources by detecting and blocking bot traffic.</li> <li>Logging and Analytics: Capture and analyze request data for insights before processing by the page or API.</li> <li>Feature Flagging: Enable or disable features dynamically for seamless feature rollouts or testing.</li> </ul> <p>Recognizing situations where middleware may not be the optimal approach is just as crucial. Here are some scenarios to be mindful of:</p> <ul> <li>Complex Data Fetching and Manipulation: Middleware is not designed for direct data fetching or manipulation, this should be done within Route Handlers or server-side utilities instead.</li> <li>Heavy Computational Tasks: Middleware should be lightweight and respond quickly or it can cause delays in page load. Heavy computational tasks or long-running processes should be done within dedicated Route Handlers.</li> <li>Extensive Session Management: While Middleware can manage basic session tasks, extensive session management should be managed by dedicated authentication services or within Route Handlers.</li> <li>Direct Database Operations: Performing direct database operations within Middleware is not recommended. Database interactions should done within Route Handlers or server-side utilities.</li> </ul> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>Use the file <code>middleware.ts</code> (or <code>.js</code>) in the root of your project to define Middleware. For example, at the same level as <code>pages</code> or <code>app</code>, or inside <code>src</code> if applicable.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: While only one <code>middleware.ts</code> file is supported per project, you can still organize your middleware logic modularly. Break out middleware functionalities into separate <code>.ts</code> or <code>.js</code> files and import them into your main <code>middleware.ts</code> file. This allows for cleaner management of route-specific middleware, aggregated in the <code>middleware.ts</code> for centralized control. By enforcing a single middleware file, it simplifies configuration, prevents potential conflicts, and optimizes performance by avoiding multiple middleware layers.</p> </blockquote> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \n// This function can be marked `async` if using `await` inside\nexport function middleware(request: NextRequest) {\n  return NextResponse.redirect(new URL('/home', request.url))\n}\n \n// See \"Matching Paths\" below to learn more\nexport const config = {\n  matcher: '/about/:path*',\n}</pre></div>  <h2 id=\"matching-paths\" data-docs-heading=\"\">Matching Paths     </h2> <p>Middleware will be invoked for <strong>every route in your project</strong>. Given this, it's crucial to use matchers to precisely target or exclude specific routes. The following is the execution order:</p> <ol> <li>\n<code>headers</code> from <code>next.config.js</code>\n</li> <li>\n<code>redirects</code> from <code>next.config.js</code>\n</li> <li>Middleware (<code>rewrites</code>, <code>redirects</code>, etc.)</li> <li>\n<code>beforeFiles</code> (<code>rewrites</code>) from <code>next.config.js</code>\n</li> <li>Filesystem routes (<code>public/</code>, <code>_next/static/</code>, <code>pages/</code>, <code>app/</code>, etc.)</li> <li>\n<code>afterFiles</code> (<code>rewrites</code>) from <code>next.config.js</code>\n</li> <li>Dynamic Routes (<code>/blog/[slug]</code>)</li> <li>\n<code>fallback</code> (<code>rewrites</code>) from <code>next.config.js</code>\n</li> </ol> <p>There are two ways to define which paths Middleware will run on:</p> <ol> <li><a href=\"#matcher\">Custom matcher config</a></li> <li><a href=\"#conditional-statements\">Conditional statements</a></li> </ol> <h3 id=\"matcher\" data-docs-heading=\"\">Matcher     </h3> <p><code>matcher</code> allows you to filter Middleware to run on specific paths.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: '/about/:path*',\n}</pre></div> <p>You can match a single path or multiple paths with an array syntax:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: ['/about/:path*', '/dashboard/:path*'],\n}</pre></div> <p>The <code>matcher</code> config allows full regex so matching like negative lookaheads or character matching is supported. An example of a negative lookahead to match all except specific paths can be seen here:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    '/((?!api|_next/static|_next/image|favicon.ico).*)',\n  ],\n}</pre></div> <p>You can also bypass Middleware for certain requests by using the <code>missing</code> or <code>has</code> arrays, or a combination of both:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n \n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      has: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n \n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      has: [{ type: 'header', key: 'x-present' }],\n      missing: [{ type: 'header', key: 'x-missing', value: 'prefetch' }],\n    },\n  ],\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The <code>matcher</code> values need to be constants so they can be statically analyzed at build-time. Dynamic values such as variables will be ignored.</p> </blockquote> <p>Configured matchers:</p> <ol> <li>MUST start with <code>/</code>\n</li> <li>Can include named parameters: <code>/about/:path</code> matches <code>/about/a</code> and <code>/about/b</code> but not <code>/about/a/c</code>\n</li> <li>Can have modifiers on named parameters (starting with <code>:</code>): <code>/about/:path*</code> matches <code>/about/a/b/c</code> because <code>*</code> is <em>zero or more</em>. <code>?</code> is <em>zero or one</em> and <code>+</code> <em>one or more</em>\n</li> <li>Can use regular expression enclosed in parenthesis: <code>/about/(.*)</code> is the same as <code>/about/:path*</code>\n</li> </ol> <p>Read more details on <a href=\"https://github.com/pillarjs/path-to-regexp#path-to-regexp-1\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">path-to-regexp</a> documentation.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: For backward compatibility, Next.js always considers <code>/public</code> as <code>/public/index</code>. Therefore, a matcher of <code>/public/:path</code> will match.</p> </blockquote> <h3 id=\"conditional-statements\" data-docs-heading=\"\">Conditional Statements     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  if (request.nextUrl.pathname.startsWith('/about')) {\n    return NextResponse.rewrite(new URL('/about-2', request.url))\n  }\n \n  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n    return NextResponse.rewrite(new URL('/dashboard/user', request.url))\n  }\n}</pre></div>  <h2 id=\"nextresponse\" data-docs-heading=\"\">NextResponse     </h2> <p>The <code>NextResponse</code> API allows you to:</p> <ul> <li>\n<code>redirect</code> the incoming request to a different URL</li> <li>\n<code>rewrite</code> the response by displaying a given URL</li> <li>Set request headers for API Routes, <code>getServerSideProps</code>, and <code>rewrite</code> destinations</li> <li>Set response cookies</li> <li>Set response headers</li> </ul>  <p>To produce a response from Middleware, you can:</p>\n<ol> <li>\n<code>rewrite</code> to a route (<a href=\"pages-and-layouts\">Page</a> or <a href=\"api-routes\">Edge API Route</a>) that produces a response</li> <li>return a <code>NextResponse</code> directly. See <a href=\"#producing-a-response\">Producing a Response</a>\n</li> </ol> <h2 id=\"using-cookies\" data-docs-heading=\"\">Using Cookies     </h2> <p>Cookies are regular headers. On a <code>Request</code>, they are stored in the <code>Cookie</code> header. On a <code>Response</code> they are in the <code>Set-Cookie</code> header. Next.js provides a convenient way to access and manipulate these cookies through the <code>cookies</code> extension on <code>NextRequest</code> and <code>NextResponse</code>.</p> <ol> <li>For incoming requests, <code>cookies</code> comes with the following methods: <code>get</code>, <code>getAll</code>, <code>set</code>, and <code>delete</code> cookies. You can check for the existence of a cookie with <code>has</code> or remove all cookies with <code>clear</code>.</li> <li>For outgoing responses, <code>cookies</code> have the following methods <code>get</code>, <code>getAll</code>, <code>set</code>, and <code>delete</code>.</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  // Assume a \"Cookie:nextjs=fast\" header to be present on the incoming request\n  // Getting cookies from the request using the `RequestCookies` API\n  let cookie = request.cookies.get('nextjs')\n  console.log(cookie) // =&gt; { name: 'nextjs', value: 'fast', Path: '/' }\n  const allCookies = request.cookies.getAll()\n  console.log(allCookies) // =&gt; [{ name: 'nextjs', value: 'fast' }]\n \n  request.cookies.has('nextjs') // =&gt; true\n  request.cookies.delete('nextjs')\n  request.cookies.has('nextjs') // =&gt; false\n \n  // Setting cookies on the response using the `ResponseCookies` API\n  const response = NextResponse.next()\n  response.cookies.set('vercel', 'fast')\n  response.cookies.set({\n    name: 'vercel',\n    value: 'fast',\n    path: '/',\n  })\n  cookie = response.cookies.get('vercel')\n  console.log(cookie) // =&gt; { name: 'vercel', value: 'fast', Path: '/' }\n  // The outgoing response will have a `Set-Cookie:vercel=fast;path=/` header.\n \n  return response\n}</pre></div>  <h2 id=\"setting-headers\" data-docs-heading=\"\">Setting Headers     </h2> <p>You can set request and response headers using the <code>NextResponse</code> API (setting <em>request</em> headers is available since Next.js v13.0.0).</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  // Clone the request headers and set a new header `x-hello-from-middleware1`\n  const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-hello-from-middleware1', 'hello')\n \n  // You can also set request headers in NextResponse.rewrite\n  const response = NextResponse.next({\n    request: {\n      // New request headers\n      headers: requestHeaders,\n    },\n  })\n \n  // Set a new response header `x-hello-from-middleware2`\n  response.headers.set('x-hello-from-middleware2', 'hello')\n  return response\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Avoid setting large headers as it might cause <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Status/431\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">431 Request Header Fields Too Large</a> error depending on your backend web server configuration.</p> </blockquote> <h3 id=\"cors\" data-docs-heading=\"\">CORS     </h3> <p>You can set CORS headers in Middleware to allow cross-origin requests, including <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">simple</a> and <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preflighted</a> requests.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse } from 'next/server'\n \nconst allowedOrigins = ['https://acme.com', 'https://my-app.org']\n \nconst corsOptions = {\n  'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n}\n \nexport function middleware(request: NextRequest) {\n  // Check the origin from the request\n  const origin = request.headers.get('origin') ?? ''\n  const isAllowedOrigin = allowedOrigins.includes(origin)\n \n  // Handle preflighted requests\n  const isPreflight = request.method === 'OPTIONS'\n \n  if (isPreflight) {\n    const preflightHeaders = {\n      ...(isAllowedOrigin &amp;&amp; { 'Access-Control-Allow-Origin': origin }),\n      ...corsOptions,\n    }\n    return NextResponse.json({}, { headers: preflightHeaders })\n  }\n \n  // Handle simple requests\n  const response = NextResponse.next()\n \n  if (isAllowedOrigin) {\n    response.headers.set('Access-Control-Allow-Origin', origin)\n  }\n \n  Object.entries(corsOptions).forEach(([key, value]) =&gt; {\n    response.headers.set(key, value)\n  })\n \n  return response\n}\n \nexport const config = {\n  matcher: '/api/:path*',\n}</pre></div>   <h2 id=\"producing-a-response\" data-docs-heading=\"\">Producing a Response     </h2> <p>You can respond from Middleware directly by returning a <code>Response</code> or <code>NextResponse</code> instance. (This is available since <a href=\"https://nextjs.org/blog/next-13-1#nextjs-advanced-middleware\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js v13.1.0</a>)</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest } from 'next/server'\nimport { isAuthenticated } from '@lib/auth'\n \n// Limit the middleware to paths starting with `/api/`\nexport const config = {\n  matcher: '/api/:function*',\n}\n \nexport function middleware(request: NextRequest) {\n  // Call our authentication function to check the request\n  if (!isAuthenticated(request)) {\n    // Respond with JSON indicating an error message\n    return Response.json(\n      { success: false, message: 'authentication failed' },\n      { status: 401 }\n    )\n  }\n}</pre></div>  <h3 id=\"waituntil-and-nextfetchevent\" data-docs-heading=\"\">waitUntil and NextFetchEvent     </h3> <p>The <code>NextFetchEvent</code> object extends the native <a href=\"https://developer.mozilla.org/docs/Web/API/FetchEvent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>FetchEvent</code></a> object, and includes the <a href=\"https://developer.mozilla.org/docs/Web/API/ExtendableEvent/waitUntil\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>waitUntil()</code></a> method.</p> <p>The <code>waitUntil()</code> method takes a promise as an argument, and extends the lifetime of the Middleware until the promise settles. This is useful for performing work in the background.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextFetchEvent, NextRequest } from 'next/server'\n \nexport function middleware(req: NextRequest, event: NextFetchEvent) {\n  event.waitUntil(\n    fetch('https://my-analytics-platform.com', {\n      method: 'POST',\n      body: JSON.stringify({ pathname: req.nextUrl.pathname }),\n    })\n  )\n \n  return NextResponse.next()\n}</pre></div> <h2 id=\"advanced-middleware-flags\" data-docs-heading=\"\">Advanced Middleware Flags     </h2> <p>In <code>v13.1</code> of Next.js two additional flags were introduced for middleware, <code>skipMiddlewareUrlNormalize</code> and <code>skipTrailingSlashRedirect</code> to handle advanced use cases.</p> <p><code>skipTrailingSlashRedirect</code> disables Next.js redirects for adding or removing trailing slashes. This allows custom handling inside middleware to maintain the trailing slash for some paths but not others, which can make incremental migrations easier.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  skipTrailingSlashRedirect: true,\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const legacyPrefixes = ['/docs', '/blog']\n \nexport default async function middleware(req) {\n  const { pathname } = req.nextUrl\n \n  if (legacyPrefixes.some((prefix) =&gt; pathname.startsWith(prefix))) {\n    return NextResponse.next()\n  }\n \n  // apply trailing slash handling\n  if (\n    !pathname.endsWith('/') &amp;&amp;\n    !pathname.match(/((?!\\.well-known(?:\\/.*)?)(?:[^/]+\\/)*[^/]+\\.\\w+)/)\n  ) {\n    req.nextUrl.pathname += '/'\n    return NextResponse.redirect(req.nextUrl)\n  }\n}</pre></div> <p><code>skipMiddlewareUrlNormalize</code> allows for disabling the URL normalization in Next.js to make handling direct visits and client-transitions the same. In some advanced cases, this option provides full control by using the original URL.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  skipMiddlewareUrlNormalize: true,\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function middleware(req) {\n  const { pathname } = req.nextUrl\n \n  // GET /_next/data/build-id/hello.json\n \n  console.log(pathname)\n  // with the flag this now /_next/data/build-id/hello.json\n  // without the flag this would be normalized to /hello\n}</pre></div> <h2 id=\"runtime\" data-docs-heading=\"\">Runtime     </h2> <p>Middleware currently only supports the <a href=\"../../../app/building-your-application/rendering/edge-and-nodejs-runtimes\">Edge runtime</a>. The Node.js runtime can not be used.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.1.0</code></td>\n<td>Advanced Middleware flags added</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>Middleware can modify request headers, response headers, and send responses</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>Middleware is stable, please see the <a href=\"../../../messages/middleware-upgrade-guide\">upgrade guide</a>\n</td>\n</tr>\n<tr>\n<td><code>v12.0.9</code></td>\n<td>Enforce absolute URLs in Edge Runtime (<a href=\"https://github.com/vercel/next.js/pull/33410\" rel=\"noopener noreferrer\" target=\"_blank\">PR</a>)</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>Middleware (Beta) added</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/middleware\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/middleware</a>\n  </p>\n</div>\n","pages/building-your-application/rendering":"<h1 class=\"break-words\">Rendering</h1>\n<p>By default, Next.js <strong>pre-renders</strong> every page. This means that Next.js generates HTML for each page in advance, instead of having it all done by client-side JavaScript. Pre-rendering can result in better performance and SEO.</p> <p>Each generated HTML is associated with minimal JavaScript code necessary for that page. When a page is loaded by the browser, its JavaScript code runs and makes the page fully interactive (this process is called <a href=\"https://react.dev/reference/react-dom/client/hydrateRoot\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">hydration</a> in React).</p> <h3 id=\"pre-rendering\" data-docs-heading=\"\">Pre-rendering     </h3> <p>Next.js has two forms of pre-rendering: <strong>Static Generation</strong> and <strong>Server-side Rendering</strong>. The difference is in <strong>when</strong> it generates the HTML for a page.</p> <ul> <li>Static Generation: The HTML is generated at <strong>build time</strong> and will be reused on each request.</li> <li>Server-side Rendering: The HTML is generated on <strong>each request</strong>.</li> </ul> <p>Importantly, Next.js lets you choose which pre-rendering form you'd like to use for each page. You can create a \"hybrid\" Next.js app by using Static Generation for most pages and using Server-side Rendering for others.</p> <p>We recommend using Static Generation over Server-side Rendering for performance reasons. Statically generated pages can be cached by CDN with no extra configuration to boost performance. However, in some cases, Server-side Rendering might be the only option.</p> <p>You can also use client-side data fetching along with Static Generation or Server-side Rendering. That means some parts of a page can be rendered entirely by clientside JavaScript. To learn more, take a look at the <a href=\"data-fetching/client-side\">Data Fetching</a> documentation.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/rendering\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/rendering</a>\n  </p>\n</div>\n","pages/building-your-application/rendering/server-side-rendering":"<h1 class=\"break-words\">Server-side Rendering (SSR)</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Also referred to as \"SSR\" or \"Dynamic Rendering\".</p> </blockquote> <p>If a page uses <strong>Server-side Rendering</strong>, the page HTML is generated on <strong>each request</strong>.</p> <p>To use Server-side Rendering for a page, you need to <code>export</code> an <code>async</code> function called <code>getServerSideProps</code>. This function will be called by the server on every request.</p> <p>For example, suppose that your page needs to pre-render frequently updated data (fetched from an external API). You can write <code>getServerSideProps</code> which fetches this data and passes it to <code>Page</code> like below:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page({ data }) {\n  // Render data...\n}\n \n// This gets called on every request\nexport async function getServerSideProps() {\n  // Fetch data from external API\n  const res = await fetch(`https://.../data`)\n  const data = await res.json()\n \n  // Pass data to the page via props\n  return { props: { data } }\n}</pre>\n</div> <p>As you can see, <code>getServerSideProps</code> is similar to <code>getStaticProps</code>, but the difference is that <code>getServerSideProps</code> is run on every request instead of on build time.</p> <p>To learn more about how <code>getServerSideProps</code> works, check out our <a href=\"../data-fetching/get-server-side-props\">Data Fetching documentation</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/rendering/server-side-rendering\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/rendering/server-side-rendering</a>\n  </p>\n</div>\n","pages/building-your-application/rendering/automatic-static-optimization":"<h1 class=\"break-words\">Automatic Static Optimization</h1>\n<p>Next.js automatically determines that a page is static (can be prerendered) if it has no blocking data requirements. This determination is made by the absence of <code>getServerSideProps</code> and <code>getInitialProps</code> in the page.</p> <p>This feature allows Next.js to emit hybrid applications that contain <strong>both server-rendered and statically generated pages</strong>.</p> <blockquote class=\"p-3 text-sm\"> <p>Statically generated pages are still reactive: Next.js will hydrate your application client-side to give it full interactivity.</p> </blockquote> <p>One of the main benefits of this feature is that optimized pages require no server-side computation, and can be instantly streamed to the end-user from multiple CDN locations. The result is an <em>ultra fast</em> loading experience for your users.</p> <h2 id=\"how-it-works\" data-docs-heading=\"\">How it works     </h2> <p>If <code>getServerSideProps</code> or <code>getInitialProps</code> is present in a page, Next.js will switch to render the page on-demand, per-request (meaning <a href=\"server-side-rendering\">Server-Side Rendering</a>).</p> <p>If the above is not the case, Next.js will <strong>statically optimize</strong> your page automatically by prerendering the page to static HTML.</p> <p>During prerendering, the router's <code>query</code> object will be empty since we do not have <code>query</code> information to provide during this phase. After hydration, Next.js will trigger an update to your application to provide the route parameters in the <code>query</code> object.</p> <p>The cases where the query will be updated after hydration triggering another render are:</p> <ul> <li>The page is a <a href=\"../routing/dynamic-routes\">dynamic-route</a>.</li> <li>The page has query values in the URL.</li> <li>\n<a href=\"../../api-reference/next-config-js/rewrites\">Rewrites</a> are configured in your <code>next.config.js</code> since these can have parameters that may need to be parsed and provided in the <code>query</code>.</li> </ul> <p>To be able to distinguish if the query is fully updated and ready for use, you can leverage the <code>isReady</code> field on <a href=\"../../api-reference/functions/use-router#router-object\"><code>next/router</code></a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Parameters added with <a href=\"../routing/dynamic-routes\">dynamic routes</a> to a page that's using <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a> will always be available inside the <code>query</code> object.</p> </blockquote> <p><code>next build</code> will emit <code>.html</code> files for statically optimized pages. For example, the result for the page <code>pages/about.js</code> would be:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.next/server/pages/about.html</pre></div> <p>And if you add <code>getServerSideProps</code> to the page, it will then be JavaScript, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.next/server/pages/about.js</pre></div> <h2 id=\"caveats\" data-docs-heading=\"\">Caveats     </h2> <ul> <li>If you have a <a href=\"../routing/custom-app\">custom <code>App</code></a> with <code>getInitialProps</code> then this optimization will be turned off in pages without <a href=\"../data-fetching/get-static-props\">Static Generation</a>.</li> <li>If you have a <a href=\"../routing/custom-document\">custom <code>Document</code></a> with <code>getInitialProps</code> be sure you check if <code>ctx.req</code> is defined before assuming the page is server-side rendered. <code>ctx.req</code> will be <code>undefined</code> for pages that are prerendered.</li> <li>Avoid using the <code>asPath</code> value on <a href=\"../../api-reference/functions/use-router#router-object\"><code>next/router</code></a> in the rendering tree until the router's <code>isReady</code> field is <code>true</code>. Statically optimized pages only know <code>asPath</code> on the client and not the server, so using it as a prop may lead to mismatch errors. The <a href=\"https://github.com/vercel/next.js/tree/canary/examples/active-class-name\" rel=\"noopener noreferrer\" target=\"_blank\"><code>active-class-name</code> example</a> demonstrates one way to use <code>asPath</code> as a prop.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/rendering/automatic-static-optimization\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/rendering/automatic-static-optimization</a>\n  </p>\n</div>\n","pages/building-your-application/rendering/client-side-rendering":"<h1 class=\"break-words\">Client-side Rendering (CSR)</h1>\n<p>In Client-Side Rendering (CSR) with React, the browser downloads a minimal HTML page and the JavaScript needed for the page. The JavaScript is then used to update the DOM and render the page. When the application is first loaded, the user may notice a slight delay before they can see the full page, this is because the page isn't fully rendered until all the JavaScript is downloaded, parsed, and executed.</p> <p>After the page has been loaded for the first time, navigating to other pages on the same website is typically faster, as only necessary data needs to be fetched, and JavaScript can re-render parts of the page without requiring a full page refresh.</p> <p>In Next.js, there are two ways you can implement client-side rendering:</p> <ol> <li>Using React's <code>useEffect()</code> hook inside your pages instead of the server-side rendering methods (<a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a> and <a href=\"../data-fetching/get-server-side-props\"><code>getServerSideProps</code></a>).</li> <li>Using a data fetching library like <a href=\"https://swr.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SWR</a> or <a href=\"https://tanstack.com/query/latest/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">TanStack Query</a> to fetch data on the client (recommended).</li> </ol> <p>Here's an example of using <code>useEffect()</code> inside a Next.js page:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React, { useState, useEffect } from 'react'\n \nexport function Page() {\n  const [data, setData] = useState(null)\n \n  useEffect(() =&gt; {\n    const fetchData = async () =&gt; {\n      const response = await fetch('https://api.example.com/data')\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n      const result = await response.json()\n      setData(result)\n    }\n \n    fetchData().catch((e) =&gt; {\n      // handle the error as needed\n      console.error('An error occurred while fetching the data: ', e)\n    })\n  }, [])\n \n  return &lt;p&gt;{data ? `Your data: ${data}` : 'Loading...'}&lt;/p&gt;\n}</pre></div> <p>In the example above, the component starts by rendering <code>Loading...</code>. Then, once the data is fetched, it re-renders and displays the data.</p> <p>Although fetching data in a <code>useEffect</code> is a pattern you may see in older React Applications, we recommend using a data-fetching library for better performance, caching, optimistic updates, and more. Here's a minimum example using <a href=\"https://swr.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SWR</a> to fetch data on the client:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import useSWR from 'swr'\n \nexport function Page() {\n  const { data, error, isLoading } = useSWR(\n    'https://api.example.com/data',\n    fetcher\n  )\n \n  if (error) return &lt;p&gt;Failed to load.&lt;/p&gt;\n  if (isLoading) return &lt;p&gt;Loading...&lt;/p&gt;\n \n  return &lt;p&gt;Your Data: {data}&lt;/p&gt;\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <p>Keep in mind that CSR can impact SEO. Some search engine crawlers might not execute JavaScript and therefore only see the initial empty or loading state of your application. It can also lead to performance issues for users with slower internet connections or devices, as they need to wait for all the JavaScript to load and run before they can see the full page. Next.js promotes a hybrid approach that allows you to use a combination of <a href=\"server-side-rendering\">server-side rendering</a>, <a href=\"static-site-generation\">static site generation</a>, and client-side rendering, <strong>depending on the needs of each page</strong> in your application. In the App Router, you can also use <a href=\"../../../app/building-your-application/routing/loading-ui-and-streaming\">Loading UI with Suspense</a> to show a loading indicator while the page is being rendered.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/rendering/client-side-rendering\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/rendering/client-side-rendering</a>\n  </p>\n</div>\n","pages/building-your-application/data-fetching":"<h1 class=\"break-words\">Data Fetching</h1>\n<p>Data fetching in Next.js allows you to render your content in different ways, depending on your application's use case. These include pre-rendering with <strong>Server-side Rendering</strong> or <strong>Static Generation</strong>, and updating or creating content at runtime with <strong>Incremental Static Regeneration</strong>.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <ul> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-wordpress\" rel=\"noopener noreferrer\" target=\"_blank\">WordPress Example</a>(<a href=\"https://next-blog-wordpress.vercel.app\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/blog-starter\" rel=\"noopener noreferrer\" target=\"_blank\">Blog Starter using markdown files</a> (<a href=\"https://next-blog-starter.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-datocms\" rel=\"noopener noreferrer\" target=\"_blank\">DatoCMS Example</a> (<a href=\"https://next-blog-datocms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-takeshape\" rel=\"noopener noreferrer\" target=\"_blank\">TakeShape Example</a> (<a href=\"https://next-blog-takeshape.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-sanity\" rel=\"noopener noreferrer\" target=\"_blank\">Sanity Example</a> (<a href=\"https://next-blog-sanity.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-prismic\" rel=\"noopener noreferrer\" target=\"_blank\">Prismic Example</a> (<a href=\"https://next-blog-prismic.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-contentful\" rel=\"noopener noreferrer\" target=\"_blank\">Contentful Example</a> (<a href=\"https://next-blog-contentful.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-strapi\" rel=\"noopener noreferrer\" target=\"_blank\">Strapi Example</a> (<a href=\"https://next-blog-strapi.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-prepr\" rel=\"noopener noreferrer\" target=\"_blank\">Prepr Example</a> (<a href=\"https://next-blog-prepr.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-agilitycms\" rel=\"noopener noreferrer\" target=\"_blank\">Agility CMS Example</a> (<a href=\"https://next-blog-agilitycms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-cosmic\" rel=\"noopener noreferrer\" target=\"_blank\">Cosmic Example</a> (<a href=\"https://next-blog-cosmic.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-buttercms\" rel=\"noopener noreferrer\" target=\"_blank\">ButterCMS Example</a> (<a href=\"https://next-blog-buttercms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-storyblok\" rel=\"noopener noreferrer\" target=\"_blank\">Storyblok Example</a> (<a href=\"https://next-blog-storyblok.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-graphcms\" rel=\"noopener noreferrer\" target=\"_blank\">GraphCMS Example</a> (<a href=\"https://next-blog-graphcms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-kontent-ai\" rel=\"noopener noreferrer\" target=\"_blank\">Kontent Example</a> (<a href=\"https://next-blog-kontent.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li><a href=\"https://static-tweet.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Static Tweet Demo</a></li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-enterspeed\" rel=\"noopener noreferrer\" target=\"_blank\">Enterspeed Example</a> (<a href=\"https://next-blog-demo.enterspeed.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/data-fetching\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/data-fetching</a>\n  </p>\n</div>\n","pages/building-your-application/data-fetching/get-static-props":"<h1 class=\"break-words\">getStaticProps</h1>\n<p>If you export a function called <code>getStaticProps</code> (Static Site Generation) from a page, Next.js will pre-render this page at build time using the props returned by <code>getStaticProps</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { InferGetStaticPropsType, GetStaticProps } from 'next'\n \ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n \nexport const getStaticProps = (async (context) =&gt; {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}) satisfies GetStaticProps&lt;{\n  repo: Repo\n}&gt;\n \nexport default function Page({\n  repo,\n}: InferGetStaticPropsType&lt;typeof getStaticProps&gt;) {\n  return repo.stargazers_count\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p>Note that irrespective of rendering type, any <code>props</code> will be passed to the page component and can be viewed on the client-side in the initial HTML. This is to allow the page to be <a href=\"https://react.dev/reference/react-dom/hydrate\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">hydrated</a> correctly. Make sure that you don't pass any sensitive information that shouldn't be available on the client in <code>props</code>.</p> </blockquote> <p>The <a href=\"../../api-reference/functions/get-static-props\"><code>getStaticProps</code> API reference</a> covers all parameters and props that can be used with <code>getStaticProps</code>.</p> <h2 id=\"when-should-i-use-getstaticprops\" data-docs-heading=\"\">When should I use getStaticProps?     </h2> <p>You should use <code>getStaticProps</code> if:</p> <ul> <li>The data required to render the page is available at build time ahead of a users request</li> <li>The data comes from a headless CMS</li> <li>The page must be pre-rendered (for SEO) and be very fast  <code>getStaticProps</code> generates <code>HTML</code> and <code>JSON</code> files, both of which can be cached by a CDN for performance</li> <li>The data can be publicly cached (not user-specific). This condition can be bypassed in certain specific situation by using a Middleware to rewrite the path.</li> </ul> <h2 id=\"when-does-getstaticprops-run\" data-docs-heading=\"\">When does getStaticProps run     </h2> <p><code>getStaticProps</code> always runs on the server and never on the client. You can validate code written inside <code>getStaticProps</code> is removed from the client-side bundle <a href=\"https://next-code-elimination.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">with this tool</a>.</p> <ul> <li>\n<code>getStaticProps</code> always runs during <code>next build</code>\n</li> <li>\n<code>getStaticProps</code> runs in the background when using <a href=\"../../api-reference/functions/get-static-paths#fallback-true\"><code>fallback: true</code></a>\n</li> <li>\n<code>getStaticProps</code> is called before initial render when using <a href=\"../../api-reference/functions/get-static-paths#fallback-blocking\"><code>fallback: blocking</code></a>\n</li> <li>\n<code>getStaticProps</code> runs in the background when using <code>revalidate</code>\n</li> <li>\n<code>getStaticProps</code> runs on-demand in the background when using <a href=\"incremental-static-regeneration#on-demand-revalidation\"><code>revalidate()</code></a>\n</li> </ul> <p>When combined with <a href=\"incremental-static-regeneration\">Incremental Static Regeneration</a>, <code>getStaticProps</code> will run in the background while the stale page is being revalidated, and the fresh page served to the browser.</p> <p><code>getStaticProps</code> does not have access to the incoming request (such as query parameters or HTTP headers) as it generates static HTML. If you need access to the request for your page, consider using <a href=\"../routing/middleware\">Middleware</a> in addition to <code>getStaticProps</code>.</p> <h2 id=\"using-getstaticprops-to-fetch-data-from-a-cms\" data-docs-heading=\"\">Using getStaticProps to fetch data from a CMS     </h2> <p>The following example shows how you can fetch a list of blog posts from a CMS.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// posts will be populated at build time by getStaticProps()\nexport default function Blog({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li&gt;{post.title}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}\n \n// This function gets called at build time on server-side.\n// It won't be called on client-side, so you can even do\n// direct database queries.\nexport async function getStaticProps() {\n  // Call an external API endpoint to get posts.\n  // You can use any data fetching library\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  // By returning { props: { posts } }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts,\n    },\n  }\n}</pre></div>  <p>The <a href=\"../../api-reference/functions/get-static-props\"><code>getStaticProps</code> API reference</a> covers all parameters and props that can be used with <code>getStaticProps</code>.</p> <h2 id=\"write-server-side-code-directly\" data-docs-heading=\"\">Write server-side code directly     </h2> <p>As <code>getStaticProps</code> runs only on the server-side, it will never run on the client-side. It wont even be included in the JS bundle for the browser, so you can write direct database queries without them being sent to browsers.</p> <p>This means that instead of fetching an <strong>API route</strong> from <code>getStaticProps</code> (that itself fetches data from an external source), you can write the server-side code directly in <code>getStaticProps</code>.</p> <p>Take the following example. An API route is used to fetch some data from a CMS. That API route is then called directly from <code>getStaticProps</code>. This produces an additional call, reducing performance. Instead, the logic for fetching the data from the CMS can be shared by using a <code>lib/</code> directory. Then it can be shared with <code>getStaticProps</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// The following function is shared\n// with getStaticProps and API routes\n// from a `lib/` directory\nexport async function loadPosts() {\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts/')\n  const data = await res.json()\n \n  return data\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// pages/blog.js\nimport { loadPosts } from '../lib/load-posts'\n \n// This function runs only on the server side\nexport async function getStaticProps() {\n  // Instead of fetching your `/api` route you can call the same\n  // function directly in `getStaticProps`\n  const posts = await loadPosts()\n \n  // Props returned will be passed to the page component\n  return { props: { posts } }\n}</pre></div> <p>Alternatively, if you are <strong>not</strong> using API routes to fetch data, then the <a href=\"https://developer.mozilla.org/docs/Web/API/Fetch_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>fetch()</code></a> API <em>can</em> be used directly in <code>getStaticProps</code> to fetch data.</p> <p>To verify what Next.js eliminates from the client-side bundle, you can use the <a href=\"https://next-code-elimination.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">next-code-elimination tool</a>.</p> <h2 id=\"statically-generates-both-html-and-json\" data-docs-heading=\"\">Statically generates both HTML and JSON     </h2> <p>When a page with <code>getStaticProps</code> is pre-rendered at build time, in addition to the page HTML file, Next.js generates a JSON file holding the result of running <code>getStaticProps</code>.</p> <p>This JSON file will be used in client-side routing through <a href=\"../../api-reference/components/link\"><code>next/link</code></a> or <a href=\"../../api-reference/functions/use-router\"><code>next/router</code></a>. When you navigate to a page thats pre-rendered using <code>getStaticProps</code>, Next.js fetches this JSON file (pre-computed at build time) and uses it as the props for the page component. This means that client-side page transitions will <strong>not</strong> call <code>getStaticProps</code> as only the exported JSON is used.</p> <p>When using Incremental Static Generation, <code>getStaticProps</code> will be executed in the background to generate the JSON needed for client-side navigation. You may see this in the form of multiple requests being made for the same page, however, this is intended and has no impact on end-user performance.</p> <h2 id=\"where-can-i-use-getstaticprops\" data-docs-heading=\"\">Where can I use getStaticProps     </h2> <p><code>getStaticProps</code> can only be exported from a <strong>page</strong>. You <strong>cannot</strong> export it from non-page files, <code>_app</code>, <code>_document</code>, or <code>_error</code>.</p> <p>One of the reasons for this restriction is that React needs to have all the required data before the page is rendered.</p> <p>Also, you must use export <code>getStaticProps</code> as a standalone function  it will <strong>not</strong> work if you add <code>getStaticProps</code> as a property of the page component.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: if you have created a <a href=\"../routing/custom-app\">custom app</a>, ensure you are passing the <code>pageProps</code> to the page component as shown in the linked document, otherwise the props will be empty.</p> </blockquote> <h2 id=\"runs-on-every-request-in-development\" data-docs-heading=\"\">Runs on every request in development     </h2> <p>In development (<code>next dev</code>), <code>getStaticProps</code> will be called on every request.</p> <h2 id=\"preview-mode\" data-docs-heading=\"\">Preview Mode     </h2> <p>You can temporarily bypass static generation and render the page at <strong>request time</strong> instead of build time using <a href=\"../configuring/preview-mode\"><strong>Preview Mode</strong></a>. For example, you might be using a headless CMS and want to preview drafts before they're published.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/data-fetching/get-static-props\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/data-fetching/get-static-props</a>\n  </p>\n</div>\n","pages/building-your-application/routing/linking-and-navigating":"<h1 class=\"break-words\">Linking and Navigating</h1>\n<p>The Next.js router allows you to do client-side route transitions between pages, similar to a single-page application.</p> <p>A React component called <code>Link</code> is provided to do this client-side route transition.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Home() {\n  return (\n    &lt;ul&gt;\n      &lt;li&gt;\n        &lt;Link href=\"/\"&gt;Home&lt;/Link&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;Link href=\"/about\"&gt;About Us&lt;/Link&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;Link href=\"/blog/hello-world\"&gt;Blog Post&lt;/Link&gt;\n      &lt;/li&gt;\n    &lt;/ul&gt;\n  )\n}\n \nexport default Home</pre>\n</div> <p>The example above uses multiple links. Each one maps a path (<code>href</code>) to a known page:</p> <ul> <li>\n<code>/</code>  <code>pages/index.js</code>\n</li> <li>\n<code>/about</code>  <code>pages/about.js</code>\n</li> <li>\n<code>/blog/hello-world</code>  <code>pages/blog/[slug].js</code>\n</li> </ul> <p>Any <code>&lt;Link /&gt;</code> in the viewport (initially or through scroll) will be prefetched by default (including the corresponding data) for pages using <a href=\"../data-fetching/get-static-props\">Static Generation</a>. The corresponding data for <a href=\"../data-fetching/get-server-side-props\">server-rendered</a> routes is fetched <em>only when</em> the <code>&lt;Link /&gt;</code> is clicked.</p> <h2 id=\"linking-to-dynamic-paths\" data-docs-heading=\"\">Linking to dynamic paths     </h2> <p>You can also use interpolation to create the path, which comes in handy for <a href=\"dynamic-routes\">dynamic route segments</a>. For example, to show a list of posts which have been passed to the component as a prop:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Posts({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li key={post.id}&gt;\n          &lt;Link href={`/blog/${encodeURIComponent(post.slug)}`}&gt;\n            {post.title}\n          &lt;/Link&gt;\n        &lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}\n \nexport default Posts</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>encodeURIComponent</code></a> is used in the example to keep the path utf-8 compatible.</p> </blockquote> <p>Alternatively, using a URL Object:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Posts({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li key={post.id}&gt;\n          &lt;Link\n            href={{\n              pathname: '/blog/[slug]',\n              query: { slug: post.slug },\n            }}\n          &gt;\n            {post.title}\n          &lt;/Link&gt;\n        &lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}\n \nexport default Posts</pre>\n</div> <p>Now, instead of using interpolation to create the path, we use a URL object in <code>href</code> where:</p> <ul> <li>\n<code>pathname</code> is the name of the page in the <code>pages</code> directory. <code>/blog/[slug]</code> in this case.</li> <li>\n<code>query</code> is an object with the dynamic segment. <code>slug</code> in this case.</li> </ul> <h2 id=\"injecting-the-router\" data-docs-heading=\"\">Injecting the router     </h2> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/dynamic-routing\" rel=\"noopener noreferrer\" target=\"_blank\">Dynamic Routing</a></li> </ul></details> <p>To access the <a href=\"../../api-reference/functions/use-router#router-object\"><code>router</code> object</a> in a React component you can use <a href=\"../../api-reference/functions/use-router\"><code>useRouter</code></a> or <a href=\"../../api-reference/functions/use-router#withrouter\"><code>withRouter</code></a>.</p> <p>In general we recommend using <a href=\"../../api-reference/functions/use-router\"><code>useRouter</code></a>.</p> <h2 id=\"imperative-routing\" data-docs-heading=\"\">Imperative Routing     </h2> <p><a href=\"../../api-reference/components/link\"><code>next/link</code></a> should be able to cover most of your routing needs, but you can also do client-side navigations without it, take a look at the <a href=\"../../api-reference/functions/use-router\">documentation for <code>next/router</code></a>.</p> <p>The following example shows how to do basic page navigations with <a href=\"../../api-reference/functions/use-router\"><code>useRouter</code></a>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function ReadMore() {\n  const router = useRouter()\n \n  return (\n    &lt;button onClick={() =&gt; router.push('/about')}&gt;\n      Click here to read more\n    &lt;/button&gt;\n  )\n}</pre>\n</div> <h2 id=\"shallow-routing\" data-docs-heading=\"\">Shallow Routing     </h2> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-shallow-routing\" rel=\"noopener noreferrer\" target=\"_blank\">Shallow Routing</a></li> </ul></details> <p>Shallow routing allows you to change the URL without running data fetching methods again, that includes <a href=\"../data-fetching/get-server-side-props\"><code>getServerSideProps</code></a>, <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a>, and <a href=\"../../api-reference/functions/get-initial-props\"><code>getInitialProps</code></a>.</p> <p>You'll receive the updated <code>pathname</code> and the <code>query</code> via the <a href=\"../../api-reference/functions/use-router#router-object\"><code>router</code> object</a> (added by <a href=\"../../api-reference/functions/use-router\"><code>useRouter</code></a> or <a href=\"../../api-reference/functions/use-router#withrouter\"><code>withRouter</code></a>), without losing state.</p> <p>To enable shallow routing, set the <code>shallow</code> option to <code>true</code>. Consider the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n \n// Current URL is '/'\nfunction Page() {\n  const router = useRouter()\n \n  useEffect(() =&gt; {\n    // Always do navigations after the first render\n    router.push('/?counter=10', undefined, { shallow: true })\n  }, [])\n \n  useEffect(() =&gt; {\n    // The counter changed!\n  }, [router.query.counter])\n}\n \nexport default Page</pre>\n</div> <p>The URL will get updated to <code>/?counter=10</code> and the page won't get replaced, only the state of the route is changed.</p> <p>You can also watch for URL changes via <a href=\"https://react.dev/reference/react/Component#componentdidupdate\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>componentDidUpdate</code></a> as shown below:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">componentDidUpdate(prevProps) {\n  const { pathname, query } = this.props.router\n  // verify props have changed to avoid an infinite loop\n  if (query.counter !== prevProps.router.query.counter) {\n    // fetch data based on the new query\n  }\n}</pre>\n</div> <h3 id=\"caveats\" data-docs-heading=\"\">Caveats     </h3> <p>Shallow routing <strong>only</strong> works for URL changes in the current page. For example, let's assume we have another page called <code>pages/about.js</code>, and you run this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">router.push('/?counter=10', '/about?counter=10', { shallow: true })</pre>\n</div> <p>Since that's a new page, it'll unload the current page, load the new one and wait for data fetching even though we asked to do shallow routing.</p> <p>When shallow routing is used with middleware it will not ensure the new page matches the current page like previously done without middleware. This is due to middleware being able to rewrite dynamically and can't be verified client-side without a data fetch which is skipped with shallow, so a shallow route change must always be treated as shallow.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/routing/linking-and-navigating\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/routing/linking-and-navigating</a>\n  </p>\n</div>\n","pages/building-your-application/rendering/static-site-generation":"<h1 class=\"break-words\">Static Site Generation (SSG)</h1>\n<details><summary>Examples</summary><ul> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-wordpress\" rel=\"noopener noreferrer\" target=\"_blank\">WordPress Example</a>(<a href=\"https://next-blog-wordpress.vercel.app\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/blog-starter\" rel=\"noopener noreferrer\" target=\"_blank\">Blog Starter using markdown files</a> (<a href=\"https://next-blog-starter.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-datocms\" rel=\"noopener noreferrer\" target=\"_blank\">DatoCMS Example</a> (<a href=\"https://next-blog-datocms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-takeshape\" rel=\"noopener noreferrer\" target=\"_blank\">TakeShape Example</a> (<a href=\"https://next-blog-takeshape.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-sanity\" rel=\"noopener noreferrer\" target=\"_blank\">Sanity Example</a> (<a href=\"https://next-blog-sanity.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-prismic\" rel=\"noopener noreferrer\" target=\"_blank\">Prismic Example</a> (<a href=\"https://next-blog-prismic.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-contentful\" rel=\"noopener noreferrer\" target=\"_blank\">Contentful Example</a> (<a href=\"https://next-blog-contentful.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-strapi\" rel=\"noopener noreferrer\" target=\"_blank\">Strapi Example</a> (<a href=\"https://next-blog-strapi.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-prepr\" rel=\"noopener noreferrer\" target=\"_blank\">Prepr Example</a> (<a href=\"https://next-blog-prepr.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-agilitycms\" rel=\"noopener noreferrer\" target=\"_blank\">Agility CMS Example</a> (<a href=\"https://next-blog-agilitycms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-cosmic\" rel=\"noopener noreferrer\" target=\"_blank\">Cosmic Example</a> (<a href=\"https://next-blog-cosmic.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-buttercms\" rel=\"noopener noreferrer\" target=\"_blank\">ButterCMS Example</a> (<a href=\"https://next-blog-buttercms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-storyblok\" rel=\"noopener noreferrer\" target=\"_blank\">Storyblok Example</a> (<a href=\"https://next-blog-storyblok.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-graphcms\" rel=\"noopener noreferrer\" target=\"_blank\">GraphCMS Example</a> (<a href=\"https://next-blog-graphcms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-kontent-ai\" rel=\"noopener noreferrer\" target=\"_blank\">Kontent Example</a> (<a href=\"https://next-blog-kontent.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-builder-io\" rel=\"noopener noreferrer\" target=\"_blank\">Builder.io Example</a> (<a href=\"https://cms-builder-io.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-tina\" rel=\"noopener noreferrer\" target=\"_blank\">TinaCMS Example</a> (<a href=\"https://cms-tina-example.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li><a href=\"https://static-tweet.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Static Tweet (Demo)</a></li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-enterspeed\" rel=\"noopener noreferrer\" target=\"_blank\">Enterspeed Example</a> (<a href=\"https://next-blog-demo.enterspeed.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> </ul></details> <p>If a page uses <strong>Static Generation</strong>, the page HTML is generated at <strong>build time</strong>. That means in production, the page HTML is generated when you run <code>next build</code>. This HTML will then be reused on each request. It can be cached by a CDN.</p> <p>In Next.js, you can statically generate pages <strong>with or without data</strong>. Let's take a look at each case.</p> <h3 id=\"static-generation-without-data\" data-docs-heading=\"\">Static Generation without data     </h3> <p>By default, Next.js pre-renders pages using Static Generation without fetching data. Here's an example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function About() {\n  return &lt;div&gt;About&lt;/div&gt;\n}\n \nexport default About</pre>\n</div> <p>Note that this page does not need to fetch any external data to be pre-rendered. In cases like this, Next.js generates a single HTML file per page during build time.</p> <h3 id=\"static-generation-with-data\" data-docs-heading=\"\">Static Generation with data     </h3> <p>Some pages require fetching external data for pre-rendering. There are two scenarios, and one or both might apply. In each case, you can use these functions that Next.js provides:</p> <ol> <li>Your page <strong>content</strong> depends on external data: Use <code>getStaticProps</code>.</li> <li>Your page <strong>paths</strong> depend on external data: Use <code>getStaticPaths</code> (usually in addition to <code>getStaticProps</code>).</li> </ol> <h4 id=\"scenario-1-your-page-content-depends-on-external-data\" data-docs-heading=\"\">Scenario 1: Your page content depends on external data     </h4> <p><strong>Example</strong>: Your blog page might need to fetch the list of blog posts from a CMS (content management system).</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// TODO: Need to fetch `posts` (by calling some API endpoint)\n//       before this page can be pre-rendered.\nexport default function Blog({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li&gt;{post.title}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}</pre>\n</div> <p>To fetch this data on pre-render, Next.js allows you to <code>export</code> an <code>async</code> function called <code>getStaticProps</code> from the same file. This function gets called at build time and lets you pass fetched data to the page's <code>props</code> on pre-render.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Blog({ posts }) {\n  // Render posts...\n}\n \n// This function gets called at build time\nexport async function getStaticProps() {\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  // By returning { props: { posts } }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts,\n    },\n  }\n}</pre>\n</div> <p>To learn more about how <code>getStaticProps</code> works, check out the <a href=\"../data-fetching/get-static-props\">Data Fetching documentation</a>.</p> <h4 id=\"scenario-2-your-page-paths-depend-on-external-data\" data-docs-heading=\"\">Scenario 2: Your page paths depend on external data     </h4> <p>Next.js allows you to create pages with <strong>dynamic routes</strong>. For example, you can create a file called <code>pages/posts/[id].js</code> to show a single blog post based on <code>id</code>. This will allow you to show a blog post with <code>id: 1</code> when you access <code>posts/1</code>.</p> <blockquote class=\"p-3 text-sm\"> <p>To learn more about dynamic routing, check the <a href=\"../routing/dynamic-routes\">Dynamic Routing documentation</a>.</p> </blockquote> <p>However, which <code>id</code> you want to pre-render at build time might depend on external data.</p> <p><strong>Example</strong>: suppose that you've only added one blog post (with <code>id: 1</code>) to the database. In this case, you'd only want to pre-render <code>posts/1</code> at build time.</p> <p>Later, you might add the second post with <code>id: 2</code>. Then you'd want to pre-render <code>posts/2</code> as well.</p> <p>So your page <strong>paths</strong> that are pre-rendered depend on external data. To handle this, Next.js lets you <code>export</code> an <code>async</code> function called <code>getStaticPaths</code> from a dynamic page (<code>pages/posts/[id].js</code> in this case). This function gets called at build time and lets you specify which paths you want to pre-render.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// This function gets called at build time\nexport async function getStaticPaths() {\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  // Get the paths we want to pre-render based on posts\n  const paths = posts.map((post) =&gt; ({\n    params: { id: post.id },\n  }))\n \n  // We'll pre-render only these paths at build time.\n  // { fallback: false } means other routes should 404.\n  return { paths, fallback: false }\n}</pre>\n</div> <p>Also in <code>pages/posts/[id].js</code>, you need to export <code>getStaticProps</code> so that you can fetch the data about the post with this <code>id</code> and use it to pre-render the page:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Post({ post }) {\n  // Render post...\n}\n \nexport async function getStaticPaths() {\n  // ...\n}\n \n// This also gets called at build time\nexport async function getStaticProps({ params }) {\n  // params contains the post `id`.\n  // If the route is like /posts/1, then params.id is 1\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n \n  // Pass post data to the page via props\n  return { props: { post } }\n}</pre>\n</div> <p>To learn more about how <code>getStaticPaths</code> works, check out the <a href=\"../data-fetching/get-static-paths\">Data Fetching documentation</a>.</p> <h3 id=\"when-should-i-use-static-generation\" data-docs-heading=\"\">When should I use Static Generation?     </h3> <p>We recommend using <strong>Static Generation</strong> (with and without data) whenever possible because your page can be built once and served by CDN, which makes it much faster than having a server render the page on every request.</p> <p>You can use Static Generation for many types of pages, including:</p> <ul> <li>Marketing pages</li> <li>Blog posts and portfolios</li> <li>E-commerce product listings</li> <li>Help and documentation</li> </ul> <p>You should ask yourself: \"Can I pre-render this page <strong>ahead</strong> of a user's request?\" If the answer is yes, then you should choose Static Generation.</p> <p>On the other hand, Static Generation is <strong>not</strong> a good idea if you cannot pre-render a page ahead of a user's request. Maybe your page shows frequently updated data, and the page content changes on every request.</p> <p>In cases like this, you can do one of the following:</p> <ul> <li>Use Static Generation with <strong>Client-side data fetching:</strong> You can skip pre-rendering some parts of a page and then use client-side JavaScript to populate them. To learn more about this approach, check out the <a href=\"../data-fetching/client-side\">Data Fetching documentation</a>.</li> <li>Use <strong>Server-Side Rendering:</strong> Next.js pre-renders a page on each request. It will be slower because the page cannot be cached by a CDN, but the pre-rendered page will always be up-to-date. We'll talk about this approach below.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/rendering/static-site-generation\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/rendering/static-site-generation</a>\n  </p>\n</div>\n","pages/building-your-application/rendering/edge-and-nodejs-runtimes":"<h1 class=\"break-words\">Edge and Node.js Runtimes</h1> <p>In the context of Next.js, runtime refers to the set of libraries, APIs, and general functionality available to your code during execution.</p> <p>On the server, there are two runtimes where parts of your application code can be rendered:</p> <ul> <li>The <strong>Node.js Runtime</strong> (default) has access to all Node.js APIs and compatible packages from the ecosystem.</li> <li>The <strong>Edge Runtime</strong> is based on <a href=\"../../../app/api-reference/edge\">Web APIs</a>.</li> </ul> <h2 id=\"runtime-differences\" data-docs-heading=\"\">Runtime Differences     </h2> <p>There are many considerations to make when choosing a runtime. This table shows the major differences at a glance. If you want a more in-depth analysis of the differences, check out the sections below.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th>Node</th>\n<th>Serverless</th>\n<th>Edge</th>\n</tr></thead>\n<tbody>\n<tr>\n<td>Cold Boot</td>\n<td>/</td>\n<td>Normal</td>\n<td>Low</td>\n</tr>\n<tr>\n<td><a href=\"../../../app/building-your-application/routing/loading-ui-and-streaming\">HTTP Streaming</a></td>\n<td>Yes</td>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td>IO</td>\n<td>All</td>\n<td>All</td>\n<td><code>fetch</code></td>\n</tr>\n<tr>\n<td>Scalability</td>\n<td>/</td>\n<td>High</td>\n<td>Highest</td>\n</tr>\n<tr>\n<td>Security</td>\n<td>Normal</td>\n<td>High</td>\n<td>High</td>\n</tr>\n<tr>\n<td>Latency</td>\n<td>Normal</td>\n<td>Low</td>\n<td>Lowest</td>\n</tr>\n<tr>\n<td>npm Packages</td>\n<td>All</td>\n<td>All</td>\n<td>A smaller subset</td>\n</tr>\n<tr>\n<td><a href=\"../../../app/building-your-application/rendering/server-components#static-rendering-default\">Static Rendering</a></td>\n<td>Yes</td>\n<td>Yes</td>\n<td>No</td>\n</tr>\n<tr>\n<td><a href=\"../../../app/building-your-application/rendering/server-components#dynamic-rendering\">Dynamic Rendering</a></td>\n<td>Yes</td>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"../../../app/building-your-application/data-fetching/fetching-caching-and-revalidating#revalidating-data\">Data Revalidation w/ <code>fetch</code></a></td>\n<td>Yes</td>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"edge-runtime\" data-docs-heading=\"\">Edge Runtime     </h3> <p>In Next.js, the lightweight Edge Runtime is a subset of available Node.js APIs.</p> <p>The Edge Runtime is ideal if you need to deliver dynamic, personalized content at low latency with small, simple functions. The Edge Runtime's speed comes from its minimal use of resources, but that can be limiting in many scenarios.</p> <p>For example, code executed in the Edge Runtime <a href=\"https://vercel.com/docs/concepts/limits/overview#edge-middleware-and-edge-functions-size\" rel=\"noopener noreferrer\" target=\"_blank\">on Vercel cannot exceed between 1 MB and 4 MB</a>, this limit includes imported packages, fonts and files, and will vary depending on your deployment infrastructure. In addition, the Edge Runtime does not support all Node.js APIs meaning some <code>npm</code> packages may not work. For example, \"Module not found: Can't resolve 'fs'\" or similar errors. We recommend using the Node.js runtime if you need to use these APIs or packages.</p> <h3 id=\"nodejs-runtime\" data-docs-heading=\"\">Node.js Runtime     </h3> <p>Using the Node.js runtime gives you access to all Node.js APIs, and all npm packages that rely on them. However, it's not as fast to start up as routes using the Edge runtime.</p> <p>Deploying your Next.js application to a Node.js server will require managing, scaling, and configuring your infrastructure. Alternatively, you can consider deploying your Next.js application to a serverless platform like Vercel, which will handle this for you.</p> <h3 id=\"serverless-nodejs\" data-docs-heading=\"\">Serverless Node.js     </h3> <p>Serverless is ideal if you need a scalable solution that can handle more complex computational loads than the Edge Runtime. With Serverless Functions on Vercel, for example, your overall code size is <a href=\"https://vercel.com/docs/concepts/limits/overview#serverless-function-size\" rel=\"noopener noreferrer\" target=\"_blank\">50MB</a> including imported packages, fonts, and files.</p> <p>The downside compared to routes using the <a href=\"https://vercel.com/docs/concepts/functions/edge-functions\" rel=\"noopener noreferrer\" target=\"_blank\">Edge</a> is that it can take hundreds of milliseconds for Serverless Functions to boot up before they begin processing requests. Depending on the amount of traffic your site receives, this could be a frequent occurrence as the functions are not frequently \"warm\".</p>  <blockquote class=\"p-3 text-sm\"> <p>Please refer to the <a href=\"https://nodejs.org/docs/latest/api/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.js Docs</a> and <a href=\"../../../app/api-reference/edge\">Edge Docs</a> for the full list of available APIs. Both runtimes can also support <a href=\"../../../app/building-your-application/routing/loading-ui-and-streaming\">streaming</a> depending on your deployment infrastructure.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/rendering/edge-and-nodejs-runtimes\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/rendering/edge-and-nodejs-runtimes</a>\n  </p>\n</div>\n","pages/building-your-application/data-fetching/get-static-paths":"<h1 class=\"break-words\">getStaticPaths</h1>\n<p>If a page has <a href=\"../routing/dynamic-routes\">Dynamic Routes</a> and uses <code>getStaticProps</code>, it needs to define a list of paths to be statically generated.</p> <p>When you export a function called <code>getStaticPaths</code> (Static Site Generation) from a page that uses dynamic routes, Next.js will statically pre-render all the paths specified by <code>getStaticPaths</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type {\n  InferGetStaticPropsType,\n  GetStaticProps,\n  GetStaticPaths,\n} from 'next'\n \ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n \nexport const getStaticPaths = (async () =&gt; {\n  return {\n    paths: [\n      {\n        params: {\n          name: 'next.js',\n        },\n      }, // See the \"paths\" section below\n    ],\n    fallback: true, // false or \"blocking\"\n  }\n}) satisfies GetStaticPaths\n \nexport const getStaticProps = (async (context) =&gt; {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}) satisfies GetStaticProps&lt;{\n  repo: Repo\n}&gt;\n \nexport default function Page({\n  repo,\n}: InferGetStaticPropsType&lt;typeof getStaticProps&gt;) {\n  return repo.stargazers_count\n}</pre></div>  <p>The <a href=\"../../api-reference/functions/get-static-paths\"><code>getStaticPaths</code> API reference</a> covers all parameters and props that can be used with <code>getStaticPaths</code>.</p> <h2 id=\"when-should-i-use-getstaticpaths\" data-docs-heading=\"\">When should I use getStaticPaths?     </h2> <p>You should use <code>getStaticPaths</code> if youre statically pre-rendering pages that use dynamic routes and:</p> <ul> <li>The data comes from a headless CMS</li> <li>The data comes from a database</li> <li>The data comes from the filesystem</li> <li>The data can be publicly cached (not user-specific)</li> <li>The page must be pre-rendered (for SEO) and be very fast  <code>getStaticProps</code> generates <code>HTML</code> and <code>JSON</code> files, both of which can be cached by a CDN for performance</li> </ul> <h2 id=\"when-does-getstaticpaths-run\" data-docs-heading=\"\">When does getStaticPaths run     </h2> <p><code>getStaticPaths</code> will only run during build in production, it will not be called during runtime. You can validate code written inside <code>getStaticPaths</code> is removed from the client-side bundle <a href=\"https://next-code-elimination.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">with this tool</a>.</p> <h3 id=\"how-does-getstaticprops-run-with-regards-to-getstaticpaths\" data-docs-heading=\"\">How does getStaticProps run with regards to getStaticPaths     </h3> <ul> <li>\n<code>getStaticProps</code> runs during <code>next build</code> for any <code>paths</code> returned during build</li> <li>\n<code>getStaticProps</code> runs in the background when using <code>fallback: true</code>\n</li> <li>\n<code>getStaticProps</code> is called before initial render when using <code>fallback: blocking</code>\n</li> </ul> <h2 id=\"where-can-i-use-getstaticpaths\" data-docs-heading=\"\">Where can I use getStaticPaths     </h2> <ul> <li>\n<code>getStaticPaths</code> <strong>must</strong> be used with <code>getStaticProps</code>\n</li> <li>You <strong>cannot</strong> use <code>getStaticPaths</code> with <a href=\"get-server-side-props\"><code>getServerSideProps</code></a>\n</li> <li>You can export <code>getStaticPaths</code> from a <a href=\"../routing/dynamic-routes\">Dynamic Route</a> that also uses <code>getStaticProps</code>\n</li> <li>You <strong>cannot</strong> export <code>getStaticPaths</code> from non-page file (e.g. your <code>components</code> folder)</li> <li>You must export <code>getStaticPaths</code> as a standalone function, and not a property of the page component</li> </ul> <h2 id=\"runs-on-every-request-in-development\" data-docs-heading=\"\">Runs on every request in development     </h2> <p>In development (<code>next dev</code>), <code>getStaticPaths</code> will be called on every request.</p> <h2 id=\"generating-paths-on-demand\" data-docs-heading=\"\">Generating paths on-demand     </h2> <p><code>getStaticPaths</code> allows you to control which pages are generated during the build instead of on-demand with <a href=\"../../api-reference/functions/get-static-paths#fallback-blocking\"><code>fallback</code></a>. Generating more pages during a build will cause slower builds.</p> <p>You can defer generating all pages on-demand by returning an empty array for <code>paths</code>. This can be especially helpful when deploying your Next.js application to multiple environments. For example, you can have faster builds by generating all pages on-demand for previews (but not production builds). This is helpful for sites with hundreds/thousands of static pages.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticPaths() {\n  // When this is true (in preview environments) don't\n  // prerender any static pages\n  // (faster builds, but slower initial page load)\n  if (process.env.SKIP_BUILD_STATIC_GENERATION) {\n    return {\n      paths: [],\n      fallback: 'blocking',\n    }\n  }\n \n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  // Get the paths we want to prerender based on posts\n  // In production environments, prerender all pages\n  // (slower builds, but faster initial page load)\n  const paths = posts.map((post) =&gt; ({\n    params: { id: post.id },\n  }))\n \n  // { fallback: false } means other routes should 404\n  return { paths, fallback: false }\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/data-fetching/get-static-paths\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/data-fetching/get-static-paths</a>\n  </p>\n</div>\n","pages/building-your-application/data-fetching/get-server-side-props":"<h1 class=\"break-words\">getServerSideProps</h1>\n<p><code>getServerSideProps</code> is a Next.js function that can be used to fetch data and render the contents of a page at request time.</p> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2> <p>You can use <code>getServerSideProps</code> by exporting it from a Page Component. The example below shows how you can fetch data from a 3rd party API in <code>getServerSideProps</code>, and pass the data to the page as props:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { InferGetServerSidePropsType, GetServerSideProps } from 'next'\n \ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n \nexport const getServerSideProps = (async () =&gt; {\n  // Fetch data from external API\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo: Repo = await res.json()\n  // Pass data to the page via props\n  return { props: { repo } }\n}) satisfies GetServerSideProps&lt;{ repo: Repo }&gt;\n \nexport default function Page({\n  repo,\n}: InferGetServerSidePropsType&lt;typeof getServerSideProps&gt;) {\n  return (\n    &lt;main&gt;\n      &lt;p&gt;{repo.stargazers_count}&lt;/p&gt;\n    &lt;/main&gt;\n  )\n}</pre></div>  <h2 id=\"when-should-i-use-getserversideprops\" data-docs-heading=\"\">When should I use getServerSideProps?     </h2> <p>You should use <code>getServerSideProps</code> if you need to render a page that relies on personalized user data, or information that can only be known at request time. For example, <code>authorization</code> headers or a geolocation.</p> <p>If you do not need to fetch the data at request time, or would prefer to cache the data and pre-rendered HTML, we recommend using <a href=\"get-static-props\"><code>getStaticProps</code></a>.</p> <h2 id=\"behavior\" data-docs-heading=\"\">Behavior     </h2> <ul> <li>\n<code>getServerSideProps</code> runs on the server.</li> <li>\n<code>getServerSideProps</code> can only be exported from a <strong>page</strong>.</li> <li>\n<code>getServerSideProps</code> returns JSON.</li> <li>When a user visits a page, <code>getServerSideProps</code> will be used to fetch data at request time, and the data is used to render the initial HTML of the page.</li> <li>\n<code>props</code> passed to the page component can be viewed on the client as part of the initial HTML. This is to allow the page to be <a href=\"https://react.dev/reference/react-dom/hydrate\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">hydrated</a> correctly. Make sure that you don't pass any sensitive information that shouldn't be available on the client in <code>props</code>.</li> <li>When a user visits the page through <a href=\"../../api-reference/components/link\"><code>next/link</code></a> or <a href=\"../../api-reference/functions/use-router\"><code>next/router</code></a>, Next.js sends an API request to the server, which runs <code>getServerSideProps</code>.</li> <li>You do not have to call a Next.js <a href=\"../routing/api-routes\">API Route</a> to fetch data when using <code>getServerSideProps</code> since the function runs on the server. Instead, you can call a CMS, database, or other third-party APIs directly from inside <code>getServerSideProps</code>.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>See <a href=\"../../api-reference/functions/get-server-side-props\"><code>getServerSideProps</code> API reference</a> for parameters and props that can be used with <code>getServerSideProps</code>.</li> <li>You can use the <a href=\"https://next-code-elimination.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">next-code-elimination tool</a> to verify what Next.js eliminates from the client-side bundle.</li> </ul> </blockquote> <h2 id=\"error-handling\" data-docs-heading=\"\">Error Handling     </h2> <p>If an error is thrown inside <code>getServerSideProps</code>, it will show the <code>pages/500.js</code> file. Check out the documentation for <a href=\"../routing/custom-error#500-page\">500 page</a> to learn more on how to create it. During development, this file will not be used and the development error overlay will be shown instead.</p> <h2 id=\"edge-cases\" data-docs-heading=\"\">Edge Cases     </h2> <h3 id=\"edge-runtime\" data-docs-heading=\"\">Edge Runtime     </h3> <p><code>getServerSideProps</code> can be used with both <a href=\"../rendering/edge-and-nodejs-runtimes\">Serverless and Edge Runtimes</a>, and you can set props in both.</p> <p>However, currently in the Edge Runtime, you do not have access to the response object. This means that you cannot  for example  add cookies in <code>getServerSideProps</code>. To have access to the response object, you should <strong>continue to use the Node.js runtime</strong>, which is the default runtime.</p> <p>You can explicitly set the runtime on a per-page basis by modifying the <code>config</code>, for example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  runtime: 'nodejs', // or \"edge\"\n}\n \nexport const getServerSideProps = async () =&gt; {}</pre></div> <h3 id=\"caching-with-server-side-rendering-ssr\" data-docs-heading=\"\">Caching with Server-Side Rendering (SSR)     </h3> <p>You can use caching headers (<code>Cache-Control</code>) inside <code>getServerSideProps</code> to cache dynamic responses. For example, using <a href=\"https://web.dev/stale-while-revalidate/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>stale-while-revalidate</code></a>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// This value is considered fresh for ten seconds (s-maxage=10).\n// If a request is repeated within the next 10 seconds, the previously\n// cached value will still be fresh. If the request is repeated before 59 seconds,\n// the cached value will be stale but still render (stale-while-revalidate=59).\n//\n// In the background, a revalidation request will be made to populate the cache\n// with a fresh value. If you refresh the page, you will see the new value.\nexport async function getServerSideProps({ req, res }) {\n  res.setHeader(\n    'Cache-Control',\n    'public, s-maxage=10, stale-while-revalidate=59'\n  )\n \n  return {\n    props: {},\n  }\n}</pre>\n</div> <p>However, before reaching for <code>cache-control</code>, we recommend seeing if <a href=\"get-static-props\"><code>getStaticProps</code></a> with <a href=\"incremental-static-regeneration\">ISR</a> is a better fit for your use case.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/data-fetching/get-server-side-props\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/data-fetching/get-server-side-props</a>\n  </p>\n</div>\n","pages/building-your-application/data-fetching/incremental-static-regeneration":"<h1 class=\"break-words\">Incremental Static Regeneration (ISR)</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://nextjs.org/commerce\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js Commerce</a></li> <li><a href=\"https://reactions-demo.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">GitHub Reactions Demo</a></li> <li><a href=\"https://static-tweet.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Static Tweet Demo</a></li> </ul></details> <p>Next.js allows you to create or update static pages <em>after</em> youve built your site. Incremental Static Regeneration (ISR) enables you to use static-generation on a per-page basis, <strong>without needing to rebuild the entire site</strong>. With ISR, you can retain the benefits of static while scaling to millions of pages.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The <a href=\"../../api-reference/edge\"><code>edge</code> runtime</a> is currently not compatible with ISR, although you can leverage <code>stale-while-revalidate</code> by setting the <code>cache-control</code> header manually.</p> </blockquote> <p>To use ISR, add the <code>revalidate</code> prop to <code>getStaticProps</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function Blog({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li key={post.id}&gt;{post.title}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}\n \n// This function gets called at build time on server-side.\n// It may be called again, on a serverless function, if\n// revalidation is enabled and a new request comes in\nexport async function getStaticProps() {\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  return {\n    props: {\n      posts,\n    },\n    // Next.js will attempt to re-generate the page:\n    // - When a request comes in\n    // - At most once every 10 seconds\n    revalidate: 10, // In seconds\n  }\n}\n \n// This function gets called at build time on server-side.\n// It may be called again, on a serverless function, if\n// the path has not been generated.\nexport async function getStaticPaths() {\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  // Get the paths we want to pre-render based on posts\n  const paths = posts.map((post) =&gt; ({\n    params: { id: post.id },\n  }))\n \n  // We'll pre-render only these paths at build time.\n  // { fallback: 'blocking' } will server-render pages\n  // on-demand if the path doesn't exist.\n  return { paths, fallback: 'blocking' }\n}\n \nexport default Blog</pre>\n</div> <p>When a request is made to a page that was pre-rendered at build time, it will initially show the cached page.</p> <ul> <li>Any requests to the page after the initial request and before 10 seconds are also cached and instantaneous.</li> <li>After the 10-second window, the next request will still show the cached (stale) page</li> <li>Next.js triggers a regeneration of the page in the background.</li> <li>Once the page generates successfully, Next.js will invalidate the cache and show the updated page. If the background regeneration fails, the old page would still be unaltered.</li> </ul> <p>When a request is made to a path that hasnt been generated, Next.js will server-render the page on the first request. Future requests will serve the static file from the cache. ISR on Vercel <a href=\"https://vercel.com/docs/concepts/next.js/incremental-static-regeneration?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">persists the cache globally and handles rollbacks</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Check if your upstream data provider has caching enabled by default. You might need to disable (e.g. <code>useCdn: false</code>), otherwise a revalidation won't be able to pull fresh data to update the ISR cache. Caching can occur at a CDN (for an endpoint being requested) when it returns the <code>Cache-Control</code> header.</p> </blockquote> <h2 id=\"on-demand-revalidation\" data-docs-heading=\"\">On-Demand Revalidation     </h2> <p>If you set a <code>revalidate</code> time of <code>60</code>, all visitors will see the same generated version of your site for one minute. The only way to invalidate the cache is from someone visiting that page after the minute has passed.</p> <p>Starting with <code>v12.2.0</code>, Next.js supports On-Demand Incremental Static Regeneration to manually purge the Next.js cache for a specific page. This makes it easier to update your site when:</p> <ul> <li>Content from your headless CMS is created or updated</li> <li>Ecommerce metadata changes (price, description, category, reviews, etc.)</li> </ul> <p>Inside <code>getStaticProps</code>, you do not need to specify <code>revalidate</code> to use on-demand revalidation. If <code>revalidate</code> is omitted, Next.js will use the default value of <code>false</code> (no revalidation) and only revalidate the page on-demand when <code>revalidate()</code> is called.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <a href=\"../routing/middleware\">Middleware</a> won't be executed for On-Demand ISR requests. Instead, call <code>revalidate()</code> on the <em>exact</em> path that you want revalidated. For example, if you have <code>pages/blog/[slug].js</code> and a rewrite from <code>/post-1</code> -&gt; <code>/blog/post-1</code>, you would need to call <code>res.revalidate('/blog/post-1')</code>.</p> </blockquote> <h3 id=\"using-on-demand-revalidation\" data-docs-heading=\"\">Using On-Demand Revalidation     </h3> <p>First, create a secret token only known by your Next.js app. This secret will be used to prevent unauthorized access to the revalidation API Route. You can access the route (either manually or with a webhook) with the following URL structure:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://&lt;your-site.com&gt;/api/revalidate?secret=&lt;token&gt;</pre></div> <p>Next, add the secret as an <a href=\"../configuring/environment-variables\">Environment Variable</a> to your application. Finally, create the revalidation API Route:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function handler(req, res) {\n  // Check for secret to confirm this is a valid request\n  if (req.query.secret !== process.env.MY_SECRET_TOKEN) {\n    return res.status(401).json({ message: 'Invalid token' })\n  }\n \n  try {\n    // this should be the actual path not a rewritten path\n    // e.g. for \"/blog/[slug]\" this should be \"/blog/post-1\"\n    await res.revalidate('/path-to-revalidate')\n    return res.json({ revalidated: true })\n  } catch (err) {\n    // If there was an error, Next.js will continue\n    // to show the last successfully generated page\n    return res.status(500).send('Error revalidating')\n  }\n}</pre></div> <p><a href=\"https://on-demand-isr.vercel.app\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">View our demo</a> to see on-demand revalidation in action and provide feedback.</p> <h3 id=\"testing-on-demand-isr-during-development\" data-docs-heading=\"\">Testing on-Demand ISR during development     </h3> <p>When running locally with <code>next dev</code>, <code>getStaticProps</code> is invoked on every request. To verify your on-demand ISR configuration is correct, you will need to create a <a href=\"../../api-reference/next-cli#build\">production build</a> and start the <a href=\"../../api-reference/next-cli#production\">production server</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">$ next build\n$ next start</pre></div> <p>Then, you can confirm that static pages have successfully revalidated.</p> <h2 id=\"error-handling-and-revalidation\" data-docs-heading=\"\">Error handling and revalidation     </h2> <p>If there is an error inside <code>getStaticProps</code> when handling background regeneration, or you manually throw an error, the last successfully generated page will continue to show. On the next subsequent request, Next.js will retry calling <code>getStaticProps</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps() {\n  // If this request throws an uncaught error, Next.js will\n  // not invalidate the currently shown page and\n  // retry getStaticProps on the next request.\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  if (!res.ok) {\n    // If there is a server error, you might want to\n    // throw an error instead of returning so that the cache is not updated\n    // until the next successful request.\n    throw new Error(`Failed to fetch posts, received status ${res.status}`)\n  }\n \n  // If the request was successful, return the posts\n  // and revalidate every 10 seconds.\n  return {\n    props: {\n      posts,\n    },\n    revalidate: 10,\n  }\n}</pre>\n</div> <h2 id=\"self-hosting-isr\" data-docs-heading=\"\">Self-hosting ISR     </h2> <p>Incremental Static Regeneration (ISR) works on <a href=\"../deploying#self-hosting\">self-hosted Next.js sites</a> out of the box when you use <code>next start</code>.</p> <p>Learn more about <a href=\"../deploying#self-hosting\">self-hosting Next.js</a>.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v14.1.0</code></td>\n<td>Custom <code>cacheHandler</code> is stable.</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>On-Demand ISR is stable</td>\n</tr>\n<tr>\n<td><code>v12.1.0</code></td>\n<td>On-Demand ISR added (beta).</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>\n<a href=\"https://nextjs.org/blog/next-12#bot-aware-isr-fallback\" rel=\"noopener noreferrer\" target=\"_blank\">Bot-aware ISR fallback</a> added.</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>Base Path added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/data-fetching/incremental-static-regeneration\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/data-fetching/incremental-static-regeneration</a>\n  </p>\n</div>\n","pages/building-your-application/data-fetching/client-side":"<h1 class=\"break-words\">Client-side Fetching</h1>\n<p>Client-side data fetching is useful when your page doesn't require SEO indexing, when you don't need to pre-render your data, or when the content of your pages needs to update frequently. Unlike the server-side rendering APIs, you can use client-side data fetching at the component level.</p> <p>If done at the page level, the data is fetched at runtime, and the content of the page is updated as the data changes. When used at the component level, the data is fetched at the time of the component mount, and the content of the component is updated as the data changes.</p> <p>It's important to note that using client-side data fetching can affect the performance of your application and the load speed of your pages. This is because the data fetching is done at the time of the component or pages mount, and the data is not cached.</p> <h2 id=\"client-side-data-fetching-with-useeffect\" data-docs-heading=\"\">Client-side data fetching with useEffect     </h2> <p>The following example shows how you can fetch data on the client side using the useEffect hook.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useState, useEffect } from 'react'\n \nfunction Profile() {\n  const [data, setData] = useState(null)\n  const [isLoading, setLoading] = useState(true)\n \n  useEffect(() =&gt; {\n    fetch('/api/profile-data')\n      .then((res) =&gt; res.json())\n      .then((data) =&gt; {\n        setData(data)\n        setLoading(false)\n      })\n  }, [])\n \n  if (isLoading) return &lt;p&gt;Loading...&lt;/p&gt;\n  if (!data) return &lt;p&gt;No profile data&lt;/p&gt;\n \n  return (\n    &lt;div&gt;\n      &lt;h1&gt;{data.name}&lt;/h1&gt;\n      &lt;p&gt;{data.bio}&lt;/p&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <h2 id=\"client-side-data-fetching-with-swr\" data-docs-heading=\"\">Client-side data fetching with SWR     </h2> <p>The team behind Next.js has created a React hook library for data fetching called <a href=\"https://swr.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><strong>SWR</strong></a>. It is <strong>highly recommended</strong> if you are fetching data on the client-side. It handles caching, revalidation, focus tracking, refetching on intervals, and more.</p> <p>Using the same example as above, we can now use SWR to fetch the profile data. SWR will automatically cache the data for us and will revalidate the data if it becomes stale.</p> <p>For more information on using SWR, check out the <a href=\"https://swr.vercel.app/docs/getting-started\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SWR docs</a>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import useSWR from 'swr'\n \nconst fetcher = (...args) =&gt; fetch(...args).then((res) =&gt; res.json())\n \nfunction Profile() {\n  const { data, error } = useSWR('/api/profile-data', fetcher)\n \n  if (error) return &lt;div&gt;Failed to load&lt;/div&gt;\n  if (!data) return &lt;div&gt;Loading...&lt;/div&gt;\n \n  return (\n    &lt;div&gt;\n      &lt;h1&gt;{data.name}&lt;/h1&gt;\n      &lt;p&gt;{data.bio}&lt;/p&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/data-fetching/client-side\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/data-fetching/client-side</a>\n  </p>\n</div>\n","pages/building-your-application/styling":"<h1 class=\"break-words\">Styling</h1> <p>Next.js supports different ways of styling your application, including:</p> <ul> <li>\n<strong>Global CSS</strong>: Simple to use and familiar for those experienced with traditional CSS, but can lead to larger CSS bundles and difficulty managing styles as the application grows.</li> <li>\n<strong>CSS Modules</strong>: Create locally scoped CSS classes to avoid naming conflicts and improve maintainability.</li> <li>\n<strong>Tailwind CSS</strong>: A utility-first CSS framework that allows for rapid custom designs by composing utility classes.</li> <li>\n<strong>Sass</strong>: A popular CSS preprocessor that extends CSS with features like variables, nested rules, and mixins.</li> <li>\n<strong>CSS-in-JS</strong>: Embed CSS directly in your JavaScript components, enabling dynamic and scoped styling.</li> </ul> <p>Learn more about each approach by exploring their respective documentation:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/styling\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/styling</a>\n  </p>\n</div>\n","pages/building-your-application/styling/tailwind-css":"<h1 class=\"break-words\">Tailwind CSS</h1> <details open=\"\"><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-tailwindcss\" rel=\"noopener noreferrer\" target=\"_blank\">With Tailwind CSS</a></li> </ul></details> <p><a href=\"https://tailwindcss.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Tailwind CSS</a> is a utility-first CSS framework that works exceptionally well with Next.js.</p> <h2 id=\"installing-tailwind\" data-docs-heading=\"\">Installing Tailwind     </h2> <p>Install the Tailwind CSS packages and run the <code>init</code> command to generate both the <code>tailwind.config.js</code> and <code>postcss.config.js</code> files:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D tailwindcss postcss autoprefixer\nnpx tailwindcss init -p</pre></div> <h2 id=\"configuring-tailwind\" data-docs-heading=\"\">Configuring Tailwind     </h2> <p>Inside <code>tailwind.config.js</code>, add paths to the files that will use Tailwind CSS class names:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    './app/**/*.{js,ts,jsx,tsx,mdx}', // Note the addition of the `app` directory.\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n \n    // Or if using `src` directory:\n    './src/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n}</pre></div> <p>You do not need to modify <code>postcss.config.js</code>.</p>  <h2 id=\"importing-styles-1\" data-docs-heading=\"\">Importing Styles     </h2>\n<p>Add the <a href=\"https://tailwindcss.com/docs/functions-and-directives#directives\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Tailwind CSS directives</a> that Tailwind will use to inject its generated styles to a <a href=\"css-modules#global-styles\">Global Stylesheet</a> in your application, for example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">@tailwind base;\n@tailwind components;\n@tailwind utilities;</pre></div>\n<p>Inside the <a href=\"../routing/custom-app\">custom app file</a> (<code>pages/_app.js</code>), import the <code>globals.css</code> stylesheet to apply the styles to every route in your application.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// These styles apply to every route in the application\nimport '@/styles/globals.css'\nimport type { AppProps } from 'next/app'\n \nexport default function App({ Component, pageProps }: AppProps) {\n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>\n<h2 id=\"using-classes-1\" data-docs-heading=\"\">Using Classes     </h2>\n<p>After installing Tailwind CSS and adding the global styles, you can use Tailwind's utility classes in your application.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return &lt;h1 className=\"text-3xl font-bold underline\"&gt;Hello, Next.js!&lt;/h1&gt;\n}</pre></div> <h2 id=\"usage-with-turbopack\" data-docs-heading=\"\">Usage with Turbopack     </h2> <p>As of Next.js 13.1, Tailwind CSS and PostCSS are supported with <a href=\"https://turbo.build/pack/docs/features/css#tailwind-css\" rel=\"noopener noreferrer\" target=\"_blank\">Turbopack</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/styling/tailwind-css\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/styling/tailwind-css</a>\n  </p>\n</div>\n","pages/building-your-application/data-fetching/forms-and-mutations":"<h1 class=\"break-words\">Forms and Mutations</h1>\n<p>Forms enable you to create and update data in web applications. Next.js provides a powerful way to handle form submissions and data mutations using <strong>API Routes</strong>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>We will soon recommend <a href=\"../../../app/building-your-application/upgrading/app-router-migration\">incrementally adopting</a> the App Router and using <a href=\"../../../app/building-your-application/data-fetching/server-actions-and-mutations\">Server Actions</a> for handling form submissions and data mutations. Server Actions allow you to define asynchronous server functions that can be called directly from your components, without needing to manually create an API Route.</li> <li>API Routes <a href=\"https://developer.mozilla.org/docs/Web/HTTP/CORS\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">do not specify CORS headers</a>, meaning they are same-origin only by default.</li> <li>Since API Routes run on the server, we're able to use sensitive values (like API keys) through <a href=\"../configuring/environment-variables\">Environment Variables</a> without exposing them to the client. This is critical for the security of your application.</li> </ul> </blockquote> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"server-only-form\" data-docs-heading=\"\">Server-only form     </h3> <p>With the Pages Router, you need to manually create API endpoints to handle securely mutating data on the server.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const data = req.body\n  const id = await createItem(data)\n  res.status(200).json({ id })\n}</pre></div>  <p>Then, call the API Route from the client with an event handler:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { FormEvent } from 'react'\n \nexport default function Page() {\n  async function onSubmit(event: FormEvent&lt;HTMLFormElement&gt;) {\n    event.preventDefault()\n \n    const formData = new FormData(event.currentTarget)\n    const response = await fetch('/api/submit', {\n      method: 'POST',\n      body: formData,\n    })\n \n    // Handle response if necessary\n    const data = await response.json()\n    // ...\n  }\n \n  return (\n    &lt;form onSubmit={onSubmit}&gt;\n      &lt;input type=\"text\" name=\"name\" /&gt;\n      &lt;button type=\"submit\"&gt;Submit&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre></div>  <h2 id=\"form-validation\" data-docs-heading=\"\">Form validation     </h2> <p>We recommend using HTML validation like <code>required</code> and <code>type=\"email\"</code> for basic client-side form validation.</p> <p>For more advanced server-side validation, you can use a schema validation library like <a href=\"https://zod.dev/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">zod</a> to validate the form fields before mutating the data:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\nimport { z } from 'zod'\n \nconst schema = z.object({\n  // ...\n})\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const parsed = schema.parse(req.body)\n  // ...\n}</pre></div>  <h3 id=\"error-handling\" data-docs-heading=\"\">Error handling     </h3> <p>You can use React state to show an error message when a form submission fails:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React, { useState, FormEvent } from 'react'\n \nexport default function Page() {\n  const [isLoading, setIsLoading] = useState&lt;boolean&gt;(false)\n  const [error, setError] = useState&lt;string | null&gt;(null)\n \n  async function onSubmit(event: FormEvent&lt;HTMLFormElement&gt;) {\n    event.preventDefault()\n    setIsLoading(true)\n    setError(null) // Clear previous errors when a new request starts\n \n    try {\n      const formData = new FormData(event.currentTarget)\n      const response = await fetch('/api/submit', {\n        method: 'POST',\n        body: formData,\n      })\n \n      if (!response.ok) {\n        throw new Error('Failed to submit the data. Please try again.')\n      }\n \n      // Handle response if necessary\n      const data = await response.json()\n      // ...\n    } catch (error) {\n      // Capture the error message to display to the user\n      setError(error.message)\n      console.error(error)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n \n  return (\n    &lt;div&gt;\n      {error &amp;&amp; &lt;div style={{ color: 'red' }}&gt;{error}&lt;/div&gt;}\n      &lt;form onSubmit={onSubmit}&gt;\n        &lt;input type=\"text\" name=\"name\" /&gt;\n        &lt;button type=\"submit\" disabled={isLoading}&gt;\n          {isLoading ? 'Loading...' : 'Submit'}\n        &lt;/button&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <h2 id=\"displaying-loading-state\" data-docs-heading=\"\">Displaying loading state     </h2> <p>You can use React state to show a loading state when a form is submitting on the server:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React, { useState, FormEvent } from 'react'\n \nexport default function Page() {\n  const [isLoading, setIsLoading] = useState&lt;boolean&gt;(false)\n \n  async function onSubmit(event: FormEvent&lt;HTMLFormElement&gt;) {\n    event.preventDefault()\n    setIsLoading(true) // Set loading to true when the request starts\n \n    try {\n      const formData = new FormData(event.currentTarget)\n      const response = await fetch('/api/submit', {\n        method: 'POST',\n        body: formData,\n      })\n \n      // Handle response if necessary\n      const data = await response.json()\n      // ...\n    } catch (error) {\n      // Handle error if necessary\n      console.error(error)\n    } finally {\n      setIsLoading(false) // Set loading to false when the request completes\n    }\n  }\n \n  return (\n    &lt;form onSubmit={onSubmit}&gt;\n      &lt;input type=\"text\" name=\"name\" /&gt;\n      &lt;button type=\"submit\" disabled={isLoading}&gt;\n        {isLoading ? 'Loading...' : 'Submit'}\n      &lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre></div>  <h3 id=\"redirecting\" data-docs-heading=\"\">Redirecting     </h3> <p>If you would like to redirect the user to a different route after a mutation, you can <a href=\"../routing/api-routes#response-helpers\"><code>redirect</code></a> to any absolute or relative URL:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const id = await addPost()\n  res.redirect(307, `/post/${id}`)\n}</pre></div>  <h3 id=\"setting-cookies\" data-docs-heading=\"\">Setting cookies     </h3> <p>You can set cookies inside an API Route using the <code>setHeader</code> method on the response:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  res.setHeader('Set-Cookie', 'username=lee; Path=/; HttpOnly')\n  res.status(200).send('Cookie has been set.')\n}</pre></div>  <h3 id=\"reading-cookies\" data-docs-heading=\"\">Reading cookies     </h3> <p>You can read cookies inside an API Route using the <a href=\"../routing/api-routes#request-helpers\"><code>cookies</code></a> request helper:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const auth = req.cookies.authorization\n  // ...\n}</pre></div>  <h3 id=\"deleting-cookies\" data-docs-heading=\"\">Deleting cookies     </h3> <p>You can delete cookies inside an API Route using the <code>setHeader</code> method on the response:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  res.setHeader('Set-Cookie', 'username=; Path=/; HttpOnly; Max-Age=0')\n  res.status(200).send('Cookie has been deleted.')\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/data-fetching/forms-and-mutations\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/data-fetching/forms-and-mutations</a>\n  </p>\n</div>\n","pages/building-your-application/styling/css-modules":"<h1 class=\"break-words\">CSS Modules</h1> <details open=\"\"><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/basic-css\" rel=\"noopener noreferrer\" target=\"_blank\">Basic CSS Example</a></li> </ul></details> <p>Next.js supports different types of stylesheets, including:</p> <ul> <li><a href=\"#css-modules\">CSS Modules</a></li> <li><a href=\"#global-styles\">Global Styles</a></li> <li><a href=\"#external-stylesheets\">External Stylesheets</a></li> </ul> <h2 id=\"css-modules\" data-docs-heading=\"\">CSS Modules     </h2> <p>Next.js has built-in support for CSS Modules using the <code>.module.css</code> extension.</p> <p>CSS Modules locally scope CSS by automatically creating a unique class name. This allows you to use the same class name in different files without worrying about collisions. This behavior makes CSS Modules the ideal way to include component-level CSS.</p> <h2 id=\"example\" data-docs-heading=\"\">Example     </h2>  <p>For example, consider a reusable <code>Button</code> component in the <code>components/</code> folder:</p>\n<p>First, create <code>components/Button.module.css</code> with the following content:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/*\nYou do not need to worry about .error {} colliding with any other `.css` or\n`.module.css` files!\n*/\n.error {\n  color: white;\n  background-color: red;\n}</pre></div>\n<p>Then, create <code>components/Button.js</code>, importing and using the above CSS file:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import styles from './Button.module.css'\n \nexport function Button() {\n  return (\n    &lt;button\n      type=\"button\"\n      // Note how the \"error\" class is accessed as a property on the imported\n      // `styles` object.\n      className={styles.error}\n    &gt;\n      Destroy\n    &lt;/button&gt;\n  )\n}</pre></div> <p>CSS Modules are <strong>only enabled for files with the <code>.module.css</code> and <code>.module.sass</code> extensions</strong>.</p> <p>In production, all CSS Module files will be automatically concatenated into <strong>many minified and code-split</strong> <code>.css</code> files. These <code>.css</code> files represent hot execution paths in your application, ensuring the minimal amount of CSS is loaded for your application to paint.</p> <h2 id=\"global-styles\" data-docs-heading=\"\">Global Styles     </h2>  <p>To add a stylesheet to your application, import the CSS file within <code>pages/_app.js</code>.</p>\n<p>For example, consider the following stylesheet named <code>styles.css</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">body {\n  font-family: 'SF Pro Text', 'SF Pro Icons', 'Helvetica Neue', 'Helvetica',\n    'Arial', sans-serif;\n  padding: 20px 20px 60px;\n  max-width: 680px;\n  margin: 0 auto;\n}</pre></div>\n<p>Create a <a href=\"../routing/custom-app\"><code>pages/_app.js</code> file</a> if not already present. Then, <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/import\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>import</code></a> the <code>styles.css</code> file.</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../styles.css'\n \n// This default export is required in a new `pages/_app.js` file.\nexport default function MyApp({ Component, pageProps }) {\n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>\n<p>These styles (<code>styles.css</code>) will apply to all pages and components in your application. Due to the global nature of stylesheets, and to avoid conflicts, you may <strong>only import them inside <a href=\"../routing/custom-app\"><code>pages/_app.js</code></a></strong>.</p>\n<p>In development, expressing stylesheets this way allows your styles to be hot reloaded as you edit themmeaning you can keep application state.</p>\n<p>In production, all CSS files will be automatically concatenated into a single minified <code>.css</code> file. The order that the CSS is concatenated will match the order the CSS is imported into the <code>_app.js</code> file. Pay special attention to imported JS modules that include their own CSS; the JS module's CSS will be concatenated following the same ordering rules as imported CSS files. For example:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../styles.css'\n// The CSS in ErrorBoundary depends on the global CSS in styles.css,\n// so we import it after styles.css.\nimport ErrorBoundary from '../components/ErrorBoundary'\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;ErrorBoundary&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/ErrorBoundary&gt;\n  )\n}</pre>\n</div> <h2 id=\"external-stylesheets\" data-docs-heading=\"\">External Stylesheets     </h2>  <p>Next.js allows you to import CSS files from a JavaScript file. This is possible because Next.js extends the concept of <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/import\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>import</code></a> beyond JavaScript.</p>\n<h3 id=\"import-styles-from-node_modules\" data-docs-heading=\"\">Import styles from node_modules     </h3>\n<p>Since Next.js <strong>9.5.4</strong>, importing a CSS file from <code>node_modules</code> is permitted anywhere in your application.</p>\n<p>For global stylesheets, like <code>bootstrap</code> or <code>nprogress</code>, you should import the file inside <code>pages/_app.js</code>. For example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import 'bootstrap/dist/css/bootstrap.css'\n \nexport default function MyApp({ Component, pageProps }) {\n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>\n<p>For importing CSS required by a third-party component, you can do so in your component. For example:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useState } from 'react'\nimport { Dialog } from '@reach/dialog'\nimport VisuallyHidden from '@reach/visually-hidden'\nimport '@reach/dialog/styles.css'\n \nfunction ExampleDialog(props) {\n  const [showDialog, setShowDialog] = useState(false)\n  const open = () =&gt; setShowDialog(true)\n  const close = () =&gt; setShowDialog(false)\n \n  return (\n    &lt;div&gt;\n      &lt;button onClick={open}&gt;Open Dialog&lt;/button&gt;\n      &lt;Dialog isOpen={showDialog} onDismiss={close}&gt;\n        &lt;button className=\"close-button\" onClick={close}&gt;\n          &lt;VisuallyHidden&gt;Close&lt;/VisuallyHidden&gt;\n          &lt;span aria-hidden&gt;&lt;/span&gt;\n        &lt;/button&gt;\n        &lt;p&gt;Hello there. I am a dialog&lt;/p&gt;\n      &lt;/Dialog&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <h2 id=\"additional-features\" data-docs-heading=\"\">Additional Features     </h2> <p>Next.js includes additional features to improve the authoring experience of adding styles:</p> <ul> <li>When running locally with <code>next dev</code>, local stylesheets (either global or CSS modules) will take advantage of <a href=\"../../../architecture/fast-refresh\">Fast Refresh</a> to instantly reflect changes as edits are saved.</li> <li>When building for production with <code>next build</code>, CSS files will be bundled into fewer minified <code>.css</code> files to reduce the number of network requests needed to retrieve styles.</li> <li>If you disable JavaScript, styles will still be loaded in the production build (<code>next start</code>). However, JavaScript is still required for <code>next dev</code> to enable <a href=\"../../../architecture/fast-refresh\">Fast Refresh</a>.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/styling/css-modules\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/styling/css-modules</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing":"<h1 class=\"break-words\">Optimizations</h1> <p>Next.js comes with a variety of built-in optimizations designed to improve your application's speed and <a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Core Web Vitals</a>. This guide will cover the optimizations you can leverage to enhance your user experience.</p> <h2 id=\"built-in-components\" data-docs-heading=\"\">Built-in Components     </h2> <p>Built-in components abstract away the complexity of implementing common UI optimizations. These components are:</p> <ul> <li>\n<strong>Images</strong>: Built on the native <code>&lt;img&gt;</code> element. The Image Component optimizes images for performance by lazy loading and automatically resizing images based on device size.</li> <li>\n<strong>Link</strong>: Built on the native <code>&lt;a&gt;</code> tags. The Link Component prefetches pages in the background, for faster and smoother page transitions.</li> <li>\n<strong>Scripts</strong>: Built on the native <code>&lt;script&gt;</code> tags. The Script Component gives you control over loading and execution of third-party scripts.</li> </ul> <h2 id=\"metadata\" data-docs-heading=\"\">Metadata     </h2> <p>Metadata helps search engines understand your content better (which can result in better SEO), and allows you to customize how your content is presented on social media, helping you create a more engaging and consistent user experience across various platforms.</p>  <p>The Head Component in Next.js allows you to modify the <code>&lt;head&gt;</code> of a page. Learn more in the <a href=\"../api-reference/components/head\">Head Component</a> documentation.</p> <h2 id=\"static-assets\" data-docs-heading=\"\">Static Assets     </h2> <p>Next.js <code>/public</code> folder can be used to serve static assets like images, fonts, and other files. Files inside <code>/public</code> can also be cached by CDN providers so that they are delivered efficiently.</p> <h2 id=\"analytics-and-monitoring\" data-docs-heading=\"\">Analytics and Monitoring     </h2> <p>For large applications, Next.js integrates with popular analytics and monitoring tools to help you understand how your application is performing. Learn more in the <a href=\"../../app/building-your-application/optimizing/analytics\">Analytics</a>,  <a href=\"optimizing/open-telemetry\">OpenTelemetry</a>, and <a href=\"optimizing/instrumentation\">Instrumentation</a> guides.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/images":"<h1 class=\"break-words\">Image Optimization</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/image-component\" rel=\"noopener noreferrer\" target=\"_blank\">Image Component</a></li> </ul></details> <p>According to <a href=\"https://almanac.httparchive.org\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Almanac</a>, images account for a huge portion of the typical websites <a href=\"https://almanac.httparchive.org/en/2022/page-weight#content-type-and-file-formats\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">page weight</a> and can have a sizable impact on your website's <a href=\"https://almanac.httparchive.org/en/2022/performance#lcp-image-optimization\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">LCP performance</a>.</p> <p>The Next.js Image component extends the HTML <code>&lt;img&gt;</code> element with features for automatic image optimization:</p> <ul> <li>\n<strong>Size Optimization:</strong> Automatically serve correctly sized images for each device, using modern image formats like WebP and AVIF.</li> <li>\n<strong>Visual Stability:</strong> Prevent <a href=\"https://nextjs.org/learn/seo/web-performance/cls\">layout shift</a> automatically when images are loading.</li> <li>\n<strong>Faster Page Loads:</strong> Images are only loaded when they enter the viewport using native browser lazy loading, with optional blur-up placeholders.</li> <li>\n<strong>Asset Flexibility:</strong> On-demand image resizing, even for images stored on remote servers</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn more about how to use <code>next/image</code>  <a href=\"https://youtu.be/IU_qq_c_lKA\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (9 minutes)</a>.</p> </blockquote> <h2 id=\"usage\" data-docs-heading=\"\">Usage     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'</pre>\n</div> <p>You can then define the <code>src</code> for your image (either local or remote).</p> <h3 id=\"local-images\" data-docs-heading=\"\">Local Images     </h3> <p>To use a local image, <code>import</code> your <code>.jpg</code>, <code>.png</code>, or <code>.webp</code> image files.</p> <p>Next.js will <a href=\"#image-sizing\">automatically determine</a> the <code>width</code> and <code>height</code> of your image based on the imported file. These values are used to prevent <a href=\"https://nextjs.org/learn/seo/web-performance/cls\" rel=\"noopener noreferrer\" target=\"_blank\">Cumulative Layout Shift</a> while your image is loading.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport profilePic from '../public/me.png'\n \nexport default function Page() {\n  return (\n    &lt;Image\n      src={profilePic}\n      alt=\"Picture of the author\"\n      // width={500} automatically provided\n      // height={500} automatically provided\n      // blurDataURL=\"data:...\" automatically provided\n      // placeholder=\"blur\" // Optional blur-up while loading\n    /&gt;\n  )\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> Dynamic <code>await import()</code> or <code>require()</code> are <em>not</em> supported. The <code>import</code> must be static so it can be analyzed at build time.</p> </blockquote> <h3 id=\"remote-images\" data-docs-heading=\"\">Remote Images     </h3> <p>To use a remote image, the <code>src</code> property should be a URL string.</p> <p>Since Next.js does not have access to remote files during the build process, you'll need to provide the <a href=\"../../../app/api-reference/components/image#width\"><code>width</code></a>, <a href=\"../../../app/api-reference/components/image#height\"><code>height</code></a> and optional <a href=\"../../../app/api-reference/components/image#blurdataurl\"><code>blurDataURL</code></a> props manually.</p> <p>The <code>width</code> and <code>height</code> attributes are used to infer the correct aspect ratio of image and avoid layout shift from the image loading in. The <code>width</code> and <code>height</code> do <em>not</em> determine the rendered size of the image file. Learn more about <a href=\"#image-sizing\">Image Sizing</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return (\n    &lt;Image\n      src=\"https://s3.amazonaws.com/my-bucket/profile.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    /&gt;\n  )\n}</pre></div> <p>To safely allow optimizing images, define a list of supported URL patterns in <code>next.config.js</code>. Be as specific as possible to prevent malicious usage. For example, the following configuration will only allow images from a specific AWS S3 bucket:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 's3.amazonaws.com',\n        port: '',\n        pathname: '/my-bucket/**',\n      },\n    ],\n  },\n}</pre></div> <p>Learn more about <a href=\"../../../app/api-reference/components/image#remotepatterns\"><code>remotePatterns</code></a> configuration. If you want to use relative URLs for the image <code>src</code>, use a <a href=\"../../../app/api-reference/components/image#loader\"><code>loader</code></a>.</p> <h3 id=\"domains\" data-docs-heading=\"\">Domains     </h3> <p>Sometimes you may want to optimize a remote image, but still use the built-in Next.js Image Optimization API. To do this, leave the <code>loader</code> at its default setting and enter an absolute URL for the Image <code>src</code> prop.</p> <p>To protect your application from malicious users, you must define a list of remote hostnames you intend to use with the <code>next/image</code> component.</p> <blockquote class=\"p-3 text-sm\"> <p>Learn more about <a href=\"../../../app/api-reference/components/image#remotepatterns\"><code>remotePatterns</code></a> configuration.</p> </blockquote> <h3 id=\"loaders\" data-docs-heading=\"\">Loaders     </h3> <p>Note that in the <a href=\"#local-images\">example earlier</a>, a partial URL (<code>\"/me.png\"</code>) is provided for a local image. This is possible because of the loader architecture.</p> <p>A loader is a function that generates the URLs for your image. It modifies the provided <code>src</code>, and generates multiple URLs to request the image at different sizes. These multiple URLs are used in the automatic <a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/srcset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">srcset</a> generation, so that visitors to your site will be served an image that is the right size for their viewport.</p> <p>The default loader for Next.js applications uses the built-in Image Optimization API, which optimizes images from anywhere on the web, and then serves them directly from the Next.js web server. If you would like to serve your images directly from a CDN or image server, you can write your own loader function with a few lines of JavaScript.</p> <p>You can define a loader per-image with the <a href=\"../../../app/api-reference/components/image#loader\"><code>loader</code> prop</a>, or at the application level with the <a href=\"../../../app/api-reference/components/image#loaderfile\"><code>loaderFile</code> configuration</a>.</p> <h2 id=\"priority\" data-docs-heading=\"\">Priority     </h2> <p>You should add the <code>priority</code> property to the image that will be the <a href=\"https://web.dev/lcp/#what-elements-are-considered\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Largest Contentful Paint (LCP) element</a> for each page. Doing so allows Next.js to specially prioritize the image for loading (e.g. through preload tags or priority hints), leading to a meaningful boost in LCP.</p> <p>The LCP element is typically the largest image or text block visible within the viewport of the page. When you run <code>next dev</code>, you'll see a console warning if the LCP element is an <code>&lt;Image&gt;</code> without the <code>priority</code> property.</p> <p>Once you've identified the LCP image, you can add the property like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Home() {\n  return (\n    &lt;&gt;\n      &lt;h1&gt;My Homepage&lt;/h1&gt;\n      &lt;Image\n        src=\"/me.png\"\n        alt=\"Picture of the author\"\n        width={500}\n        height={500}\n        priority\n      /&gt;\n      &lt;p&gt;Welcome to my homepage!&lt;/p&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>See more about priority in the <a href=\"../../../app/api-reference/components/image#priority\"><code>next/image</code> component documentation</a>.</p> <h2 id=\"image-sizing\" data-docs-heading=\"\">Image Sizing     </h2> <p>One of the ways that images most commonly hurt performance is through <em>layout shift</em>, where the image pushes other elements around on the page as it loads in. This performance problem is so annoying to users that it has its own Core Web Vital, called <a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a>. The way to avoid image-based layout shifts is to <a href=\"https://web.dev/optimize-cls/#images-without-dimensions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">always size your images</a>. This allows the browser to reserve precisely enough space for the image before it loads.</p> <p>Because <code>next/image</code> is designed to guarantee good performance results, it cannot be used in a way that will contribute to layout shift, and <strong>must</strong> be sized in one of three ways:</p> <ol> <li>Automatically, using a <a href=\"#local-images\">static import</a>\n</li> <li>Explicitly, by including a <a href=\"../../../app/api-reference/components/image#width\"><code>width</code></a> and <a href=\"../../../app/api-reference/components/image#height\"><code>height</code></a> property</li> <li>Implicitly, by using <a href=\"../../../app/api-reference/components/image#fill\">fill</a> which causes the image to expand to fill its parent element.</li> </ol> <blockquote class=\"p-3 text-sm\"> <p><strong>What if I don't know the size of my images?</strong></p> <p>If you are accessing images from a source without knowledge of the images' sizes, there are several things you can do:</p> <p><strong>Use <code>fill</code></strong></p> <p>The <a href=\"../../../app/api-reference/components/image#fill\"><code>fill</code></a> prop allows your image to be sized by its parent element. Consider using CSS to give the image's parent element space on the page along <a href=\"../../../app/api-reference/components/image#sizes\"><code>sizes</code></a> prop to match any media query break points. You can also use <a href=\"https://developer.mozilla.org/docs/Web/CSS/object-fit\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>object-fit</code></a> with <code>fill</code>, <code>contain</code>, or <code>cover</code>, and <a href=\"https://developer.mozilla.org/docs/Web/CSS/object-position\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>object-position</code></a> to define how the image should occupy that space.</p> <p><strong>Normalize your images</strong></p> <p>If you're serving images from a source that you control, consider modifying your image pipeline to normalize the images to a specific size.</p> <p><strong>Modify your API calls</strong></p> <p>If your application is retrieving image URLs using an API call (such as to a CMS), you may be able to modify the API call to return the image dimensions along with the URL.</p> </blockquote> <p>If none of the suggested methods works for sizing your images, the <code>next/image</code> component is designed to work well on a page alongside standard <code>&lt;img&gt;</code> elements.</p> <h2 id=\"styling\" data-docs-heading=\"\">Styling     </h2> <p>Styling the Image component is similar to styling a normal <code>&lt;img&gt;</code> element, but there are a few guidelines to keep in mind:</p> <ul> <li>Use <code>className</code> or <code>style</code>, not <code>styled-jsx</code>. <ul> <li>In most cases, we recommend using the <code>className</code> prop. This can be an imported <a href=\"../../../app/building-your-application/styling/css-modules\">CSS Module</a>, a <a href=\"../../../app/building-your-application/styling/css-modules#global-styles\">global stylesheet</a>, etc.</li> <li>You can also use the <code>style</code> prop to assign inline styles.</li> <li>You cannot use <a href=\"../../../app/building-your-application/styling/css-in-js\">styled-jsx</a> because it's scoped to the current component (unless you mark the style as <code>global</code>).</li> </ul> </li> <li>When using <code>fill</code>, the parent element must have <code>position: relative</code> <ul> <li>This is necessary for the proper rendering of the image element in that layout mode.</li> </ul> </li> <li>When using <code>fill</code>, the parent element must have <code>display: block</code> <ul> <li>This is the default for <code>&lt;div&gt;</code> elements but should be specified otherwise.</li> </ul> </li> </ul> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"responsive\" data-docs-heading=\"\">Responsive     </h3> <figure><img alt=\"Responsive image filling the width and height of its parent container\" loading=\"lazy\" width=\"1600\" height=\"629\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fresponsive-image.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fresponsive-image.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fresponsive-image.png&amp;w=3840&amp;q=75\"><img alt=\"Responsive image filling the width and height of its parent container\" loading=\"lazy\" width=\"1600\" height=\"629\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fresponsive-image.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fresponsive-image.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fresponsive-image.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n \nexport default function Responsive() {\n  return (\n    &lt;div style={{ display: 'flex', flexDirection: 'column' }}&gt;\n      &lt;Image\n        alt=\"Mountains\"\n        // Importing an image will\n        // automatically set the width and height\n        src={mountains}\n        sizes=\"100vw\"\n        // Make the image display full width\n        style={{\n          width: '100%',\n          height: 'auto',\n        }}\n      /&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <h3 id=\"fill-container\" data-docs-heading=\"\">Fill Container     </h3> <figure><img alt=\"Grid of images filling parent container width\" loading=\"lazy\" width=\"1600\" height=\"529\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Ffill-container.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Ffill-container.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Ffill-container.png&amp;w=3840&amp;q=75\"><img alt=\"Grid of images filling parent container width\" loading=\"lazy\" width=\"1600\" height=\"529\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Ffill-container.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Ffill-container.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Ffill-container.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n \nexport default function Fill() {\n  return (\n    &lt;div\n      style={{\n        display: 'grid',\n        gridGap: '8px',\n        gridTemplateColumns: 'repeat(auto-fit, minmax(400px, auto))',\n      }}\n    &gt;\n      &lt;div style={{ position: 'relative', height: '400px' }}&gt;\n        &lt;Image\n          alt=\"Mountains\"\n          src={mountains}\n          fill\n          sizes=\"(min-width: 808px) 50vw, 100vw\"\n          style={{\n            objectFit: 'cover', // cover, contain, none\n          }}\n        /&gt;\n      &lt;/div&gt;\n      {/* And more images in the grid... */}\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <h3 id=\"background-image\" data-docs-heading=\"\">Background Image     </h3> <figure><img alt=\"Background image taking full width and height of page\" loading=\"lazy\" width=\"1600\" height=\"427\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fbackground-image.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fbackground-image.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fbackground-image.png&amp;w=3840&amp;q=75\"><img alt=\"Background image taking full width and height of page\" loading=\"lazy\" width=\"1600\" height=\"427\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fbackground-image.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fbackground-image.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fbackground-image.png&amp;w=3840&amp;q=75\"></figure> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport mountains from '../public/mountains.jpg'\n \nexport default function Background() {\n  return (\n    &lt;Image\n      alt=\"Mountains\"\n      src={mountains}\n      placeholder=\"blur\"\n      quality={100}\n      fill\n      sizes=\"100vw\"\n      style={{\n        objectFit: 'cover',\n      }}\n    /&gt;\n  )\n}</pre>\n</div> <p>For examples of the Image component used with the various styles, see the <a href=\"https://image-component.nextjs.gallery\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Image Component Demo</a>.</p> <h2 id=\"other-properties\" data-docs-heading=\"\">Other Properties     </h2> <p><a href=\"../../../app/api-reference/components/image\"><strong>View all properties available to the <code>next/image</code> component.</strong></a></p> <h2 id=\"configuration\" data-docs-heading=\"\">Configuration     </h2> <p>The <code>next/image</code> component and Next.js Image Optimization API can be configured in the <a href=\"../../../app/api-reference/next-config-js\"><code>next.config.js</code> file</a>. These configurations allow you to <a href=\"../../../app/api-reference/components/image#remotepatterns\">enable remote images</a>, <a href=\"../../../app/api-reference/components/image#devicesizes\">define custom image breakpoints</a>, <a href=\"../../../app/api-reference/components/image#caching-behavior\">change caching behavior</a> and more.</p> <p><a href=\"../../../app/api-reference/components/image#configuration-options\"><strong>Read the full image configuration documentation for more information.</strong></a></p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/images\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/images</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/fonts":"<h1 class=\"break-words\">Font Optimization</h1> <p><a href=\"../../../app/api-reference/components/font\"><strong><code>next/font</code></strong></a> will automatically optimize your fonts (including custom fonts) and remove external network requests for improved privacy and performance.</p> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn more about using <code>next/font</code>  <a href=\"https://www.youtube.com/watch?v=L8_98i_bMMA\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (6 minutes)</a>.</p> </blockquote> <p><code>next/font</code> includes <strong>built-in automatic self-hosting</strong> for <em>any</em> font file. This means you can optimally load web fonts with zero layout shift, thanks to the underlying CSS <code>size-adjust</code> property used.</p> <p>This new font system also allows you to conveniently use all Google Fonts with performance and privacy in mind. CSS and font files are downloaded at build time and self-hosted with the rest of your static assets. <strong>No requests are sent to Google by the browser.</strong></p> <h2 id=\"google-fonts\" data-docs-heading=\"\">Google Fonts     </h2> <p>Automatically self-host any Google Font. Fonts are included in the deployment and served from the same domain as your deployment. <strong>No requests are sent to Google by the browser.</strong></p> <p>Get started by importing the font you would like to use from <code>next/font/google</code> as a function. We recommend using <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable fonts</a> for the best performance and flexibility.</p>  <p>To use the font in all your pages, add it to <a href=\"../routing/custom-app\"><code>_app.js</code> file</a> under <code>/pages</code> as shown below:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'\n \n// If loading a variable font, you don't need to specify the font weight\nconst inter = Inter({ subsets: ['latin'] })\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;main className={inter.className}&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/main&gt;\n  )\n}</pre></div>\n<p>If you can't use a variable font, you will <strong>need to specify a weight</strong>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Roboto } from 'next/font/google'\n \nconst roboto = Roboto({\n  weight: '400',\n  subsets: ['latin'],\n})\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;main className={roboto.className}&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/main&gt;\n  )\n}</pre></div> <p>You can specify multiple weights and/or styles by using an array:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const roboto = Roboto({\n  weight: ['400', '700'],\n  style: ['normal', 'italic'],\n  subsets: ['latin'],\n  display: 'swap',\n})</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Use an underscore (_) for font names with multiple words. E.g. <code>Roboto Mono</code> should be imported as <code>Roboto_Mono</code>.</p> </blockquote> <h3 id=\"apply-the-font-in-head\" data-docs-heading=\"\">Apply the font in &lt;head&gt;     </h3>\n<p>You can also use the font without a wrapper and <code>className</code> by injecting it inside the <code>&lt;head&gt;</code> as follows:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'\n \nconst inter = Inter({ subsets: ['latin'] })\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;&gt;\n      &lt;style jsx global&gt;{`\n        html {\n          font-family: ${inter.style.fontFamily};\n        }\n      `}&lt;/style&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>\n<h3 id=\"single-page-usage\" data-docs-heading=\"\">Single page usage     </h3>\n<p>To use the font on a single page, add it to the specific page as shown below:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'\n \nconst inter = Inter({ subsets: ['latin'] })\n \nexport default function Home() {\n  return (\n    &lt;div className={inter.className}&gt;\n      &lt;p&gt;Hello World&lt;/p&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <h3 id=\"specifying-a-subset\" data-docs-heading=\"\">Specifying a subset     </h3> <p>Google Fonts are automatically <a href=\"https://fonts.google.com/knowledge/glossary/subsetting\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">subset</a>. This reduces the size of the font file and improves performance. You'll need to define which of these subsets you want to preload. Failing to specify any subsets while <a href=\"../../../app/api-reference/components/font#preload\"><code>preload</code></a> is <code>true</code> will result in a warning.</p> <p>This can be done by adding it to the function call:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const inter = Inter({ subsets: ['latin'] })</pre></div> <p>View the <a href=\"../../../app/api-reference/components/font\">Font API Reference</a> for more information.</p> <h3 id=\"using-multiple-fonts\" data-docs-heading=\"\">Using Multiple Fonts     </h3> <p>You can import and use multiple fonts in your application. There are two approaches you can take.</p> <p>The first approach is to create a utility function that exports a font, imports it, and applies its <code>className</code> where needed. This ensures the font is preloaded only when it's rendered:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter, Roboto_Mono } from 'next/font/google'\n \nexport const inter = Inter({\n  subsets: ['latin'],\n  display: 'swap',\n})\n \nexport const roboto_mono = Roboto_Mono({\n  subsets: ['latin'],\n  display: 'swap',\n})</pre></div>   <p>In the example above, <code>Inter</code> will be applied globally, and <code>Roboto Mono</code> can be imported and applied as needed.</p> <p>Alternatively, you can create a <a href=\"../../../app/api-reference/components/font#variable\">CSS variable</a> and use it with your preferred CSS solution:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">html {\n  font-family: var(--font-inter);\n}\n \nh1 {\n  font-family: var(--font-roboto-mono);\n}</pre></div> <p>In the example above, <code>Inter</code> will be applied globally, and any <code>&lt;h1&gt;</code> tags will be styled with <code>Roboto Mono</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: Use multiple fonts conservatively since each new font is an additional resource the client has to download.</p> </blockquote> <h2 id=\"local-fonts\" data-docs-heading=\"\">Local Fonts     </h2> <p>Import <code>next/font/local</code> and specify the <code>src</code> of your local font file. We recommend using <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable fonts</a> for the best performance and flexibility.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import localFont from 'next/font/local'\n \n// Font files can be colocated inside of `pages`\nconst myFont = localFont({ src: './my-font.woff2' })\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;main className={myFont.className}&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/main&gt;\n  )\n}</pre></div> <p>If you want to use multiple files for a single font family, <code>src</code> can be an array:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const roboto = localFont({\n  src: [\n    {\n      path: './Roboto-Regular.woff2',\n      weight: '400',\n      style: 'normal',\n    },\n    {\n      path: './Roboto-Italic.woff2',\n      weight: '400',\n      style: 'italic',\n    },\n    {\n      path: './Roboto-Bold.woff2',\n      weight: '700',\n      style: 'normal',\n    },\n    {\n      path: './Roboto-BoldItalic.woff2',\n      weight: '700',\n      style: 'italic',\n    },\n  ],\n})</pre>\n</div> <p>View the <a href=\"../../../app/api-reference/components/font\">Font API Reference</a> for more information.</p> <h2 id=\"with-tailwind-css\" data-docs-heading=\"\">With Tailwind CSS     </h2> <p><code>next/font</code> can be used with <a href=\"https://tailwindcss.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Tailwind CSS</a> through a <a href=\"../../../app/api-reference/components/font#css-variables\">CSS variable</a>.</p> <p>In the example below, we use the font <code>Inter</code> from <code>next/font/google</code> (you can use any font from Google or Local Fonts). Load your font with the <code>variable</code> option to define your CSS variable name and assign it to <code>inter</code>. Then, use <code>inter.variable</code> to add the CSS variable to your HTML document.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'\n \nconst inter = Inter({\n  subsets: ['latin'],\n  variable: '--font-inter',\n})\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;main className={`${inter.variable} font-sans`}&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/main&gt;\n  )\n}</pre></div> <p>Finally, add the CSS variable to your <a href=\"../../../app/building-your-application/styling/tailwind-css#configuring-tailwind\">Tailwind CSS config</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    './pages/**/*.{js,ts,jsx,tsx}',\n    './components/**/*.{js,ts,jsx,tsx}',\n    './app/**/*.{js,ts,jsx,tsx}',\n  ],\n  theme: {\n    extend: {\n      fontFamily: {\n        sans: ['var(--font-inter)'],\n        mono: ['var(--font-roboto-mono)'],\n      },\n    },\n  },\n  plugins: [],\n}</pre></div> <p>You can now use the <code>font-sans</code> and <code>font-mono</code> utility classes to apply the font to your elements.</p> <h2 id=\"preloading\" data-docs-heading=\"\">Preloading     </h2>  <p>When a font function is called on a page of your site, it is not globally available and preloaded on all routes. Rather, the font is only preloaded on the related route/s based on the type of file where it is used:</p>\n<ul> <li>if it's a <a href=\"../routing/pages-and-layouts\">unique page</a>, it is preloaded on the unique route for that page</li> <li>if it's in the <a href=\"../routing/custom-app\">custom App</a>, it is preloaded on all the routes of the site under <code>/pages</code>\n</li> </ul> <h2 id=\"reusing-fonts\" data-docs-heading=\"\">Reusing fonts     </h2> <p>Every time you call the <code>localFont</code> or Google font function, that font is hosted as one instance in your application. Therefore, if you load the same font function in multiple files, multiple instances of the same font are hosted. In this situation, it is recommended to do the following:</p> <ul> <li>Call the font loader function in one shared file</li> <li>Export it as a constant</li> <li>Import the constant in each file where you would like to use this font</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/fonts\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/fonts</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/scripts":"<h1 class=\"break-words\">Script Optimization</h1>  <h3 id=\"application-scripts\" data-docs-heading=\"\">Application Scripts     </h3>  <p>To load a third-party script for all routes, import <code>next/script</code> and include the script directly in your custom <code>_app</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;&gt;\n      &lt;Component {...pageProps} /&gt;\n      &lt;Script src=\"https://example.com/script.js\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <p>This script will load and execute when <em>any</em> route in your application is accessed. Next.js will ensure the script will <strong>only load once</strong>, even if a user navigates between multiple pages.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: We recommend only including third-party scripts in specific pages or layouts in order to minimize any unnecessary impact to performance.</p> </blockquote> <h3 id=\"strategy\" data-docs-heading=\"\">Strategy     </h3> <p>Although the default behavior of <code>next/script</code> allows you to load third-party scripts in any page or layout, you can fine-tune its loading behavior by using the <code>strategy</code> property:</p> <ul> <li>\n<code>beforeInteractive</code>: Load the script before any Next.js code and before any page hydration occurs.</li> <li>\n<code>afterInteractive</code>: (<strong>default</strong>) Load the script early but after some hydration on the page occurs.</li> <li>\n<code>lazyOnload</code>: Load the script later during browser idle time.</li> <li>\n<code>worker</code>: (experimental) Load the script in a web worker.</li> </ul> <p>Refer to the <a href=\"../../../app/api-reference/components/script#strategy\"><code>next/script</code></a> API reference documentation to learn more about each strategy and their use cases.</p> <h3 id=\"offloading-scripts-to-a-web-worker-experimental\" data-docs-heading=\"\">Offloading Scripts To A Web Worker (Experimental)     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> The <code>worker</code> strategy is not yet stable and does not yet work with the <a href=\"../../../app/building-your-application/routing/defining-routes\"><code>app</code></a> directory. Use with caution.</p> </blockquote> <p>Scripts that use the <code>worker</code> strategy are offloaded and executed in a web worker with <a href=\"https://partytown.builder.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Partytown</a>. This can improve the performance of your site by dedicating the main thread to the rest of your application code.</p> <p>This strategy is still experimental and can only be used if the <code>nextScriptWorkers</code> flag is enabled in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    nextScriptWorkers: true,\n  },\n}</pre></div> <p>Then, run <code>next</code> (normally <code>npm run dev</code> or <code>yarn dev</code>) and Next.js will guide you through the installation of the required packages to finish the setup:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm run dev</pre></div> <p>You'll see instructions like these: Please install Partytown by running <code>npm install @builder.io/partytown</code></p> <p>Once setup is complete, defining <code>strategy=\"worker\"</code> will automatically instantiate Partytown in your application and offload the script to a web worker.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Home() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" strategy=\"worker\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>There are a number of trade-offs that need to be considered when loading a third-party script in a web worker. Please see Partytown's <a href=\"https://partytown.builder.io/trade-offs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">tradeoffs</a> documentation for more information.</p> <h3 id=\"inline-scripts\" data-docs-heading=\"\">Inline Scripts     </h3> <p>Inline scripts, or scripts not loaded from an external file, are also supported by the Script component. They can be written by placing the JavaScript within curly braces:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Script id=\"show-banner\"&gt;\n  {`document.getElementById('banner').classList.remove('hidden')`}\n&lt;/Script&gt;</pre>\n</div> <p>Or by using the <code>dangerouslySetInnerHTML</code> property:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Script\n  id=\"show-banner\"\n  dangerouslySetInnerHTML={{\n    __html: `document.getElementById('banner').classList.remove('hidden')`,\n  }}\n/&gt;</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: An <code>id</code> property must be assigned for inline scripts in order for Next.js to track and optimize the script.</p> </blockquote> <h3 id=\"executing-additional-code\" data-docs-heading=\"\">Executing Additional Code     </h3> <p>Event handlers can be used with the Script component to execute additional code after a certain event occurs:</p> <ul> <li>\n<code>onLoad</code>: Execute code after the script has finished loading.</li> <li>\n<code>onReady</code>: Execute code after the script has finished loading and every time the component is mounted.</li> <li>\n<code>onError</code>: Execute code if the script fails to load.</li> </ul>  <p>These handlers will only work when <code>next/script</code> is imported and used inside of a <a href=\"../../../app/building-your-application/rendering/client-components\">Client Component</a> where <code>\"use client\"</code> is defined as the first line of code:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script\n        src=\"https://example.com/script.js\"\n        onLoad={() =&gt; {\n          console.log('Script has loaded')\n        }}\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>\n<p>Refer to the <a href=\"../../api-reference/components/script#onload\"><code>next/script</code></a> API reference to learn more about each event handler and view examples.</p> <h3 id=\"additional-attributes\" data-docs-heading=\"\">Additional Attributes     </h3> <p>There are many DOM attributes that can be assigned to a <code>&lt;script&gt;</code> element that are not used by the Script component, like <a href=\"https://developer.mozilla.org/docs/Web/HTML/Global_attributes/nonce\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>nonce</code></a> or <a href=\"https://developer.mozilla.org/docs/Web/HTML/Global_attributes/data-*\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">custom data attributes</a>. Including any additional attributes will automatically forward it to the final, optimized <code>&lt;script&gt;</code> element that is included in the HTML.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script\n        src=\"https://example.com/script.js\"\n        id=\"example-script\"\n        nonce=\"XUENAJFW\"\n        data-test=\"script\"\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/scripts\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/scripts</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/static-assets":"<h1 class=\"break-words\">Static Assets</h1> <p>Next.js can serve static files, like images, under a folder called <code>public</code> in the root directory. Files inside <code>public</code> can then be referenced by your code starting from the base URL (<code>/</code>).</p> <p>For example, the file <code>public/avatars/me.png</code> can be viewed by visiting the <code>/avatars/me.png</code> path. The code to display that image might look like:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport function Avatar({ id, alt }) {\n  return &lt;Image src={`/avatars/${id}.png`} alt={alt} width=\"64\" height=\"64\" /&gt;\n}\n \nexport function AvatarOfMe() {\n  return &lt;Avatar id=\"me\" alt=\"A portrait of me\" /&gt;\n}</pre></div> <h2 id=\"caching\" data-docs-heading=\"\">Caching     </h2> <p>Next.js cannot safely cache assets in the <code>public</code> folder because they may change. The default caching headers applied are:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Cache-Control: public, max-age=0</pre>\n</div> <h2 id=\"robots-favicons-and-others\" data-docs-heading=\"\">Robots, Favicons, and others     </h2> <p>The folder is also useful for <code>robots.txt</code>, <code>favicon.ico</code>, Google Site Verification, and any other static files (including <code>.html</code>). But make sure to not have a static file with the same name as a file in the <code>pages/</code> directory, as this will result in an error. <a href=\"../../../messages/conflicting-public-file-page\">Read more</a>.</p>  <blockquote class=\"p-3 text-sm\"> <p>Good to know:</p> <ul> <li>The directory must be named <code>public</code>. The name cannot be changed and it's the only directory used to serve static assets.</li> <li>Only assets that are in the <code>public</code> directory at <a href=\"../../../app/api-reference/next-cli#build\">build time</a> will be served by Next.js. Files added at request time won't be available. We recommend using a third-party service like <a href=\"https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Blob</a> for persistent file storage.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/static-assets\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/static-assets</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/bundle-analyzer":"<h1 class=\"break-words\">Bundle Analyzer</h1>\n<p><a href=\"https://www.npmjs.com/package/@next/bundle-analyzer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@next/bundle-analyzer</code></a> is a plugin for Next.js that helps you manage the size of your JavaScript modules. It generates a visual report of the size of each module and their dependencies. You can use the information to remove large dependencies, split your code, or only load some parts when needed, reducing the amount of data transferred to the client.</p> <h2 id=\"installation\" data-docs-heading=\"\">Installation     </h2> <p>Install the plugin by running the following command:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i @next/bundle-analyzer\n# or\nyarn add @next/bundle-analyzer\n# or\npnpm add @next/bundle-analyzer</pre>\n</div> <p>Then, add the bundle analyzer's settings to your <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const withBundleAnalyzer = require('@next/bundle-analyzer')({\n  enabled: process.env.ANALYZE === 'true',\n})\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {}\n \nmodule.exports = withBundleAnalyzer(nextConfig)</pre></div> <h2 id=\"analyzing-your-bundles\" data-docs-heading=\"\">Analyzing your bundles     </h2> <p>Run the following command to analyze your bundles:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">ANALYZE=true npm run build\n# or\nANALYZE=true yarn build\n# or\nANALYZE=true pnpm build</pre>\n</div> <p>The report will open three new tabs in your browser, which you can inspect. Doing this regularly while you develop and before deploying your site can help you identify large bundles earlier, and architect your application to be more performant.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/bundle-analyzer\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/bundle-analyzer</a>\n  </p>\n</div>\n","pages/building-your-application/styling/css-in-js":"<h1 class=\"break-words\">CSS-in-JS</h1>  <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-styled-jsx\" rel=\"noopener noreferrer\" target=\"_blank\">Styled JSX</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-styled-components\" rel=\"noopener noreferrer\" target=\"_blank\">Styled Components</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-emotion\" rel=\"noopener noreferrer\" target=\"_blank\">Emotion</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-linaria\" rel=\"noopener noreferrer\" target=\"_blank\">Linaria</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-styletron\" rel=\"noopener noreferrer\" target=\"_blank\">Styletron</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-cxs\" rel=\"noopener noreferrer\" target=\"_blank\">Cxs</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-fela\" rel=\"noopener noreferrer\" target=\"_blank\">Fela</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-stitches\" rel=\"noopener noreferrer\" target=\"_blank\">Stitches</a></li> </ul></details><p>It's possible to use any existing CSS-in-JS solution. The simplest one is inline styles:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function HiThere() {\n  return &lt;p style={{ color: 'red' }}&gt;hi there&lt;/p&gt;\n}\n \nexport default HiThere</pre>\n</div>\n<p>We bundle <a href=\"https://github.com/vercel/styled-jsx\" rel=\"noopener noreferrer\" target=\"_blank\">styled-jsx</a> to provide support for isolated scoped CSS. The aim is to support \"shadow CSS\" similar to Web Components, which unfortunately <a href=\"https://github.com/w3c/webcomponents/issues/71\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">do not support server-rendering and are JS-only</a>.</p>\n<p>See the above examples for other popular CSS-in-JS solutions (like Styled Components).</p>\n<p>A component using <code>styled-jsx</code> looks like this:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function HelloWorld() {\n  return (\n    &lt;div&gt;\n      Hello world\n      &lt;p&gt;scoped!&lt;/p&gt;\n      &lt;style jsx&gt;{`\n        p {\n          color: blue;\n        }\n        div {\n          background: red;\n        }\n        @media (max-width: 600px) {\n          div {\n            background: blue;\n          }\n        }\n      `}&lt;/style&gt;\n      &lt;style global jsx&gt;{`\n        body {\n          background: black;\n        }\n      `}&lt;/style&gt;\n    &lt;/div&gt;\n  )\n}\n \nexport default HelloWorld</pre>\n</div>\n<p>Please see the <a href=\"https://github.com/vercel/styled-jsx\" rel=\"noopener noreferrer\" target=\"_blank\">styled-jsx documentation</a> for more examples.</p>\n<h3 id=\"disabling-javascript\" data-docs-heading=\"\">Disabling JavaScript     </h3>\n<p>Yes, if you disable JavaScript the CSS will still be loaded in the production build (<code>next start</code>). During development, we require JavaScript to be enabled to provide the best developer experience with <a href=\"https://nextjs.org/blog/next-9-4#fast-refresh\" rel=\"noopener noreferrer\" target=\"_blank\">Fast Refresh</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/styling/css-in-js\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/styling/css-in-js</a>\n  </p>\n</div>\n","pages/building-your-application/styling/sass":"<h1 class=\"break-words\">Sass</h1> <p>Next.js has built-in support for integrating with Sass after the package is installed using both the <code>.scss</code> and <code>.sass</code> extensions. You can use component-level Sass via CSS Modules and the <code>.module.scss</code>or <code>.module.sass</code> extension.</p> <p>First, install <a href=\"https://github.com/sass/sass\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>sass</code></a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install --save-dev sass</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <p>Sass supports <a href=\"https://sass-lang.com/documentation/syntax\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">two different syntaxes</a>, each with their own extension. The <code>.scss</code> extension requires you use the <a href=\"https://sass-lang.com/documentation/syntax#scss\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SCSS syntax</a>, while the <code>.sass</code> extension requires you use the <a href=\"https://sass-lang.com/documentation/syntax#the-indented-syntax\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Indented Syntax (\"Sass\")</a>.</p> <p>If you're not sure which to choose, start with the <code>.scss</code> extension which is a superset of CSS, and doesn't require you learn the Indented Syntax (\"Sass\").</p> </blockquote> <h3 id=\"customizing-sass-options\" data-docs-heading=\"\">Customizing Sass Options     </h3> <p>If you want to configure the Sass compiler, use <code>sassOptions</code> in <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const path = require('path')\n \nmodule.exports = {\n  sassOptions: {\n    includePaths: [path.join(__dirname, 'styles')],\n  },\n}</pre></div> <h3 id=\"sass-variables\" data-docs-heading=\"\">Sass Variables     </h3> <p>Next.js supports Sass variables exported from CSS Module files.</p> <p>For example, using the exported <code>primaryColor</code> Sass variable:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">$primary-color: #64ff00;\n \n:export {\n  primaryColor: $primary-color;\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import variables from '../styles/variables.module.scss'\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;Layout color={variables.primaryColor}&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/Layout&gt;\n  )\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/styling/sass\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/styling/sass</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/analytics":"<h1 class=\"break-words\">Analytics</h1> <p>Next.js has built-in support for measuring and reporting performance metrics. You can either use the <code>useReportWebVitals</code> hook to manage reporting yourself, or alternatively, Vercel provides a <a href=\"https://vercel.com/analytics?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">managed service</a> to automatically collect and visualize metrics for you.</p> <h2 id=\"build-your-own\" data-docs-heading=\"\">Build Your Own     </h2> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useReportWebVitals } from 'next/web-vitals'\n \nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals((metric) =&gt; {\n    console.log(metric)\n  })\n \n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>\n<p>View the <a href=\"../../api-reference/functions/use-report-web-vitals\">API Reference</a> for more information.</p>  <h2 id=\"web-vitals\" data-docs-heading=\"\">Web Vitals     </h2> <p><a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Vitals</a> are a set of useful metrics that aim to capture the user experience of a web page. The following web vitals are all included:</p> <ul> <li>\n<a href=\"https://developer.mozilla.org/docs/Glossary/Time_to_first_byte\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Time to First Byte</a> (TTFB)</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Glossary/First_contentful_paint\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Contentful Paint</a> (FCP)</li> <li>\n<a href=\"https://web.dev/lcp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Largest Contentful Paint</a> (LCP)</li> <li>\n<a href=\"https://web.dev/fid/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Input Delay</a> (FID)</li> <li>\n<a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a> (CLS)</li> <li>\n<a href=\"https://web.dev/inp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Interaction to Next Paint</a> (INP)</li> </ul> <p>You can handle all the results of these metrics using the <code>name</code> property.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useReportWebVitals } from 'next/web-vitals'\n \nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals((metric) =&gt; {\n    switch (metric.name) {\n      case 'FCP': {\n        // handle FCP results\n      }\n      case 'LCP': {\n        // handle LCP results\n      }\n      // ...\n    }\n  })\n \n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>  <h2 id=\"custom-metrics\" data-docs-heading=\"\">Custom Metrics     </h2>\n<p>In addition to the core metrics listed above, there are some additional custom metrics that measure the time it takes for the page to hydrate and render:</p>\n<ul> <li>\n<code>Next.js-hydration</code>: Length of time it takes for the page to start and finish hydrating (in ms)</li> <li>\n<code>Next.js-route-change-to-render</code>: Length of time it takes for a page to start rendering after a route change (in ms)</li> <li>\n<code>Next.js-render</code>: Length of time it takes for a page to finish render after a route change (in ms)</li> </ul>\n<p>You can handle all the results of these metrics separately:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function reportWebVitals(metric) {\n  switch (metric.name) {\n    case 'Next.js-hydration':\n      // handle hydration results\n      break\n    case 'Next.js-route-change-to-render':\n      // handle route-change to render results\n      break\n    case 'Next.js-render':\n      // handle render results\n      break\n    default:\n      break\n  }\n}</pre>\n</div>\n<p>These metrics work in all browsers that support the <a href=\"https://caniuse.com/#feat=user-timing\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">User Timing API</a>.</p> <h2 id=\"sending-results-to-external-systems\" data-docs-heading=\"\">Sending results to external systems     </h2> <p>You can send results to any endpoint to measure and track real user performance on your site. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useReportWebVitals((metric) =&gt; {\n  const body = JSON.stringify(metric)\n  const url = 'https://example.com/analytics'\n \n  // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.\n  if (navigator.sendBeacon) {\n    navigator.sendBeacon(url, body)\n  } else {\n    fetch(url, { body, method: 'POST', keepalive: true })\n  }\n})</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you use <a href=\"https://analytics.google.com/analytics/web/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Analytics</a>, using the <code>id</code> value can allow you to construct metric distributions manually (to calculate percentiles, etc.)</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useReportWebVitals((metric) =&gt; {\n  // Use `window.gtag` if you initialized Google Analytics as this example:\n  // https://github.com/vercel/next.js/blob/canary/examples/with-google-analytics/pages/_app.js\n  window.gtag('event', metric.name, {\n    value: Math.round(\n      metric.name === 'CLS' ? metric.value * 1000 : metric.value\n    ), // values must be integers\n    event_label: metric.id, // id unique to current page load\n    non_interaction: true, // avoids affecting bounce rate.\n  })\n})</pre>\n</div> <p>Read more about <a href=\"https://github.com/GoogleChrome/web-vitals#send-the-results-to-google-analytics\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">sending results to Google Analytics</a>.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/analytics\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/analytics</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/lazy-loading":"<h1 class=\"break-words\">Lazy Loading</h1> <p><a href=\"https://developer.mozilla.org/docs/Web/Performance/Lazy_loading\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Lazy loading</a> in Next.js helps improve the initial loading performance of an application by decreasing the amount of JavaScript needed to render a route.</p> <p>It allows you to defer loading of <strong>Client Components</strong> and imported libraries, and only include them in the client bundle when they're needed. For example, you might want to defer loading a modal until a user clicks to open it.</p> <p>There are two ways you can implement lazy loading in Next.js:</p> <ol> <li>Using <a href=\"#nextdynamic\">Dynamic Imports</a> with <code>next/dynamic</code>\n</li> <li>Using <a href=\"https://react.dev/reference/react/lazy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>React.lazy()</code></a> with <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Suspense</a>\n</li> </ol> <p>By default, Server Components are automatically <a href=\"https://developer.mozilla.org/docs/Glossary/Code_splitting\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">code split</a>, and you can use <a href=\"../../../app/building-your-application/routing/loading-ui-and-streaming\">streaming</a> to progressively send pieces of UI from the server to the client. Lazy loading applies to Client Components.</p> <h2 id=\"nextdynamic\" data-docs-heading=\"\">next/dynamic     </h2> <p><code>next/dynamic</code> is a composite of <a href=\"https://react.dev/reference/react/lazy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>React.lazy()</code></a> and <a href=\"https://react.dev/reference/react/Suspense\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Suspense</a>. It behaves the same way in the <code>app</code> and <code>pages</code> directories to allow for incremental migration.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2>  <p>By using <code>next/dynamic</code>, the header component will not be included in the page's initial JavaScript bundle. The page will render the Suspense <code>fallback</code> first, followed by the <code>Header</code> component when the <code>Suspense</code> boundary is resolved.</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst DynamicHeader = dynamic(() =&gt; import('../components/header'), {\n  loading: () =&gt; &lt;p&gt;Loading...&lt;/p&gt;,\n})\n \nexport default function Home() {\n  return &lt;DynamicHeader /&gt;\n}</pre>\n</div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: In <code>import('path/to/component')</code>, the path must be explicitly written. It can't be a template string nor a variable. Furthermore the <code>import()</code> has to be inside the <code>dynamic()</code> call for Next.js to be able to match webpack bundles / module ids to the specific <code>dynamic()</code> call and preload them before rendering. <code>dynamic()</code> can't be used inside of React rendering as it needs to be marked in the top level of the module for preloading to work, similar to <code>React.lazy</code>.</p> </blockquote>\n<h2 id=\"with-named-exports\" data-docs-heading=\"\">With named exports     </h2>\n<p>To dynamically import a named export, you can return it from the <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Promise</a> returned by <a href=\"https://github.com/tc39/proposal-dynamic-import#example\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>import()</code></a>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function Hello() {\n  return &lt;p&gt;Hello!&lt;/p&gt;\n}\n \n// pages/index.js\nimport dynamic from 'next/dynamic'\n \nconst DynamicComponent = dynamic(() =&gt;\n  import('../components/hello').then((mod) =&gt; mod.Hello)\n)</pre></div>\n<h2 id=\"with-no-ssr\" data-docs-heading=\"\">With no SSR     </h2>\n<p>To dynamically load a component on the client side, you can use the <code>ssr</code> option to disable server-rendering. This is useful if an external dependency or component relies on browser APIs like <code>window</code>.</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst DynamicHeader = dynamic(() =&gt; import('../components/header'), {\n  ssr: false,\n})</pre>\n</div>\n<h2 id=\"with-external-libraries\" data-docs-heading=\"\">With external libraries     </h2>\n<p>This example uses the external library <code>fuse.js</code> for fuzzy search. The module is only loaded in the browser after the user types in the search input.</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useState } from 'react'\n \nconst names = ['Tim', 'Joe', 'Bel', 'Lee']\n \nexport default function Page() {\n  const [results, setResults] = useState()\n \n  return (\n    &lt;div&gt;\n      &lt;input\n        type=\"text\"\n        placeholder=\"Search\"\n        onChange={async (e) =&gt; {\n          const { value } = e.currentTarget\n          // Dynamically load fuse.js\n          const Fuse = (await import('fuse.js')).default\n          const fuse = new Fuse(names)\n \n          setResults(fuse.search(value))\n        }}\n      /&gt;\n      &lt;pre&gt;Results: {JSON.stringify(results, null, 2)}&lt;/pre&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/lazy-loading\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/lazy-loading</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/typescript":"<h1 class=\"break-words\">TypeScript</h1> <p>Next.js provides a TypeScript-first development experience for building your React application.</p> <p>It comes with built-in TypeScript support for automatically installing the necessary packages and configuring the proper settings.</p>  <h2 id=\"new-projects\" data-docs-heading=\"\">New Projects     </h2> <p><code>create-next-app</code> now ships with TypeScript by default.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest</pre></div> <h2 id=\"existing-projects\" data-docs-heading=\"\">Existing Projects     </h2> <p>Add TypeScript to your project by renaming a file to <code>.ts</code> / <code>.tsx</code>. Run <code>next dev</code> and <code>next build</code> to automatically install the necessary dependencies and add a <code>tsconfig.json</code> file with the recommended config options.</p> <p>If you already had a <code>jsconfig.json</code> file, copy the <code>paths</code> compiler option from the old <code>jsconfig.json</code> into the new <code>tsconfig.json</code> file, and delete the old <code>jsconfig.json</code> file.</p>  <h2 id=\"minimum-typescript-version\" data-docs-heading=\"\">Minimum TypeScript Version     </h2> <p>It is highly recommended to be on at least <code>v4.5.2</code> of TypeScript to get syntax features such as <a href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-4-5/#type-on-import-names\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">type modifiers on import names</a> and <a href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-4-5/#real-path-sync-native\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">performance improvements</a>.</p>  <h2 id=\"static-generation-and-server-side-rendering\" data-docs-heading=\"\">Static Generation and Server-side Rendering     </h2>\n<p>For <a href=\"../../api-reference/functions/get-static-props\"><code>getStaticProps</code></a>, <a href=\"../../api-reference/functions/get-static-paths\"><code>getStaticPaths</code></a>, and <a href=\"../../api-reference/functions/get-server-side-props\"><code>getServerSideProps</code></a>, you can use the <code>GetStaticProps</code>, <code>GetStaticPaths</code>, and <code>GetServerSideProps</code> types respectively:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GetStaticProps, GetStaticPaths, GetServerSideProps } from 'next'\n \nexport const getStaticProps = (async (context) =&gt; {\n  // ...\n}) satisfies GetStaticProps\n \nexport const getStaticPaths = (async () =&gt; {\n  // ...\n}) satisfies GetStaticPaths\n \nexport const getServerSideProps = (async (context) =&gt; {\n  // ...\n}) satisfies GetServerSideProps</pre></div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> <code>satisfies</code> was added to TypeScript in <a href=\"https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-9.html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">4.9</a>. We recommend upgrading to the latest version of TypeScript.</p> </blockquote>\n<h2 id=\"api-routes\" data-docs-heading=\"\">API Routes     </h2>\n<p>The following is an example of how to use the built-in types for API routes:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  res.status(200).json({ name: 'John Doe' })\n}</pre>\n</div>\n<p>You can also type the response data:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \ntype Data = {\n  name: string\n}\n \nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse&lt;Data&gt;\n) {\n  res.status(200).json({ name: 'John Doe' })\n}</pre>\n</div>\n<h2 id=\"custom-app\" data-docs-heading=\"\">Custom App     </h2>\n<p>If you have a <a href=\"../routing/custom-app\">custom <code>App</code></a>, you can use the built-in type <code>AppProps</code> and change file name to <code>./pages/_app.tsx</code> like so:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { AppProps } from 'next/app'\n \nexport default function MyApp({ Component, pageProps }: AppProps) {\n  return &lt;Component {...pageProps} /&gt;\n}</pre>\n</div> <h2 id=\"path-aliases-and-baseurl\" data-docs-heading=\"\">Path aliases and baseUrl     </h2> <p>Next.js automatically supports the <code>tsconfig.json</code> <code>\"paths\"</code> and <code>\"baseUrl\"</code> options.</p>  <p>You can learn more about this feature on the <a href=\"absolute-imports-and-module-aliases\">Module Path aliases documentation</a>.</p> <h2 id=\"type-checking-nextconfigjs\" data-docs-heading=\"\">Type checking next.config.js     </h2> <p>The <code>next.config.js</code> file must be a JavaScript file as it does not get parsed by Babel or TypeScript, however you can add some type checking in your IDE using JSDoc as below:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \n/**\n * @type {import('next').NextConfig}\n **/\nconst nextConfig = {\n  /* config options here */\n}\n \nmodule.exports = nextConfig</pre>\n</div> <h2 id=\"incremental-type-checking\" data-docs-heading=\"\">Incremental type checking     </h2> <p>Since <code>v10.2.1</code> Next.js supports <a href=\"https://www.typescriptlang.org/tsconfig#incremental\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">incremental type checking</a> when enabled in your <code>tsconfig.json</code>, this can help speed up type checking in larger applications.</p> <h2 id=\"ignoring-typescript-errors\" data-docs-heading=\"\">Ignoring TypeScript Errors     </h2> <p>Next.js fails your <strong>production build</strong> (<code>next build</code>) when TypeScript errors are present in your project.</p> <p>If you'd like Next.js to dangerously produce production code even when your application has errors, you can disable the built-in type checking step.</p> <p>If disabled, be sure you are running type checks as part of your build or deploy process, otherwise this can be very dangerous.</p> <p>Open <code>next.config.js</code> and enable the <code>ignoreBuildErrors</code> option in the <code>typescript</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  typescript: {\n    // !! WARN !!\n    // Dangerously allow production builds to successfully complete even if\n    // your project has type errors.\n    // !! WARN !!\n    ignoreBuildErrors: true,\n  },\n}</pre></div> <h2 id=\"custom-type-declarations\" data-docs-heading=\"\">Custom Type Declarations     </h2> <p>When you need to declare custom types, you might be tempted to modify <code>next-env.d.ts</code>. However, this file is automatically generated, so any changes you make will be overwritten. Instead, you should create a new file, let's call it <code>new-types.d.ts</code>, and reference it in your <code>tsconfig.json</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"skipLibCheck\": true\n    //...truncated...\n  },\n  \"include\": [\n    \"new-types.d.ts\",\n    \"next-env.d.ts\",\n    \".next/types/**/*.ts\",\n    \"**/*.ts\",\n    \"**/*.tsx\"\n  ],\n  \"exclude\": [\"node_modules\"]\n}</pre></div> <h2 id=\"version-changes\" data-docs-heading=\"\">Version Changes     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>Statically typed links are available in beta.</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>\n<a href=\"../../../architecture/nextjs-compiler\">SWC</a> is now used by default to compile TypeScript and TSX for faster builds.</td>\n</tr>\n<tr>\n<td><code>v10.2.1</code></td>\n<td>\n<a href=\"https://www.typescriptlang.org/tsconfig#incremental\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Incremental type checking</a> support added when enabled in your <code>tsconfig.json</code>.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/typescript\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/typescript</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/environment-variables":"<h1 class=\"break-words\">Environment Variables</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/environment-variables\" rel=\"noopener noreferrer\" target=\"_blank\">Environment Variables</a></li> </ul></details> <p>Next.js comes with built-in support for environment variables, which allows you to do the following:</p> <ul> <li><a href=\"#loading-environment-variables\">Use <code>.env.local</code> to load environment variables</a></li> <li><a href=\"#bundling-environment-variables-for-the-browser\">Bundle environment variables for the browser by prefixing with <code>NEXT_PUBLIC_</code></a></li> </ul> <h2 id=\"loading-environment-variables\" data-docs-heading=\"\">Loading Environment Variables     </h2> <p>Next.js has built-in support for loading environment variables from <code>.env.local</code> into <code>process.env</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">DB_HOST=localhost\nDB_USER=myuser\nDB_PASS=mypassword</pre></div> <p>This loads <code>process.env.DB_HOST</code>, <code>process.env.DB_USER</code>, and <code>process.env.DB_PASS</code> into the Node.js environment automatically allowing you to use them in <a href=\"../data-fetching\">Next.js data fetching methods</a> and <a href=\"../routing/api-routes\">API routes</a>.</p>\n<p>For example, using <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps() {\n  const db = await myDB.connect({\n    host: process.env.DB_HOST,\n    username: process.env.DB_USER,\n    password: process.env.DB_PASS,\n  })\n  // ...\n}</pre></div>  <h3 id=\"referencing-other-variables\" data-docs-heading=\"\">Referencing Other Variables     </h3> <p>Next.js will automatically expand variables that use <code>$</code> to reference other variables e.g. <code>$VARIABLE</code> inside of your <code>.env*</code> files. This allows you to reference other secrets. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">TWITTER_USER=nextjs\nTWITTER_URL=https://twitter.com/$TWITTER_USER</pre></div> <p>In the above example, <code>process.env.TWITTER_URL</code> would be set to <code>https://twitter.com/nextjs</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you need to use variable with a <code>$</code> in the actual value, it needs to be escaped e.g. <code>\\$</code>.</p> </blockquote> <h2 id=\"bundling-environment-variables-for-the-browser\" data-docs-heading=\"\">Bundling Environment Variables for the Browser     </h2> <p>Non-<code>NEXT_PUBLIC_</code> environment variables are only available in the Node.js environment, meaning they aren't accessible to the browser (the client runs in a different <em>environment</em>).</p> <p>In order to make the value of an environment variable accessible in the browser, Next.js can \"inline\" a value, at build time, into the js bundle that is delivered to the client, replacing all references to <code>process.env.[variable]</code> with a hard-coded value. To tell it to do this, you just have to prefix the variable with <code>NEXT_PUBLIC_</code>. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">NEXT_PUBLIC_ANALYTICS_ID=abcdefghijk</pre></div> <p>This will tell Next.js to replace all references to <code>process.env.NEXT_PUBLIC_ANALYTICS_ID</code> in the Node.js environment with the value from the environment in which you run <code>next build</code>, allowing you to use it anywhere in your code. It will be inlined into any JavaScript sent to the browser.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: After being built, your app will no longer respond to changes to these environment variables. For instance, if you use a Heroku pipeline to promote slugs built in one environment to another environment, or if you build and deploy a single Docker image to multiple environments, all <code>NEXT_PUBLIC_</code> variables will be frozen with the value evaluated at build time, so these values need to be set appropriately when the project is built. If you need access to runtime environment values, you'll have to setup your own API to provide them to the client (either on demand or during initialization).</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import setupAnalyticsService from '../lib/my-analytics-service'\n \n// 'NEXT_PUBLIC_ANALYTICS_ID' can be used here as it's prefixed by 'NEXT_PUBLIC_'.\n// It will be transformed at build time to `setupAnalyticsService('abcdefghijk')`.\nsetupAnalyticsService(process.env.NEXT_PUBLIC_ANALYTICS_ID)\n \nfunction HomePage() {\n  return &lt;h1&gt;Hello World&lt;/h1&gt;\n}\n \nexport default HomePage</pre></div> <p>Note that dynamic lookups will <em>not</em> be inlined, such as:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// This will NOT be inlined, because it uses a variable\nconst varName = 'NEXT_PUBLIC_ANALYTICS_ID'\nsetupAnalyticsService(process.env[varName])\n \n// This will NOT be inlined, because it uses a variable\nconst env = process.env\nsetupAnalyticsService(env.NEXT_PUBLIC_ANALYTICS_ID)</pre>\n</div> <h3 id=\"runtime-environment-variables\" data-docs-heading=\"\">Runtime Environment Variables     </h3> <p>Next.js can support both build time and runtime environment variables.</p> <p><strong>By default, environment variables are only available on the server</strong>. To expose an environment variable to the browser, it must be prefixed with <code>NEXT_PUBLIC_</code>. However, these public environment variables will be inlined into the JavaScript bundle during <code>next build</code>.</p> <p>To read runtime environment variables, we recommend using <code>getServerSideProps</code> or <a href=\"../../../app/building-your-application/upgrading/app-router-migration\">incrementally adopting the App Router</a>. With the App Router, we can safely read environment variables on the server during dynamic rendering. This allows you to use a singular Docker image that can be promoted through multiple environments with different values.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { unstable_noStore as noStore } from 'next/cache'\n \nexport default function Component() {\n  noStore()\n  // cookies(), headers(), and other dynamic functions\n  // will also opt into dynamic rendering, meaning\n  // this env variable is evaluated at runtime\n  const value = process.env.MY_VALUE\n  // ...\n}</pre>\n</div> <p><strong>Good to know:</strong></p> <ul> <li>You can run code on server startup using the <a href=\"../../../app/building-your-application/optimizing/instrumentation\"><code>register</code> function</a>.</li> <li>We do not recommend using the <a href=\"../../api-reference/next-config-js/runtime-configuration\">runtimeConfig</a> option, as this does not work with the standalone output mode. Instead, we recommend <a href=\"../../../app/building-your-application/upgrading/app-router-migration\">incrementally adopting</a> the App Router.</li> </ul> <h2 id=\"default-environment-variables\" data-docs-heading=\"\">Default Environment Variables     </h2> <p>In general only one <code>.env.local</code> file is needed. However, sometimes you might want to add some defaults for the <code>development</code> (<code>next dev</code>) or <code>production</code> (<code>next start</code>) environment.</p> <p>Next.js allows you to set defaults in <code>.env</code> (all environments), <code>.env.development</code> (development environment), and <code>.env.production</code> (production environment).</p> <p><code>.env.local</code> always overrides the defaults set.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.env</code>, <code>.env.development</code>, and <code>.env.production</code> files should be included in your repository as they define defaults. <strong><code>.env*.local</code> should be added to <code>.gitignore</code></strong>, as those files are intended to be ignored. <code>.env.local</code> is where secrets can be stored.</p> </blockquote> <h2 id=\"environment-variables-on-vercel\" data-docs-heading=\"\">Environment Variables on Vercel     </h2> <p>When deploying your Next.js application to <a href=\"https://vercel.com\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, Environment Variables can be configured <a href=\"https://vercel.com/docs/projects/environment-variables?utm_medium=docs&amp;utm_source=next-site&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">in the Project Settings</a>.</p> <p>All types of Environment Variables should be configured there. Even Environment Variables used in Development  which can be <a href=\"https://vercel.com/docs/concepts/projects/environment-variables#development-environment-variables?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">downloaded onto your local device</a> afterwards.</p> <p>If you've configured <a href=\"https://vercel.com/docs/concepts/projects/environment-variables#development-environment-variables?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Development Environment Variables</a> you can pull them into a <code>.env.local</code> for usage on your local machine using the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">vercel env pull .env.local</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: When deploying your Next.js application to <a href=\"https://vercel.com\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, your environment variables in <code>.env*</code> files will not be made available to Edge Runtime, unless their name are prefixed with <code>NEXT_PUBLIC_</code>. We strongly recommend managing your environment variables in <a href=\"https://vercel.com/docs/projects/environment-variables?utm_medium=docs&amp;utm_source=next-site&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Project Settings</a> instead, from where all environment variables are available.</p> </blockquote> <h2 id=\"test-environment-variables\" data-docs-heading=\"\">Test Environment Variables     </h2> <p>Apart from <code>development</code> and <code>production</code> environments, there is a 3rd option available: <code>test</code>. In the same way you can set defaults for development or production environments, you can do the same with a <code>.env.test</code> file for the <code>testing</code> environment (though this one is not as common as the previous two). Next.js will not load environment variables from <code>.env.development</code> or <code>.env.production</code> in the <code>testing</code> environment.</p> <p>This one is useful when running tests with tools like <code>jest</code> or <code>cypress</code> where you need to set specific environment vars only for testing purposes. Test default values will be loaded if <code>NODE_ENV</code> is set to <code>test</code>, though you usually don't need to do this manually as testing tools will address it for you.</p> <p>There is a small difference between <code>test</code> environment, and both <code>development</code> and <code>production</code> that you need to bear in mind: <code>.env.local</code> won't be loaded, as you expect tests to produce the same results for everyone. This way every test execution will use the same env defaults across different executions by ignoring your <code>.env.local</code> (which is intended to override the default set).</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: similar to Default Environment Variables, <code>.env.test</code> file should be included in your repository, but <code>.env.test.local</code> shouldn't, as <code>.env*.local</code> are intended to be ignored through <code>.gitignore</code>.</p> </blockquote> <p>While running unit tests you can make sure to load your environment variables the same way Next.js does by leveraging the <code>loadEnvConfig</code> function from the <code>@next/env</code> package.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// The below can be used in a Jest global setup file or similar for your testing set-up\nimport { loadEnvConfig } from '@next/env'\n \nexport default async () =&gt; {\n  const projectDir = process.cwd()\n  loadEnvConfig(projectDir)\n}</pre>\n</div> <h2 id=\"environment-variable-load-order\" data-docs-heading=\"\">Environment Variable Load Order     </h2> <p>Environment variables are looked up in the following places, in order, stopping once the variable is found.</p> <ol> <li><code>process.env</code></li> <li><code>.env.$(NODE_ENV).local</code></li> <li>\n<code>.env.local</code> (Not checked when <code>NODE_ENV</code> is <code>test</code>.)</li> <li><code>.env.$(NODE_ENV)</code></li> <li><code>.env</code></li> </ol> <p>For example, if <code>NODE_ENV</code> is <code>development</code> and you define a variable in both <code>.env.development.local</code> and <code>.env</code>, the value in <code>.env.development.local</code> will be used.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The allowed values for <code>NODE_ENV</code> are <code>production</code>, <code>development</code> and <code>test</code>.</p> </blockquote> <h2 id=\"good-to-know\" data-docs-heading=\"\">Good to know     </h2> <ul> <li>If you are using a <a href=\"../../../app/building-your-application/configuring/src-directory\"><code>/src</code> directory</a>, <code>.env.*</code> files should remain in the root of your project.</li> <li>If the environment variable <code>NODE_ENV</code> is unassigned, Next.js automatically assigns <code>development</code> when running the <code>next dev</code> command, or <code>production</code> for all other commands.</li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v9.4.0</code></td>\n<td>Support <code>.env</code> and <code>NEXT_PUBLIC_</code> introduced.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/environment-variables\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/environment-variables</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/absolute-imports-and-module-aliases":"<h1 class=\"break-words\">Absolute Imports and Module Path Aliases</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-absolute-imports\" rel=\"noopener noreferrer\" target=\"_blank\">Absolute Imports and Aliases</a></li> </ul></details> <p>Next.js has in-built support for the <code>\"paths\"</code> and <code>\"baseUrl\"</code> options of <code>tsconfig.json</code> and <code>jsconfig.json</code> files.</p> <p>These options allow you to alias project directories to absolute paths, making it easier to import modules. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// before\nimport { Button } from '../../../components/button'\n \n// after\nimport { Button } from '@/components/button'</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>create-next-app</code> will prompt to configure these options for you.</p> </blockquote> <h2 id=\"absolute-imports\" data-docs-heading=\"\">Absolute Imports     </h2> <p>The <code>baseUrl</code> configuration option allows you to import directly from the root of the project.</p> <p>An example of this configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"baseUrl\": \".\"\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Button() {\n  return &lt;button&gt;Click me&lt;/button&gt;\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Button from 'components/button'\n \nexport default function HomePage() {\n  return (\n    &lt;&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n      &lt;Button /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h2 id=\"module-aliases\" data-docs-heading=\"\">Module Aliases     </h2> <p>In addition to configuring the <code>baseUrl</code> path, you can use the <code>\"paths\"</code> option to \"alias\" module paths.</p> <p>For example, the following configuration maps <code>@/components/*</code> to <code>components/*</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/components/*\": [\"components/*\"]\n    }\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Button() {\n  return &lt;button&gt;Click me&lt;/button&gt;\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Button from '@/components/button'\n \nexport default function HomePage() {\n  return (\n    &lt;&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n      &lt;Button /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p>Each of the <code>\"paths\"</code> are relative to the <code>baseUrl</code> location. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// tsconfig.json or jsconfig.json\n{\n  \"compilerOptions\": {\n    \"baseUrl\": \"src/\",\n    \"paths\": {\n      \"@/styles/*\": [\"styles/*\"],\n      \"@/components/*\": [\"components/*\"]\n    }\n  }\n}</pre>\n</div> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// pages/index.js\nimport Button from '@/components/button'\nimport '@/styles/styles.css'\nimport Helper from 'utils/helper'\n \nexport default function HomePage() {\n  return (\n    &lt;Helper&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n      &lt;Button /&gt;\n    &lt;/Helper&gt;\n  )\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/absolute-imports-and-module-aliases\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/absolute-imports-and-module-aliases</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/open-telemetry":"<h1 class=\"break-words\">OpenTelemetry</h1> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This feature is <strong>experimental</strong>, you need to explicitly opt-in by providing <code>experimental.instrumentationHook = true;</code> in your <code>next.config.js</code>.</p> </blockquote> <p>Observability is crucial for understanding and optimizing the behavior and performance of your Next.js app.</p> <p>As applications become more complex, it becomes increasingly difficult to identify and diagnose issues that may arise. By leveraging observability tools, such as logging and metrics, developers can gain insights into their application's behavior and identify areas for optimization. With observability, developers can proactively address issues before they become major problems and provide a better user experience. Therefore, it is highly recommended to use observability in your Next.js applications to improve performance, optimize resources, and enhance user experience.</p> <p>We recommend using OpenTelemetry for instrumenting your apps. It's a platform-agnostic way to instrument apps that allows you to change your observability provider without changing your code. Read <a href=\"https://opentelemetry.io/docs/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Official OpenTelemetry docs</a> for more information about OpenTelemetry and how it works.</p> <p>This documentation uses terms like <em>Span</em>, <em>Trace</em> or <em>Exporter</em> throughout this doc, all of which can be found in <a href=\"https://opentelemetry.io/docs/concepts/observability-primer/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">the OpenTelemetry Observability Primer</a>.</p> <p>Next.js supports OpenTelemetry instrumentation out of the box, which means that we already instrumented Next.js itself. When you enable OpenTelemetry we will automatically wrap all your code like <code>getStaticProps</code> in <em>spans</em> with helpful attributes.</p> <h2 id=\"getting-started\" data-docs-heading=\"\">Getting Started     </h2> <p>OpenTelemetry is extensible but setting it up properly can be quite verbose. That's why we prepared a package <code>@vercel/otel</code> that helps you get started quickly.</p> <h3 id=\"using-vercelotel\" data-docs-heading=\"\">Using @vercel/otel     </h3> <p>To get started, you must install <code>@vercel/otel</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @vercel/otel</pre></div>  <p>Next, create a custom <a href=\"instrumentation\"><code>instrumentation.ts</code></a> (or <code>.js</code>) file in the <strong>root directory</strong> of the project (or inside <code>src</code> folder if using one):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { registerOTel } from '@vercel/otel'\n \nexport function register() {\n  registerOTel({ serviceName: 'next-app' })\n}</pre></div>  <p>See the <a href=\"https://www.npmjs.com/package/@vercel/otel\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@vercel/otel</code> documentation</a> for additional configuration options.</p>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>The <code>instrumentation</code> file should be in the root of your project and not inside the <code>app</code> or <code>pages</code> directory. If you're using the <code>src</code> folder, then place the file inside <code>src</code> alongside <code>pages</code> and <code>app</code>.</li> <li>If you use the <a href=\"../../api-reference/next-config-js/pageextensions\"><code>pageExtensions</code> config option</a> to add a suffix, you will also need to update the <code>instrumentation</code> filename to match.</li> <li>We have created a basic <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-opentelemetry\" rel=\"noopener noreferrer\" target=\"_blank\">with-opentelemetry</a> example that you can use.</li> </ul> </blockquote> <h3 id=\"manual-opentelemetry-configuration\" data-docs-heading=\"\">Manual OpenTelemetry configuration     </h3> <p>The <code>@vercel/otel</code> package provides many configuration options and should serve most of common use cases. But if it doesn't suit your needs, you can configure OpenTelemetry manually.</p> <p>Firstly you need to install OpenTelemetry packages:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @opentelemetry/sdk-node @opentelemetry/resources @opentelemetry/semantic-conventions @opentelemetry/sdk-trace-node @opentelemetry/exporter-trace-otlp-http</pre></div> <p>Now you can initialize <code>NodeSDK</code> in your <code>instrumentation.ts</code>. Unlike <code>@vercel/otel</code>, <code>NodeSDK</code> is not compatible with edge runtime, so you need to make sure that you are importing them only when <code>process.env.NEXT_RUNTIME === 'nodejs'</code>. We recommend creating a new file <code>instrumentation.node.ts</code> which you conditionally import only when using node:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation.node.ts')\n  }\n}</pre></div>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NodeSDK } from '@opentelemetry/sdk-node'\nimport { OTLPTraceExporter } from '@opentelemetry/exporter-trace-otlp-http'\nimport { Resource } from '@opentelemetry/resources'\nimport { SEMRESATTRS_SERVICE_NAME } from '@opentelemetry/semantic-conventions'\nimport { SimpleSpanProcessor } from '@opentelemetry/sdk-trace-node'\n \nconst sdk = new NodeSDK({\n  resource: new Resource({\n    [SEMRESATTRS_SERVICE_NAME]: 'next-app',\n  }),\n  spanProcessor: new SimpleSpanProcessor(new OTLPTraceExporter()),\n})\nsdk.start()</pre></div>  <p>Doing this is equivalent to using <code>@vercel/otel</code>, but it's possible to modify and extend some features that are not exposed by the <code>@vercel/otel</code>. If edge runtime support is necessary, you will have to use <code>@vercel/otel</code>.</p> <h2 id=\"testing-your-instrumentation\" data-docs-heading=\"\">Testing your instrumentation     </h2> <p>You need an OpenTelemetry collector with a compatible backend to test OpenTelemetry traces locally. We recommend using our <a href=\"https://github.com/vercel/opentelemetry-collector-dev-setup\" rel=\"noopener noreferrer\" target=\"_blank\">OpenTelemetry dev environment</a>.</p> <p>If everything works well you should be able to see the root server span labeled as <code>GET /requested/pathname</code>. All other spans from that particular trace will be nested under it.</p> <p>Next.js traces more spans than are emitted by default. To see more spans, you must set <code>NEXT_OTEL_VERBOSE=1</code>.</p> <h2 id=\"deployment\" data-docs-heading=\"\">Deployment     </h2> <h3 id=\"using-opentelemetry-collector\" data-docs-heading=\"\">Using OpenTelemetry Collector     </h3> <p>When you are deploying with OpenTelemetry Collector, you can use <code>@vercel/otel</code>. It will work both on Vercel and when self-hosted.</p> <h4 id=\"deploying-on-vercel\" data-docs-heading=\"\">Deploying on Vercel     </h4> <p>We made sure that OpenTelemetry works out of the box on Vercel.</p> <p>Follow <a href=\"https://vercel.com/docs/concepts/observability/otel-overview/quickstart\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel documentation</a> to connect your project to an observability provider.</p> <h4 id=\"self-hosting\" data-docs-heading=\"\">Self-hosting     </h4> <p>Deploying to other platforms is also straightforward. You will need to spin up your own OpenTelemetry Collector to receive and process the telemetry data from your Next.js app.</p> <p>To do this, follow the <a href=\"https://opentelemetry.io/docs/collector/getting-started/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">OpenTelemetry Collector Getting Started guide</a>, which will walk you through setting up the collector and configuring it to receive data from your Next.js app.</p> <p>Once you have your collector up and running, you can deploy your Next.js app to your chosen platform following their respective deployment guides.</p> <h3 id=\"custom-exporters\" data-docs-heading=\"\">Custom Exporters     </h3> <p>OpenTelemetry Collector is not necessary. You can use a custom OpenTelemetry exporter with <a href=\"#using-vercelotel\"><code>@vercel/otel</code></a> or <a href=\"open-telemetry#manual-opentelemetry-configuration\">manual OpenTelemetry configuration</a>.</p> <h2 id=\"custom-spans\" data-docs-heading=\"\">Custom Spans     </h2> <p>You can add a custom span with <a href=\"https://opentelemetry.io/docs/instrumentation/js/instrumentation\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">OpenTelemetry APIs</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @opentelemetry/api</pre></div> <p>The following example demonstrates a function that fetches GitHub stars and adds a custom <code>fetchGithubStars</code> span to track the fetch request's result:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { trace } from '@opentelemetry/api'\n \nexport async function fetchGithubStars() {\n  return await trace\n    .getTracer('nextjs-example')\n    .startActiveSpan('fetchGithubStars', async (span) =&gt; {\n      try {\n        return await getValue()\n      } finally {\n        span.end()\n      }\n    })\n}</pre>\n</div> <p>The <code>register</code> function will execute before your code runs in a new environment. You can start creating new spans, and they should be correctly added to the exported trace.</p> <h2 id=\"default-spans-in-nextjs\" data-docs-heading=\"\">Default Spans in Next.js     </h2> <p>Next.js automatically instruments several spans for you to provide useful insights into your application's performance.</p> <p>Attributes on spans follow <a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">OpenTelemetry semantic conventions</a>. We also add some custom attributes under the <code>next</code> namespace:</p> <ul> <li>\n<code>next.span_name</code> - duplicates span name</li> <li>\n<code>next.span_type</code> - each span type has a unique identifier</li> <li>\n<code>next.route</code> - The route pattern of the request (e.g., <code>/[param]/user</code>).</li> <li>\n<code>next.rsc</code> (true/false) - Whether the request is an RSC request, such as prefetch.</li> <li>\n<code>next.page</code> <ul> <li>This is an internal value used by an app router.</li> <li>You can think about it as a route to a special file (like <code>page.ts</code>, <code>layout.ts</code>, <code>loading.ts</code> and others)</li> <li>It can be used as a unique identifier only when paired with <code>next.route</code> because <code>/layout</code> can be used to identify both <code>/(groupA)/layout.ts</code> and <code>/(groupB)/layout.ts</code>\n</li> </ul> </li> </ul> <h3 id=\"httpmethod-nextroute\" data-docs-heading=\"\">[http.method] [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>BaseServer.handleRequest</code>\n</li> </ul> <p>This span represents the root span for each incoming request to your Next.js application. It tracks the HTTP method, route, target, and status code of the request.</p> <p>Attributes:</p> <ul> <li>\n<a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#common-attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Common HTTP attributes</a> <ul> <li><code>http.method</code></li> <li><code>http.status_code</code></li> </ul> </li> <li>\n<a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#http-server-semantic-conventions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Server HTTP attributes</a> <ul> <li><code>http.route</code></li> <li><code>http.target</code></li> </ul> </li> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"render-route-app-nextroute\" data-docs-heading=\"\">render route (app) [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>AppRender.getBodyResult</code>.</li> </ul> <p>This span represents the process of rendering a route in the app router.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"fetch-httpmethod-httpurl\" data-docs-heading=\"\">fetch [http.method] [http.url]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>AppRender.fetch</code>\n</li> </ul> <p>This span represents the fetch request executed in your code.</p> <p>Attributes:</p> <ul> <li>\n<a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#common-attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Common HTTP attributes</a> <ul> <li><code>http.method</code></li> </ul> </li> <li>\n<a href=\"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#http-client\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Client HTTP attributes</a> <ul> <li><code>http.url</code></li> <li><code>net.peer.name</code></li> <li>\n<code>net.peer.port</code> (only if specified)</li> </ul> </li> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> </ul> <p>This span can be turned off by setting <code>NEXT_OTEL_FETCH_DISABLED=1</code> in your environment. This is useful when you want to use a custom fetch instrumentation library.</p> <h3 id=\"executing-api-route-app-nextroute\" data-docs-heading=\"\">executing api route (app) [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>AppRouteRouteHandlers.runHandler</code>.</li> </ul> <p>This span represents the execution of an API route handler in the app router.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"getserversideprops-nextroute\" data-docs-heading=\"\">getServerSideProps [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>Render.getServerSideProps</code>.</li> </ul> <p>This span represents the execution of <code>getServerSideProps</code> for a specific route.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"getstaticprops-nextroute\" data-docs-heading=\"\">getStaticProps [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>Render.getStaticProps</code>.</li> </ul> <p>This span represents the execution of <code>getStaticProps</code> for a specific route.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"render-route-pages-nextroute\" data-docs-heading=\"\">render route (pages) [next.route]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>Render.renderDocument</code>.</li> </ul> <p>This span represents the process of rendering the document for a specific route.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"generatemetadata-nextpage\" data-docs-heading=\"\">generateMetadata [next.page]     </h3> <ul> <li>\n<code>next.span_type</code>: <code>ResolveMetadata.generateMetadata</code>.</li> </ul> <p>This span represents the process of generating metadata for a specific page (a single route can have multiple of these spans).</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.page</code></li> </ul> <h3 id=\"resolve-page-components\" data-docs-heading=\"\">resolve page components     </h3> <ul> <li>\n<code>next.span_type</code>: <code>NextNodeServer.findPageComponents</code>.</li> </ul> <p>This span represents the process of resolving page components for a specific page.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.route</code></li> </ul> <h3 id=\"resolve-segment-modules\" data-docs-heading=\"\">resolve segment modules     </h3> <ul> <li>\n<code>next.span_type</code>: <code>NextNodeServer.getLayoutOrPageModule</code>.</li> </ul> <p>This span represents loading of code modules for a layout or a page.</p> <p>Attributes:</p> <ul> <li><code>next.span_name</code></li> <li><code>next.span_type</code></li> <li><code>next.segment</code></li> </ul> <h3 id=\"start-response\" data-docs-heading=\"\">start response     </h3> <ul> <li>\n<code>next.span_type</code>: <code>NextNodeServer.startResponse</code>.</li> </ul> <p>This zero-length span represents the time when the first byte has been sent in the response.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/open-telemetry\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/open-telemetry</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/third-party-libraries":"<h1 class=\"break-words\">Third Party Libraries</h1> <p><strong><code>@next/third-parties</code></strong> is a library that provides a collection of components and utilities that improve the performance and developer experience of loading popular third-party libraries in your Next.js application.</p> <p>All third-party integrations provided by <code>@next/third-parties</code> have been optimized for performance and ease of use.</p> <h2 id=\"getting-started\" data-docs-heading=\"\">Getting Started     </h2> <p>To get started, install the <code>@next/third-parties</code> library:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @next/third-parties@latest next@latest</pre></div>  <p><code>@next/third-parties</code> is currently an <strong>experimental</strong> library under active development. We recommend installing it with the <strong>latest</strong> or <strong>canary</strong> flags while we work on adding more third-party integrations.</p> <h2 id=\"google-third-parties\" data-docs-heading=\"\">Google Third-Parties     </h2> <p>All supported third-party libraries from Google can be imported from <code>@next/third-parties/google</code>.</p> <h3 id=\"google-tag-manager\" data-docs-heading=\"\">Google Tag Manager     </h3> <p>The <code>GoogleTagManager</code> component can be used to instantiate a <a href=\"https://developers.google.com/tag-platform/tag-manager\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Tag Manager</a> container to your page. By default, it fetches the original inline script after hydration occurs on the page.</p>  <p>To load Google Tag Manager for all routes, include the component directly in your custom <code>_app</code> and pass in your GTM container ID:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleTagManager } from '@next/third-parties/google'\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;&gt;\n      &lt;Component {...pageProps} /&gt;\n      &lt;GoogleTagManager gtmId=\"GTM-XYZ\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <p>To load Google Tag Manager for a single route, include the component in your page file:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleTagManager } from '@next/third-parties/google'\n \nexport default function Page() {\n  return &lt;GoogleTagManager gtmId=\"GTM-XYZ\" /&gt;\n}</pre></div> <h4 id=\"sending-events\" data-docs-heading=\"\">Sending Events     </h4> <p>The <code>sendGTMEvent</code> function can be used to track user interactions on your page by sending events using the <code>dataLayer</code> object. For this function to work, the <code>&lt;GoogleTagManager /&gt;</code> component must be included in either a parent layout, page, or component, or directly in the same file.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { sendGTMEvent } from '@next/third-parties/google'\n \nexport function EventButton() {\n  return (\n    &lt;div&gt;\n      &lt;button\n        onClick={() =&gt; sendGTMEvent({ event: 'buttonClicked', value: 'xyz' })}\n      &gt;\n        Send Event\n      &lt;/button&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Refer to the Tag Manager <a href=\"https://developers.google.com/tag-platform/tag-manager/datalayer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">developer documentation</a> to learn about the different variables and events that can be passed into the function.</p> <h4 id=\"options\" data-docs-heading=\"\">Options     </h4> <p>Options to pass to the Google Tag Manager. For a full list of options, read the <a href=\"https://developers.google.com/tag-platform/tag-manager/datalayer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Tag Manager docs</a>.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>gtmId</code></td>\n<td>Required</td>\n<td>Your GTM container ID. Usually starts with <code>GTM-</code>.</td>\n</tr>\n<tr>\n<td><code>dataLayer</code></td>\n<td>Optional</td>\n<td>Data layer array to instantiate the container with. Defaults to an empty array.</td>\n</tr>\n<tr>\n<td><code>dataLayerName</code></td>\n<td>Optional</td>\n<td>Name of the data layer. Defaults to <code>dataLayer</code>.</td>\n</tr>\n<tr>\n<td><code>auth</code></td>\n<td>Optional</td>\n<td>Value of authentication parameter (<code>gtm_auth</code>) for environment snippets.</td>\n</tr>\n<tr>\n<td><code>preview</code></td>\n<td>Optional</td>\n<td>Value of preview parameter (<code>gtm_preview</code>) for environment snippets.</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"google-analytics\" data-docs-heading=\"\">Google Analytics     </h3> <p>The <code>GoogleAnalytics</code> component can be used to include <a href=\"https://developers.google.com/analytics/devguides/collection/ga4\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Analytics 4</a> to your page via the Google tag (<code>gtag.js</code>). By default, it fetches the original scripts after hydration occurs on the page.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: If Google Tag Manager is already included in your application, you can configure Google Analytics directly using it, rather than including Google Analytics as a separate component. Refer to the <a href=\"https://developers.google.com/analytics/devguides/collection/ga4/tag-options#what-is-gtm\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">documentation</a> to learn more about the differences between Tag Manager and <code>gtag.js</code>.</p> </blockquote>  <p>To load Google Analytics for all routes, include the component directly in your custom <code>_app</code> and pass in your measurement ID:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleAnalytics } from '@next/third-parties/google'\n \nexport default function MyApp({ Component, pageProps }) {\n  return (\n    &lt;&gt;\n      &lt;Component {...pageProps} /&gt;\n      &lt;GoogleAnalytics gaId=\"G-XYZ\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <p>To load Google Analytics for a single route, include the component in your page file:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleAnalytics } from '@next/third-parties/google'\n \nexport default function Page() {\n  return &lt;GoogleAnalytics gaId=\"G-XYZ\" /&gt;\n}</pre></div> <h4 id=\"sending-events-1\" data-docs-heading=\"\">Sending Events     </h4> <p>The <code>sendGAEvent</code> function can be used to measure user interactions on your page by sending events using the <code>dataLayer</code> object. For this function to work, the <code>&lt;GoogleAnalytics /&gt;</code> component must be included in either a parent layout, page, or component, or directly in the same file.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { sendGAEvent } from '@next/third-parties/google'\n \nexport function EventButton() {\n  return (\n    &lt;div&gt;\n      &lt;button\n        onClick={() =&gt; sendGAEvent({ event: 'buttonClicked', value: 'xyz' })}\n      &gt;\n        Send Event\n      &lt;/button&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Refer to the Google Analytics <a href=\"https://developers.google.com/analytics/devguides/collection/ga4/event-parameters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">developer documentation</a> to learn more about event parameters.</p> <h4 id=\"tracking-pageviews\" data-docs-heading=\"\">Tracking Pageviews     </h4> <p>Google Analytics automatically tracks pageviews when the browser history state changes. This means that client-side navigations between Next.js routes will send pageview data without any configuration.</p> <p>To ensure that client-side navigations are being measured correctly, verify that the <a href=\"https://support.google.com/analytics/answer/9216061#enable_disable\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><em>Enhanced Measurement</em></a> property is enabled in your Admin panel and the <em>Page changes based on browser history events</em> checkbox is selected.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: If you decide to manually send pageview events, make sure to disable the default pageview measurement to avoid having duplicate data. Refer to the Google Analytics <a href=\"https://developers.google.com/analytics/devguides/collection/ga4/views?client_type=gtag#manual_pageviews\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">developer documentation</a> to learn more.</p> </blockquote> <h4 id=\"options-1\" data-docs-heading=\"\">Options     </h4> <p>Options to pass to the <code>&lt;GoogleAnalytics&gt;</code> component.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>gaId</code></td>\n<td>Required</td>\n<td>Your <a href=\"https://support.google.com/analytics/answer/12270356\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">measurement ID</a>. Usually starts with <code>G-</code>.</td>\n</tr>\n<tr>\n<td><code>dataLayerName</code></td>\n<td>Optional</td>\n<td>Name of the data layer. Defaults to <code>dataLayer</code>.</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"google-maps-embed\" data-docs-heading=\"\">Google Maps Embed     </h3> <p>The <code>GoogleMapsEmbed</code> component can be used to add a <a href=\"https://developers.google.com/maps/documentation/embed/embedding-map\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Maps Embed</a> to your page. By default, it uses the <code>loading</code> attribute to lazy-load the embed below the fold.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleMapsEmbed } from '@next/third-parties/google'\n \nexport default function Page() {\n  return (\n    &lt;GoogleMapsEmbed\n      apiKey=\"XYZ\"\n      height={200}\n      width=\"100%\"\n      mode=\"place\"\n      q=\"Brooklyn+Bridge,New+York,NY\"\n    /&gt;\n  )\n}</pre></div> <h4 id=\"options-2\" data-docs-heading=\"\">Options     </h4> <p>Options to pass to the Google Maps Embed. For a full list of options, read the <a href=\"https://developers.google.com/maps/documentation/embed/embedding-map\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Map Embed docs</a>.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>apiKey</code></td>\n<td>Required</td>\n<td>Your api key.</td>\n</tr>\n<tr>\n<td><code>mode</code></td>\n<td>Required</td>\n<td><a href=\"https://developers.google.com/maps/documentation/embed/embedding-map#choosing_map_modes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Map mode</a></td>\n</tr>\n<tr>\n<td><code>height</code></td>\n<td>Optional</td>\n<td>Height of the embed. Defaults to <code>auto</code>.</td>\n</tr>\n<tr>\n<td><code>width</code></td>\n<td>Optional</td>\n<td>Width of the embed. Defaults to <code>auto</code>.</td>\n</tr>\n<tr>\n<td><code>style</code></td>\n<td>Optional</td>\n<td>Pass styles to the iframe.</td>\n</tr>\n<tr>\n<td><code>allowfullscreen</code></td>\n<td>Optional</td>\n<td>Property to allow certain map parts to go full screen.</td>\n</tr>\n<tr>\n<td><code>loading</code></td>\n<td>Optional</td>\n<td>Defaults to lazy. Consider changing if you know your embed will be above the fold.</td>\n</tr>\n<tr>\n<td><code>q</code></td>\n<td>Optional</td>\n<td>Defines map marker location. <em>This may be required depending on the map mode</em>.</td>\n</tr>\n<tr>\n<td><code>center</code></td>\n<td>Optional</td>\n<td>Defines the center of the map view.</td>\n</tr>\n<tr>\n<td><code>zoom</code></td>\n<td>Optional</td>\n<td>Sets initial zoom level of the map.</td>\n</tr>\n<tr>\n<td><code>maptype</code></td>\n<td>Optional</td>\n<td>Defines type of map tiles to load.</td>\n</tr>\n<tr>\n<td><code>language</code></td>\n<td>Optional</td>\n<td>Defines the language to use for UI elements and for the display of labels on map tiles.</td>\n</tr>\n<tr>\n<td><code>region</code></td>\n<td>Optional</td>\n<td>Defines the appropriate borders and labels to display, based on geo-political sensitivities.</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"youtube-embed\" data-docs-heading=\"\">YouTube Embed     </h3> <p>The <code>YouTubeEmbed</code> component can be used to load and display a YouTube embed. This component loads faster by using <a href=\"https://github.com/paulirish/lite-youtube-embed\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>lite-youtube-embed</code></a> under the hood.</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { YouTubeEmbed } from '@next/third-parties/google'\n \nexport default function Page() {\n  return &lt;YouTubeEmbed videoid=\"ogfYd705cRs\" height={400} params=\"controls=0\" /&gt;\n}</pre></div> <h4 id=\"options-3\" data-docs-heading=\"\">Options     </h4> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>videoid</code></td>\n<td>Required</td>\n<td>YouTube video id.</td>\n</tr>\n<tr>\n<td><code>width</code></td>\n<td>Optional</td>\n<td>Width of the video container. Defaults to <code>auto</code>\n</td>\n</tr>\n<tr>\n<td><code>height</code></td>\n<td>Optional</td>\n<td>Height of the video container. Defaults to <code>auto</code>\n</td>\n</tr>\n<tr>\n<td><code>playlabel</code></td>\n<td>Optional</td>\n<td>A visually hidden label for the play button for accessibility.</td>\n</tr>\n<tr>\n<td><code>params</code></td>\n<td>Optional</td>\n<td>The video player params defined <a href=\"https://developers.google.com/youtube/player_parameters#Parameters\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">here</a>. <br> Params are passed as a query param string. <br> Eg: <code>params=\"controls=0&amp;start=10&amp;end=30\"</code>\n</td>\n</tr>\n<tr>\n<td><code>style</code></td>\n<td>Optional</td>\n<td>Used to apply styles to the video container.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/third-party-libraries\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/third-party-libraries</a>\n  </p>\n</div>\n","pages/building-your-application/configuring":"<h1 class=\"break-words\">Configuring</h1> <p>Next.js allows you to customize your project to meet specific requirements. This includes integrations with TypeScript, ESlint, and more, as well as internal configuration options such as Absolute Imports and Environment Variables.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/eslint":"<h1 class=\"break-words\">ESLint</h1> <p>Next.js provides an integrated <a href=\"https://eslint.org/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">ESLint</a> experience out of the box. Add <code>next lint</code> as a script to <code>package.json</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"lint\": \"next lint\"\n  }\n}</pre></div> <p>Then run <code>npm run lint</code> or <code>yarn lint</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn lint</pre></div> <p>If you don't already have ESLint configured in your application, you will be guided through the installation and configuration process.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn lint</pre></div> <blockquote class=\"p-3 text-sm\"> <p>You'll see a prompt like this:</p> <p>? How would you like to configure ESLint?</p> <p> Strict (recommended)<br> Base<br> Cancel</p> </blockquote> <p>One of the following three options can be selected:</p> <ul> <li> <p><strong>Strict</strong>: Includes Next.js' base ESLint configuration along with a stricter <a href=\"#core-web-vitals\">Core Web Vitals rule-set</a>. This is the recommended configuration for developers setting up ESLint for the first time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next/core-web-vitals\"\n}</pre></div> </li> <li> <p><strong>Base</strong>: Includes Next.js' base ESLint configuration.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next\"\n}</pre></div> </li> <li> <p><strong>Cancel</strong>: Does not include any ESLint configuration. Only select this option if you plan on setting up your own custom ESLint configuration.</p> </li> </ul> <p>If either of the two configuration options are selected, Next.js will automatically install <code>eslint</code> and <code>eslint-config-next</code> as dependencies in your application and create an <code>.eslintrc.json</code> file in the root of your project that includes your selected configuration.</p> <p>You can now run <code>next lint</code> every time you want to run ESLint to catch errors. Once ESLint has been set up, it will also automatically run during every build (<code>next build</code>). Errors will fail the build, while warnings will not.</p>  <blockquote class=\"p-3 text-sm\"> <p>If you do not want ESLint to run during <code>next build</code>, refer to the documentation for <a href=\"../../api-reference/next-config-js/eslint\">Ignoring ESLint</a>.</p> </blockquote> <p>We recommend using an appropriate <a href=\"https://eslint.org/docs/user-guide/integrations#editors\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">integration</a> to view warnings and errors directly in your code editor during development.</p> <h2 id=\"eslint-config\" data-docs-heading=\"\">ESLint Config     </h2> <p>The default configuration (<code>eslint-config-next</code>) includes everything you need to have an optimal out-of-the-box linting experience in Next.js. If you do not have ESLint already configured in your application, we recommend using <code>next lint</code> to set up ESLint along with this configuration.</p> <blockquote class=\"p-3 text-sm\"> <p>If you would like to use <code>eslint-config-next</code> along with other ESLint configurations, refer to the <a href=\"#additional-configurations\">Additional Configurations</a> section to learn how to do so without causing any conflicts.</p> </blockquote> <p>Recommended rule-sets from the following ESLint plugins are all used within <code>eslint-config-next</code>:</p> <ul> <li><a href=\"https://www.npmjs.com/package/eslint-plugin-react\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eslint-plugin-react</code></a></li> <li><a href=\"https://www.npmjs.com/package/eslint-plugin-react-hooks\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eslint-plugin-react-hooks</code></a></li> <li><a href=\"https://www.npmjs.com/package/@next/eslint-plugin-next\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eslint-plugin-next</code></a></li> </ul> <p>This will take precedence over the configuration from <code>next.config.js</code>.</p> <h2 id=\"eslint-plugin\" data-docs-heading=\"\">ESLint Plugin     </h2> <p>Next.js provides an ESLint plugin, <a href=\"https://www.npmjs.com/package/@next/eslint-plugin-next\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eslint-plugin-next</code></a>, already bundled within the base configuration that makes it possible to catch common issues and problems in a Next.js application. The full set of rules is as follows:</p> <p> Enabled in the recommended configuration</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th align=\"center\"></th>\n<th>Rule</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/google-font-display\">@next/next/google-font-display</a></td>\n<td>Enforce font-display behavior with Google Fonts.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/google-font-preconnect\">@next/next/google-font-preconnect</a></td>\n<td>Ensure <code>preconnect</code> is used with Google Fonts.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/inline-script-id\">@next/next/inline-script-id</a></td>\n<td>Enforce <code>id</code> attribute on <code>next/script</code> components with inline content.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/next-script-for-ga\">@next/next/next-script-for-ga</a></td>\n<td>Prefer <code>next/script</code> component when using the inline script for Google Analytics.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-assign-module-variable\">@next/next/no-assign-module-variable</a></td>\n<td>Prevent assignment to the <code>module</code> variable.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-async-client-component\">@next/next/no-async-client-component</a></td>\n<td>Prevent client components from being async functions.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-before-interactive-script-outside-document\">@next/next/no-before-interactive-script-outside-document</a></td>\n<td>Prevent usage of <code>next/script</code>'s <code>beforeInteractive</code> strategy outside of <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-css-tags\">@next/next/no-css-tags</a></td>\n<td>Prevent manual stylesheet tags.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-document-import-in-page\">@next/next/no-document-import-in-page</a></td>\n<td>Prevent importing <code>next/document</code> outside of <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-duplicate-head\">@next/next/no-duplicate-head</a></td>\n<td>Prevent duplicate usage of <code>&lt;Head&gt;</code> in <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-head-element\">@next/next/no-head-element</a></td>\n<td>Prevent usage of <code>&lt;head&gt;</code> element.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-head-import-in-document\">@next/next/no-head-import-in-document</a></td>\n<td>Prevent usage of <code>next/head</code> in <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-html-link-for-pages\">@next/next/no-html-link-for-pages</a></td>\n<td>Prevent usage of <code>&lt;a&gt;</code> elements to navigate to internal Next.js pages.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-img-element\">@next/next/no-img-element</a></td>\n<td>Prevent usage of <code>&lt;img&gt;</code> element due to slower LCP and higher bandwidth.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-page-custom-font\">@next/next/no-page-custom-font</a></td>\n<td>Prevent page-only custom fonts.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-script-component-in-head\">@next/next/no-script-component-in-head</a></td>\n<td>Prevent usage of <code>next/script</code> in <code>next/head</code> component.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-styled-jsx-in-document\">@next/next/no-styled-jsx-in-document</a></td>\n<td>Prevent usage of <code>styled-jsx</code> in <code>pages/_document.js</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-sync-scripts\">@next/next/no-sync-scripts</a></td>\n<td>Prevent synchronous scripts.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-title-in-document-head\">@next/next/no-title-in-document-head</a></td>\n<td>Prevent usage of <code>&lt;title&gt;</code> with <code>Head</code> component from <code>next/document</code>.</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td>@next/next/no-typos</td>\n<td>Prevent common typos in <a href=\"../data-fetching\">Next.js's data fetching functions</a>\n</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td><a href=\"../../../messages/no-unwanted-polyfillio\">@next/next/no-unwanted-polyfillio</a></td>\n<td>Prevent duplicate polyfills from Polyfill.io.</td>\n</tr>\n</tbody>\n</table></div> <p>If you already have ESLint configured in your application, we recommend extending from this plugin directly instead of including <code>eslint-config-next</code> unless a few conditions are met. Refer to the <a href=\"#recommended-plugin-ruleset\">Recommended Plugin Ruleset</a> to learn more.</p> <h3 id=\"custom-settings\" data-docs-heading=\"\">Custom Settings     </h3> <h4 id=\"rootdir\" data-docs-heading=\"\">rootDir     </h4> <p>If you're using <code>eslint-plugin-next</code> in a project where Next.js isn't installed in your root directory (such as a monorepo), you can tell <code>eslint-plugin-next</code> where to find your Next.js application using the <code>settings</code> property in your <code>.eslintrc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next\",\n  \"settings\": {\n    \"next\": {\n      \"rootDir\": \"packages/my-app/\"\n    }\n  }\n}</pre></div> <p><code>rootDir</code> can be a path (relative or absolute), a glob (i.e. <code>\"packages/*/\"</code>), or an array of paths and/or globs.</p> <h2 id=\"linting-custom-directories-and-files\" data-docs-heading=\"\">Linting Custom Directories and Files     </h2> <p>By default, Next.js will run ESLint for all files in the <code>pages/</code>, <code>app/</code>, <code>components/</code>, <code>lib/</code>, and <code>src/</code> directories. However, you can specify which directories using the <code>dirs</code> option in the <code>eslint</code> config in <code>next.config.js</code> for production builds:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  eslint: {\n    dirs: ['pages', 'utils'], // Only run ESLint on the 'pages' and 'utils' directories during production builds (next build)\n  },\n}</pre></div> <p>Similarly, the <code>--dir</code> and <code>--file</code> flags can be used for <code>next lint</code> to lint specific directories and files:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next lint --dir pages --dir utils --file bar.js</pre></div> <h2 id=\"caching\" data-docs-heading=\"\">Caching     </h2>  <p>To improve performance, information of files processed by ESLint are cached by default. This is stored in <code>.next/cache</code> or in your defined <a href=\"../../api-reference/next-config-js/distdir\">build directory</a>. If you include any ESLint rules that depend on more than the contents of a single source file and need to disable the cache, use the <code>--no-cache</code> flag with <code>next lint</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next lint --no-cache</pre></div> <h2 id=\"disabling-rules\" data-docs-heading=\"\">Disabling Rules     </h2> <p>If you would like to modify or disable any rules provided by the supported plugins (<code>react</code>, <code>react-hooks</code>, <code>next</code>), you can directly change them using the <code>rules</code> property in your <code>.eslintrc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next\",\n  \"rules\": {\n    \"react/no-unescaped-entities\": \"off\",\n    \"@next/next/no-page-custom-font\": \"off\"\n  }\n}</pre></div> <h3 id=\"core-web-vitals\" data-docs-heading=\"\">Core Web Vitals     </h3> <p>The <code>next/core-web-vitals</code> rule set is enabled when <code>next lint</code> is run for the first time and the <strong>strict</strong> option is selected.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": \"next/core-web-vitals\"\n}</pre></div> <p><code>next/core-web-vitals</code> updates <code>eslint-plugin-next</code> to error on a number of rules that are warnings by default if they affect <a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Core Web Vitals</a>.</p> <blockquote class=\"p-3 text-sm\"> <p>The <code>next/core-web-vitals</code> entry point is automatically included for new applications built with <a href=\"../../../app/api-reference/create-next-app\">Create Next App</a>.</p> </blockquote> <h2 id=\"usage-with-other-tools\" data-docs-heading=\"\">Usage With Other Tools     </h2> <h3 id=\"prettier\" data-docs-heading=\"\">Prettier     </h3> <p>ESLint also contains code formatting rules, which can conflict with your existing <a href=\"https://prettier.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Prettier</a> setup. We recommend including <a href=\"https://github.com/prettier/eslint-config-prettier\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">eslint-config-prettier</a> in your ESLint config to make ESLint and Prettier work together.</p> <p>First, install the dependency:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install --save-dev eslint-config-prettier\n \nyarn add --dev eslint-config-prettier\n \npnpm add --save-dev eslint-config-prettier\n \nbun add --dev eslint-config-prettier</pre></div> <p>Then, add <code>prettier</code> to your existing ESLint config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": [\"next\", \"prettier\"]\n}</pre></div> <h3 id=\"lint-staged\" data-docs-heading=\"\">lint-staged     </h3> <p>If you would like to use <code>next lint</code> with <a href=\"https://github.com/okonet/lint-staged\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">lint-staged</a> to run the linter on staged git files, you'll have to add the following to the <code>.lintstagedrc.js</code> file in the root of your project in order to specify usage of the <code>--file</code> flag.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const path = require('path')\n \nconst buildEslintCommand = (filenames) =&gt;\n  `next lint --fix --file ${filenames\n    .map((f) =&gt; path.relative(process.cwd(), f))\n    .join(' --file ')}`\n \nmodule.exports = {\n  '*.{js,jsx,ts,tsx}': [buildEslintCommand],\n}</pre></div> <h2 id=\"migrating-existing-config\" data-docs-heading=\"\">Migrating Existing Config     </h2> <h3 id=\"recommended-plugin-ruleset\" data-docs-heading=\"\">Recommended Plugin Ruleset     </h3> <p>If you already have ESLint configured in your application and any of the following conditions are true:</p> <ul> <li>You have one or more of the following plugins already installed (either separately or through a different config such as <code>airbnb</code> or <code>react-app</code>): <ul> <li><code>react</code></li> <li><code>react-hooks</code></li> <li><code>jsx-a11y</code></li> <li><code>import</code></li> </ul> </li> <li>You've defined specific <code>parserOptions</code> that are different from how Babel is configured within Next.js (this is not recommended unless you have <a href=\"babel\">customized your Babel configuration</a>)</li> <li>You have <code>eslint-plugin-import</code> installed with Node.js and/or TypeScript <a href=\"https://github.com/benmosher/eslint-plugin-import#resolvers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">resolvers</a> defined to handle imports</li> </ul> <p>Then we recommend either removing these settings if you prefer how these properties have been configured within <a href=\"https://github.com/vercel/next.js/blob/canary/packages/eslint-config-next/index.js\" rel=\"noopener noreferrer\" target=\"_blank\"><code>eslint-config-next</code></a> or extending directly from the Next.js ESLint plugin instead:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  extends: [\n    //...\n    'plugin:@next/next/recommended',\n  ],\n}</pre>\n</div> <p>The plugin can be installed normally in your project without needing to run <code>next lint</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install --save-dev @next/eslint-plugin-next\n \nyarn add --dev @next/eslint-plugin-next\n \npnpm add --save-dev @next/eslint-plugin-next\n \nbun add --dev @next/eslint-plugin-next</pre></div> <p>This eliminates the risk of collisions or errors that can occur due to importing the same plugin or parser across multiple configurations.</p> <h3 id=\"additional-configurations\" data-docs-heading=\"\">Additional Configurations     </h3> <p>If you already use a separate ESLint configuration and want to include <code>eslint-config-next</code>, ensure that it is extended last after other configurations. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"extends\": [\"eslint:recommended\", \"next\"]\n}</pre></div> <p>The <code>next</code> configuration already handles setting default values for the <code>parser</code>, <code>plugins</code> and <code>settings</code> properties. There is no need to manually re-declare any of these properties unless you need a different configuration for your use case.</p> <p>If you include any other shareable configurations, <strong>you will need to make sure that these properties are not overwritten or modified</strong>. Otherwise, we recommend removing any configurations that share behavior with the <code>next</code> configuration or extending directly from the Next.js ESLint plugin as mentioned above.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/eslint\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/eslint</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/src-directory":"<h1 class=\"break-words\">src Directory</h1> <p>As an alternative to having the special Next.js <code>app</code> or <code>pages</code> directories in the root of your project, Next.js also supports the common pattern of placing application code under the <code>src</code> directory.</p> <p>This separates application code from project configuration files which mostly live in the root of a project, which is preferred by some individuals and teams.</p> <p>To use the <code>src</code> directory, move the <code>app</code> Router folder or <code>pages</code> Router folder to <code>src/app</code> or <code>src/pages</code> respectively.</p> <figure><img alt=\"An example folder structure with the `src` directory\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"block rounded-md border border-gray-200 bg-gray-100 dark:hidden\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75\"><img alt=\"An example folder structure with the `src` directory\" loading=\"lazy\" width=\"1600\" height=\"687\" decoding=\"async\" data-nimg=\"1\" class=\"hidden rounded-md border border-gray-200 bg-gray-100 dark:block\" style=\"color:transparent\" srcset=\"/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=1920&amp;q=75 1x, /_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75 2x\" src=\"https://nextjs.org/_next/image?url=%2Fdocs%2Fdark%2Fproject-organization-src-directory.png&amp;w=3840&amp;q=75\"></figure> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>The <code>/public</code> directory should remain in the root of your project.</li> <li>Config files like <code>package.json</code>, <code>next.config.js</code> and <code>tsconfig.json</code> should remain in the root of your project.</li> <li>\n<code>.env.*</code> files should remain in the root of your project.</li> <li>\n<code>src/app</code> or <code>src/pages</code> will be ignored if <code>app</code> or <code>pages</code> are present in the root directory.</li> <li>If you're using <code>src</code>, you'll probably also move other application folders such as <code>/components</code> or <code>/lib</code>.</li> <li>If you're using Middleware, ensure it is placed inside the <code>src</code> directory.</li> <li>If you're using Tailwind CSS, you'll need to add the <code>/src</code> prefix to the <code>tailwind.config.js</code> file in the <a href=\"https://tailwindcss.com/docs/content-configuration\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">content section</a>.</li> <li>If you are using TypeScript paths for imports such as <code>@/*</code>, you should update the <code>paths</code> object in <code>tsconfig.json</code> to include <code>src/</code>.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/src-directory\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/src-directory</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/mdx":"<h1 class=\"break-words\">Markdown and MDX</h1> <p><a href=\"https://daringfireball.net/projects/markdown/syntax\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Markdown</a> is a lightweight markup language used to format text. It allows you to write using plain text syntax and convert it to structurally valid HTML. It's commonly used for writing content on websites and blogs.</p> <p>You write...</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">I **love** using [Next.js](https://nextjs.org/)</pre>\n</div> <p>Output:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;p&gt;I &lt;strong&gt;love&lt;/strong&gt; using &lt;a href=\"https://nextjs.org/\"&gt;Next.js&lt;/a&gt;&lt;/p&gt;</pre>\n</div> <p><a href=\"https://mdxjs.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDX</a> is a superset of markdown that lets you write <a href=\"https://react.dev/learn/writing-markup-with-jsx\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">JSX</a> directly in your markdown files. It is a powerful way to add dynamic interactivity and embed React components within your content.</p> <p>Next.js can support both local MDX content inside your application, as well as remote MDX files fetched dynamically on the server. The Next.js plugin handles transforming markdown and React components into HTML, including support for usage in Server Components (the default in App Router).</p> <h2 id=\"nextmdx\" data-docs-heading=\"\">@next/mdx     </h2> <p>The <code>@next/mdx</code> package is used to configure Next.js so it can process markdown and MDX. <strong>It sources data from local files</strong>, allowing you to create pages with a <code>.mdx</code> extension, directly in your <code>/pages</code> or <code>/app</code> directory.</p> <p>Let's walk through how to configure and use MDX with Next.js.</p> <h2 id=\"getting-started\" data-docs-heading=\"\">Getting Started     </h2> <p>Install packages needed to render MDX:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install @next/mdx @mdx-js/loader @mdx-js/react @types/mdx</pre></div>  <p>Update the <code>next.config.js</code> file at your project's root to configure it to use MDX:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const withMDX = require('@next/mdx')()\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Configure `pageExtensions` to include MDX files\n  pageExtensions: ['js', 'jsx', 'mdx', 'ts', 'tsx'],\n  // Optionally, add any other Next.js config below\n}\n \nmodule.exports = withMDX(nextConfig)</pre></div>  <p>Then, create a new MDX page within the <code>/pages</code> directory:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">  your-project\n   pages\n      my-mdx-page.mdx\n   package.json</pre>\n</div> <p>Now you can use markdown and import React components directly inside your MDX page:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { MyComponent } from 'my-components'\n \n# Welcome to my MDX page!\n \nThis is some **bold** and _italics_ text.\n \nThis is a list in markdown:\n \n- One\n- Two\n- Three\n \nCheckout my React component:\n \n&lt;MyComponent /&gt;</pre>\n</div> <p>Navigating to the <code>/my-mdx-page</code> route should display your rendered MDX.</p> <h2 id=\"remote-mdx\" data-docs-heading=\"\">Remote MDX     </h2> <p>If your markdown or MDX files or content lives <em>somewhere else</em>, you can fetch it dynamically on the server. This is useful for content stored in a separate local folder, CMS, database, or anywhere else. A popular community package for this use is <a href=\"https://github.com/hashicorp/next-mdx-remote#react-server-components-rsc--nextjs-app-directory-support\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>next-mdx-remote</code></a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Please proceed with caution. MDX compiles to JavaScript and is executed on the server. You should only fetch MDX content from a trusted source, otherwise this can lead to remote code execution (RCE).</p> </blockquote> <p>The following example uses <code>next-mdx-remote</code>:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { serialize } from 'next-mdx-remote/serialize'\nimport { MDXRemote, MDXRemoteSerializeResult } from 'next-mdx-remote'\n \ninterface Props {\n  mdxSource: MDXRemoteSerializeResult\n}\n \nexport default function RemoteMdxPage({ mdxSource }: Props) {\n  return &lt;MDXRemote {...mdxSource} /&gt;\n}\n \nexport async function getStaticProps() {\n  // MDX text - can be from a local file, database, CMS, fetch, anywhere...\n  const res = await fetch('https:...')\n  const mdxText = await res.text()\n  const mdxSource = await serialize(mdxText)\n  return { props: { mdxSource } }\n}</pre></div> <p>Navigating to the <code>/my-mdx-page-remote</code> route should display your rendered MDX.</p> <h2 id=\"layouts\" data-docs-heading=\"\">Layouts     </h2>  <p>To share a layout around MDX pages, create a layout component:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function MdxLayout({ children }: { children: React.ReactNode }) {\n  // Create any shared layout or styles here\n  return &lt;div style={{ color: 'blue' }}&gt;{children}&lt;/div&gt;\n}</pre></div>\n<p>Then, import the layout component into the MDX page, wrap the MDX content in the layout, and export it:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import MdxLayout from '../components/mdx-layout'\n \n# Welcome to my MDX page!\n \nexport default function MDXPage({ children }) {\n  return &lt;MdxLayout&gt;{children}&lt;/MdxLayout&gt;\n \n}</pre>\n</div> <h2 id=\"remark-and-rehype-plugins\" data-docs-heading=\"\">Remark and Rehype Plugins     </h2> <p>You can optionally provide <code>remark</code> and <code>rehype</code> plugins to transform the MDX content.</p> <p>For example, you can use <code>remark-gfm</code> to support GitHub Flavored Markdown.</p> <p>Since the <code>remark</code> and <code>rehype</code> ecosystem is ESM only, you'll need to use <code>next.config.mjs</code> as the configuration file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import remarkGfm from 'remark-gfm'\nimport createMDX from '@next/mdx'\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  // Configure `pageExtensions`` to include MDX files\n  pageExtensions: ['js', 'jsx', 'mdx', 'ts', 'tsx'],\n  // Optionally, add any other Next.js config below\n}\n \nconst withMDX = createMDX({\n  // Add markdown plugins here, as desired\n  options: {\n    remarkPlugins: [remarkGfm],\n    rehypePlugins: [],\n  },\n})\n \n// Wrap MDX and Next.js config with each other\nexport default withMDX(nextConfig)</pre></div> <h2 id=\"frontmatter\" data-docs-heading=\"\">Frontmatter     </h2> <p>Frontmatter is a YAML like key/value pairing that can be used to store data about a page. <code>@next/mdx</code> does <strong>not</strong> support frontmatter by default, though there are many solutions for adding frontmatter to your MDX content, such as:</p> <ul> <li><a href=\"https://github.com/remarkjs/remark-frontmatter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">remark-frontmatter</a></li> <li><a href=\"https://github.com/remcohaszing/remark-mdx-frontmatter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">remark-mdx-frontmatter</a></li> <li>\n<a href=\"https://github.com/jonschlinkert/gray-matter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">gray-matter</a>.</li> </ul> <p>To access page metadata with <code>@next/mdx</code>, you can export a metadata object from within the <code>.mdx</code> file:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  author: 'John Doe',\n}\n \n# My MDX page</pre>\n</div> <h2 id=\"custom-elements\" data-docs-heading=\"\">Custom Elements     </h2> <p>One of the pleasant aspects of using markdown, is that it maps to native <code>HTML</code> elements, making writing fast, and intuitive:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">This is a list in markdown:\n \n- One\n- Two\n- Three</pre>\n</div> <p>The above generates the following <code>HTML</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;p&gt;This is a list in markdown:&lt;/p&gt;\n \n&lt;ul&gt;\n  &lt;li&gt;One&lt;/li&gt;\n  &lt;li&gt;Two&lt;/li&gt;\n  &lt;li&gt;Three&lt;/li&gt;\n&lt;/ul&gt;</pre>\n</div> <p>When you want to style your own elements for a custom feel to your website or application, you can pass in shortcodes. These are your own custom components that map to <code>HTML</code> elements.</p>  <p>To do this, create a <code>mdx-components.tsx</code> file at the root of your application (the parent folder of <code>pages/</code> or <code>src/</code>) and add custom elements:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { MDXComponents } from 'mdx/types'\nimport Image, { ImageProps } from 'next/image'\n \n// This file allows you to provide custom React components\n// to be used in MDX files. You can import and use any\n// React component you want, including inline styles,\n// components from other libraries, and more.\n \nexport function useMDXComponents(components: MDXComponents): MDXComponents {\n  return {\n    // Allows customizing built-in components, e.g. to add styling.\n    h1: ({ children }) =&gt; &lt;h1 style={{ fontSize: '100px' }}&gt;{children}&lt;/h1&gt;,\n    img: (props) =&gt; (\n      &lt;Image\n        sizes=\"100vw\"\n        style={{ width: '100%', height: 'auto' }}\n        {...(props as ImageProps)}\n      /&gt;\n    ),\n    ...components,\n  }\n}</pre></div>  <h2 id=\"deep-dive-how-do-you-transform-markdown-into-html\" data-docs-heading=\"\">Deep Dive: How do you transform markdown into HTML?     </h2> <p>React does not natively understand markdown. The markdown plaintext needs to first be transformed into HTML. This can be accomplished with <code>remark</code> and <code>rehype</code>.</p> <p><code>remark</code> is an ecosystem of tools around markdown. <code>rehype</code> is the same, but for HTML. For example, the following code snippet transforms markdown into HTML:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { unified } from 'unified'\nimport remarkParse from 'remark-parse'\nimport remarkRehype from 'remark-rehype'\nimport rehypeSanitize from 'rehype-sanitize'\nimport rehypeStringify from 'rehype-stringify'\n \nmain()\n \nasync function main() {\n  const file = await unified()\n    .use(remarkParse) // Convert into markdown AST\n    .use(remarkRehype) // Transform to HTML AST\n    .use(rehypeSanitize) // Sanitize HTML input\n    .use(rehypeStringify) // Convert AST into serialized HTML\n    .process('Hello, Next.js!')\n \n  console.log(String(file)) // &lt;p&gt;Hello, Next.js!&lt;/p&gt;\n}</pre>\n</div> <p>The <code>remark</code> and <code>rehype</code> ecosystem contains plugins for <a href=\"https://github.com/atomiks/rehype-pretty-code\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">syntax highlighting</a>, <a href=\"https://github.com/rehypejs/rehype-autolink-headings\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">linking headings</a>, <a href=\"https://github.com/remarkjs/remark-toc\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">generating a table of contents</a>, and more.</p> <p>When using <code>@next/mdx</code> as shown above, you <strong>do not</strong> need to use <code>remark</code> or <code>rehype</code> directly, as it is handled for you. We're describing it here for a deeper understanding of what the <code>@next/mdx</code> package is doing underneath.</p> <h2 id=\"using-the-rust-based-mdx-compiler-experimental\" data-docs-heading=\"\">Using the Rust-based MDX compiler (Experimental)     </h2> <p>Next.js supports a new MDX compiler written in Rust. This compiler is still experimental and is not recommended for production use. To use the new compiler, you need to configure <code>next.config.js</code> when you pass it to <code>withMDX</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = withMDX({\n  experimental: {\n    mdxRs: true,\n  },\n})</pre></div> <h2 id=\"helpful-links\" data-docs-heading=\"\">Helpful Links     </h2> <ul> <li><a href=\"https://mdxjs.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDX</a></li> <li><a href=\"https://www.npmjs.com/package/@next/mdx\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@next/mdx</code></a></li> <li><a href=\"https://github.com/remarkjs/remark\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">remark</a></li> <li><a href=\"https://github.com/rehypejs/rehype\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">rehype</a></li> <li><a href=\"https://markdoc.dev/docs/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Markdoc</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/mdx\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/mdx</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/draft-mode":"<h1 class=\"break-words\">Draft Mode</h1>\n<p>In the <a href=\"../routing/pages-and-layouts\">Pages documentation</a> and the <a href=\"../data-fetching\">Data Fetching documentation</a>, we talked about how to pre-render a page at build time (<strong>Static Generation</strong>) using <code>getStaticProps</code> and <code>getStaticPaths</code>.</p> <p>Static Generation is useful when your pages fetch data from a headless CMS. However, its not ideal when youre writing a draft on your headless CMS and want to view the draft immediately on your page. Youd want Next.js to render these pages at <strong>request time</strong> instead of build time and fetch the draft content instead of the published content. Youd want Next.js to bypass Static Generation only for this specific case.</p> <p>Next.js has a feature called <strong>Draft Mode</strong> which solves this problem. Here are instructions on how to use it.</p> <h2 id=\"step-1-create-and-access-the-api-route\" data-docs-heading=\"\">Step 1: Create and access the API route     </h2> <blockquote class=\"p-3 text-sm\"> <p>Take a look at the <a href=\"../routing/api-routes\">API Routes documentation</a> first if youre not familiar with Next.js API Routes.</p> </blockquote> <p>First, create the <strong>API route</strong>. It can have any name - e.g. <code>pages/api/draft.ts</code></p> <p>In this API route, you need to call <code>setDraftMode</code> on the response object.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function handler(req, res) {\n  // ...\n  res.setDraftMode({ enable: true })\n  // ...\n}</pre>\n</div> <p>This will set a <strong>cookie</strong> to enable draft mode. Subsequent requests containing this cookie will trigger <strong>Draft Mode</strong> changing the behavior for statically generated pages (more on this later).</p> <p>You can test this manually by creating an API route like below and accessing it from your browser manually:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// simple example for testing it manually from your browser.\nexport default function handler(req, res) {\n  res.setDraftMode({ enable: true })\n  res.end('Draft mode is enabled')\n}</pre></div> <p>If you open your browsers developer tools and visit <code>/api/draft</code>, youll notice a <code>Set-Cookie</code> response header with a cookie named <code>__prerender_bypass</code>.</p> <h3 id=\"securely-accessing-it-from-your-headless-cms\" data-docs-heading=\"\">Securely accessing it from your Headless CMS     </h3> <p>In practice, youd want to call this API route <em>securely</em> from your headless CMS. The specific steps will vary depending on which headless CMS youre using, but here are some common steps you could take.</p> <p>These steps assume that the headless CMS youre using supports setting <strong>custom draft URLs</strong>. If it doesnt, you can still use this method to secure your draft URLs, but youll need to construct and access the draft URL manually.</p> <p><strong>First</strong>, you should create a <strong>secret token string</strong> using a token generator of your choice. This secret will only be known by your Next.js app and your headless CMS. This secret prevents people who dont have access to your CMS from accessing draft URLs.</p> <p><strong>Second</strong>, if your headless CMS supports setting custom draft URLs, specify the following as the draft URL. This assumes that your draft API route is located at <code>pages/api/draft.ts</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://&lt;your-site&gt;/api/draft?secret=&lt;token&gt;&amp;slug=&lt;path&gt;</pre></div> <ul> <li>\n<code>&lt;your-site&gt;</code> should be your deployment domain.</li> <li>\n<code>&lt;token&gt;</code> should be replaced with the secret token you generated.</li> <li>\n<code>&lt;path&gt;</code> should be the path for the page that you want to view. If you want to view <code>/posts/foo</code>, then you should use <code>&amp;slug=/posts/foo</code>.</li> </ul> <p>Your headless CMS might allow you to include a variable in the draft URL so that <code>&lt;path&gt;</code> can be set dynamically based on the CMSs data like so: <code>&amp;slug=/posts/{entry.fields.slug}</code></p> <p><strong>Finally</strong>, in the draft API route:</p> <ul> <li>Check that the secret matches and that the <code>slug</code> parameter exists (if not, the request should fail).</li> <li> <li>Call <code>res.setDraftMode</code>.</li> <li>Then redirect the browser to the path specified by <code>slug</code>. (The following example uses a <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Status/307\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">307 redirect</a>).</li> </ul> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async (req, res) =&gt; {\n  // Check the secret and next parameters\n  // This secret should only be known to this API route and the CMS\n  if (req.query.secret !== 'MY_SECRET_TOKEN' || !req.query.slug) {\n    return res.status(401).json({ message: 'Invalid token' })\n  }\n \n  // Fetch the headless CMS to check if the provided `slug` exists\n  // getPostBySlug would implement the required fetching logic to the headless CMS\n  const post = await getPostBySlug(req.query.slug)\n \n  // If the slug doesn't exist prevent draft mode from being enabled\n  if (!post) {\n    return res.status(401).json({ message: 'Invalid slug' })\n  }\n \n  // Enable Draft Mode by setting the cookie\n  res.setDraftMode({ enable: true })\n \n  // Redirect to the path from the fetched post\n  // We don't redirect to req.query.slug as that might lead to open redirect vulnerabilities\n  res.redirect(post.slug)\n}</pre>\n</div> <p>If it succeeds, then the browser will be redirected to the path you want to view with the draft mode cookie.</p> <h2 id=\"step-2-update-getstaticprops\" data-docs-heading=\"\">Step 2: Update getStaticProps     </h2> <p>The next step is to update <code>getStaticProps</code> to support draft mode.</p> <p>If you request a page which has <code>getStaticProps</code> with the cookie set (via <code>res.setDraftMode</code>), then <code>getStaticProps</code> will be called at <strong>request time</strong> (instead of at build time).</p> <p>Furthermore, it will be called with a <code>context</code> object where <code>context.draftMode</code> will be <code>true</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps(context) {\n  if (context.draftMode) {\n    // dynamic data\n  }\n}</pre>\n</div> <p>We used <code>res.setDraftMode</code> in the draft API route, so <code>context.draftMode</code> will be <code>true</code>.</p> <p>If youre also using <code>getStaticPaths</code>, then <code>context.params</code> will also be available.</p> <h3 id=\"fetch-draft-data\" data-docs-heading=\"\">Fetch draft data     </h3> <p>You can update <code>getStaticProps</code> to fetch different data based on <code>context.draftMode</code>.</p> <p>For example, your headless CMS might have a different API endpoint for draft posts. If so, you can modify the API endpoint URL like below:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps(context) {\n  const url = context.draftMode\n    ? 'https://draft.example.com'\n    : 'https://production.example.com'\n  const res = await fetch(url)\n  // ...\n}</pre>\n</div> <p>Thats it! If you access the draft API route (with <code>secret</code> and <code>slug</code>) from your headless CMS or manually, you should now be able to see the draft content. And if you update your draft without publishing, you should be able to view the draft.</p> <p>Set this as the draft URL on your headless CMS or access manually, and you should be able to see the draft.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://&lt;your-site&gt;/api/draft?secret=&lt;token&gt;&amp;slug=&lt;path&gt;</pre></div> <h2 id=\"more-details\" data-docs-heading=\"\">More Details     </h2> <h3 id=\"clear-the-draft-mode-cookie\" data-docs-heading=\"\">Clear the Draft Mode cookie     </h3> <p>By default, the Draft Mode session ends when the browser is closed.</p> <p>To clear the Draft Mode cookie manually, create an API route that calls <code>setDraftMode({ enable: false })</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function handler(req, res) {\n  res.setDraftMode({ enable: false })\n}</pre></div> <p>Then, send a request to <code>/api/disable-draft</code> to invoke the API Route. If calling this route using <a href=\"../../api-reference/components/link\"><code>next/link</code></a>, you must pass <code>prefetch={false}</code> to prevent accidentally deleting the cookie on prefetch.</p> <h3 id=\"works-with-getserversideprops\" data-docs-heading=\"\">Works with getServerSideProps     </h3> <p>Draft Mode works with <code>getServerSideProps</code>, and is available as a <code>draftMode</code> key in the <a href=\"../../api-reference/functions/get-server-side-props#context-parameter\"><code>context</code></a> object.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You shouldn't set the <code>Cache-Control</code> header when using Draft Mode because it cannot be bypassed. Instead, we recommend using <a href=\"../data-fetching/incremental-static-regeneration\">ISR</a>.</p> </blockquote> <h3 id=\"works-with-api-routes\" data-docs-heading=\"\">Works with API Routes     </h3> <p>API Routes will have access to <code>draftMode</code> on the request object. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function myApiRoute(req, res) {\n  if (req.draftMode) {\n    // get draft data\n  }\n}</pre>\n</div> <h3 id=\"unique-per-next-build\" data-docs-heading=\"\">Unique per next build     </h3> <p>A new bypass cookie value will be generated each time you run <code>next build</code>.</p> <p>This ensures that the bypass cookie cant be guessed.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: To test Draft Mode locally over HTTP, your browser will need to allow third-party cookies and local storage access.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/draft-mode\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/draft-mode</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/error-handling":"<h1 class=\"break-words\">Error Handling</h1>\n<p>This documentation explains how you can handle development, server-side, and client-side errors.</p> <h2 id=\"handling-errors-in-development\" data-docs-heading=\"\">Handling Errors in Development     </h2> <p>When there is a runtime error during the development phase of your Next.js application, you will encounter an <strong>overlay</strong>. It is a modal that covers the webpage. It is <strong>only</strong> visible when the development server runs using <code>next dev</code> via <code>pnpm dev</code>, <code>npm run dev</code>, <code>yarn dev</code>, or <code>bun dev</code> and will not be shown in production. Fixing the error will automatically dismiss the overlay.</p> <p>Here is an example of an overlay:</p>  <p><img src=\"https://assets.vercel.com/image/upload/v1645118290/docs-assets/static/docs/error-handling/overlay.png\" alt=\"Example of an overlay when in development mode\"></p> <h2 id=\"handling-server-errors\" data-docs-heading=\"\">Handling Server Errors     </h2> <p>Next.js provides a static 500 page by default to handle server-side errors that occur in your application. You can also <a href=\"../routing/custom-error#customizing-the-500-page\">customize this page</a> by creating a <code>pages/500.js</code> file.</p> <p>Having a 500 page in your application does not show specific errors to the app user.</p> <p>You can also use <a href=\"../routing/custom-error#404-page\">404 page</a> to handle specific runtime error like <code>file not found</code>.</p> <h2 id=\"handling-client-errors\" data-docs-heading=\"\">Handling Client Errors     </h2> <p>React <a href=\"https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Error Boundaries</a> is a graceful way to handle a JavaScript error on the client so that the other parts of the application continue working. In addition to preventing the page from crashing, it allows you to provide a custom fallback component and even log error information.</p> <p>To use Error Boundaries for your Next.js application, you must create a class component <code>ErrorBoundary</code> and wrap the <code>Component</code> prop in the <code>pages/_app.js</code> file. This component will be responsible to:</p> <ul> <li>Render a fallback UI after an error is thrown</li> <li>Provide a way to reset the Application's state</li> <li>Log error information</li> </ul> <p>You can create an <code>ErrorBoundary</code> class component by extending <code>React.Component</code>. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props)\n \n    // Define a state variable to track whether is an error or not\n    this.state = { hasError: false }\n  }\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI\n \n    return { hasError: true }\n  }\n  componentDidCatch(error, errorInfo) {\n    // You can use your own error logging service here\n    console.log({ error, errorInfo })\n  }\n  render() {\n    // Check if the error is thrown\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return (\n        &lt;div&gt;\n          &lt;h2&gt;Oops, there is an error!&lt;/h2&gt;\n          &lt;button\n            type=\"button\"\n            onClick={() =&gt; this.setState({ hasError: false })}\n          &gt;\n            Try again?\n          &lt;/button&gt;\n        &lt;/div&gt;\n      )\n    }\n \n    // Return children components in case of no error\n \n    return this.props.children\n  }\n}\n \nexport default ErrorBoundary</pre>\n</div> <p>The <code>ErrorBoundary</code> component keeps track of an <code>hasError</code> state. The value of this state variable is a boolean. When the value of <code>hasError</code> is <code>true</code>, then the <code>ErrorBoundary</code> component will render a fallback UI. Otherwise, it will render the children components.</p> <p>After creating an <code>ErrorBoundary</code> component, import it in the <code>pages/_app.js</code> file to wrap the <code>Component</code> prop in your Next.js application.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Import the ErrorBoundary component\nimport ErrorBoundary from '../components/ErrorBoundary'\n \nfunction MyApp({ Component, pageProps }) {\n  return (\n    // Wrap the Component prop with ErrorBoundary component\n    &lt;ErrorBoundary&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/ErrorBoundary&gt;\n  )\n}\n \nexport default MyApp</pre>\n</div> <p>You can learn more about <a href=\"https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Error Boundaries</a> in React's documentation.</p> <h3 id=\"reporting-errors\" data-docs-heading=\"\">Reporting Errors     </h3> <p>To monitor client errors, use a service like <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-sentry\" rel=\"noopener noreferrer\" target=\"_blank\">Sentry</a>, Bugsnag or Datadog.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/error-handling\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/error-handling</a>\n  </p>\n</div>\n","pages/building-your-application/optimizing/instrumentation":"<h1 class=\"break-words\">Instrumentation</h1> <p>Instrumentation is the process of using code to integrate monitoring and logging tools into your application. This allows you to track the performance and behavior of your application, and to debug issues in production.</p> <h2 id=\"convention\" data-docs-heading=\"\">Convention     </h2> <p>To set up instrumentation, create <code>instrumentation.ts|js</code> file in the <strong>root directory</strong> of your project (or inside the <a href=\"../../../app/building-your-application/configuring/src-directory\"><code>src</code></a> folder if using one).</p> <p>Then, export a <code>register</code> function in the file. This function will be called <strong>once</strong> when a new Next.js server instance is initiated.</p> <p>For example, to use Next.js with <a href=\"https://opentelemetry.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">OpenTelemetry</a> and <a href=\"https://vercel.com/docs/observability/otel-overview\" rel=\"noopener noreferrer\" target=\"_blank\">@vercel/otel</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { registerOTel } from '@vercel/otel'\n \nexport function register() {\n  registerOTel('next-app')\n}</pre></div>  <p>See the <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-opentelemetry\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with OpenTelemetry example</a> for a complete implementation.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong></p> <ul> <li>This feature is <strong>experimental</strong>. To use it, you must explicitly opt in by defining <a href=\"../../../app/api-reference/next-config-js/instrumentationhook\"><code>experimental.instrumentationHook = true;</code></a> in your <code>next.config.js</code>.</li> <li>The <code>instrumentation</code> file should be in the root of your project and not inside the <code>app</code> or <code>pages</code> directory. If you're using the <code>src</code> folder, then place the file inside <code>src</code> alongside <code>pages</code> and <code>app</code>.</li> <li>If you use the <a href=\"../../../app/api-reference/next-config-js/pageextensions\"><code>pageExtensions</code> config option</a> to add a suffix, you will also need to update the <code>instrumentation</code> filename to match.</li> </ul> </blockquote> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"importing-files-with-side-effects\" data-docs-heading=\"\">Importing files with side effects     </h3> <p>Sometimes, it may be useful to import a file in your code because of the side effects it will cause. For example, you might import a file that defines a set of global variables, but never explicitly use the imported file in your code. You would still have access to the global variables the package has declared.</p> <p>We recommend importing files using JavaScript <code>import</code> syntax within your <code>register</code> function. The following example demonstrates a basic usage of <code>import</code> in a <code>register</code> function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function register() {\n  await import('package-with-side-effect')\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <p>We recommend importing the file from within the <code>register</code> function, rather than at the top of the file. By doing this, you can colocate all of your side effects in one place in your code, and avoid any unintended consequences from importing globally at the top of the file.</p> </blockquote> <h3 id=\"importing-runtime-specific-code\" data-docs-heading=\"\">Importing runtime-specific code     </h3> <p>Next.js calls <code>register</code> in all environments, so it's important to conditionally import any code that doesn't support specific runtimes (e.g. <a href=\"../../../app/building-your-application/rendering/edge-and-nodejs-runtimes#edge-runtime\">Edge</a> or <a href=\"../../../app/building-your-application/rendering/edge-and-nodejs-runtimes#nodejs-runtime\">Node.js</a>). You can use the <code>NEXT_RUNTIME</code> environment variable to get the current environment:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function register() {\n  if (process.env.NEXT_RUNTIME === 'nodejs') {\n    await import('./instrumentation-node')\n  }\n \n  if (process.env.NEXT_RUNTIME === 'edge') {\n    await import('./instrumentation-edge')\n  }\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/optimizing/instrumentation\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/optimizing/instrumentation</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/amp":"<h1 class=\"break-words\">AMP</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/amp\" rel=\"noopener noreferrer\" target=\"_blank\">AMP</a></li> </ul></details> <p>With Next.js you can turn any React page into an AMP page, with minimal config, and without leaving React.</p> <p>You can read more about AMP in the official <a href=\"https://amp.dev/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">amp.dev</a> site.</p> <h2 id=\"enabling-amp\" data-docs-heading=\"\">Enabling AMP     </h2> <p>To enable AMP support for a page, and to learn more about the different AMP configs, read the <a href=\"amp\">API documentation for <code>next/amp</code></a>.</p> <h2 id=\"caveats\" data-docs-heading=\"\">Caveats     </h2> <ul> <li>Only CSS-in-JS is supported. <a href=\"../styling\">CSS Modules</a> aren't supported by AMP pages at the moment. You can <a href=\"https://github.com/vercel/next.js/issues/10549\" rel=\"noopener noreferrer\" target=\"_blank\">contribute CSS Modules support to Next.js</a>.</li> </ul> <h2 id=\"adding-amp-components\" data-docs-heading=\"\">Adding AMP Components     </h2> <p>The AMP community provides <a href=\"https://amp.dev/documentation/components/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">many components</a> to make AMP pages more interactive. Next.js will automatically import all components used on a page and there is no need to manually import AMP component scripts:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = { amp: true }\n \nfunction MyAmpPage() {\n  const date = new Date()\n \n  return (\n    &lt;div&gt;\n      &lt;p&gt;Some time: {date.toJSON()}&lt;/p&gt;\n      &lt;amp-timeago\n        width=\"0\"\n        height=\"15\"\n        datetime={date.toJSON()}\n        layout=\"responsive\"\n      &gt;\n        .\n      &lt;/amp-timeago&gt;\n    &lt;/div&gt;\n  )\n}\n \nexport default MyAmpPage</pre>\n</div> <p>The above example uses the <a href=\"https://amp.dev/documentation/components/amp-timeago/?format=websites\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>amp-timeago</code></a> component.</p> <p>By default, the latest version of a component is always imported. If you want to customize the version, you can use <code>next/head</code>, as in the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Head from 'next/head'\n \nexport const config = { amp: true }\n \nfunction MyAmpPage() {\n  const date = new Date()\n \n  return (\n    &lt;div&gt;\n      &lt;Head&gt;\n        &lt;script\n          async\n          key=\"amp-timeago\"\n          custom-element=\"amp-timeago\"\n          src=\"https://cdn.ampproject.org/v0/amp-timeago-0.1.js\"\n        /&gt;\n      &lt;/Head&gt;\n \n      &lt;p&gt;Some time: {date.toJSON()}&lt;/p&gt;\n      &lt;amp-timeago\n        width=\"0\"\n        height=\"15\"\n        datetime={date.toJSON()}\n        layout=\"responsive\"\n      &gt;\n        .\n      &lt;/amp-timeago&gt;\n    &lt;/div&gt;\n  )\n}\n \nexport default MyAmpPage</pre>\n</div> <h2 id=\"amp-validation\" data-docs-heading=\"\">AMP Validation     </h2> <p>AMP pages are automatically validated with <a href=\"https://www.npmjs.com/package/amphtml-validator\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">amphtml-validator</a> during development. Errors and warnings will appear in the terminal where you started Next.js.</p> <p>Pages are also validated during <a href=\"../deploying/static-exports\">Static HTML export</a> and any warnings / errors will be printed to the terminal. Any AMP errors will cause the export to exit with status code <code>1</code> because the export is not valid AMP.</p> <h3 id=\"custom-validators\" data-docs-heading=\"\">Custom Validators     </h3> <p>You can set up custom AMP validator in <code>next.config.js</code> as shown below:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  amp: {\n    validator: './custom_validator.js',\n  },\n}</pre>\n</div> <h3 id=\"skip-amp-validation\" data-docs-heading=\"\">Skip AMP Validation     </h3> <p>To turn off AMP validation add the following code to <code>next.config.js</code></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">experimental: {\n  amp: {\n    skipValidation: true\n  }\n}</pre>\n</div> <h3 id=\"amp-in-static-html-export\" data-docs-heading=\"\">AMP in Static HTML Export     </h3> <p>When using <a href=\"../deploying/static-exports\">Static HTML export</a> statically prerender pages, Next.js will detect if the page supports AMP and change the exporting behavior based on that.</p> <p>For example, the hybrid AMP page <code>pages/about.js</code> would output:</p> <ul> <li>\n<code>out/about.html</code> - HTML page with client-side React runtime</li> <li>\n<code>out/about.amp.html</code> - AMP page</li> </ul> <p>And if <code>pages/about.js</code> is an AMP-only page, then it would output:</p> <ul> <li>\n<code>out/about.html</code> - Optimized AMP page</li> </ul> <p>Next.js will automatically insert a link to the AMP version of your page in the HTML version, so you don't have to, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"amphtml\" href=\"/about.amp.html\" /&gt;</pre>\n</div> <p>And the AMP version of your page will include a link to the HTML page:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"canonical\" href=\"/about\" /&gt;</pre>\n</div> <p>When <a href=\"../../api-reference/next-config-js/trailingslash\"><code>trailingSlash</code></a> is enabled the exported pages for <code>pages/about.js</code> would be:</p> <ul> <li>\n<code>out/about/index.html</code> - HTML page</li> <li>\n<code>out/about.amp/index.html</code> - AMP page</li> </ul> <h2 id=\"typescript\" data-docs-heading=\"\">TypeScript     </h2> <p>AMP currently doesn't have built-in types for TypeScript, but it's in their roadmap (<a href=\"https://github.com/ampproject/amphtml/issues/13791\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">#13791</a>).</p> <p>As a workaround you can manually create a file called <code>amp.d.ts</code> inside your project and add these <a href=\"https://stackoverflow.com/a/50601125\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">custom types</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/amp\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/amp</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/babel":"<h1 class=\"break-words\">Babel</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-custom-babel-config\" rel=\"noopener noreferrer\" target=\"_blank\">Customizing babel configuration</a></li> </ul></details> <p>Next.js includes the <code>next/babel</code> preset to your app, which includes everything needed to compile React applications and server-side code. But if you want to extend the default Babel configs, it's also possible.</p> <h2 id=\"adding-presets-and-plugins\" data-docs-heading=\"\">Adding Presets and Plugins     </h2> <p>To start, you only need to define a <code>.babelrc</code> file (or <code>babel.config.js</code>) in the root directory of your project. If such a file is found, it will be considered as the <em>source of truth</em>, and therefore it needs to define what Next.js needs as well, which is the <code>next/babel</code> preset.</p> <p>Here's an example <code>.babelrc</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"presets\": [\"next/babel\"],\n  \"plugins\": []\n}</pre></div> <p>You can <a href=\"https://github.com/vercel/next.js/blob/canary/packages/next/src/build/babel/preset.ts\" rel=\"noopener noreferrer\" target=\"_blank\">take a look at this file</a> to learn about the presets included by <code>next/babel</code>.</p> <p>To add presets/plugins <strong>without configuring them</strong>, you can do it this way:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"presets\": [\"next/babel\"],\n  \"plugins\": [\"@babel/plugin-proposal-do-expressions\"]\n}</pre></div> <h2 id=\"customizing-presets-and-plugins\" data-docs-heading=\"\">Customizing Presets and Plugins     </h2> <p>To add presets/plugins <strong>with custom configuration</strong>, do it on the <code>next/babel</code> preset like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"presets\": [\n    [\n      \"next/babel\",\n      {\n        \"preset-env\": {},\n        \"transform-runtime\": {},\n        \"styled-jsx\": {},\n        \"class-properties\": {}\n      }\n    ]\n  ],\n  \"plugins\": []\n}</pre></div> <p>To learn more about the available options for each config, visit babel's <a href=\"https://babeljs.io/docs/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">documentation</a> site.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Next.js uses the <a href=\"https://github.com/nodejs/release#release-schedule\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><strong>current</strong> Node.js version</a> for server-side compilations.</li> <li>The <code>modules</code> option on <code>\"preset-env\"</code> should be kept to <code>false</code>, otherwise webpack code splitting is turned off.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/babel\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/babel</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/post-css":"<h1 class=\"break-words\">PostCSS</h1>\n<details open=\"\"><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-tailwindcss\" rel=\"noopener noreferrer\" target=\"_blank\">Tailwind CSS Example</a></li> </ul></details> <h2 id=\"default-behavior\" data-docs-heading=\"\">Default Behavior     </h2> <p>Next.js compiles CSS for its <a href=\"../styling\">built-in CSS support</a> using PostCSS.</p> <p>Out of the box, with no configuration, Next.js compiles CSS with the following transformations:</p> <ul> <li>\n<a href=\"https://github.com/postcss/autoprefixer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Autoprefixer</a> automatically adds vendor prefixes to CSS rules (back to IE11).</li> <li>\n<a href=\"https://github.com/philipwalton/flexbugs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cross-browser Flexbox bugs</a> are corrected to behave like <a href=\"https://www.w3.org/TR/css-flexbox-1/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">the spec</a>.</li> <li>New CSS features are automatically compiled for Internet Explorer 11 compatibility: <ul> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/all\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>all</code> Property</a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/break-after\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Break Properties</a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/font-variant\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>font-variant</code> Property</a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/gap\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Gap Properties</a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/Media_Queries/Using_media_queries#Syntax_improvements_in_Level_4\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Media Query Ranges</a></li> </ul> </li> </ul> <p>By default, <a href=\"https://www.w3.org/TR/css-grid-1/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">CSS Grid</a> and <a href=\"https://developer.mozilla.org/docs/Web/CSS/var\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Custom Properties</a> (CSS variables) are <strong>not compiled</strong> for IE11 support.</p> <p>To compile <a href=\"https://developer.mozilla.org/docs/Web/CSS/grid\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">CSS Grid Layout</a> for IE11, you can place the following comment at the top of your CSS file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/* autoprefixer grid: autoplace */</pre>\n</div> <p>You can also enable IE11 support for <a href=\"https://developer.mozilla.org/docs/Web/CSS/grid\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">CSS Grid Layout</a> in your entire project by configuring autoprefixer with the configuration shown below (collapsed). See <a href=\"#customizing-plugins\">\"Customizing Plugins\"</a> below for more information.</p> <details><summary>Click to view the configuration to enable CSS Grid Layout</summary><div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"plugins\": [\n    \"postcss-flexbugs-fixes\",\n    [\n      \"postcss-preset-env\",\n      {\n        \"autoprefixer\": {\n          \"flexbox\": \"no-2009\",\n          \"grid\": \"autoplace\"\n        },\n        \"stage\": 3,\n        \"features\": {\n          \"custom-properties\": false\n        }\n      }\n    ]\n  ]\n}</pre></div></details> <p>CSS variables are not compiled because it is <a href=\"https://github.com/MadLittleMods/postcss-css-variables#caveats\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">not possible to safely do so</a>. If you must use variables, consider using something like <a href=\"https://sass-lang.com/documentation/variables\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Sass variables</a> which are compiled away by <a href=\"https://sass-lang.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Sass</a>.</p> <h2 id=\"customizing-target-browsers\" data-docs-heading=\"\">Customizing Target Browsers     </h2> <p>Next.js allows you to configure the target browsers (for <a href=\"https://github.com/postcss/autoprefixer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Autoprefixer</a> and compiled css features) through <a href=\"https://github.com/browserslist/browserslist\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Browserslist</a>.</p> <p>To customize browserslist, create a <code>browserslist</code> key in your <code>package.json</code> like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"browserslist\": [\"&gt;0.3%\", \"not dead\", \"not op_mini all\"]\n}</pre></div> <p>You can use the <a href=\"https://browsersl.ist/?q=%3E0.3%25%2C+not+ie+11%2C+not+dead%2C+not+op_mini+all\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">browsersl.ist</a> tool to visualize what browsers you are targeting.</p> <h2 id=\"css-modules\" data-docs-heading=\"\">CSS Modules     </h2> <p>No configuration is needed to support CSS Modules. To enable CSS Modules for a file, rename the file to have the extension <code>.module.css</code>.</p> <p>You can learn more about <a href=\"../styling\">Next.js' CSS Module support here</a>.</p> <h2 id=\"customizing-plugins\" data-docs-heading=\"\">Customizing Plugins     </h2> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: When you define a custom PostCSS configuration file, Next.js <strong>completely disables</strong> the <a href=\"#default-behavior\">default behavior</a>. Be sure to manually configure all the features you need compiled, including <a href=\"https://github.com/postcss/autoprefixer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Autoprefixer</a>. You also need to install any plugins included in your custom configuration manually, i.e. <code>npm install postcss-flexbugs-fixes postcss-preset-env</code>.</p> </blockquote> <p>To customize the PostCSS configuration, create a <code>postcss.config.json</code> file in the root of your project.</p> <p>This is the default configuration used by Next.js:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"plugins\": [\n    \"postcss-flexbugs-fixes\",\n    [\n      \"postcss-preset-env\",\n      {\n        \"autoprefixer\": {\n          \"flexbox\": \"no-2009\"\n        },\n        \"stage\": 3,\n        \"features\": {\n          \"custom-properties\": false\n        }\n      }\n    ]\n  ]\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Next.js also allows the file to be named <code>.postcssrc.json</code>, or, to be read from the <code>postcss</code> key in <code>package.json</code>.</p> </blockquote> <p>It is also possible to configure PostCSS with a <code>postcss.config.js</code> file, which is useful when you want to conditionally include plugins based on environment:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  plugins:\n    process.env.NODE_ENV === 'production'\n      ? [\n          'postcss-flexbugs-fixes',\n          [\n            'postcss-preset-env',\n            {\n              autoprefixer: {\n                flexbox: 'no-2009',\n              },\n              stage: 3,\n              features: {\n                'custom-properties': false,\n              },\n            },\n          ],\n        ]\n      : [\n          // No transformations in development\n        ],\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Next.js also allows the file to be named <code>.postcssrc.js</code>.</p> </blockquote> <p>Do <strong>not use <code>require()</code></strong> to import the PostCSS Plugins. Plugins must be provided as strings.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If your <code>postcss.config.js</code> needs to support other non-Next.js tools in the same project, you must use the interoperable object-based format instead:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  plugins: {\n    'postcss-flexbugs-fixes': {},\n    'postcss-preset-env': {\n      autoprefixer: {\n        flexbox: 'no-2009',\n      },\n      stage: 3,\n      features: {\n        'custom-properties': false,\n      },\n    },\n  },\n}</pre>\n</div> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/post-css\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/post-css</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/debugging":"<h1 class=\"break-words\">Debugging</h1>\n<p>This documentation explains how you can debug your Next.js frontend and backend code with full source maps support using either the <a href=\"https://code.visualstudio.com/docs/editor/debugging\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">VS Code debugger</a> or <a href=\"https://developers.google.com/web/tools/chrome-devtools\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Chrome DevTools</a>.</p> <p>Any debugger that can attach to Node.js can also be used to debug a Next.js application. You can find more details in the Node.js <a href=\"https://nodejs.org/en/docs/guides/debugging-getting-started/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Debugging Guide</a>.</p> <h2 id=\"debugging-with-vs-code\" data-docs-heading=\"\">Debugging with VS Code     </h2> <p>Create a file named <code>.vscode/launch.json</code> at the root of your project with the following content:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \"Next.js: debug server-side\",\n      \"type\": \"node-terminal\",\n      \"request\": \"launch\",\n      \"command\": \"npm run dev\"\n    },\n    {\n      \"name\": \"Next.js: debug client-side\",\n      \"type\": \"chrome\",\n      \"request\": \"launch\",\n      \"url\": \"http://localhost:3000\"\n    },\n    {\n      \"name\": \"Next.js: debug full stack\",\n      \"type\": \"node-terminal\",\n      \"request\": \"launch\",\n      \"command\": \"npm run dev\",\n      \"serverReadyAction\": {\n        \"pattern\": \"- Local:.+(https?://.+)\",\n        \"uriFormat\": \"%s\",\n        \"action\": \"debugWithChrome\"\n      }\n    }\n  ]\n}</pre></div> <p><code>npm run dev</code> can be replaced with <code>yarn dev</code> if you're using Yarn or <code>pnpm dev</code> if you're using pnpm.</p> <p>If you're <a href=\"../../api-reference/next-cli#development\">changing the port number</a> your application starts on, replace the <code>3000</code> in <code>http://localhost:3000</code> with the port you're using instead.</p> <p>If you're running Next.js from a directory other than root (for example, if you're using Turborepo) then you need to add <code>cwd</code> to the server-side and full stack debugging tasks. For example, <code>\"cwd\": \"${workspaceFolder}/apps/web\"</code>.</p> <p>Now go to the Debug panel (<code>Ctrl+Shift+D</code> on Windows/Linux, <code>++D</code> on macOS), select a launch configuration, then press <code>F5</code> or select <strong>Debug: Start Debugging</strong> from the Command Palette to start your debugging session.</p> <h2 id=\"using-the-debugger-in-jetbrains-webstorm\" data-docs-heading=\"\">Using the Debugger in Jetbrains WebStorm     </h2> <p>Click the drop down menu listing the runtime configuration, and click <code>Edit Configurations...</code>. Create a <code>Javascript Debug</code> debug configuration with <code>http://localhost:3000</code> as the URL. Customize to your liking (e.g. Browser for debugging, store as project file), and click <code>OK</code>. Run this debug configuration, and the selected browser should automatically open. At this point, you should have 2 applications in debug mode: the NextJS node application, and the client/ browser application.</p> <h2 id=\"debugging-with-chrome-devtools\" data-docs-heading=\"\">Debugging with Chrome DevTools     </h2> <h3 id=\"client-side-code\" data-docs-heading=\"\">Client-side code     </h3> <p>Start your development server as usual by running <code>next dev</code>, <code>npm run dev</code>, or <code>yarn dev</code>. Once the server starts, open <code>http://localhost:3000</code> (or your alternate URL) in Chrome. Next, open Chrome's Developer Tools (<code>Ctrl+Shift+J</code> on Windows/Linux, <code>++I</code> on macOS), then go to the <strong>Sources</strong> tab.</p> <p>Now, any time your client-side code reaches a <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/debugger\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>debugger</code></a> statement, code execution will pause and that file will appear in the debug area. You can also press <code>Ctrl+P</code> on Windows/Linux or <code>+P</code> on macOS to search for a file and set breakpoints manually. Note that when searching here, your source files will have paths starting with <code>webpack://_N_E/./</code>.</p> <h3 id=\"server-side-code\" data-docs-heading=\"\">Server-side code     </h3> <p>To debug server-side Next.js code with Chrome DevTools, you need to pass the <a href=\"https://nodejs.org/api/cli.html#cli_inspect_host_port\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>--inspect</code></a> flag to the underlying Node.js process:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">NODE_OPTIONS='--inspect' next dev</pre></div> <p>If you're using <code>npm run dev</code> or <code>yarn dev</code> then you should update the <code>dev</code> script on your <code>package.json</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"NODE_OPTIONS='--inspect' next dev\"\n  }\n}</pre></div> <p>Launching the Next.js dev server with the <code>--inspect</code> flag will look something like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Debugger listening on ws://127.0.0.1:9229/0cf90313-350d-4466-a748-cd60f4e47c95\nFor help, see: https://nodejs.org/en/docs/inspector\nready - started server on 0.0.0.0:3000, url: http://localhost:3000</pre></div> <blockquote class=\"p-3 text-sm\"> <p>Be aware that running <code>NODE_OPTIONS='--inspect' npm run dev</code> or <code>NODE_OPTIONS='--inspect' yarn dev</code> won't work. This would try to start multiple debuggers on the same port: one for the npm/yarn process and one for Next.js. You would then get an error like <code>Starting inspector on 127.0.0.1:9229 failed: address already in use</code> in your console.</p> </blockquote> <p>Once the server starts, open a new tab in Chrome and visit <code>chrome://inspect</code>, where you should see your Next.js application inside the <strong>Remote Target</strong> section. Click <strong>inspect</strong> under your application to open a separate DevTools window, then go to the <strong>Sources</strong> tab.</p> <p>Debugging server-side code here works much like debugging client-side code with Chrome DevTools, except that when you search for files here with <code>Ctrl+P</code> or <code>+P</code>, your source files will have paths starting with <code>webpack://{application-name}/./</code> (where <code>{application-name}</code> will be replaced with the name of your application according to your <code>package.json</code> file).</p> <h3 id=\"debugging-on-windows\" data-docs-heading=\"\">Debugging on Windows     </h3> <p>Windows users may run into an issue when using <code>NODE_OPTIONS='--inspect'</code> as that syntax is not supported on Windows platforms. To get around this, install the <a href=\"https://www.npmjs.com/package/cross-env\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>cross-env</code></a> package as a development dependency (<code>-D</code> with <code>npm</code> and <code>yarn</code>) and replace the <code>dev</code> script with the following.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"cross-env NODE_OPTIONS='--inspect' next dev\"\n  }\n}</pre></div> <p><code>cross-env</code> will set the <code>NODE_OPTIONS</code> environment variable regardless of which platform you are on (including Mac, Linux, and Windows) and allow you to debug consistently across devices and operating systems.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Ensure Windows Defender is disabled on your machine. This external service will check <em>every file read</em>, which has been reported to greatly increase Fast Refresh time with <code>next dev</code>. This is a known issue, not related to Next.js, but it does affect Next.js development.</p> </blockquote> <h2 id=\"more-information\" data-docs-heading=\"\">More information     </h2> <p>To learn more about how to use a JavaScript debugger, take a look at the following documentation:</p> <ul> <li><a href=\"https://code.visualstudio.com/docs/nodejs/nodejs-debugging#_breakpoints\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.js debugging in VS Code: Breakpoints</a></li> <li><a href=\"https://developers.google.com/web/tools/chrome-devtools/javascript\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Chrome DevTools: Debug JavaScript</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/debugging\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/debugging</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/preview-mode":"<h1 class=\"break-words\">Preview Mode</h1>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: This feature is superseded by <a href=\"draft-mode\">Draft Mode</a>.</p> </blockquote> <details><summary>Examples</summary><ul> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-wordpress\" rel=\"noopener noreferrer\" target=\"_blank\">WordPress Example</a> (<a href=\"https://next-blog-wordpress.vercel.app\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-datocms\" rel=\"noopener noreferrer\" target=\"_blank\">DatoCMS Example</a> (<a href=\"https://next-blog-datocms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-takeshape\" rel=\"noopener noreferrer\" target=\"_blank\">TakeShape Example</a> (<a href=\"https://next-blog-takeshape.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-sanity\" rel=\"noopener noreferrer\" target=\"_blank\">Sanity Example</a> (<a href=\"https://next-blog-sanity.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-prismic\" rel=\"noopener noreferrer\" target=\"_blank\">Prismic Example</a> (<a href=\"https://next-blog-prismic.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-contentful\" rel=\"noopener noreferrer\" target=\"_blank\">Contentful Example</a> (<a href=\"https://next-blog-contentful.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-strapi\" rel=\"noopener noreferrer\" target=\"_blank\">Strapi Example</a> (<a href=\"https://next-blog-strapi.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-prepr\" rel=\"noopener noreferrer\" target=\"_blank\">Prepr Example</a> (<a href=\"https://next-blog-prepr.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-agilitycms\" rel=\"noopener noreferrer\" target=\"_blank\">Agility CMS Example</a> (<a href=\"https://next-blog-agilitycms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-cosmic\" rel=\"noopener noreferrer\" target=\"_blank\">Cosmic Example</a> (<a href=\"https://next-blog-cosmic.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-buttercms\" rel=\"noopener noreferrer\" target=\"_blank\">ButterCMS Example</a> (<a href=\"https://next-blog-buttercms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-storyblok\" rel=\"noopener noreferrer\" target=\"_blank\">Storyblok Example</a> (<a href=\"https://next-blog-storyblok.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-graphcms\" rel=\"noopener noreferrer\" target=\"_blank\">GraphCMS Example</a> (<a href=\"https://next-blog-graphcms.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-kontent-ai\" rel=\"noopener noreferrer\" target=\"_blank\">Kontent Example</a> (<a href=\"https://next-blog-kontent.vercel.app//\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-umbraco-heartcore\" rel=\"noopener noreferrer\" target=\"_blank\">Umbraco Heartcore Example</a> (<a href=\"https://next-blog-umbraco-heartcore.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-plasmic\" rel=\"noopener noreferrer\" target=\"_blank\">Plasmic Example</a> (<a href=\"https://nextjs-plasmic-example.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-enterspeed\" rel=\"noopener noreferrer\" target=\"_blank\">Enterspeed Example</a> (<a href=\"https://next-blog-demo.enterspeed.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/cms-makeswift\" rel=\"noopener noreferrer\" target=\"_blank\">Makeswift Example</a> (<a href=\"https://nextjs-makeswift-example.vercel.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo</a>)</li> </ul></details> <p>In the <a href=\"../routing/pages-and-layouts\">Pages documentation</a> and the <a href=\"../data-fetching\">Data Fetching documentation</a>, we talked about how to pre-render a page at build time (<strong>Static Generation</strong>) using <code>getStaticProps</code> and <code>getStaticPaths</code>.</p> <p>Static Generation is useful when your pages fetch data from a headless CMS. However, its not ideal when youre writing a draft on your headless CMS and want to <strong>preview</strong> the draft immediately on your page. Youd want Next.js to render these pages at <strong>request time</strong> instead of build time and fetch the draft content instead of the published content. Youd want Next.js to bypass Static Generation only for this specific case.</p> <p>Next.js has a feature called <strong>Preview Mode</strong> which solves this problem. Here are instructions on how to use it.</p> <h2 id=\"step-1-create-and-access-a-preview-api-route\" data-docs-heading=\"\">Step 1: Create and access a preview API route     </h2> <blockquote class=\"p-3 text-sm\"> <p>Take a look at the <a href=\"../routing/api-routes\">API Routes documentation</a> first if youre not familiar with Next.js API Routes.</p> </blockquote> <p>First, create a <strong>preview API route</strong>. It can have any name - e.g. <code>pages/api/preview.js</code> (or <code>.ts</code> if using TypeScript).</p> <p>In this API route, you need to call <code>setPreviewData</code> on the response object. The argument for <code>setPreviewData</code> should be an object, and this can be used by <code>getStaticProps</code> (more on this later). For now, well use <code>{}</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function handler(req, res) {\n  // ...\n  res.setPreviewData({})\n  // ...\n}</pre>\n</div> <p><code>res.setPreviewData</code> sets some <strong>cookies</strong> on the browser which turns on the preview mode. Any requests to Next.js containing these cookies will be considered as the <strong>preview mode</strong>, and the behavior for statically generated pages will change (more on this later).</p> <p>You can test this manually by creating an API route like below and accessing it from your browser manually:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// simple example for testing it manually from your browser.\nexport default function handler(req, res) {\n  res.setPreviewData({})\n  res.end('Preview mode enabled')\n}</pre></div> <p>If you open your browsers developer tools and visit <code>/api/preview</code>, youll notice that the <code>__prerender_bypass</code> and <code>__next_preview_data</code> cookies will be set on this request.</p> <h3 id=\"securely-accessing-it-from-your-headless-cms\" data-docs-heading=\"\">Securely accessing it from your Headless CMS     </h3> <p>In practice, youd want to call this API route <em>securely</em> from your headless CMS. The specific steps will vary depending on which headless CMS youre using, but here are some common steps you could take.</p> <p>These steps assume that the headless CMS youre using supports setting <strong>custom preview URLs</strong>. If it doesnt, you can still use this method to secure your preview URLs, but youll need to construct and access the preview URL manually.</p> <p><strong>First</strong>, you should create a <strong>secret token string</strong> using a token generator of your choice. This secret will only be known by your Next.js app and your headless CMS. This secret prevents people who dont have access to your CMS from accessing preview URLs.</p> <p><strong>Second</strong>, if your headless CMS supports setting custom preview URLs, specify the following as the preview URL. This assumes that your preview API route is located at <code>pages/api/preview.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://&lt;your-site&gt;/api/preview?secret=&lt;token&gt;&amp;slug=&lt;path&gt;</pre></div> <ul> <li>\n<code>&lt;your-site&gt;</code> should be your deployment domain.</li> <li>\n<code>&lt;token&gt;</code> should be replaced with the secret token you generated.</li> <li>\n<code>&lt;path&gt;</code> should be the path for the page that you want to preview. If you want to preview <code>/posts/foo</code>, then you should use <code>&amp;slug=/posts/foo</code>.</li> </ul> <p>Your headless CMS might allow you to include a variable in the preview URL so that <code>&lt;path&gt;</code> can be set dynamically based on the CMSs data like so: <code>&amp;slug=/posts/{entry.fields.slug}</code></p> <p><strong>Finally</strong>, in the preview API route:</p> <ul> <li>Check that the secret matches and that the <code>slug</code> parameter exists (if not, the request should fail).</li> <li> <li>Call <code>res.setPreviewData</code>.</li> <li>Then redirect the browser to the path specified by <code>slug</code>. (The following example uses a <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Status/307\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">307 redirect</a>).</li> </ul> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async (req, res) =&gt; {\n  // Check the secret and next parameters\n  // This secret should only be known to this API route and the CMS\n  if (req.query.secret !== 'MY_SECRET_TOKEN' || !req.query.slug) {\n    return res.status(401).json({ message: 'Invalid token' })\n  }\n \n  // Fetch the headless CMS to check if the provided `slug` exists\n  // getPostBySlug would implement the required fetching logic to the headless CMS\n  const post = await getPostBySlug(req.query.slug)\n \n  // If the slug doesn't exist prevent preview mode from being enabled\n  if (!post) {\n    return res.status(401).json({ message: 'Invalid slug' })\n  }\n \n  // Enable Preview Mode by setting the cookies\n  res.setPreviewData({})\n \n  // Redirect to the path from the fetched post\n  // We don't redirect to req.query.slug as that might lead to open redirect vulnerabilities\n  res.redirect(post.slug)\n}</pre>\n</div> <p>If it succeeds, then the browser will be redirected to the path you want to preview with the preview mode cookies being set.</p> <h2 id=\"step-2-update-getstaticprops\" data-docs-heading=\"\">Step 2: Update getStaticProps     </h2> <p>The next step is to update <code>getStaticProps</code> to support the preview mode.</p> <p>If you request a page which has <code>getStaticProps</code> with the preview mode cookies set (via <code>res.setPreviewData</code>), then <code>getStaticProps</code> will be called at <strong>request time</strong> (instead of at build time).</p> <p>Furthermore, it will be called with a <code>context</code> object where:</p> <ul> <li>\n<code>context.preview</code> will be <code>true</code>.</li> <li>\n<code>context.previewData</code> will be the same as the argument used for <code>setPreviewData</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps(context) {\n  // If you request this page with the preview mode cookies set:\n  //\n  // - context.preview will be true\n  // - context.previewData will be the same as\n  //   the argument used for `setPreviewData`.\n}</pre>\n</div> <p>We used <code>res.setPreviewData({})</code> in the preview API route, so <code>context.previewData</code> will be <code>{}</code>. You can use this to pass session information from the preview API route to <code>getStaticProps</code> if necessary.</p> <p>If youre also using <code>getStaticPaths</code>, then <code>context.params</code> will also be available.</p> <h3 id=\"fetch-preview-data\" data-docs-heading=\"\">Fetch preview data     </h3> <p>You can update <code>getStaticProps</code> to fetch different data based on <code>context.preview</code> and/or <code>context.previewData</code>.</p> <p>For example, your headless CMS might have a different API endpoint for draft posts. If so, you can use <code>context.preview</code> to modify the API endpoint URL like below:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps(context) {\n  // If context.preview is true, append \"/preview\" to the API endpoint\n  // to request draft data instead of published data. This will vary\n  // based on which headless CMS you're using.\n  const res = await fetch(`https://.../${context.preview ? 'preview' : ''}`)\n  // ...\n}</pre>\n</div> <p>Thats it! If you access the preview API route (with <code>secret</code> and <code>slug</code>) from your headless CMS or manually, you should now be able to see the preview content. And if you update your draft without publishing, you should be able to preview the draft.</p> <p>Set this as the preview URL on your headless CMS or access manually, and you should be able to see the preview.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://&lt;your-site&gt;/api/preview?secret=&lt;token&gt;&amp;slug=&lt;path&gt;</pre></div> <h2 id=\"more-details\" data-docs-heading=\"\">More Details     </h2> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: during rendering <code>next/router</code> exposes an <code>isPreview</code> flag, see the <a href=\"../../api-reference/functions/use-router#router-object\">router object docs</a> for more info.</p> </blockquote> <h3 id=\"specify-the-preview-mode-duration\" data-docs-heading=\"\">Specify the Preview Mode duration     </h3> <p><code>setPreviewData</code> takes an optional second parameter which should be an options object. It accepts the following keys:</p> <ul> <li>\n<code>maxAge</code>: Specifies the number (in seconds) for the preview session to last for.</li> <li>\n<code>path</code>: Specifies the path the cookie should be applied under. Defaults to <code>/</code> enabling preview mode for all paths.</li> </ul> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">setPreviewData(data, {\n  maxAge: 60 * 60, // The preview mode cookies expire in 1 hour\n  path: '/about', // The preview mode cookies apply to paths with /about\n})</pre>\n</div> <h3 id=\"clear-the-preview-mode-cookies\" data-docs-heading=\"\">Clear the Preview Mode cookies     </h3> <p>By default, no expiration date is set for Preview Mode cookies, so the preview session ends when the browser is closed.</p> <p>To clear the Preview Mode cookies manually, create an API route that calls <code>clearPreviewData()</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function handler(req, res) {\n  res.clearPreviewData({})\n}</pre></div> <p>Then, send a request to <code>/api/clear-preview-mode-cookies</code> to invoke the API Route. If calling this route using <a href=\"../../api-reference/components/link\"><code>next/link</code></a>, you must pass <code>prefetch={false}</code> to prevent calling <code>clearPreviewData</code> during link prefetching.</p> <p>If a path was specified in the <code>setPreviewData</code> call, you must pass the same path to <code>clearPreviewData</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function handler(req, res) {\n  const { path } = req.query\n \n  res.clearPreviewData({ path })\n}</pre></div> <h3 id=\"previewdata-size-limits\" data-docs-heading=\"\">previewData size limits     </h3> <p>You can pass an object to <code>setPreviewData</code> and have it be available in <code>getStaticProps</code>. However, because the data will be stored in a cookie, theres a size limitation. Currently, preview data is limited to 2KB.</p> <h3 id=\"works-with-getserversideprops\" data-docs-heading=\"\">Works with getServerSideProps     </h3> <p>The preview mode works on <code>getServerSideProps</code> as well. It will also be available on the <code>context</code> object containing <code>preview</code> and <code>previewData</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You shouldn't set the <code>Cache-Control</code> header when using Preview Mode because it cannot be bypassed. Instead, we recommend using <a href=\"../data-fetching/incremental-static-regeneration\">ISR</a>.</p> </blockquote> <h3 id=\"works-with-api-routes\" data-docs-heading=\"\">Works with API Routes     </h3> <p>API Routes will have access to <code>preview</code> and <code>previewData</code> under the request object. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function myApiRoute(req, res) {\n  const isPreview = req.preview\n  const previewData = req.previewData\n  // ...\n}</pre>\n</div> <h3 id=\"unique-per-next-build\" data-docs-heading=\"\">Unique per next build     </h3> <p>Both the bypass cookie value and the private key for encrypting the <code>previewData</code> change when <code>next build</code> is completed. This ensures that the bypass cookie cant be guessed.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: To test Preview Mode locally over HTTP your browser will need to allow third-party cookies and local storage access.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/preview-mode\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/preview-mode</a>\n  </p>\n</div>\n","pages/building-your-application/testing":"<h1 class=\"break-words\">Testing</h1>\n<p>In React and Next.js, there are a few different types of tests you can write, each with its own purpose and use cases. This page provides an overview of types and commonly used tools you can use to test your application.</p> <h2 id=\"types-of-tests\" data-docs-heading=\"\">Types of tests     </h2> <ul> <li>\n<strong>Unit testing</strong> involves testing individual units (or blocks of code) in isolation. In React, a unit can be a single function, hook, or component. <ul> <li>\n<strong>Component testing</strong> is a more focused version of unit testing where the primary subject of the tests is React components. This may involve testing how components are rendered, their interaction with props, and their behavior in response to user events.</li> <li>\n<strong>Integration testing</strong> involves testing how multiple units work together. This can be a combination of components, hooks, and functions.</li> </ul> </li> <li>\n<strong>End-to-End (E2E) Testing</strong> involves testing user flows in an environment that simulates real user scenarios, like the browser. This means testing specific tasks (e.g. signup flow) in a production-like environment.</li> <li>\n<strong>Snapshot testing</strong> involves capturing the rendered output of a component and saving it to a snapshot file. When tests run, the current rendered output of the component is compared against the saved snapshot. Changes in the snapshot are used to indicate unexpected changes in behavior.</li> </ul>  <h2 id=\"guides\" data-docs-heading=\"\">Guides     </h2> <p>See the guides below to learn how to set up Next.js with these commonly used testing tools:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/testing\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/testing</a>\n  </p>\n</div>\n","pages/building-your-application/testing/vitest":"<h1 class=\"break-words\">Setting up Vitest with Next.js</h1>\n<p>Vite and React Testing Library are frequently used together for <strong>Unit Testing</strong>. This guide will show you how to setup Vitest with Next.js and write your first tests.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> Since <code>async</code> Server Components are new to the React ecosystem, Vitest currently does not support them. While you can still run <strong>unit tests</strong> for synchronous Server and Client Components, we recommend using an <strong>E2E tests</strong> for <code>async</code> components.</p> </blockquote> <h2 id=\"quickstart\" data-docs-heading=\"\">Quickstart     </h2> <p>You can use <code>create-next-app</code> with the Next.js <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-vitest\" rel=\"noopener noreferrer\" target=\"_blank\">with-vitest</a> example to quickly get started:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest --example with-vitest with-vitest-app</pre></div> <h2 id=\"manual-setup\" data-docs-heading=\"\">Manual Setup     </h2> <p>To manually set up Vitest, install <code>vitest</code> and the following packages as dev dependencies:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D vitest @vitejs/plugin-react jsdom @testing-library/react\n# or\nyarn add -D vitest @vitejs/plugin-react jsdom @testing-library/react\n# or\npnpm install -D vitest @vitejs/plugin-react jsdom @testing-library/react\n# or\nbun add -D vitest @vitejs/plugin-react jsdom @testing-library/react</pre></div> <p>Create a <code>vitest.config.ts|js</code> file in the root of your project, and add the following options:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { defineConfig } from 'vitest/config'\nimport react from '@vitejs/plugin-react'\n \nexport default defineConfig({\n  plugins: [react()],\n  test: {\n    environment: 'jsdom',\n  },\n})</pre></div>  <p>For more information on configuring Vitest, please refer to the <a href=\"https://vitest.dev/config/#configuration\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Vitest Configuration</a> docs.</p> <p>Then, add a <code>test</code> script to your <code>package.json</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"test\": \"vitest\"\n  }\n}</pre></div> <p>When you run <code>npm run test</code>, Vitest will <strong>watch</strong> for changes in your project by default.</p> <h2 id=\"creating-your-first-vitest-unit-test\" data-docs-heading=\"\">Creating your first Vitest Unit Test     </h2> <p>Check that everything is working by creating a test to check if the <code>&lt;Page /&gt;</code> component successfully renders a heading:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Home&lt;/h1&gt;\n      &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { expect, test } from 'vitest'\nimport { render, screen } from '@testing-library/react'\nimport Page from '../pages/index'\n \ntest('Page', () =&gt; {\n  render(&lt;Page /&gt;)\n  expect(screen.getByRole('heading', { level: 1, name: 'Home' })).toBeDefined()\n})</pre></div> <h2 id=\"running-your-tests\" data-docs-heading=\"\">Running your tests     </h2> <p>Then, run the following command to run your tests:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm run test\n# or\nyarn test\n# or\npnpm test\n# or\nbun test</pre></div> <h2 id=\"additional-resources\" data-docs-heading=\"\">Additional Resources     </h2> <p>You may find these resources helpful:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-vitest\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with Vitest example</a></li> <li><a href=\"https://vitest.dev/guide/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Vitest Docs</a></li> <li><a href=\"https://testing-library.com/docs/react-testing-library/intro/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Testing Library Docs</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/testing/vitest\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/testing/vitest</a>\n  </p>\n</div>\n","pages/building-your-application/testing/jest":"<h1 class=\"break-words\">Setting up Jest with Next.js</h1>\n<p>Jest and React Testing Library are frequently used together for <strong>Unit Testing</strong> and <strong>Snapshot Testing</strong>. This guide will show you how to set up Jest with Next.js and write your first tests.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> Since <code>async</code> Server Components are new to the React ecosystem, Jest currently does not support them. While you can still run <strong>unit tests</strong> for synchronous Server and Client Components, we recommend using an <strong>E2E tests</strong> for <code>async</code> components.</p> </blockquote> <h2 id=\"quickstart\" data-docs-heading=\"\">Quickstart     </h2> <p>You can use <code>create-next-app</code> with the Next.js <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-jest\" rel=\"noopener noreferrer\" target=\"_blank\">with-jest</a> example to quickly get started:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest --example with-jest with-jest-app</pre></div> <h2 id=\"manual-setup\" data-docs-heading=\"\">Manual setup     </h2> <p>Since the release of <a href=\"https://nextjs.org/blog/next-12\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js 12</a>, Next.js now has built-in configuration for Jest.</p> <p>To set up Jest, install <code>jest</code> and the following packages as dev dependencies:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D jest jest-environment-jsdom @testing-library/react @testing-library/jest-dom\n# or\nyarn add -D jest jest-environment-jsdom @testing-library/react @testing-library/jest-dom\n# or\npnpm install -D jest jest-environment-jsdom @testing-library/react @testing-library/jest-dom</pre></div> <p>Generate a basic Jest configuration file by running the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm init jest@latest\n# or\nyarn create jest@latest\n# or\npnpm create jest@latest</pre></div> <p>This will take you through a series of prompts to setup Jest for your project, including automatically creating a <code>jest.config.ts|js</code> file.</p> <p>Update your config file to use <code>next/jest</code>. This transformer has all the necessary configuration options for Jest to work with Next.js:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Config } from 'jest'\nimport nextJest from 'next/jest.js'\n \nconst createJestConfig = nextJest({\n  // Provide the path to your Next.js app to load next.config.js and .env files in your test environment\n  dir: './',\n})\n \n// Add any custom config to be passed to Jest\nconst config: Config = {\n  coverageProvider: 'v8',\n  testEnvironment: 'jsdom',\n  // Add more setup options before each test is run\n  // setupFilesAfterEnv: ['&lt;rootDir&gt;/jest.setup.ts'],\n}\n \n// createJestConfig is exported this way to ensure that next/jest can load the Next.js config which is async\nexport default createJestConfig(config)</pre></div>  <p>Under the hood, <code>next/jest</code> is automatically configuring Jest for you, including:</p> <ul> <li>Setting up <code>transform</code> using the <a href=\"../../../architecture/nextjs-compiler\">Next.js Compiler</a>\n</li> <li>Auto mocking stylesheets (<code>.css</code>, <code>.module.css</code>, and their scss variants), image imports and <a href=\"../optimizing/fonts\"><code>next/font</code></a>\n</li> <li>Loading <code>.env</code> (and all variants) into <code>process.env</code>\n</li> <li>Ignoring <code>node_modules</code> from test resolving and transforms</li> <li>Ignoring <code>.next</code> from test resolving</li> <li>Loading <code>next.config.js</code> for flags that enable SWC transforms</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: To test environment variables directly, load them manually in a separate setup script or in your <code>jest.config.ts</code> file. For more information, please see <a href=\"../configuring/environment-variables#test-environment-variables\">Test Environment Variables</a>.</p> </blockquote> <h2 id=\"setting-up-jest-with-babel\" data-docs-heading=\"\">Setting up Jest (with Babel)     </h2>\n<p>If you opt out of the <a href=\"../../../architecture/nextjs-compiler\">Next.js Compiler</a> and use Babel instead, you will need to manually configure Jest and install <code>babel-jest</code> and <code>identity-obj-proxy</code> in addition to the packages above.</p>\n<p>Here are the recommended options to configure Jest for Next.js:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  collectCoverage: true,\n  // on node 14.x coverage provider v8 offers good speed and more or less good report\n  coverageProvider: 'v8',\n  collectCoverageFrom: [\n    '**/*.{js,jsx,ts,tsx}',\n    '!**/*.d.ts',\n    '!**/node_modules/**',\n    '!&lt;rootDir&gt;/out/**',\n    '!&lt;rootDir&gt;/.next/**',\n    '!&lt;rootDir&gt;/*.config.js',\n    '!&lt;rootDir&gt;/coverage/**',\n  ],\n  moduleNameMapper: {\n    // Handle CSS imports (with CSS modules)\n    // https://jestjs.io/docs/webpack#mocking-css-modules\n    '^.+\\\\.module\\\\.(css|sass|scss)$': 'identity-obj-proxy',\n \n    // Handle CSS imports (without CSS modules)\n    '^.+\\\\.(css|sass|scss)$': '&lt;rootDir&gt;/__mocks__/styleMock.js',\n \n    // Handle image imports\n    // https://jestjs.io/docs/webpack#handling-static-assets\n    '^.+\\\\.(png|jpg|jpeg|gif|webp|avif|ico|bmp|svg)$/i': `&lt;rootDir&gt;/__mocks__/fileMock.js`,\n \n    // Handle module aliases\n    '^@/components/(.*)$': '&lt;rootDir&gt;/components/$1',\n \n    // Handle @next/font\n    '@next/font/(.*)': `&lt;rootDir&gt;/__mocks__/nextFontMock.js`,\n    // Handle next/font\n    'next/font/(.*)': `&lt;rootDir&gt;/__mocks__/nextFontMock.js`,\n    // Disable server-only\n    'server-only': `&lt;rootDir&gt;/__mocks__/empty.js`,\n  },\n  // Add more setup options before each test is run\n  // setupFilesAfterEnv: ['&lt;rootDir&gt;/jest.setup.js'],\n  testPathIgnorePatterns: ['&lt;rootDir&gt;/node_modules/', '&lt;rootDir&gt;/.next/'],\n  testEnvironment: 'jsdom',\n  transform: {\n    // Use babel-jest to transpile tests with the next/babel preset\n    // https://jestjs.io/docs/configuration#transform-objectstring-pathtotransformer--pathtotransformer-object\n    '^.+\\\\.(js|jsx|ts|tsx)$': ['babel-jest', { presets: ['next/babel'] }],\n  },\n  transformIgnorePatterns: [\n    '/node_modules/',\n    '^.+\\\\.module\\\\.(css|sass|scss)$',\n  ],\n}</pre></div>\n<p>You can learn more about each configuration option in the <a href=\"https://jestjs.io/docs/configuration\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Jest docs</a>. We also recommend reviewing <a href=\"https://github.com/vercel/next.js/blob/e02fe314dcd0ae614c65b505c6daafbdeebb920e/packages/next/src/build/jest/jest.ts\" rel=\"noopener noreferrer\" target=\"_blank\"><code>next/jest</code> configuration</a> to see how Next.js configures Jest.</p>\n<h3 id=\"handling-stylesheets-and-image-imports\" data-docs-heading=\"\">Handling stylesheets and image imports     </h3>\n<p>Stylesheets and images aren't used in the tests but importing them may cause errors, so they will need to be mocked.</p>\n<p>Create the mock files referenced in the configuration above - <code>fileMock.js</code> and <code>styleMock.js</code> - inside a <code>__mocks__</code> directory:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = 'test-file-stub'</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {}</pre></div>\n<p>For more information on handling static assets, please refer to the <a href=\"https://jestjs.io/docs/webpack#handling-static-assets\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Jest Docs</a>.</p>\n<h2 id=\"handling-fonts\" data-docs-heading=\"\">Handling Fonts     </h2>\n<p>To handle fonts, create the <code>nextFontMock.js</code> file inside the <code>__mocks__</code> directory, and add the following configuration:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = new Proxy(\n  {},\n  {\n    get: function getter() {\n      return () =&gt; ({\n        className: 'className',\n        variable: 'variable',\n        style: { fontFamily: 'fontFamily' },\n      })\n    },\n  }\n)</pre></div> <h2 id=\"optional-handling-absolute-imports-and-module-path-aliases\" data-docs-heading=\"\">Optional: Handling Absolute Imports and Module Path Aliases     </h2> <p>If your project is using <a href=\"../configuring/absolute-imports-and-module-aliases\">Module Path Aliases</a>, you will need to configure Jest to resolve the imports by matching the paths option in the <code>jsconfig.json</code> file with the <code>moduleNameMapper</code> option in the <code>jest.config.js</code> file. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"bundler\",\n    \"baseUrl\": \"./\",\n    \"paths\": {\n      \"@/components/*\": [\"components/*\"]\n    }\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">moduleNameMapper: {\n  // ...\n  '^@/components/(.*)$': '&lt;rootDir&gt;/components/$1',\n}</pre></div> <h2 id=\"optional-extend-jest-with-custom-matchers\" data-docs-heading=\"\">Optional: Extend Jest with custom matchers     </h2> <p><code>@testing-library/jest-dom</code> includes a set of convenient <a href=\"https://github.com/testing-library/jest-dom#custom-matchers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">custom matchers</a> such as <code>.toBeInTheDocument()</code> making it easier to write tests. You can import the custom matchers for every test by adding the following option to the Jest configuration file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">setupFilesAfterEnv: ['&lt;rootDir&gt;/jest.setup.ts']</pre></div>  <p>Then, inside <code>jest.setup.ts</code>, add the following import:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '@testing-library/jest-dom'</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong><a href=\"https://github.com/testing-library/jest-dom/releases/tag/v6.0.0\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>extend-expect</code> was removed in <code>v6.0</code></a>, so if you are using <code>@testing-library/jest-dom</code> before version 6, you will need to import <code>@testing-library/jest-dom/extend-expect</code> instead.</p> </blockquote> <p>If you need to add more setup options before each test, you can add them to the <code>jest.setup.js</code> file above.</p> <h2 id=\"add-a-test-script-to-packagejson\" data-docs-heading=\"\">Add a test script to package.json:     </h2> <p>Finally, add a Jest <code>test</code> script to your <code>package.json</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"test\": \"jest\",\n    \"test:watch\": \"jest --watch\"\n  }\n}</pre></div> <p><code>jest --watch</code> will re-run tests when a file is changed. For more Jest CLI options, please refer to the <a href=\"https://jestjs.io/docs/cli#reference\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Jest Docs</a>.</p> <h3 id=\"creating-your-first-test\" data-docs-heading=\"\">Creating your first test:     </h3> <p>Your project is now ready to run tests. Create a folder called <code>__tests__</code> in your project's root directory.</p> <p>For example, we can add a test to check if the <code>&lt;Home /&gt;</code> component successfully renders a heading:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Home() {\n  return &lt;h1&gt;Home&lt;/h1&gt;\n}</pre>\n</div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '@testing-library/jest-dom'\nimport { render, screen } from '@testing-library/react'\nimport Home from '../pages/index'\n \ndescribe('Home', () =&gt; {\n  it('renders a heading', () =&gt; {\n    render(&lt;Home /&gt;)\n \n    const heading = screen.getByRole('heading', { level: 1 })\n \n    expect(heading).toBeInTheDocument()\n  })\n})</pre></div>  <p>Optionally, add a <a href=\"https://jestjs.io/docs/snapshot-testing\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">snapshot test</a> to keep track of any unexpected changes in your component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { render } from '@testing-library/react'\nimport Home from '../pages/index'\n \nit('renders homepage unchanged', () =&gt; {\n  const { container } = render(&lt;Home /&gt;)\n  expect(container).toMatchSnapshot()\n})</pre></div>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Test files should not be included inside the Pages Router because any files inside the Pages Router are considered routes.</p> </blockquote>  <h2 id=\"running-your-tests\" data-docs-heading=\"\">Running your tests     </h2> <p>Then, run the following command to run your tests:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm run test\n# or\nyarn test\n# or\npnpm test</pre></div> <h2 id=\"additional-resources\" data-docs-heading=\"\">Additional Resources     </h2> <p>For further reading, you may find these resources helpful:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-jest\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with Jest example</a></li> <li><a href=\"https://jestjs.io/docs/getting-started\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Jest Docs</a></li> <li><a href=\"https://testing-library.com/docs/react-testing-library/intro/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Testing Library Docs</a></li> <li>\n<a href=\"https://testing-playground.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Testing Playground</a> - use good testing practices to match elements.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/testing/jest\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/testing/jest</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/custom-server":"<h1 class=\"break-words\">Custom Server</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/custom-server\" rel=\"noopener noreferrer\" target=\"_blank\">Custom Server</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/ssr-caching\" rel=\"noopener noreferrer\" target=\"_blank\">SSR Caching</a></li> </ul></details> <p>By default, Next.js includes its own server with <code>next start</code>. If you have an existing backend, you can still use it with Next.js (this is not a custom server). A custom Next.js server allows you to start a server 100% programmatically in order to use custom server patterns. Most of the time, you will not need this - but it's available for complete customization.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Before deciding to use a custom server, please keep in mind that it should only be used when the integrated router of Next.js can't meet your app requirements. A custom server will remove important performance optimizations, like <strong>serverless functions</strong> and <strong><a href=\"../rendering/automatic-static-optimization\">Automatic Static Optimization</a>.</strong>\n</li> <li>A custom server <strong>cannot</strong> be deployed on <a href=\"https://vercel.com/solutions/nextjs\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>.</li> <li>Standalone output mode, does not trace custom server files and this mode outputs a separate minimal <code>server.js</code> file instead.</li> </ul> </blockquote> <p>Take a look at the following example of a custom server:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const { createServer } = require('http')\nconst { parse } = require('url')\nconst next = require('next')\n \nconst dev = process.env.NODE_ENV !== 'production'\nconst hostname = 'localhost'\nconst port = 3000\n// when using middleware `hostname` and `port` must be provided below\nconst app = next({ dev, hostname, port })\nconst handle = app.getRequestHandler()\n \napp.prepare().then(() =&gt; {\n  createServer(async (req, res) =&gt; {\n    try {\n      // Be sure to pass `true` as the second argument to `url.parse`.\n      // This tells it to parse the query portion of the URL.\n      const parsedUrl = parse(req.url, true)\n      const { pathname, query } = parsedUrl\n \n      if (pathname === '/a') {\n        await app.render(req, res, '/a', query)\n      } else if (pathname === '/b') {\n        await app.render(req, res, '/b', query)\n      } else {\n        await handle(req, res, parsedUrl)\n      }\n    } catch (err) {\n      console.error('Error occurred handling', req.url, err)\n      res.statusCode = 500\n      res.end('internal server error')\n    }\n  })\n    .once('error', (err) =&gt; {\n      console.error(err)\n      process.exit(1)\n    })\n    .listen(port, () =&gt; {\n      console.log(`&gt; Ready on http://${hostname}:${port}`)\n    })\n})</pre></div> <blockquote class=\"p-3 text-sm\"> <p><code>server.js</code> doesn't go through babel or webpack. Make sure the syntax and sources this file requires are compatible with the current node version you are running.</p> </blockquote> <p>To run the custom server you'll need to update the <code>scripts</code> in <code>package.json</code> like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"node server.js\",\n    \"build\": \"next build\",\n    \"start\": \"NODE_ENV=production node server.js\"\n  }\n}</pre></div> <hr> <p>The custom server uses the following import to connect the server with the Next.js application:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const next = require('next')\nconst app = next({})</pre>\n</div> <p>The above <code>next</code> import is a function that receives an object with the following options:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Option</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>conf</code></td>\n<td><code>Object</code></td>\n<td>The same object you would use in <a href=\"../../api-reference/next-config-js\">next.config.js</a>. Defaults to <code>{}</code>\n</td>\n</tr>\n<tr>\n<td><code>customServer</code></td>\n<td><code>Boolean</code></td>\n<td>(<em>Optional</em>) Set to false when the server was created by Next.js</td>\n</tr>\n<tr>\n<td><code>dev</code></td>\n<td><code>Boolean</code></td>\n<td>(<em>Optional</em>) Whether or not to launch Next.js in dev mode. Defaults to <code>false</code>\n</td>\n</tr>\n<tr>\n<td><code>dir</code></td>\n<td><code>String</code></td>\n<td>(<em>Optional</em>) Location of the Next.js project. Defaults to <code>'.'</code>\n</td>\n</tr>\n<tr>\n<td><code>quiet</code></td>\n<td><code>Boolean</code></td>\n<td>(<em>Optional</em>) Hide error messages containing server information. Defaults to <code>false</code>\n</td>\n</tr>\n<tr>\n<td><code>hostname</code></td>\n<td><code>String</code></td>\n<td>(<em>Optional</em>) The hostname the server is running behind</td>\n</tr>\n<tr>\n<td><code>port</code></td>\n<td><code>Number</code></td>\n<td>(<em>Optional</em>) The port the server is running behind</td>\n</tr>\n<tr>\n<td><code>httpServer</code></td>\n<td><code>node:http#Server</code></td>\n<td>(<em>Optional</em>) The HTTP Server that Next.js is running behind</td>\n</tr>\n</tbody>\n</table></div> <p>The returned <code>app</code> can then be used to let Next.js handle requests as required.</p> <h2 id=\"disabling-file-system-routing\" data-docs-heading=\"\">Disabling file-system routing     </h2> <p>By default, <code>Next</code> will serve each file in the <code>pages</code> folder under a pathname matching the filename. If your project uses a custom server, this behavior may result in the same content being served from multiple paths, which can present problems with SEO and UX.</p> <p>To disable this behavior and prevent routing based on files in <code>pages</code>, open <code>next.config.js</code> and disable the <code>useFileSystemPublicRoutes</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  useFileSystemPublicRoutes: false,\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p>Note that <code>useFileSystemPublicRoutes</code> disables filename routes from SSR; client-side routing may still access those paths. When using this option, you should guard against navigation to routes you do not want programmatically.</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p>You may also wish to configure the client-side router to disallow client-side redirects to filename routes; for that refer to <a href=\"../../api-reference/functions/use-router#routerbeforepopstate\"><code>router.beforePopState</code></a>.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/custom-server\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/custom-server</a>\n  </p>\n</div>\n","pages/building-your-application/configuring/content-security-policy":"<h1 class=\"break-words\">Content Security Policy</h1> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/CSP\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Content Security Policy (CSP)</a> is important to guard your Next.js application against various security threats such as cross-site scripting (XSS), clickjacking, and other code injection attacks.</p> <p>By using CSP, developers can specify which origins are permissible for content sources, scripts, stylesheets, images, fonts, objects, media (audio, video), iframes, and more.</p> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-strict-csp\" rel=\"noopener noreferrer\" target=\"_blank\">Strict CSP</a></li> </ul></details> <h2 id=\"nonces\" data-docs-heading=\"\">Nonces     </h2> <p>A <a href=\"https://developer.mozilla.org/docs/Web/HTML/Global_attributes/nonce\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">nonce</a> is a unique, random string of characters created for a one-time use. It is used in conjunction with CSP to selectively allow certain inline scripts or styles to execute, bypassing strict CSP directives.</p> <h3 id=\"why-use-a-nonce\" data-docs-heading=\"\">Why use a nonce?     </h3> <p>Even though CSPs are designed to block malicious scripts, there are legitimate scenarios where inline scripts are necessary. In such cases, nonces offer a way to allow these scripts to execute if they have the correct nonce.</p> <h3 id=\"adding-a-nonce-with-middleware\" data-docs-heading=\"\">Adding a nonce with Middleware     </h3> <p><a href=\"../../../app/building-your-application/routing/middleware\">Middleware</a> enables you to add headers and generate nonces before the page renders.</p> <p>Every time a page is viewed, a fresh nonce should be generated. This means that you <strong>must use dynamic rendering to add nonces</strong>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  const nonce = Buffer.from(crypto.randomUUID()).toString('base64')\n  const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}' 'strict-dynamic';\n    style-src 'self' 'nonce-${nonce}';\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n  // Replace newline characters and spaces\n  const contentSecurityPolicyHeaderValue = cspHeader\n    .replace(/\\s{2,}/g, ' ')\n    .trim()\n \n  const requestHeaders = new Headers(request.headers)\n  requestHeaders.set('x-nonce', nonce)\n \n  requestHeaders.set(\n    'Content-Security-Policy',\n    contentSecurityPolicyHeaderValue\n  )\n \n  const response = NextResponse.next({\n    request: {\n      headers: requestHeaders,\n    },\n  })\n  response.headers.set(\n    'Content-Security-Policy',\n    contentSecurityPolicyHeaderValue\n  )\n \n  return response\n}</pre></div>  <p>By default, Middleware runs on all requests. You can filter Middleware to run on specific paths using a <a href=\"../../../app/building-your-application/routing/middleware#matcher\"><code>matcher</code></a>.</p> <p>We recommend ignoring matching prefetches (from <code>next/link</code>) and static assets that don't need the CSP header.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-prefetch' },\n        { type: 'header', key: 'purpose', value: 'prefetch' },\n      ],\n    },\n  ],\n}</pre></div>  <h3 id=\"reading-the-nonce\" data-docs-heading=\"\">Reading the nonce     </h3> <p>You can now read the nonce from a <a href=\"../../../app/building-your-application/rendering/server-components\">Server Component</a> using <a href=\"../../../app/api-reference/functions/headers\"><code>headers</code></a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { headers } from 'next/headers'\nimport Script from 'next/script'\n \nexport default function Page() {\n  const nonce = headers().get('x-nonce')\n \n  return (\n    &lt;Script\n      src=\"https://www.googletagmanager.com/gtag/js\"\n      strategy=\"afterInteractive\"\n      nonce={nonce}\n    /&gt;\n  )\n}</pre></div>  <h2 id=\"without-nonces\" data-docs-heading=\"\">Without Nonces     </h2> <p>For applications that do not require nonces, you can set the CSP header directly in your <a href=\"../../../app/api-reference/next-config-js\"><code>next.config.js</code></a> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const cspHeader = `\n    default-src 'self';\n    script-src 'self' 'unsafe-eval' 'unsafe-inline';\n    style-src 'self' 'unsafe-inline';\n    img-src 'self' blob: data:;\n    font-src 'self';\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n`\n \nmodule.exports = {\n  async headers() {\n    return [\n      {\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'Content-Security-Policy',\n            value: cspHeader.replace(/\\n/g, ''),\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <p>We recommend using <code>v13.4.20+</code> of Next.js to properly handle and apply nonces.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/configuring/content-security-policy\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/configuring/content-security-policy</a>\n  </p>\n</div>\n","pages/building-your-application/testing/playwright":"<h1 class=\"break-words\">Setting up Playwright with Next.js</h1>\n<p>Playwright is a testing framework that lets you automate Chromium, Firefox, and WebKit with a single API. You can use it to write <strong>End-to-End (E2E)</strong> testing. This guide will show you how to set up Playwright with Next.js and write your first tests.</p> <h2 id=\"quickstart\" data-docs-heading=\"\">Quickstart     </h2> <p>The fastest way to get started is to use <code>create-next-app</code> with the <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-playwright\" rel=\"noopener noreferrer\" target=\"_blank\">with-playwright example</a>. This will create a Next.js project complete with Playwright configured.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest --example with-playwright with-playwright-app</pre></div> <h2 id=\"manual-setup\" data-docs-heading=\"\">Manual setup     </h2> <p>To install Playwright, run the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm init playwright\n# or\nyarn create playwright\n# or\npnpm create playwright</pre></div> <p>This will take you through a series of prompts to setup and configure Playwright for your project, including adding a <code>playwright.config.ts</code> file. Please refer to the <a href=\"https://playwright.dev/docs/intro#installation\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Playwright installation guide</a> for the step-by-step guide.</p> <h2 id=\"creating-your-first-playwright-e2e-test\" data-docs-heading=\"\">Creating your first Playwright E2E test     </h2> <p>Create two new Next.js pages:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Home() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Home&lt;/h1&gt;\n      &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function About() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;About&lt;/h1&gt;\n      &lt;Link href=\"/\"&gt;Home&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Then, add a test to verify that your navigation is working correctly:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { test, expect } from '@playwright/test'\n \ntest('should navigate to the about page', async ({ page }) =&gt; {\n  // Start from the index page (the baseURL is set via the webServer in the playwright.config.ts)\n  await page.goto('http://localhost:3000/')\n  // Find an element with the text 'About' and click on it\n  await page.click('text=About')\n  // The new URL should be \"/about\" (baseURL is used there)\n  await expect(page).toHaveURL('http://localhost:3000/about')\n  // The new page should contain an h1 with \"About\"\n  await expect(page.locator('h1')).toContainText('About')\n})</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <p>You can use <code>page.goto(\"/\")</code> instead of <code>page.goto(\"http://localhost:3000/\")</code>, if you add <a href=\"https://playwright.dev/docs/api/class-testoptions#test-options-base-url\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>\"baseURL\": \"http://localhost:3000\"</code></a> to the <code>playwright.config.ts</code> <a href=\"https://playwright.dev/docs/test-configuration\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">configuration file</a>.</p> </blockquote> <h3 id=\"running-your-playwright-tests\" data-docs-heading=\"\">Running your Playwright tests     </h3> <p>Playwright will simulate a user navigating your application using three browsers: Chromium, Firefox and Webkit, this requires your Next.js server to be running. We recommend running your tests against your production code to more closely resemble how your application will behave.</p> <p>Run <code>npm run build</code> and <code>npm run start</code>, then run <code>npx playwright test</code> in another terminal window to run the Playwright tests.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Alternatively, you can use the <a href=\"https://playwright.dev/docs/test-webserver/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>webServer</code></a> feature to let Playwright start the development server and wait until it's fully available.</p> </blockquote> <h3 id=\"running-playwright-on-continuous-integration-ci\" data-docs-heading=\"\">Running Playwright on Continuous Integration (CI)     </h3> <p>Playwright will by default run your tests in the <a href=\"https://playwright.dev/docs/ci#running-headed\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">headless mode</a>. To install all the Playwright dependencies, run <code>npx playwright install-deps</code>.</p> <p>You can learn more about Playwright and Continuous Integration from these resources:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-playwright\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with Playwright example</a></li> <li><a href=\"https://playwright.dev/docs/ci\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Playwright on your CI provider</a></li> <li><a href=\"https://discord.com/invite/playwright-807756831384403968\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Playwright Discord</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/testing/playwright\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/testing/playwright</a>\n  </p>\n</div>\n","pages/building-your-application/authentication":"<h1 class=\"break-words\">Authentication</h1>\n<p>To implement authentication in Next.js, familiarize yourself with three foundational concepts:</p> <ul> <li>\n<strong><a href=\"#authentication\">Authentication</a></strong> verifies if the user is who they say they are. It requires the user to prove their identity with something they have, such as a username and password.</li> <li>\n<strong><a href=\"#session-management\">Session Management</a></strong> tracks the user's state (e.g. logged in) across multiple requests.</li> <li>\n<strong><a href=\"#authorization\">Authorization</a></strong> decides what parts of the application the user is allowed to access.</li> </ul> <p>This page demonstrates how to use Next.js features to implement common authentication, authorization, and session management patterns so you can choose the best solutions based on your application's needs.</p> <h2 id=\"authentication\" data-docs-heading=\"\">Authentication     </h2> <p>Authentication verifies a user's identity. This happens when a user logs in, either with a username and password or through a service like Google. It's all about confirming that users are really who they claim to be, protecting both the user's data and the application from unauthorized access or fraudulent activities.</p> <h3 id=\"authentication-strategies\" data-docs-heading=\"\">Authentication Strategies     </h3> <p>Modern web applications commonly use several authentication strategies:</p> <ol> <li>\n<strong>OAuth/OpenID Connect (OIDC)</strong>: Enable third-party access without sharing user credentials. Ideal for social media logins and Single Sign-On (SSO) solutions. They add an identity layer with OpenID Connect.</li> <li>\n<strong>Credentials-based login (Email + Password)</strong>: A standard choice for web applications, where users log in with an email and password. Familiar and easy to implement, it requires robust security measures against threats like phishing.</li> <li>\n<strong>Passwordless/Token-based authentication</strong>: Use email magic links or SMS one-time codes for secure, password-free access. Popular for its convenience and enhanced security, this method helps reduce password fatigue. Its limitation is the dependency on the user's email or phone availability.</li> <li>\n<strong>Passkeys/WebAuthn</strong>: Use cryptographic credentials unique to each site, offering high security against phishing. Secure but new, this strategy can be difficult to implement.</li> </ol> <p>Selecting an authentication strategy should align with your application's specific requirements, user interface considerations, and security objectives.</p> <h3 id=\"implementing-authentication\" data-docs-heading=\"\">Implementing Authentication     </h3> <p>In this section, we'll explore the process of adding basic email-password authentication to a web application. While this method provides a fundamental level of security, it's worth considering more advanced options like OAuth or passwordless logins for enhanced protection against common security threats. The authentication flow we'll discuss is as follows:</p> <ol> <li>The user submits their credentials through a login form.</li> <li>The form sends a request that is handled by an API route.</li> <li>Upon successful verification, the process is completed, indicating the user's successful authentication.</li> <li>If verification is unsuccessful, an error message is shown.</li> </ol>\n<p>Consider a login form where users can input their credentials:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { FormEvent } from 'react'\nimport { useRouter } from 'next/router'\n \nexport default function LoginPage() {\n  const router = useRouter()\n \n  async function handleSubmit(event: FormEvent&lt;HTMLFormElement&gt;) {\n    event.preventDefault()\n \n    const formData = new FormData(event.currentTarget)\n    const email = formData.get('email')\n    const password = formData.get('password')\n \n    const response = await fetch('/api/auth/login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ email, password }),\n    })\n \n    if (response.ok) {\n      router.push('/profile')\n    } else {\n      // Handle errors\n    }\n  }\n \n  return (\n    &lt;form onSubmit={handleSubmit}&gt;\n      &lt;input type=\"email\" name=\"email\" placeholder=\"Email\" required /&gt;\n      &lt;input type=\"password\" name=\"password\" placeholder=\"Password\" required /&gt;\n      &lt;button type=\"submit\"&gt;Login&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre></div>\n<p>The form above has two input fields for capturing the user's email and password. On submission, it triggers a function that sends a POST request to an API route (<code>/api/auth/login</code>).</p>\n<p>You can then call your Authentication Provider's API in the API route to handle authentication:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextApiRequest, NextApiResponse } from 'next'\nimport { signIn } from '@/auth'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  try {\n    const { email, password } = req.body\n    await signIn('credentials', { email, password })\n \n    res.status(200).json({ success: true })\n  } catch (error) {\n    if (error.type === 'CredentialsSignin') {\n      res.status(401).json({ error: 'Invalid credentials.' })\n    } else {\n      res.status(500).json({ error: 'Something went wrong.' })\n    }\n  }\n}</pre></div>  <p>In this code, the <code>signIn</code> method checks the credentials against stored user data. After the authentication provider processes the credentials, there are two possible outcomes:</p> <ul> <li>\n<strong>Successful Authentication</strong>: This outcome implies that the login was successful. Further actions, such as accessing protected routes and fetching user information, can then be initiated.</li> <li>\n<strong>Failed Authentication</strong>: In cases where the credentials are incorrect or an error is encountered, the function returns a corresponding error message to indicate the authentication failure.</li> </ul>  <p>For a more streamlined authentication setup in Next.js projects, especially when offering multiple login methods, consider using a comprehensive <a href=\"#examples\">authentication solution</a>.</p> <h2 id=\"authorization\" data-docs-heading=\"\">Authorization     </h2> <p>Once a user is authenticated, you'll need to ensure the user is allowed to visit certain routes, and perform operations such as mutating data with Server Actions and calling Route Handlers.</p> <h3 id=\"protecting-routes-with-middleware\" data-docs-heading=\"\">Protecting Routes with Middleware     </h3> <p><a href=\"../../app/building-your-application/routing/middleware\">Middleware</a> in Next.js helps you control who can access different parts of your website. This is important for keeping areas like the user dashboard protected while having other pages like marketing pages be public. It's recommended to apply Middleware across all routes and specify exclusions for public access.</p> <p>Here's how to implement Middleware for authentication in Next.js:</p> <h4 id=\"setting-up-middleware\" data-docs-heading=\"\">Setting Up Middleware:     </h4> <ul> <li>Create a <code>middleware.ts</code> or <code>.js</code> file in your project's root directory.</li> <li>Include logic to authorize user access, such as checking for authentication tokens.</li> </ul> <h4 id=\"defining-protected-routes\" data-docs-heading=\"\">Defining Protected Routes:     </h4> <ul> <li>Not all routes require authorization. Use the <code>matcher</code> option in your Middleware to specify any routes that do not require authorization checks.</li> </ul> <h4 id=\"middleware-logic\" data-docs-heading=\"\">Middleware Logic:     </h4> <ul> <li>Write logic to verify if a user is authenticated. Check user roles or permissions for route authorization.</li> </ul> <h4 id=\"handling-unauthorized-access\" data-docs-heading=\"\">Handling Unauthorized Access:     </h4> <ul> <li>Redirect unauthorized users to a login or error page as appropriate.</li> </ul> <p>Example Middleware file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  const currentUser = request.cookies.get('currentUser')?.value\n \n  if (currentUser &amp;&amp; !request.nextUrl.pathname.startsWith('/dashboard')) {\n    return Response.redirect(new URL('/dashboard', request.url))\n  }\n \n  if (!currentUser &amp;&amp; !request.nextUrl.pathname.startsWith('/login')) {\n    return Response.redirect(new URL('/login', request.url))\n  }\n}\n \nexport const config = {\n  matcher: ['/((?!api|_next/static|_next/image|.*\\\\.png$).*)'],\n}</pre></div>  <p>This example uses <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Response/redirect_static\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Response.redirect</code></a> for handling redirects early in the request pipeline, making it efficient and centralizing access control.</p>  <p>After successful authentication, it's important to manage user navigation based on their roles. For example, an admin user might be redirected to an admin dashboard, while a regular user is sent to a different page. This is important for role-specific experiences and conditional navigation, such as prompting users to complete their profile if needed.</p> <p>When setting up authorization, it's important to ensure that the main security checks happen where your app accesses or changes data. While Middleware can be useful for initial validation, it should not be the sole line of defense in protecting your data. The bulk of security checks should be performed in the Data Access Layer (DAL).</p> <h3 id=\"protecting-api-routes\" data-docs-heading=\"\">Protecting API Routes     </h3>\n<p>API Routes in Next.js are essential for handling server-side logic and data management. It's crucial to secure these routes to ensure that only authorized users can access specific functionalities. This typically involves verifying the user's authentication status and their role-based permissions.</p>\n<p>Here's an example of securing an API Route:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  const session = await getSession(req)\n \n  // Check if the user is authenticated\n  if (!session) {\n    res.status(401).json({\n      error: 'User is not authenticated',\n    })\n    return\n  }\n \n  // Check if the user has the 'admin' role\n  if (session.user.role !== 'admin') {\n    res.status(401).json({\n      error: 'Unauthorized access: User does not have admin privileges.',\n    })\n    return\n  }\n \n  // Proceed with the route for authorized users\n  // ... implementation of the API Route\n}</pre></div>\n<p>This example demonstrates an API Route with a two-tier security check for authentication and authorization. It first checks for an active session, and then verifies if the logged-in user is an 'admin'. This approach ensures secure access, limited to authenticated and authorized users, maintaining robust security for request processing.</p>  <h3 id=\"best-practices\" data-docs-heading=\"\">Best Practices     </h3> <ul> <li>\n<strong>Secure Session Management</strong>: Prioritize the security of session data to prevent unauthorized access and data breaches. Use encryption and secure storage practices.</li> <li>\n<strong>Dynamic Role Management</strong>: Use a flexible system for user roles to easily adjust to changes in permissions and roles, avoiding hardcoded roles.</li> <li>\n<strong>Security-First Approach</strong>: In all aspects of authorization logic, prioritize security to safeguard user data and maintain the integrity of your application. This includes thorough testing and considering potential security vulnerabilities.</li> </ul> <h2 id=\"session-management\" data-docs-heading=\"\">Session Management     </h2> <p>Session management involves tracking and managing a user's interaction with the application over time, ensuring that their authenticated state is preserved across different parts of the application.</p> <p>This prevents the need for repeated logins, enhancing both security and user convenience. There are two primary methods used for session management: cookie-based and database sessions.</p> <h3 id=\"cookie-based-sessions\" data-docs-heading=\"\">Cookie-Based Sessions     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn more about cookie-based sessions and authentication with Next.js  <a href=\"https://www.youtube.com/watch?v=DJvM2lSPn6w\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (11 minutes)</a>.</p> </blockquote> <p>Cookie-based sessions manage user data by storing encrypted session information directly in browser cookies. Upon user login, this encrypted data is stored in the cookie. Each subsequent server request includes this cookie, minimizing the need for repeated server queries and enhancing client-side efficiency.</p> <p>However, this method requires careful encryption to protect sensitive data, as cookies are susceptible to client-side security risks. Encrypting session data in cookies is key to safeguarding user information from unauthorized access. It ensures that even if a cookie is stolen, the data inside remains unreadable.</p> <p>Additionally, while individual cookies are limited in size (typically around 4KB), techniques like cookie-chunking can overcome this limitation by dividing large session data into multiple cookies.</p> <p>Setting a cookie in a Next.js project might look something like this:</p> <p><strong>Setting a cookie on the server:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { serialize } from 'cookie'\nimport type { NextApiRequest, NextApiResponse } from 'next'\n \nexport default function handler(req: NextApiRequest, res: NextApiResponse) {\n  const sessionData = req.body\n  const encryptedSessionData = encrypt(sessionData)\n \n  const cookie = serialize('session', encryptedSessionData, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    maxAge: 60 * 60 * 24 * 7, // One week\n    path: '/',\n  })\n  res.setHeader('Set-Cookie', cookie)\n  res.status(200).json({ message: 'Successfully set cookie!' })\n}</pre></div>  <h3 id=\"database-sessions\" data-docs-heading=\"\">Database Sessions     </h3> <p>Database session management involves storing session data on the server, with the user's browser only receiving a session ID. This ID references the session data stored server-side, without containing the data itself. This method enhances security, as it keeps sensitive session data away from the client-side environment, reducing the risk of exposure to client-side attacks. Database sessions are also more scalable, accommodating larger data storage needs.</p> <p>However, this approach has its tradeoffs. It can increase performance overhead due to the need for database lookups at each user interaction. Strategies like session data caching can help mitigate this. Additionally, reliance on the database means that session management is as reliable as the database's performance and availability.</p> <p>Here's a simplified example of implementing database sessions in a Next.js application:</p> <p><strong>Creating a Session on the Server</strong>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import db from '../../lib/db'\nimport { NextApiRequest, NextApiResponse } from 'next'\n \nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  try {\n    const user = req.body\n    const sessionId = generateSessionId()\n    await db.insertSession({\n      sessionId,\n      userId: user.id,\n      createdAt: new Date(),\n    })\n \n    res.status(200).json({ sessionId })\n  } catch (error) {\n    res.status(500).json({ error: 'Internal Server Error' })\n  }\n}</pre></div>  <h3 id=\"selecting-session-management-in-nextjs\" data-docs-heading=\"\">Selecting Session Management in Next.js     </h3> <p>Deciding between cookie-based and database sessions in Next.js depends on your application's needs. Cookie-based sessions are simpler and suit smaller applications with lower server load but may offer less security. Database sessions, while more complex, provide better security and scalability, ideal for larger, data-sensitive applications.</p> <p>With <a href=\"#examples\">authentication solutions</a> such as <a href=\"https://authjs.dev/guides/upgrade-to-v5\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">NextAuth.js</a>, session management becomes more efficient, using either cookies or database storage. This automation simplifies the development process, but it's important to understand the session management method used by your chosen solution. Ensure it aligns with your application's security and performance requirements.</p> <p>Regardless of your choice, prioritize security in your session management strategy. For cookie-based sessions, using secure and HTTP-only cookies is crucial to protect session data. For database sessions, regular backups and secure handling of session data are essential. Implementing session expiry and cleanup mechanisms is vital in both approaches to prevent unauthorized access and maintain application performance and reliability.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <p>Here are authentication solutions compatible with Next.js, please refer to the quickstart guides below to learn how to configure them in your Next.js application:</p>  <ul> <li><a href=\"https://auth0.com/docs/quickstart/webapp/nextjs/01-login\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Auth0</a></li> <li><a href=\"https://clerk.com/docs/quickstarts/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Clerk</a></li> <li><a href=\"https://kinde.com/docs/developer-tools/nextjs-sdk\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Kinde</a></li> <li><a href=\"https://lucia-auth.com/getting-started/nextjs-app\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Lucia</a></li> <li><a href=\"https://authjs.dev/guides/upgrade-to-v5\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">NextAuth.js</a></li> <li><a href=\"https://supabase.com/docs/guides/getting-started/quickstarts/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Supabase</a></li> <li><a href=\"https://stytch.com/docs/guides/quickstarts/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Stytch</a></li> <li><a href=\"https://github.com/vvo/iron-session\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Iron Session</a></li> </ul> <h2 id=\"further-reading\" data-docs-heading=\"\">Further Reading     </h2> <p>To continue learning about authentication and security, check out the following resources:</p> <ul> <li><a href=\"https://vercel.com/guides/understanding-xss-attacks\" rel=\"noopener noreferrer\" target=\"_blank\">Understanding XSS Attacks</a></li> <li><a href=\"https://vercel.com/guides/understanding-csrf-attacks\" rel=\"noopener noreferrer\" target=\"_blank\">Understanding CSRF Attacks</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/authentication\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/authentication</a>\n  </p>\n</div>\n","pages/building-your-application/deploying":"<h1 class=\"break-words\">Deploying</h1> <p>Congratulations, it's time to ship to production.</p> <p>You can deploy <a href=\"#managed-nextjs-with-vercel\">managed Next.js with Vercel</a>, or self-host on a Node.js server, Docker image, or even static HTML files. When deploying using <code>next start</code>, all Next.js features are supported.</p> <h2 id=\"production-builds\" data-docs-heading=\"\">Production Builds     </h2> <p>Running <code>next build</code> generates an optimized version of your application for production. HTML, CSS, and JavaScript files are created based on your pages. JavaScript is <strong>compiled</strong> and browser bundles are <strong>minified</strong> using the <a href=\"../../architecture/nextjs-compiler\">Next.js Compiler</a> to help achieve the best performance and support <a href=\"../../architecture/supported-browsers\">all modern browsers</a>.</p> <p>Next.js produces a standard deployment output used by managed and self-hosted Next.js. This ensures all features are supported across both methods of deployment. In the next major version, we will be transforming this output into our <a href=\"https://vercel.com/docs/build-output-api/v3?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Build Output API specification</a>.</p> <h2 id=\"managed-nextjs-with-vercel\" data-docs-heading=\"\">Managed Next.js with Vercel     </h2> <p><a href=\"https://vercel.com/docs/frameworks/nextjs?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, the creators and maintainers of Next.js, provide managed infrastructure and a developer experience platform for your Next.js applications.</p> <p>Deploying to Vercel is zero-configuration and provides additional enhancements for scalability, availability, and performance globally. However, all Next.js features are still supported when self-hosted.</p> <p>Learn more about <a href=\"https://vercel.com/docs/frameworks/nextjs?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js on Vercel</a> or <a href=\"https://vercel.com/templates/next.js?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">deploy a template for free</a> to try it out.</p> <h2 id=\"self-hosting\" data-docs-heading=\"\">Self-Hosting     </h2> <p>You can self-host Next.js in three different ways:</p> <ul> <li><a href=\"#nodejs-server\">A Node.js server</a></li> <li><a href=\"#docker-image\">A Docker container</a></li> <li><a href=\"#static-html-export\">A static export</a></li> </ul> <h3 id=\"nodejs-server\" data-docs-heading=\"\">Node.js Server     </h3> <p>Next.js can be deployed to any hosting provider that supports Node.js. Ensure your <code>package.json</code> has the <code>\"build\"</code> and <code>\"start\"</code> scripts:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}</pre></div> <p>Then, run <code>npm run build</code> to build your application. Finally, run <code>npm run start</code> to start the Node.js server. This server supports all Next.js features.</p> <h3 id=\"docker-image\" data-docs-heading=\"\">Docker Image     </h3> <p>Next.js can be deployed to any hosting provider that supports <a href=\"https://www.docker.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Docker</a> containers. You can use this approach when deploying to container orchestrators such as <a href=\"https://kubernetes.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Kubernetes</a> or when running inside a container in any cloud provider.</p> <ol> <li>\n<a href=\"https://docs.docker.com/get-docker/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Install Docker</a> on your machine</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-docker\" rel=\"noopener noreferrer\" target=\"_blank\">Clone our example</a> (or the <a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-docker-multi-env\" rel=\"noopener noreferrer\" target=\"_blank\">multi-environment example</a>)</li> <li>Build your container: <code>docker build -t nextjs-docker .</code>\n</li> <li>Run your container: <code>docker run -p 3000:3000 nextjs-docker</code>\n</li> </ol> <p>Next.js through Docker supports all Next.js features.</p> <h3 id=\"static-html-export\" data-docs-heading=\"\">Static HTML Export     </h3> <p>Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server.</p> <p>Since Next.js supports this <a href=\"../../app/building-your-application/deploying/static-exports\">static export</a>, it can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets. This includes tools like AWS S3, Nginx, or Apache.</p> <p>Running as a <a href=\"../../app/building-your-application/deploying/static-exports\">static export</a> does not support Next.js features that require a server. <a href=\"../../app/building-your-application/deploying/static-exports#unsupported-features\">Learn more</a>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>\n<a href=\"../../app/building-your-application/rendering/server-components\">Server Components</a> are supported with static exports.</li> </ul> </blockquote> <h2 id=\"features\" data-docs-heading=\"\">Features     </h2> <h3 id=\"image-optimization\" data-docs-heading=\"\">Image Optimization     </h3> <p><a href=\"../../app/building-your-application/optimizing/images\">Image Optimization</a> through <code>next/image</code> works self-hosted with zero configuration when deploying using <code>next start</code>. If you would prefer to have a separate service to optimize images, you can <a href=\"../../app/building-your-application/optimizing/images#loaders\">configure an image loader</a>.</p> <p>Image Optimization can be used with a <a href=\"../../app/building-your-application/deploying/static-exports#image-optimization\">static export</a> by defining a custom image loader in <code>next.config.js</code>. Note that images are optimized at runtime, not during the build.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>When self-hosting, consider installing <code>sharp</code> for more performant <a href=\"optimizing/images\">Image Optimization</a> in your production environment by running <code>npm install sharp</code> in your project directory. On Linux platforms, <code>sharp</code> may require <a href=\"https://sharp.pixelplumbing.com/install#linux-memory-allocator\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">additional configuration</a> to prevent excessive memory usage.</li> <li>Learn more about the <a href=\"../../app/api-reference/components/image#caching-behavior\">caching behavior of optimized images</a> and how to configure the TTL.</li> <li>You can also <a href=\"../../app/api-reference/components/image#unoptimized\">disable Image Optimization</a> and still retain other benefits of using <code>next/image</code> if you prefer. For example, if you are optimizing images yourself separately.</li> </ul> </blockquote> <h3 id=\"middleware\" data-docs-heading=\"\">Middleware     </h3> <p><a href=\"../../app/building-your-application/routing/middleware\">Middleware</a> works self-hosted with zero configuration when deploying using <code>next start</code>. Since it requires access to the incoming request, it is not supported when using a <a href=\"../../app/building-your-application/deploying/static-exports\">static export</a>.</p> <p>Middleware uses a <a href=\"../../app/building-your-application/rendering/edge-and-nodejs-runtimes\">runtime</a> that is a subset of all available Node.js APIs to help ensure low latency, since it may run in front of every route or asset in your application. This runtime does not require running at the edge and works in a single-region server. Additional configuration and infrastructure are required to run Middleware in multiple regions.</p> <p>If you are looking to add logic (or use an external package) that requires all Node.js APIs, you might be able to move this logic to a <a href=\"../../app/building-your-application/routing/pages-and-layouts#layouts\">layout</a> as a <a href=\"../../app/building-your-application/rendering/server-components\">Server Component</a>. For example, checking <a href=\"../../app/api-reference/functions/headers\">headers</a> and <a href=\"../../app/api-reference/functions/redirect\">redirecting</a>. You can also use headers, cookies, or query parameters to <a href=\"../../app/api-reference/next-config-js/redirects#header-cookie-and-query-matching\">redirect</a> or <a href=\"../../app/api-reference/next-config-js/rewrites#header-cookie-and-query-matching\">rewrite</a> through <code>next.config.js</code>. If that does not work, you can also use a <a href=\"configuring/custom-server\">custom server</a>.</p> <h3 id=\"environment-variables\" data-docs-heading=\"\">Environment Variables     </h3> <p>Next.js can support both build time and runtime environment variables.</p> <p><strong>By default, environment variables are only available on the server</strong>. To expose an environment variable to the browser, it must be prefixed with <code>NEXT_PUBLIC_</code>. However, these public environment variables will be inlined into the JavaScript bundle during <code>next build</code>.</p> <p>To read runtime environment variables, we recommend using <code>getServerSideProps</code> or <a href=\"../../app/building-your-application/upgrading/app-router-migration\">incrementally adopting the App Router</a>. With the App Router, we can safely read environment variables on the server during dynamic rendering. This allows you to use a singular Docker image that can be promoted through multiple environments with different values.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { unstable_noStore as noStore } from 'next/cache';\n \nexport default function Component() {\n  noStore();\n  // cookies(), headers(), and other dynamic functions\n  // will also opt into dynamic rendering, making\n  // this env variable is evaluated at runtime\n  const value = process.env.MY_VALUE\n  ...\n}</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>You can run code on server startup using the <a href=\"../../app/building-your-application/optimizing/instrumentation\"><code>register</code> function</a>.</li> <li>We do not recommend using the <a href=\"../api-reference/next-config-js/runtime-configuration\">runtimeConfig</a> option, as this does not work with the standalone output mode. Instead, we recommend <a href=\"../../app/building-your-application/upgrading/app-router-migration\">incrementally adopting</a> the App Router.</li> </ul> </blockquote> <h3 id=\"caching-and-isr\" data-docs-heading=\"\">Caching and ISR     </h3> <p>Next.js can cache responses, generated static pages, build outputs, and other static assets like images, fonts, and scripts.</p> <p>Caching and revalidating pages (using Incremental Static Regeneration (ISR) or newer functions in the App Router) use the <strong>same shared cache</strong>. By default, this cache is stored to the filesystem (on disk) on your Next.js server. <strong>This works automatically when self-hosting</strong> using both the Pages and App Router.</p> <p>You can configure the Next.js cache location if you want to persist cached pages and data to durable storage, or share the cache across multiple containers or instances of your Next.js application.</p> <h4 id=\"automatic-caching\" data-docs-heading=\"\">Automatic Caching     </h4> <ul> <li>Next.js sets the <code>Cache-Control</code> header of <code>public, max-age=31536000, immutable</code> to truly immutable assets. It cannot be overridden. These immutable files contain a SHA-hash in the file name, so they can be safely cached indefinitely. For example, <a href=\"../../app/building-your-application/optimizing/images#local-images\">Static Image Imports</a>. You can <a href=\"../../app/api-reference/components/image#caching-behavior\">configure the TTL</a> for images.</li> <li>Incremental Static Regeneration (ISR) sets the <code>Cache-Control</code> header of <code>s-maxage: &lt;revalidate in getStaticProps&gt;, stale-while-revalidate</code>. This revalidation time is defined in your <a href=\"data-fetching/get-static-props\"><code>getStaticProps</code> function</a> in seconds. If you set <code>revalidate: false</code>, it will default to a one-year cache duration.</li> <li>Dynamically rendered pages set a <code>Cache-Control</code> header of <code>private, no-cache, no-store, max-age=0, must-revalidate</code> to prevent user-specific data from being cached. This applies to both the App Router and Pages Router. This also includes <a href=\"../../app/building-your-application/configuring/draft-mode\">Draft Mode</a>.</li> </ul> <h4 id=\"static-assets\" data-docs-heading=\"\">Static Assets     </h4> <p>If you want to host static assets on a different domain or CDN, you can use the <code>assetPrefix</code> <a href=\"../../app/api-reference/next-config-js/assetprefix\">configuration</a> in <code>next.config.js</code>. Next.js will use this asset prefix when retrieving JavaScript or CSS files. Separating your assets to a different domain does come with the downside of extra time spent on DNS and TLS resolution.</p> <p><a href=\"../../app/api-reference/next-config-js/assetprefix\">Learn more about <code>assetPrefix</code></a>.</p> <h4 id=\"configuring-caching\" data-docs-heading=\"\">Configuring Caching     </h4> <p>By default, generated cache assets will be stored in memory (defaults to 50mb) and on disk. If you are hosting Next.js using a container orchestration platform like Kubernetes, each pod will have a copy of the cache. To prevent stale data from being shown since the cache is not shared between pods by default, you can configure the Next.js cache to provide a cache handler and disable in-memory caching.</p> <p>To configure the ISR/Data Cache location when self-hosting, you can configure a custom handler in your <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  cacheHandler: require.resolve('./cache-handler.js'),\n  cacheMaxMemorySize: 0, // disable default in-memory caching\n}</pre></div> <p>Then, create <code>cache-handler.js</code> in the root of your project, for example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const cache = new Map()\n \nmodule.exports = class CacheHandler {\n  constructor(options) {\n    this.options = options\n  }\n \n  async get(key) {\n    // This could be stored anywhere, like durable storage\n    return cache.get(key)\n  }\n \n  async set(key, data, ctx) {\n    // This could be stored anywhere, like durable storage\n    cache.set(key, {\n      value: data,\n      lastModified: Date.now(),\n      tags: ctx.tags,\n    })\n  }\n \n  async revalidateTag(tag) {\n    // Iterate over all entries in the cache\n    for (let [key, value] of cache) {\n      // If the value's tags include the specified tag, delete this entry\n      if (value.tags.includes(tag)) {\n        cache.delete(key)\n      }\n    }\n  }\n}</pre></div> <p>Using a custom cache handler will allow you to ensure consistency across all pods hosting your Next.js application. For instance, you can save the cached values anywhere, like <a href=\"https://github.com/vercel/next.js/tree/canary/examples/cache-handler-redis\" rel=\"noopener noreferrer\" target=\"_blank\">Redis</a> or AWS S3.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>\n<code>revalidatePath</code> is a convenience layer on top of cache tags. Calling <code>revalidatePath</code> will call the <code>revalidateTag</code> function with a special default tag for the provided page.</li> </ul> </blockquote> <h3 id=\"build-cache\" data-docs-heading=\"\">Build Cache     </h3> <p>Next.js generates an ID during <code>next build</code> to identify which version of your application is being served. The same build should be used and boot up multiple containers.</p> <p>If you are rebuilding for each stage of your environment, you will need to generate a consistent build ID to use between containers. Use the <code>generateBuildId</code> command in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  generateBuildId: async () =&gt; {\n    // This could be anything, using the latest git hash\n    return process.env.GIT_HASH\n  },\n}</pre></div> <h3 id=\"version-skew\" data-docs-heading=\"\">Version Skew     </h3> <p>Next.js will automatically mitigate most instances of <a href=\"https://www.industrialempathy.com/posts/version-skew/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">version skew</a> and automatically reload the application to retrieve new assets when detected. For example, if there is a mismatch in the <code>deploymentId</code>, transitions between pages will perform a hard navigation versus using a prefetched value.</p> <p>When the application is reloaded, there may be a loss of application state if it's not designed to persist between page navigations. For example, using URL state or local storage would persist state after a page refresh. However, component state like <code>useState</code> would be lost in such navigations.</p> <p>Vercel provides additional <a href=\"https://vercel.com/docs/deployments/skew-protection?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">skew protection</a> for Next.js applications to ensure assets and functions from the previous version are still available to older clients, even after the new version is deployed.</p> <p>You can manually configure the <code>deploymentId</code> property in your <code>next.config.js</code> file to ensure each request uses either <code>?dpl</code> query string or <code>x-deployment-id</code> header.</p>  <h2 id=\"manual-graceful-shutdowns\" data-docs-heading=\"\">Manual Graceful Shutdowns     </h2>\n<p>When self-hosting, you might want to run code when the server shuts down on <code>SIGTERM</code> or <code>SIGINT</code> signals.</p>\n<p>You can set the env variable <code>NEXT_MANUAL_SIG_HANDLE</code> to <code>true</code> and then register a handler for that signal inside your <code>_document.js</code> file. You will need to register the environment variable directly in the <code>package.json</code> script, and not in the <code>.env</code> file.</p>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Manual signal handling is not available in <code>next dev</code>.</p> </blockquote>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"NEXT_MANUAL_SIG_HANDLE=true next start\"\n  }\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">if (process.env.NEXT_MANUAL_SIG_HANDLE) {\n  process.on('SIGTERM', () =&gt; {\n    console.log('Received SIGTERM: cleaning up')\n    process.exit(0)\n  })\n  process.on('SIGINT', () =&gt; {\n    console.log('Received SIGINT: cleaning up')\n    process.exit(0)\n  })\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/deploying\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/deploying</a>\n  </p>\n</div>\n","pages/building-your-application/deploying/static-exports":"<h1 class=\"break-words\">Static Exports</h1> <p>Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server.</p> <p>When running <code>next build</code>, Next.js generates an HTML file per route. By breaking a strict SPA into individual HTML files, Next.js can avoid loading unnecessary JavaScript code on the client-side, reducing the bundle size and enabling faster page loads.</p> <p>Since Next.js supports this static export, it can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: We recommend using the App Router for enhanced static export support.</p> </blockquote> <h2 id=\"configuration\" data-docs-heading=\"\">Configuration     </h2> <p>To enable a static export, change the output mode inside <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/**\n * @type {import('next').NextConfig}\n */\nconst nextConfig = {\n  output: 'export',\n \n  // Optional: Change links `/me` -&gt; `/me/` and emit `/me.html` -&gt; `/me/index.html`\n  // trailingSlash: true,\n \n  // Optional: Prevent automatic `/me` -&gt; `/me/`, instead preserve `href`\n  // skipTrailingSlashRedirect: true,\n \n  // Optional: Change the output directory `out` -&gt; `dist`\n  // distDir: 'dist',\n}\n \nmodule.exports = nextConfig</pre></div> <p>After running <code>next build</code>, Next.js will produce an <code>out</code> folder which contains the HTML/CSS/JS assets for your application.</p> <p>You can utilize <a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a> and <a href=\"../data-fetching/get-static-paths\"><code>getStaticPaths</code></a> to generate an HTML file for each page in your <code>pages</code> directory (or more for <a href=\"../../../app/building-your-application/routing/dynamic-routes\">dynamic routes</a>).</p>  <h2 id=\"supported-features-1\" data-docs-heading=\"\">Supported Features     </h2>\n<p>The majority of core Next.js features needed to build a static site are supported, including:</p>\n<ul> <li><a href=\"../../../app/building-your-application/routing/dynamic-routes\">Dynamic Routes when using <code>getStaticPaths</code></a></li> <li>Prefetching with <code>next/link</code>\n</li> <li>Preloading JavaScript</li> <li><a href=\"../optimizing/lazy-loading\">Dynamic Imports</a></li> <li>Any styling options (e.g. CSS Modules, styled-jsx)</li> <li><a href=\"../data-fetching/client-side\">Client-side data fetching</a></li> <li><a href=\"../data-fetching/get-static-props\"><code>getStaticProps</code></a></li> <li><a href=\"../data-fetching/get-static-paths\"><code>getStaticPaths</code></a></li> </ul> <h3 id=\"image-optimization\" data-docs-heading=\"\">Image Optimization     </h3> <p><a href=\"../../../app/building-your-application/optimizing/images\">Image Optimization</a> through <code>next/image</code> can be used with a static export by defining a custom image loader in <code>next.config.js</code>. For example, you can optimize images with a service like Cloudinary:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export',\n  images: {\n    loader: 'custom',\n    loaderFile: './my-loader.ts',\n  },\n}\n \nmodule.exports = nextConfig</pre></div> <p>This custom loader will define how to fetch images from a remote source. For example, the following loader will construct the URL for Cloudinary:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function cloudinaryLoader({\n  src,\n  width,\n  quality,\n}: {\n  src: string\n  width: number\n  quality?: number\n}) {\n  const params = ['f_auto', 'c_limit', `w_${width}`, `q_${quality || 'auto'}`]\n  return `https://res.cloudinary.com/demo/image/upload/${params.join(\n    ','\n  )}${src}`\n}</pre></div>  <p>You can then use <code>next/image</code> in your application, defining relative paths to the image in Cloudinary:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return &lt;Image alt=\"turtles\" src=\"/turtles.jpg\" width={300} height={300} /&gt;\n}</pre></div>   <h2 id=\"unsupported-features\" data-docs-heading=\"\">Unsupported Features     </h2> <p>Features that require a Node.js server, or dynamic logic that cannot be computed during the build process, are <strong>not</strong> supported:</p>  <ul> <li><a href=\"../routing/internationalization\">Internationalized Routing</a></li> <li><a href=\"../routing/api-routes\">API Routes</a></li> <li><a href=\"../../api-reference/next-config-js/rewrites\">Rewrites</a></li> <li><a href=\"../../api-reference/next-config-js/redirects\">Redirects</a></li> <li><a href=\"../../api-reference/next-config-js/headers\">Headers</a></li> <li><a href=\"../routing/middleware\">Middleware</a></li> <li><a href=\"../data-fetching/incremental-static-regeneration\">Incremental Static Regeneration</a></li> <li>\n<a href=\"../optimizing/images\">Image Optimization</a> with the default <code>loader</code>\n</li> <li><a href=\"../configuring/draft-mode\">Draft Mode</a></li> <li><a href=\"../../api-reference/functions/get-static-paths#fallback-true\"><code>getStaticPaths</code> with <code>fallback: true</code></a></li> <li><a href=\"../../api-reference/functions/get-static-paths#fallback-blocking\"><code>getStaticPaths</code> with <code>fallback: 'blocking'</code></a></li> <li><a href=\"../data-fetching/get-server-side-props\"><code>getServerSideProps</code></a></li> </ul> <h2 id=\"deploying\" data-docs-heading=\"\">Deploying     </h2> <p>With a static export, Next.js can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets.</p> <p>When running <code>next build</code>, Next.js generates the static export into the <code>out</code> folder. For example, let's say you have the following routes:</p> <ul> <li><code>/</code></li> <li><code>/blog/[id]</code></li> </ul> <p>After running <code>next build</code>, Next.js will generate the following files:</p> <ul> <li><code>/out/index.html</code></li> <li><code>/out/404.html</code></li> <li><code>/out/blog/post-1.html</code></li> <li><code>/out/blog/post-2.html</code></li> </ul> <p>If you are using a static host like Nginx, you can configure rewrites from incoming requests to the correct files:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">server {\n  listen 80;\n  server_name acme.com;\n \n  root /var/www/out;\n \n  location / {\n      try_files $uri $uri.html $uri/ =404;\n  }\n \n  # This is necessary when `trailingSlash: false`.\n  # You can omit this when `trailingSlash: true`.\n  location /blog/ {\n      rewrite ^/blog/(.*)$ /blog/$1.html break;\n  }\n \n  error_page 404 /404.html;\n  location = /404.html {\n      internal;\n  }\n}</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v14.0.0</code></td>\n<td>\n<code>next export</code> has been removed in favor of <code>\"output\": \"export\"</code>\n</td>\n</tr>\n<tr>\n<td><code>v13.4.0</code></td>\n<td>App Router (Stable) adds enhanced static export support, including using React Server Components and Route Handlers.</td>\n</tr>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>next export</code> is deprecated and replaced with <code>\"output\": \"export\"</code>\n</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/deploying/static-exports\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/deploying/static-exports</a>\n  </p>\n</div>\n","pages/building-your-application/testing/cypress":"<h1 class=\"break-words\">Setting up Cypress with Next.js</h1>\n<p><a href=\"https://www.cypress.io/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cypress</a> is a test runner used for <strong>End-to-End (E2E)</strong> and <strong>Component Testing</strong>. This page will show you how to set up Cypress with Next.js and write your first tests.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong></p> <ul> <li>For <strong>component testing</strong>, Cypress currently does not support <a href=\"https://github.com/cypress-io/cypress/issues/28185\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Next.js version 14</a> and <code>async</code> Server Components. These issues are being tracked. For now, component testing works with Next.js version 13, and we recommend E2E testing for <code>async</code> Server Components.</li> <li>Cypress currently does not support <a href=\"https://github.com/cypress-io/cypress/issues/27731\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">TypeScript version 5</a> with <code>moduleResolution:\"bundler\"</code>. This issue is being tracked.</li> </ul> </blockquote>  <h2 id=\"manual-setup\" data-docs-heading=\"\">Manual setup     </h2> <p>To manually set up Cypress, install <code>cypress</code> as a dev dependency:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D cypress\n# or\nyarn add -D cypress\n# or\npnpm install -D cypress</pre></div> <p>Add the Cypress <code>open</code> command to the <code>package.json</code> scripts field:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\",\n    \"cypress:open\": \"cypress open\"\n  }\n}</pre></div> <p>Run Cypress for the first time to open the Cypress testing suite:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm run cypress:open</pre></div> <p>You can choose to configure <strong>E2E Testing</strong> and/or <strong>Component Testing</strong>. Selecting any of these options will automatically create a <code>cypress.config.js</code> file and a <code>cypress</code> folder in your project.</p> <h2 id=\"creating-your-first-cypress-e2e-test\" data-docs-heading=\"\">Creating your first Cypress E2E test     </h2> <p>Ensure your <code>cypress.config.js</code> file has the following configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { defineConfig } from 'cypress'\n \nexport default defineConfig({\n  e2e: {\n    setupNodeEvents(on, config) {},\n  },\n})</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const { defineConfig } = require('cypress')\n \nmodule.exports = defineConfig({\n  e2e: {\n    setupNodeEvents(on, config) {},\n  },\n})</pre></div> <p>Then, create two new Next.js files:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Home() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Home&lt;/h1&gt;\n      &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function About() {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;About&lt;/h1&gt;\n      &lt;Link href=\"/\"&gt;Home&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Add a test to check your navigation is working correctly:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">describe('Navigation', () =&gt; {\n  it('should navigate to the about page', () =&gt; {\n    // Start from the index page\n    cy.visit('http://localhost:3000/')\n \n    // Find a link with an href attribute containing \"about\" and click it\n    cy.get('a[href*=\"about\"]').click()\n \n    // The new url should include \"/about\"\n    cy.url().should('include', '/about')\n \n    // The new page should contain an h1 with \"About\"\n    cy.get('h1').contains('About')\n  })\n})</pre></div> <h3 id=\"running-e2e-tests\" data-docs-heading=\"\">Running E2E Tests     </h3> <p>Cypress will simulate a user navigating your application, this requires your Next.js server to be running. We recommend running your tests against your production code to more closely resemble how your application will behave.</p> <p>Run <code>npm run build &amp;&amp; npm run start</code> to build your Next.js application, then run <code>npm run cypress:open</code> in another terminal window to start Cypress and run your E2E testing suite.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>You can use <code>cy.visit(\"/\")</code> instead of <code>cy.visit(\"http://localhost:3000/\")</code> by adding <code>baseUrl: 'http://localhost:3000'</code> to the <code>cypress.config.js</code> configuration file.</li> <li>Alternatively, you can install the <code>start-server-and-test</code> package to run the Next.js production server in conjunction with Cypress. After installation, add <code>\"test\": \"start-server-and-test start http://localhost:3000 cypress\"</code> to your <code>package.json</code> scripts field. Remember to rebuild your application after new changes.</li> </ul> </blockquote> <h2 id=\"creating-your-first-cypress-component-test\" data-docs-heading=\"\">Creating your first Cypress component test     </h2> <p>Component tests build and mount a specific component without having to bundle your whole application or start a server.</p> <p>Select <strong>Component Testing</strong> in the Cypress app, then select <strong>Next.js</strong> as your front-end framework. A <code>cypress/component</code> folder will be created in your project, and a <code>cypress.config.js</code> file will be updated to enable component testing.</p> <p>Ensure your <code>cypress.config.js</code> file has the following configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { defineConfig } from 'cypress'\n \nexport default defineConfig({\n  component: {\n    devServer: {\n      framework: 'next',\n      bundler: 'webpack',\n    },\n  },\n})</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const { defineConfig } = require('cypress')\n \nmodule.exports = defineConfig({\n  component: {\n    devServer: {\n      framework: 'next',\n      bundler: 'webpack',\n    },\n  },\n})</pre></div> <p>Assuming the same components from the previous section, add a test to validate a component is rendering the expected output:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import AboutPage from '../../pages/about'\n \ndescribe('&lt;AboutPage /&gt;', () =&gt; {\n  it('should render and display expected content', () =&gt; {\n    // Mount the React component for the About page\n    cy.mount(&lt;AboutPage /&gt;)\n \n    // The new page should contain an h1 with \"About page\"\n    cy.get('h1').contains('About')\n \n    // Validate that a link with the expected URL is present\n    // *Following* the link is better suited to an E2E test\n    cy.get('a[href=\"/\"]').should('be.visible')\n  })\n})</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Cypress currently doesn't support component testing for <code>async</code> Server Components. We recommend using E2E testing.</li> <li>Since component tests do not require a Next.js server, features like <code>&lt;Image /&gt;</code> that rely on a server being available may not function out-of-the-box.</li> </ul> </blockquote> <h3 id=\"running-component-tests\" data-docs-heading=\"\">Running Component Tests     </h3> <p>Run <code>npm run cypress:open</code> in your terminal to start Cypress and run your component testing suite.</p> <h2 id=\"continuous-integration-ci\" data-docs-heading=\"\">Continuous Integration (CI)     </h2> <p>In addition to interactive testing, you can also run Cypress headlessly using the <code>cypress run</code> command, which is better suited for CI environments:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    //...\n    \"e2e\": \"start-server-and-test dev http://localhost:3000 \\\"cypress open --e2e\\\"\",\n    \"e2e:headless\": \"start-server-and-test dev http://localhost:3000 \\\"cypress run --e2e\\\"\",\n    \"component\": \"cypress open --component\",\n    \"component:headless\": \"cypress run --component\"\n  }\n}</pre></div> <p>You can learn more about Cypress and Continuous Integration from these resources:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-cypress\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js with Cypress example</a></li> <li><a href=\"https://docs.cypress.io/guides/continuous-integration/introduction\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cypress Continuous Integration Docs</a></li> <li><a href=\"https://on.cypress.io/github-actions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cypress GitHub Actions Guide</a></li> <li><a href=\"https://github.com/cypress-io/github-action\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Official Cypress GitHub Action</a></li> <li><a href=\"https://discord.com/invite/cypress\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cypress Discord</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/testing/cypress\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/testing/cypress</a>\n  </p>\n</div>\n","pages/building-your-application/deploying/multi-zones":"<h1 class=\"break-words\">Multi Zones</h1>\n<details open=\"\"><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-zones\" rel=\"noopener noreferrer\" target=\"_blank\">With Zones</a></li> </ul></details> <p>A zone is a single deployment of a Next.js app. You can have multiple zones and merge them as a single app.</p> <p>For example, let's say you have the following apps:</p> <ul> <li>An app for serving <code>/blog/**</code>\n</li> <li>Another app for serving all other pages</li> </ul> <p>With multi zones support, you can merge both these apps into a single one allowing your customers to browse it using a single URL, but you can develop and deploy both apps independently.</p> <h2 id=\"how-to-define-a-zone\" data-docs-heading=\"\">How to define a zone     </h2> <p>There are no zone related APIs. You only need to do the following:</p> <ul> <li>Make sure to keep only the pages you need in your app, meaning that an app can't have pages from another app, if app <code>A</code> has <code>/blog</code> then app <code>B</code> shouldn't have it too.</li> <li>Make sure to configure a <a href=\"../../../app/api-reference/next-config-js/basepath\">basePath</a> to avoid conflicts with pages and static files.</li> </ul> <h2 id=\"how-to-merge-zones\" data-docs-heading=\"\">How to merge zones     </h2> <p>You can merge zones using <a href=\"../../api-reference/next-config-js/rewrites\"><code>rewrites</code></a> in one of the apps or any HTTP proxy.</p> <p>For <a href=\"https://vercel.com?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js on Vercel</a> applications, you can use a <a href=\"https://vercel.com/blog/monorepos-are-changing-how-teams-build-software?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">monorepo</a> to deploy both apps with a single <code>git push</code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/deploying/multi-zones\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/deploying/multi-zones</a>\n  </p>\n</div>\n","pages/building-your-application/deploying/ci-build-caching":"<h1 class=\"break-words\">Continuous Integration (CI) Build Caching</h1>\n<p>To improve build performance, Next.js saves a cache to <code>.next/cache</code> that is shared between builds.</p> <p>To take advantage of this cache in Continuous Integration (CI) environments, your CI workflow will need to be configured to correctly persist the cache between builds.</p> <blockquote class=\"p-3 text-sm\"> <p>If your CI is not configured to persist <code>.next/cache</code> between builds, you may see a <a href=\"../../../messages/no-cache\">No Cache Detected</a> error.</p> </blockquote> <p>Here are some example cache configurations for common CI providers:</p> <h2 id=\"vercel\" data-docs-heading=\"\">Vercel     </h2> <p>Next.js caching is automatically configured for you. There's no action required on your part.</p> <h2 id=\"circleci\" data-docs-heading=\"\">CircleCI     </h2> <p>Edit your <code>save_cache</code> step in <code>.circleci/config.yml</code> to include <code>.next/cache</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">steps:\n  - save_cache:\n      key: dependency-cache-{{ checksum \"yarn.lock\" }}\n      paths:\n        - ./node_modules\n        - ./.next/cache</pre>\n</div> <p>If you do not have a <code>save_cache</code> key, please follow CircleCI's <a href=\"https://circleci.com/docs/2.0/caching/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">documentation on setting up build caching</a>.</p> <h2 id=\"travis-ci\" data-docs-heading=\"\">Travis CI     </h2> <p>Add or merge the following into your <code>.travis.yml</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">cache:\n  directories:\n    - $HOME/.cache/yarn\n    - node_modules\n    - .next/cache</pre>\n</div> <h2 id=\"gitlab-ci\" data-docs-heading=\"\">GitLab CI     </h2> <p>Add or merge the following into your <code>.gitlab-ci.yml</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">cache:\n  key: ${CI_COMMIT_REF_SLUG}\n  paths:\n    - node_modules/\n    - .next/cache/</pre>\n</div> <h2 id=\"netlify-ci\" data-docs-heading=\"\">Netlify CI     </h2> <p>Use <a href=\"https://www.netlify.com/products/build/plugins/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Netlify Plugins</a> with <a href=\"https://www.npmjs.com/package/@netlify/plugin-nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@netlify/plugin-nextjs</code></a>.</p> <h2 id=\"aws-codebuild\" data-docs-heading=\"\">AWS CodeBuild     </h2> <p>Add (or merge in) the following to your <code>buildspec.yml</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">cache:\n  paths:\n    - 'node_modules/**/*' # Cache `node_modules` for faster `yarn` or `npm i`\n    - '.next/cache/**/*' # Cache Next.js for faster application rebuilds</pre>\n</div> <h2 id=\"github-actions\" data-docs-heading=\"\">GitHub Actions     </h2> <p>Using GitHub's <a href=\"https://github.com/actions/cache\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">actions/cache</a>, add the following step in your workflow file:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">uses: actions/cache@v4\nwith:\n  # See here for caching with `yarn` https://github.com/actions/cache/blob/main/examples.md#node---yarn or you can leverage caching with actions/setup-node https://github.com/actions/setup-node\n  path: |\n    ~/.npm\n    ${{ github.workspace }}/.next/cache\n  # Generate a new cache whenever packages or source files change.\n  key: ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json') }}-${{ hashFiles('**/*.js', '**/*.jsx', '**/*.ts', '**/*.tsx') }}\n  # If source files changed but packages didn't, rebuild from a prior cache.\n  restore-keys: |\n    ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json') }}-</pre>\n</div> <h2 id=\"bitbucket-pipelines\" data-docs-heading=\"\">Bitbucket Pipelines     </h2> <p>Add or merge the following into your <code>bitbucket-pipelines.yml</code> at the top level (same level as <code>pipelines</code>):</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">definitions:\n  caches:\n    nextcache: .next/cache</pre>\n</div> <p>Then reference it in the <code>caches</code> section of your pipeline's <code>step</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">- step:\n    name: your_step_name\n    caches:\n      - node\n      - nextcache</pre>\n</div> <h2 id=\"heroku\" data-docs-heading=\"\">Heroku     </h2> <p>Using Heroku's <a href=\"https://devcenter.heroku.com/articles/nodejs-support#custom-caching\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">custom cache</a>, add a <code>cacheDirectories</code> array in your top-level package.json:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">\"cacheDirectories\": [\".next/cache\"]</pre>\n</div> <h2 id=\"azure-pipelines\" data-docs-heading=\"\">Azure Pipelines     </h2> <p>Using Azure Pipelines' <a href=\"https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/utility/cache\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cache task</a>, add the following task to your pipeline yaml file somewhere prior to the task that executes <code>next build</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">- task: Cache@2\n  displayName: 'Cache .next/cache'\n  inputs:\n    key: next | $(Agent.OS) | yarn.lock\n    path: '$(System.DefaultWorkingDirectory)/.next/cache'</pre>\n</div> <h2 id=\"jenkins-pipeline\" data-docs-heading=\"\">Jenkins (Pipeline)     </h2> <p>Using Jenkins' <a href=\"https://www.jenkins.io/doc/pipeline/steps/jobcacher/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Job Cacher</a> plugin, add the following build step to your <code>Jenkinsfile</code> where you would normally run <code>next build</code> or <code>npm install</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">stage(\"Restore npm packages\") {\n    steps {\n        // Writes lock-file to cache based on the GIT_COMMIT hash\n        writeFile file: \"next-lock.cache\", text: \"$GIT_COMMIT\"\n \n        cache(caches: [\n            arbitraryFileCache(\n                path: \"node_modules\",\n                includes: \"**/*\",\n                cacheValidityDecidingFile: \"package-lock.json\"\n            )\n        ]) {\n            sh \"npm install\"\n        }\n    }\n}\nstage(\"Build\") {\n    steps {\n        // Writes lock-file to cache based on the GIT_COMMIT hash\n        writeFile file: \"next-lock.cache\", text: \"$GIT_COMMIT\"\n \n        cache(caches: [\n            arbitraryFileCache(\n                path: \".next/cache\",\n                includes: \"**/*\",\n                cacheValidityDecidingFile: \"next-lock.cache\"\n            )\n        ]) {\n            // aka `next build`\n            sh \"npm run build\"\n        }\n    }\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/deploying/ci-build-caching\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/deploying/ci-build-caching</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading":"<h1 class=\"break-words\">Upgrading</h1>\n<p>Upgrade your application to newer versions of Next.js or migrate from the Pages Router to the App Router.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/codemods":"<h1 class=\"break-words\">Codemods</h1>\n<p>Codemods are transformations that run on your codebase programmatically. This allows a large number of changes to be programmatically applied without having to manually go through every file.</p> <p>Next.js provides Codemod transformations to help upgrade your Next.js codebase when an API is updated or deprecated.</p> <h2 id=\"usage\" data-docs-heading=\"\">Usage     </h2> <p>In your terminal, navigate (<code>cd</code>) into your project's folder, then run:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod &lt;transform&gt; &lt;path&gt;</pre></div> <p>Replacing <code>&lt;transform&gt;</code> and <code>&lt;path&gt;</code> with appropriate values.</p> <ul> <li>\n<code>transform</code> - name of transform</li> <li>\n<code>path</code> - files or directory to transform</li> <li>\n<code>--dry</code> Do a dry-run, no code will be edited</li> <li>\n<code>--print</code> Prints the changed output for comparison</li> </ul> <h2 id=\"nextjs-codemods\" data-docs-heading=\"\">Next.js Codemods     </h2> <h3 id=\"140\" data-docs-heading=\"\">14.0     </h3> <h4 id=\"migrate-imageresponse-imports\" data-docs-heading=\"\">Migrate ImageResponse imports     </h4> <h5 id=\"next-og-import\" data-docs-heading=\"\"><a href=\"#next-og-import\"><code>next-og-import</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest next-og-import .</pre></div> <p>This codemod moves transforms imports from <code>next/server</code> to <code>next/og</code> for usage of <a href=\"../../../app/building-your-application/optimizing/metadata#dynamic-image-generation\">Dynamic OG Image Generation</a>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/server'</pre>\n</div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { ImageResponse } from 'next/og'</pre>\n</div> <h4 id=\"use-viewport-export\" data-docs-heading=\"\">Use viewport export     </h4> <h5 id=\"metadata-to-viewport-export\" data-docs-heading=\"\"><a href=\"#metadata-to-viewport-export\"><code>metadata-to-viewport-export</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest metadata-to-viewport-export .</pre></div> <p>This codemod migrates certain viewport metadata to <code>viewport</code> export.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'My App',\n  themeColor: 'dark',\n  viewport: {\n    width: 1,\n  },\n}</pre>\n</div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const metadata = {\n  title: 'My App',\n}\n \nexport const viewport = {\n  width: 1,\n  themeColor: 'dark',\n}</pre>\n</div> <h3 id=\"132\" data-docs-heading=\"\">13.2     </h3> <h4 id=\"use-built-in-font\" data-docs-heading=\"\">Use Built-in Font     </h4> <h5 id=\"built-in-next-font\" data-docs-heading=\"\"><a href=\"#built-in-next-font\"><code>built-in-next-font</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest built-in-next-font .</pre></div> <p>This codemod uninstalls the <code>@next/font</code> package and transforms <code>@next/font</code> imports into the built-in <code>next/font</code>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from '@next/font/google'</pre>\n</div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'</pre>\n</div> <h3 id=\"130\" data-docs-heading=\"\">13.0     </h3> <h4 id=\"rename-next-image-imports\" data-docs-heading=\"\">Rename Next Image Imports     </h4> <h5 id=\"next-image-to-legacy-image\" data-docs-heading=\"\"><a href=\"#next-image-to-legacy-image\"><code>next-image-to-legacy-image</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest next-image-to-legacy-image .</pre></div> <p>Safely renames <code>next/image</code> imports in existing Next.js 10, 11, or 12 applications to <code>next/legacy/image</code> in Next.js 13. Also renames <code>next/future/image</code> to <code>next/image</code>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image1 from 'next/image'\nimport Image2 from 'next/future/image'\n \nexport default function Home() {\n  return (\n    &lt;div&gt;\n      &lt;Image1 src=\"/test.jpg\" width=\"200\" height=\"300\" /&gt;\n      &lt;Image2 src=\"/test.png\" width=\"500\" height=\"400\" /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// 'next/image' becomes 'next/legacy/image'\nimport Image1 from 'next/legacy/image'\n// 'next/future/image' becomes 'next/image'\nimport Image2 from 'next/image'\n \nexport default function Home() {\n  return (\n    &lt;div&gt;\n      &lt;Image1 src=\"/test.jpg\" width=\"200\" height=\"300\" /&gt;\n      &lt;Image2 src=\"/test.png\" width=\"500\" height=\"400\" /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <h4 id=\"migrate-to-the-new-image-component\" data-docs-heading=\"\">Migrate to the New Image Component     </h4> <h5 id=\"next-image-experimental\" data-docs-heading=\"\"><a href=\"#next-image-experimental\"><code>next-image-experimental</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest next-image-experimental .</pre></div> <p>Dangerously migrates from <code>next/legacy/image</code> to the new <code>next/image</code> by adding inline styles and removing unused props.</p> <ul> <li>Removes <code>layout</code> prop and adds <code>style</code>.</li> <li>Removes <code>objectFit</code> prop and adds <code>style</code>.</li> <li>Removes <code>objectPosition</code> prop and adds <code>style</code>.</li> <li>Removes <code>lazyBoundary</code> prop.</li> <li>Removes <code>lazyRoot</code> prop.</li> </ul> <h4 id=\"remove-a-tags-from-link-components\" data-docs-heading=\"\">Remove &lt;a&gt; Tags From Link Components     </h4> <h5 id=\"new-link\" data-docs-heading=\"\"><a href=\"#new-link\"><code>new-link</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod@latest new-link .</pre></div>  <p>Remove <code>&lt;a&gt;</code> tags inside <a href=\"../../api-reference/components/link\">Link Components</a>, or add a <code>legacyBehavior</code> prop to Links that cannot be auto-fixed.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/about\"&gt;\n  &lt;a&gt;About&lt;/a&gt;\n&lt;/Link&gt;\n// transforms into\n&lt;Link href=\"/about\"&gt;\n  About\n&lt;/Link&gt;\n \n&lt;Link href=\"/about\"&gt;\n  &lt;a onClick={() =&gt; console.log('clicked')}&gt;About&lt;/a&gt;\n&lt;/Link&gt;\n// transforms into\n&lt;Link href=\"/about\" onClick={() =&gt; console.log('clicked')}&gt;\n  About\n&lt;/Link&gt;</pre>\n</div> <p>In cases where auto-fixing can't be applied, the <code>legacyBehavior</code> prop is added. This allows your app to keep functioning using the old behavior for that particular link.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const Component = () =&gt; &lt;a&gt;About&lt;/a&gt;\n \n&lt;Link href=\"/about\"&gt;\n  &lt;Component /&gt;\n&lt;/Link&gt;\n// becomes\n&lt;Link href=\"/about\" legacyBehavior&gt;\n  &lt;Component /&gt;\n&lt;/Link&gt;</pre>\n</div> <h3 id=\"11\" data-docs-heading=\"\">11     </h3> <h4 id=\"migrate-from-cra\" data-docs-heading=\"\">Migrate from CRA     </h4> <h5 id=\"cra-to-next\" data-docs-heading=\"\"><a href=\"#cra-to-next\"><code>cra-to-next</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod cra-to-next</pre></div> <p>Migrates a Create React App project to Next.js; creating a Pages Router and necessary config to match behavior. Client-side only rendering is leveraged initially to prevent breaking compatibility due to <code>window</code> usage during SSR and can be enabled seamlessly to allow the gradual adoption of Next.js specific features.</p> <p>Please share any feedback related to this transform <a href=\"https://github.com/vercel/next.js/discussions/25858\" rel=\"noopener noreferrer\" target=\"_blank\">in this discussion</a>.</p> <h3 id=\"10\" data-docs-heading=\"\">10     </h3> <h4 id=\"add-react-imports\" data-docs-heading=\"\">Add React imports     </h4> <h5 id=\"add-missing-react-import\" data-docs-heading=\"\"><a href=\"#add-missing-react-import\"><code>add-missing-react-import</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod add-missing-react-import</pre></div> <p>Transforms files that do not import <code>React</code> to include the import in order for the new <a href=\"https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React JSX transform</a> to work.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default class Home extends React.Component {\n  render() {\n    return &lt;div&gt;Hello World&lt;/div&gt;\n  }\n}</pre></div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nexport default class Home extends React.Component {\n  render() {\n    return &lt;div&gt;Hello World&lt;/div&gt;\n  }\n}</pre></div> <h3 id=\"9\" data-docs-heading=\"\">9     </h3> <h4 id=\"transform-anonymous-components-into-named-components\" data-docs-heading=\"\">Transform Anonymous Components into Named Components     </h4> <h5 id=\"name-default-component\" data-docs-heading=\"\"><a href=\"#name-default-component\"><code>name-default-component</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod name-default-component</pre></div> <p><strong>Versions 9 and above.</strong></p> <p>Transforms anonymous components into named components to make sure they work with <a href=\"https://nextjs.org/blog/next-9-4#fast-refresh\" rel=\"noopener noreferrer\" target=\"_blank\">Fast Refresh</a>.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function () {\n  return &lt;div&gt;Hello World&lt;/div&gt;\n}</pre></div> <p>Transforms into:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function MyComponent() {\n  return &lt;div&gt;Hello World&lt;/div&gt;\n}</pre></div> <p>The component will have a camel-cased name based on the name of the file, and it also works with arrow functions.</p> <h3 id=\"8\" data-docs-heading=\"\">8     </h3> <h4 id=\"transform-amp-hoc-into-page-config\" data-docs-heading=\"\">Transform AMP HOC into page config     </h4> <h5 id=\"withamp-to-config\" data-docs-heading=\"\"><a href=\"#withamp-to-config\"><code>withamp-to-config</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod withamp-to-config</pre></div> <p>Transforms the <code>withAmp</code> HOC into Next.js 9 page configuration.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\nimport { withAmp } from 'next/amp'\n \nfunction Home() {\n  return &lt;h1&gt;My AMP Page&lt;/h1&gt;\n}\n \nexport default withAmp(Home)</pre>\n</div> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// After\nexport default function Home() {\n  return &lt;h1&gt;My AMP Page&lt;/h1&gt;\n}\n \nexport const config = {\n  amp: true,\n}</pre>\n</div> <h3 id=\"6\" data-docs-heading=\"\">6     </h3> <h4 id=\"use-withrouter\" data-docs-heading=\"\">Use withRouter     </h4> <h5 id=\"url-to-withrouter\" data-docs-heading=\"\"><a href=\"#url-to-withrouter\"><code>url-to-withrouter</code></a></h5> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx @next/codemod url-to-withrouter</pre></div> <p>Transforms the deprecated automatically injected <code>url</code> property on top level pages to using <code>withRouter</code> and the <code>router</code> property it injects. Read more here: <a href=\"../../../messages/url-deprecated\">https://nextjs.org/docs/messages/url-deprecated</a></p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nexport default class extends React.Component {\n  render() {\n    const { pathname } = this.props.url\n    return &lt;div&gt;Current pathname: {pathname}&lt;/div&gt;\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nimport { withRouter } from 'next/router'\nexport default withRouter(\n  class extends React.Component {\n    render() {\n      const { pathname } = this.props.router\n      return &lt;div&gt;Current pathname: {pathname}&lt;/div&gt;\n    }\n  }\n)</pre></div> <p>This is one case. All the cases that are transformed (and tested) can be found in the <a href=\"https://github.com/vercel/next.js/tree/canary/packages/next-codemod/transforms/__testfixtures__/url-to-withrouter\" rel=\"noopener noreferrer\" target=\"_blank\"><code>__testfixtures__</code> directory</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/codemods\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/codemods</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/version-12":"<h1 class=\"break-words\">Version 12</h1>\n<p>To upgrade to version 12, run the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i next@12 react@17 react-dom@17 eslint-config-next@12</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add next@12 react@17 react-dom@17 eslint-config-next@12</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm up next@12 react@17 react-dom@17 eslint-config-next@12</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add next@12 react@17 react-dom@17 eslint-config-next@12</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> If you are using TypeScript, ensure you also upgrade <code>@types/react</code> and <code>@types/react-dom</code> to their corresponding versions.</p> </blockquote> <h3 id=\"upgrading-to-122\" data-docs-heading=\"\">Upgrading to 12.2     </h3> <p><a href=\"../../../messages/middleware-upgrade-guide\">Middleware</a> - If you were using Middleware prior to <code>12.2</code>, please see the <a href=\"../../../messages/middleware-upgrade-guide\">upgrade guide</a> for more information.</p> <h3 id=\"upgrading-to-120\" data-docs-heading=\"\">Upgrading to 12.0     </h3> <p><a href=\"https://nodejs.org/en/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Minimum Node.js Version</a> - The minimum Node.js version has been bumped from <code>12.0.0</code> to <code>12.22.0</code> which is the first version of Node.js with native ES Modules support.</p> <p><a href=\"https://react.dev/learn/add-react-to-an-existing-project\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Minimum React Version</a> - The minimum required React version is <code>17.0.2</code>. To upgrade you can run the following command in the terminal:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install react@latest react-dom@latest\n \nyarn add react@latest react-dom@latest\n \npnpm update react@latest react-dom@latest\n \nbun add react@latest react-dom@latest</pre></div> <h4 id=\"swc-replacing-babel\" data-docs-heading=\"\">SWC replacing Babel     </h4> <p>Next.js now uses the Rust-based compiler <a href=\"https://swc.rs/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SWC</a> to compile JavaScript/TypeScript. This new compiler is up to 17x faster than Babel when compiling individual files and up to 5x faster Fast Refresh.</p> <p>Next.js provides full backward compatibility with applications that have <a href=\"../configuring/babel\">custom Babel configuration</a>. All transformations that Next.js handles by default like styled-jsx and tree-shaking of <code>getStaticProps</code> / <code>getStaticPaths</code> / <code>getServerSideProps</code> have been ported to Rust.</p> <p>When an application has a custom Babel configuration, Next.js will automatically opt-out of using SWC for compiling JavaScript/Typescript and will fall back to using Babel in the same way that it was used in Next.js 11.</p> <p>Many of the integrations with external libraries that currently require custom Babel transformations will be ported to Rust-based SWC transforms in the near future. These include but are not limited to:</p> <ul> <li>Styled Components</li> <li>Emotion</li> <li>Relay</li> </ul> <p>In order to prioritize transforms that will help you adopt SWC, please provide your <code>.babelrc</code> on <a href=\"https://github.com/vercel/next.js/discussions/30174\" rel=\"noopener noreferrer\" target=\"_blank\">this feedback thread</a>.</p> <h4 id=\"swc-replacing-terser-for-minification\" data-docs-heading=\"\">SWC replacing Terser for minification     </h4> <p>You can opt-in to replacing Terser with SWC for minifying JavaScript up to 7x faster using a flag in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  swcMinify: true,\n}</pre></div> <p>Minification using SWC is an opt-in flag to ensure it can be tested against more real-world Next.js applications before it becomes the default in Next.js 12.1. If you have feedback about minification, please leave it on <a href=\"https://github.com/vercel/next.js/discussions/30237\" rel=\"noopener noreferrer\" target=\"_blank\">this feedback thread</a>.</p> <h4 id=\"improvements-to-styled-jsx-css-parsing\" data-docs-heading=\"\">Improvements to styled-jsx CSS parsing     </h4> <p>On top of the Rust-based compiler we've implemented a new CSS parser based on the one used for the styled-jsx Babel transform. This new parser has improved handling of CSS and now errors when invalid CSS is used that would previously slip through and cause unexpected behavior.</p> <p>Because of this change invalid CSS will throw an error during development and <code>next build</code>. This change only affects styled-jsx usage.</p> <h4 id=\"nextimage-changed-wrapping-element\" data-docs-heading=\"\">next/image changed wrapping element     </h4> <p><code>next/image</code> now renders the <code>&lt;img&gt;</code> inside a <code>&lt;span&gt;</code> instead of <code>&lt;div&gt;</code>.</p> <p>If your application has specific CSS targeting span such as <code>.container span</code>, upgrading to Next.js 12 might incorrectly match the wrapping element inside the <code>&lt;Image&gt;</code> component. You can avoid this by restricting the selector to a specific class such as <code>.container span.item</code> and updating the relevant component with that className, such as <code>&lt;span className=\"item\" /&gt;</code>.</p> <p>If your application has specific CSS targeting the <code>next/image</code> <code>&lt;div&gt;</code> tag, for example <code>.container div</code>, it may not match anymore. You can update the selector <code>.container span</code>, or preferably, add a new <code>&lt;div className=\"wrapper\"&gt;</code> wrapping the <code>&lt;Image&gt;</code> component and target that instead such as <code>.container .wrapper</code>.</p> <p>The <code>className</code> prop is unchanged and will still be passed to the underlying <code>&lt;img&gt;</code> element.</p> <p>See the <a href=\"../optimizing/images#styling\">documentation</a> for more info.</p> <h4 id=\"hmr-connection-now-uses-a-websocket\" data-docs-heading=\"\">HMR connection now uses a WebSocket     </h4> <p>Previously, Next.js used a <a href=\"https://developer.mozilla.org/docs/Web/API/Server-sent_events\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">server-sent events</a> connection to receive HMR events. Next.js 12 now uses a WebSocket connection.</p> <p>In some cases when proxying requests to the Next.js dev server, you will need to ensure the upgrade request is handled correctly. For example, in <code>nginx</code> you would need to add the following configuration:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">location /_next/webpack-hmr {\n    proxy_pass http://localhost:3000/_next/webpack-hmr;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n}</pre>\n</div> <p>If you are using Apache (2.x), you can add the following configuration to enable web sockets to the server. Review the port, host name and server names.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;VirtualHost *:443&gt;\n # ServerName yourwebsite.local\n ServerName \"${WEBSITE_SERVER_NAME}\"\n ProxyPass / http://localhost:3000/\n ProxyPassReverse / http://localhost:3000/\n # Next.js 12 uses websocket\n &lt;Location /_next/webpack-hmr&gt;\n    RewriteEngine On\n    RewriteCond %{QUERY_STRING} transport=websocket [NC]\n    RewriteCond %{HTTP:Upgrade} websocket [NC]\n    RewriteCond %{HTTP:Connection} upgrade [NC]\n    RewriteRule /(.*) ws://localhost:3000/_next/webpack-hmr/$1 [P,L]\n    ProxyPass ws://localhost:3000/_next/webpack-hmr retry=0 timeout=30\n    ProxyPassReverse ws://localhost:3000/_next/webpack-hmr\n &lt;/Location&gt;\n&lt;/VirtualHost&gt;\n</pre>\n</div> <p>For custom servers, such as <code>express</code>, you may need to use <code>app.all</code> to ensure the request is passed correctly, for example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">app.all('/_next/webpack-hmr', (req, res) =&gt; {\n  nextjsRequestHandler(req, res)\n})</pre>\n</div> <h4 id=\"webpack-4-support-has-been-removed\" data-docs-heading=\"\">Webpack 4 support has been removed     </h4> <p>If you are already using webpack 5 you can skip this section.</p> <p>Next.js has adopted webpack 5 as the default for compilation in Next.js 11. As communicated in the <a href=\"../../../messages/webpack5\">webpack 5 upgrading documentation</a> Next.js 12 removes support for webpack 4.</p> <p>If your application is still using webpack 4 using the opt-out flag, you will now see an error linking to the <a href=\"../../../messages/webpack5\">webpack 5 upgrading documentation</a>.</p> <h4 id=\"target-option-deprecated\" data-docs-heading=\"\">target option deprecated     </h4> <p>If you do not have <code>target</code> in <code>next.config.js</code> you can skip this section.</p> <p>The target option has been deprecated in favor of built-in support for tracing what dependencies are needed to run a page.</p> <p>During <code>next build</code>, Next.js will automatically trace each page and its dependencies to determine all of the files that are needed for deploying a production version of your application.</p> <p>If you are currently using the <code>target</code> option set to <code>serverless</code>, please read the <a href=\"../../api-reference/next-config-js/output\">documentation on how to leverage the new output</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/version-12\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/version-12</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/version-11":"<h1 class=\"break-words\">Version 11</h1>\n<p>To upgrade to version 11, run the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i next@11 react@17 react-dom@17</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add next@11 react@17 react-dom@17</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm up next@11 react@17 react-dom@17</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add next@11 react@17 react-dom@17</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> If you are using TypeScript, ensure you also upgrade <code>@types/react</code> and <code>@types/react-dom</code> to their corresponding versions.</p> </blockquote> <h3 id=\"webpack-5\" data-docs-heading=\"\">Webpack 5     </h3> <p>Webpack 5 is now the default for all Next.js applications. If you did not have a custom webpack configuration, your application is already using webpack 5. If you do have a custom webpack configuration, you can refer to the <a href=\"../../../messages/webpack5\">Next.js webpack 5 documentation</a> for upgrade guidance.</p> <h3 id=\"cleaning-the-distdir-is-now-a-default\" data-docs-heading=\"\">Cleaning the distDir is now a default     </h3> <p>The build output directory (defaults to <code>.next</code>) is now cleared by default except for the Next.js caches. You can refer to <a href=\"https://github.com/vercel/next.js/discussions/6009\" rel=\"noopener noreferrer\" target=\"_blank\">the cleaning <code>distDir</code> RFC</a> for more information.</p> <p>If your application was relying on this behavior previously you can disable the new default behavior by adding the <code>cleanDistDir: false</code> flag in <code>next.config.js</code>.</p> <h3 id=\"port-is-now-supported-for-next-dev-and-next-start\" data-docs-heading=\"\">PORT is now supported for next dev and next start     </h3> <p>Next.js 11 supports the <code>PORT</code> environment variable to set the port the application runs on. Using <code>-p</code>/<code>--port</code> is still recommended but if you were prohibited from using <code>-p</code> in any way you can now use <code>PORT</code> as an alternative:</p> <p>Example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">PORT=4000 next start\n</pre>\n</div> <h3 id=\"nextconfigjs-customization-to-import-images\" data-docs-heading=\"\">next.config.js customization to import images     </h3> <p>Next.js 11 supports static image imports with <code>next/image</code>. This new feature relies on being able to process image imports. If you previously added the <code>next-images</code> or <code>next-optimized-images</code> packages you can either move to the new built-in support using <code>next/image</code> or disable the feature:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    disableStaticImages: true,\n  },\n}</pre></div> <h3 id=\"remove-supercomponentdidcatch-from-pages_appjs\" data-docs-heading=\"\">Remove super.componentDidCatch() from pages/_app.js     </h3> <p>The <code>next/app</code> component's <code>componentDidCatch</code> was deprecated in Next.js 9 as it's no longer needed and has since been a no-op. In Next.js 11, it was removed.</p> <p>If your <code>pages/_app.js</code> has a custom <code>componentDidCatch</code> method you can remove <code>super.componentDidCatch</code> as it is no longer needed.</p> <h3 id=\"remove-container-from-pages_appjs\" data-docs-heading=\"\">Remove Container from pages/_app.js     </h3> <p>This export was deprecated in Next.js 9 as it's no longer needed and has since been a no-op with a warning during development. In Next.js 11 it was removed.</p> <p>If your <code>pages/_app.js</code> imports <code>Container</code> from <code>next/app</code> you can remove <code>Container</code> as it was removed. Learn more in <a href=\"../../../messages/app-container-deprecated\">the documentation</a>.</p> <h3 id=\"remove-propsurl-usage-from-page-components\" data-docs-heading=\"\">Remove props.url usage from page components     </h3> <p>This property was deprecated in Next.js 4 and has since shown a warning during development. With the introduction of <code>getStaticProps</code> / <code>getServerSideProps</code> these methods already disallowed the usage of <code>props.url</code>. In Next.js 11, it was removed completely.</p> <p>You can learn more in <a href=\"../../../messages/url-deprecated\">the documentation</a>.</p> <h3 id=\"remove-unsized-property-on-nextimage\" data-docs-heading=\"\">Remove unsized property on next/image     </h3> <p>The <code>unsized</code> property on <code>next/image</code> was deprecated in Next.js 10.0.1. You can use <code>layout=\"fill\"</code> instead. In Next.js 11 <code>unsized</code> was removed.</p> <h3 id=\"remove-modules-property-on-nextdynamic\" data-docs-heading=\"\">Remove modules property on next/dynamic     </h3> <p>The <code>modules</code> and <code>render</code> option for <code>next/dynamic</code> were deprecated in Next.js 9.5. This was done in order to make the <code>next/dynamic</code> API closer to <code>React.lazy</code>. In Next.js 11, the <code>modules</code> and <code>render</code> options were removed.</p> <p>This option hasn't been mentioned in the documentation since Next.js 8 so it's less likely that your application is using it.</p> <p>If your application does use <code>modules</code> and <code>render</code> you can refer to <a href=\"../../../messages/next-dynamic-modules\">the documentation</a>.</p> <h3 id=\"remove-headrewind\" data-docs-heading=\"\">Remove Head.rewind     </h3> <p><code>Head.rewind</code> has been a no-op since Next.js 9.5, in Next.js 11 it was removed. You can safely remove your usage of <code>Head.rewind</code>.</p> <h3 id=\"momentjs-locales-excluded-by-default\" data-docs-heading=\"\">Moment.js locales excluded by default     </h3> <p>Moment.js includes translations for a lot of locales by default. Next.js now automatically excludes these locales by default to optimize bundle size for applications using Moment.js.</p> <p>To load a specific locale use this snippet:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import moment from 'moment'\nimport 'moment/locale/ja'\n \nmoment.locale('ja')</pre>\n</div> <p>You can opt-out of this new default by adding <code>excludeDefaultMomentLocales: false</code> to <code>next.config.js</code> if you do not want the new behavior, do note it's highly recommended to not disable this new optimization as it significantly reduces the size of Moment.js.</p> <h3 id=\"update-usage-of-routerevents\" data-docs-heading=\"\">Update usage of router.events     </h3> <p>In case you're accessing <code>router.events</code> during rendering, in Next.js 11 <code>router.events</code> is no longer provided during pre-rendering. Ensure you're accessing <code>router.events</code> in <code>useEffect</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useEffect(() =&gt; {\n  const handleRouteChange = (url, { shallow }) =&gt; {\n    console.log(\n      `App is changing to ${url} ${\n        shallow ? 'with' : 'without'\n      } shallow routing`\n    )\n  }\n \n  router.events.on('routeChangeStart', handleRouteChange)\n \n  // If the component is unmounted, unsubscribe\n  // from the event with the `off` method:\n  return () =&gt; {\n    router.events.off('routeChangeStart', handleRouteChange)\n  }\n}, [router])</pre>\n</div> <p>If your application uses <code>router.router.events</code> which was an internal property that was not public please make sure to use <code>router.events</code> as well.</p> <h2 id=\"react-16-to-17\" data-docs-heading=\"\">React 16 to 17     </h2> <p>React 17 introduced a new <a href=\"https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">JSX Transform</a> that brings a long-time Next.js feature to the wider React ecosystem: Not having to <code>import React from 'react'</code> when using JSX. When using React 17 Next.js will automatically use the new transform. This transform does not make the <code>React</code> variable global, which was an unintended side-effect of the previous Next.js implementation. A <a href=\"codemods#add-missing-react-import\">codemod is available</a> to automatically fix cases where you accidentally used <code>React</code> without importing it.</p> <p>Most applications already use the latest version of React, with Next.js 11 the minimum React version has been updated to 17.0.2.</p> <p>To upgrade you can run the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install react@latest react-dom@latest\n</pre>\n</div> <p>Or using <code>yarn</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add react@latest react-dom@latest\n</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/version-11\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/version-11</a>\n  </p>\n</div>\n","pages/building-your-application/deploying/production-checklist":"<h1 class=\"break-words\">Production Checklist</h1>\n<p>Before taking your Next.js application to production, there are some optimizations and patterns you should consider implementing for the best user experience, performance, and security.</p> <p>This page provides best practices that you can use as a reference when <a href=\"#during-development\">building your application</a>, <a href=\"#before-going-to-production\">before going to production</a>, and <a href=\"#after-deployment\">after deployment</a> - as well as the <a href=\"#automatic-optimizations\">automatic Next.js optimizations</a> you should be aware of.</p> <h2 id=\"automatic-optimizations\" data-docs-heading=\"\">Automatic optimizations     </h2> <p>These Next.js optimizations are enabled by default and require no configuration:</p>  <ul> <li>\n<strong><a href=\"../routing/pages-and-layouts\">Code-splitting</a>:</strong> Next.js automatically code-splits your application code by pages. This means only the code needed for the current page is loaded on navigation. You may also consider <a href=\"../optimizing/lazy-loading\">lazy loading</a> third-party libraries, where appropriate.</li> <li>\n<strong><a href=\"../../api-reference/components/link#prefetch\">Prefetching</a>:</strong> When a link to a new route enters the user's viewport, Next.js prefetches the route in background. This makes navigation to new routes almost instant. You can opt out of prefetching, where appropriate.</li> <li>\n<strong><a href=\"../rendering/automatic-static-optimization\">Automatic Static Optimization</a>:</strong> Next.js automatically determines that a page is static (can be pre-rendered) if it has no blocking data requirements. Optimized pages can be cached, and served to the end-user from multiple CDN locations. You may opt into <a href=\"../data-fetching/get-server-side-props\">Server-side Rendering</a>, where appropriate.</li> </ul> <p>These defaults aim to improve your application's performance, and reduce the cost and amount of data transferred on each network request.</p> <h2 id=\"during-development\" data-docs-heading=\"\">During development     </h2> <p>While building your application, we recommend using the following features to ensure the best performance and user experience:</p> <h3 id=\"routing-and-rendering\" data-docs-heading=\"\">Routing and rendering     </h3>  <ul> <li>\n<strong><a href=\"../routing/linking-and-navigating\"><code>&lt;Link&gt;</code> component</a>:</strong> Use the <code>&lt;Link&gt;</code> component for client-side navigation and prefetching.</li> <li>\n<strong><a href=\"../routing/custom-error\">Custom Errors</a>:</strong> Gracefully handle <a href=\"../routing/custom-error#500-page\">500</a> and <a href=\"../routing/custom-error#404-page\">404 errors</a>\n</li> </ul> <h3 id=\"data-fetching-and-caching\" data-docs-heading=\"\">Data fetching and caching     </h3>  <ul> <li>\n<strong><a href=\"../routing/api-routes\">API Routes</a>:</strong> Use Route Handlers to access your backend resources, and prevent sensitive secrets from being exposed to the client.</li> <li>\n<strong><a href=\"../data-fetching/get-static-props\">Data Caching</a>:</strong> Verify whether your data requests are being cached or not, and opt into caching, where appropriate. Ensure requests that don't use <code>getStaticProps</code> are cached where appropriate.</li> <li>\n<strong><a href=\"../data-fetching/incremental-static-regeneration\">Incremental Static Regeneration</a>:</strong> Use Incremental Static Regeneration to update static pages after they've been built, without rebuilding your entire site.</li> <li>\n<strong><a href=\"../optimizing/static-assets\">Static Images</a>:</strong> Use the <code>public</code> directory to automatically cache your application's static assets, e.g. images.</li> </ul> <h3 id=\"ui-and-accessibility\" data-docs-heading=\"\">UI and accessibility     </h3>  <ul> <li>\n<strong><a href=\"../../../app/building-your-application/optimizing/fonts\">Font Module</a>:</strong> Optimize fonts by using the Font Module, which automatically hosts your font files with other static assets, removes external network requests, and reduces <a href=\"https://web.dev/articles/cls\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">layout shift</a>.</li> <li>\n<strong><a href=\"../../../app/building-your-application/optimizing/images\"><code>&lt;Image&gt;</code> Component</a>:</strong> Optimize images by using the Image Component, which automatically optimizes images, prevents layout shift, and serves them in modern formats like WebP or AVIF.</li> <li>\n<strong><a href=\"../../../app/building-your-application/optimizing/scripts\"><code>&lt;Script&gt;</code> Component</a>:</strong> Optimize third-party scripts by using the Script Component, which automatically defers scripts and prevents them from blocking the main thread.</li> <li>\n<strong><a href=\"../../../architecture/accessibility#linting\">ESLint</a>:</strong> Use the built-in <code>eslint-plugin-jsx-a11y</code> plugin to catch accessibility issues early.</li> </ul> <h3 id=\"security\" data-docs-heading=\"\">Security     </h3>  <ul> <li>\n<strong><a href=\"../../../app/building-your-application/configuring/environment-variables\">Environment Variables</a>:</strong> Ensure your <code>.env.*</code> files are added to <code>.gitignore</code> and only public variables are prefixed with <code>NEXT_PUBLIC_</code>.</li> <li>\n<strong><a href=\"../../../app/building-your-application/configuring/content-security-policy\">Content Security Policy</a>:</strong> Consider adding a Content Security Policy to protect your application against various security threats such as cross-site scripting, clickjacking, and other code injection attacks.</li> </ul> <h3 id=\"metadata-and-seo\" data-docs-heading=\"\">Metadata and SEO     </h3>  <ul> <li>\n<strong><a href=\"../../api-reference/components/head\"><code>&lt;Head&gt;</code> Component</a>:</strong> Use the <code>next/head</code> component to add page titles, descriptions, and more.</li> </ul> <h3 id=\"type-safety\" data-docs-heading=\"\">Type safety     </h3> <ul> <li>\n<strong>TypeScript and <a href=\"../../../app/building-your-application/configuring/typescript\">TS Plugin</a>:</strong> Use TypeScript and the TypeScript plugin for better type-safety, and to help you catch errors early.</li> </ul> <h2 id=\"before-going-to-production\" data-docs-heading=\"\">Before going to production     </h2> <p>Before going to production, you can run <code>next build</code> to build your application locally and catch any build errors, then run <code>next start</code> to measure the performance of your application in a production-like environment.</p> <h3 id=\"core-web-vitals\" data-docs-heading=\"\">Core Web Vitals     </h3> <ul> <li>\n<strong><a href=\"https://developers.google.com/web/tools/lighthouse\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Lighthouse</a>:</strong> Run lighthouse in incognito to gain a better understanding of how your users will experience your site, and to identify areas for improvement. This is a simulated test and should be paired with looking at field data (such as Core Web Vitals).</li> </ul>  <h3 id=\"analyzing-bundles\" data-docs-heading=\"\">Analyzing bundles     </h3> <p>Use the <a href=\"../../../app/building-your-application/optimizing/bundle-analyzer\"><code>@next/bundle-analyzer</code> plugin</a> to analyze the size of your JavaScript bundles and identify large modules and dependencies that might be impacting your application's performance.</p> <p>Additionally, the following tools can you understand the impact of adding new dependencies to your application:</p> <ul> <li><a href=\"https://marketplace.visualstudio.com/items?itemName=wix.vscode-import-cost\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Import Cost</a></li> <li><a href=\"https://packagephobia.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Package Phobia</a></li> <li><a href=\"https://bundlephobia.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Bundle Phobia</a></li> <li><a href=\"https://bundlejs.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">bundlejs</a></li> </ul> <h2 id=\"after-deployment\" data-docs-heading=\"\">After deployment     </h2> <p>Depending on where you deploy your application, you might have access to additional tools and integrations to help you monitor and improve your application's performance.</p> <p>For Vercel deployments, we recommend the following:</p> <ul> <li>\n<strong><a href=\"https://vercel.com/analytics?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">Analytics</a>:</strong> A built-in analytics dashboard to help you understand your application's traffic, including the number of unique visitors, page views, and more.</li> <li>\n<strong><a href=\"https://vercel.com/docs/speed-insights?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">Speed Insights</a>:</strong> Real-world performance insights based on visitor data, offering a practical view of how your website is performing in the field.</li> <li>\n<strong><a href=\"https://vercel.com/docs/observability/runtime-logs?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">Logging</a>:</strong> Runtime and Activity logs to help you debug issues and monitor your application in production. Alternatively, see the <a href=\"https://vercel.com/integrations?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">integrations page</a> for a list of third-party tools and services.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <p>To get a comprehensive understanding of the best practices for production deployments on Vercel, including detailed strategies for improving website performance, refer to the <a href=\"https://vercel.com/docs/production-checklist?utm_source=next-site&amp;utm_campaign=nextjs-docs&amp;utm_medium=docs\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Production Checklist</a>.</p> </blockquote> <p>Following these recommendations will help you build a faster, more reliable, and secure application for your users.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/deploying/production-checklist\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/deploying/production-checklist</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/app-router-migration":"<h1 class=\"break-words\">From Pages to App</h1>\n<p>This guide will help you:</p> <ul> <li><a href=\"#nextjs-version\">Update your Next.js application from version 12 to version 13</a></li> <li><a href=\"#upgrading-new-features\">Upgrade features that work in both the <code>pages</code> and the <code>app</code> directories</a></li> <li><a href=\"#migrating-from-pages-to-app\">Incrementally migrate your existing application from <code>pages</code> to <code>app</code></a></li> </ul> <h2 id=\"upgrading\" data-docs-heading=\"\">Upgrading     </h2> <h3 id=\"nodejs-version\" data-docs-heading=\"\">Node.js Version     </h3> <p>The minimum Node.js version is now <strong>v18.17</strong>. See the <a href=\"https://nodejs.org/docs/latest-v18.x/api/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.js documentation</a> for more information.</p> <h3 id=\"nextjs-version\" data-docs-heading=\"\">Next.js Version     </h3> <p>To update to Next.js version 13, run the following command using your preferred package manager:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest react@latest react-dom@latest</pre></div> <h3 id=\"eslint-version\" data-docs-heading=\"\">ESLint Version     </h3> <p>If you're using ESLint, you need to upgrade your ESLint version:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install -D eslint-config-next@latest</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: You may need to restart the ESLint server in VS Code for the ESLint changes to take effect. Open the Command Palette (<code>cmd+shift+p</code> on Mac; <code>ctrl+shift+p</code> on Windows) and search for <code>ESLint: Restart ESLint Server</code>.</p> </blockquote> <h2 id=\"next-steps\" data-docs-heading=\"\">Next Steps     </h2> <p>After you've updated, see the following sections for next steps:</p> <ul> <li>\n<a href=\"#upgrading-new-features\">Upgrade new features</a>: A guide to help you upgrade to new features such as the improved Image and Link Components.</li> <li>\n<a href=\"#migrating-from-pages-to-app\">Migrate from the <code>pages</code> to <code>app</code> directory</a>: A step-by-step guide to help you incrementally migrate from the <code>pages</code> to the <code>app</code> directory.</li> </ul> <h2 id=\"upgrading-new-features\" data-docs-heading=\"\">Upgrading New Features     </h2> <p>Next.js 13 introduced the new <a href=\"../../../app/building-your-application/routing\">App Router</a> with new features and conventions. The new Router is available in the <code>app</code> directory and co-exists with the <code>pages</code> directory.</p> <p>Upgrading to Next.js 13 does <strong>not</strong> require using the new <a href=\"../../../app/building-your-application/routing#the-app-router\">App Router</a>. You can continue using <code>pages</code> with new features that work in both directories, such as the updated <a href=\"#image-component\">Image component</a>, <a href=\"#link-component\">Link component</a>, <a href=\"#script-component\">Script component</a>, and <a href=\"#font-optimization\">Font optimization</a>.</p> <h3 id=\"image-component\" data-docs-heading=\"\">&lt;Image/&gt; Component     </h3> <p>Next.js 12 introduced new improvements to the Image Component with a temporary import: <code>next/future/image</code>. These improvements included less client-side JavaScript, easier ways to extend and style images, better accessibility, and native browser lazy loading.</p> <p>In version 13, this new behavior is now the default for <code>next/image</code>.</p> <p>There are two codemods to help you migrate to the new Image Component:</p> <ul> <li>\n<a href=\"../../../app/building-your-application/upgrading/codemods#next-image-to-legacy-image\"><strong><code>next-image-to-legacy-image</code> codemod</strong></a>: Safely and automatically renames <code>next/image</code> imports to <code>next/legacy/image</code>. Existing components will maintain the same behavior.</li> <li>\n<a href=\"../../../app/building-your-application/upgrading/codemods#next-image-experimental\"><strong><code>next-image-experimental</code> codemod</strong></a>: Dangerously adds inline styles and removes unused props. This will change the behavior of existing components to match the new defaults. To use this codemod, you need to run the <code>next-image-to-legacy-image</code> codemod first.</li> </ul> <h3 id=\"link-component\" data-docs-heading=\"\">&lt;Link&gt; Component     </h3> <p>The <a href=\"../../../app/building-your-application/routing/linking-and-navigating#link-component\"><code>&lt;Link&gt;</code> Component</a> no longer requires manually adding an <code>&lt;a&gt;</code> tag as a child. This behavior was added as an experimental option in <a href=\"https://nextjs.org/blog/next-12-2\" rel=\"noopener noreferrer\" target=\"_blank\">version 12.2</a> and is now the default. In Next.js 13, <code>&lt;Link&gt;</code> always renders <code>&lt;a&gt;</code> and allows you to forward props to the underlying tag.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \n// Next.js 12: `&lt;a&gt;` has to be nested otherwise it's excluded\n&lt;Link href=\"/about\"&gt;\n  &lt;a&gt;About&lt;/a&gt;\n&lt;/Link&gt;\n \n// Next.js 13: `&lt;Link&gt;` always renders `&lt;a&gt;` under the hood\n&lt;Link href=\"/about\"&gt;\n  About\n&lt;/Link&gt;</pre>\n</div> <p>To upgrade your links to Next.js 13, you can use the <a href=\"../../../app/building-your-application/upgrading/codemods#new-link\"><code>new-link</code> codemod</a>.</p> <h3 id=\"script-component\" data-docs-heading=\"\">&lt;Script&gt; Component     </h3> <p>The behavior of <a href=\"../../../app/api-reference/components/script\"><code>next/script</code></a> has been updated to support both <code>pages</code> and <code>app</code>, but some changes need to be made to ensure a smooth migration:</p> <ul> <li>Move any <code>beforeInteractive</code> scripts you previously included in <code>_document.js</code> to the root layout file (<code>app/layout.tsx</code>).</li> <li>The experimental <code>worker</code> strategy does not yet work in <code>app</code> and scripts denoted with this strategy will either have to be removed or modified to use a different strategy (e.g. <code>lazyOnload</code>).</li> <li>\n<code>onLoad</code>, <code>onReady</code>, and <code>onError</code> handlers will not work in Server Components so make sure to move them to a <a href=\"../../../app/building-your-application/rendering/server-components\">Client Component</a> or remove them altogether.</li> </ul> <h3 id=\"font-optimization\" data-docs-heading=\"\">Font Optimization     </h3> <p>Previously, Next.js helped you optimize fonts by <a href=\"../../../app/building-your-application/optimizing/fonts\">inlining font CSS</a>. Version 13 introduces the new <a href=\"../../../app/building-your-application/optimizing/fonts\"><code>next/font</code></a> module which gives you the ability to customize your font loading experience while still ensuring great performance and privacy. <code>next/font</code> is supported in both the <code>pages</code> and <code>app</code> directories.</p> <p>While <a href=\"../../../app/building-your-application/optimizing/fonts\">inlining CSS</a> still works in <code>pages</code>, it does not work in <code>app</code>. You should use <a href=\"../../../app/building-your-application/optimizing/fonts\"><code>next/font</code></a> instead.</p> <p>See the <a href=\"../../../app/building-your-application/optimizing/fonts\">Font Optimization</a> page to learn how to use <code>next/font</code>.</p> <h2 id=\"migrating-from-pages-to-app\" data-docs-heading=\"\">Migrating from pages to app     </h2> <blockquote class=\"p-3 text-sm\"> <p><strong> Watch:</strong> Learn how to incrementally adopt the App Router  <a href=\"https://www.youtube.com/watch?v=YQMSietiFm0\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">YouTube (16 minutes)</a>.</p> </blockquote> <p>Moving to the App Router may be the first time using React features that Next.js builds on top of such as Server Components, Suspense, and more. When combined with new Next.js features such as <a href=\"../../../app/building-your-application/routing#file-conventions\">special files</a> and <a href=\"../../../app/building-your-application/routing/pages-and-layouts#layouts\">layouts</a>, migration means new concepts, mental models, and behavioral changes to learn.</p> <p>We recommend reducing the combined complexity of these updates by breaking down your migration into smaller steps. The <code>app</code> directory is intentionally designed to work simultaneously with the <code>pages</code> directory to allow for incremental page-by-page migration.</p> <ul> <li>The <code>app</code> directory supports nested routes <em>and</em> layouts. <a href=\"../../../app/building-your-application/routing\">Learn more</a>.</li> <li>Use nested folders to <a href=\"../../../app/building-your-application/routing/defining-routes\">define routes</a> and a special <code>page.js</code> file to make a route segment publicly accessible. <a href=\"#step-4-migrating-pages\">Learn more</a>.</li> <li>\n<a href=\"../../../app/building-your-application/routing#file-conventions\">Special file conventions</a> are used to create UI for each route segment. The most common special files are <code>page.js</code> and <code>layout.js</code>. <ul> <li>Use <code>page.js</code> to define UI unique to a route.</li> <li>Use <code>layout.js</code> to define UI that is shared across multiple routes.</li> <li>\n<code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> file extensions can be used for special files.</li> </ul> </li> <li>You can colocate other files inside the <code>app</code> directory such as components, styles, tests, and more. <a href=\"../../../app/building-your-application/routing\">Learn more</a>.</li> <li>Data fetching functions like <code>getServerSideProps</code> and <code>getStaticProps</code> have been replaced with <a href=\"../../../app/building-your-application/data-fetching\">a new API</a> inside <code>app</code>. <code>getStaticPaths</code> has been replaced with <a href=\"../../../app/api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a>.</li> <li>\n<code>pages/_app.js</code> and <code>pages/_document.js</code> have been replaced with a single <code>app/layout.js</code> root layout. <a href=\"../../../app/building-your-application/routing/pages-and-layouts#root-layout-required\">Learn more</a>.</li> <li>\n<code>pages/_error.js</code> has been replaced with more granular <code>error.js</code> special files. <a href=\"../../../app/building-your-application/routing/error-handling\">Learn more</a>.</li> <li>\n<code>pages/404.js</code> has been replaced with the <a href=\"../../../app/api-reference/file-conventions/not-found\"><code>not-found.js</code></a> file.</li> <li>\n<code>pages/api/*</code> API Routes have been replaced with the <a href=\"../../../app/api-reference/file-conventions/route\"><code>route.js</code></a> (Route Handler) special file.</li> </ul> <h3 id=\"step-1-creating-the-app-directory\" data-docs-heading=\"\">Step 1: Creating the app directory     </h3> <p>Update to the latest Next.js version (requires 13.4 or greater):</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest</pre>\n</div> <p>Then, create a new <code>app</code> directory at the root of your project (or <code>src/</code> directory).</p> <h3 id=\"step-2-creating-a-root-layout\" data-docs-heading=\"\">Step 2: Creating a Root Layout     </h3> <p>Create a new <code>app/layout.tsx</code> file inside the <code>app</code> directory. This is a <a href=\"../../../app/building-your-application/routing/pages-and-layouts#root-layout-required\">root layout</a> that will apply to all routes inside <code>app</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  // Layouts must accept a children prop.\n  // This will be populated with nested layouts or pages\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <ul> <li>The <code>app</code> directory <strong>must</strong> include a root layout.</li> <li>The root layout must define <code>&lt;html&gt;</code>, and <code>&lt;body&gt;</code> tags since Next.js does not automatically create them</li> <li>The root layout replaces the <code>pages/_app.tsx</code> and <code>pages/_document.tsx</code> files.</li> <li>\n<code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> extensions can be used for layout files.</li> </ul> <p>To manage <code>&lt;head&gt;</code> HTML elements, you can use the <a href=\"../../../app/building-your-application/optimizing/metadata\">built-in SEO support</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'Home',\n  description: 'Welcome to Next.js',\n}</pre></div>  <h4 id=\"migrating-_documentjs-and-_appjs\" data-docs-heading=\"\">Migrating _document.js and _app.js     </h4> <p>If you have an existing <code>_app</code> or <code>_document</code> file, you can copy the contents (e.g. global styles) to the root layout (<code>app/layout.tsx</code>). Styles in <code>app/layout.tsx</code> will <em>not</em> apply to <code>pages/*</code>. You should keep <code>_app</code>/<code>_document</code> while migrating to prevent your <code>pages/*</code> routes from breaking. Once fully migrated, you can then safely delete them.</p> <p>If you are using any React Context providers, they will need to be moved to a <a href=\"../../../app/building-your-application/rendering/client-components\">Client Component</a>.</p> <h4 id=\"migrating-the-getlayout-pattern-to-layouts-optional\" data-docs-heading=\"\">Migrating the getLayout() pattern to Layouts (Optional)     </h4> <p>Next.js recommended adding a <a href=\"#\">property to Page components</a> to achieve per-page layouts in the <code>pages</code> directory. This pattern can be replaced with native support for <a href=\"../../../app/building-your-application/routing/pages-and-layouts#layouts\">nested layouts</a> in the <code>app</code> directory.</p> <details><summary>See before and after example</summary><p><strong>Before</strong></p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function DashboardLayout({ children }) {\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;My Dashboard&lt;/h2&gt;\n      {children}\n    &lt;/div&gt;\n  )\n}</pre></div>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import DashboardLayout from '../components/DashboardLayout'\n \nexport default function Page() {\n  return &lt;p&gt;My Page&lt;/p&gt;\n}\n \nPage.getLayout = function getLayout(page) {\n  return &lt;DashboardLayout&gt;{page}&lt;/DashboardLayout&gt;\n}</pre></div>\n<p><strong>After</strong></p>\n<ul> <li> <p>Remove the <code>Page.getLayout</code> property from <code>pages/dashboard/index.js</code> and follow the <a href=\"#step-4-migrating-pages\">steps for migrating pages</a> to the <code>app</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Page() {\n  return &lt;p&gt;My Page&lt;/p&gt;\n}</pre></div> </li> <li> <p>Move the contents of <code>DashboardLayout</code> into a new <a href=\"../../../app/building-your-application/rendering/client-components\">Client Component</a> to retain <code>pages</code> directory behavior.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client' // this directive should be at top of the file, before any imports.\n \n// This is a Client Component\nexport default function DashboardLayout({ children }) {\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;My Dashboard&lt;/h2&gt;\n      {children}\n    &lt;/div&gt;\n  )\n}</pre></div> </li> <li> <p>Import the <code>DashboardLayout</code> into a new <code>layout.js</code> file inside the <code>app</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import DashboardLayout from './DashboardLayout'\n \n// This is a Server Component\nexport default function Layout({ children }) {\n  return &lt;DashboardLayout&gt;{children}&lt;/DashboardLayout&gt;\n}</pre></div> </li> <li> <p>You can incrementally move non-interactive parts of <code>DashboardLayout.js</code> (Client Component) into <code>layout.js</code> (Server Component) to reduce the amount of component JavaScript you send to the client.</p> </li> </ul></details> <h3 id=\"step-3-migrating-nexthead\" data-docs-heading=\"\">Step 3: Migrating next/head     </h3> <p>In the <code>pages</code> directory, the <code>next/head</code> React component is used to manage <code>&lt;head&gt;</code> HTML elements such as <code>title</code> and <code>meta</code> . In the <code>app</code> directory, <code>next/head</code> is replaced with the new <a href=\"../../../app/building-your-application/optimizing/metadata\">built-in SEO support</a>.</p> <p><strong>Before:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Head from 'next/head'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Head&gt;\n        &lt;title&gt;My page title&lt;/title&gt;\n      &lt;/Head&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <p><strong>After:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'My Page Title',\n}\n \nexport default function Page() {\n  return '...'\n}</pre></div>  <p><a href=\"../../../app/api-reference/functions/generate-metadata\">See all metadata options</a>.</p> <h3 id=\"step-4-migrating-pages\" data-docs-heading=\"\">Step 4: Migrating Pages     </h3> <ul> <li>Pages in the <a href=\"../../../app/building-your-application/routing\"><code>app</code> directory</a> are <a href=\"../../../app/building-your-application/rendering/server-components\">Server Components</a> by default. This is different from the <code>pages</code> directory where pages are <a href=\"../../../app/building-your-application/rendering/client-components\">Client Components</a>.</li> <li>\n<a href=\"../../../app/building-your-application/data-fetching\">Data fetching</a> has changed in <code>app</code>. <code>getServerSideProps</code>, <code>getStaticProps</code> and <code>getInitialProps</code> have been replaced with a simpler API.</li> <li>The <code>app</code> directory uses nested folders to <a href=\"../../../app/building-your-application/routing/defining-routes\">define routes</a> and a special <code>page.js</code> file to make a route segment publicly accessible.</li> <li> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>\n<code>pages</code> Directory</th>\n<th>\n<code>app</code> Directory</th>\n<th>Route</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>index.js</code></td>\n<td><code>page.js</code></td>\n<td><code>/</code></td>\n</tr>\n<tr>\n<td><code>about.js</code></td>\n<td><code>about/page.js</code></td>\n<td><code>/about</code></td>\n</tr>\n<tr>\n<td><code>blog/[slug].js</code></td>\n<td><code>blog/[slug]/page.js</code></td>\n<td><code>/blog/post-1</code></td>\n</tr>\n</tbody>\n</table></div> </li> </ul> <p>We recommend breaking down the migration of a page into two main steps:</p> <ul> <li>Step 1: Move the default exported Page Component into a new Client Component.</li> <li>Step 2: Import the new Client Component into a new <code>page.js</code> file inside the <code>app</code> directory.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This is the easiest migration path because it has the most comparable behavior to the <code>pages</code> directory.</p> </blockquote> <p><strong>Step 1: Create a new Client Component</strong></p> <ul> <li>Create a new separate file inside the <code>app</code> directory (i.e. <code>app/home-page.tsx</code> or similar) that exports a Client Component. To define Client Components, add the <code>'use client'</code> directive to the top of the file (before any imports). <ul> <li>Similar to the Pages Router, there is an <a href=\"../../../app/building-your-application/rendering/client-components#full-page-load\">optimization step</a> to prerender Client Components to static HTML on the initial page load.</li> </ul> </li> <li>Move the default exported page component from <code>pages/index.js</code> to <code>app/home-page.tsx</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \n// This is a Client Component (same as components in the `pages` directory)\n// It receives data as props, has access to state and effects, and is\n// prerendered on the server during the initial page load.\nexport default function HomePage({ recentPosts }) {\n  return (\n    &lt;div&gt;\n      {recentPosts.map((post) =&gt; (\n        &lt;div key={post.id}&gt;{post.title}&lt;/div&gt;\n      ))}\n    &lt;/div&gt;\n  )\n}</pre></div>  <p><strong>Step 2: Create a new page</strong></p> <ul> <li> <p>Create a new <code>app/page.tsx</code> file inside the <code>app</code> directory. This is a Server Component by default.</p> </li> <li> <p>Import the <code>home-page.tsx</code> Client Component into the page.</p> </li> <li> <p>If you were fetching data in <code>pages/index.js</code>, move the data fetching logic directly into the Server Component using the new <a href=\"../../../app/building-your-application/data-fetching/fetching-caching-and-revalidating\">data fetching APIs</a>. See the <a href=\"#step-6-migrating-data-fetching-methods\">data fetching upgrade guide</a> for more details.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Import your Client Component\nimport HomePage from './home-page'\n \nasync function getPosts() {\n  const res = await fetch('https://...')\n  const posts = await res.json()\n  return posts\n}\n \nexport default async function Page() {\n  // Fetch data directly in a Server Component\n  const recentPosts = await getPosts()\n  // Forward fetched data to your Client Component\n  return &lt;HomePage recentPosts={recentPosts} /&gt;\n}</pre></div>  </li> <li> <p>If your previous page used <code>useRouter</code>, you'll need to update to the new routing hooks. <a href=\"../../../app/api-reference/functions/use-router\">Learn more</a>.</p> </li> <li> <p>Start your development server and visit <a href=\"http://localhost:3000\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>http://localhost:3000</code></a>. You should see your existing index route, now served through the app directory.</p> </li> </ul> <h3 id=\"step-5-migrating-routing-hooks\" data-docs-heading=\"\">Step 5: Migrating Routing Hooks     </h3> <p>A new router has been added to support the new behavior in the <code>app</code> directory.</p> <p>In <code>app</code>, you should use the three new hooks imported from <code>next/navigation</code>: <a href=\"../../../app/api-reference/functions/use-router\"><code>useRouter()</code></a>, <a href=\"../../../app/api-reference/functions/use-pathname\"><code>usePathname()</code></a>, and <a href=\"../../../app/api-reference/functions/use-search-params\"><code>useSearchParams()</code></a>.</p> <ul> <li>The new <code>useRouter</code> hook is imported from <code>next/navigation</code> and has different behavior to the <code>useRouter</code> hook in <code>pages</code> which is imported from <code>next/router</code>. <ul> <li>The <a href=\"../../api-reference/functions/use-router\"><code>useRouter</code> hook imported from <code>next/router</code></a> is not supported in the <code>app</code> directory but can continue to be used in the <code>pages</code> directory.</li> </ul> </li> <li>The new <code>useRouter</code> does not return the <code>pathname</code> string. Use the separate <code>usePathname</code> hook instead.</li> <li>The new <code>useRouter</code> does not return the <code>query</code> object. Use the separate <code>useSearchParams</code> hook instead.</li> <li>You can use <code>useSearchParams</code> and <code>usePathname</code> together to listen to page changes. See the <a href=\"../../../app/api-reference/functions/use-router#router-events\">Router Events</a> section for more details.</li> <li>These new hooks are only supported in Client Components. They cannot be used in Server Components.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport { useRouter, usePathname, useSearchParams } from 'next/navigation'\n \nexport default function ExampleClientComponent() {\n  const router = useRouter()\n  const pathname = usePathname()\n  const searchParams = useSearchParams()\n \n  // ...\n}</pre></div>  <p>In addition, the new <code>useRouter</code> hook has the following changes:</p> <ul> <li>\n<code>isFallback</code> has been removed because <code>fallback</code> has <a href=\"#replacing-fallback\">been replaced</a>.</li> <li>The <code>locale</code>, <code>locales</code>, <code>defaultLocales</code>, <code>domainLocales</code> values have been removed because built-in i18n Next.js features are no longer necessary in the <code>app</code> directory. <a href=\"../../../app/building-your-application/routing/internationalization\">Learn more about i18n</a>.</li> <li>\n<code>basePath</code> has been removed. The alternative will not be part of <code>useRouter</code>. It has not yet been implemented.</li> <li>\n<code>asPath</code> has been removed because the concept of <code>as</code> has been removed from the new router.</li> <li>\n<code>isReady</code> has been removed because it is no longer necessary. During <a href=\"../../../app/building-your-application/rendering/server-components#static-rendering-default\">static rendering</a>, any component that uses the <a href=\"../../../app/api-reference/functions/use-search-params\"><code>useSearchParams()</code></a> hook will skip the prerendering step and instead be rendered on the client at runtime.</li> </ul> <p><a href=\"../../../app/api-reference/functions/use-router\">View the <code>useRouter()</code> API reference</a>.</p> <h3 id=\"step-6-migrating-data-fetching-methods\" data-docs-heading=\"\">Step 6: Migrating Data Fetching Methods     </h3> <p>The <code>pages</code> directory uses <code>getServerSideProps</code> and <code>getStaticProps</code> to fetch data for pages. Inside the <code>app</code> directory, these previous data fetching functions are replaced with a <a href=\"../../../app/building-your-application/data-fetching\">simpler API</a> built on top of <code>fetch()</code> and <code>async</code> React Server Components.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default async function Page() {\n  // This request should be cached until manually invalidated.\n  // Similar to `getStaticProps`.\n  // `force-cache` is the default and can be omitted.\n  const staticData = await fetch(`https://...`, { cache: 'force-cache' })\n \n  // This request should be refetched on every request.\n  // Similar to `getServerSideProps`.\n  const dynamicData = await fetch(`https://...`, { cache: 'no-store' })\n \n  // This request should be cached with a lifetime of 10 seconds.\n  // Similar to `getStaticProps` with the `revalidate` option.\n  const revalidatedData = await fetch(`https://...`, {\n    next: { revalidate: 10 },\n  })\n \n  return &lt;div&gt;...&lt;/div&gt;\n}</pre></div>  <h4 id=\"server-side-rendering-getserversideprops\" data-docs-heading=\"\">Server-side Rendering (getServerSideProps)     </h4> <p>In the <code>pages</code> directory, <code>getServerSideProps</code> is used to fetch data on the server and forward props to the default exported React component in the file. The initial HTML for the page is prerendered from the server, followed by \"hydrating\" the page in the browser (making it interactive).</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getServerSideProps() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n \n  return { props: { projects } }\n}\n \nexport default function Dashboard({ projects }) {\n  return (\n    &lt;ul&gt;\n      {projects.map((project) =&gt; (\n        &lt;li key={project.id}&gt;{project.name}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}</pre></div> <p>In the <code>app</code> directory, we can colocate our data fetching inside our React components using <a href=\"../../../app/building-your-application/rendering/server-components\">Server Components</a>. This allows us to send less JavaScript to the client, while maintaining the rendered HTML from the server.</p> <p>By setting the <code>cache</code> option to <code>no-store</code>, we can indicate that the fetched data should <a href=\"../../../app/building-your-application/data-fetching/fetching-caching-and-revalidating\">never be cached</a>. This is similar to <code>getServerSideProps</code> in the <code>pages</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\n \n// This function can be named anything\nasync function getProjects() {\n  const res = await fetch(`https://...`, { cache: 'no-store' })\n  const projects = await res.json()\n \n  return projects\n}\n \nexport default async function Dashboard() {\n  const projects = await getProjects()\n \n  return (\n    &lt;ul&gt;\n      {projects.map((project) =&gt; (\n        &lt;li key={project.id}&gt;{project.name}&lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}</pre></div>  <h4 id=\"accessing-request-object\" data-docs-heading=\"\">Accessing Request Object     </h4> <p>In the <code>pages</code> directory, you can retrieve request-based data based on the Node.js HTTP API.</p> <p>For example, you can retrieve the <code>req</code> object from <code>getServerSideProps</code> and use it to retrieve the request's cookies and headers.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getServerSideProps({ req, query }) {\n  const authHeader = req.getHeaders()['authorization'];\n  const theme = req.cookies['theme'];\n \n  return { props: { ... }}\n}\n \nexport default function Page(props) {\n  return ...\n}</pre></div> <p>The <code>app</code> directory exposes new read-only functions to retrieve request data:</p> <ul> <li>\n<a href=\"../../../app/api-reference/functions/headers\"><code>headers()</code></a>: Based on the Web Headers API, and can be used inside <a href=\"../../../app/building-your-application/rendering/server-components\">Server Components</a> to retrieve request headers.</li> <li>\n<a href=\"../../../app/api-reference/functions/cookies\"><code>cookies()</code></a>: Based on the Web Cookies API, and can be used inside <a href=\"../../../app/building-your-application/rendering/server-components\">Server Components</a> to retrieve cookies.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\nimport { cookies, headers } from 'next/headers'\n \nasync function getData() {\n  const authHeader = headers().get('authorization')\n \n  return '...'\n}\n \nexport default async function Page() {\n  // You can use `cookies()` or `headers()` inside Server Components\n  // directly or in your data fetching function\n  const theme = cookies().get('theme')\n  const data = await getData()\n  return '...'\n}</pre></div>  <h4 id=\"static-site-generation-getstaticprops\" data-docs-heading=\"\">Static Site Generation (getStaticProps)     </h4> <p>In the <code>pages</code> directory, the <code>getStaticProps</code> function is used to pre-render a page at build time. This function can be used to fetch data from an external API or directly from a database, and pass this data down to the entire page as it's being generated during the build.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getStaticProps() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n \n  return { props: { projects } }\n}\n \nexport default function Index({ projects }) {\n  return projects.map((project) =&gt; &lt;div&gt;{project.name}&lt;/div&gt;)\n}</pre></div> <p>In the <code>app</code> directory, data fetching with <a href=\"../../../app/api-reference/functions/fetch\"><code>fetch()</code></a> will default to <code>cache: 'force-cache'</code>, which will cache the request data until manually invalidated. This is similar to <code>getStaticProps</code> in the <code>pages</code> directory.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\n \n// This function can be named anything\nasync function getProjects() {\n  const res = await fetch(`https://...`)\n  const projects = await res.json()\n \n  return projects\n}\n \nexport default async function Index() {\n  const projects = await getProjects()\n \n  return projects.map((project) =&gt; &lt;div&gt;{project.name}&lt;/div&gt;)\n}</pre></div> <h4 id=\"dynamic-paths-getstaticpaths\" data-docs-heading=\"\">Dynamic paths (getStaticPaths)     </h4> <p>In the <code>pages</code> directory, the <code>getStaticPaths</code> function is used to define the dynamic paths that should be pre-rendered at build time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\nimport PostLayout from '@/components/post-layout'\n \nexport async function getStaticPaths() {\n  return {\n    paths: [{ params: { id: '1' } }, { params: { id: '2' } }],\n  }\n}\n \nexport async function getStaticProps({ params }) {\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n \n  return { props: { post } }\n}\n \nexport default function Post({ post }) {\n  return &lt;PostLayout post={post} /&gt;\n}</pre></div> <p>In the <code>app</code> directory, <code>getStaticPaths</code> is replaced with <a href=\"../../../app/api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a>.</p> <p><a href=\"../../../app/api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a> behaves similarly to <code>getStaticPaths</code>, but has a simplified API for returning route parameters and can be used inside <a href=\"../../../app/building-your-application/routing/pages-and-layouts\">layouts</a>. The return shape of <code>generateStaticParams</code> is an array of segments instead of an array of nested <code>param</code> objects or a string of resolved paths.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\nimport PostLayout from '@/components/post-layout'\n \nexport async function generateStaticParams() {\n  return [{ id: '1' }, { id: '2' }]\n}\n \nasync function getPost(params) {\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n \n  return post\n}\n \nexport default async function Post({ params }) {\n  const post = await getPost(params)\n \n  return &lt;PostLayout post={post} /&gt;\n}</pre></div> <p>Using the name <code>generateStaticParams</code> is more appropriate than <code>getStaticPaths</code> for the new model in the <code>app</code> directory. The <code>get</code> prefix is replaced with a more descriptive <code>generate</code>, which sits better alone now that <code>getStaticProps</code> and <code>getServerSideProps</code> are no longer necessary. The <code>Paths</code> suffix is replaced by <code>Params</code>, which is more appropriate for nested routing with multiple dynamic segments.</p> <hr> <h4 id=\"replacing-fallback\" data-docs-heading=\"\">Replacing fallback     </h4> <p>In the <code>pages</code> directory, the <code>fallback</code> property returned from <code>getStaticPaths</code> is used to define the behavior of a page that isn't pre-rendered at build time. This property can be set to <code>true</code> to show a fallback page while the page is being generated, <code>false</code> to show a 404 page, or <code>blocking</code> to generate the page at request time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getStaticPaths() {\n  return {\n    paths: [],\n    fallback: 'blocking'\n  };\n}\n \nexport async function getStaticProps({ params }) {\n  ...\n}\n \nexport default function Post({ post }) {\n  return ...\n}</pre></div> <p>In the <code>app</code> directory the <a href=\"../../../app/api-reference/file-conventions/route-segment-config#dynamicparams\"><code>config.dynamicParams</code> property</a> controls how params outside of <a href=\"../../../app/api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a> are handled:</p> <ul> <li>\n<strong><code>true</code></strong>: (default) Dynamic segments not included in <code>generateStaticParams</code> are generated on demand.</li> <li>\n<strong><code>false</code></strong>: Dynamic segments not included in <code>generateStaticParams</code> will return a 404.</li> </ul> <p>This replaces the <code>fallback: true | false | 'blocking'</code> option of <code>getStaticPaths</code> in the <code>pages</code> directory. The <code>fallback: 'blocking'</code> option is not included in <code>dynamicParams</code> because the difference between <code>'blocking'</code> and <code>true</code> is negligible with streaming.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\n \nexport const dynamicParams = true;\n \nexport async function generateStaticParams() {\n  return [...]\n}\n \nasync function getPost(params) {\n  ...\n}\n \nexport default async function Post({ params }) {\n  const post = await getPost(params);\n \n  return ...\n}</pre></div> <p>With <a href=\"../../../app/api-reference/file-conventions/route-segment-config#dynamicparams\"><code>dynamicParams</code></a> set to <code>true</code> (the default), when a route segment is requested that hasn't been generated, it will be server-rendered and cached.</p> <h4 id=\"incremental-static-regeneration-getstaticprops-with-revalidate\" data-docs-heading=\"\">Incremental Static Regeneration (getStaticProps with revalidate)     </h4> <p>In the <code>pages</code> directory, the <code>getStaticProps</code> function allows you to add a <code>revalidate</code> field to automatically regenerate a page after a certain amount of time.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `pages` directory\n \nexport async function getStaticProps() {\n  const res = await fetch(`https://.../posts`)\n  const posts = await res.json()\n \n  return {\n    props: { posts },\n    revalidate: 60,\n  }\n}\n \nexport default function Index({ posts }) {\n  return (\n    &lt;Layout&gt;\n      &lt;PostList posts={posts} /&gt;\n    &lt;/Layout&gt;\n  )\n}</pre></div> <p>In the <code>app</code> directory, data fetching with <a href=\"../../../app/api-reference/functions/fetch\"><code>fetch()</code></a> can use <code>revalidate</code>, which will cache the request for the specified amount of seconds.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// `app` directory\n \nasync function getPosts() {\n  const res = await fetch(`https://.../posts`, { next: { revalidate: 60 } })\n  const data = await res.json()\n \n  return data.posts\n}\n \nexport default async function PostList() {\n  const posts = await getPosts()\n \n  return posts.map((post) =&gt; &lt;div&gt;{post.name}&lt;/div&gt;)\n}</pre></div> <h4 id=\"api-routes\" data-docs-heading=\"\">API Routes     </h4> <p>API Routes continue to work in the <code>pages/api</code> directory without any changes. However, they have been replaced by <a href=\"../../../app/building-your-application/routing/route-handlers\">Route Handlers</a> in the <code>app</code> directory.</p> <p>Route Handlers allow you to create custom request handlers for a given route using the Web <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Request</a> and <a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Response</a> APIs.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function GET(request: Request) {}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you previously used API routes to call an external API from the client, you can now use <a href=\"../../../app/building-your-application/rendering/server-components\">Server Components</a> instead to securely fetch data. Learn more about <a href=\"../../../app/building-your-application/data-fetching/fetching-caching-and-revalidating\">data fetching</a>.</p> </blockquote> <h3 id=\"step-7-styling\" data-docs-heading=\"\">Step 7: Styling     </h3> <p>In the <code>pages</code> directory, global stylesheets are restricted to only <code>pages/_app.js</code>. With the <code>app</code> directory, this restriction has been lifted. Global styles can be added to any layout, page, or component.</p> <ul> <li><a href=\"../../../app/building-your-application/styling/css-modules\">CSS Modules</a></li> <li><a href=\"../../../app/building-your-application/styling/tailwind-css\">Tailwind CSS</a></li> <li><a href=\"../../../app/building-your-application/styling/css-modules#global-styles\">Global Styles</a></li> <li><a href=\"../../../app/building-your-application/styling/css-in-js\">CSS-in-JS</a></li> <li><a href=\"../../../app/building-your-application/styling/css-modules#external-stylesheets\">External Stylesheets</a></li> <li><a href=\"../../../app/building-your-application/styling/sass\">Sass</a></li> </ul> <h4 id=\"tailwind-css\" data-docs-heading=\"\">Tailwind CSS     </h4> <p>If you're using Tailwind CSS, you'll need to add the <code>app</code> directory to your <code>tailwind.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  content: [\n    './app/**/*.{js,ts,jsx,tsx,mdx}', // &lt;-- Add this line\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n}</pre></div> <p>You'll also need to import your global styles in your <code>app/layout.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../styles/globals.css'\n \nexport default function RootLayout({ children }) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div> <p>Learn more about <a href=\"../../../app/building-your-application/styling/tailwind-css\">styling with Tailwind CSS</a></p> <h2 id=\"codemods\" data-docs-heading=\"\">Codemods     </h2> <p>Next.js provides Codemod transformations to help upgrade your codebase when a feature is deprecated. See <a href=\"../../../app/building-your-application/upgrading/codemods\">Codemods</a> for more information.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/app-router-migration\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/app-router-migration</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/from-vite":"<h1 class=\"break-words\">Migrating from Vite</h1>\n<p>This guide will help you migrate an existing Vite application to Next.js.</p> <h2 id=\"why-switch\" data-docs-heading=\"\">Why Switch?     </h2> <p>There are several reasons why you might want to switch from Vite to Next.js:</p> <h3 id=\"slow-initial-page-loading-time\" data-docs-heading=\"\">Slow initial page loading time     </h3> <p>If you have built your application with the <a href=\"https://github.com/vitejs/vite-plugin-react/tree/main/packages/plugin-react\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">default Vite plugin for React</a>, your application is a purely client-side application. Client-side only applications, also known as single-page applications (SPAs), often experience slow initial page loading time. This happens due to a couple of reasons:</p> <ol> <li>The browser needs to wait for the React code and your entire application bundle to download and run before your code is able to send requests to load some data.</li> <li>Your application code grows with every new feature and extra dependency you add.</li> </ol> <h3 id=\"no-automatic-code-splitting\" data-docs-heading=\"\">No automatic code splitting     </h3> <p>The previous issue of slow loading times can be somewhat managed with code splitting. However, if you try to do code splitting manually, you'll often make performance worse. It's easy to inadvertently introduce network waterfalls when code-splitting manually. Next.js provides automatic code splitting built into its router.</p> <h3 id=\"network-waterfalls\" data-docs-heading=\"\">Network waterfalls     </h3> <p>A common cause of poor performance occurs when applications make sequential client-server requests to fetch data. One common pattern for data fetching in an SPA is to initially render a placeholder, and then fetch data after the component has mounted. Unfortunately, this means that a child component that fetches data can't start fetching until the parent component has finished loading its own data.</p> <p>While fetching data on the client is supported with Next.js, it also gives you the option to shift data fetching to the server, which can eliminate client-server waterfalls.</p> <h3 id=\"fast-and-intentional-loading-states\" data-docs-heading=\"\">Fast and intentional loading states     </h3> <p>With built-in support for <a href=\"../../../app/building-your-application/routing/loading-ui-and-streaming#streaming-with-suspense\">streaming through React Suspense</a>, you can be more intentional about which parts of your UI you want to load first and in what order without introducing network waterfalls.</p> <p>This enables you to build pages that are faster to load and eliminate <a href=\"https://vercel.com/blog/how-core-web-vitals-affect-seo\" rel=\"noopener noreferrer\" target=\"_blank\">layout shifts</a>.</p> <h3 id=\"choose-the-data-fetching-strategy\" data-docs-heading=\"\">Choose the data fetching strategy     </h3> <p>Depending on your needs, Next.js allows you to choose your data fetching strategy on a page and component basis. You can decide to fetch at build time, at request time on the server, or on the client. For example, you can fetch data from your CMS and render your blog posts at build time, which can then be efficiently cached on a CDN.</p> <h3 id=\"middleware\" data-docs-heading=\"\">Middleware     </h3> <p><a href=\"../../../app/building-your-application/routing/middleware\">Next.js Middleware</a> allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The middleware is also useful for experimentation and <a href=\"../../../app/building-your-application/routing/internationalization\">internationalization</a>.</p> <h3 id=\"built-in-optimizations\" data-docs-heading=\"\">Built-in Optimizations     </h3> <p><a href=\"../../../app/building-your-application/optimizing/images\">Images</a>, <a href=\"../../../app/building-your-application/optimizing/fonts\">fonts</a>, and <a href=\"../../../app/building-your-application/optimizing/scripts\">third-party scripts</a> often have significant impact on an application's performance. Next.js comes with built-in components that automatically optimize those for you.</p> <h2 id=\"migration-steps\" data-docs-heading=\"\">Migration Steps     </h2> <p>Our goal with this migration is to get a working Next.js application as quickly as possible, so that you can then adopt Next.js features incrementally. To begin with, we'll keep it as a purely client-side application (SPA) without migrating your existing router. This helps minimize the chances of encountering issues during the migration process and reduces merge conflicts.</p> <h3 id=\"step-1-install-the-nextjs-dependency\" data-docs-heading=\"\">Step 1: Install the Next.js Dependency     </h3> <p>The first thing you need to do is to install <code>next</code> as a dependency:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest</pre></div> <h3 id=\"step-2-create-the-nextjs-configuration-file\" data-docs-heading=\"\">Step 2: Create the Next.js Configuration File     </h3> <p>Create a <code>next.config.mjs</code> at the root of your project. This file will hold your <a href=\"../../../app/api-reference/next-config-js\">Next.js configuration options</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA).\n  distDir: './dist', // Changes the build output directory to `./dist/`.\n}\n \nexport default nextConfig</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> You can use either <code>.js</code> or <code>.mjs</code> for your Next.js configuration file.</p> </blockquote> <h3 id=\"step-3-update-typescript-configuration\" data-docs-heading=\"\">Step 3: Update TypeScript Configuration     </h3> <p>If you're using TypeScript, you need to update your <code>tsconfig.json</code> file with the following changes to make it compatible with Next.js. If you're not using TypeScript, you can skip this step.</p> <ol> <li>Remove the <a href=\"https://www.typescriptlang.org/tsconfig#references\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">project reference</a> to <code>tsconfig.node.json</code>\n</li> <li>Add <code>./dist/types/**/*.ts</code> and <code>./next-env.d.ts</code> to the <a href=\"https://www.typescriptlang.org/tsconfig#include\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>include</code> array</a>\n</li> <li>Add <code>./node_modules</code> to the <a href=\"https://www.typescriptlang.org/tsconfig#exclude\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>exclude</code> array</a>\n</li> <li>Add <code>{ \"name\": \"next\" }</code> to the <a href=\"https://www.typescriptlang.org/tsconfig#plugins\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>plugins</code> array in <code>compilerOptions</code></a>: <code>\"plugins\": [{ \"name\": \"next\" }]</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#esModuleInterop\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>esModuleInterop</code></a> to <code>true</code>: <code>\"esModuleInterop\": true</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#jsx\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>jsx</code></a> to <code>preserve</code>: <code>\"jsx\": \"preserve\"</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#allowJs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>allowJs</code></a> to <code>true</code>: <code>\"allowJs\": true</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#forceConsistentCasingInFileNames\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>forceConsistentCasingInFileNames</code></a> to <code>true</code>: <code>\"forceConsistentCasingInFileNames\": true</code>\n</li> <li>Set <a href=\"https://www.typescriptlang.org/tsconfig#incremental\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>incremental</code></a> to <code>true</code>: <code>\"incremental\": true</code>\n</li> </ol> <p>Here's an example of a working <code>tsconfig.json</code> with those changes:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"esModuleInterop\": true,\n    \"skipLibCheck\": true,\n    \"moduleResolution\": \"bundler\",\n    \"allowImportingTsExtensions\": true,\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"preserve\",\n    \"strict\": true,\n    \"noUnusedLocals\": true,\n    \"noUnusedParameters\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"allowJs\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"incremental\": true,\n    \"plugins\": [{ \"name\": \"next\" }]\n  },\n  \"include\": [\"./src\", \"./dist/types/**/*.ts\", \"./next-env.d.ts\"],\n  \"exclude\": [\"./node_modules\"]\n}</pre></div> <p>You can find more information about configuring TypeScript on the <a href=\"../../../app/building-your-application/configuring/typescript#typescript-plugin\">Next.js docs</a>.</p> <h3 id=\"step-4-create-the-root-layout\" data-docs-heading=\"\">Step 4: Create the Root Layout     </h3> <p>A Next.js <a href=\"../../../app\">App Router</a> application must include a <a href=\"../../../app/building-your-application/routing/pages-and-layouts#root-layout-required\">root layout</a> file, which is a <a href=\"../../../app/building-your-application/rendering/server-components\">React Server Component</a> that will wrap all pages in your application. This file is defined at the top level of the <code>app</code> directory.</p> <p>The closest equivalent to the root layout file in a Vite application is the <a href=\"https://vitejs.dev/guide/#index-html-and-project-root\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>index.html</code> file</a>, which contains your <code>&lt;html&gt;</code>, <code>&lt;head&gt;</code>, and <code>&lt;body&gt;</code> tags.</p> <p>In this step, you'll convert your <code>index.html</code> file into a root layout file:</p> <ol> <li>Create a new <code>app</code> directory in your <code>src</code> directory.</li> <li>Create a new <code>layout.tsx</code> file inside that <code>app</code> directory:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return null\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> extensions can be used for Layout files.</p> </blockquote> <ol start=\"3\"> <li>Copy the content of your <code>index.html</code> file into the previously created <code>&lt;RootLayout&gt;</code> component while replacing the <code>body.div#root</code> and <code>body.script</code> tags with <code>&lt;div id=\"root\"&gt;{children}&lt;/div&gt;</code>:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;meta charset=\"UTF-8\" /&gt;\n        &lt;link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" /&gt;\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n        &lt;title&gt;My App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"My App is a...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <ol start=\"4\"> <li>Next.js already includes by default the <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/meta#charset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta charset</a> and <a href=\"https://developer.mozilla.org/docs/Web/HTML/Viewport_meta_tag\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta viewport</a> tags, so you can safely remove those from your <code>&lt;head&gt;</code>:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;link rel=\"icon\" type=\"image/svg+xml\" href=\"/icon.svg\" /&gt;\n        &lt;title&gt;My App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"My App is a...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <ol start=\"5\"> <li>Any <a href=\"../../../app/building-your-application/optimizing/metadata#file-based-metadata\">metadata files</a> such as <code>favicon.ico</code>, <code>icon.png</code>, <code>robots.txt</code> are automatically added to the application <code>&lt;head&gt;</code> tag as long as you have them placed into the top level of the <code>app</code> directory. After moving <a href=\"../../../app/building-your-application/optimizing/metadata#file-based-metadata\">all supported files</a> into the <code>app</code> directory you can safely delete their <code>&lt;link&gt;</code> tags:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;title&gt;My App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"My App is a...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <ol start=\"6\"> <li>Finally, Next.js can manage your last <code>&lt;head&gt;</code> tags with the <a href=\"../../../app/building-your-application/optimizing/metadata\">Metadata API</a>. Move your final metadata info into an exported <a href=\"../../../app/api-reference/functions/generate-metadata#metadata-object\"><code>metadata</code> object</a>:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'My App',\n  description: 'My App is a...',\n}\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>With the above changes, you shifted from declaring everything in your <code>index.html</code> to using Next.js' convention-based approach built into the framework (<a href=\"../../../app/building-your-application/optimizing/metadata\">Metadata API</a>). This approach enables you to more easily improve your SEO and web shareability of your pages.</p> <h3 id=\"step-5-create-the-entrypoint-page\" data-docs-heading=\"\">Step 5: Create the Entrypoint Page     </h3> <p>On Next.js you declare an entrypoint for your application by creating a <code>page.tsx</code> file. The closest equivalent of this file on Vite is your <code>main.tsx</code> file. In this step, youll set up the entrypoint of your application.</p> <ol> <li><strong>Create a <code>[[...slug]]</code> directory in your <code>app</code> directory.</strong></li> </ol> <p>Since in this guide we're aiming first to set up our Next.js as an SPA (Single Page Application), you need your page entrypoint to catch all possible routes of your application. For that, create a new <code>[[...slug]]</code> directory in your <code>app</code> directory.</p> <p>This directory is what is called an <a href=\"../../../app/building-your-application/routing/dynamic-routes#optional-catch-all-segments\">optional catch-all route segment</a>. Next.js uses a file-system based router where <a href=\"../../../app/building-your-application/routing/defining-routes#creating-routes\">directories are used to define routes</a>. This special directory will make sure that all routes of your application will be directed to its containing <code>page.tsx</code> file.</p> <ol start=\"2\"> <li><strong>Create a new <code>page.tsx</code> file inside the <code>app/[[...slug]]</code> directory with the following content:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../../index.css'\n \nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n \nexport default function Page() {\n  return '...' // We'll update this\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> extensions can be used for Page files.</p> </blockquote> <p>This file is a <a href=\"../../../app/building-your-application/rendering/server-components\">Server Component</a>. When you run <code>next build</code>, the file is prerendered into a static asset. It does <em>not</em> require any dynamic code.</p> <p>This file imports our global CSS and tells <a href=\"../../../app/api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a> we are only going to generate one route, the index route at <code>/</code>.</p> <p>Now, let's move the rest of our Vite application which will run client-only.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport React from 'react'\nimport dynamic from 'next/dynamic'\n \nconst App = dynamic(() =&gt; import('../../App'), { ssr: false })\n \nexport function ClientOnly() {\n  return &lt;App /&gt;\n}</pre></div>  <p>This file is a <a href=\"../../../app/building-your-application/rendering/client-components\">Client Component</a>, defined by the <code>'use client'</code> directive. Client Components are still <a href=\"../../../app/building-your-application/rendering/client-components#how-are-client-components-rendered\">prerendered to HTML</a> on the server before being sent to the client.</p> <p>Since we want a client-only application to start, we can configure Next.js to disable prerendering from the <code>App</code> component down.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const App = dynamic(() =&gt; import('../../App'), { ssr: false })</pre>\n</div> <p>Now, update your entrypoint page to use the new component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../../index.css'\nimport { ClientOnly } from './client'\n \nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n \nexport default function Page() {\n  return &lt;ClientOnly /&gt;\n}</pre></div>  <h3 id=\"step-6-update-static-image-imports\" data-docs-heading=\"\">Step 6: Update Static Image Imports     </h3> <p>Next.js handles static image imports slightly different from Vite. With Vite, importing an image file will return its public URL as a string:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import image from './img.png' // `image` will be '/assets/img.2d8efhg.png' in production\n \nexport default function App() {\n  return &lt;img src={image} /&gt;\n}</pre></div> <p>With Next.js, static image imports return an object. The object can then be used directly with the Next.js <a href=\"../../../app/api-reference/components/image\"><code>&lt;Image&gt;</code> component</a>, or you can use the object's <code>src</code> property with your existing <code>&lt;img&gt;</code> tag.</p> <p>The <code>&lt;Image&gt;</code> component has the added benefits of <a href=\"../../../app/building-your-application/optimizing/images\">automatic image optimization</a>. The <code>&lt;Image&gt;</code> component automatically sets the <code>width</code> and <code>height</code> attributes of the resulting <code>&lt;img&gt;</code> based on the image's dimensions. This prevents layout shifts when the image loads. However, this can cause issues if your app contains images with only one of their dimensions being styled without the other styled to <code>auto</code>. When not styled to <code>auto</code>, the dimension will default to the <code>&lt;img&gt;</code> dimension attribute's value, which can cause the image to appear distorted.</p> <p>Keeping the <code>&lt;img&gt;</code> tag will reduce the amount of changes in your application and prevent the above issues. You can then optionally later migrate to the <code>&lt;Image&gt;</code> component to take advantage of optimizing images by <a href=\"../../../app/building-your-application/optimizing/images#loaders\">configuring a loader</a>, or moving to the default Next.js server which has automatic image optimization.</p> <ol> <li><strong>Convert absolute import paths for images imported from <code>/public</code> into relative imports:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\nimport logo from '/logo.png'\n \n// After\nimport logo from '../public/logo.png'</pre>\n</div> <ol start=\"2\"> <li><strong>Pass the image <code>src</code> property instead of the whole image object to your <code>&lt;img&gt;</code> tag:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\n&lt;img src={logo} /&gt;\n \n// After\n&lt;img src={logo.src} /&gt;</pre>\n</div> <p>Alternatively, you can reference the public URL for the image asset based on the filename. For example, <code>public/logo.png</code> will serve the image at <code>/logo.png</code> for your application, which would be the <code>src</code> value.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> If you're using TypeScript, you might encounter type errors when accessing the <code>src</code> property. You can safely ignore those for now. They will be fixed by the end of this guide.</p> </blockquote> <h3 id=\"step-7-migrate-the-environment-variables\" data-docs-heading=\"\">Step 7: Migrate the Environment Variables     </h3> <p>Next.js has support for <code>.env</code> <a href=\"../../../app/building-your-application/configuring/environment-variables\">environment variables</a> similar to Vite. The main difference is the prefix used to expose environment variables on the client-side.</p> <ul> <li>Change all environment variables with the <code>VITE_</code> prefix to <code>NEXT_PUBLIC_</code>.</li> </ul> <p>Vite exposes a few built-in environment variables on the special <code>import.meta.env</code> object which arent supported by Next.js. You need to update their usage as follows:</p> <ul> <li>\n<code>import.meta.env.MODE</code>  <code>process.env.NODE_ENV</code>\n</li> <li>\n<code>import.meta.env.PROD</code>  <code>process.env.NODE_ENV === 'production'</code>\n</li> <li>\n<code>import.meta.env.DEV</code>  <code>process.env.NODE_ENV !== 'production'</code>\n</li> <li>\n<code>import.meta.env.SSR</code>  <code>typeof window !== 'undefined'</code>\n</li> </ul> <p>Next.js also doesn't provide a built-in <code>BASE_URL</code> environment variable. However, you can still configure one, if you need it:</p> <ol> <li><strong>Add the following to your <code>.env</code> file:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"># ...\nNEXT_PUBLIC_BASE_PATH=\"/some-base-path\"</pre></div> <ol start=\"2\"> <li><strong>Set <a href=\"../../../app/api-reference/next-config-js/basepath\"><code>basePath</code></a> to <code>process.env.NEXT_PUBLIC_BASE_PATH</code> in your <code>next.config.mjs</code> file:</strong></li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA).\n  distDir: './dist', // Changes the build output directory to `./dist/`.\n  basePath: process.env.NEXT_PUBLIC_BASE_PATH, // Sets the base path to `/some-base-path`.\n}\n \nexport default nextConfig</pre></div> <ol start=\"3\"> <li><strong>Update <code>import.meta.env.BASE_URL</code> usages to <code>process.env.NEXT_PUBLIC_BASE_PATH</code></strong></li> </ol> <h3 id=\"step-8-update-scripts-in-packagejson\" data-docs-heading=\"\">Step 8: Update Scripts in package.json     </h3> <p>You should now be able to run your application to test if you successfully migrated to Next.js. But before that, you need to update your <code>scripts</code> in your <code>package.json</code> with Next.js related commands, and add <code>.next</code> and <code>next-env.d.ts</code> to your <code>.gitignore</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"># ...\n.next\nnext-env.d.ts\ndist</pre></div> <p>Now run <code>npm run dev</code>, and open <a href=\"http://localhost:3000\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>http://localhost:3000</code></a>. You should see your application now running on Next.js.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Example:</strong> Check out <a href=\"https://github.com/inngest/vite-to-nextjs/pull/1\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">this pull request</a> for a working example of a Vite application migrated to Next.js.</p> </blockquote> <h3 id=\"step-9-clean-up\" data-docs-heading=\"\">Step 9: Clean Up     </h3> <p>You can now clean up your codebase from Vite related artifacts:</p> <ul> <li>Delete <code>main.tsx</code>\n</li> <li>Delete <code>index.html</code>\n</li> <li>Delete <code>vite-env.d.ts</code>\n</li> <li>Delete <code>tsconfig.node.json</code>\n</li> <li>Delete <code>vite.config.ts</code>\n</li> <li>Uninstall Vite dependencies</li> </ul> <h2 id=\"next-steps\" data-docs-heading=\"\">Next Steps     </h2> <p>If everything went according to plan, you now have a functioning Next.js application running as a single-page application. However, you aren't yet taking advantage of most of Next.js' benefits, but you can now start making incremental changes to reap all the benefits. Here's what you might want to do next:</p> <ul> <li>Migrate from React Router to the <a href=\"../../../app/building-your-application/routing\">Next.js App Router</a> to get: <ul> <li>Automatic code splitting</li> <li><a href=\"../../../app/building-your-application/routing/loading-ui-and-streaming\">Streaming Server-Rendering</a></li> <li><a href=\"../../../app/building-your-application/rendering/server-components\">React Server Components</a></li> </ul> </li> <li><a href=\"../../../app/building-your-application/optimizing/images\">Optimize images with the <code>&lt;Image&gt;</code> component</a></li> <li><a href=\"../../../app/building-your-application/optimizing/fonts\">Optimize fonts with <code>next/font</code></a></li> <li><a href=\"../../../app/building-your-application/optimizing/scripts\">Optimize third-party scripts with the <code>&lt;Script&gt;</code> component</a></li> <li><a href=\"../../../app/building-your-application/configuring/eslint\">Update your ESLint configuration to support Next.js rules</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/from-vite\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/from-vite</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/version-14":"<h1 class=\"break-words\">Version 14</h1> <h2 id=\"upgrading-from-13-to-14\" data-docs-heading=\"\">Upgrading from 13 to 14     </h2> <p>To update to Next.js version 14, run the following command using your preferred package manager:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i next@latest react@latest react-dom@latest eslint-config-next@latest</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add next@latest react@latest react-dom@latest eslint-config-next@latest</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm up next react react-dom eslint-config-next --latest</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add next@latest react@latest react-dom@latest eslint-config-next@latest</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> If you are using TypeScript, ensure you also upgrade <code>@types/react</code> and <code>@types/react-dom</code> to their latest versions.</p> </blockquote> <h3 id=\"v14-summary\" data-docs-heading=\"\">v14 Summary     </h3> <ul> <li>The minimum Node.js version has been bumped from 16.14 to 18.17, since 16.x has reached end-of-life.</li> <li>The <code>next export</code> command has been removed in favor of <code>output: 'export'</code> config. Please see the <a href=\"../../../app/building-your-application/deploying/static-exports\" rel=\"noopener noreferrer\" target=\"_blank\">docs</a> for more information.</li> <li>The <code>next/server</code> import for <code>ImageResponse</code> was renamed to <code>next/og</code>. A <a href=\"../../../app/building-your-application/upgrading/codemods#next-og-import\">codemod is available</a> to safely and automatically rename your imports.</li> <li>The <code>@next/font</code> package has been fully removed in favor of the built-in <code>next/font</code>. A <a href=\"../../../app/building-your-application/upgrading/codemods#built-in-next-font\">codemod is available</a> to safely and automatically rename your imports.</li> <li>The WASM target for <code>next-swc</code> has been removed.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/version-14\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/version-14</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/version-10":"<h1 class=\"break-words\">Version 10</h1>\n<p>There were no breaking changes between versions 9 and 10.</p> <p>To upgrade to version 10, run the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i next@10</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add next@10</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm up next@10</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add next@10</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> If you are using TypeScript, ensure you also upgrade <code>@types/react</code> and <code>@types/react-dom</code> to their corresponding versions.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/version-10\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/version-10</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/version-9":"<h1 class=\"break-words\">Upgrading to Version 9</h1>\n<p>To upgrade to version 9, run the following command:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i next@9</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add next@9</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm up next@9</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add next@9</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> If you are using TypeScript, ensure you also upgrade <code>@types/react</code> and <code>@types/react-dom</code> to their corresponding versions.</p> </blockquote> <h2 id=\"production-deployment-on-vercel\" data-docs-heading=\"\">Production Deployment on Vercel     </h2> <p>If you previously configured <code>routes</code> in your <code>vercel.json</code> file for dynamic routes, these rules can be removed when leveraging Next.js 9's new <a href=\"../routing/dynamic-routes\">Dynamic Routing feature</a>.</p> <p>Next.js 9's dynamic routes are <strong>automatically configured on <a href=\"https://vercel.com/\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a></strong> and do not require any <code>vercel.json</code> customization.</p> <p>You can read more about <a href=\"../routing/dynamic-routes\">Dynamic Routing here</a>.</p> <h2 id=\"check-your-custom-app-file-pages_appjs\" data-docs-heading=\"\">Check your Custom App File (pages/_app.js)     </h2> <p>If you previously copied the <a href=\"../routing/custom-app\">Custom <code>&lt;App&gt;</code></a> example, you may be able to remove your <code>getInitialProps</code>.</p> <p>Removing <code>getInitialProps</code> from <code>pages/_app.js</code> (when possible) is important to leverage new Next.js features!</p> <p>The following <code>getInitialProps</code> does nothing and may be removed:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">class MyApp extends App {\n  // Remove me, I do nothing!\n  static async getInitialProps({ Component, ctx }) {\n    let pageProps = {}\n \n    if (Component.getInitialProps) {\n      pageProps = await Component.getInitialProps(ctx)\n    }\n \n    return { pageProps }\n  }\n \n  render() {\n    // ... etc\n  }\n}</pre>\n</div> <h2 id=\"breaking-changes\" data-docs-heading=\"\">Breaking Changes     </h2> <h3 id=\"zeitnext-typescript-is-no-longer-necessary\" data-docs-heading=\"\">@zeit/next-typescript is no longer necessary     </h3> <p>Next.js will now ignore usage <code>@zeit/next-typescript</code> and warn you to remove it. Please remove this plugin from your <code>next.config.js</code>.</p> <p>Remove references to <code>@zeit/next-typescript/babel</code> from your custom <code>.babelrc</code> (if present).</p> <p>The usage of <a href=\"https://github.com/Realytics/fork-ts-checker-webpack-plugin/issues\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>fork-ts-checker-webpack-plugin</code></a> should also be removed from your <code>next.config.js</code>.</p> <p>TypeScript Definitions are published with the <code>next</code> package, so you need to uninstall <code>@types/next</code> as they would conflict.</p> <p>The following types are different:</p> <blockquote class=\"p-3 text-sm\"> <p>This list was created by the community to help you upgrade, if you find other differences please send a pull-request to this list to help other users.</p> </blockquote> <p>From:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextContext } from 'next'\nimport { NextAppContext, DefaultAppIProps } from 'next/app'\nimport { NextDocumentContext, DefaultDocumentIProps } from 'next/document'</pre>\n</div> <p>to</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextPageContext } from 'next'\nimport { AppContext, AppInitialProps } from 'next/app'\nimport { DocumentContext, DocumentInitialProps } from 'next/document'</pre>\n</div> <h3 id=\"the-config-key-is-now-an-export-on-a-page\" data-docs-heading=\"\">The config key is now an export on a page     </h3> <p>You may no longer export a custom variable named <code>config</code> from a page (i.e. <code>export { config }</code> / <code>export const config ...</code>). This exported variable is now used to specify page-level Next.js configuration like Opt-in AMP and API Route features.</p> <p>You must rename a non-Next.js-purposed <code>config</code> export to something different.</p> <h3 id=\"nextdynamic-no-longer-renders-loading-by-default-while-loading\" data-docs-heading=\"\">next/dynamic no longer renders \"loading...\" by default while loading     </h3> <p>Dynamic components will not render anything by default while loading. You can still customize this behavior by setting the <code>loading</code> property:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst DynamicComponentWithCustomLoading = dynamic(\n  () =&gt; import('../components/hello2'),\n  {\n    loading: () =&gt; &lt;p&gt;Loading&lt;/p&gt;,\n  }\n)</pre>\n</div> <h3 id=\"withamp-has-been-removed-in-favor-of-an-exported-configuration-object\" data-docs-heading=\"\">withAmp has been removed in favor of an exported configuration object     </h3> <p>Next.js now has the concept of page-level configuration, so the <code>withAmp</code> higher-order component has been removed for consistency.</p> <p>This change can be <strong>automatically migrated by running the following commands in the root of your Next.js project:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">curl -L https://github.com/vercel/next-codemod/archive/master.tar.gz | tar -xz --strip=2 next-codemod-master/transforms/withamp-to-config.js npx jscodeshift -t ./withamp-to-config.js pages/**/*.js</pre></div> <p>To perform this migration by hand, or view what the codemod will produce, see below:</p> <p><strong>Before</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { withAmp } from 'next/amp'\n \nfunction Home() {\n  return &lt;h1&gt;My AMP Page&lt;/h1&gt;\n}\n \nexport default withAmp(Home)\n// or\nexport default withAmp(Home, { hybrid: true })</pre>\n</div> <p><strong>After</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function Home() {\n  return &lt;h1&gt;My AMP Page&lt;/h1&gt;\n}\n \nexport const config = {\n  amp: true,\n  // or\n  amp: 'hybrid',\n}</pre>\n</div> <h3 id=\"next-export-no-longer-exports-pages-as-indexhtml\" data-docs-heading=\"\">next export no longer exports pages as index.html     </h3> <p>Previously, exporting <code>pages/about.js</code> would result in <code>out/about/index.html</code>. This behavior has been changed to result in <code>out/about.html</code>.</p> <p>You can revert to the previous behavior by creating a <code>next.config.js</code> with the following content:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  trailingSlash: true,\n}</pre></div> <h3 id=\"pagesapi-is-treated-differently\" data-docs-heading=\"\">pages/api/ is treated differently     </h3> <p>Pages in <code>pages/api/</code> are now considered <a href=\"https://nextjs.org/blog/next-9#api-routes\" rel=\"noopener noreferrer\" target=\"_blank\">API Routes</a>. Pages in this directory will no longer contain a client-side bundle.</p> <h2 id=\"deprecated-features\" data-docs-heading=\"\">Deprecated Features     </h2> <h3 id=\"nextdynamic-has-deprecated-loading-multiple-modules-at-once\" data-docs-heading=\"\">next/dynamic has deprecated loading multiple modules at once     </h3> <p>The ability to load multiple modules at once has been deprecated in <code>next/dynamic</code> to be closer to React's implementation (<code>React.lazy</code> and <code>Suspense</code>).</p> <p>Updating code that relies on this behavior is relatively straightforward! We've provided an example of a before/after to help you migrate your application:</p> <p><strong>Before</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst HelloBundle = dynamic({\n  modules: () =&gt; {\n    const components = {\n      Hello1: () =&gt; import('../components/hello1').then((m) =&gt; m.default),\n      Hello2: () =&gt; import('../components/hello2').then((m) =&gt; m.default),\n    }\n \n    return components\n  },\n  render: (props, { Hello1, Hello2 }) =&gt; (\n    &lt;div&gt;\n      &lt;h1&gt;{props.title}&lt;/h1&gt;\n      &lt;Hello1 /&gt;\n      &lt;Hello2 /&gt;\n    &lt;/div&gt;\n  ),\n})\n \nfunction DynamicBundle() {\n  return &lt;HelloBundle title=\"Dynamic Bundle\" /&gt;\n}\n \nexport default DynamicBundle</pre>\n</div> <p><strong>After</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst Hello1 = dynamic(() =&gt; import('../components/hello1'))\nconst Hello2 = dynamic(() =&gt; import('../components/hello2'))\n \nfunction HelloBundle({ title }) {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;{title}&lt;/h1&gt;\n      &lt;Hello1 /&gt;\n      &lt;Hello2 /&gt;\n    &lt;/div&gt;\n  )\n}\n \nfunction DynamicBundle() {\n  return &lt;HelloBundle title=\"Dynamic Bundle\" /&gt;\n}\n \nexport default DynamicBundle</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/version-9\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/version-9</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/from-create-react-app":"<h1 class=\"break-words\">Migrating from Create React App</h1>\n<p>This guide will help you migrate an existing Create React App site to Next.js.</p> <h2 id=\"why-switch\" data-docs-heading=\"\">Why Switch?     </h2> <p>There are several reasons why you might want to switch from Create React App to Next.js:</p> <h3 id=\"slow-initial-page-loading-time\" data-docs-heading=\"\">Slow initial page loading time     </h3> <p>Create React App uses purely client-side React. Client-side only applications, also known as single-page applications (SPAs), often experience slow initial page loading time. This happens due to a couple of reasons:</p> <ol> <li>The browser needs to wait for the React code and your entire application bundle to download and run before your code is able to send requests to load data.</li> <li>Your application code grows with every new feature and dependency you add.</li> </ol> <h3 id=\"no-automatic-code-splitting\" data-docs-heading=\"\">No automatic code splitting     </h3> <p>The previous issue of slow loading times can be somewhat managed with code splitting. However, if you try to do code splitting manually, you'll often make performance worse. It's easy to inadvertently introduce network waterfalls when code-splitting manually. Next.js provides automatic code splitting built into its router.</p> <h3 id=\"network-waterfalls\" data-docs-heading=\"\">Network waterfalls     </h3> <p>A common cause of poor performance occurs when applications make sequential client-server requests to fetch data. One common pattern for data fetching in an SPA is to initially render a placeholder, and then fetch data after the component has mounted. Unfortunately, this means that a child component that fetches data can't start fetching until the parent component has finished loading its own data.</p> <p>While fetching data on the client is supported with Next.js, it also gives you the option to shift data fetching to the server, which can eliminate client-server waterfalls.</p> <h3 id=\"fast-and-intentional-loading-states\" data-docs-heading=\"\">Fast and intentional loading states     </h3> <p>With built-in support for <a href=\"../../../app/building-your-application/routing/loading-ui-and-streaming#streaming-with-suspense\">streaming through React Suspense</a>, you can be more intentional about which parts of your UI you want to load first and in what order without introducing network waterfalls.</p> <p>This enables you to build pages that are faster to load and eliminate <a href=\"https://vercel.com/blog/how-core-web-vitals-affect-seo\" rel=\"noopener noreferrer\" target=\"_blank\">layout shifts</a>.</p> <h3 id=\"choose-the-data-fetching-strategy\" data-docs-heading=\"\">Choose the data fetching strategy     </h3> <p>Depending on your needs, Next.js allows you to choose your data fetching strategy on a page and component basis. You can decide to fetch at build time, at request time on the server, or on the client. For example, you can fetch data from your CMS and render your blog posts at build time, which can then be efficiently cached on a CDN.</p> <h3 id=\"middleware\" data-docs-heading=\"\">Middleware     </h3> <p><a href=\"../../../app/building-your-application/routing/middleware\">Next.js Middleware</a> allows you to run code on the server before a request is completed. This is especially useful to avoid having a flash of unauthenticated content when the user visits an authenticated-only page by redirecting the user to a login page. The middleware is also useful for experimentation and <a href=\"../../../app/building-your-application/routing/internationalization\">internationalization</a>.</p> <h3 id=\"built-in-optimizations\" data-docs-heading=\"\">Built-in Optimizations     </h3> <p><a href=\"../../../app/building-your-application/optimizing/images\">Images</a>, <a href=\"../../../app/building-your-application/optimizing/fonts\">fonts</a>, and <a href=\"../../../app/building-your-application/optimizing/scripts\">third-party scripts</a> often have significant impact on an application's performance. Next.js comes with built-in components that automatically optimize those for you.</p> <h2 id=\"migration-steps\" data-docs-heading=\"\">Migration Steps     </h2> <p>Our goal with this migration is to get a working Next.js application as quickly as possible, so that you can then adopt Next.js features incrementally. To begin with, we'll keep it as a purely client-side application (SPA) without migrating your existing router. This helps minimize the chances of encountering issues during the migration process and reduces merge conflicts.</p> <h3 id=\"step-1-install-the-nextjs-dependency\" data-docs-heading=\"\">Step 1: Install the Next.js Dependency     </h3> <p>The first thing you need to do is to install <code>next</code> as a dependency:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install next@latest</pre></div> <h3 id=\"step-2-create-the-nextjs-configuration-file\" data-docs-heading=\"\">Step 2: Create the Next.js Configuration File     </h3> <p>Create a <code>next.config.mjs</code> at the root of your project. This file will hold your <a href=\"../../../app/api-reference/next-config-js\">Next.js configuration options</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export', // Outputs a Single-Page Application (SPA).\n  distDir: './dist', // Changes the build output directory to `./dist/`.\n}\n \nexport default nextConfig</pre></div> <h3 id=\"step-3-update-typescript-configuration\" data-docs-heading=\"\">Step 3: Update TypeScript Configuration     </h3> <p>If you're using TypeScript, you need to update your <code>tsconfig.json</code> file with the following changes to make it compatible with Next.js:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"target\": \"es5\",\n    \"lib\": [\"dom\", \"dom.iterable\", \"esnext\"],\n    \"allowJs\": true,\n    \"skipLibCheck\": true,\n    \"strict\": false,\n    \"forceConsistentCasingInFileNames\": true,\n    \"noEmit\": true,\n    \"esModuleInterop\": true,\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"node\",\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"jsx\": \"preserve\",\n    \"baseUrl\": \".\",\n    \"incremental\": true,\n    \"plugins\": [\n      {\n        \"name\": \"next\"\n      }\n    ],\n    \"strictNullChecks\": true\n  },\n  \"include\": [\n    \"next-env.d.ts\",\n    \"**/*.ts\",\n    \"**/*.tsx\",\n    \".next/types/**/*.ts\",\n    \"./dist/types/**/*.ts\"\n  ],\n  \"exclude\": [\"node_modules\"]\n}</pre></div> <p>You can find more information about configuring TypeScript on the <a href=\"../../../app/building-your-application/configuring/typescript#typescript-plugin\">Next.js docs</a>.</p> <h3 id=\"step-4-create-the-root-layout\" data-docs-heading=\"\">Step 4: Create the Root Layout     </h3> <p>A Next.js <a href=\"../../../app\">App Router</a> application must include a <a href=\"../../../app/building-your-application/routing/pages-and-layouts#root-layout-required\">root layout</a> file, which is a <a href=\"../../../app/building-your-application/rendering/server-components\">React Server Component</a> that will wrap all pages in your application. This file is defined at the top level of the <code>app</code> directory.</p> <p>The closest equivalent to the root layout file in a CRA application is the <code>index.html</code> file, which contains your <code>&lt;html&gt;</code>, <code>&lt;head&gt;</code>, and <code>&lt;body&gt;</code> tags.</p> <p>In this step, you'll convert your <code>index.html</code> file into a root layout file:</p> <ol> <li>Create a new <code>app</code> directory in your <code>src</code> directory.</li> <li>Create a new <code>layout.tsx</code> file inside that <code>app</code> directory:</li> </ol> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return null\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>.js</code>, <code>.jsx</code>, or <code>.tsx</code> extensions can be used for Layout files.</p> </blockquote> <p>Copy the content of your <code>index.html</code> file into the previously created <code>&lt;RootLayout&gt;</code> component while replacing the <code>body.div#root</code> and <code>body.script</code> tags with <code>&lt;div id=\"root\"&gt;{children}&lt;/div&gt;</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;meta charset=\"UTF-8\" /&gt;\n        &lt;link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" /&gt;\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /&gt;\n        &lt;title&gt;React App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"Web site created...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: We'll ignore the <a href=\"../../../app/api-reference/file-conventions/metadata\">manifest file</a>, additional iconography other than the favicon, and <a href=\"../../../app/building-your-application/testing\">testing configuration</a>, but if these are requirements, Next.js also supports these options.</p> </blockquote> <h3 id=\"step-5-metadata\" data-docs-heading=\"\">Step 5: Metadata     </h3> <p>Next.js already includes by default the <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/meta#charset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta charset</a> and <a href=\"https://developer.mozilla.org/docs/Web/HTML/Viewport_meta_tag\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">meta viewport</a> tags, so you can safely remove those from your <code>&lt;head&gt;</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" /&gt;\n        &lt;title&gt;React App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"Web site created...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>Any <a href=\"../../../app/building-your-application/optimizing/metadata#file-based-metadata\">metadata files</a> such as <code>favicon.ico</code>, <code>icon.png</code>, <code>robots.txt</code> are automatically added to the application <code>&lt;head&gt;</code> tag as long as you have them placed into the top level of the <code>app</code> directory. After moving <a href=\"../../../app/building-your-application/optimizing/metadata#file-based-metadata\">all supported files</a> into the <code>app</code> directory you can safely delete their <code>&lt;link&gt;</code> tags:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;head&gt;\n        &lt;title&gt;React App&lt;/title&gt;\n        &lt;meta name=\"description\" content=\"Web site created...\" /&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>Finally, Next.js can manage your last <code>&lt;head&gt;</code> tags with the <a href=\"../../../app/building-your-application/optimizing/metadata\">Metadata API</a>. Move your final metadata info into an exported <a href=\"../../../app/api-reference/functions/generate-metadata#metadata-object\"><code>metadata</code> object</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { Metadata } from 'next'\n \nexport const metadata: Metadata = {\n  title: 'React App',\n  description: 'Web site created with Next.js.',\n}\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;\n        &lt;div id=\"root\"&gt;{children}&lt;/div&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>With the above changes, you shifted from declaring everything in your <code>index.html</code> to using Next.js' convention-based approach built into the framework (<a href=\"../../../app/building-your-application/optimizing/metadata\">Metadata API</a>). This approach enables you to more easily improve your SEO and web shareability of your pages.</p> <h3 id=\"step-6-styles\" data-docs-heading=\"\">Step 6: Styles     </h3> <p>Like Create React App, Next.js has built-in support for <a href=\"../../../app/building-your-application/styling/css-modules\">CSS Modules</a>.</p> <p>If you're using a global CSS file, import it into your <code>app/layout.tsx</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../index.css'\n \n// ...</pre></div> <p>If you're using Tailwind, you'll need to install <code>postcss</code> and <code>autoprefixer</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm install postcss autoprefixer</pre></div> <p>Then, create a <code>postcss.config.js</code> file at the root of your project:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}</pre></div> <h3 id=\"step-7-create-the-entrypoint-page\" data-docs-heading=\"\">Step 7: Create the Entrypoint Page     </h3> <p>On Next.js you declare an entrypoint for your application by creating a <code>page.tsx</code> file. The closest equivalent of this file on CRA is your <code>src/index.tsx</code> file. In this step, youll set up the entry point of your application.</p> <p><strong>Create a <code>[[...slug]]</code> directory in your <code>app</code> directory.</strong></p> <p>Since this guide is aiming to first set up our Next.js as an SPA (Single Page Application), you need your page entry point to catch all possible routes of your application. For that, create a new <code>[[...slug]]</code> directory in your <code>app</code> directory.</p> <p>This directory is what is called an <a href=\"../../../app/building-your-application/routing/dynamic-routes#optional-catch-all-segments\">optional catch-all route segment</a>. Next.js uses a file-system based router where <a href=\"../../../app/building-your-application/routing/defining-routes#creating-routes\">directories are used to define routes</a>. This special directory will make sure that all routes of your application will be directed to its containing <code>page.tsx</code> file.</p> <p><strong>Create a new <code>page.tsx</code> file inside the <code>app/[[...slug]]</code> directory with the following content:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../../index.css'\n \nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n \nexport default function Page() {\n  return '...' // We'll update this\n}</pre></div>  <p>This file is a <a href=\"../../../app/building-your-application/rendering/server-components\">Server Component</a>. When you run <code>next build</code>, the file is prerendered into a static asset. It does <em>not</em> require any dynamic code.</p> <p>This file imports our global CSS and tells <a href=\"../../../app/api-reference/functions/generate-static-params\"><code>generateStaticParams</code></a> we are only going to generate one route, the index route at <code>/</code>.</p> <p>Now, let's move the rest of our CRA application which will run client-only.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport React from 'react'\nimport dynamic from 'next/dynamic'\n \nconst App = dynamic(() =&gt; import('../../App'), { ssr: false })\n \nexport function ClientOnly() {\n  return &lt;App /&gt;\n}</pre></div>  <p>This file is a <a href=\"../../../app/building-your-application/rendering/client-components\">Client Component</a>, defined by the <code>'use client'</code> directive. Client Components are still <a href=\"../../../app/building-your-application/rendering/client-components#how-are-client-components-rendered\">prerendered to HTML</a> on the server before being sent to the client.</p> <p>Since we want a client-only application to start, we can configure Next.js to disable prerendering from the <code>App</code> component down.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const App = dynamic(() =&gt; import('../../App'), { ssr: false })</pre>\n</div> <p>Now, update your entrypoint page to use the new component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../../index.css'\nimport { ClientOnly } from './client'\n \nexport function generateStaticParams() {\n  return [{ slug: [''] }]\n}\n \nexport default function Page() {\n  return &lt;ClientOnly /&gt;\n}</pre></div>  <h3 id=\"step-8-update-static-image-imports\" data-docs-heading=\"\">Step 8: Update Static Image Imports     </h3> <p>Next.js handles static image imports slightly different from CRA. With CRA, importing an image file will return its public URL as a string:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import image from './img.png'\n \nexport default function App() {\n  return &lt;img src={image} /&gt;\n}</pre></div> <p>With Next.js, static image imports return an object. The object can then be used directly with the Next.js <a href=\"../../../app/api-reference/components/image\"><code>&lt;Image&gt;</code> component</a>, or you can use the object's <code>src</code> property with your existing <code>&lt;img&gt;</code> tag.</p> <p>The <code>&lt;Image&gt;</code> component has the added benefits of <a href=\"../../../app/building-your-application/optimizing/images\">automatic image optimization</a>. The <code>&lt;Image&gt;</code> component automatically sets the <code>width</code> and <code>height</code> attributes of the resulting <code>&lt;img&gt;</code> based on the image's dimensions. This prevents layout shifts when the image loads. However, this can cause issues if your app contains images with only one of their dimensions being styled without the other styled to <code>auto</code>. When not styled to <code>auto</code>, the dimension will default to the <code>&lt;img&gt;</code> dimension attribute's value, which can cause the image to appear distorted.</p> <p>Keeping the <code>&lt;img&gt;</code> tag will reduce the amount of changes in your application and prevent the above issues. You can then optionally later migrate to the <code>&lt;Image&gt;</code> component to take advantage of optimizing images by <a href=\"../../../app/building-your-application/optimizing/images#loaders\">configuring a loader</a>, or moving to the default Next.js server which has automatic image optimization.</p> <p><strong>Convert absolute import paths for images imported from <code>/public</code> into relative imports:</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\nimport logo from '/logo.png'\n \n// After\nimport logo from '../public/logo.png'</pre>\n</div> <p><strong>Pass the image <code>src</code> property instead of the whole image object to your <code>&lt;img&gt;</code> tag:</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Before\n&lt;img src={logo} /&gt;\n \n// After\n&lt;img src={logo.src} /&gt;</pre>\n</div> <p>Alternatively, you can reference the public URL for the image asset based on the filename. For example, <code>public/logo.png</code> will serve the image at <code>/logo.png</code> for your application, which would be the <code>src</code> value.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> If you're using TypeScript, you might encounter type errors when accessing the <code>src</code> property. You can safely ignore those for now. They will be fixed by the end of this guide.</p> </blockquote> <h3 id=\"step-9-migrate-the-environment-variables\" data-docs-heading=\"\">Step 9: Migrate the Environment Variables     </h3> <p>Next.js has support for <code>.env</code> <a href=\"../../../app/building-your-application/configuring/environment-variables\">environment variables</a> similar to CRA.</p> <p>The main difference is the prefix used to expose environment variables on the client-side. Change all environment variables with the <code>REACT_APP_</code> prefix to <code>NEXT_PUBLIC_</code>.</p> <h3 id=\"step-10-update-scripts-in-packagejson\" data-docs-heading=\"\">Step 10: Update Scripts in package.json     </h3> <p>You should now be able to run your application to test if you successfully migrated to Next.js. But before that, you need to update your <code>scripts</code> in your <code>package.json</code> with Next.js related commands, and add <code>.next</code>, <code>next-env.d.ts</code>, and <code>dist</code> to your <code>.gitignore</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\"\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"># ...\n.next\nnext-env.d.ts\ndist</pre></div> <p>Now run <code>npm run dev</code>, and open <a href=\"http://localhost:3000\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>http://localhost:3000</code></a>. You should see your application now running on Next.js.</p> <h3 id=\"step-11-clean-up\" data-docs-heading=\"\">Step 11: Clean Up     </h3> <p>You can now clean up your codebase from Create React App related artifacts:</p> <ul> <li>Delete <code>src/index.tsx</code>\n</li> <li>Delete <code>public/index.html</code>\n</li> <li>Delete <code>reportWebVitals</code> setup</li> <li>Uninstall CRA dependencies (<code>react-scripts</code>)</li> </ul> <h2 id=\"bundler-compatibility\" data-docs-heading=\"\">Bundler Compatibility     </h2> <p>Create React App and Next.js both default to using webpack for bundling.</p> <p>When migrating your CRA application to Next.js, you might have a custom webpack configuration you're looking to migrate. Next.js supports providing a <a href=\"../../../app/api-reference/next-config-js/webpack\">custom webpack configuration</a>.</p> <p>Further, Next.js has support for <a href=\"../../../app/api-reference/next-config-js/turbo\">Turbopack</a> through <code>next dev --turbo</code> to improve your local dev performance. Turbopack supports some <a href=\"../../../app/api-reference/next-config-js/turbo\">webpack loaders</a> as well for compatibility and incremental adoption.</p> <h2 id=\"next-steps\" data-docs-heading=\"\">Next Steps     </h2> <p>If everything went according to plan, you now have a functioning Next.js application running as a single-page application. However, you aren't yet taking advantage of most of Next.js' benefits, but you can now start making incremental changes to reap all the benefits. Here's what you might want to do next:</p> <ul> <li>Migrate from React Router to the <a href=\"../../../app/building-your-application/routing\">Next.js App Router</a> to get: <ul> <li>Automatic code splitting</li> <li><a href=\"../../../app/building-your-application/routing/loading-ui-and-streaming\">Streaming Server-Rendering</a></li> <li><a href=\"../../../app/building-your-application/rendering/server-components\">React Server Components</a></li> </ul> </li> <li><a href=\"../../../app/building-your-application/optimizing/images\">Optimize images with the <code>&lt;Image&gt;</code> component</a></li> <li><a href=\"../../../app/building-your-application/optimizing/fonts\">Optimize fonts with <code>next/font</code></a></li> <li><a href=\"../../../app/building-your-application/optimizing/scripts\">Optimize third-party scripts with the <code>&lt;Script&gt;</code> component</a></li> <li><a href=\"../../../app/building-your-application/configuring/eslint\">Update your ESLint configuration to support Next.js rules</a></li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> Using a static export <a href=\"https://github.com/vercel/next.js/issues/54393\" rel=\"noopener noreferrer\" target=\"_blank\">does not currently support</a> using the <code>useParams</code> hook.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/from-create-react-app\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/from-create-react-app</a>\n  </p>\n</div>\n","pages/api-reference":"<h1 class=\"break-words\">API Reference</h1><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference</a>\n  </p>\n</div>\n","pages/api-reference/components":"<h1 class=\"break-words\">Components</h1><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/components\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/components</a>\n  </p>\n</div>\n","pages/api-reference/components/font":"<h1 class=\"break-words\">Font Module</h1> <p>This API reference will help you understand how to use <a href=\"../../../app/building-your-application/optimizing/fonts#google-fonts\"><code>next/font/google</code></a> and <a href=\"../../../app/building-your-application/optimizing/fonts#local-fonts\"><code>next/font/local</code></a>. For features and usage, please see the <a href=\"../../../app/building-your-application/optimizing/fonts\">Optimizing Fonts</a> page.</p> <h3 id=\"font-function-arguments\" data-docs-heading=\"\">Font Function Arguments     </h3> <p>For usage, review <a href=\"../../../app/building-your-application/optimizing/fonts#google-fonts\">Google Fonts</a> and <a href=\"../../../app/building-your-application/optimizing/fonts#local-fonts\">Local Fonts</a>.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Key</th>\n<th><code>font/google</code></th>\n<th><code>font/local</code></th>\n<th>Type</th>\n<th>Required</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#src\"><code>src</code></a></td>\n<td></td>\n<td></td>\n<td>String or Array of Objects</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"#weight\"><code>weight</code></a></td>\n<td></td>\n<td></td>\n<td>String or Array</td>\n<td>Required/Optional</td>\n</tr>\n<tr>\n<td><a href=\"#style\"><code>style</code></a></td>\n<td></td>\n<td></td>\n<td>String or Array</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#subsets\"><code>subsets</code></a></td>\n<td></td>\n<td></td>\n<td>Array of Strings</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#axes\"><code>axes</code></a></td>\n<td></td>\n<td></td>\n<td>Array of Strings</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#display\"><code>display</code></a></td>\n<td></td>\n<td></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#preload\"><code>preload</code></a></td>\n<td></td>\n<td></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#fallback\"><code>fallback</code></a></td>\n<td></td>\n<td></td>\n<td>Array of Strings</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#adjustfontfallback\"><code>adjustFontFallback</code></a></td>\n<td></td>\n<td></td>\n<td>Boolean or String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#variable\"><code>variable</code></a></td>\n<td></td>\n<td></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#declarations\"><code>declarations</code></a></td>\n<td></td>\n<td></td>\n<td>Array of Objects</td>\n<td>-</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"src\" data-docs-heading=\"\">src     </h3> <p>The path of the font file as a string or an array of objects (with type <code>Array&lt;{path: string, weight?: string, style?: string}&gt;</code>) relative to the directory where the font loader function is called.</p> <p>Used in <code>next/font/local</code></p> <ul> <li>Required</li> </ul> <p>Examples:</p> <ul> <li>\n<code>src:'./fonts/my-font.woff2'</code> where <code>my-font.woff2</code> is placed in a directory named <code>fonts</code> inside the <code>app</code> directory</li> <li><code>src:[{path: './inter/Inter-Thin.ttf', weight: '100',},{path: './inter/Inter-Regular.ttf',weight: '400',},{path: './inter/Inter-Bold-Italic.ttf', weight: '700',style: 'italic',},]</code></li> <li>if the font loader function is called in <code>app/page.tsx</code> using <code>src:'../styles/fonts/my-font.ttf'</code>, then <code>my-font.ttf</code> is placed in <code>styles/fonts</code> at the root of the project</li> </ul> <h3 id=\"weight\" data-docs-heading=\"\">weight     </h3> <p>The font <a href=\"https://fonts.google.com/knowledge/glossary/weight\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>weight</code></a> with the following possibilities:</p> <ul> <li>A string with possible values of the weights available for the specific font or a range of values if it's a <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable</a> font</li> <li>An array of weight values if the font is not a <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable google font</a>. It applies to <code>next/font/google</code> only.</li> </ul> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Required if the font being used is <strong>not</strong> <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable</a>\n</li> </ul> <p>Examples:</p> <ul> <li>\n<code>weight: '400'</code>: A string for a single weight value - for the font <a href=\"https://fonts.google.com/specimen/Inter?query=inter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Inter</code></a>, the possible values are <code>'100'</code>, <code>'200'</code>, <code>'300'</code>, <code>'400'</code>, <code>'500'</code>, <code>'600'</code>, <code>'700'</code>, <code>'800'</code>, <code>'900'</code> or <code>'variable'</code> where <code>'variable'</code> is the default)</li> <li>\n<code>weight: '100 900'</code>: A string for the range between <code>100</code> and <code>900</code> for a variable font</li> <li>\n<code>weight: ['100','400','900']</code>: An array of 3 possible values for a non variable font</li> </ul> <h3 id=\"style\" data-docs-heading=\"\">style     </h3> <p>The font <a href=\"https://developer.mozilla.org/docs/Web/CSS/font-style\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>style</code></a> with the following possibilities:</p> <ul> <li>A string <a href=\"https://developer.mozilla.org/docs/Web/CSS/font-style#values\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">value</a> with default value of <code>'normal'</code>\n</li> <li>An array of style values if the font is not a <a href=\"https://fonts.google.com/variablefonts\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">variable google font</a>. It applies to <code>next/font/google</code> only.</li> </ul> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>style: 'italic'</code>: A string - it can be <code>normal</code> or <code>italic</code> for <code>next/font/google</code>\n</li> <li>\n<code>style: 'oblique'</code>: A string - it can take any value for <code>next/font/local</code> but is expected to come from <a href=\"https://developer.mozilla.org/docs/Web/CSS/font-style\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">standard font styles</a>\n</li> <li>\n<code>style: ['italic','normal']</code>: An array of 2 values for <code>next/font/google</code> - the values are from <code>normal</code> and <code>italic</code>\n</li> </ul> <h3 id=\"subsets\" data-docs-heading=\"\">subsets     </h3> <p>The font <a href=\"https://fonts.google.com/knowledge/glossary/subsetting\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>subsets</code></a> defined by an array of string values with the names of each subset you would like to be <a href=\"../../../app/building-your-application/optimizing/fonts#specifying-a-subset\">preloaded</a>. Fonts specified via <code>subsets</code> will have a link preload tag injected into the head when the <a href=\"#preload\"><code>preload</code></a> option is true, which is the default.</p> <p>Used in <code>next/font/google</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>subsets: ['latin']</code>: An array with the subset <code>latin</code>\n</li> </ul> <p>You can find a list of all subsets on the Google Fonts page for your font.</p> <h3 id=\"axes\" data-docs-heading=\"\">axes     </h3> <p>Some variable fonts have extra <code>axes</code> that can be included. By default, only the font weight is included to keep the file size down. The possible values of <code>axes</code> depend on the specific font.</p> <p>Used in <code>next/font/google</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>axes: ['slnt']</code>: An array with value <code>slnt</code> for the <code>Inter</code> variable font which has <code>slnt</code> as additional <code>axes</code> as shown <a href=\"https://fonts.google.com/variablefonts?vfquery=inter#font-families\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">here</a>. You can find the possible <code>axes</code> values for your font by using the filter on the <a href=\"https://fonts.google.com/variablefonts#font-families\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google variable fonts page</a> and looking for axes other than <code>wght</code>\n</li> </ul> <h3 id=\"display\" data-docs-heading=\"\">display     </h3> <p>The font <a href=\"https://developer.mozilla.org/docs/Web/CSS/@font-face/font-display\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>display</code></a> with possible string <a href=\"https://developer.mozilla.org/docs/Web/CSS/@font-face/font-display#values\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">values</a> of <code>'auto'</code>, <code>'block'</code>, <code>'swap'</code>, <code>'fallback'</code> or <code>'optional'</code> with default value of <code>'swap'</code>.</p> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>display: 'optional'</code>: A string assigned to the <code>optional</code> value</li> </ul> <h3 id=\"preload\" data-docs-heading=\"\">preload     </h3> <p>A boolean value that specifies whether the font should be <a href=\"../../../app/building-your-application/optimizing/fonts#preloading\">preloaded</a> or not. The default is <code>true</code>.</p> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li><code>preload: false</code></li> </ul> <h3 id=\"fallback\" data-docs-heading=\"\">fallback     </h3> <p>The fallback font to use if the font cannot be loaded. An array of strings of fallback fonts with no default.</p> <ul> <li>Optional</li> </ul> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <p>Examples:</p> <ul> <li>\n<code>fallback: ['system-ui', 'arial']</code>: An array setting the fallback fonts to <code>system-ui</code> or <code>arial</code>\n</li> </ul> <h3 id=\"adjustfontfallback\" data-docs-heading=\"\">adjustFontFallback     </h3> <ul> <li>For <code>next/font/google</code>: A boolean value that sets whether an automatic fallback font should be used to reduce <a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a>. The default is <code>true</code>.</li> <li>For <code>next/font/local</code>: A string or boolean <code>false</code> value that sets whether an automatic fallback font should be used to reduce <a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a>. The possible values are <code>'Arial'</code>, <code>'Times New Roman'</code> or <code>false</code>. The default is <code>'Arial'</code>.</li> </ul> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>adjustFontFallback: false</code>: for <code>next/font/google</code>\n</li> <li>\n<code>adjustFontFallback: 'Times New Roman'</code>: for <code>next/font/local</code>\n</li> </ul> <h3 id=\"variable\" data-docs-heading=\"\">variable     </h3> <p>A string value to define the CSS variable name to be used if the style is applied with the <a href=\"#css-variables\">CSS variable method</a>.</p> <p>Used in <code>next/font/google</code> and <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li>\n<code>variable: '--my-font'</code>: The CSS variable <code>--my-font</code> is declared</li> </ul> <h3 id=\"declarations\" data-docs-heading=\"\">declarations     </h3> <p>An array of font face <a href=\"https://developer.mozilla.org/docs/Web/CSS/@font-face#descriptors\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">descriptor</a> key-value pairs that define the generated <code>@font-face</code> further.</p> <p>Used in <code>next/font/local</code></p> <ul> <li>Optional</li> </ul> <p>Examples:</p> <ul> <li><code>declarations: [{ prop: 'ascent-override', value: '90%' }]</code></li> </ul> <h2 id=\"applying-styles\" data-docs-heading=\"\">Applying Styles     </h2> <p>You can apply the font styles in three ways:</p> <ul> <li><a href=\"#classname\"><code>className</code></a></li> <li><a href=\"#style-1\"><code>style</code></a></li> <li><a href=\"#css-variables\">CSS Variables</a></li> </ul> <h3 id=\"classname\" data-docs-heading=\"\">className     </h3> <p>Returns a read-only CSS <code>className</code> for the loaded font to be passed to an HTML element.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;p className={inter.className}&gt;Hello, Next.js!&lt;/p&gt;</pre>\n</div> <h3 id=\"style-1\" data-docs-heading=\"\">style     </h3> <p>Returns a read-only CSS <code>style</code> object for the loaded font to be passed to an HTML element, including <code>style.fontFamily</code> to access the font family name and fallback fonts.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;p style={inter.style}&gt;Hello World&lt;/p&gt;</pre>\n</div> <h3 id=\"css-variables\" data-docs-heading=\"\">CSS Variables     </h3> <p>If you would like to set your styles in an external style sheet and specify additional options there, use the CSS variable method.</p> <p>In addition to importing the font, also import the CSS file where the CSS variable is defined and set the variable option of the font loader object as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter } from 'next/font/google'\nimport styles from '../styles/component.module.css'\n \nconst inter = Inter({\n  variable: '--font-inter',\n})</pre></div>  <p>To use the font, set the <code>className</code> of the parent container of the text you would like to style to the font loader's <code>variable</code> value and the <code>className</code> of the text to the <code>styles</code> property from the external CSS file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;main className={inter.variable}&gt;\n  &lt;p className={styles.text}&gt;Hello World&lt;/p&gt;\n&lt;/main&gt;</pre></div>  <p>Define the <code>text</code> selector class in the <code>component.module.css</code> CSS file as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.text {\n  font-family: var(--font-inter);\n  font-weight: 200;\n  font-style: italic;\n}</pre></div> <p>In the example above, the text <code>Hello World</code> is styled using the <code>Inter</code> font and the generated font fallback with <code>font-weight: 200</code> and <code>font-style: italic</code>.</p> <h2 id=\"using-a-font-definitions-file\" data-docs-heading=\"\">Using a font definitions file     </h2> <p>Every time you call the <code>localFont</code> or Google font function, that font will be hosted as one instance in your application. Therefore, if you need to use the same font in multiple places, you should load it in one place and import the related font object where you need it. This is done using a font definitions file.</p> <p>For example, create a <code>fonts.ts</code> file in a <code>styles</code> folder at the root of your app directory.</p> <p>Then, specify your font definitions as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Inter, Lora, Source_Sans_3 } from 'next/font/google'\nimport localFont from 'next/font/local'\n \n// define your variable fonts\nconst inter = Inter()\nconst lora = Lora()\n// define 2 weights of a non-variable font\nconst sourceCodePro400 = Source_Sans_3({ weight: '400' })\nconst sourceCodePro700 = Source_Sans_3({ weight: '700' })\n// define a custom local font where GreatVibes-Regular.ttf is stored in the styles folder\nconst greatVibes = localFont({ src: './GreatVibes-Regular.ttf' })\n \nexport { inter, lora, sourceCodePro400, sourceCodePro700, greatVibes }</pre></div>  <p>You can now use these definitions in your code as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { inter, lora, sourceCodePro700, greatVibes } from '../styles/fonts'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;p className={inter.className}&gt;Hello world using Inter font&lt;/p&gt;\n      &lt;p style={lora.style}&gt;Hello world using Lora font&lt;/p&gt;\n      &lt;p className={sourceCodePro700.className}&gt;\n        Hello world using Source_Sans_3 font with weight 700\n      &lt;/p&gt;\n      &lt;p className={greatVibes.className}&gt;My title in Great Vibes font&lt;/p&gt;\n    &lt;/div&gt;\n  )\n}</pre></div>  <p>To make it easier to access the font definitions in your code, you can define a path alias in your <code>tsconfig.json</code> or <code>jsconfig.json</code> files as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@/fonts\": [\"./styles/fonts\"]\n    }\n  }\n}</pre></div> <p>You can now import any font definition as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { greatVibes, sourceCodePro400 } from '@/fonts'</pre></div>  <h2 id=\"version-changes\" data-docs-heading=\"\">Version Changes     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>\n<code>@next/font</code> renamed to <code>next/font</code>. Installation no longer required.</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>@next/font</code> was added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/components/font\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/components/font</a>\n  </p>\n</div>\n","pages/api-reference/components/head":"<h1 class=\"break-words\">&lt;Head&gt;</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/head-elements\" rel=\"noopener noreferrer\" target=\"_blank\">Head Elements</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/layout-component\" rel=\"noopener noreferrer\" target=\"_blank\">Layout Component</a></li> </ul></details> <p>We expose a built-in component for appending elements to the <code>head</code> of the page:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Head from 'next/head'\n \nfunction IndexPage() {\n  return (\n    &lt;div&gt;\n      &lt;Head&gt;\n        &lt;title&gt;My page title&lt;/title&gt;\n      &lt;/Head&gt;\n      &lt;p&gt;Hello world!&lt;/p&gt;\n    &lt;/div&gt;\n  )\n}\n \nexport default IndexPage</pre>\n</div> <h2 id=\"avoid-duplicated-tags\" data-docs-heading=\"\">Avoid duplicated tags     </h2> <p>To avoid duplicate tags in your <code>head</code> you can use the <code>key</code> property, which will make sure the tag is only rendered once, as in the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Head from 'next/head'\n \nfunction IndexPage() {\n  return (\n    &lt;div&gt;\n      &lt;Head&gt;\n        &lt;title&gt;My page title&lt;/title&gt;\n        &lt;meta property=\"og:title\" content=\"My page title\" key=\"title\" /&gt;\n      &lt;/Head&gt;\n      &lt;Head&gt;\n        &lt;meta property=\"og:title\" content=\"My new title\" key=\"title\" /&gt;\n      &lt;/Head&gt;\n      &lt;p&gt;Hello world!&lt;/p&gt;\n    &lt;/div&gt;\n  )\n}\n \nexport default IndexPage</pre>\n</div> <p>In this case only the second <code>&lt;meta property=\"og:title\" /&gt;</code> is rendered. <code>meta</code> tags with duplicate <code>key</code> attributes are automatically handled.</p> <blockquote class=\"p-3 text-sm\"> <p>The contents of <code>head</code> get cleared upon unmounting the component, so make sure each page completely defines what it needs in <code>head</code>, without making assumptions about what other pages added.</p> </blockquote> <h2 id=\"use-minimal-nesting\" data-docs-heading=\"\">Use minimal nesting     </h2> <p><code>title</code>, <code>meta</code> or any other elements (e.g. <code>script</code>) need to be contained as <strong>direct</strong> children of the <code>Head</code> element, or wrapped into maximum one level of <code>&lt;React.Fragment&gt;</code> or arraysotherwise the tags won't be correctly picked up on client-side navigations.</p> <h2 id=\"use-nextscript-for-scripts\" data-docs-heading=\"\">Use next/script for scripts     </h2> <p>We recommend using <a href=\"../../building-your-application/optimizing/scripts\"><code>next/script</code></a> in your component instead of manually creating a <code>&lt;script&gt;</code> in <code>next/head</code>.</p> <h2 id=\"no-html-or-body-tags\" data-docs-heading=\"\">No html or body tags     </h2> <p>You <strong>cannot</strong> use <code>&lt;Head&gt;</code> to set attributes on <code>&lt;html&gt;</code> or <code>&lt;body&gt;</code> tags. This will result in an <code>next-head-count is missing</code> error. <code>next/head</code> can only handle tags inside the HTML <code>&lt;head&gt;</code> tag.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/components/head\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/components/head</a>\n  </p>\n</div>\n","pages/api-reference/components/image":"<h1 class=\"break-words\">&lt;Image&gt;</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/image-component\" rel=\"noopener noreferrer\" target=\"_blank\">Image Component</a></li> </ul></details> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you are using a version of Next.js prior to 13, you'll want to use the <a href=\"image-legacy\">next/legacy/image</a> documentation since the component was renamed.</p> </blockquote> <p>This API reference will help you understand how to use <a href=\"#props\">props</a> and <a href=\"#configuration-options\">configuration options</a> available for the Image Component. For features and usage, please see the <a href=\"../../../app/building-your-application/optimizing/images\">Image Component</a> page.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return (\n    &lt;Image\n      src=\"/profile.png\"\n      width={500}\n      height={500}\n      alt=\"Picture of the author\"\n    /&gt;\n  )\n}</pre></div> <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <p>Here's a summary of the props available for the Image Component:</p> <div style=\"overflow-x:auto;width:100%\"><div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Prop</th>\n<th>Example</th>\n<th>Type</th>\n<th>Status</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#src\"><code>src</code></a></td>\n<td><code>src=\"/profile.png\"</code></td>\n<td>String</td>\n<td>Required</td>\n</tr>\n<tr>\n<td><a href=\"#width\"><code>width</code></a></td>\n<td><code>width={500}</code></td>\n<td>Integer (px)</td>\n<td>Required</td>\n</tr>\n<tr>\n<td><a href=\"#height\"><code>height</code></a></td>\n<td><code>height={500}</code></td>\n<td>Integer (px)</td>\n<td>Required</td>\n</tr>\n<tr>\n<td><a href=\"#alt\"><code>alt</code></a></td>\n<td><code>alt=\"Picture of the author\"</code></td>\n<td>String</td>\n<td>Required</td>\n</tr>\n<tr>\n<td><a href=\"#loader\"><code>loader</code></a></td>\n<td><code>loader={imageLoader}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#fill\"><code>fill</code></a></td>\n<td><code>fill={true}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#sizes\"><code>sizes</code></a></td>\n<td><code>sizes=\"(max-width: 768px) 100vw, 33vw\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#quality\"><code>quality</code></a></td>\n<td><code>quality={80}</code></td>\n<td>Integer (1-100)</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#priority\"><code>priority</code></a></td>\n<td><code>priority={true}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#placeholder\"><code>placeholder</code></a></td>\n<td><code>placeholder=\"blur\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#style\"><code>style</code></a></td>\n<td><code>style={{objectFit: \"contain\"}}</code></td>\n<td>Object</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onloadingcomplete\"><code>onLoadingComplete</code></a></td>\n<td><code>onLoadingComplete={img =&gt; done())}</code></td>\n<td>Function</td>\n<td>Deprecated</td>\n</tr>\n<tr>\n<td><a href=\"#onload\"><code>onLoad</code></a></td>\n<td><code>onLoad={event =&gt; done())}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onerror\"><code>onError</code></a></td>\n<td><code>onError(event =&gt; fail()}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#loading\"><code>loading</code></a></td>\n<td><code>loading=\"lazy\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#blurdataurl\"><code>blurDataURL</code></a></td>\n<td><code>blurDataURL=\"data:image/jpeg...\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#overridesrc\"><code>overrideSrc</code></a></td>\n<td><code>overrideSrc=\"/seo.png\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n</tbody>\n</table></div></div> <h2 id=\"required-props\" data-docs-heading=\"\">Required Props     </h2> <p>The Image Component requires the following properties: <code>src</code>, <code>width</code>, <code>height</code>, and <code>alt</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return (\n    &lt;div&gt;\n      &lt;Image\n        src=\"/profile.png\"\n        width={500}\n        height={500}\n        alt=\"Picture of the author\"\n      /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <h3 id=\"src\" data-docs-heading=\"\">src     </h3> <p>Must be one of the following:</p> <ul> <li>A <a href=\"../../../app/building-your-application/optimizing/images#local-images\">statically imported</a> image file</li> <li>A path string. This can be either an absolute external URL, or an internal path depending on the <a href=\"#loader\">loader</a> prop.</li> </ul> <p>When using an external URL, you must add it to <a href=\"#remotepatterns\">remotePatterns</a> in <code>next.config.js</code>.</p> <h3 id=\"width\" data-docs-heading=\"\">width     </h3> <p>The <code>width</code> property represents the <em>rendered</em> width in pixels, so it will affect how large the image appears.</p> <p>Required, except for <a href=\"../../../app/building-your-application/optimizing/images#local-images\">statically imported images</a> or images with the <a href=\"#fill\"><code>fill</code> property</a>.</p> <h3 id=\"height\" data-docs-heading=\"\">height     </h3> <p>The <code>height</code> property represents the <em>rendered</em> height in pixels, so it will affect how large the image appears.</p> <p>Required, except for <a href=\"../../../app/building-your-application/optimizing/images#local-images\">statically imported images</a> or images with the <a href=\"#fill\"><code>fill</code> property</a>.</p> <h3 id=\"alt\" data-docs-heading=\"\">alt     </h3> <p>The <code>alt</code> property is used to describe the image for screen readers and search engines. It is also the fallback text if images have been disabled or an error occurs while loading the image.</p> <p>It should contain text that could replace the image <a href=\"https://html.spec.whatwg.org/multipage/images.html#general-guidelines\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">without changing the meaning of the page</a>. It is not meant to supplement the image and should not repeat information that is already provided in the captions above or below the image.</p> <p>If the image is <a href=\"https://html.spec.whatwg.org/multipage/images.html#a-purely-decorative-image-that-doesn't-add-any-information\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">purely decorative</a> or <a href=\"https://html.spec.whatwg.org/multipage/images.html#an-image-not-intended-for-the-user\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">not intended for the user</a>, the <code>alt</code> property should be an empty string (<code>alt=\"\"</code>).</p> <p><a href=\"https://html.spec.whatwg.org/multipage/images.html#alt\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Learn more</a></p> <h2 id=\"optional-props\" data-docs-heading=\"\">Optional Props     </h2> <p>The <code>&lt;Image /&gt;</code> component accepts a number of additional properties beyond those which are required. This section describes the most commonly-used properties of the Image component. Find details about more rarely-used properties in the <a href=\"#advanced-props\">Advanced Props</a> section.</p> <h3 id=\"loader\" data-docs-heading=\"\">loader     </h3> <p>A custom function used to resolve image URLs.</p> <p>A <code>loader</code> is a function returning a URL string for the image, given the following parameters:</p> <ul> <li><a href=\"#src\"><code>src</code></a></li> <li><a href=\"#width\"><code>width</code></a></li> <li><a href=\"#quality\"><code>quality</code></a></li> </ul> <p>Here is an example of using a custom loader:</p>  <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nconst imageLoader = ({ src, width, quality }) =&gt; {\n  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`\n}\n \nexport default function Page() {\n  return (\n    &lt;Image\n      loader={imageLoader}\n      src=\"me.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    /&gt;\n  )\n}</pre>\n</div> <p>Alternatively, you can use the <a href=\"#loaderfile\">loaderFile</a> configuration in <code>next.config.js</code> to configure every instance of <code>next/image</code> in your application, without passing a prop.</p> <h3 id=\"fill\" data-docs-heading=\"\">fill     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">fill={true} // {true} | {false}</pre>\n</div> <p>A boolean that causes the image to fill the parent element, which is useful when the <a href=\"#width\"><code>width</code></a> and <a href=\"#height\"><code>height</code></a> are unknown.</p> <p>The parent element <em>must</em> assign <code>position: \"relative\"</code>, <code>position: \"fixed\"</code>, or <code>position: \"absolute\"</code> style.</p> <p>By default, the img element will automatically be assigned the <code>position: \"absolute\"</code> style.</p> <p>If no styles are applied to the image, the image will stretch to fit the container. You may prefer to set <code>object-fit: \"contain\"</code> for an image which is letterboxed to fit the container and preserve aspect ratio.</p> <p>Alternatively, <code>object-fit: \"cover\"</code> will cause the image to fill the entire container and be cropped to preserve aspect ratio. For this to look correct, the <code>overflow: \"hidden\"</code> style should be assigned to the parent element.</p> <p>For more information, see also:</p> <ul> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/position\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>position</code></a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/object-fit\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>object-fit</code></a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/CSS/object-position\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>object-position</code></a></li> </ul> <h3 id=\"sizes\" data-docs-heading=\"\">sizes     </h3> <p>A string, similar to a media query, that provides information about how wide the image will be at different breakpoints. The value of <code>sizes</code> will greatly affect performance for images using <a href=\"#fill\"><code>fill</code></a> or which are <a href=\"#responsive-images\">styled to have a responsive size</a>.</p> <p>The <code>sizes</code> property serves two important purposes related to image performance:</p> <ul> <li>First, the value of <code>sizes</code> is used by the browser to determine which size of the image to download, from <code>next/image</code>'s automatically generated <code>srcset</code>. When the browser chooses, it does not yet know the size of the image on the page, so it selects an image that is the same size or larger than the viewport. The <code>sizes</code> property allows you to tell the browser that the image will actually be smaller than full screen. If you don't specify a <code>sizes</code> value in an image with the <code>fill</code> property, a default value of <code>100vw</code> (full screen width) is used.</li> <li>Second, the <code>sizes</code> property changes the behavior of the automatically generated <code>srcset</code> value. If no <code>sizes</code> value is present, a small <code>srcset</code> is generated, suitable for a fixed-size image (1x/2x/etc). If <code>sizes</code> is defined, a large <code>srcset</code> is generated, suitable for a responsive image (640w/750w/etc). If the <code>sizes</code> property includes sizes such as <code>50vw</code>, which represent a percentage of the viewport width, then the <code>srcset</code> is trimmed to not include any values which are too small to ever be necessary.</li> </ul> <p>For example, if you know your styling will cause an image to be full-width on mobile devices, in a 2-column layout on tablets, and a 3-column layout on desktop displays, you should include a sizes property such as the following:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page() {\n  return (\n    &lt;div className=\"grid-element\"&gt;\n      &lt;Image\n        fill\n        src=\"/example.png\"\n        sizes=\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\"\n      /&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <p>This example <code>sizes</code> could have a dramatic effect on performance metrics. Without the <code>33vw</code> sizes, the image selected from the server would be 3 times as wide as it needs to be. Because file size is proportional to the square of the width, without <code>sizes</code> the user would download an image that's 9 times larger than necessary.</p> <p>Learn more about <code>srcset</code> and <code>sizes</code>:</p> <ul> <li><a href=\"https://web.dev/learn/design/responsive-images/#sizes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">web.dev</a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/img#sizes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">mdn</a></li> </ul> <h3 id=\"quality\" data-docs-heading=\"\">quality     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">quality={75} // {number 1-100}</pre>\n</div> <p>The quality of the optimized image, an integer between <code>1</code> and <code>100</code>, where <code>100</code> is the best quality and therefore largest file size. Defaults to <code>75</code>.</p> <h3 id=\"priority\" data-docs-heading=\"\">priority     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">priority={false} // {false} | {true}</pre>\n</div> <p>When true, the image will be considered high priority and <a href=\"https://web.dev/preload-responsive-images/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preload</a>. Lazy loading is automatically disabled for images using <code>priority</code>.</p> <p>You should use the <code>priority</code> property on any image detected as the <a href=\"https://nextjs.org/learn/seo/web-performance/lcp\" rel=\"noopener noreferrer\" target=\"_blank\">Largest Contentful Paint (LCP)</a> element. It may be appropriate to have multiple priority images, as different images may be the LCP element for different viewport sizes.</p> <p>Should only be used when the image is visible above the fold. Defaults to <code>false</code>.</p> <h3 id=\"placeholder\" data-docs-heading=\"\">placeholder     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">placeholder = 'empty' // \"empty\" | \"blur\" | \"data:image/...\"</pre>\n</div> <p>A placeholder to use while the image is loading. Possible values are <code>blur</code>, <code>empty</code>, or <code>data:image/...</code>. Defaults to <code>empty</code>.</p> <p>When <code>blur</code>, the <a href=\"#blurdataurl\"><code>blurDataURL</code></a> property will be used as the placeholder. If <code>src</code> is an object from a <a href=\"../../../app/building-your-application/optimizing/images#local-images\">static import</a> and the imported image is <code>.jpg</code>, <code>.png</code>, <code>.webp</code>, or <code>.avif</code>, then <code>blurDataURL</code> will be automatically populated, except when the image is detected to be animated.</p> <p>For dynamic images, you must provide the <a href=\"#blurdataurl\"><code>blurDataURL</code></a> property. Solutions such as <a href=\"https://github.com/joe-bell/plaiceholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Plaiceholder</a> can help with <code>base64</code> generation.</p> <p>When <code>data:image/...</code>, the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/Data_URIs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Data URL</a> will be used as the placeholder while the image is loading.</p> <p>When <code>empty</code>, there will be no placeholder while the image is loading, only empty space.</p> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/placeholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>blur</code> placeholder</a></li> <li><a href=\"https://image-component.nextjs.gallery/shimmer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the shimmer effect with data URL <code>placeholder</code> prop</a></li> <li><a href=\"https://image-component.nextjs.gallery/color\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the color effect with <code>blurDataURL</code> prop</a></li> </ul> <h2 id=\"advanced-props\" data-docs-heading=\"\">Advanced Props     </h2> <p>In some cases, you may need more advanced usage. The <code>&lt;Image /&gt;</code> component optionally accepts the following advanced properties.</p> <h3 id=\"style\" data-docs-heading=\"\">style     </h3> <p>Allows passing CSS styles to the underlying image element.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const imageStyle = {\n  borderRadius: '50%',\n  border: '1px solid #fff',\n}\n \nexport default function ProfileImage() {\n  return &lt;Image src=\"...\" style={imageStyle} /&gt;\n}</pre></div> <p>Remember that the required width and height props can interact with your styling. If you use styling to modify an image's width, you should also style its height to <code>auto</code> to preserve its intrinsic aspect ratio, or your image will be distorted.</p> <h3 id=\"onloadingcomplete\" data-docs-heading=\"\">onLoadingComplete     </h3>  <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image onLoadingComplete={(img) =&gt; console.log(img.naturalWidth)} /&gt;</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: Deprecated since Next.js 14 in favor of <a href=\"#onload\"><code>onLoad</code></a>.</p> </blockquote> <p>A callback function that is invoked once the image is completely loaded and the <a href=\"#placeholder\">placeholder</a> has been removed.</p> <p>The callback function will be called with one argument, a reference to the underlying <code>&lt;img&gt;</code> element.</p>  <h3 id=\"onload\" data-docs-heading=\"\">onLoad     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image onLoad={(e) =&gt; console.log(e.target.naturalWidth)} /&gt;</pre>\n</div> <p>A callback function that is invoked once the image is completely loaded and the <a href=\"#placeholder\">placeholder</a> has been removed.</p> <p>The callback function will be called with one argument, the Event which has a <code>target</code> that references the underlying <code>&lt;img&gt;</code> element.</p>  <h3 id=\"onerror\" data-docs-heading=\"\">onError     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image onError={(e) =&gt; console.error(e.target.id)} /&gt;</pre>\n</div> <p>A callback function that is invoked if the image fails to load.</p>  <h3 id=\"loading\" data-docs-heading=\"\">loading     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: This property is only meant for advanced use cases. Switching an image to load with <code>eager</code> will normally <strong>hurt performance</strong>. We recommend using the <a href=\"#priority\"><code>priority</code></a> property instead, which will eagerly preload the image.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">loading = 'lazy' // {lazy} | {eager}</pre>\n</div> <p>The loading behavior of the image. Defaults to <code>lazy</code>.</p> <p>When <code>lazy</code>, defer loading the image until it reaches a calculated distance from the viewport.</p> <p>When <code>eager</code>, load the image immediately.</p> <p>Learn more about the <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/img#loading\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>loading</code> attribute</a>.</p> <h3 id=\"blurdataurl\" data-docs-heading=\"\">blurDataURL     </h3> <p>A <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/Data_URIs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Data URL</a> to be used as a placeholder image before the <code>src</code> image successfully loads. Only takes effect when combined with <a href=\"#placeholder\"><code>placeholder=\"blur\"</code></a>.</p> <p>Must be a base64-encoded image. It will be enlarged and blurred, so a very small image (10px or less) is recommended. Including larger images as placeholders may harm your application performance.</p> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/placeholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the default <code>blurDataURL</code> prop</a></li> <li><a href=\"https://image-component.nextjs.gallery/color\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the color effect with <code>blurDataURL</code> prop</a></li> </ul> <p>You can also <a href=\"https://png-pixel.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">generate a solid color Data URL</a> to match the image.</p> <h3 id=\"unoptimized\" data-docs-heading=\"\">unoptimized     </h3> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">unoptimized = {false} // {false} | {true}</pre>\n</div> <p>When true, the source image will be served as-is instead of changing quality, size, or format. Defaults to <code>false</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nconst UnoptimizedImage = (props) =&gt; {\n  return &lt;Image {...props} unoptimized /&gt;\n}</pre>\n</div> <p>Since Next.js 12.3.0, this prop can be assigned to all images by updating <code>next.config.js</code> with the following configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    unoptimized: true,\n  },\n}</pre></div> <h3 id=\"overridesrc\" data-docs-heading=\"\">overrideSrc     </h3> <p>When providing the <code>src</code> prop to the <code>&lt;Image&gt;</code> component, both the <code>srcset</code> and <code>src</code> attributes are generated automatically for the resulting <code>&lt;img&gt;</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image src=\"/me.jpg\" /&gt;</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;img\n  srcset=\"\n    /_next/image?url=%2Fme.jpg&amp;w=640&amp;q=75 1x,\n    /_next/image?url=%2Fme.jpg&amp;w=828&amp;q=75 2x\n  \"\n  src=\"/_next/image?url=%2Fme.jpg&amp;w=828&amp;q=75\"\n/&gt;</pre></div> <p>In some cases, it is not desirable to have the <code>src</code> attribute generated and you may wish to override it using the <code>overrideSrc</code> prop.</p> <p>For example, when upgrading an existing website from <code>&lt;img&gt;</code> to <code>&lt;Image&gt;</code>, you may wish to maintain the same <code>src</code> attribute for SEO purposes such as image ranking or avoiding recrawl.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Image src=\"/me.jpg\" overrideSrc=\"/override.jpg\" /&gt;</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;img\n  srcset=\"\n    /_next/image?url=%2Fme.jpg&amp;w=640&amp;q=75 1x,\n    /_next/image?url=%2Fme.jpg&amp;w=828&amp;q=75 2x\n  \"\n  src=\"/override.jpg\"\n/&gt;</pre></div> <h3 id=\"other-props\" data-docs-heading=\"\">Other Props     </h3> <p>Other properties on the <code>&lt;Image /&gt;</code> component will be passed to the underlying <code>img</code> element with the exception of the following:</p> <ul> <li>\n<code>srcSet</code>. Use <a href=\"#devicesizes\">Device Sizes</a> instead.</li> <li>\n<code>decoding</code>. It is always <code>\"async\"</code>.</li> </ul> <h2 id=\"configuration-options\" data-docs-heading=\"\">Configuration Options     </h2> <p>In addition to props, you can configure the Image Component in <code>next.config.js</code>. The following options are available:</p> <h3 id=\"remotepatterns\" data-docs-heading=\"\">remotePatterns     </h3> <p>To protect your application from malicious users, configuration is required in order to use external images. This ensures that only external images from your account can be served from the Next.js Image Optimization API. These external images can be configured with the <code>remotePatterns</code> property in your <code>next.config.js</code> file, as shown below:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 'example.com',\n        port: '',\n        pathname: '/account123/**',\n      },\n    ],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The example above will ensure the <code>src</code> property of <code>next/image</code> must start with <code>https://example.com/account123/</code>. Any other protocol, hostname, port, or unmatched path will respond with 400 Bad Request.</p> </blockquote> <p>Below is another example of the <code>remotePatterns</code> property in the <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: '**.example.com',\n        port: '',\n      },\n    ],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The example above will ensure the <code>src</code> property of <code>next/image</code> must start with <code>https://img1.example.com</code> or <code>https://me.avatar.example.com</code> or any number of subdomains. Any other protocol, port, or unmatched hostname will respond with 400 Bad Request.</p> </blockquote> <p>Wildcard patterns can be used for both <code>pathname</code> and <code>hostname</code> and have the following syntax:</p> <ul> <li>\n<code>*</code> match a single path segment or subdomain</li> <li>\n<code>**</code> match any number of path segments at the end or subdomains at the beginning</li> </ul> <p>The <code>**</code> syntax does not work in the middle of the pattern.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: When omitting <code>protocol</code>, <code>port</code> or <code>pathname</code>, then the wildcard <code>**</code> is implied. This is not recommended because it may allow malicious actors to optimize urls you did not intend.</p> </blockquote> <h3 id=\"domains\" data-docs-heading=\"\">domains     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: Deprecated since Next.js 14 in favor of strict <a href=\"#remotepatterns\"><code>remotePatterns</code></a> in order to protect your application from malicious users. Only use <code>domains</code> if you own all the content served from the domain.</p> </blockquote> <p>Similar to <a href=\"#remotepatterns\"><code>remotePatterns</code></a>, the <code>domains</code> configuration can be used to provide a list of allowed hostnames for external images.</p> <p>However, the <code>domains</code> configuration does not support wildcard pattern matching and it cannot restrict protocol, port, or pathname.</p> <p>Below is an example of the <code>domains</code> property in the <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    domains: ['assets.acme.com'],\n  },\n}</pre></div> <h3 id=\"loaderfile\" data-docs-heading=\"\">loaderFile     </h3> <p>If you want to use a cloud provider to optimize images instead of using the Next.js built-in Image Optimization API, you can configure the <code>loaderFile</code> in your <code>next.config.js</code> like the following:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    loader: 'custom',\n    loaderFile: './my/image/loader.js',\n  },\n}</pre></div> <p>This must point to a file relative to the root of your Next.js application. The file must export a default function that returns a string, for example:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function myImageLoader({ src, width, quality }) {\n  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`\n}</pre></div> <p>Alternatively, you can use the <a href=\"#loader\"><code>loader</code> prop</a> to configure each instance of <code>next/image</code>.</p> <p>Examples:</p> <ul> <li><a href=\"../../../app/api-reference/next-config-js/images#example-loader-configuration\">Custom Image Loader Configuration</a></li> </ul>  <h2 id=\"advanced\" data-docs-heading=\"\">Advanced     </h2> <p>The following configuration is for advanced use cases and is usually not necessary. If you choose to configure the properties below, you will override any changes to the Next.js defaults in future updates.</p> <h3 id=\"devicesizes\" data-docs-heading=\"\">deviceSizes     </h3> <p>If you know the expected device widths of your users, you can specify a list of device width breakpoints using the <code>deviceSizes</code> property in <code>next.config.js</code>. These widths are used when the <code>next/image</code> component uses <a href=\"#sizes\"><code>sizes</code></a> prop to ensure the correct image is served for user's device.</p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],\n  },\n}</pre></div> <h3 id=\"imagesizes\" data-docs-heading=\"\">imageSizes     </h3> <p>You can specify a list of image widths using the <code>images.imageSizes</code> property in your <code>next.config.js</code> file. These widths are concatenated with the array of <a href=\"#devicesizes\">device sizes</a> to form the full array of sizes used to generate image <a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/srcset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">srcset</a>s.</p> <p>The reason there are two separate lists is that imageSizes is only used for images which provide a <a href=\"#sizes\"><code>sizes</code></a> prop, which indicates that the image is less than the full width of the screen. <strong>Therefore, the sizes in imageSizes should all be smaller than the smallest size in deviceSizes.</strong></p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],\n  },\n}</pre></div> <h3 id=\"formats\" data-docs-heading=\"\">formats     </h3> <p>The default <a href=\"#loader\">Image Optimization API</a> will automatically detect the browser's supported image formats via the request's <code>Accept</code> header.</p> <p>If the <code>Accept</code> head matches more than one of the configured formats, the first match in the array is used. Therefore, the array order matters. If there is no match (or the source image is <a href=\"#animated-images\">animated</a>), the Image Optimization API will fallback to the original image's format.</p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    formats: ['image/webp'],\n  },\n}</pre></div> <p>You can enable AVIF support with the following configuration.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    formats: ['image/avif', 'image/webp'],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>AVIF generally takes 20% longer to encode but it compresses 20% smaller compared to WebP. This means that the first time an image is requested, it will typically be slower and then subsequent requests that are cached will be faster.</li> <li>If you self-host with a Proxy/CDN in front of Next.js, you must configure the Proxy to forward the <code>Accept</code> header.</li> </ul> </blockquote> <h2 id=\"caching-behavior\" data-docs-heading=\"\">Caching Behavior     </h2> <p>The following describes the caching algorithm for the default <a href=\"#loader\">loader</a>. For all other loaders, please refer to your cloud provider's documentation.</p> <p>Images are optimized dynamically upon request and stored in the <code>&lt;distDir&gt;/cache/images</code> directory. The optimized image file will be served for subsequent requests until the expiration is reached. When a request is made that matches a cached but expired file, the expired image is served stale immediately. Then the image is optimized again in the background (also called revalidation) and saved to the cache with the new expiration date.</p> <p>The cache status of an image can be determined by reading the value of the <code>x-nextjs-cache</code> response header. The possible values are the following:</p> <ul> <li>\n<code>MISS</code> - the path is not in the cache (occurs at most once, on the first visit)</li> <li>\n<code>STALE</code> - the path is in the cache but exceeded the revalidate time so it will be updated in the background</li> <li>\n<code>HIT</code> - the path is in the cache and has not exceeded the revalidate time</li> </ul> <p>The expiration (or rather Max Age) is defined by either the <a href=\"#minimumcachettl\"><code>minimumCacheTTL</code></a> configuration or the upstream image <code>Cache-Control</code> header, whichever is larger. Specifically, the <code>max-age</code> value of the <code>Cache-Control</code> header is used. If both <code>s-maxage</code> and <code>max-age</code> are found, then <code>s-maxage</code> is preferred. The <code>max-age</code> is also passed-through to any downstream clients including CDNs and browsers.</p> <ul> <li>You can configure <a href=\"#minimumcachettl\"><code>minimumCacheTTL</code></a> to increase the cache duration when the upstream image does not include <code>Cache-Control</code> header or the value is very low.</li> <li>You can configure <a href=\"#devicesizes\"><code>deviceSizes</code></a> and <a href=\"#imagesizes\"><code>imageSizes</code></a> to reduce the total number of possible generated images.</li> <li>You can configure <a href=\"#formats\">formats</a> to disable multiple formats in favor of a single image format.</li> </ul> <h3 id=\"minimumcachettl\" data-docs-heading=\"\">minimumCacheTTL     </h3> <p>You can configure the Time to Live (TTL) in seconds for cached optimized images. In many cases, it's better to use a <a href=\"../../../app/building-your-application/optimizing/images#local-images\">Static Image Import</a> which will automatically hash the file contents and cache the image forever with a <code>Cache-Control</code> header of <code>immutable</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    minimumCacheTTL: 60,\n  },\n}</pre></div> <p>The expiration (or rather Max Age) of the optimized image is defined by either the <code>minimumCacheTTL</code> or the upstream image <code>Cache-Control</code> header, whichever is larger.</p> <p>If you need to change the caching behavior per image, you can configure <a href=\"../../../app/api-reference/next-config-js/headers\"><code>headers</code></a> to set the <code>Cache-Control</code> header on the upstream image (e.g. <code>/some-asset.jpg</code>, not <code>/_next/image</code> itself).</p> <p>There is no mechanism to invalidate the cache at this time, so its best to keep <code>minimumCacheTTL</code> low. Otherwise you may need to manually change the <a href=\"#src\"><code>src</code></a> prop or delete <code>&lt;distDir&gt;/cache/images</code>.</p> <h3 id=\"disablestaticimages\" data-docs-heading=\"\">disableStaticImages     </h3> <p>The default behavior allows you to import static files such as <code>import icon from './icon.png'</code> and then pass that to the <code>src</code> property.</p> <p>In some cases, you may wish to disable this feature if it conflicts with other plugins that expect the import to behave differently.</p> <p>You can disable static image imports inside your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    disableStaticImages: true,\n  },\n}</pre></div> <h3 id=\"dangerouslyallowsvg\" data-docs-heading=\"\">dangerouslyAllowSVG     </h3> <p>The default <a href=\"#loader\">loader</a> does not optimize SVG images for a few reasons. First, SVG is a vector format meaning it can be resized losslessly. Second, SVG has many of the same features as HTML/CSS, which can lead to vulnerabilities without proper <a href=\"../../../app/api-reference/next-config-js/headers#content-security-policy\">Content Security Policy (CSP) headers</a>.</p> <p>Therefore, we recommended using the <a href=\"#unoptimized\"><code>unoptimized</code></a> prop when the <a href=\"#src\"><code>src</code></a> prop is known to be SVG. This happens automatically when <code>src</code> ends with <code>\".svg\"</code>.</p> <p>However, if you need to serve SVG images with the default Image Optimization API, you can set <code>dangerouslyAllowSVG</code> inside your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    dangerouslyAllowSVG: true,\n    contentDispositionType: 'attachment',\n    contentSecurityPolicy: \"default-src 'self'; script-src 'none'; sandbox;\",\n  },\n}</pre></div> <p>In addition, it is strongly recommended to also set <code>contentDispositionType</code> to force the browser to download the image, as well as <code>contentSecurityPolicy</code> to prevent scripts embedded in the image from executing.</p> <h2 id=\"animated-images\" data-docs-heading=\"\">Animated Images     </h2> <p>The default <a href=\"#loader\">loader</a> will automatically bypass Image Optimization for animated images and serve the image as-is.</p> <p>Auto-detection for animated files is best-effort and supports GIF, APNG, and WebP. If you want to explicitly bypass Image Optimization for a given animated image, use the <a href=\"#unoptimized\">unoptimized</a> prop.</p> <h2 id=\"responsive-images\" data-docs-heading=\"\">Responsive Images     </h2> <p>The default generated <code>srcset</code> contains <code>1x</code> and <code>2x</code> images in order to support different device pixel ratios. However, you may wish to render a responsive image that stretches with the viewport. In that case, you'll need to set <a href=\"#sizes\"><code>sizes</code></a> as well as <code>style</code> (or <code>className</code>).</p> <p>You can render a responsive image using one of the following methods below.</p> <h3 id=\"responsive-image-using-a-static-import\" data-docs-heading=\"\">Responsive image using a static import     </h3> <p>If the source image is not dynamic, you can statically import to create a responsive image:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport me from '../photos/me.jpg'\n \nexport default function Author() {\n  return (\n    &lt;Image\n      src={me}\n      alt=\"Picture of the author\"\n      sizes=\"100vw\"\n      style={{\n        width: '100%',\n        height: 'auto',\n      }}\n    /&gt;\n  )\n}</pre></div> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/responsive\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the image responsive to viewport</a></li> </ul> <h3 id=\"responsive-image-with-aspect-ratio\" data-docs-heading=\"\">Responsive image with aspect ratio     </h3> <p>If the source image is a dynamic or a remote url, you will also need to provide <code>width</code> and <code>height</code> to set the correct aspect ratio of the responsive image:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page({ photoUrl }) {\n  return (\n    &lt;Image\n      src={photoUrl}\n      alt=\"Picture of the author\"\n      sizes=\"100vw\"\n      style={{\n        width: '100%',\n        height: 'auto',\n      }}\n      width={500}\n      height={300}\n    /&gt;\n  )\n}</pre></div> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/responsive\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the image responsive to viewport</a></li> </ul> <h3 id=\"responsive-image-with-fill\" data-docs-heading=\"\">Responsive image with fill     </h3> <p>If you don't know the aspect ratio, you will need to set the <a href=\"#fill\"><code>fill</code></a> prop and set <code>position: relative</code> on the parent. Optionally, you can set <code>object-fit</code> style depending on the desired stretch vs crop behavior:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nexport default function Page({ photoUrl }) {\n  return (\n    &lt;div style={{ position: 'relative', width: '300px', height: '500px' }}&gt;\n      &lt;Image\n        src={photoUrl}\n        alt=\"Picture of the author\"\n        sizes=\"300px\"\n        fill\n        style={{\n          objectFit: 'contain',\n        }}\n      /&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/fill\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>fill</code> prop</a></li> </ul> <h2 id=\"theme-detection-css\" data-docs-heading=\"\">Theme Detection CSS     </h2> <p>If you want to display a different image for light and dark mode, you can create a new component that wraps two <code>&lt;Image&gt;</code> components and reveals the correct one based on a CSS media query.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.imgDark {\n  display: none;\n}\n \n@media (prefers-color-scheme: dark) {\n  .imgLight {\n    display: none;\n  }\n  .imgDark {\n    display: unset;\n  }\n}</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import styles from './theme-image.module.css'\nimport Image, { ImageProps } from 'next/image'\n \ntype Props = Omit&lt;ImageProps, 'src' | 'priority' | 'loading'&gt; &amp; {\n  srcLight: string\n  srcDark: string\n}\n \nconst ThemeImage = (props: Props) =&gt; {\n  const { srcLight, srcDark, ...rest } = props\n \n  return (\n    &lt;&gt;\n      &lt;Image {...rest} src={srcLight} className={styles.imgLight} /&gt;\n      &lt;Image {...rest} src={srcDark} className={styles.imgDark} /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The default behavior of <code>loading=\"lazy\"</code> ensures that only the correct image is loaded. You cannot use <code>priority</code> or <code>loading=\"eager\"</code> because that would cause both images to load. Instead, you can use <a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/fetchPriority\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>fetchPriority=\"high\"</code></a>.</p> </blockquote> <p>Try it out:</p> <ul> <li><a href=\"https://image-component.nextjs.gallery/theme\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo light/dark mode theme detection</a></li> </ul> <h2 id=\"getimageprops\" data-docs-heading=\"\">getImageProps     </h2> <p>For more advanced use cases, you can call <code>getImageProps()</code> to get the props that would be passed to the underlying <code>&lt;img&gt;</code> element, and instead pass to them to another component, style, canvas, etc.</p> <p>This also avoid calling React <code>useState()</code> so it can lead to better performance, but it cannot be used with the <a href=\"#placeholder\"><code>placeholder</code></a> prop because the placeholder will never be removed.</p> <h3 id=\"theme-detection-picture\" data-docs-heading=\"\">Theme Detection Picture     </h3> <p>If you want to display a different image for light and dark mode, you can use the <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/picture\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>&lt;picture&gt;</code></a> element to display a different image based on the user's <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preferred color scheme</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getImageProps } from 'next/image'\n \nexport default function Page() {\n  const common = { alt: 'Theme Example', width: 800, height: 400 }\n  const {\n    props: { srcSet: dark },\n  } = getImageProps({ ...common, src: '/dark.png' })\n  const {\n    props: { srcSet: light, ...rest },\n  } = getImageProps({ ...common, src: '/light.png' })\n \n  return (\n    &lt;picture&gt;\n      &lt;source media=\"(prefers-color-scheme: dark)\" srcSet={dark} /&gt;\n      &lt;source media=\"(prefers-color-scheme: light)\" srcSet={light} /&gt;\n      &lt;img {...rest} /&gt;\n    &lt;/picture&gt;\n  )\n}</pre></div> <h3 id=\"art-direction\" data-docs-heading=\"\">Art Direction     </h3> <p>If you want to display a different image for mobile and desktop, sometimes called <a href=\"https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images#art_direction\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Art Direction</a>, you can provide different <code>src</code>, <code>width</code>, <code>height</code>, and <code>quality</code> props to <code>getImageProps()</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getImageProps } from 'next/image'\n \nexport default function Home() {\n  const common = { alt: 'Art Direction Example', sizes: '100vw' }\n  const {\n    props: { srcSet: desktop },\n  } = getImageProps({\n    ...common,\n    width: 1440,\n    height: 875,\n    quality: 80,\n    src: '/desktop.jpg',\n  })\n  const {\n    props: { srcSet: mobile, ...rest },\n  } = getImageProps({\n    ...common,\n    width: 750,\n    height: 1334,\n    quality: 70,\n    src: '/mobile.jpg',\n  })\n \n  return (\n    &lt;picture&gt;\n      &lt;source media=\"(min-width: 1000px)\" srcSet={desktop} /&gt;\n      &lt;source media=\"(min-width: 500px)\" srcSet={mobile} /&gt;\n      &lt;img {...rest} style={{ width: '100%', height: 'auto' }} /&gt;\n    &lt;/picture&gt;\n  )\n}</pre></div> <h3 id=\"background-css\" data-docs-heading=\"\">Background CSS     </h3> <p>You can even convert the <code>srcSet</code> string to the <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/image/image-set\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>image-set()</code></a> CSS function to optimize a background image.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { getImageProps } from 'next/image'\n \nfunction getBackgroundImage(srcSet = '') {\n  const imageSet = srcSet\n    .split(', ')\n    .map((str) =&gt; {\n      const [url, dpi] = str.split(' ')\n      return `url(\"${url}\") ${dpi}`\n    })\n    .join(', ')\n  return `image-set(${imageSet})`\n}\n \nexport default function Home() {\n  const {\n    props: { srcSet },\n  } = getImageProps({ alt: '', width: 128, height: 128, src: '/img.png' })\n  const backgroundImage = getBackgroundImage(srcSet)\n  const style = { height: '100vh', width: '100vw', backgroundImage }\n \n  return (\n    &lt;main style={style}&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n    &lt;/main&gt;\n  )\n}</pre></div> <h2 id=\"known-browser-bugs\" data-docs-heading=\"\">Known Browser Bugs     </h2> <p>This <code>next/image</code> component uses browser native <a href=\"https://caniuse.com/loading-lazy-attr\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">lazy loading</a>, which may fallback to eager loading for older browsers before Safari 15.4. When using the blur-up placeholder, older browsers before Safari 12 will fallback to empty placeholder. When using styles with <code>width</code>/<code>height</code> of <code>auto</code>, it is possible to cause <a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Layout Shift</a> on older browsers before Safari 15 that don't <a href=\"https://caniuse.com/mdn-html_elements_img_aspect_ratio_computed_from_attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preserve the aspect ratio</a>. For more details, see <a href=\"https://www.youtube.com/watch?v=4-d_SoCHeWE\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">this MDN video</a>.</p> <ul> <li>\n<a href=\"https://bugs.webkit.org/show_bug.cgi?id=243601\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Safari 15 - 16.3</a> display a gray border while loading. Safari 16.4 <a href=\"https://webkit.org/blog/13966/webkit-features-in-safari-16-4/#:~:text=Now%20in%20Safari%2016.4%2C%20a%20gray%20line%20no%20longer%20appears%20to%20mark%20the%20space%20where%20a%20lazy%2Dloaded%20image%20will%20appear%20once%20it%E2%80%99s%20been%20loaded.\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">fixed this issue</a>. Possible solutions: <ul> <li>Use CSS <code>@supports (font: -apple-system-body) and (-webkit-appearance: none) { img[loading=\"lazy\"] { clip-path: inset(0.6px) } }</code>\n</li> <li>Use <a href=\"#priority\"><code>priority</code></a> if the image is above the fold</li> </ul> </li> <li>\n<a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=1556156\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Firefox 67+</a> displays a white background while loading. Possible solutions: <ul> <li>Enable <a href=\"#formats\">AVIF <code>formats</code></a>\n</li> <li>Use <a href=\"#placeholder\"><code>placeholder</code></a>\n</li> </ul> </li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v14.2.0</code></td>\n<td>\n<code>overrideSrc</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v14.1.0</code></td>\n<td>\n<code>getImageProps()</code> is stable.</td>\n</tr>\n<tr>\n<td><code>v14.0.0</code></td>\n<td>\n<code>onLoadingComplete</code> prop and <code>domains</code> config deprecated.</td>\n</tr>\n<tr>\n<td><code>v13.4.14</code></td>\n<td>\n<code>placeholder</code> prop support for <code>data:/image...</code>\n</td>\n</tr>\n<tr>\n<td><code>v13.2.0</code></td>\n<td>\n<code>contentDispositionType</code> configuration added.</td>\n</tr>\n<tr>\n<td><code>v13.0.6</code></td>\n<td>\n<code>ref</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>The <code>next/image</code> import was renamed to <code>next/legacy/image</code>. The <code>next/future/image</code> import was renamed to <code>next/image</code>. A <a href=\"../../../app/building-your-application/upgrading/codemods#next-image-to-legacy-image\">codemod is available</a> to safely and automatically rename your imports. <code>&lt;span&gt;</code> wrapper removed. <code>layout</code>, <code>objectFit</code>, <code>objectPosition</code>, <code>lazyBoundary</code>, <code>lazyRoot</code> props removed. <code>alt</code> is required. <code>onLoadingComplete</code> receives reference to <code>img</code> element. Built-in loader config removed.</td>\n</tr>\n<tr>\n<td><code>v12.3.0</code></td>\n<td>\n<code>remotePatterns</code> and <code>unoptimized</code> configuration is stable.</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>Experimental <code>remotePatterns</code> and experimental <code>unoptimized</code> configuration added. <code>layout=\"raw\"</code> removed.</td>\n</tr>\n<tr>\n<td><code>v12.1.1</code></td>\n<td>\n<code>style</code> prop added. Experimental support for <code>layout=\"raw\"</code> added.</td>\n</tr>\n<tr>\n<td><code>v12.1.0</code></td>\n<td>\n<code>dangerouslyAllowSVG</code> and <code>contentSecurityPolicy</code> configuration added.</td>\n</tr>\n<tr>\n<td><code>v12.0.9</code></td>\n<td>\n<code>lazyRoot</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>\n<code>formats</code> configuration added.<br>AVIF support added.<br>Wrapper <code>&lt;div&gt;</code> changed to <code>&lt;span&gt;</code>.</td>\n</tr>\n<tr>\n<td><code>v11.1.0</code></td>\n<td>\n<code>onLoadingComplete</code> and <code>lazyBoundary</code> props added.</td>\n</tr>\n<tr>\n<td><code>v11.0.0</code></td>\n<td>\n<code>src</code> prop support for static import.<br><code>placeholder</code> prop added.<br><code>blurDataURL</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v10.0.5</code></td>\n<td>\n<code>loader</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v10.0.1</code></td>\n<td>\n<code>layout</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v10.0.0</code></td>\n<td>\n<code>next/image</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/components/image\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/components/image</a>\n  </p>\n</div>\n","pages/api-reference/functions/get-initial-props":"<h1 class=\"break-words\">getInitialProps</h1>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>getInitialProps</code> is a legacy API. We recommend using <a href=\"../../building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code></a> or <a href=\"../../building-your-application/data-fetching/get-server-side-props\"><code>getServerSideProps</code></a> instead.</p> </blockquote> <p><code>getInitialProps</code> is an <code>async</code> function that can be added to the default exported React component for the page. It will run on both the server-side and again on the client-side during page transitions. The result of the function will be forwarded to the React component as <code>props</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextPageContext } from 'next'\n \nPage.getInitialProps = async (ctx: NextPageContext) =&gt; {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const json = await res.json()\n  return { stars: json.stargazers_count }\n}\n \nexport default function Page({ stars }: { stars: number }) {\n  return stars\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Data returned from <code>getInitialProps</code> is serialized when server rendering. Ensure the returned object from <code>getInitialProps</code> is a plain <code>Object</code>, and not using <code>Date</code>, <code>Map</code> or <code>Set</code>.</li> <li>For the initial page load, <code>getInitialProps</code> will run on the server only. <code>getInitialProps</code> will then also run on the client when navigating to a different route with the <a href=\"../components/link\"><code>next/link</code></a> component or by using <a href=\"use-router\"><code>next/router</code></a>.</li> <li>If <code>getInitialProps</code> is used in a custom <code>_app.js</code>, and the page being navigated to is using <code>getServerSideProps</code>, then <code>getInitialProps</code> will also run on the server.</li> </ul> </blockquote> <h2 id=\"context-object\" data-docs-heading=\"\">Context Object     </h2> <p><code>getInitialProps</code> receives a single argument called <code>context</code>, which is an object with the following properties:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>pathname</code></td>\n<td>Current route, the path of the page in <code>/pages</code>\n</td>\n</tr>\n<tr>\n<td><code>query</code></td>\n<td>Query string of the URL, parsed as an object</td>\n</tr>\n<tr>\n<td><code>asPath</code></td>\n<td>\n<code>String</code> of the actual path (including the query) shown in the browser</td>\n</tr>\n<tr>\n<td><code>req</code></td>\n<td>\n<a href=\"https://nodejs.org/api/http.html#http_class_http_incomingmessage\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP request object</a> (server only)</td>\n</tr>\n<tr>\n<td><code>res</code></td>\n<td>\n<a href=\"https://nodejs.org/api/http.html#http_class_http_serverresponse\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP response object</a> (server only)</td>\n</tr>\n<tr>\n<td><code>err</code></td>\n<td>Error object if any error is encountered during the rendering</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"caveats\" data-docs-heading=\"\">Caveats     </h2> <ul> <li>\n<code>getInitialProps</code> can only be used in <code>pages/</code> top level files, and not in nested components. To have nested data fetching at the component level, consider exploring the <a href=\"../../../app/building-your-application/data-fetching\">App Router</a>.</li> <li>Regardless of whether your route is static or dynamic, any data returned from <code>getInitialProps</code> as <code>props</code> will be able to be examined on the client-side in the initial HTML. This is to allow the page to be <a href=\"https://react.dev/reference/react-dom/hydrate\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">hydrated</a> correctly. Make sure that you don't pass any sensitive information that shouldn't be available on the client in <code>props</code>.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/get-initial-props\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/get-initial-props</a>\n  </p>\n</div>\n","pages/api-reference/functions/get-server-side-props":"<h1 class=\"break-words\">getServerSideProps</h1>\n<p>When exporting a function called <code>getServerSideProps</code> (Server-Side Rendering) from a page, Next.js will pre-render this page on each request using the data returned by <code>getServerSideProps</code>. This is useful if you want to fetch data that changes often, and have the page update to show the most current data.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { InferGetServerSidePropsType, GetServerSideProps } from 'next'\n \ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n \nexport const getServerSideProps = (async () =&gt; {\n  // Fetch data from external API\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo: Repo = await res.json()\n  // Pass data to the page via props\n  return { props: { repo } }\n}) satisfies GetServerSideProps&lt;{ repo: Repo }&gt;\n \nexport default function Page({\n  repo,\n}: InferGetServerSidePropsType&lt;typeof getServerSideProps&gt;) {\n  return (\n    &lt;main&gt;\n      &lt;p&gt;{repo.stargazers_count}&lt;/p&gt;\n    &lt;/main&gt;\n  )\n}</pre></div>  <p>You can import modules in top-level scope for use in <code>getServerSideProps</code>. Imports used will <strong>not be bundled for the client-side</strong>. This means you can write <strong>server-side code directly in <code>getServerSideProps</code></strong>, including fetching data from your database.</p> <h2 id=\"context-parameter\" data-docs-heading=\"\">Context parameter     </h2> <p>The <code>context</code> parameter is an object containing the following keys:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>params</code></td>\n<td>If this page uses a <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route</a>, <code>params</code> contains the route parameters. If the page name is <code>[id].js</code>, then <code>params</code> will look like <code>{ id: ... }</code>.</td>\n</tr>\n<tr>\n<td><code>req</code></td>\n<td>\n<a href=\"https://nodejs.org/api/http.html#http_class_http_incomingmessage\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">The <code>HTTP</code> IncomingMessage object</a>, with an additional <code>cookies</code> prop, which is an object with string keys mapping to string values of cookies.</td>\n</tr>\n<tr>\n<td><code>res</code></td>\n<td>\n<a href=\"https://nodejs.org/api/http.html#http_class_http_serverresponse\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">The <code>HTTP</code> response object</a>.</td>\n</tr>\n<tr>\n<td><code>query</code></td>\n<td>An object representing the query string, including dynamic route parameters.</td>\n</tr>\n<tr>\n<td><code>preview</code></td>\n<td>(Deprecated for <code>draftMode</code>) <code>preview</code> is <code>true</code> if the page is in the <a href=\"../../building-your-application/configuring/preview-mode\">Preview Mode</a> and <code>false</code> otherwise.</td>\n</tr>\n<tr>\n<td><code>previewData</code></td>\n<td>(Deprecated for <code>draftMode</code>) The <a href=\"../../building-your-application/configuring/preview-mode\">preview</a> data set by <code>setPreviewData</code>.</td>\n</tr>\n<tr>\n<td><code>draftMode</code></td>\n<td>\n<code>draftMode</code> is <code>true</code> if the page is in the <a href=\"../../building-your-application/configuring/draft-mode\">Draft Mode</a> and <code>false</code> otherwise.</td>\n</tr>\n<tr>\n<td><code>resolvedUrl</code></td>\n<td>A normalized version of the request <code>URL</code> that strips the <code>_next/data</code> prefix for client transitions and includes original query values.</td>\n</tr>\n<tr>\n<td><code>locale</code></td>\n<td>Contains the active locale (if enabled).</td>\n</tr>\n<tr>\n<td><code>locales</code></td>\n<td>Contains all supported locales (if enabled).</td>\n</tr>\n<tr>\n<td><code>defaultLocale</code></td>\n<td>Contains the configured default locale (if enabled).</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"getserversideprops-return-values\" data-docs-heading=\"\">getServerSideProps return values     </h2> <p>The <code>getServerSideProps</code> function should return an object with <strong>any one of the following</strong> properties:</p> <h3 id=\"props\" data-docs-heading=\"\">props     </h3> <p>The <code>props</code> object is a key-value pair, where each value is received by the page component. It should be a <a href=\"https://developer.mozilla.org/docs/Glossary/Serialization\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">serializable object</a> so that any props passed, could be serialized with <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>JSON.stringify</code></a>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getServerSideProps(context) {\n  return {\n    props: { message: `Next.js is awesome` }, // will be passed to the page component as props\n  }\n}</pre>\n</div> <h3 id=\"notfound\" data-docs-heading=\"\">notFound     </h3> <p>The <code>notFound</code> boolean allows the page to return a <code>404</code> status and <a href=\"../../building-your-application/routing/custom-error#404-page\">404 Page</a>. With <code>notFound: true</code>, the page will return a <code>404</code> even if there was a successfully generated page before. This is meant to support use cases like user-generated content getting removed by its author.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getServerSideProps(context) {\n  const res = await fetch(`https://.../data`)\n  const data = await res.json()\n \n  if (!data) {\n    return {\n      notFound: true,\n    }\n  }\n \n  return {\n    props: { data }, // will be passed to the page component as props\n  }\n}</pre>\n</div> <h3 id=\"redirect\" data-docs-heading=\"\">redirect     </h3> <p>The <code>redirect</code> object allows redirecting to internal and external resources. It should match the shape of <code>{ destination: string, permanent: boolean }</code>. In some rare cases, you might need to assign a custom status code for older <code>HTTP</code> clients to properly redirect. In these cases, you can use the <code>statusCode</code> property instead of the <code>permanent</code> property, but not both.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getServerSideProps(context) {\n  const res = await fetch(`https://.../data`)\n  const data = await res.json()\n \n  if (!data) {\n    return {\n      redirect: {\n        destination: '/',\n        permanent: false,\n      },\n    }\n  }\n \n  return {\n    props: {}, // will be passed to the page component as props\n  }\n}</pre>\n</div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.4.0</code></td>\n<td>\n<a href=\"../../../app/building-your-application/data-fetching\">App Router</a> is now stable with simplified data fetching</td>\n</tr>\n<tr>\n<td><code>v10.0.0</code></td>\n<td>\n<code>locale</code>, <code>locales</code>, <code>defaultLocale</code>, and <code>notFound</code> options added.</td>\n</tr>\n<tr>\n<td><code>v9.3.0</code></td>\n<td>\n<code>getServerSideProps</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/get-server-side-props\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/get-server-side-props</a>\n  </p>\n</div>\n","pages/building-your-application/upgrading/version-13":"<h1 class=\"break-words\">Version 13</h1>\n<h2 id=\"upgrading-from-12-to-13\" data-docs-heading=\"\">Upgrading from 12 to 13     </h2> <p>To update to Next.js version 13, run the following command using your preferred package manager:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i next@13 react@latest react-dom@latest eslint-config-next@13</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add next@13 react@latest react-dom@latest eslint-config-next@13</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm i next@13 react@latest react-dom@latest eslint-config-next@13</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add next@13 react@latest react-dom@latest eslint-config-next@13</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> If you are using TypeScript, ensure you also upgrade <code>@types/react</code> and <code>@types/react-dom</code> to their latest versions.</p> </blockquote> <h3 id=\"v13-summary\" data-docs-heading=\"\">v13 Summary     </h3> <ul> <li>The <a href=\"../../../architecture/supported-browsers\">Supported Browsers</a> have been changed to drop Internet Explorer and target modern browsers.</li> <li>The minimum Node.js version has been bumped from 12.22.0 to 16.14.0, since 12.x and 14.x have reached end-of-life.</li> <li>The minimum React version has been bumped from 17.0.2 to 18.2.0.</li> <li>The <code>swcMinify</code> configuration property was changed from <code>false</code> to <code>true</code>. See <a href=\"../../../architecture/nextjs-compiler\">Next.js Compiler</a> for more info.</li> <li>The <code>next/image</code> import was renamed to <code>next/legacy/image</code>. The <code>next/future/image</code> import was renamed to <code>next/image</code>. A <a href=\"codemods#next-image-to-legacy-image\">codemod is available</a> to safely and automatically rename your imports.</li> <li>The <code>next/link</code> child can no longer be <code>&lt;a&gt;</code>. Add the <code>legacyBehavior</code> prop to use the legacy behavior or remove the <code>&lt;a&gt;</code> to upgrade. A <a href=\"codemods#new-link\">codemod is available</a> to automatically upgrade your code.</li> <li>The <code>target</code> configuration property has been removed and superseded by <a href=\"../../api-reference/next-config-js/output\">Output File Tracing</a>.</li> </ul> <h2 id=\"migrating-shared-features\" data-docs-heading=\"\">Migrating shared features     </h2> <p>Next.js 13 introduces a new <a href=\"../../../app/building-your-application/routing\"><code>app</code> directory</a> with new features and conventions. However, upgrading to Next.js 13 does <strong>not</strong> require using the new <a href=\"../../../app/building-your-application/routing#the-app-router\"><code>app</code> directory</a>.</p> <p>You can continue using <code>pages</code> with new features that work in both directories, such as the updated <a href=\"#image-component\">Image component</a>, <a href=\"#link-component\">Link component</a>, <a href=\"#script-component\">Script component</a>, and <a href=\"#font-optimization\">Font optimization</a>.</p> <h3 id=\"image-component\" data-docs-heading=\"\">&lt;Image/&gt; Component     </h3> <p>Next.js 12 introduced many improvements to the Image Component with a temporary import: <code>next/future/image</code>. These improvements included less client-side JavaScript, easier ways to extend and style images, better accessibility, and native browser lazy loading.</p> <p>Starting in Next.js 13, this new behavior is now the default for <code>next/image</code>.</p> <p>There are two codemods to help you migrate to the new Image Component:</p> <ul> <li>\n<a href=\"codemods#next-image-to-legacy-image\">next-image-to-legacy-image</a>: This codemod will safely and automatically rename <code>next/image</code> imports to <code>next/legacy/image</code> to maintain the same behavior as Next.js 12. We recommend running this codemod to quickly update to Next.js 13 automatically.</li> <li>\n<a href=\"codemods#next-image-experimental\">next-image-experimental</a>: After running the previous codemod, you can optionally run this experimental codemod to upgrade <code>next/legacy/image</code> to the new <code>next/image</code>, which will remove unused props and add inline styles. Please note this codemod is experimental and only covers static usage (such as <code>&lt;Image src={img} layout=\"responsive\" /&gt;</code>) but not dynamic usage (such as <code>&lt;Image {...props} /&gt;</code>).</li> </ul> <p>Alternatively, you can manually update by following the <a href=\"codemods#next-image-experimental\">migration guide</a> and also see the <a href=\"../../api-reference/components/image-legacy#comparison\">legacy comparison</a>.</p> <h3 id=\"link-component\" data-docs-heading=\"\">&lt;Link&gt; Component     </h3> <p>The <a href=\"../../api-reference/components/link\"><code>&lt;Link&gt;</code> Component</a> no longer requires manually adding an <code>&lt;a&gt;</code> tag as a child. This behavior was added as an experimental option in <a href=\"https://nextjs.org/blog/next-12-2\" rel=\"noopener noreferrer\" target=\"_blank\">version 12.2</a> and is now the default. In Next.js 13, <code>&lt;Link&gt;</code> always renders <code>&lt;a&gt;</code> and allows you to forward props to the underlying tag.</p> <p>For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \n// Next.js 12: `&lt;a&gt;` has to be nested otherwise it's excluded\n&lt;Link href=\"/about\"&gt;\n  &lt;a&gt;About&lt;/a&gt;\n&lt;/Link&gt;\n \n// Next.js 13: `&lt;Link&gt;` always renders `&lt;a&gt;` under the hood\n&lt;Link href=\"/about\"&gt;\n  About\n&lt;/Link&gt;</pre>\n</div> <p>To upgrade your links to Next.js 13, you can use the <a href=\"codemods#new-link\"><code>new-link</code> codemod</a>.</p> <h3 id=\"script-component\" data-docs-heading=\"\">&lt;Script&gt; Component     </h3> <p>The behavior of <a href=\"../../api-reference/components/script\"><code>next/script</code></a> has been updated to support both <code>pages</code> and <code>app</code>. If incrementally adopting <code>app</code>, read the <a href=\"../upgrading\">upgrade guide</a>.</p> <h3 id=\"font-optimization\" data-docs-heading=\"\">Font Optimization     </h3> <p>Previously, Next.js helped you optimize fonts by inlining font CSS. Version 13 introduces the new <a href=\"../optimizing/fonts\"><code>next/font</code></a> module which gives you the ability to customize your font loading experience while still ensuring great performance and privacy.</p> <p>See <a href=\"../optimizing/fonts\">Optimizing Fonts</a> to learn how to use <code>next/font</code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/building-your-application/upgrading/version-13\" class=\"_attribution-link\">https://nextjs.org/docs/pages/building-your-application/upgrading/version-13</a>\n  </p>\n</div>\n","pages/api-reference/components/image-legacy":"<h1 class=\"break-words\">&lt;Image&gt; (Legacy)</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/image-legacy-component\" rel=\"noopener noreferrer\" target=\"_blank\">Legacy Image Component</a></li> </ul></details> <p>Starting with Next.js 13, the <code>next/image</code> component was rewritten to improve both the performance and developer experience. In order to provide a backwards compatible upgrade solution, the old <code>next/image</code> was renamed to <code>next/legacy/image</code>.</p> <p>View the <strong>new</strong> <a href=\"image\"><code>next/image</code> API Reference</a></p> <h2 id=\"comparison\" data-docs-heading=\"\">Comparison     </h2> <p>Compared to <code>next/legacy/image</code>, the new <code>next/image</code> component has the following changes:</p> <ul> <li>Removes <code>&lt;span&gt;</code> wrapper around <code>&lt;img&gt;</code> in favor of <a href=\"https://caniuse.com/mdn-html_elements_img_aspect_ratio_computed_from_attributes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">native computed aspect ratio</a>\n</li> <li>Adds support for canonical <code>style</code> prop <ul> <li>Removes <code>layout</code> prop in favor of <code>style</code> or <code>className</code>\n</li> <li>Removes <code>objectFit</code> prop in favor of <code>style</code> or <code>className</code>\n</li> <li>Removes <code>objectPosition</code> prop in favor of <code>style</code> or <code>className</code>\n</li> </ul> </li> <li>Removes <code>IntersectionObserver</code> implementation in favor of <a href=\"https://caniuse.com/loading-lazy-attr\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">native lazy loading</a> <ul> <li>Removes <code>lazyBoundary</code> prop since there is no native equivalent</li> <li>Removes <code>lazyRoot</code> prop since there is no native equivalent</li> </ul> </li> <li>Removes <code>loader</code> config in favor of <a href=\"#loader\"><code>loader</code></a> prop</li> <li>Changed <code>alt</code> prop from optional to required</li> <li>Changed <code>onLoadingComplete</code> callback to receive reference to <code>&lt;img&gt;</code> element</li> </ul> <h2 id=\"required-props\" data-docs-heading=\"\">Required Props     </h2> <p>The <code>&lt;Image /&gt;</code> component requires the following properties.</p> <h3 id=\"src\" data-docs-heading=\"\">src     </h3> <p>Must be one of the following:</p> <ul> <li>A <a href=\"../../building-your-application/optimizing/images#local-images\">statically imported</a> image file</li> <li>A path string. This can be either an absolute external URL, or an internal path depending on the <a href=\"#loader\">loader</a> prop or <a href=\"#loader-configuration\">loader configuration</a>.</li> </ul> <p>When using an external URL, you must add it to <a href=\"#remote-patterns\">remotePatterns</a> in <code>next.config.js</code>.</p> <h3 id=\"width\" data-docs-heading=\"\">width     </h3> <p>The <code>width</code> property can represent either the <em>rendered</em> width or <em>original</em> width in pixels, depending on the <a href=\"#layout\"><code>layout</code></a> and <a href=\"#sizes\"><code>sizes</code></a> properties.</p> <p>When using <code>layout=\"intrinsic\"</code> or <code>layout=\"fixed\"</code> the <code>width</code> property represents the <em>rendered</em> width in pixels, so it will affect how large the image appears.</p> <p>When using <code>layout=\"responsive\"</code>, <code>layout=\"fill\"</code>, the <code>width</code> property represents the <em>original</em> width in pixels, so it will only affect the aspect ratio.</p> <p>The <code>width</code> property is required, except for <a href=\"../../building-your-application/optimizing/images#local-images\">statically imported images</a>, or those with <code>layout=\"fill\"</code>.</p> <h3 id=\"height\" data-docs-heading=\"\">height     </h3> <p>The <code>height</code> property can represent either the <em>rendered</em> height or <em>original</em> height in pixels, depending on the <a href=\"#layout\"><code>layout</code></a> and <a href=\"#sizes\"><code>sizes</code></a> properties.</p> <p>When using <code>layout=\"intrinsic\"</code> or <code>layout=\"fixed\"</code> the <code>height</code> property represents the <em>rendered</em> height in pixels, so it will affect how large the image appears.</p> <p>When using <code>layout=\"responsive\"</code>, <code>layout=\"fill\"</code>, the <code>height</code> property represents the <em>original</em> height in pixels, so it will only affect the aspect ratio.</p> <p>The <code>height</code> property is required, except for <a href=\"../../building-your-application/optimizing/images#local-images\">statically imported images</a>, or those with <code>layout=\"fill\"</code>.</p> <h2 id=\"optional-props\" data-docs-heading=\"\">Optional Props     </h2> <p>The <code>&lt;Image /&gt;</code> component accepts a number of additional properties beyond those which are required. This section describes the most commonly-used properties of the Image component. Find details about more rarely-used properties in the <a href=\"#advanced-props\">Advanced Props</a> section.</p> <h3 id=\"layout\" data-docs-heading=\"\">layout     </h3> <p>The layout behavior of the image as the viewport changes size.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th><code>layout</code></th>\n<th>Behavior</th>\n<th><code>srcSet</code></th>\n<th><code>sizes</code></th>\n<th>Has wrapper and sizer</th>\n</tr></thead>\n<tbody>\n<tr>\n<td>\n<code>intrinsic</code> (default)</td>\n<td>Scale <em>down</em> to fit width of container, up to image size</td>\n<td>\n<code>1x</code>, <code>2x</code> (based on <a href=\"#image-sizes\">imageSizes</a>)</td>\n<td>N/A</td>\n<td>yes</td>\n</tr>\n<tr>\n<td><code>fixed</code></td>\n<td>Sized to <code>width</code> and <code>height</code> exactly</td>\n<td>\n<code>1x</code>, <code>2x</code> (based on <a href=\"#image-sizes\">imageSizes</a>)</td>\n<td>N/A</td>\n<td>yes</td>\n</tr>\n<tr>\n<td><code>responsive</code></td>\n<td>Scale to fit width of container</td>\n<td>\n<code>640w</code>, <code>750w</code>, ... <code>2048w</code>, <code>3840w</code> (based on <a href=\"#image-sizes\">imageSizes</a> and <a href=\"#device-sizes\">deviceSizes</a>)</td>\n<td><code>100vw</code></td>\n<td>yes</td>\n</tr>\n<tr>\n<td><code>fill</code></td>\n<td>Grow in both X and Y axes to fill container</td>\n<td>\n<code>640w</code>, <code>750w</code>, ... <code>2048w</code>, <code>3840w</code> (based on <a href=\"#image-sizes\">imageSizes</a> and <a href=\"#device-sizes\">deviceSizes</a>)</td>\n<td><code>100vw</code></td>\n<td>yes</td>\n</tr>\n</tbody>\n</table></div> <ul> <li>\n<a href=\"https://image-legacy-component.nextjs.gallery/layout-intrinsic\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>intrinsic</code> layout (default)</a> <ul> <li>When <code>intrinsic</code>, the image will scale the dimensions down for smaller viewports, but maintain the original dimensions for larger viewports.</li> </ul> </li> <li>\n<a href=\"https://image-legacy-component.nextjs.gallery/layout-fixed\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>fixed</code> layout</a> <ul> <li>When <code>fixed</code>, the image dimensions will not change as the viewport changes (no responsiveness) similar to the native <code>img</code> element.</li> </ul> </li> <li>\n<a href=\"https://image-legacy-component.nextjs.gallery/layout-responsive\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>responsive</code> layout</a> <ul> <li>When <code>responsive</code>, the image will scale the dimensions down for smaller viewports and scale up for larger viewports.</li> <li>Ensure the parent element uses <code>display: block</code> in their stylesheet.</li> </ul> </li> <li>\n<a href=\"https://image-legacy-component.nextjs.gallery/layout-fill\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>fill</code> layout</a> <ul> <li>When <code>fill</code>, the image will stretch both width and height to the dimensions of the parent element, provided the parent element is relative.</li> <li>This is usually paired with the <a href=\"#objectfit\"><code>objectFit</code></a> property.</li> <li>Ensure the parent element has <code>position: relative</code> in their stylesheet.</li> </ul> </li> <li><a href=\"https://image-legacy-component.nextjs.gallery/background\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo background image</a></li> </ul> <h3 id=\"loader\" data-docs-heading=\"\">loader     </h3> <p>A custom function used to resolve URLs. Setting the loader as a prop on the Image component overrides the default loader defined in the <a href=\"#loader-configuration\"><code>images</code> section of <code>next.config.js</code></a>.</p> <p>A <code>loader</code> is a function returning a URL string for the image, given the following parameters:</p> <ul> <li><a href=\"#src\"><code>src</code></a></li> <li><a href=\"#width\"><code>width</code></a></li> <li><a href=\"#quality\"><code>quality</code></a></li> </ul> <p>Here is an example of using a custom loader:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/legacy/image'\n \nconst myLoader = ({ src, width, quality }) =&gt; {\n  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`\n}\n \nconst MyImage = (props) =&gt; {\n  return (\n    &lt;Image\n      loader={myLoader}\n      src=\"me.png\"\n      alt=\"Picture of the author\"\n      width={500}\n      height={500}\n    /&gt;\n  )\n}</pre>\n</div> <h3 id=\"sizes\" data-docs-heading=\"\">sizes     </h3> <p>A string that provides information about how wide the image will be at different breakpoints. The value of <code>sizes</code> will greatly affect performance for images using <code>layout=\"responsive\"</code> or <code>layout=\"fill\"</code>. It will be ignored for images using <code>layout=\"intrinsic\"</code> or <code>layout=\"fixed\"</code>.</p> <p>The <code>sizes</code> property serves two important purposes related to image performance:</p> <p>First, the value of <code>sizes</code> is used by the browser to determine which size of the image to download, from <code>next/legacy/image</code>'s automatically-generated source set. When the browser chooses, it does not yet know the size of the image on the page, so it selects an image that is the same size or larger than the viewport. The <code>sizes</code> property allows you to tell the browser that the image will actually be smaller than full screen. If you don't specify a <code>sizes</code> value, a default value of <code>100vw</code> (full screen width) is used.</p> <p>Second, the <code>sizes</code> value is parsed and used to trim the values in the automatically-created source set. If the <code>sizes</code> property includes sizes such as <code>50vw</code>, which represent a percentage of the viewport width, then the source set is trimmed to not include any values which are too small to ever be necessary.</p> <p>For example, if you know your styling will cause an image to be full-width on mobile devices, in a 2-column layout on tablets, and a 3-column layout on desktop displays, you should include a sizes property such as the following:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/legacy/image'\nconst Example = () =&gt; (\n  &lt;div className=\"grid-element\"&gt;\n    &lt;Image\n      src=\"/example.png\"\n      layout=\"fill\"\n      sizes=\"(max-width: 768px) 100vw,\n              (max-width: 1200px) 50vw,\n              33vw\"\n    /&gt;\n  &lt;/div&gt;\n)</pre>\n</div> <p>This example <code>sizes</code> could have a dramatic effect on performance metrics. Without the <code>33vw</code> sizes, the image selected from the server would be 3 times as wide as it needs to be. Because file size is proportional to the square of the width, without <code>sizes</code> the user would download an image that's 9 times larger than necessary.</p> <p>Learn more about <code>srcset</code> and <code>sizes</code>:</p> <ul> <li><a href=\"https://web.dev/learn/design/responsive-images/#sizes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">web.dev</a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/img#attr-sizes\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">mdn</a></li> </ul> <h3 id=\"quality\" data-docs-heading=\"\">quality     </h3> <p>The quality of the optimized image, an integer between <code>1</code> and <code>100</code> where <code>100</code> is the best quality. Defaults to <code>75</code>.</p> <h3 id=\"priority\" data-docs-heading=\"\">priority     </h3> <p>When true, the image will be considered high priority and <a href=\"https://web.dev/preload-responsive-images/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">preload</a>. Lazy loading is automatically disabled for images using <code>priority</code>.</p> <p>You should use the <code>priority</code> property on any image detected as the <a href=\"https://nextjs.org/learn/seo/web-performance/lcp\" rel=\"noopener noreferrer\" target=\"_blank\">Largest Contentful Paint (LCP)</a> element. It may be appropriate to have multiple priority images, as different images may be the LCP element for different viewport sizes.</p> <p>Should only be used when the image is visible above the fold. Defaults to <code>false</code>.</p> <h3 id=\"placeholder\" data-docs-heading=\"\">placeholder     </h3> <p>A placeholder to use while the image is loading. Possible values are <code>blur</code> or <code>empty</code>. Defaults to <code>empty</code>.</p> <p>When <code>blur</code>, the <a href=\"#blurdataurl\"><code>blurDataURL</code></a> property will be used as the placeholder. If <code>src</code> is an object from a <a href=\"../../building-your-application/optimizing/images#local-images\">static import</a> and the imported image is <code>.jpg</code>, <code>.png</code>, <code>.webp</code>, or <code>.avif</code>, then <code>blurDataURL</code> will be automatically populated.</p> <p>For dynamic images, you must provide the <a href=\"#blurdataurl\"><code>blurDataURL</code></a> property. Solutions such as <a href=\"https://github.com/joe-bell/plaiceholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Plaiceholder</a> can help with <code>base64</code> generation.</p> <p>When <code>empty</code>, there will be no placeholder while the image is loading, only empty space.</p> <p>Try it out:</p> <ul> <li><a href=\"https://image-legacy-component.nextjs.gallery/placeholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the <code>blur</code> placeholder</a></li> <li><a href=\"https://image-legacy-component.nextjs.gallery/shimmer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the shimmer effect with <code>blurDataURL</code> prop</a></li> <li><a href=\"https://image-legacy-component.nextjs.gallery/color\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the color effect with <code>blurDataURL</code> prop</a></li> </ul> <h2 id=\"advanced-props\" data-docs-heading=\"\">Advanced Props     </h2> <p>In some cases, you may need more advanced usage. The <code>&lt;Image /&gt;</code> component optionally accepts the following advanced properties.</p> <h3 id=\"style\" data-docs-heading=\"\">style     </h3> <p>Allows <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/style\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">passing CSS styles</a> to the underlying image element.</p> <p>Note that all <code>layout</code> modes apply their own styles to the image element, and these automatic styles take precedence over the <code>style</code> prop.</p> <p>Also keep in mind that the required <code>width</code> and <code>height</code> props can interact with your styling. If you use styling to modify an image's <code>width</code>, you must set the <code>height=\"auto\"</code> style as well, or your image will be distorted.</p> <h3 id=\"objectfit\" data-docs-heading=\"\">objectFit     </h3> <p>Defines how the image will fit into its parent container when using <code>layout=\"fill\"</code>.</p> <p>This value is passed to the <a href=\"https://developer.mozilla.org/docs/Web/CSS/object-fit\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">object-fit CSS property</a> for the <code>src</code> image.</p> <h3 id=\"objectposition\" data-docs-heading=\"\">objectPosition     </h3> <p>Defines how the image is positioned within its parent element when using <code>layout=\"fill\"</code>.</p> <p>This value is passed to the <a href=\"https://developer.mozilla.org/docs/Web/CSS/object-position\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">object-position CSS property</a> applied to the image.</p> <h3 id=\"onloadingcomplete\" data-docs-heading=\"\">onLoadingComplete     </h3> <p>A callback function that is invoked once the image is completely loaded and the <a href=\"#placeholder\">placeholder</a> has been removed.</p> <p>The <code>onLoadingComplete</code> function accepts one parameter, an object with the following properties:</p> <ul> <li><a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/naturalWidth\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>naturalWidth</code></a></li> <li><a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/naturalHeight\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>naturalHeight</code></a></li> </ul> <h3 id=\"loading\" data-docs-heading=\"\">loading     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Attention</strong>: This property is only meant for advanced usage. Switching an image to load with <code>eager</code> will normally <strong>hurt performance</strong>.</p> <p>We recommend using the <a href=\"#priority\"><code>priority</code></a> property instead, which properly loads the image eagerly for nearly all use cases.</p> </blockquote> <p>The loading behavior of the image. Defaults to <code>lazy</code>.</p> <p>When <code>lazy</code>, defer loading the image until it reaches a calculated distance from the viewport.</p> <p>When <code>eager</code>, load the image immediately.</p> <p><a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/img#attr-loading\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Learn more</a></p> <h3 id=\"blurdataurl\" data-docs-heading=\"\">blurDataURL     </h3> <p>A <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Basics_of_HTTP/Data_URIs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Data URL</a> to be used as a placeholder image before the <code>src</code> image successfully loads. Only takes effect when combined with <a href=\"#placeholder\"><code>placeholder=\"blur\"</code></a>.</p> <p>Must be a base64-encoded image. It will be enlarged and blurred, so a very small image (10px or less) is recommended. Including larger images as placeholders may harm your application performance.</p> <p>Try it out:</p> <ul> <li><a href=\"https://image-legacy-component.nextjs.gallery/placeholder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the default <code>blurDataURL</code> prop</a></li> <li><a href=\"https://image-legacy-component.nextjs.gallery/shimmer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the shimmer effect with <code>blurDataURL</code> prop</a></li> <li><a href=\"https://image-legacy-component.nextjs.gallery/color\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Demo the color effect with <code>blurDataURL</code> prop</a></li> </ul> <p>You can also <a href=\"https://png-pixel.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">generate a solid color Data URL</a> to match the image.</p> <h3 id=\"lazyboundary\" data-docs-heading=\"\">lazyBoundary     </h3> <p>A string (with similar syntax to the margin property) that acts as the bounding box used to detect the intersection of the viewport with the image and trigger lazy <a href=\"#loading\">loading</a>. Defaults to <code>\"200px\"</code>.</p> <p>If the image is nested in a scrollable parent element other than the root document, you will also need to assign the <a href=\"#lazyroot\">lazyRoot</a> prop.</p> <p><a href=\"https://developer.mozilla.org/docs/Web/API/IntersectionObserver/rootMargin\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Learn more</a></p> <h3 id=\"lazyroot\" data-docs-heading=\"\">lazyRoot     </h3> <p>A React <a href=\"https://react.dev/learn/referencing-values-with-refs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Ref</a> pointing to the scrollable parent element. Defaults to <code>null</code> (the document viewport).</p> <p>The Ref must point to a DOM element or a React component that <a href=\"https://react.dev/reference/react/forwardRef\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">forwards the Ref</a> to the underlying DOM element.</p> <p><strong>Example pointing to a DOM element</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/legacy/image'\nimport React from 'react'\n \nconst Example = () =&gt; {\n  const lazyRoot = React.useRef(null)\n \n  return (\n    &lt;div ref={lazyRoot} style={{ overflowX: 'scroll', width: '500px' }}&gt;\n      &lt;Image lazyRoot={lazyRoot} src=\"/one.jpg\" width=\"500\" height=\"500\" /&gt;\n      &lt;Image lazyRoot={lazyRoot} src=\"/two.jpg\" width=\"500\" height=\"500\" /&gt;\n    &lt;/div&gt;\n  )\n}</pre>\n</div> <p><strong>Example pointing to a React component</strong></p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/legacy/image'\nimport React from 'react'\n \nconst Container = React.forwardRef((props, ref) =&gt; {\n  return (\n    &lt;div ref={ref} style={{ overflowX: 'scroll', width: '500px' }}&gt;\n      {props.children}\n    &lt;/div&gt;\n  )\n})\n \nconst Example = () =&gt; {\n  const lazyRoot = React.useRef(null)\n \n  return (\n    &lt;Container ref={lazyRoot}&gt;\n      &lt;Image lazyRoot={lazyRoot} src=\"/one.jpg\" width=\"500\" height=\"500\" /&gt;\n      &lt;Image lazyRoot={lazyRoot} src=\"/two.jpg\" width=\"500\" height=\"500\" /&gt;\n    &lt;/Container&gt;\n  )\n}</pre>\n</div> <p><a href=\"https://developer.mozilla.org/docs/Web/API/IntersectionObserver/root\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Learn more</a></p> <h3 id=\"unoptimized\" data-docs-heading=\"\">unoptimized     </h3> <p>When true, the source image will be served as-is instead of changing quality, size, or format. Defaults to <code>false</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nconst UnoptimizedImage = (props) =&gt; {\n  return &lt;Image {...props} unoptimized /&gt;\n}</pre>\n</div> <p>Since Next.js 12.3.0, this prop can be assigned to all images by updating <code>next.config.js</code> with the following configuration:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    unoptimized: true,\n  },\n}</pre></div> <h2 id=\"other-props\" data-docs-heading=\"\">Other Props     </h2> <p>Other properties on the <code>&lt;Image /&gt;</code> component will be passed to the underlying <code>img</code> element with the exception of the following:</p> <ul> <li>\n<code>srcSet</code>. Use <a href=\"#device-sizes\">Device Sizes</a> instead.</li> <li>\n<code>ref</code>. Use <a href=\"#onloadingcomplete\"><code>onLoadingComplete</code></a> instead.</li> <li>\n<code>decoding</code>. It is always <code>\"async\"</code>.</li> </ul> <h2 id=\"configuration-options\" data-docs-heading=\"\">Configuration Options     </h2> <h3 id=\"remote-patterns\" data-docs-heading=\"\">Remote Patterns     </h3> <p>To protect your application from malicious users, configuration is required in order to use external images. This ensures that only external images from your account can be served from the Next.js Image Optimization API. These external images can be configured with the <code>remotePatterns</code> property in your <code>next.config.js</code> file, as shown below:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: 'example.com',\n        port: '',\n        pathname: '/account123/**',\n      },\n    ],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The example above will ensure the <code>src</code> property of <code>next/legacy/image</code> must start with <code>https://example.com/account123/</code>. Any other protocol, hostname, port, or unmatched path will respond with 400 Bad Request.</p> </blockquote> <p>Below is another example of the <code>remotePatterns</code> property in the <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    remotePatterns: [\n      {\n        protocol: 'https',\n        hostname: '**.example.com',\n        port: '',\n      },\n    ],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The example above will ensure the <code>src</code> property of <code>next/legacy/image</code> must start with <code>https://img1.example.com</code> or <code>https://me.avatar.example.com</code> or any number of subdomains. Any other protocol, port, or unmatched hostname will respond with 400 Bad Request.</p> </blockquote> <p>Wildcard patterns can be used for both <code>pathname</code> and <code>hostname</code> and have the following syntax:</p> <ul> <li>\n<code>*</code> match a single path segment or subdomain</li> <li>\n<code>**</code> match any number of path segments at the end or subdomains at the beginning</li> </ul> <p>The <code>**</code> syntax does not work in the middle of the pattern.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: When omitting <code>protocol</code>, <code>port</code> or <code>pathname</code>, then the wildcard <code>**</code> is implied. This is not recommended because it may allow malicious actors to optimize urls you did not intend.</p> </blockquote> <h3 id=\"domains\" data-docs-heading=\"\">Domains     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: Deprecated since Next.js 14 in favor of strict <a href=\"#remote-patterns\"><code>remotePatterns</code></a> in order to protect your application from malicious users. Only use <code>domains</code> if you own all the content served from the domain.</p> </blockquote> <p>Similar to <a href=\"#remote-patterns\"><code>remotePatterns</code></a>, the <code>domains</code> configuration can be used to provide a list of allowed hostnames for external images.</p> <p>However, the <code>domains</code> configuration does not support wildcard pattern matching and it cannot restrict protocol, port, or pathname.</p> <p>Below is an example of the <code>domains</code> property in the <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    domains: ['assets.acme.com'],\n  },\n}</pre></div> <h3 id=\"loader-configuration\" data-docs-heading=\"\">Loader Configuration     </h3> <p>If you want to use a cloud provider to optimize images instead of using the Next.js built-in Image Optimization API, you can configure the <code>loader</code> and <code>path</code> prefix in your <code>next.config.js</code> file. This allows you to use relative URLs for the Image <a href=\"#src\"><code>src</code></a> and automatically generate the correct absolute URL for your provider.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    loader: 'imgix',\n    path: 'https://example.com/myaccount/',\n  },\n}</pre></div> <h3 id=\"built-in-loaders\" data-docs-heading=\"\">Built-in Loaders     </h3> <p>The following Image Optimization cloud providers are included:</p> <ul> <li>Default: Works automatically with <code>next dev</code>, <code>next start</code>, or a custom server</li> <li>\n<a href=\"https://vercel.com\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>: Works automatically when you deploy on Vercel, no configuration necessary. <a href=\"https://vercel.com/docs/concepts/image-optimization?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Learn more</a>\n</li> <li>\n<a href=\"https://www.imgix.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Imgix</a>: <code>loader: 'imgix'</code>\n</li> <li>\n<a href=\"https://cloudinary.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cloudinary</a>: <code>loader: 'cloudinary'</code>\n</li> <li>\n<a href=\"https://www.akamai.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Akamai</a>: <code>loader: 'akamai'</code>\n</li> <li>Custom: <code>loader: 'custom'</code> use a custom cloud provider by implementing the <a href=\"#loader\"><code>loader</code></a> prop on the <code>next/legacy/image</code> component</li> </ul> <p>If you need a different provider, you can use the <a href=\"#loader\"><code>loader</code></a> prop with <code>next/legacy/image</code>.</p> <blockquote class=\"p-3 text-sm\"> <p>Images can not be optimized at build time using <a href=\"../../building-your-application/deploying/static-exports\"><code>output: 'export'</code></a>, only on-demand. To use <code>next/legacy/image</code> with <code>output: 'export'</code>, you will need to use a different loader than the default. <a href=\"https://github.com/vercel/next.js/discussions/19065\" rel=\"noopener noreferrer\" target=\"_blank\">Read more in the discussion.</a></p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p>The <code>next/legacy/image</code> component's default loader uses <a href=\"https://www.npmjs.com/package/@squoosh/lib\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>squoosh</code></a> because it is quick to install and suitable for a development environment. When using <code>next start</code> in your production environment, it is strongly recommended that you install <a href=\"https://www.npmjs.com/package/sharp\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>sharp</code></a> by running <code>npm i sharp</code> in your project directory. This is not necessary for Vercel deployments, as <code>sharp</code> is installed automatically.</p> </blockquote> <h2 id=\"advanced\" data-docs-heading=\"\">Advanced     </h2> <p>The following configuration is for advanced use cases and is usually not necessary. If you choose to configure the properties below, you will override any changes to the Next.js defaults in future updates.</p> <h3 id=\"device-sizes\" data-docs-heading=\"\">Device Sizes     </h3> <p>If you know the expected device widths of your users, you can specify a list of device width breakpoints using the <code>deviceSizes</code> property in <code>next.config.js</code>. These widths are used when the <code>next/legacy/image</code> component uses <code>layout=\"responsive\"</code> or <code>layout=\"fill\"</code> to ensure the correct image is served for user's device.</p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],\n  },\n}</pre></div> <h3 id=\"image-sizes\" data-docs-heading=\"\">Image Sizes     </h3> <p>You can specify a list of image widths using the <code>images.imageSizes</code> property in your <code>next.config.js</code> file. These widths are concatenated with the array of <a href=\"#device-sizes\">device sizes</a> to form the full array of sizes used to generate image <a href=\"https://developer.mozilla.org/docs/Web/API/HTMLImageElement/srcset\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">srcset</a>s.</p> <p>The reason there are two separate lists is that imageSizes is only used for images which provide a <a href=\"#sizes\"><code>sizes</code></a> prop, which indicates that the image is less than the full width of the screen. <strong>Therefore, the sizes in imageSizes should all be smaller than the smallest size in deviceSizes.</strong></p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],\n  },\n}</pre></div> <h3 id=\"acceptable-formats\" data-docs-heading=\"\">Acceptable Formats     </h3> <p>The default <a href=\"#loader-configuration\">Image Optimization API</a> will automatically detect the browser's supported image formats via the request's <code>Accept</code> header.</p> <p>If the <code>Accept</code> head matches more than one of the configured formats, the first match in the array is used. Therefore, the array order matters. If there is no match (or the source image is <a href=\"#animated-images\">animated</a>), the Image Optimization API will fallback to the original image's format.</p> <p>If no configuration is provided, the default below is used.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    formats: ['image/webp'],\n  },\n}</pre></div> <p>You can enable AVIF support with the following configuration.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    formats: ['image/avif', 'image/webp'],\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: AVIF generally takes 20% longer to encode but it compresses 20% smaller compared to WebP. This means that the first time an image is requested, it will typically be slower and then subsequent requests that are cached will be faster.</p> </blockquote> <h2 id=\"caching-behavior\" data-docs-heading=\"\">Caching Behavior     </h2> <p>The following describes the caching algorithm for the default <a href=\"#loader\">loader</a>. For all other loaders, please refer to your cloud provider's documentation.</p> <p>Images are optimized dynamically upon request and stored in the <code>&lt;distDir&gt;/cache/images</code> directory. The optimized image file will be served for subsequent requests until the expiration is reached. When a request is made that matches a cached but expired file, the expired image is served stale immediately. Then the image is optimized again in the background (also called revalidation) and saved to the cache with the new expiration date.</p> <p>The cache status of an image can be determined by reading the value of the <code>x-nextjs-cache</code> (<code>x-vercel-cache</code> when deployed on Vercel) response header. The possible values are the following:</p> <ul> <li>\n<code>MISS</code> - the path is not in the cache (occurs at most once, on the first visit)</li> <li>\n<code>STALE</code> - the path is in the cache but exceeded the revalidate time so it will be updated in the background</li> <li>\n<code>HIT</code> - the path is in the cache and has not exceeded the revalidate time</li> </ul> <p>The expiration (or rather Max Age) is defined by either the <a href=\"#minimum-cache-ttl\"><code>minimumCacheTTL</code></a> configuration or the upstream image <code>Cache-Control</code> header, whichever is larger. Specifically, the <code>max-age</code> value of the <code>Cache-Control</code> header is used. If both <code>s-maxage</code> and <code>max-age</code> are found, then <code>s-maxage</code> is preferred. The <code>max-age</code> is also passed-through to any downstream clients including CDNs and browsers.</p> <ul> <li>You can configure <a href=\"#minimum-cache-ttl\"><code>minimumCacheTTL</code></a> to increase the cache duration when the upstream image does not include <code>Cache-Control</code> header or the value is very low.</li> <li>You can configure <a href=\"#device-sizes\"><code>deviceSizes</code></a> and <a href=\"#image-sizes\"><code>imageSizes</code></a> to reduce the total number of possible generated images.</li> <li>You can configure <a href=\"#acceptable-formats\">formats</a> to disable multiple formats in favor of a single image format.</li> </ul> <h3 id=\"minimum-cache-ttl\" data-docs-heading=\"\">Minimum Cache TTL     </h3> <p>You can configure the Time to Live (TTL) in seconds for cached optimized images. In many cases, it's better to use a <a href=\"../../building-your-application/optimizing/images#local-images\">Static Image Import</a> which will automatically hash the file contents and cache the image forever with a <code>Cache-Control</code> header of <code>immutable</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    minimumCacheTTL: 60,\n  },\n}</pre></div> <p>The expiration (or rather Max Age) of the optimized image is defined by either the <code>minimumCacheTTL</code> or the upstream image <code>Cache-Control</code> header, whichever is larger.</p> <p>If you need to change the caching behavior per image, you can configure <a href=\"../next-config-js/headers\"><code>headers</code></a> to set the <code>Cache-Control</code> header on the upstream image (e.g. <code>/some-asset.jpg</code>, not <code>/_next/image</code> itself).</p> <p>There is no mechanism to invalidate the cache at this time, so its best to keep <code>minimumCacheTTL</code> low. Otherwise you may need to manually change the <a href=\"#src\"><code>src</code></a> prop or delete <code>&lt;distDir&gt;/cache/images</code>.</p> <h3 id=\"disable-static-imports\" data-docs-heading=\"\">Disable Static Imports     </h3> <p>The default behavior allows you to import static files such as <code>import icon from './icon.png'</code> and then pass that to the <code>src</code> property.</p> <p>In some cases, you may wish to disable this feature if it conflicts with other plugins that expect the import to behave differently.</p> <p>You can disable static image imports inside your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    disableStaticImages: true,\n  },\n}</pre></div> <h3 id=\"dangerously-allow-svg\" data-docs-heading=\"\">Dangerously Allow SVG     </h3> <p>The default <a href=\"#loader\">loader</a> does not optimize SVG images for a few reasons. First, SVG is a vector format meaning it can be resized losslessly. Second, SVG has many of the same features as HTML/CSS, which can lead to vulnerabilities without proper <a href=\"../../../app/api-reference/next-config-js/headers#content-security-policy\">Content Security Policy (CSP) headers</a>.</p> <p>Therefore, we recommended using the <a href=\"#unoptimized\"><code>unoptimized</code></a> prop when the <a href=\"#src\"><code>src</code></a> prop is known to be SVG. This happens automatically when <code>src</code> ends with <code>\".svg\"</code>.</p> <p>However, if you need to serve SVG images with the default Image Optimization API, you can set <code>dangerouslyAllowSVG</code> inside your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    dangerouslyAllowSVG: true,\n    contentDispositionType: 'attachment',\n    contentSecurityPolicy: \"default-src 'self'; script-src 'none'; sandbox;\",\n  },\n}</pre></div> <p>In addition, it is strongly recommended to also set <code>contentDispositionType</code> to force the browser to download the image, as well as <code>contentSecurityPolicy</code> to prevent scripts embedded in the image from executing.</p> <h3 id=\"animated-images\" data-docs-heading=\"\">Animated Images     </h3> <p>The default <a href=\"#loader\">loader</a> will automatically bypass Image Optimization for animated images and serve the image as-is.</p> <p>Auto-detection for animated files is best-effort and supports GIF, APNG, and WebP. If you want to explicitly bypass Image Optimization for a given animated image, use the <a href=\"#unoptimized\">unoptimized</a> prop.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>next/image</code> renamed to <code>next/legacy/image</code>\n</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/components/image-legacy\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/components/image-legacy</a>\n  </p>\n</div>\n","pages/api-reference/components/link":"<h1 class=\"break-words\">&lt;Link&gt;</h1> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/hello-world\" rel=\"noopener noreferrer\" target=\"_blank\">Hello World</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/active-class-name\" rel=\"noopener noreferrer\" target=\"_blank\">Active className on Link</a></li> </ul></details> <p><code>&lt;Link&gt;</code> is a React component that extends the HTML <code>&lt;a&gt;</code> element to provide <a href=\"../../../app/building-your-application/routing/linking-and-navigating#2-prefetching\">prefetching</a> and client-side navigation between routes. It is the primary way to navigate between routes in Next.js.</p>  <p>For an example, consider a <code>pages</code> directory with the following files:</p>\n<ul> <li><code>pages/index.js</code></li> <li><code>pages/about.js</code></li> <li><code>pages/blog/[slug].js</code></li> </ul>\n<p>We can have a link to each of these pages like so:</p>\n<div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Home() {\n  return (\n    &lt;ul&gt;\n      &lt;li&gt;\n        &lt;Link href=\"/\"&gt;Home&lt;/Link&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;Link href=\"/about\"&gt;About Us&lt;/Link&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;Link href=\"/blog/hello-world\"&gt;Blog Post&lt;/Link&gt;\n      &lt;/li&gt;\n    &lt;/ul&gt;\n  )\n}\n \nexport default Home</pre>\n</div> <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <p>Here's a summary of the props available for the Link Component:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Prop</th>\n<th>Example</th>\n<th>Type</th>\n<th>Required</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#href-required\"><code>href</code></a></td>\n<td><code>href=\"/dashboard\"</code></td>\n<td>String or Object</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><a href=\"#replace\"><code>replace</code></a></td>\n<td><code>replace={false}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#scroll\"><code>scroll</code></a></td>\n<td><code>scroll={false}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#prefetch\"><code>prefetch</code></a></td>\n<td><code>prefetch={false}</code></td>\n<td>Boolean</td>\n<td>-</td>\n</tr>\n</tbody>\n</table></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>&lt;a&gt;</code> tag attributes such as <code>className</code> or <code>target=\"_blank\"</code> can be added to <code>&lt;Link&gt;</code> as props and will be passed to the underlying <code>&lt;a&gt;</code> element.</p> </blockquote> <h3 id=\"href-required\" data-docs-heading=\"\">href (required)     </h3> <p>The path or URL to navigate to.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/dashboard\"&gt;Dashboard&lt;/Link&gt;</pre>\n</div> <p><code>href</code> can also accept an object, for example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Navigate to /about?name=test\n&lt;Link\n  href={{\n    pathname: '/about',\n    query: { name: 'test' },\n  }}\n&gt;\n  About\n&lt;/Link&gt;</pre>\n</div> <h3 id=\"replace\" data-docs-heading=\"\">replace     </h3> <p><strong>Defaults to <code>false</code>.</strong> When <code>true</code>, <code>next/link</code> will replace the current history state instead of adding a new URL into the <a href=\"https://developer.mozilla.org/docs/Web/API/History_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">browsers history</a> stack.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;Link href=\"/dashboard\" replace&gt;\n      Dashboard\n    &lt;/Link&gt;\n  )\n}</pre></div>  <h3 id=\"scroll\" data-docs-heading=\"\">scroll     </h3> <p><strong>Defaults to <code>true</code>.</strong> The default behavior of <code>&lt;Link&gt;</code> <strong>is to scroll to the top of a new route or to maintain the scroll position for backwards and forwards navigation.</strong> When <code>false</code>, <code>next/link</code> will <em>not</em> scroll to the top of the page after a navigation.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;Link href=\"/dashboard\" scroll={false}&gt;\n      Dashboard\n    &lt;/Link&gt;\n  )\n}</pre></div>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>Next.js will scroll to the <a href=\"../../../app/building-your-application/routing/pages-and-layouts#pages\">Page</a> if it is not visible in the viewport upon navigation.</li> </ul> </blockquote> <h3 id=\"prefetch\" data-docs-heading=\"\">prefetch     </h3>  <p>Prefetching happens when a <code>&lt;Link /&gt;</code> component enters the user's viewport (initially or through scroll). Next.js prefetches and loads the linked route (denoted by the <code>href</code>) and data in the background to improve the performance of client-side navigations. Prefetching is only enabled in production.</p>\n<ul> <li>\n<strong><code>true</code> (default)</strong>: The full route and its data will be prefetched.</li> <li>\n<code>false</code>: Prefetching will not happen when entering the viewport, but will happen on hover. If you want to completely remove fetching on hover as well, consider using an <code>&lt;a&gt;</code> tag or <a href=\"../../../app/building-your-application/upgrading/app-router-migration\">incrementally adopting</a> the App Router, which enables disabling prefetching on hover too.</li> </ul>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return (\n    &lt;Link href=\"/dashboard\" prefetch={false}&gt;\n      Dashboard\n    &lt;/Link&gt;\n  )\n}</pre></div>\n<h2 id=\"other-props\" data-docs-heading=\"\">Other Props     </h2>\n<h3 id=\"legacybehavior\" data-docs-heading=\"\">legacyBehavior     </h3>\n<p>An <code>&lt;a&gt;</code> element is no longer required as a child of <code>&lt;Link&gt;</code>. Add the <code>legacyBehavior</code> prop to use the legacy behavior or remove the <code>&lt;a&gt;</code> to upgrade. A <a href=\"../../../app/building-your-application/upgrading/codemods#new-link\">codemod is available</a> to automatically upgrade your code.</p>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: when <code>legacyBehavior</code> is not set to <code>true</code>, all <a href=\"https://developer.mozilla.org/docs/Web/HTML/Element/a\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>anchor</code></a> tag properties can be passed to <code>next/link</code> as well such as, <code>className</code>, <code>onClick</code>, etc.</p> </blockquote>\n<h3 id=\"passhref\" data-docs-heading=\"\">passHref     </h3>\n<p>Forces <code>Link</code> to send the <code>href</code> property to its child. Defaults to <code>false</code></p>\n<h3 id=\"scroll-1\" data-docs-heading=\"\">scroll     </h3>\n<p>Scroll to the top of the page after a navigation. Defaults to <code>true</code></p>\n<h3 id=\"shallow\" data-docs-heading=\"\">shallow     </h3>\n<p>Update the path of the current page without rerunning <a href=\"../../building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code></a>, <a href=\"../../building-your-application/data-fetching/get-server-side-props\"><code>getServerSideProps</code></a> or <a href=\"../functions/get-initial-props\"><code>getInitialProps</code></a>. Defaults to <code>false</code></p>\n<h3 id=\"locale\" data-docs-heading=\"\">locale     </h3>\n<p>The active locale is automatically prepended. <code>locale</code> allows for providing a different locale. When <code>false</code> <code>href</code> has to include the locale as the default behavior is disabled.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"linking-to-dynamic-routes\" data-docs-heading=\"\">Linking to Dynamic Routes     </h3> <p>For dynamic routes, it can be handy to use template literals to create the link's path.</p> <p>For example, you can generate a list of links to the dynamic route <code>pages/blog/[slug].js</code></p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Posts({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li key={post.id}&gt;\n          &lt;Link href={`/blog/${post.slug}`}&gt;{post.title}&lt;/Link&gt;\n        &lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}\n \nexport default Posts</pre></div>  <h3 id=\"if-the-child-is-a-custom-component-that-wraps-an-a-tag\" data-docs-heading=\"\">If the child is a custom component that wraps an &lt;a&gt; tag     </h3>  <p>If the child of <code>Link</code> is a custom component that wraps an <code>&lt;a&gt;</code> tag, you must add <code>passHref</code> to <code>Link</code>. This is necessary if youre using libraries like <a href=\"https://styled-components.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">styled-components</a>. Without this, the <code>&lt;a&gt;</code> tag will not have the <code>href</code> attribute, which hurts your site's accessibility and might affect SEO. If you're using <a href=\"../../building-your-application/configuring/eslint#eslint-plugin\">ESLint</a>, there is a built-in rule <code>next/link-passhref</code> to ensure correct usage of <code>passHref</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\nimport styled from 'styled-components'\n \n// This creates a custom component that wraps an &lt;a&gt; tag\nconst RedLink = styled.a`\n  color: red;\n`\n \nfunction NavLink({ href, name }) {\n  return (\n    &lt;Link href={href} passHref legacyBehavior&gt;\n      &lt;RedLink&gt;{name}&lt;/RedLink&gt;\n    &lt;/Link&gt;\n  )\n}\n \nexport default NavLink</pre>\n</div> <ul> <li>If youre using <a href=\"https://emotion.sh/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">emotion</a>s JSX pragma feature (<code>@jsx jsx</code>), you must use <code>passHref</code> even if you use an <code>&lt;a&gt;</code> tag directly.</li> <li>The component should support <code>onClick</code> property to trigger navigation correctly</li> </ul> <h3 id=\"if-the-child-is-a-functional-component\" data-docs-heading=\"\">If the child is a functional component     </h3> <p>If the child of <code>Link</code> is a functional component, in addition to using <code>passHref</code> and <code>legacyBehavior</code>, you must wrap the component in <a href=\"https://react.dev/reference/react/forwardRef\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>React.forwardRef</code></a>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \n// `onClick`, `href`, and `ref` need to be passed to the DOM element\n// for proper handling\nconst MyButton = React.forwardRef(({ onClick, href }, ref) =&gt; {\n  return (\n    &lt;a href={href} onClick={onClick} ref={ref}&gt;\n      Click Me\n    &lt;/a&gt;\n  )\n})\n \nfunction Home() {\n  return (\n    &lt;Link href=\"/about\" passHref legacyBehavior&gt;\n      &lt;MyButton /&gt;\n    &lt;/Link&gt;\n  )\n}\n \nexport default Home</pre>\n</div> <h3 id=\"with-url-object\" data-docs-heading=\"\">With URL Object     </h3> <p><code>Link</code> can also receive a URL object and it will automatically format it to create the URL string. Here's how to do it:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Home() {\n  return (\n    &lt;ul&gt;\n      &lt;li&gt;\n        &lt;Link\n          href={{\n            pathname: '/about',\n            query: { name: 'test' },\n          }}\n        &gt;\n          About us\n        &lt;/Link&gt;\n      &lt;/li&gt;\n      &lt;li&gt;\n        &lt;Link\n          href={{\n            pathname: '/blog/[slug]',\n            query: { slug: 'my-post' },\n          }}\n        &gt;\n          Blog Post\n        &lt;/Link&gt;\n      &lt;/li&gt;\n    &lt;/ul&gt;\n  )\n}\n \nexport default Home</pre>\n</div> <p>The above example has a link to:</p> <ul> <li>A predefined route: <code>/about?name=test</code>\n</li> <li>A <a href=\"../../../app/building-your-application/routing/dynamic-routes\">dynamic route</a>: <code>/blog/my-post</code>\n</li> </ul> <p>You can use every property as defined in the <a href=\"https://nodejs.org/api/url.html#url_url_strings_and_url_objects\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.js URL module documentation</a>.</p> <h3 id=\"replace-the-url-instead-of-push\" data-docs-heading=\"\">Replace the URL instead of push     </h3> <p>The default behavior of the <code>Link</code> component is to <code>push</code> a new URL into the <code>history</code> stack. You can use the <code>replace</code> prop to prevent adding a new entry, as in the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/about\" replace&gt;\n  About us\n&lt;/Link&gt;</pre>\n</div> <h3 id=\"disable-scrolling-to-the-top-of-the-page\" data-docs-heading=\"\">Disable scrolling to the top of the page     </h3> <p>The default behavior of <code>Link</code> is to scroll to the top of the page. When there is a hash defined it will scroll to the specific id, like a normal <code>&lt;a&gt;</code> tag. To prevent scrolling to the top / hash <code>scroll={false}</code> can be added to <code>Link</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Link href=\"/#hashid\" scroll={false}&gt;\n  Disables scrolling to the top\n&lt;/Link&gt;</pre>\n</div> <h3 id=\"middleware\" data-docs-heading=\"\">Middleware     </h3> <p>It's common to use <a href=\"../../../app/building-your-application/routing/middleware\">Middleware</a> for authentication or other purposes that involve rewriting the user to a different page. In order for the <code>&lt;Link /&gt;</code> component to properly prefetch links with rewrites via Middleware, you need to tell Next.js both the URL to display and the URL to prefetch. This is required to avoid un-necessary fetches to middleware to know the correct route to prefetch.</p> <p>For example, if you want to serve a <code>/dashboard</code> route that has authenticated and visitor views, you may add something similar to the following in your Middleware to redirect the user to the correct page:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function middleware(req) {\n  const nextUrl = req.nextUrl\n  if (nextUrl.pathname === '/dashboard') {\n    if (req.cookies.authToken) {\n      return NextResponse.rewrite(new URL('/auth/dashboard', req.url))\n    } else {\n      return NextResponse.rewrite(new URL('/public/dashboard', req.url))\n    }\n  }\n}</pre></div> <p>In this case, you would want to use the following code in your <code>&lt;Link /&gt;</code> component:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\nimport useIsAuthed from './hooks/useIsAuthed'\n \nexport default function Page() {\n  const isAuthed = useIsAuthed()\n  const path = isAuthed ? '/auth/dashboard' : '/public/dashboard'\n  return (\n    &lt;Link as=\"/dashboard\" href={path}&gt;\n      Dashboard\n    &lt;/Link&gt;\n  )\n}</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you're using <a href=\"../../../app/building-your-application/routing/dynamic-routes\">Dynamic Routes</a>, you'll need to adapt your <code>as</code> and <code>href</code> props. For example, if you have a Dynamic Route like <code>/dashboard/authed/[user]</code> that you want to present differently via middleware, you would write: <code>&lt;Link href={{ pathname: '/dashboard/authed/[user]', query: { user: username } }} as=\"/dashboard/[user]\"&gt;Profile&lt;/Link&gt;</code>.</p> </blockquote> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>No longer requires a child <code>&lt;a&gt;</code> tag. A <a href=\"../../../app/building-your-application/upgrading/codemods#remove-a-tags-from-link-components\">codemod</a> is provided to automatically update your codebase.</td>\n</tr>\n<tr>\n<td><code>v10.0.0</code></td>\n<td>\n<code>href</code> props pointing to a dynamic route are automatically resolved and no longer require an <code>as</code> prop.</td>\n</tr>\n<tr>\n<td><code>v8.0.0</code></td>\n<td>Improved prefetching performance.</td>\n</tr>\n<tr>\n<td><code>v1.0.0</code></td>\n<td>\n<code>next/link</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/components/link\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/components/link</a>\n  </p>\n</div>\n","pages/api-reference/components/script":"<h1 class=\"break-words\">&lt;Script&gt;</h1> <p>This API reference will help you understand how to use <a href=\"#props\">props</a> available for the Script Component. For features and usage, please see the <a href=\"../../../app/building-your-application/optimizing/scripts\">Optimizing Scripts</a> page.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Dashboard() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h2 id=\"props\" data-docs-heading=\"\">Props     </h2> <p>Here's a summary of the props available for the Script Component:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Prop</th>\n<th>Example</th>\n<th>Type</th>\n<th>Required</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"#src\"><code>src</code></a></td>\n<td><code>src=\"http://example.com/script\"</code></td>\n<td>String</td>\n<td>Required unless inline script is used</td>\n</tr>\n<tr>\n<td><a href=\"#strategy\"><code>strategy</code></a></td>\n<td><code>strategy=\"lazyOnload\"</code></td>\n<td>String</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onload\"><code>onLoad</code></a></td>\n<td><code>onLoad={onLoadFunc}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onready\"><code>onReady</code></a></td>\n<td><code>onReady={onReadyFunc}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n<tr>\n<td><a href=\"#onerror\"><code>onError</code></a></td>\n<td><code>onError={onErrorFunc}</code></td>\n<td>Function</td>\n<td>-</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"required-props\" data-docs-heading=\"\">Required Props     </h2> <p>The <code>&lt;Script /&gt;</code> component requires the following properties.</p> <h3 id=\"src\" data-docs-heading=\"\">src     </h3> <p>A path string specifying the URL of an external script. This can be either an absolute external URL or an internal path. The <code>src</code> property is required unless an inline script is used.</p> <h2 id=\"optional-props\" data-docs-heading=\"\">Optional Props     </h2> <p>The <code>&lt;Script /&gt;</code> component accepts a number of additional properties beyond those which are required.</p> <h3 id=\"strategy\" data-docs-heading=\"\">strategy     </h3> <p>The loading strategy of the script. There are four different strategies that can be used:</p> <ul> <li>\n<code>beforeInteractive</code>: Load before any Next.js code and before any page hydration occurs.</li> <li>\n<code>afterInteractive</code>: (<strong>default</strong>) Load early but after some hydration on the page occurs.</li> <li>\n<code>lazyOnload</code>: Load during browser idle time.</li> <li>\n<code>worker</code>: (experimental) Load in a web worker.</li> </ul> <h3 id=\"beforeinteractive\" data-docs-heading=\"\">beforeInteractive     </h3> <p>Scripts that load with the <code>beforeInteractive</code> strategy are injected into the initial HTML from the server, downloaded before any Next.js module, and executed in the order they are placed before <em>any</em> hydration occurs on the page.</p> <p>Scripts denoted with this strategy are preloaded and fetched before any first-party code, but their execution does not block page hydration from occurring.</p>  <p><code>beforeInteractive</code> scripts must be placed inside the <code>Document</code> Component (<code>pages/_document.js</code>) and are designed to load scripts that are needed by the entire site (i.e. the script will load when any page in the application has been loaded server-side).</p> <p><strong>This strategy should only be used for critical scripts that need to be fetched before any part of the page becomes interactive.</strong></p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Html, Head, Main, NextScript } from 'next/document'\nimport Script from 'next/script'\n \nexport default function Document() {\n  return (\n    &lt;Html&gt;\n      &lt;Head /&gt;\n      &lt;body&gt;\n        &lt;Main /&gt;\n        &lt;NextScript /&gt;\n        &lt;Script\n          src=\"https://example.com/script.js\"\n          strategy=\"beforeInteractive\"\n        /&gt;\n      &lt;/body&gt;\n    &lt;/Html&gt;\n  )\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Scripts with <code>beforeInteractive</code> will always be injected inside the <code>head</code> of the HTML document regardless of where it's placed in the component.</p> </blockquote> <p>Some examples of scripts that should be loaded as soon as possible with <code>beforeInteractive</code> include:</p> <ul> <li>Bot detectors</li> <li>Cookie consent managers</li> </ul> <h3 id=\"afterinteractive\" data-docs-heading=\"\">afterInteractive     </h3> <p>Scripts that use the <code>afterInteractive</code> strategy are injected into the HTML client-side and will load after some (or all) hydration occurs on the page. <strong>This is the default strategy</strong> of the Script component and should be used for any script that needs to load as soon as possible but not before any first-party Next.js code.</p> <p><code>afterInteractive</code> scripts can be placed inside of any page or layout and will only load and execute when that page (or group of pages) is opened in the browser.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" strategy=\"afterInteractive\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <p>Some examples of scripts that are good candidates for <code>afterInteractive</code> include:</p> <ul> <li>Tag managers</li> <li>Analytics</li> </ul> <h3 id=\"lazyonload\" data-docs-heading=\"\">lazyOnload     </h3> <p>Scripts that use the <code>lazyOnload</code> strategy are injected into the HTML client-side during browser idle time and will load after all resources on the page have been fetched. This strategy should be used for any background or low priority scripts that do not need to load early.</p> <p><code>lazyOnload</code> scripts can be placed inside of any page or layout and will only load and execute when that page (or group of pages) is opened in the browser.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" strategy=\"lazyOnload\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <p>Examples of scripts that do not need to load immediately and can be fetched with <code>lazyOnload</code> include:</p> <ul> <li>Chat support plugins</li> <li>Social media widgets</li> </ul> <h3 id=\"worker\" data-docs-heading=\"\">worker     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> The <code>worker</code> strategy is not yet stable and does not yet work with the <a href=\"../../../app/building-your-application/routing/defining-routes\"><code>app</code></a> directory. Use with caution.</p> </blockquote> <p>Scripts that use the <code>worker</code> strategy are off-loaded to a web worker in order to free up the main thread and ensure that only critical, first-party resources are processed on it. While this strategy can be used for any script, it is an advanced use case that is not guaranteed to support all third-party scripts.</p> <p>To use <code>worker</code> as a strategy, the <code>nextScriptWorkers</code> flag must be enabled in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    nextScriptWorkers: true,\n  },\n}</pre></div> <p><code>worker</code> scripts can <strong>only currently be used in the <code>pages/</code> directory</strong>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Home() {\n  return (\n    &lt;&gt;\n      &lt;Script src=\"https://example.com/script.js\" strategy=\"worker\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"onload\" data-docs-heading=\"\">onLoad     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> <code>onLoad</code> does not yet work with Server Components and can only be used in Client Components. Further, <code>onLoad</code> can't be used with <code>beforeInteractive</code>  consider using <code>onReady</code> instead.</p> </blockquote> <p>Some third-party scripts require users to run JavaScript code once after the script has finished loading in order to instantiate content or call a function. If you are loading a script with either afterInteractive or lazyOnload as a loading strategy, you can execute code after it has loaded using the onLoad property.</p> <p>Here's an example of executing a lodash method only after the library has been loaded.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">'use client'\n \nimport Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script\n        src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.min.js\"\n        onLoad={() =&gt; {\n          console.log(_.sample([1, 2, 3, 4]))\n        }}\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre></div>  <h3 id=\"onready\" data-docs-heading=\"\">onReady     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> <code>onReady</code> does not yet work with Server Components and can only be used in Client Components.</p> </blockquote> <p>Some third-party scripts require users to run JavaScript code after the script has finished loading and every time the component is mounted (after a route navigation for example). You can execute code after the script's load event when it first loads and then after every subsequent component re-mount using the onReady property.</p> <p>Here's an example of how to re-instantiate a Google Maps JS embed every time the component is mounted:</p>  <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRef } from 'react'\nimport Script from 'next/script'\n \nexport default function Page() {\n  const mapRef = useRef()\n \n  return (\n    &lt;&gt;\n      &lt;div ref={mapRef}&gt;&lt;/div&gt;\n      &lt;Script\n        id=\"google-maps\"\n        src=\"https://maps.googleapis.com/maps/api/js\"\n        onReady={() =&gt; {\n          new google.maps.Map(mapRef.current, {\n            center: { lat: -34.397, lng: 150.644 },\n            zoom: 8,\n          })\n        }}\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre>\n</div> <h3 id=\"onerror\" data-docs-heading=\"\">onError     </h3> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong> <code>onError</code> does not yet work with Server Components and can only be used in Client Components. <code>onError</code> cannot be used with the <code>beforeInteractive</code> loading strategy.</p> </blockquote> <p>Sometimes it is helpful to catch when a script fails to load. These errors can be handled with the onError property:</p>  <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function Page() {\n  return (\n    &lt;&gt;\n      &lt;Script\n        src=\"https://example.com/script.js\"\n        onError={(e: Error) =&gt; {\n          console.error('Script failed to load', e)\n        }}\n      /&gt;\n    &lt;/&gt;\n  )\n}</pre>\n</div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>beforeInteractive</code> and <code>afterInteractive</code> is modified to support <code>app</code>.</td>\n</tr>\n<tr>\n<td><code>v12.2.4</code></td>\n<td>\n<code>onReady</code> prop added.</td>\n</tr>\n<tr>\n<td><code>v12.2.2</code></td>\n<td>Allow <code>next/script</code> with <code>beforeInteractive</code> to be placed in <code>_document</code>.</td>\n</tr>\n<tr>\n<td><code>v11.0.0</code></td>\n<td>\n<code>next/script</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/components/script\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/components/script</a>\n  </p>\n</div>\n","pages/api-reference/functions":"<h1 class=\"break-words\">Functions</h1><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions</a>\n  </p>\n</div>\n","pages/api-reference/functions/get-static-paths":"<h1 class=\"break-words\">getStaticPaths</h1>\n<p>When exporting a function called <code>getStaticPaths</code> from a page that uses <a href=\"../../building-your-application/routing/dynamic-routes\">Dynamic Routes</a>, Next.js will statically pre-render all the paths specified by <code>getStaticPaths</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type {\n  InferGetStaticPropsType,\n  GetStaticProps,\n  GetStaticPaths,\n} from 'next'\n \ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n \nexport const getStaticPaths = (async () =&gt; {\n  return {\n    paths: [\n      {\n        params: {\n          name: 'next.js',\n        },\n      }, // See the \"paths\" section below\n    ],\n    fallback: true, // false or \"blocking\"\n  }\n}) satisfies GetStaticPaths\n \nexport const getStaticProps = (async (context) =&gt; {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}) satisfies GetStaticProps&lt;{\n  repo: Repo\n}&gt;\n \nexport default function Page({\n  repo,\n}: InferGetStaticPropsType&lt;typeof getStaticProps&gt;) {\n  return repo.stargazers_count\n}</pre></div>  <h2 id=\"getstaticpaths-return-values\" data-docs-heading=\"\">getStaticPaths return values     </h2> <p>The <code>getStaticPaths</code> function should return an object with the following <strong>required</strong> properties:</p> <h3 id=\"paths\" data-docs-heading=\"\">paths     </h3> <p>The <code>paths</code> key determines which paths will be pre-rendered. For example, suppose that you have a page that uses <a href=\"../../building-your-application/routing/dynamic-routes\">Dynamic Routes</a> named <code>pages/posts/[id].js</code>. If you export <code>getStaticPaths</code> from this page and return the following for <code>paths</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">return {\n  paths: [\n    { params: { id: '1' }},\n    {\n      params: { id: '2' },\n      // with i18n configured the locale for the path can be returned as well\n      locale: \"en\",\n    },\n  ],\n  fallback: ...\n}</pre>\n</div> <p>Then, Next.js will statically generate <code>/posts/1</code> and <code>/posts/2</code> during <code>next build</code> using the page component in <code>pages/posts/[id].js</code>.</p> <p>The value for each <code>params</code> object must match the parameters used in the page name:</p> <ul> <li>If the page name is <code>pages/posts/[postId]/[commentId]</code>, then <code>params</code> should contain <code>postId</code> and <code>commentId</code>.</li> <li>If the page name uses <a href=\"../../building-your-application/routing/dynamic-routes#catch-all-segments\">catch-all routes</a> like <code>pages/[...slug]</code>, then <code>params</code> should contain <code>slug</code> (which is an array). If this array is <code>['hello', 'world']</code>, then Next.js will statically generate the page at <code>/hello/world</code>.</li> <li>If the page uses an <a href=\"../../building-your-application/routing/dynamic-routes#optional-catch-all-segments\">optional catch-all route</a>, use <code>null</code>, <code>[]</code>, <code>undefined</code> or <code>false</code> to render the root-most route. For example, if you supply <code>slug: false</code> for <code>pages/[[...slug]]</code>, Next.js will statically generate the page <code>/</code>.</li> </ul> <p>The <code>params</code> strings are <strong>case-sensitive</strong> and ideally should be normalized to ensure the paths are generated correctly. For example, if <code>WoRLD</code> is returned for a param it will only match if <code>WoRLD</code> is the actual path visited, not <code>world</code> or <code>World</code>.</p> <p>Separate of the <code>params</code> object a <code>locale</code> field can be returned when <a href=\"../../building-your-application/routing/internationalization\">i18n is configured</a>, which configures the locale for the path being generated.</p> <h3 id=\"fallback-false\" data-docs-heading=\"\">fallback: false     </h3> <p>If <code>fallback</code> is <code>false</code>, then any paths not returned by <code>getStaticPaths</code> will result in a <strong>404 page</strong>.</p> <p>When <code>next build</code> is run, Next.js will check if <code>getStaticPaths</code> returned <code>fallback: false</code>, it will then build <strong>only</strong> the paths returned by <code>getStaticPaths</code>. This option is useful if you have a small number of paths to create, or new page data is not added often. If you find that you need to add more paths, and you have <code>fallback: false</code>, you will need to run <code>next build</code> again so that the new paths can be generated.</p> <p>The following example pre-renders one blog post per page called <code>pages/posts/[id].js</code>. The list of blog posts will be fetched from a CMS and returned by <code>getStaticPaths</code>. Then, for each page, it fetches the post data from a CMS using <a href=\"../../building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code></a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function Post({ post }) {\n  // Render post...\n}\n \n// This function gets called at build time\nexport async function getStaticPaths() {\n  // Call an external API endpoint to get posts\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  // Get the paths we want to pre-render based on posts\n  const paths = posts.map((post) =&gt; ({\n    params: { id: post.id },\n  }))\n \n  // We'll pre-render only these paths at build time.\n  // { fallback: false } means other routes should 404.\n  return { paths, fallback: false }\n}\n \n// This also gets called at build time\nexport async function getStaticProps({ params }) {\n  // params contains the post `id`.\n  // If the route is like /posts/1, then params.id is 1\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n \n  // Pass post data to the page via props\n  return { props: { post } }\n}\n \nexport default Post</pre></div> <h3 id=\"fallback-true\" data-docs-heading=\"\">fallback: true     </h3> <details><summary>Examples</summary><ul> <li><a href=\"https://static-tweet.vercel.app\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Static generation of a large number of pages</a></li> </ul></details> <p>If <code>fallback</code> is <code>true</code>, then the behavior of <code>getStaticProps</code> changes in the following ways:</p> <ul> <li>The paths returned from <code>getStaticPaths</code> will be rendered to <code>HTML</code> at build time by <code>getStaticProps</code>.</li> <li>The paths that have not been generated at build time will <strong>not</strong> result in a 404 page. Instead, Next.js will serve a <a href=\"#fallback-pages\">fallback</a> version of the page on the first request to such a path. Web crawlers, such as Google, won't be served a fallback and instead the path will behave as in <a href=\"#fallback-blocking\"><code>fallback: 'blocking'</code></a>.</li> <li>When a page with <code>fallback: true</code> is navigated to through <code>next/link</code> or <code>next/router</code> (client-side) Next.js will <em>not</em> serve a fallback and instead the page will behave as <a href=\"#fallback-blocking\"><code>fallback: 'blocking'</code></a>.</li> <li>In the background, Next.js will statically generate the requested path <code>HTML</code> and <code>JSON</code>. This includes running <code>getStaticProps</code>.</li> <li>When complete, the browser receives the <code>JSON</code> for the generated path. This will be used to automatically render the page with the required props. From the users perspective, the page will be swapped from the fallback page to the full page.</li> <li>At the same time, Next.js adds this path to the list of pre-rendered pages. Subsequent requests to the same path will serve the generated page, like other pages pre-rendered at build time.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>fallback: true</code> is not supported when using <a href=\"../../building-your-application/deploying/static-exports\"><code>output: 'export'</code></a>.</p> </blockquote> <h4 id=\"when-is-fallback-true-useful\" data-docs-heading=\"\">When is fallback: true useful?     </h4> <p><code>fallback: true</code> is useful if your app has a very large number of static pages that depend on data (such as a very large e-commerce site). If you want to pre-render all product pages, the builds would take a very long time.</p> <p>Instead, you may statically generate a small subset of pages and use <code>fallback: true</code> for the rest. When someone requests a page that is not generated yet, the user will see the page with a loading indicator or skeleton component.</p> <p>Shortly after, <code>getStaticProps</code> finishes and the page will be rendered with the requested data. From now on, everyone who requests the same page will get the statically pre-rendered page.</p> <p>This ensures that users always have a fast experience while preserving fast builds and the benefits of Static Generation.</p> <p><code>fallback: true</code> will not <em>update</em> generated pages, for that take a look at <a href=\"../../building-your-application/data-fetching/incremental-static-regeneration\">Incremental Static Regeneration</a>.</p> <h3 id=\"fallback-blocking\" data-docs-heading=\"\">fallback: 'blocking'     </h3> <p>If <code>fallback</code> is <code>'blocking'</code>, new paths not returned by <code>getStaticPaths</code> will wait for the <code>HTML</code> to be generated, identical to SSR (hence why <em>blocking</em>), and then be cached for future requests so it only happens once per path.</p> <p><code>getStaticProps</code> will behave as follows:</p> <ul> <li>The paths returned from <code>getStaticPaths</code> will be rendered to <code>HTML</code> at build time by <code>getStaticProps</code>.</li> <li>The paths that have not been generated at build time will <strong>not</strong> result in a 404 page. Instead, Next.js will SSR on the first request and return the generated <code>HTML</code>.</li> <li>When complete, the browser receives the <code>HTML</code> for the generated path. From the users perspective, it will transition from \"the browser is requesting the page\" to \"the full page is loaded\". There is no flash of loading/fallback state.</li> <li>At the same time, Next.js adds this path to the list of pre-rendered pages. Subsequent requests to the same path will serve the generated page, like other pages pre-rendered at build time.</li> </ul> <p><code>fallback: 'blocking'</code> will not <em>update</em> generated pages by default. To update generated pages, use <a href=\"../../building-your-application/data-fetching/incremental-static-regeneration\">Incremental Static Regeneration</a> in conjunction with <code>fallback: 'blocking'</code>.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>fallback: 'blocking'</code> is not supported when using <a href=\"../../building-your-application/deploying/static-exports\"><code>output: 'export'</code></a>.</p> </blockquote> <h3 id=\"fallback-pages\" data-docs-heading=\"\">Fallback pages     </h3> <p>In the fallback version of a page:</p> <ul> <li>The pages props will be empty.</li> <li>Using the <a href=\"use-router\">router</a>, you can detect if the fallback is being rendered, <code>router.isFallback</code> will be <code>true</code>.</li> </ul> <p>The following example showcases using <code>isFallback</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nfunction Post({ post }) {\n  const router = useRouter()\n \n  // If the page is not yet generated, this will be displayed\n  // initially until getStaticProps() finishes running\n  if (router.isFallback) {\n    return &lt;div&gt;Loading...&lt;/div&gt;\n  }\n \n  // Render post...\n}\n \n// This function gets called at build time\nexport async function getStaticPaths() {\n  return {\n    // Only `/posts/1` and `/posts/2` are generated at build time\n    paths: [{ params: { id: '1' } }, { params: { id: '2' } }],\n    // Enable statically generating additional pages\n    // For example: `/posts/3`\n    fallback: true,\n  }\n}\n \n// This also gets called at build time\nexport async function getStaticProps({ params }) {\n  // params contains the post `id`.\n  // If the route is like /posts/1, then params.id is 1\n  const res = await fetch(`https://.../posts/${params.id}`)\n  const post = await res.json()\n \n  // Pass post data to the page via props\n  return {\n    props: { post },\n    // Re-generate the post at most once per second\n    // if a request comes in\n    revalidate: 1,\n  }\n}\n \nexport default Post</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.4.0</code></td>\n<td>\n<a href=\"../../../app/building-your-application/data-fetching\">App Router</a> is now stable with simplified data fetching, including <a href=\"../../../app/api-reference/functions/generate-static-params\"><code>generateStaticParams()</code></a>\n</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>\n<a href=\"../../building-your-application/data-fetching/incremental-static-regeneration#on-demand-revalidation\">On-Demand Incremental Static Regeneration</a> is stable.</td>\n</tr>\n<tr>\n<td><code>v12.1.0</code></td>\n<td>\n<a href=\"../../building-your-application/data-fetching/incremental-static-regeneration#on-demand-revalidation\">On-Demand Incremental Static Regeneration</a> added (beta).</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>Stable <a href=\"../../building-your-application/data-fetching/incremental-static-regeneration\">Incremental Static Regeneration</a>\n</td>\n</tr>\n<tr>\n<td><code>v9.3.0</code></td>\n<td>\n<code>getStaticPaths</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/get-static-paths\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/get-static-paths</a>\n  </p>\n</div>\n","pages/api-reference/functions/get-static-props":"<h1 class=\"break-words\">getStaticProps</h1>\n<p>Exporting a function called <code>getStaticProps</code> will pre-render a page at build time using the props returned from the function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { InferGetStaticPropsType, GetStaticProps } from 'next'\n \ntype Repo = {\n  name: string\n  stargazers_count: number\n}\n \nexport const getStaticProps = (async (context) =&gt; {\n  const res = await fetch('https://api.github.com/repos/vercel/next.js')\n  const repo = await res.json()\n  return { props: { repo } }\n}) satisfies GetStaticProps&lt;{\n  repo: Repo\n}&gt;\n \nexport default function Page({\n  repo,\n}: InferGetStaticPropsType&lt;typeof getStaticProps&gt;) {\n  return repo.stargazers_count\n}</pre></div>  <p>You can import modules in top-level scope for use in <code>getStaticProps</code>. Imports used will <strong>not be bundled for the client-side</strong>. This means you can write <strong>server-side code directly in <code>getStaticProps</code></strong>, including fetching data from your database.</p> <h2 id=\"context-parameter\" data-docs-heading=\"\">Context parameter     </h2> <p>The <code>context</code> parameter is an object containing the following keys:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Name</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>params</code></td>\n<td>Contains the route parameters for pages using <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic routes</a>. For example, if the page name is <code>[id].js</code>, then <code>params</code> will look like <code>{ id: ... }</code>. You should use this together with <code>getStaticPaths</code>, which we'll explain later.</td>\n</tr>\n<tr>\n<td><code>preview</code></td>\n<td>(Deprecated for <code>draftMode</code>) <code>preview</code> is <code>true</code> if the page is in the <a href=\"../../building-your-application/configuring/preview-mode\">Preview Mode</a> and <code>false</code> otherwise.</td>\n</tr>\n<tr>\n<td><code>previewData</code></td>\n<td>(Deprecated for <code>draftMode</code>) The <a href=\"../../building-your-application/configuring/preview-mode\">preview</a> data set by <code>setPreviewData</code>.</td>\n</tr>\n<tr>\n<td><code>draftMode</code></td>\n<td>\n<code>draftMode</code> is <code>true</code> if the page is in the <a href=\"../../building-your-application/configuring/draft-mode\">Draft Mode</a> and <code>false</code> otherwise.</td>\n</tr>\n<tr>\n<td><code>locale</code></td>\n<td>Contains the active locale (if enabled).</td>\n</tr>\n<tr>\n<td><code>locales</code></td>\n<td>Contains all supported locales (if enabled).</td>\n</tr>\n<tr>\n<td><code>defaultLocale</code></td>\n<td>Contains the configured default locale (if enabled).</td>\n</tr>\n<tr>\n<td><code>revalidateReason</code></td>\n<td>Provides a reason for why the function was called. Can be one of: \"build\" (run at build time), \"stale\" (revalidate period expired, or running in <a href=\"../../building-your-application/data-fetching/get-static-props#runs-on-every-request-in-development\">development mode</a>), \"on-demand\" (triggered via <a href=\"../../building-your-application/data-fetching/incremental-static-regeneration#on-demand-revalidation\">on-demand revalidation</a>)</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"getstaticprops-return-values\" data-docs-heading=\"\">getStaticProps return values     </h2> <p>The <code>getStaticProps</code> function should return an object containing either <code>props</code>, <code>redirect</code>, or <code>notFound</code> followed by an <strong>optional</strong> <code>revalidate</code> property.</p> <h3 id=\"props\" data-docs-heading=\"\">props     </h3> <p>The <code>props</code> object is a key-value pair, where each value is received by the page component. It should be a <a href=\"https://developer.mozilla.org/docs/Glossary/Serialization\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">serializable object</a> so that any props passed, could be serialized with <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>JSON.stringify</code></a>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps(context) {\n  return {\n    props: { message: `Next.js is awesome` }, // will be passed to the page component as props\n  }\n}</pre>\n</div> <h3 id=\"revalidate\" data-docs-heading=\"\">revalidate     </h3> <p>The <code>revalidate</code> property is the amount in seconds after which a page re-generation can occur (defaults to <code>false</code> or no revalidation).</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// This function gets called at build time on server-side.\n// It may be called again, on a serverless function, if\n// revalidation is enabled and a new request comes in\nexport async function getStaticProps() {\n  const res = await fetch('https://.../posts')\n  const posts = await res.json()\n \n  return {\n    props: {\n      posts,\n    },\n    // Next.js will attempt to re-generate the page:\n    // - When a request comes in\n    // - At most once every 10 seconds\n    revalidate: 10, // In seconds\n  }\n}</pre>\n</div> <p>Learn more about <a href=\"../../building-your-application/data-fetching/incremental-static-regeneration\">Incremental Static Regeneration</a>.</p> <p>The cache status of a page leveraging ISR can be determined by reading the value of the <code>x-nextjs-cache</code> response header. The possible values are the following:</p> <ul> <li>\n<code>MISS</code> - the path is not in the cache (occurs at most once, on the first visit)</li> <li>\n<code>STALE</code> - the path is in the cache but exceeded the revalidate time so it will be updated in the background</li> <li>\n<code>HIT</code> - the path is in the cache and has not exceeded the revalidate time</li> </ul> <h3 id=\"notfound\" data-docs-heading=\"\">notFound     </h3> <p>The <code>notFound</code> boolean allows the page to return a <code>404</code> status and <a href=\"../../building-your-application/routing/custom-error#404-page\">404 Page</a>. With <code>notFound: true</code>, the page will return a <code>404</code> even if there was a successfully generated page before. This is meant to support use cases like user-generated content getting removed by its author. Note, <code>notFound</code> follows the same <code>revalidate</code> behavior <a href=\"#revalidate\">described here</a>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps(context) {\n  const res = await fetch(`https://.../data`)\n  const data = await res.json()\n \n  if (!data) {\n    return {\n      notFound: true,\n    }\n  }\n \n  return {\n    props: { data }, // will be passed to the page component as props\n  }\n}</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: <code>notFound</code> is not needed for <a href=\"get-static-paths#fallback-false\"><code>fallback: false</code></a> mode as only paths returned from <code>getStaticPaths</code> will be pre-rendered.</p> </blockquote> <h3 id=\"redirect\" data-docs-heading=\"\">redirect     </h3> <p>The <code>redirect</code> object allows redirecting to internal or external resources. It should match the shape of <code>{ destination: string, permanent: boolean }</code>.</p> <p>In some rare cases, you might need to assign a custom status code for older <code>HTTP</code> clients to properly redirect. In these cases, you can use the <code>statusCode</code> property instead of the <code>permanent</code> property, <strong>but not both</strong>. You can also set <code>basePath: false</code> similar to redirects in <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export async function getStaticProps(context) {\n  const res = await fetch(`https://...`)\n  const data = await res.json()\n \n  if (!data) {\n    return {\n      redirect: {\n        destination: '/',\n        permanent: false,\n        // statusCode: 301\n      },\n    }\n  }\n \n  return {\n    props: { data }, // will be passed to the page component as props\n  }\n}</pre>\n</div> <p>If the redirects are known at build-time, they should be added in <a href=\"../next-config-js/redirects\"><code>next.config.js</code></a> instead.</p> <h2 id=\"reading-files-use-processcwd\" data-docs-heading=\"\">Reading files: Use process.cwd()     </h2> <p>Files can be read directly from the filesystem in <code>getStaticProps</code>.</p> <p>In order to do so you have to get the full path to a file.</p> <p>Since Next.js compiles your code into a separate directory you can't use <code>__dirname</code> as the path it returns will be different from the Pages Router.</p> <p>Instead you can use <code>process.cwd()</code> which gives you the directory where Next.js is being executed.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { promises as fs } from 'fs'\nimport path from 'path'\n \n// posts will be populated at build time by getStaticProps()\nfunction Blog({ posts }) {\n  return (\n    &lt;ul&gt;\n      {posts.map((post) =&gt; (\n        &lt;li&gt;\n          &lt;h3&gt;{post.filename}&lt;/h3&gt;\n          &lt;p&gt;{post.content}&lt;/p&gt;\n        &lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  )\n}\n \n// This function gets called at build time on server-side.\n// It won't be called on client-side, so you can even do\n// direct database queries.\nexport async function getStaticProps() {\n  const postsDirectory = path.join(process.cwd(), 'posts')\n  const filenames = await fs.readdir(postsDirectory)\n \n  const posts = filenames.map(async (filename) =&gt; {\n    const filePath = path.join(postsDirectory, filename)\n    const fileContents = await fs.readFile(filePath, 'utf8')\n \n    // Generally you would parse/transform the contents\n    // For example you can transform markdown to HTML here\n \n    return {\n      filename,\n      content: fileContents,\n    }\n  })\n  // By returning { props: { posts } }, the Blog component\n  // will receive `posts` as a prop at build time\n  return {\n    props: {\n      posts: await Promise.all(posts),\n    },\n  }\n}\n \nexport default Blog</pre>\n</div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.4.0</code></td>\n<td>\n<a href=\"../../../app/building-your-application/data-fetching\">App Router</a> is now stable with simplified data fetching</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>\n<a href=\"../../building-your-application/data-fetching/incremental-static-regeneration#on-demand-revalidation\">On-Demand Incremental Static Regeneration</a> is stable.</td>\n</tr>\n<tr>\n<td><code>v12.1.0</code></td>\n<td>\n<a href=\"../../building-your-application/data-fetching/incremental-static-regeneration#on-demand-revalidation\">On-Demand Incremental Static Regeneration</a> added (beta).</td>\n</tr>\n<tr>\n<td><code>v10.0.0</code></td>\n<td>\n<code>locale</code>, <code>locales</code>, <code>defaultLocale</code>, and <code>notFound</code> options added.</td>\n</tr>\n<tr>\n<td><code>v10.0.0</code></td>\n<td>\n<code>fallback: 'blocking'</code> return option added.</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>Stable <a href=\"../../building-your-application/data-fetching/incremental-static-regeneration\">Incremental Static Regeneration</a>\n</td>\n</tr>\n<tr>\n<td><code>v9.3.0</code></td>\n<td>\n<code>getStaticProps</code> introduced.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/get-static-props\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/get-static-props</a>\n  </p>\n</div>\n","pages/api-reference/functions/next-response":"<h1 class=\"break-words\">NextResponse</h1> <p>NextResponse extends the <a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Response API</a> with additional convenience methods.</p> <h2 id=\"cookies\" data-docs-heading=\"\">cookies     </h2> <p>Read or mutate the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Set-Cookie</code></a> header of the response.</p> <h3 id=\"setname-value\" data-docs-heading=\"\">set(name, value)     </h3> <p>Given a name, set a cookie with the given value on the response.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\nlet response = NextResponse.next()\n// Set a cookie to hide the banner\nresponse.cookies.set('show-banner', 'false')\n// Response will have a `Set-Cookie:show-banner=false;path=/home` header\nreturn response</pre>\n</div> <h3 id=\"getname\" data-docs-heading=\"\">get(name)     </h3> <p>Given a cookie name, return the value of the cookie. If the cookie is not found, <code>undefined</code> is returned. If multiple cookies are found, the first one is returned.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\nlet response = NextResponse.next()\n// { name: 'show-banner', value: 'false', Path: '/home' }\nresponse.cookies.get('show-banner')</pre>\n</div> <h3 id=\"getall\" data-docs-heading=\"\">getAll()     </h3> <p>Given a cookie name, return the values of the cookie. If no name is given, return all cookies on the response.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\nlet response = NextResponse.next()\n// [\n//   { name: 'experiments', value: 'new-pricing-page', Path: '/home' },\n//   { name: 'experiments', value: 'winter-launch', Path: '/home' },\n// ]\nresponse.cookies.getAll('experiments')\n// Alternatively, get all cookies for the response\nresponse.cookies.getAll()</pre>\n</div> <h3 id=\"deletename\" data-docs-heading=\"\">delete(name)     </h3> <p>Given a cookie name, delete the cookie from the response.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\nlet response = NextResponse.next()\n// Returns true for deleted, false is nothing is deleted\nresponse.cookies.delete('experiments')</pre>\n</div> <h2 id=\"json\" data-docs-heading=\"\">json()     </h2> <p>Produce a response with the given JSON body.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \nexport async function GET(request: Request) {\n  return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 })\n}</pre></div>  <h2 id=\"redirect\" data-docs-heading=\"\">redirect()     </h2> <p>Produce a response that redirects to a <a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">URL</a>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \nreturn NextResponse.redirect(new URL('/new', request.url))</pre>\n</div> <p>The <a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">URL</a> can be created and modified before being used in the <code>NextResponse.redirect()</code> method. For example, you can use the <code>request.nextUrl</code> property to get the current URL, and then modify it to redirect to a different URL.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \n// Given an incoming request...\nconst loginUrl = new URL('/login', request.url)\n// Add ?from=/incoming-url to the /login URL\nloginUrl.searchParams.set('from', request.nextUrl.pathname)\n// And redirect to the new URL\nreturn NextResponse.redirect(loginUrl)</pre>\n</div> <h2 id=\"rewrite\" data-docs-heading=\"\">rewrite()     </h2> <p>Produce a response that rewrites (proxies) the given <a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">URL</a> while preserving the original URL.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \n// Incoming request: /about, browser shows /about\n// Rewritten request: /proxy, browser shows /about\nreturn NextResponse.rewrite(new URL('/proxy', request.url))</pre>\n</div> <h2 id=\"next\" data-docs-heading=\"\">next()     </h2> <p>The <code>next()</code> method is useful for Middleware, as it allows you to return early and continue routing.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \nreturn NextResponse.next()</pre>\n</div> <p>You can also forward <code>headers</code> when producing the response:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\n \n// Given an incoming request...\nconst newHeaders = new Headers(request.headers)\n// Add a new header\nnewHeaders.set('x-version', '123')\n// And produce a response with the new headers\nreturn NextResponse.next({\n  request: {\n    // New request headers\n    headers: newHeaders,\n  },\n})</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/next-response\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/next-response</a>\n  </p>\n</div>\n","pages/api-reference/functions/use-amp":"<h1 class=\"break-words\">useAmp</h1>\n<details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/amp\" rel=\"noopener noreferrer\" target=\"_blank\">AMP</a></li> </ul></details> <blockquote class=\"p-3 text-sm\"> <p>AMP support is one of our advanced features, you can <a href=\"../../building-your-application/configuring/amp\">read more about AMP here</a>.</p> </blockquote> <p>To enable AMP, add the following config to your page:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = { amp: true }</pre></div> <p>The <code>amp</code> config accepts the following values:</p> <ul> <li>\n<code>true</code> - The page will be AMP-only</li> <li>\n<code>'hybrid'</code> - The page will have two versions, one with AMP and another one with HTML</li> </ul> <p>To learn more about the <code>amp</code> config, read the sections below.</p> <h2 id=\"amp-first-page\" data-docs-heading=\"\">AMP First Page     </h2> <p>Take a look at the following example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = { amp: true }\n \nfunction About(props) {\n  return &lt;h3&gt;My AMP About Page!&lt;/h3&gt;\n}\n \nexport default About</pre></div> <p>The page above is an AMP-only page, which means:</p> <ul> <li>The page has no Next.js or React client-side runtime</li> <li>The page is automatically optimized with <a href=\"https://github.com/ampproject/amp-toolbox/tree/master/packages/optimizer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">AMP Optimizer</a>, an optimizer that applies the same transformations as AMP caches (improves performance by up to 42%)</li> <li>The page has a user-accessible (optimized) version of the page and a search-engine indexable (unoptimized) version of the page</li> </ul> <h2 id=\"hybrid-amp-page\" data-docs-heading=\"\">Hybrid AMP Page     </h2> <p>Take a look at the following example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useAmp } from 'next/amp'\n \nexport const config = { amp: 'hybrid' }\n \nfunction About(props) {\n  const isAmp = useAmp()\n \n  return (\n    &lt;div&gt;\n      &lt;h3&gt;My AMP About Page!&lt;/h3&gt;\n      {isAmp ? (\n        &lt;amp-img\n          width=\"300\"\n          height=\"300\"\n          src=\"/my-img.jpg\"\n          alt=\"a cool image\"\n          layout=\"responsive\"\n        /&gt;\n      ) : (\n        &lt;img width=\"300\" height=\"300\" src=\"/my-img.jpg\" alt=\"a cool image\" /&gt;\n      )}\n    &lt;/div&gt;\n  )\n}\n \nexport default About</pre></div> <p>The page above is a hybrid AMP page, which means:</p> <ul> <li>The page is rendered as traditional HTML (default) and AMP HTML (by adding <code>?amp=1</code> to the URL)</li> <li>The AMP version of the page only has valid optimizations applied with AMP Optimizer so that it is indexable by search-engines</li> </ul> <p>The page uses <code>useAmp</code> to differentiate between modes, it's a <a href=\"https://react.dev/reference/react\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Hook</a> that returns <code>true</code> if the page is using AMP, and <code>false</code> otherwise.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/use-amp\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/use-amp</a>\n  </p>\n</div>\n","pages/api-reference/functions/use-router":"<h1 class=\"break-words\">useRouter</h1>\n<p>If you want to access the <a href=\"#router-object\"><code>router</code> object</a> inside any function component in your app, you can use the <code>useRouter</code> hook, take a look at the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nfunction ActiveLink({ children, href }) {\n  const router = useRouter()\n  const style = {\n    marginRight: 10,\n    color: router.asPath === href ? 'red' : 'black',\n  }\n \n  const handleClick = (e) =&gt; {\n    e.preventDefault()\n    router.push(href)\n  }\n \n  return (\n    &lt;a href={href} onClick={handleClick} style={style}&gt;\n      {children}\n    &lt;/a&gt;\n  )\n}\n \nexport default ActiveLink</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><code>useRouter</code> is a <a href=\"https://react.dev/learn#using-hooks\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Hook</a>, meaning it cannot be used with classes. You can either use <a href=\"#withrouter\">withRouter</a> or wrap your class in a function component.</p> </blockquote> <h2 id=\"router-object\" data-docs-heading=\"\">router object     </h2> <p>The following is the definition of the <code>router</code> object returned by both <a href=\"#top\"><code>useRouter</code></a> and <a href=\"#withrouter\"><code>withRouter</code></a>:</p> <ul> <li>\n<code>pathname</code>: <code>String</code> - The path for current route file that comes after <code>/pages</code>. Therefore, <code>basePath</code>, <code>locale</code> and trailing slash (<code>trailingSlash: true</code>) are not included.</li> <li>\n<code>query</code>: <code>Object</code> - The query string parsed to an object, including <a href=\"../../building-your-application/routing/dynamic-routes\">dynamic route</a> parameters. It will be an empty object during prerendering if the page doesn't use <a href=\"../../building-your-application/data-fetching/get-server-side-props\">Server-side Rendering</a>. Defaults to <code>{}</code>\n</li> <li>\n<code>asPath</code>: <code>String</code> - The path as shown in the browser including the search params and respecting the <code>trailingSlash</code> configuration. <code>basePath</code> and <code>locale</code> are not included.</li> <li>\n<code>isFallback</code>: <code>boolean</code> - Whether the current page is in <a href=\"get-static-paths#fallback-true\">fallback mode</a>.</li> <li>\n<code>basePath</code>: <code>String</code> - The active <a href=\"../../../app/api-reference/next-config-js/basepath\">basePath</a> (if enabled).</li> <li>\n<code>locale</code>: <code>String</code> - The active locale (if enabled).</li> <li>\n<code>locales</code>: <code>String[]</code> - All supported locales (if enabled).</li> <li>\n<code>defaultLocale</code>: <code>String</code> - The current default locale (if enabled).</li> <li>\n<code>domainLocales</code>: <code>Array&lt;{domain, defaultLocale, locales}&gt;</code> - Any configured domain locales.</li> <li>\n<code>isReady</code>: <code>boolean</code> - Whether the router fields are updated client-side and ready for use. Should only be used inside of <code>useEffect</code> methods and not for conditionally rendering on the server. See related docs for use case with <a href=\"../../building-your-application/rendering/automatic-static-optimization\">automatically statically optimized pages</a>\n</li> <li>\n<code>isPreview</code>: <code>boolean</code> - Whether the application is currently in <a href=\"../../building-your-application/configuring/preview-mode\">preview mode</a>.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p>Using the <code>asPath</code> field may lead to a mismatch between client and server if the page is rendered using server-side rendering or <a href=\"../../building-your-application/rendering/automatic-static-optimization\">automatic static optimization</a>. Avoid using <code>asPath</code> until the <code>isReady</code> field is <code>true</code>.</p> </blockquote> <p>The following methods are included inside <code>router</code>:</p> <h3 id=\"routerpush\" data-docs-heading=\"\">router.push     </h3> <p>Handles client-side transitions, this method is useful for cases where <a href=\"../components/link\"><code>next/link</code></a> is not enough.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">router.push(url, as, options)</pre>\n</div> <ul> <li>\n<code>url</code>: <code>UrlObject | String</code> - The URL to navigate to (see <a href=\"https://nodejs.org/api/url.html#legacy-urlobject\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Node.JS URL module documentation</a> for <code>UrlObject</code> properties).</li> <li>\n<code>as</code>: <code>UrlObject | String</code> - Optional decorator for the path that will be shown in the browser URL bar. Before Next.js 9.5.3 this was used for dynamic routes.</li> <li>\n<code>options</code> - Optional object with the following configuration options: <ul> <li>\n<code>scroll</code> - Optional boolean, controls scrolling to the top of the page after navigation. Defaults to <code>true</code>\n</li> <li>\n<a href=\"../../building-your-application/routing/linking-and-navigating#shallow-routing\"><code>shallow</code></a>: Update the path of the current page without rerunning <a href=\"../../building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code></a>, <a href=\"../../building-your-application/data-fetching/get-server-side-props\"><code>getServerSideProps</code></a> or <a href=\"get-initial-props\"><code>getInitialProps</code></a>. Defaults to <code>false</code>\n</li> <li>\n<code>locale</code> - Optional string, indicates locale of the new page</li> </ul> </li> </ul> <blockquote class=\"p-3 text-sm\"> <p>You don't need to use <code>router.push</code> for external URLs. <a href=\"https://developer.mozilla.org/docs/Web/API/Window/location\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">window.location</a> is better suited for those cases.</p> </blockquote> <p>Navigating to <code>pages/about.js</code>, which is a predefined route:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.push('/about')}&gt;\n      Click me\n    &lt;/button&gt;\n  )\n}</pre>\n</div> <p>Navigating <code>pages/post/[pid].js</code>, which is a dynamic route:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.push('/post/abc')}&gt;\n      Click me\n    &lt;/button&gt;\n  )\n}</pre>\n</div> <p>Redirecting the user to <code>pages/login.js</code>, useful for pages behind <a href=\"../../building-your-application/authentication\">authentication</a>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n \n// Here you would fetch and return the user\nconst useUser = () =&gt; ({ user: null, loading: false })\n \nexport default function Page() {\n  const { user, loading } = useUser()\n  const router = useRouter()\n \n  useEffect(() =&gt; {\n    if (!(user || loading)) {\n      router.push('/login')\n    }\n  }, [user, loading])\n \n  return &lt;p&gt;Redirecting...&lt;/p&gt;\n}</pre>\n</div> <h4 id=\"resetting-state-after-navigation\" data-docs-heading=\"\">Resetting state after navigation     </h4> <p>When navigating to the same page in Next.js, the page's state <strong>will not</strong> be reset by default as React does not unmount unless the parent component has changed.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\nimport { useState } from 'react'\nimport { useRouter } from 'next/router'\n \nexport default function Page(props) {\n  const router = useRouter()\n  const [count, setCount] = useState(0)\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;Page: {router.query.slug}&lt;/h1&gt;\n      &lt;p&gt;Count: {count}&lt;/p&gt;\n      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;Increase count&lt;/button&gt;\n      &lt;Link href=\"/one\"&gt;one&lt;/Link&gt; &lt;Link href=\"/two\"&gt;two&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>In the above example, navigating between <code>/one</code> and <code>/two</code> <strong>will not</strong> reset the count . The <code>useState</code> is maintained between renders because the top-level React component, <code>Page</code>, is the same.</p> <p>If you do not want this behavior, you have a couple of options:</p> <ul> <li> <p>Manually ensure each state is updated using <code>useEffect</code>. In the above example, that could look like:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useEffect(() =&gt; {\n  setCount(0)\n}, [router.query.slug])</pre>\n</div> </li> <li> <p>Use a React <code>key</code> to <a href=\"https://react.dev/learn/rendering-lists#keeping-list-items-in-order-with-key\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">tell React to remount the component</a>. To do this for all pages, you can use a custom app:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function MyApp({ Component, pageProps }) {\n  const router = useRouter()\n  return &lt;Component key={router.asPath} {...pageProps} /&gt;\n}</pre></div> </li> </ul> <h4 id=\"with-url-object\" data-docs-heading=\"\">With URL object     </h4> <p>You can use a URL object in the same way you can use it for <a href=\"../components/link#with-url-object\"><code>next/link</code></a>. Works for both the <code>url</code> and <code>as</code> parameters:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function ReadMore({ post }) {\n  const router = useRouter()\n \n  return (\n    &lt;button\n      type=\"button\"\n      onClick={() =&gt; {\n        router.push({\n          pathname: '/post/[pid]',\n          query: { pid: post.id },\n        })\n      }}\n    &gt;\n      Click here to read more\n    &lt;/button&gt;\n  )\n}</pre>\n</div> <h3 id=\"routerreplace\" data-docs-heading=\"\">router.replace     </h3> <p>Similar to the <code>replace</code> prop in <a href=\"../components/link\"><code>next/link</code></a>, <code>router.replace</code> will prevent adding a new URL entry into the <code>history</code> stack.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">router.replace(url, as, options)</pre>\n</div> <ul> <li>The API for <code>router.replace</code> is exactly the same as the API for <a href=\"#routerpush\"><code>router.push</code></a>.</li> </ul> <p>Take a look at the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.replace('/home')}&gt;\n      Click me\n    &lt;/button&gt;\n  )\n}</pre>\n</div> <h3 id=\"routerprefetch\" data-docs-heading=\"\">router.prefetch     </h3> <p>Prefetch pages for faster client-side transitions. This method is only useful for navigations without <a href=\"../components/link\"><code>next/link</code></a>, as <code>next/link</code> takes care of prefetching pages automatically.</p> <blockquote class=\"p-3 text-sm\"> <p>This is a production only feature. Next.js doesn't prefetch pages in development.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">router.prefetch(url, as, options)</pre>\n</div> <ul> <li>\n<code>url</code> - The URL to prefetch, including explicit routes (e.g. <code>/dashboard</code>) and dynamic routes (e.g. <code>/product/[id]</code>)</li> <li>\n<code>as</code> - Optional decorator for <code>url</code>. Before Next.js 9.5.3 this was used to prefetch dynamic routes.</li> <li>\n<code>options</code> - Optional object with the following allowed fields: <ul> <li>\n<code>locale</code> - allows providing a different locale from the active one. If <code>false</code>, <code>url</code> has to include the locale as the active locale won't be used.</li> </ul> </li> </ul> <p>Let's say you have a login page, and after a login, you redirect the user to the dashboard. For that case, we can prefetch the dashboard to make a faster transition, like in the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useCallback, useEffect } from 'react'\nimport { useRouter } from 'next/router'\n \nexport default function Login() {\n  const router = useRouter()\n  const handleSubmit = useCallback((e) =&gt; {\n    e.preventDefault()\n \n    fetch('/api/login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        /* Form data */\n      }),\n    }).then((res) =&gt; {\n      // Do a fast client-side transition to the already prefetched dashboard page\n      if (res.ok) router.push('/dashboard')\n    })\n  }, [])\n \n  useEffect(() =&gt; {\n    // Prefetch the dashboard page\n    router.prefetch('/dashboard')\n  }, [router])\n \n  return (\n    &lt;form onSubmit={handleSubmit}&gt;\n      {/* Form fields */}\n      &lt;button type=\"submit\"&gt;Login&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</pre>\n</div> <h3 id=\"routerbeforepopstate\" data-docs-heading=\"\">router.beforePopState     </h3> <p>In some cases (for example, if using a <a href=\"../../building-your-application/configuring/custom-server\">Custom Server</a>), you may wish to listen to <a href=\"https://developer.mozilla.org/docs/Web/Events/popstate\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">popstate</a> and do something before the router acts on it.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">router.beforePopState(cb)</pre>\n</div> <ul> <li>\n<code>cb</code> - The function to run on incoming <code>popstate</code> events. The function receives the state of the event as an object with the following props: <ul> <li>\n<code>url</code>: <code>String</code> - the route for the new state. This is usually the name of a <code>page</code>\n</li> <li>\n<code>as</code>: <code>String</code> - the url that will be shown in the browser</li> <li>\n<code>options</code>: <code>Object</code> - Additional options sent by <a href=\"#routerpush\">router.push</a>\n</li> </ul> </li> </ul> <p>If <code>cb</code> returns <code>false</code>, the Next.js router will not handle <code>popstate</code>, and you'll be responsible for handling it in that case. See <a href=\"../../building-your-application/configuring/custom-server#disabling-file-system-routing\">Disabling file-system routing</a>.</p> <p>You could use <code>beforePopState</code> to manipulate the request, or force a SSR refresh, as in the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n \nexport default function Page() {\n  const router = useRouter()\n \n  useEffect(() =&gt; {\n    router.beforePopState(({ url, as, options }) =&gt; {\n      // I only want to allow these two routes!\n      if (as !== '/' &amp;&amp; as !== '/other') {\n        // Have SSR render bad routes as a 404.\n        window.location.href = as\n        return false\n      }\n \n      return true\n    })\n  }, [router])\n \n  return &lt;p&gt;Welcome to the page&lt;/p&gt;\n}</pre>\n</div> <h3 id=\"routerback\" data-docs-heading=\"\">router.back     </h3> <p>Navigate back in history. Equivalent to clicking the browsers back button. It executes <code>window.history.back()</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.back()}&gt;\n      Click here to go back\n    &lt;/button&gt;\n  )\n}</pre>\n</div> <h3 id=\"routerreload\" data-docs-heading=\"\">router.reload     </h3> <p>Reload the current URL. Equivalent to clicking the browsers refresh button. It executes <code>window.location.reload()</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useRouter } from 'next/router'\n \nexport default function Page() {\n  const router = useRouter()\n \n  return (\n    &lt;button type=\"button\" onClick={() =&gt; router.reload()}&gt;\n      Click here to reload\n    &lt;/button&gt;\n  )\n}</pre>\n</div> <h3 id=\"routerevents\" data-docs-heading=\"\">router.events     </h3> <p>You can listen to different events happening inside the Next.js Router. Here's a list of supported events:</p> <ul> <li>\n<code>routeChangeStart(url, { shallow })</code> - Fires when a route starts to change</li> <li>\n<code>routeChangeComplete(url, { shallow })</code> - Fires when a route changed completely</li> <li>\n<code>routeChangeError(err, url, { shallow })</code> - Fires when there's an error when changing routes, or a route load is cancelled <ul> <li>\n<code>err.cancelled</code> - Indicates if the navigation was cancelled</li> </ul> </li> <li>\n<code>beforeHistoryChange(url, { shallow })</code> - Fires before changing the browser's history</li> <li>\n<code>hashChangeStart(url, { shallow })</code> - Fires when the hash will change but not the page</li> <li>\n<code>hashChangeComplete(url, { shallow })</code> - Fires when the hash has changed but not the page</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Here <code>url</code> is the URL shown in the browser, including the <a href=\"../../../app/api-reference/next-config-js/basepath\"><code>basePath</code></a>.</p> </blockquote> <p>For example, to listen to the router event <code>routeChangeStart</code>, open or create <code>pages/_app.js</code> and subscribe to the event, like so:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n \nexport default function MyApp({ Component, pageProps }) {\n  const router = useRouter()\n \n  useEffect(() =&gt; {\n    const handleRouteChange = (url, { shallow }) =&gt; {\n      console.log(\n        `App is changing to ${url} ${\n          shallow ? 'with' : 'without'\n        } shallow routing`\n      )\n    }\n \n    router.events.on('routeChangeStart', handleRouteChange)\n \n    // If the component is unmounted, unsubscribe\n    // from the event with the `off` method:\n    return () =&gt; {\n      router.events.off('routeChangeStart', handleRouteChange)\n    }\n  }, [router])\n \n  return &lt;Component {...pageProps} /&gt;\n}</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p>We use a <a href=\"../../building-your-application/routing/custom-app\">Custom App</a> (<code>pages/_app.js</code>) for this example to subscribe to the event because it's not unmounted on page navigations, but you can subscribe to router events on any component in your application.</p> </blockquote> <p>Router events should be registered when a component mounts (<a href=\"https://react.dev/reference/react/useEffect\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">useEffect</a> or <a href=\"https://react.dev/reference/react/Component#componentdidmount\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">componentDidMount</a> / <a href=\"https://react.dev/reference/react/Component#componentwillunmount\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">componentWillUnmount</a>) or imperatively when an event happens.</p> <p>If a route load is cancelled (for example, by clicking two links rapidly in succession), <code>routeChangeError</code> will fire. And the passed <code>err</code> will contain a <code>cancelled</code> property set to <code>true</code>, as in the following example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n \nexport default function MyApp({ Component, pageProps }) {\n  const router = useRouter()\n \n  useEffect(() =&gt; {\n    const handleRouteChangeError = (err, url) =&gt; {\n      if (err.cancelled) {\n        console.log(`Route to ${url} was cancelled!`)\n      }\n    }\n \n    router.events.on('routeChangeError', handleRouteChangeError)\n \n    // If the component is unmounted, unsubscribe\n    // from the event with the `off` method:\n    return () =&gt; {\n      router.events.off('routeChangeError', handleRouteChangeError)\n    }\n  }, [router])\n \n  return &lt;Component {...pageProps} /&gt;\n}</pre>\n</div> <h2 id=\"potential-eslint-errors\" data-docs-heading=\"\">Potential ESLint errors     </h2> <p>Certain methods accessible on the <code>router</code> object return a Promise. If you have the ESLint rule, <a href=\"https://typescript-eslint.io/rules/no-floating-promises\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">no-floating-promises</a> enabled, consider disabling it either globally, or for the affected line.</p> <p>If your application needs this rule, you should either <code>void</code> the promise  or use an <code>async</code> function, <code>await</code> the Promise, then void the function call. <strong>This is not applicable when the method is called from inside an <code>onClick</code> handler</strong>.</p> <p>The affected methods are:</p> <ul> <li><code>router.push</code></li> <li><code>router.replace</code></li> <li><code>router.prefetch</code></li> </ul> <h3 id=\"potential-solutions\" data-docs-heading=\"\">Potential solutions     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useEffect } from 'react'\nimport { useRouter } from 'next/router'\n \n// Here you would fetch and return the user\nconst useUser = () =&gt; ({ user: null, loading: false })\n \nexport default function Page() {\n  const { user, loading } = useUser()\n  const router = useRouter()\n \n  useEffect(() =&gt; {\n    // disable the linting on the next line - This is the cleanest solution\n    // eslint-disable-next-line no-floating-promises\n    router.push('/login')\n \n    // void the Promise returned by router.push\n    if (!(user || loading)) {\n      void router.push('/login')\n    }\n    // or use an async function, await the Promise, then void the function call\n    async function handleRouteChange() {\n      if (!(user || loading)) {\n        await router.push('/login')\n      }\n    }\n    void handleRouteChange()\n  }, [user, loading])\n \n  return &lt;p&gt;Redirecting...&lt;/p&gt;\n}</pre>\n</div> <h2 id=\"withrouter\" data-docs-heading=\"\">withRouter     </h2> <p>If <a href=\"#router-object\"><code>useRouter</code></a> is not the best fit for you, <code>withRouter</code> can also add the same <a href=\"#router-object\"><code>router</code> object</a> to any component.</p> <h3 id=\"usage\" data-docs-heading=\"\">Usage     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { withRouter } from 'next/router'\n \nfunction Page({ router }) {\n  return &lt;p&gt;{router.pathname}&lt;/p&gt;\n}\n \nexport default withRouter(Page)</pre>\n</div> <h3 id=\"typescript\" data-docs-heading=\"\">TypeScript     </h3> <p>To use class components with <code>withRouter</code>, the component needs to accept a router prop:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nimport { withRouter, NextRouter } from 'next/router'\n \ninterface WithRouterProps {\n  router: NextRouter\n}\n \ninterface MyComponentProps extends WithRouterProps {}\n \nclass MyComponent extends React.Component&lt;MyComponentProps&gt; {\n  render() {\n    return &lt;p&gt;{this.props.router.pathname}&lt;/p&gt;\n  }\n}\n \nexport default withRouter(MyComponent)</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/use-router\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/use-router</a>\n  </p>\n</div>\n","pages/api-reference/functions/next-request":"<h1 class=\"break-words\">NextRequest</h1> <p>NextRequest extends the <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Request API</a> with additional convenience methods.</p> <h2 id=\"cookies\" data-docs-heading=\"\">cookies     </h2> <p>Read or mutate the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Set-Cookie</code></a> header of the request.</p> <h3 id=\"setname-value\" data-docs-heading=\"\">set(name, value)     </h3> <p>Given a name, set a cookie with the given value on the request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\n// Set a cookie to hide the banner\n// request will have a `Set-Cookie:show-banner=false;path=/home` header\nrequest.cookies.set('show-banner', 'false')</pre>\n</div> <h3 id=\"getname\" data-docs-heading=\"\">get(name)     </h3> <p>Given a cookie name, return the value of the cookie. If the cookie is not found, <code>undefined</code> is returned. If multiple cookies are found, the first one is returned.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\n// { name: 'show-banner', value: 'false', Path: '/home' }\nrequest.cookies.get('show-banner')</pre>\n</div> <h3 id=\"getall\" data-docs-heading=\"\">getAll()     </h3> <p>Given a cookie name, return the values of the cookie. If no name is given, return all cookies on the request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given incoming request /home\n// [\n//   { name: 'experiments', value: 'new-pricing-page', Path: '/home' },\n//   { name: 'experiments', value: 'winter-launch', Path: '/home' },\n// ]\nrequest.cookies.getAll('experiments')\n// Alternatively, get all cookies for the request\nrequest.cookies.getAll()</pre>\n</div> <h3 id=\"deletename\" data-docs-heading=\"\">delete(name)     </h3> <p>Given a cookie name, delete the cookie from the request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Returns true for deleted, false is nothing is deleted\nrequest.cookies.delete('experiments')</pre>\n</div> <h3 id=\"hasname\" data-docs-heading=\"\">has(name)     </h3> <p>Given a cookie name, return <code>true</code> if the cookie exists on the request.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Returns true if cookie exists, false if it does not\nrequest.cookies.has('experiments')</pre>\n</div> <h3 id=\"clear\" data-docs-heading=\"\">clear()     </h3> <p>Remove the <code>Set-Cookie</code> header from the request.</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">request.cookies.clear()</pre>\n</div> <h2 id=\"nexturl\" data-docs-heading=\"\">nextUrl     </h2> <p>Extends the native <a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URL</code></a> API with additional convenience methods, including Next.js specific properties.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Given a request to /home, pathname is /home\nrequest.nextUrl.pathname\n// Given a request to /home?name=lee, searchParams is { 'name': 'lee' }\nrequest.nextUrl.searchParams</pre>\n</div> <p>The following options are available:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Property</th>\n<th>Type</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>basePath</code></td>\n<td><code>string</code></td>\n<td>The <a href=\"../next-config-js/basepath\">base path</a> of the URL.</td>\n</tr>\n<tr>\n<td><code>buildId</code></td>\n<td>\n<code>string</code> | <code>undefined</code>\n</td>\n<td>The build identifier of the Next.js application. Can be <a href=\"../next-config-js/generatebuildid\">customized</a>.</td>\n</tr>\n<tr>\n<td><code>defaultLocale</code></td>\n<td>\n<code>string</code> | <code>undefined</code>\n</td>\n<td>The default locale for <a href=\"../../building-your-application/routing/internationalization\">internationalization</a>.</td>\n</tr>\n<tr>\n<td><code>domainLocale</code></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>- <code>defaultLocale</code>\n</td>\n<td><code>string</code></td>\n<td>The default locale within a domain.</td>\n</tr>\n<tr>\n<td>- <code>domain</code>\n</td>\n<td><code>string</code></td>\n<td>The domain associated with a specific locale.</td>\n</tr>\n<tr>\n<td>- <code>http</code>\n</td>\n<td>\n<code>boolean</code> | <code>undefined</code>\n</td>\n<td>Indicates if the domain is using HTTP.</td>\n</tr>\n<tr>\n<td><code>locales</code></td>\n<td>\n<code>string[]</code> | <code>undefined</code>\n</td>\n<td>An array of available locales.</td>\n</tr>\n<tr>\n<td><code>locale</code></td>\n<td>\n<code>string</code> | <code>undefined</code>\n</td>\n<td>The currently active locale.</td>\n</tr>\n<tr>\n<td><code>url</code></td>\n<td><code>URL</code></td>\n<td>The URL object.</td>\n</tr>\n</tbody>\n</table></div>  <h2 id=\"ip\" data-docs-heading=\"\">ip     </h2> <p>The <code>ip</code> property is a string that contains the IP address of the request. This value can optionally be provided by your hosting platform.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> On <a href=\"https://vercel.com/docs/frameworks/nextjs?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, this value is provided by default. On other platforms, you can use the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Forwarded-For\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>X-Forwarded-For</code></a> header to provide the IP address.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Provided by Vercel\nrequest.ip\n// Self-hosting\nrequest.headers.get('X-Forwarded-For')</pre>\n</div> <h2 id=\"geo\" data-docs-heading=\"\">geo     </h2> <p>The <code>geo</code> property is an object that contains the geographic information of the request. This value can optionally be provided by your hosting platform.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong> On <a href=\"https://vercel.com/docs/frameworks/nextjs?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, this value is provided by default. On other platforms, you can use the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Forwarded-For\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>X-Forwarded-For</code></a> header to provide the IP address, then use a <a href=\"https://ip-api.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">third-party service</a> to lookup the geographic information.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Provided by Vercel\nrequest.geo.city\nrequest.geo.country\nrequest.geo.region\nrequest.geo.latitude\nrequest.geo.longitude\n \n// Self-hosting\nfunction getGeo(request) {\n  let ip = request.headers.get('X-Forwarded-For')\n  // Use a third-party service to lookup the geographic information\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/next-request\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/next-request</a>\n  </p>\n</div>\n","pages/api-reference/functions/use-report-web-vitals":"<h1 class=\"break-words\">useReportWebVitals</h1> <p>The <code>useReportWebVitals</code> hook allows you to report <a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Core Web Vitals</a>, and can be used in combination with your analytics service.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useReportWebVitals } from 'next/web-vitals'\n \nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals((metric) =&gt; {\n    console.log(metric)\n  })\n \n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>  <h2 id=\"usereportwebvitals\" data-docs-heading=\"\">useReportWebVitals     </h2> <p>The <code>metric</code> object passed as the hook's argument consists of a number of properties:</p> <ul> <li>\n<code>id</code>: Unique identifier for the metric in the context of the current page load</li> <li>\n<code>name</code>: The name of the performance metric. Possible values include names of <a href=\"#web-vitals\">Web Vitals</a> metrics (TTFB, FCP, LCP, FID, CLS) specific to a web application.</li> <li>\n<code>delta</code>: The difference between the current value and the previous value of the metric. The value is typically in milliseconds and represents the change in the metric's value over time.</li> <li>\n<code>entries</code>: An array of <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceEntry\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Performance Entries</a> associated with the metric. These entries provide detailed information about the performance events related to the metric.</li> <li>\n<code>navigationType</code>: Indicates the <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceNavigationTiming/type\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">type of navigation</a> that triggered the metric collection. Possible values include <code>\"navigate\"</code>, <code>\"reload\"</code>, <code>\"back_forward\"</code>, and <code>\"prerender\"</code>.</li> <li>\n<code>rating</code>: A qualitative rating of the metric value, providing an assessment of the performance. Possible values are <code>\"good\"</code>, <code>\"needs-improvement\"</code>, and <code>\"poor\"</code>. The rating is typically determined by comparing the metric value against predefined thresholds that indicate acceptable or suboptimal performance.</li> <li>\n<code>value</code>: The actual value or duration of the performance entry, typically in milliseconds. The value provides a quantitative measure of the performance aspect being tracked by the metric. The source of the value depends on the specific metric being measured and can come from various <a href=\"https://developer.mozilla.org/docs/Web/API/Performance_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Performance API</a>s.</li> </ul> <h2 id=\"web-vitals\" data-docs-heading=\"\">Web Vitals     </h2> <p><a href=\"https://web.dev/vitals/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Vitals</a> are a set of useful metrics that aim to capture the user experience of a web page. The following web vitals are all included:</p> <ul> <li>\n<a href=\"https://developer.mozilla.org/docs/Glossary/Time_to_first_byte\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Time to First Byte</a> (TTFB)</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Glossary/First_contentful_paint\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Contentful Paint</a> (FCP)</li> <li>\n<a href=\"https://web.dev/lcp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Largest Contentful Paint</a> (LCP)</li> <li>\n<a href=\"https://web.dev/fid/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">First Input Delay</a> (FID)</li> <li>\n<a href=\"https://web.dev/cls/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cumulative Layout Shift</a> (CLS)</li> <li>\n<a href=\"https://web.dev/inp/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Interaction to Next Paint</a> (INP)</li> </ul> <p>You can handle all the results of these metrics using the <code>name</code> property.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useReportWebVitals } from 'next/web-vitals'\n \nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals((metric) =&gt; {\n    switch (metric.name) {\n      case 'FCP': {\n        // handle FCP results\n      }\n      case 'LCP': {\n        // handle LCP results\n      }\n      // ...\n    }\n  })\n \n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>  <h2 id=\"custom-metrics\" data-docs-heading=\"\">Custom Metrics     </h2>\n<p>In addition to the core metrics listed above, there are some additional custom metrics that measure the time it takes for the page to hydrate and render:</p>\n<ul> <li>\n<code>Next.js-hydration</code>: Length of time it takes for the page to start and finish hydrating (in ms)</li> <li>\n<code>Next.js-route-change-to-render</code>: Length of time it takes for a page to start rendering after a route change (in ms)</li> <li>\n<code>Next.js-render</code>: Length of time it takes for a page to finish render after a route change (in ms)</li> </ul>\n<p>You can handle all the results of these metrics separately:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { useReportWebVitals } from 'next/web-vitals'\n \nfunction MyApp({ Component, pageProps }) {\n  useReportWebVitals((metric) =&gt; {\n    switch (metric.name) {\n      case 'Next.js-hydration':\n        // handle hydration results\n        break\n      case 'Next.js-route-change-to-render':\n        // handle route-change to render results\n        break\n      case 'Next.js-render':\n        // handle render results\n        break\n      default:\n        break\n    }\n  })\n \n  return &lt;Component {...pageProps} /&gt;\n}</pre></div>\n<p>These metrics work in all browsers that support the <a href=\"https://caniuse.com/#feat=user-timing\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">User Timing API</a>.</p> <h2 id=\"usage-on-vercel\" data-docs-heading=\"\">Usage on Vercel     </h2> <p><a href=\"https://vercel.com/docs/concepts/speed-insights\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel Speed Insights</a> are automatically configured on Vercel deployments, and don't require the use of <code>useReportWebVitals</code>. This hook is useful in local development, or if you're using a different analytics service.</p> <h2 id=\"sending-results-to-external-systems\" data-docs-heading=\"\">Sending results to external systems     </h2> <p>You can send results to any endpoint to measure and track real user performance on your site. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useReportWebVitals((metric) =&gt; {\n  const body = JSON.stringify(metric)\n  const url = 'https://example.com/analytics'\n \n  // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.\n  if (navigator.sendBeacon) {\n    navigator.sendBeacon(url, body)\n  } else {\n    fetch(url, { body, method: 'POST', keepalive: true })\n  }\n})</pre>\n</div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: If you use <a href=\"https://analytics.google.com/analytics/web/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Analytics</a>, using the <code>id</code> value can allow you to construct metric distributions manually (to calculate percentiles, etc.)</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">useReportWebVitals(metric =&gt; {\n  // Use `window.gtag` if you initialized Google Analytics as this example:\n  // https://github.com/vercel/next.js/blob/canary/examples/with-google-analytics/pages/_app.js\n  window.gtag('event', metric.name, {\n    value: Math.round(metric.name === 'CLS' ? metric.value * 1000 : metric.value), // values must be integers\n    event_label: metric.id, // id unique to current page load\n    non_interaction: true, // avoids affecting bounce rate.\n  });\n}</pre>\n</div> <p>Read more about <a href=\"https://github.com/GoogleChrome/web-vitals#send-the-results-to-google-analytics\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">sending results to Google Analytics</a>.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/use-report-web-vitals\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/use-report-web-vitals</a>\n  </p>\n</div>\n","pages/api-reference/functions/useragent":"<h1 class=\"break-words\">userAgent</h1> <p>The <code>userAgent</code> helper extends the <a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Web Request API</a> with additional properties and methods to interact with the user agent object from the request.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse, userAgent } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  const url = request.nextUrl\n  const { device } = userAgent(request)\n  const viewport = device.type === 'mobile' ? 'mobile' : 'desktop'\n  url.searchParams.set('viewport', viewport)\n  return NextResponse.rewrite(url)\n}</pre></div>  <h2 id=\"isbot\" data-docs-heading=\"\">isBot     </h2> <p>A boolean indicating whether the request comes from a known bot.</p> <h2 id=\"browser\" data-docs-heading=\"\">browser     </h2> <p>An object containing information about the browser used in the request.</p> <ul> <li>\n<code>name</code>: A string representing the browser's name, or <code>undefined</code> if not identifiable.</li> <li>\n<code>version</code>: A string representing the browser's version, or <code>undefined</code>.</li> </ul> <h2 id=\"device\" data-docs-heading=\"\">device     </h2> <p>An object containing information about the device used in the request.</p> <ul> <li>\n<code>model</code>: A string representing the model of the device, or <code>undefined</code>.</li> <li>\n<code>type</code>: A string representing the type of the device, such as <code>console</code>, <code>mobile</code>, <code>tablet</code>, <code>smarttv</code>, <code>wearable</code>, <code>embedded</code>, or <code>undefined</code>.</li> <li>\n<code>vendor</code>: A string representing the vendor of the device, or <code>undefined</code>.</li> </ul> <h2 id=\"engine\" data-docs-heading=\"\">engine     </h2> <p>An object containing information about the browser's engine.</p> <ul> <li>\n<code>name</code>: A string representing the engine's name. Possible values include: <code>Amaya</code>, <code>Blink</code>, <code>EdgeHTML</code>, <code>Flow</code>, <code>Gecko</code>, <code>Goanna</code>, <code>iCab</code>, <code>KHTML</code>, <code>Links</code>, <code>Lynx</code>, <code>NetFront</code>, <code>NetSurf</code>, <code>Presto</code>, <code>Tasman</code>, <code>Trident</code>, <code>w3m</code>, <code>WebKit</code> or <code>undefined</code>.</li> <li>\n<code>version</code>: A string representing the engine's version, or <code>undefined</code>.</li> </ul> <h2 id=\"os\" data-docs-heading=\"\">os     </h2> <p>An object containing information about the operating system.</p> <ul> <li>\n<code>name</code>: A string representing the name of the OS, or <code>undefined</code>.</li> <li>\n<code>version</code>: A string representing the version of the OS, or <code>undefined</code>.</li> </ul> <h2 id=\"cpu\" data-docs-heading=\"\">cpu     </h2> <p>An object containing information about the CPU architecture.</p> <ul> <li>\n<code>architecture</code>: A string representing the architecture of the CPU. Possible values include: <code>68k</code>, <code>amd64</code>, <code>arm</code>, <code>arm64</code>, <code>armhf</code>, <code>avr</code>, <code>ia32</code>, <code>ia64</code>, <code>irix</code>, <code>irix64</code>, <code>mips</code>, <code>mips64</code>, <code>pa-risc</code>, <code>ppc</code>, <code>sparc</code>, <code>sparc64</code> or <code>undefined</code>\n</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/functions/userAgent\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/functions/userAgent</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js":"<h1 class=\"break-words\">next.config.js Options</h1> <p>Next.js can be configured through a <code>next.config.js</code> file in the root of your project directory (for example, by <code>package.json</code>) with a default export.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  /* config options here */\n}\n \nmodule.exports = nextConfig</pre></div> <p><code>next.config.js</code> is a regular Node.js module, not a JSON file. It gets used by the Next.js server and build phases, and it's not included in the browser build.</p> <p>If you need <a href=\"https://nodejs.org/api/esm.html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">ECMAScript modules</a>, you can use <code>next.config.mjs</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \n/**\n * @type {import('next').NextConfig}\n */\nconst nextConfig = {\n  /* config options here */\n}\n \nexport default nextConfig</pre></div> <p>You can also use a function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \nexport default (phase, { defaultConfig }) =&gt; {\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    /* config options here */\n  }\n  return nextConfig\n}</pre></div> <p>Since Next.js 12.1.0, you can use an async function:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \nmodule.exports = async (phase, { defaultConfig }) =&gt; {\n  /**\n   * @type {import('next').NextConfig}\n   */\n  const nextConfig = {\n    /* config options here */\n  }\n  return nextConfig\n}</pre></div> <p><code>phase</code> is the current context in which the configuration is loaded. You can see the <a href=\"https://github.com/vercel/next.js/blob/5e6b008b561caf2710ab7be63320a3d549474a5b/packages/next/shared/lib/constants.ts#L19-L23\" rel=\"noopener noreferrer\" target=\"_blank\">available phases</a>. Phases can be imported from <code>next/constants</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// @ts-check\n \nconst { PHASE_DEVELOPMENT_SERVER } = require('next/constants')\n \nmodule.exports = (phase, { defaultConfig }) =&gt; {\n  if (phase === PHASE_DEVELOPMENT_SERVER) {\n    return {\n      /* development only config options here */\n    }\n  }\n \n  return {\n    /* config options for all phases except development here */\n  }\n}</pre>\n</div> <p>The commented lines are the place where you can put the configs allowed by <code>next.config.js</code>, which are <a href=\"https://github.com/vercel/next.js/blob/canary/packages/next/src/server/config-shared.ts\" rel=\"noopener noreferrer\" target=\"_blank\">defined in this file</a>.</p> <p>However, none of the configs are required, and it's not necessary to understand what each config does. Instead, search for the features you need to enable or modify in this section and they will show you what to do.</p> <blockquote class=\"p-3 text-sm\"> <p>Avoid using new JavaScript features not available in your target Node.js version. <code>next.config.js</code> will not be parsed by Webpack, Babel or TypeScript.</p> </blockquote> <p>This page documents all the available configuration options:</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/basepath":"<h1 class=\"break-words\">basePath</h1> <p>To deploy a Next.js application under a sub-path of a domain you can use the <code>basePath</code> config option.</p> <p><code>basePath</code> allows you to set a path prefix for the application. For example, to use <code>/docs</code> instead of <code>''</code> (an empty string, the default), open <code>next.config.js</code> and add the <code>basePath</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  basePath: '/docs',\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This value must be set at build time and cannot be changed without re-building as the value is inlined in the client-side bundles.</p> </blockquote> <h3 id=\"links\" data-docs-heading=\"\">Links     </h3> <p>When linking to other pages using <code>next/link</code> and <code>next/router</code> the <code>basePath</code> will be automatically applied.</p> <p>For example, using <code>/about</code> will automatically become <code>/docs/about</code> when <code>basePath</code> is set to <code>/docs</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function HomePage() {\n  return (\n    &lt;&gt;\n      &lt;Link href=\"/about\"&gt;About Page&lt;/Link&gt;\n    &lt;/&gt;\n  )\n}</pre>\n</div> <p>Output html:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;a href=\"/docs/about\"&gt;About Page&lt;/a&gt;</pre>\n</div> <p>This makes sure that you don't have to change all links in your application when changing the <code>basePath</code> value.</p> <h3 id=\"images\" data-docs-heading=\"\">Images     </h3>  <p>When using the <a href=\"../components/image\"><code>next/image</code></a> component, you will need to add the <code>basePath</code> in front of <code>src</code>.</p> <p>For example, using <code>/docs/me.png</code> will properly serve your image when <code>basePath</code> is set to <code>/docs</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nfunction Home() {\n  return (\n    &lt;&gt;\n      &lt;h1&gt;My Homepage&lt;/h1&gt;\n      &lt;Image\n        src=\"/docs/me.png\"\n        alt=\"Picture of the author\"\n        width={500}\n        height={500}\n      /&gt;\n      &lt;p&gt;Welcome to my homepage!&lt;/p&gt;\n    &lt;/&gt;\n  )\n}\n \nexport default Home</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/basePath\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/basePath</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/compress":"<h1 class=\"break-words\">compress</h1> <p>By default, Next.js uses <code>gzip</code> to compress rendered content and static files when using <code>next start</code> or a custom server. This is an optimization for applications that do not have compression configured. If compression is <em>already</em> configured in your application via a custom server, Next.js will not add compression.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>When hosting your application on <a href=\"https://vercel.com/docs/edge-network/compression\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, compression uses <code>brotli</code> first, then <code>gzip</code>.</li> <li>You can check if compression is enabled and which algorithm is used by looking at the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Accept-Encoding</code></a> (browser accepted options) and <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Encoding\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Content-Encoding</code></a> (currently used) headers in the response.</li> </ul> </blockquote> <h2 id=\"disabling-compression\" data-docs-heading=\"\">Disabling compression     </h2> <p>To disable <strong>compression</strong>, set the <code>compress</code> config option to <code>false</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compress: false,\n}</pre></div> <p>We do not recommend disabling compression unless you have compression configured on your server, as compression reduces bandwidth usage and improves the performance of your application.</p> <h2 id=\"changing-the-compression-algorithm\" data-docs-heading=\"\">Changing the compression algorithm     </h2> <p>To change your compression algorithm, you will need to configure your custom server and set the <code>compress</code> option to <code>false</code> in your <code>next.config.js</code> file.</p> <p>For example, you're using <a href=\"https://www.nginx.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">nginx</a> and want to switch to <code>brotli</code>, set the <code>compress</code> option to <code>false</code> to allow nginx to handle compression.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>For Next.js applications on Vercel, compression is handled by the Vercel's Edge Network and not Next.js. See the <a href=\"https://vercel.com/docs/edge-network/compression\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel documentation</a> for more information.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/compress\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/compress</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/crossorigin":"<h1 class=\"break-words\">crossOrigin</h1> <p>Use the <code>crossOrigin</code> option to add a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>crossOrigin</code> attribute</a> in all <code>&lt;script&gt;</code> tags generated by the  <a href=\"../../building-your-application/optimizing/scripts\"><code>next/script</code></a> and <a href=\"../components/head\"><code>next/head</code></a>components, and define how cross-origin requests should be handled.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  crossOrigin: 'anonymous',\n}</pre></div> <h2 id=\"options\" data-docs-heading=\"\">Options     </h2> <ul> <li>\n<code>'anonymous'</code>: Adds <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin#anonymous\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>crossOrigin=\"anonymous\"</code></a> attribute.</li> <li>\n<code>'use-credentials'</code>: Adds <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin#use-credentials\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>crossOrigin=\"use-credentials\"</code></a>.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/crossOrigin\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/crossOrigin</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/devindicators":"<h1 class=\"break-words\">devIndicators</h1>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This indicator was removed in Next.js version 10.0.1. We recommend upgrading to the latest version of Next.js.</p> </blockquote>\n<p>When a page qualifies for <a href=\"../../building-your-application/rendering/automatic-static-optimization\">Automatic Static Optimization</a> we show an indicator to let you know.</p>\n<p>This is helpful since automatic static optimization can be very beneficial and knowing immediately in development if the page qualifies can be useful.</p>\n<p>In some cases this indicator might not be useful, like when working on electron applications. To remove it open <code>next.config.js</code> and disable the <code>autoPrerender</code> config in <code>devIndicators</code>:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  devIndicators: {\n    autoPrerender: false,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/devIndicators\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/devIndicators</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/distdir":"<h1 class=\"break-words\">distDir</h1> <p>You can specify a name to use for a custom build directory to use instead of <code>.next</code>.</p> <p>Open <code>next.config.js</code> and add the <code>distDir</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  distDir: 'build',\n}</pre></div> <p>Now if you run <code>next build</code> Next.js will use <code>build</code> instead of the default <code>.next</code> folder.</p> <blockquote class=\"p-3 text-sm\"> <p><code>distDir</code> <strong>should not</strong> leave your project directory. For example, <code>../build</code> is an <strong>invalid</strong> directory.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/distDir\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/distDir</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/assetprefix":"<h1 class=\"break-words\">assetPrefix</h1>  <blockquote class=\"p-3 text-sm\"> <p><strong>Attention</strong>: <a href=\"../../building-your-application/deploying\">Deploying to Vercel</a> automatically configures a global CDN for your Next.js project. You do not need to manually setup an Asset Prefix.</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Next.js 9.5+ added support for a customizable <a href=\"../../../app/api-reference/next-config-js/basepath\">Base Path</a>, which is better suited for hosting your application on a sub-path like <code>/docs</code>. We do not suggest you use a custom Asset Prefix for this use case.</p> </blockquote> <p>To set up a <a href=\"https://en.wikipedia.org/wiki/Content_delivery_network\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">CDN</a>, you can set up an asset prefix and configure your CDN's origin to resolve to the domain that Next.js is hosted on.</p> <p>Open <code>next.config.js</code> and add the <code>assetPrefix</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const isProd = process.env.NODE_ENV === 'production'\n \nmodule.exports = {\n  // Use the CDN in production and localhost for development.\n  assetPrefix: isProd ? 'https://cdn.mydomain.com' : undefined,\n}</pre></div> <p>Next.js will automatically use your asset prefix for the JavaScript and CSS files it loads from the <code>/_next/</code> path (<code>.next/static/</code> folder). For example, with the above configuration, the following request for a JS chunk:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/_next/static/chunks/4b9b41aaa062cbbfeff4add70f256968c51ece5d.4d708494b3aed70c04f0.js\n</pre>\n</div> <p>Would instead become:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">https://cdn.mydomain.com/_next/static/chunks/4b9b41aaa062cbbfeff4add70f256968c51ece5d.4d708494b3aed70c04f0.js\n</pre>\n</div> <p>The exact configuration for uploading your files to a given CDN will depend on your CDN of choice. The only folder you need to host on your CDN is the contents of <code>.next/static/</code>, which should be uploaded as <code>_next/static/</code> as the above URL request indicates. <strong>Do not upload the rest of your <code>.next/</code> folder</strong>, as you should not expose your server code and other configuration to the public.</p> <p>While <code>assetPrefix</code> covers requests to <code>_next/static</code>, it does not influence the following paths:</p>  <ul> <li>Files in the <a href=\"../../building-your-application/optimizing/static-assets\">public</a> folder; if you want to serve those assets over a CDN, you'll have to introduce the prefix yourself</li> <li>\n<code>/_next/data/</code> requests for <code>getServerSideProps</code> pages. These requests will always be made against the main domain since they're not static.</li> <li>\n<code>/_next/data/</code> requests for <code>getStaticProps</code> pages. These requests will always be made against the main domain to support <a href=\"../../building-your-application/data-fetching/incremental-static-regeneration\">Incremental Static Generation</a>, even if you're not using it (for consistency).</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/assetPrefix\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/assetPrefix</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/env":"<h1 class=\"break-words\">env</h1>  <blockquote class=\"p-3 text-sm\"> <p>Since the release of <a href=\"https://nextjs.org/blog/next-9-4\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js 9.4</a> we now have a more intuitive and ergonomic experience for <a href=\"../../building-your-application/configuring/environment-variables\">adding environment variables</a>. Give it a try!</p> </blockquote>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: environment variables specified in this way will <strong>always</strong> be included in the JavaScript bundle, prefixing the environment variable name with <code>NEXT_PUBLIC_</code> only has an effect when specifying them <a href=\"../../building-your-application/configuring/environment-variables\">through the environment or .env files</a>.</p> </blockquote> <p>To add environment variables to the JavaScript bundle, open <code>next.config.js</code> and add the <code>env</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  env: {\n    customKey: 'my-value',\n  },\n}</pre></div> <p>Now you can access <code>process.env.customKey</code> in your code. For example:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function Page() {\n  return &lt;h1&gt;The value of customKey is: {process.env.customKey}&lt;/h1&gt;\n}\n \nexport default Page</pre>\n</div> <p>Next.js will replace <code>process.env.customKey</code> with <code>'my-value'</code> at build time. Trying to destructure <code>process.env</code> variables won't work due to the nature of webpack <a href=\"https://webpack.js.org/plugins/define-plugin/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">DefinePlugin</a>.</p> <p>For example, the following line:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">return &lt;h1&gt;The value of customKey is: {process.env.customKey}&lt;/h1&gt;</pre>\n</div> <p>Will end up being:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">return &lt;h1&gt;The value of customKey is: {'my-value'}&lt;/h1&gt;</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/env\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/env</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/eslint":"<h1 class=\"break-words\">eslint</h1> <p>When ESLint is detected in your project, Next.js fails your <strong>production build</strong> (<code>next build</code>) when errors are present.</p> <p>If you'd like Next.js to produce production code even when your application has ESLint errors, you can disable the built-in linting step completely. This is not recommended unless you already have ESLint configured to run in a separate part of your workflow (for example, in CI or a pre-commit hook).</p> <p>Open <code>next.config.js</code> and enable the <code>ignoreDuringBuilds</code> option in the <code>eslint</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  eslint: {\n    // Warning: This allows production builds to successfully complete even if\n    // your project has ESLint errors.\n    ignoreDuringBuilds: true,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/eslint\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/eslint</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/generatebuildid":"<h1 class=\"break-words\">generateBuildId</h1> <p>Next.js generates an ID during <code>next build</code> to identify which version of your application is being served. The same build should be used and boot up multiple containers.</p> <p>If you are rebuilding for each stage of your environment, you will need to generate a consistent build ID to use between containers. Use the <code>generateBuildId</code> command in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  generateBuildId: async () =&gt; {\n    // This could be anything, using the latest git hash\n    return process.env.GIT_HASH\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/generateBuildId\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/generateBuildId</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/generateetags":"<h1 class=\"break-words\">generateEtags</h1> <p>Next.js will generate <a href=\"https://en.wikipedia.org/wiki/HTTP_ETag\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">etags</a> for every page by default. You may want to disable etag generation for HTML pages depending on your cache strategy.</p> <p>Open <code>next.config.js</code> and disable the <code>generateEtags</code> option:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  generateEtags: false,\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/generateEtags\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/generateEtags</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/headers":"<h1 class=\"break-words\">headers</h1> <p>Headers allow you to set custom HTTP headers on the response to an incoming request on a given path.</p> <p>To set custom HTTP headers you can use the <code>headers</code> key in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/about',\n        headers: [\n          {\n            key: 'x-custom-header',\n            value: 'my custom header value',\n          },\n          {\n            key: 'x-another-custom-header',\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <p><code>headers</code> is an async function that expects an array to be returned holding objects with <code>source</code> and <code>headers</code> properties:</p> <ul> <li>\n<code>source</code> is the incoming request path pattern.</li> <li>\n<code>headers</code> is an array of response header objects, with <code>key</code> and <code>value</code> properties.</li> <li>\n<code>basePath</code>: <code>false</code> or <code>undefined</code> - if false the basePath won't be included when matching, can be used for external rewrites only.</li> <li>\n<code>locale</code>: <code>false</code> or <code>undefined</code> - whether the locale should not be included when matching.</li> <li>\n<code>has</code> is an array of <a href=\"#header-cookie-and-query-matching\">has objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> <li>\n<code>missing</code> is an array of <a href=\"#header-cookie-and-query-matching\">missing objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> </ul> <p>Headers are checked before the filesystem which includes pages and <code>/public</code> files.</p> <h2 id=\"header-overriding-behavior\" data-docs-heading=\"\">Header Overriding Behavior     </h2> <p>If two headers match the same path and set the same header key, the last header key will override the first. Using the below headers, the path <code>/hello</code> will result in the header <code>x-hello</code> being <code>world</code> due to the last header value set being <code>world</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/:path*',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'there',\n          },\n        ],\n      },\n      {\n        source: '/hello',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"path-matching\" data-docs-heading=\"\">Path Matching     </h2> <p>Path matches are allowed, for example <code>/blog/:slug</code> will match <code>/blog/hello-world</code> (no nested paths):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:slug',\n        headers: [\n          {\n            key: 'x-slug',\n            value: ':slug', // Matched parameters can be used in the value\n          },\n          {\n            key: 'x-slug-:slug', // Matched parameters can be used in the key\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"wildcard-path-matching\" data-docs-heading=\"\">Wildcard Path Matching     </h3> <p>To match a wildcard path you can use <code>*</code> after a parameter, for example <code>/blog/:slug*</code> will match <code>/blog/a/b/c/d/hello-world</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:slug*',\n        headers: [\n          {\n            key: 'x-slug',\n            value: ':slug*', // Matched parameters can be used in the value\n          },\n          {\n            key: 'x-slug-:slug*', // Matched parameters can be used in the key\n            value: 'my other custom header value',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"regex-path-matching\" data-docs-heading=\"\">Regex Path Matching     </h3> <p>To match a regex path you can wrap the regex in parenthesis after a parameter, for example <code>/blog/:slug(\\\\d{1,})</code> will match <code>/blog/123</code> but not <code>/blog/abc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/blog/:post(\\\\d{1,})',\n        headers: [\n          {\n            key: 'x-post',\n            value: ':post',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <p>The following characters <code>(</code>, <code>)</code>, <code>{</code>, <code>}</code>, <code>:</code>, <code>*</code>, <code>+</code>, <code>?</code> are used for regex path matching, so when used in the <code>source</code> as non-special values they must be escaped by adding <code>\\\\</code> before them:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        headers: [\n          {\n            key: 'x-header',\n            value: 'value',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"header-cookie-and-query-matching\" data-docs-heading=\"\">Header, Cookie, and Query Matching     </h2> <p>To only apply a header when header, cookie, or query values also match the <code>has</code> field or don't match the <code>missing</code> field can be used. Both the <code>source</code> and all <code>has</code> items must match and all <code>missing</code> items must not match for the header to be applied.</p> <p><code>has</code> and <code>missing</code> items can have the following fields:</p> <ul> <li>\n<code>type</code>: <code>String</code> - must be either <code>header</code>, <code>cookie</code>, <code>host</code>, or <code>query</code>.</li> <li>\n<code>key</code>: <code>String</code> - the key from the selected type to match against.</li> <li>\n<code>value</code>: <code>String</code> or <code>undefined</code> - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value <code>first-(?&lt;paramName&gt;.*)</code> is used for <code>first-second</code> then <code>second</code> will be usable in the destination with <code>:paramName</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async headers() {\n    return [\n      // if the header `x-add-header` is present,\n      // the `x-another-header` header will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-add-header',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: 'hello',\n          },\n        ],\n      },\n      // if the header `x-no-header` is not present,\n      // the `x-another-header` header will be applied\n      {\n        source: '/:path*',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-no-header',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: 'hello',\n          },\n        ],\n      },\n      // if the source, query, and cookie are matched,\n      // the `x-authorized` header will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // header key/values since value is provided and\n            // doesn't use a named capture group e.g. (?&lt;page&gt;home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-authorized',\n            value: ':authorized',\n          },\n        ],\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, the `x-another-header` will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?&lt;authorized&gt;yes|true)',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: ':authorized',\n          },\n        ],\n      },\n      // if the host is `example.com`,\n      // this header will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        headers: [\n          {\n            key: 'x-another-header',\n            value: ':authorized',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"headers-with-basepath-support\" data-docs-heading=\"\">Headers with basePath support     </h2> <p>When leveraging <a href=\"../../../app/api-reference/next-config-js/basepath\"><code>basePath</code> support</a> with headers each <code>source</code> is automatically prefixed with the <code>basePath</code> unless you add <code>basePath: false</code> to the header:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  basePath: '/docs',\n \n  async headers() {\n    return [\n      {\n        source: '/with-basePath', // becomes /docs/with-basePath\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        source: '/without-basePath', // is not modified since basePath: false is set\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n        basePath: false,\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"headers-with-i18n-support\" data-docs-heading=\"\">Headers with i18n support     </h2>  <p>When leveraging <a href=\"../../building-your-application/routing/internationalization\"><code>i18n</code> support</a> with headers each <code>source</code> is automatically prefixed to handle the configured <code>locales</code> unless you add <code>locale: false</code> to the header. If <code>locale: false</code> is used you must prefix the <code>source</code> with a locale for it to be matched correctly.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },\n \n  async headers() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        locale: false,\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        locale: false,\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'x-hello',\n            value: 'world',\n          },\n        ],\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"cache-control\" data-docs-heading=\"\">Cache-Control     </h2> <p>You cannot set <code>Cache-Control</code> headers in <code>next.config.js</code> for pages or assets, as these headers will be overwritten in production to ensure that responses and static assets are cached effectively.</p>  <p>If you need to revalidate the cache of a page that has been <a href=\"../../building-your-application/rendering/static-site-generation\">statically generated</a>, you can do so by setting the <code>revalidate</code> prop in the page's <a href=\"../../building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code></a> function.</p>\n<p>You can set the <code>Cache-Control</code> header in your <a href=\"../../building-your-application/routing/api-routes\">API Routes</a> by using the <code>res.setHeader</code> method:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextApiRequest, NextApiResponse } from 'next'\n \ntype ResponseData = {\n  message: string\n}\n \nexport default function handler(\n  req: NextApiRequest,\n  res: NextApiResponse&lt;ResponseData&gt;\n) {\n  res.setHeader('Cache-Control', 's-maxage=86400')\n  res.status(200).json({ message: 'Hello from Next.js!' })\n}</pre></div> <h2 id=\"options\" data-docs-heading=\"\">Options     </h2> <h3 id=\"cors\" data-docs-heading=\"\">CORS     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/CORS\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cross-Origin Resource Sharing (CORS)</a> is a security feature that allows you to control which sites can access your resources. You can set the <code>Access-Control-Allow-Origin</code> header to allow a specific origin to access your API Endpoints.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">async headers() {\n    return [\n      {\n        source: \"/api/:path*\",\n        headers: [\n          {\n            key: \"Access-Control-Allow-Origin\",\n            value: \"*\", // Set your origin\n          },\n          {\n            key: \"Access-Control-Allow-Methods\",\n            value: \"GET, POST, PUT, DELETE, OPTIONS\",\n          },\n          {\n            key: \"Access-Control-Allow-Headers\",\n            value: \"Content-Type, Authorization\",\n          },\n        ],\n      },\n    ];\n  },</pre>\n</div> <h3 id=\"x-dns-prefetch-control\" data-docs-heading=\"\">X-DNS-Prefetch-Control     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> controls DNS prefetching, allowing browsers to proactively perform domain name resolution on external links, images, CSS, JavaScript, and more. This prefetching is performed in the background, so the <a href=\"https://developer.mozilla.org/docs/Glossary/DNS\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">DNS</a> is more likely to be resolved by the time the referenced items are needed. This reduces latency when the user clicks a link.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'X-DNS-Prefetch-Control',\n  value: 'on'\n}</pre>\n</div> <h3 id=\"strict-transport-security\" data-docs-heading=\"\">Strict-Transport-Security     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Strict-Transport-Security\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> informs browsers it should only be accessed using HTTPS, instead of using HTTP. Using the configuration below, all present and future subdomains will use HTTPS for a <code>max-age</code> of 2 years. This blocks access to pages or subdomains that can only be served over HTTP.</p> <p>If you're deploying to <a href=\"https://vercel.com/docs/concepts/edge-network/headers#strict-transport-security?utm_source=next-site&amp;utm_medium=docs&amp;utm_campaign=next-website\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, this header is not necessary as it's automatically added to all deployments unless you declare <code>headers</code> in your <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'Strict-Transport-Security',\n  value: 'max-age=63072000; includeSubDomains; preload'\n}</pre>\n</div> <h3 id=\"x-frame-options\" data-docs-heading=\"\">X-Frame-Options     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> indicates whether the site should be allowed to be displayed within an <code>iframe</code>. This can prevent against clickjacking attacks.</p> <p><strong>This header has been superseded by CSP's <code>frame-ancestors</code> option</strong>, which has better support in modern browsers (see <a href=\"../../../app/building-your-application/configuring/content-security-policy\">Content Security Policy</a> for configuration details).</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'X-Frame-Options',\n  value: 'SAMEORIGIN'\n}</pre>\n</div> <h3 id=\"permissions-policy\" data-docs-heading=\"\">Permissions-Policy     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Permissions-Policy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> allows you to control which features and APIs can be used in the browser. It was previously named <code>Feature-Policy</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'Permissions-Policy',\n  value: 'camera=(), microphone=(), geolocation=(), browsing-topics=()'\n}</pre>\n</div> <h3 id=\"x-content-type-options\" data-docs-heading=\"\">X-Content-Type-Options     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Content-Type-Options\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> prevents the browser from attempting to guess the type of content if the <code>Content-Type</code> header is not explicitly set. This can prevent XSS exploits for websites that allow users to upload and share files.</p> <p>For example, a user trying to download an image, but having it treated as a different <code>Content-Type</code> like an executable, which could be malicious. This header also applies to downloading browser extensions. The only valid value for this header is <code>nosniff</code>.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'X-Content-Type-Options',\n  value: 'nosniff'\n}</pre>\n</div> <h3 id=\"referrer-policy\" data-docs-heading=\"\">Referrer-Policy     </h3> <p><a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Referrer-Policy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">This header</a> controls how much information the browser includes when navigating from the current website (origin) to another.</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  key: 'Referrer-Policy',\n  value: 'origin-when-cross-origin'\n}</pre>\n</div> <h3 id=\"content-security-policy\" data-docs-heading=\"\">Content-Security-Policy     </h3> <p>Learn more about adding a <a href=\"../../../app/building-your-application/configuring/content-security-policy\">Content Security Policy</a> to your application.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>missing</code> added.</td>\n</tr>\n<tr>\n<td><code>v10.2.0</code></td>\n<td>\n<code>has</code> added.</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>Headers added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/headers\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/headers</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/exportpathmap":"<h1 class=\"break-words\">exportPathMap</h1> <blockquote class=\"p-3 text-sm\"> <p>This feature is exclusive to <code>next export</code> and currently <strong>deprecated</strong> in favor of <code>getStaticPaths</code> with <code>pages</code> or <code>generateStaticParams</code> with <code>app</code>.</p> </blockquote> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-static-export\" rel=\"noopener noreferrer\" target=\"_blank\">Static Export</a></li> </ul></details> <p><code>exportPathMap</code> allows you to specify a mapping of request paths to page destinations, to be used during export. Paths defined in <code>exportPathMap</code> will also be available when using <a href=\"../../../app/api-reference/next-cli#development\"><code>next dev</code></a>.</p> <p>Let's start with an example, to create a custom <code>exportPathMap</code> for an app with the following pages:</p> <ul> <li><code>pages/index.js</code></li> <li><code>pages/about.js</code></li> <li><code>pages/post.js</code></li> </ul> <p>Open <code>next.config.js</code> and add the following <code>exportPathMap</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  exportPathMap: async function (\n    defaultPathMap,\n    { dev, dir, outDir, distDir, buildId }\n  ) {\n    return {\n      '/': { page: '/' },\n      '/about': { page: '/about' },\n      '/p/hello-nextjs': { page: '/post', query: { title: 'hello-nextjs' } },\n      '/p/learn-nextjs': { page: '/post', query: { title: 'learn-nextjs' } },\n      '/p/deploy-nextjs': { page: '/post', query: { title: 'deploy-nextjs' } },\n    }\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: the <code>query</code> field in <code>exportPathMap</code> cannot be used with <a href=\"../../building-your-application/rendering/automatic-static-optimization\">automatically statically optimized pages</a> or <a href=\"../../building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code> pages</a> as they are rendered to HTML files at build-time and additional query information cannot be provided during <code>next export</code>.</p> </blockquote> <p>The pages will then be exported as HTML files, for example, <code>/about</code> will become <code>/about.html</code>.</p> <p><code>exportPathMap</code> is an <code>async</code> function that receives 2 arguments: the first one is <code>defaultPathMap</code>, which is the default map used by Next.js. The second argument is an object with:</p> <ul> <li>\n<code>dev</code> - <code>true</code> when <code>exportPathMap</code> is being called in development. <code>false</code> when running <code>next export</code>. In development <code>exportPathMap</code> is used to define routes.</li> <li>\n<code>dir</code> - Absolute path to the project directory</li> <li>\n<code>outDir</code> - Absolute path to the <code>out/</code> directory (<a href=\"#customizing-the-output-directory\">configurable with <code>-o</code></a>). When <code>dev</code> is <code>true</code> the value of <code>outDir</code> will be <code>null</code>.</li> <li>\n<code>distDir</code> - Absolute path to the <code>.next/</code> directory (configurable with the <a href=\"distdir\"><code>distDir</code></a> config)</li> <li>\n<code>buildId</code> - The generated build id</li> </ul> <p>The returned object is a map of pages where the <code>key</code> is the <code>pathname</code> and the <code>value</code> is an object that accepts the following fields:</p> <ul> <li>\n<code>page</code>: <code>String</code> - the page inside the <code>pages</code> directory to render</li> <li>\n<code>query</code>: <code>Object</code> - the <code>query</code> object passed to <code>getInitialProps</code> when prerendering. Defaults to <code>{}</code>\n</li> </ul> <blockquote class=\"p-3 text-sm\"> <p>The exported <code>pathname</code> can also be a filename (for example, <code>/readme.md</code>), but you may need to set the <code>Content-Type</code> header to <code>text/html</code> when serving its content if it is different than <code>.html</code>.</p> </blockquote> <h2 id=\"adding-a-trailing-slash\" data-docs-heading=\"\">Adding a trailing slash     </h2> <p>It is possible to configure Next.js to export pages as <code>index.html</code> files and require trailing slashes, <code>/about</code> becomes <code>/about/index.html</code> and is routable via <code>/about/</code>. This was the default behavior prior to Next.js 9.</p> <p>To switch back and add a trailing slash, open <code>next.config.js</code> and enable the <code>trailingSlash</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  trailingSlash: true,\n}</pre></div> <h2 id=\"customizing-the-output-directory\" data-docs-heading=\"\">Customizing the output directory     </h2>  <p><a href=\"../../building-your-application/deploying/static-exports\"><code>next export</code></a> will use <code>out</code> as the default output directory, you can customize this using the <code>-o</code> argument, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next export -o outdir</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: Using <code>exportPathMap</code> is deprecated and is overridden by <code>getStaticPaths</code> inside <code>pages</code>. We don't recommend using them together.</p> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/exportPathMap\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/exportPathMap</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/httpagentoptions":"<h1 class=\"break-words\">httpAgentOptions</h1> <p>In Node.js versions prior to 18, Next.js automatically polyfills <code>fetch()</code> with <a href=\"../../../architecture/supported-browsers#polyfills\">undici</a> and enables <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Keep-Alive\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">HTTP Keep-Alive</a> by default.</p> <p>To disable HTTP Keep-Alive for all <code>fetch()</code> calls on the server-side, open <code>next.config.js</code> and add the <code>httpAgentOptions</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  httpAgentOptions: {\n    keepAlive: false,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/httpAgentOptions\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/httpAgentOptions</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/instrumentationhook":"<h1 class=\"break-words\">instrumentationHook</h1> <p>The experimental <code>instrumentationHook</code> option allows you to set up instrumentation via the <a href=\"../../../app/api-reference/file-conventions/instrumentation\"><code>instrumentation</code> file</a> in your Next.js App.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    instrumentationHook: true,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/instrumentationHook\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/instrumentationHook</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/productionbrowsersourcemaps":"<h1 class=\"break-words\">productionBrowserSourceMaps</h1> <p>Source Maps are enabled by default during development. During production builds, they are disabled to prevent you leaking your source on the client, unless you specifically opt-in with the configuration flag.</p> <p>Next.js provides a configuration flag you can use to enable browser source map generation during the production build:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  productionBrowserSourceMaps: true,\n}</pre></div> <p>When the <code>productionBrowserSourceMaps</code> option is enabled, the source maps will be output in the same directory as the JavaScript files. Next.js will automatically serve these files when requested.</p> <ul> <li>Adding source maps can increase <code>next build</code> time</li> <li>Increases memory usage during <code>next build</code>\n</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/productionBrowserSourceMaps\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/productionBrowserSourceMaps</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/images":"<h1 class=\"break-words\">images</h1> <p>If you want to use a cloud provider to optimize images instead of using the Next.js built-in Image Optimization API, you can configure <code>next.config.js</code> with the following:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  images: {\n    loader: 'custom',\n    loaderFile: './my/image/loader.js',\n  },\n}</pre></div> <p>This <code>loaderFile</code> must point to a file relative to the root of your Next.js application. The file must export a default function that returns a string, for example:</p>  <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export default function myImageLoader({ src, width, quality }) {\n  return `https://example.com/${src}?w=${width}&amp;q=${quality || 75}`\n}</pre></div>\n<p>Alternatively, you can use the <a href=\"../components/image#loader\"><code>loader</code> prop</a> to pass the function to each instance of <code>next/image</code>.</p>\n<p>To learn more about configuring the behavior of the built-in <a href=\"../../building-your-application/optimizing/images\">Image Optimization API</a> and the <a href=\"../components/image\">Image Component</a>, see <a href=\"../components/image#configuration-options\">Image Configuration Options</a> for available options.</p> <h2 id=\"example-loader-configuration\" data-docs-heading=\"\">Example Loader Configuration     </h2> <ul> <li><a href=\"#akamai\">Akamai</a></li> <li><a href=\"#aws-cloudfront\">AWS CloudFront</a></li> <li><a href=\"#cloudinary\">Cloudinary</a></li> <li><a href=\"#cloudflare\">Cloudflare</a></li> <li><a href=\"#contentful\">Contentful</a></li> <li><a href=\"#fastly\">Fastly</a></li> <li><a href=\"#gumlet\">Gumlet</a></li> <li><a href=\"#imageengine\">ImageEngine</a></li> <li><a href=\"#imgix\">Imgix</a></li> <li><a href=\"#thumbor\">Thumbor</a></li> <li><a href=\"#sanity\">Sanity</a></li> <li><a href=\"#sirv\">Sirv</a></li> <li><a href=\"#supabase\">Supabase</a></li> </ul> <h3 id=\"akamai\" data-docs-heading=\"\">Akamai     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://techdocs.akamai.com/ivm/reference/test-images-on-demand\nexport default function akamaiLoader({ src, width, quality }) {\n  return `https://example.com/${src}?imwidth=${width}`\n}</pre>\n</div> <h3 id=\"aws-cloudfront\" data-docs-heading=\"\">AWS CloudFront     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://aws.amazon.com/developer/application-security-performance/articles/image-optimization\nexport default function cloudfrontLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('format', 'auto')\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href</pre>\n</div> <h3 id=\"cloudinary\" data-docs-heading=\"\">Cloudinary     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Demo: https://res.cloudinary.com/demo/image/upload/w_300,c_limit,q_auto/turtles.jpg\nexport default function cloudinaryLoader({ src, width, quality }) {\n  const params = ['f_auto', 'c_limit', `w_${width}`, `q_${quality || 'auto'}`]\n  return `https://example.com/${params.join(',')}${src}`\n}</pre>\n</div> <h3 id=\"cloudflare\" data-docs-heading=\"\">Cloudflare     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://developers.cloudflare.com/images/url-format\nexport default function cloudflareLoader({ src, width, quality }) {\n  const params = [`width=${width}`, `quality=${quality || 75}`, 'format=auto']\n  return `https://example.com/cdn-cgi/image/${params.join(',')}/${src}`\n}</pre>\n</div> <h3 id=\"contentful\" data-docs-heading=\"\">Contentful     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://www.contentful.com/developers/docs/references/images-api/\nexport default function contentfulLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('fm', 'webp')\n  url.searchParams.set('w', width.toString())\n  url.searchParams.set('q', (quality || 75).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"fastly\" data-docs-heading=\"\">Fastly     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://developer.fastly.com/reference/io/\nexport default function fastlyLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('auto', 'webp')\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"gumlet\" data-docs-heading=\"\">Gumlet     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://docs.gumlet.com/reference/image-transform-size\nexport default function gumletLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('format', 'auto')\n  url.searchParams.set('w', width.toString())\n  url.searchParams.set('q', (quality || 75).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"imageengine\" data-docs-heading=\"\">ImageEngine     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://support.imageengine.io/hc/en-us/articles/360058880672-Directives\nexport default function imageengineLoader({ src, width, quality }) {\n  const compression = 100 - (quality || 50)\n  const params = [`w_${width}`, `cmpr_${compression}`)]\n  return `https://example.com${src}?imgeng=/${params.join('/')`\n}</pre>\n</div> <h3 id=\"imgix\" data-docs-heading=\"\">Imgix     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Demo: https://static.imgix.net/daisy.png?format=auto&amp;fit=max&amp;w=300\nexport default function imgixLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  const params = url.searchParams\n  params.set('auto', params.getAll('auto').join(',') || 'format')\n  params.set('fit', params.get('fit') || 'max')\n  params.set('w', params.get('w') || width.toString())\n  params.set('q', (quality || 50).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"thumbor\" data-docs-heading=\"\">Thumbor     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://thumbor.readthedocs.io/en/latest/\nexport default function thumborLoader({ src, width, quality }) {\n  const params = [`${width}x0`, `filters:quality(${quality || 75})`]\n  return `https://example.com${params.join('/')}${src}`\n}</pre>\n</div> <h3 id=\"sanity\" data-docs-heading=\"\">Sanity     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://www.sanity.io/docs/image-urls\nexport default function sanityLoader({ src, width, quality }) {\n  const prj = 'zp7mbokg'\n  const dataset = 'production'\n  const url = new URL(`https://cdn.sanity.io/images/${prj}/${dataset}${src}`)\n  url.searchParams.set('auto', 'format')\n  url.searchParams.set('fit', 'max')\n  url.searchParams.set('w', width.toString())\n  if (quality) {\n    url.searchParams.set('q', quality.toString())\n  }\n  return url.href\n}</pre>\n</div> <h3 id=\"sirv\" data-docs-heading=\"\">Sirv     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://sirv.com/help/articles/dynamic-imaging/\nexport default function sirvLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  const params = url.searchParams\n  params.set('format', params.getAll('format').join(',') || 'optimal')\n  params.set('w', params.get('w') || width.toString())\n  params.set('q', (quality || 85).toString())\n  return url.href\n}</pre>\n</div> <h3 id=\"supabase\" data-docs-heading=\"\">Supabase     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Docs: https://supabase.com/docs/guides/storage/image-transformations#nextjs-loader\nexport default function supabaseLoader({ src, width, quality }) {\n  const url = new URL(`https://example.com${src}`)\n  url.searchParams.set('width', width.toString())\n  url.searchParams.set('quality', (quality || 75).toString())\n  return url.href\n}</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/images\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/images</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/optimizepackageimports":"<h1 class=\"break-words\">optimizePackageImports</h1> <p>By default, Next.js uses <code>gzip</code> to compress rendered content and static files when using <code>next start</code> or a custom server. This is an optimization for applications that do not have compression configured. If compression is <em>already</em> configured in your application via a custom server, Next.js will not add compression.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>When hosting your application on <a href=\"https://vercel.com/docs/edge-network/compression\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, compression uses <code>brotli</code> first, then <code>gzip</code>.</li> <li>You can check if compression is enabled and which algorithm is used by looking at the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Accept-Encoding</code></a> (browser accepted options) and <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Encoding\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Content-Encoding</code></a> (currently used) headers in the response.</li> </ul> </blockquote> <h2 id=\"disabling-compression\" data-docs-heading=\"\">Disabling compression     </h2> <p>To disable <strong>compression</strong>, set the <code>compress</code> config option to <code>false</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compress: false,\n}</pre></div> <p>We do not recommend disabling compression unless you have compression configured on your server, as compression reduces bandwidth usage and improves the performance of your application.</p> <h2 id=\"changing-the-compression-algorithm\" data-docs-heading=\"\">Changing the compression algorithm     </h2> <p>To change your compression algorithm, you will need to configure your custom server and set the <code>compress</code> option to <code>false</code> in your <code>next.config.js</code> file.</p> <p>For example, you're using <a href=\"https://www.nginx.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">nginx</a> and want to switch to <code>brotli</code>, set the <code>compress</code> option to <code>false</code> to allow nginx to handle compression.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>For Next.js applications on Vercel, compression is handled by the Vercel's Edge Network and not Next.js. See the <a href=\"https://vercel.com/docs/edge-network/compression\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel documentation</a> for more information.</li> </ul> </blockquote><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/optimizePackageImports\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/optimizePackageImports</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/output":"<h1 class=\"break-words\">output</h1> <p>During a build, Next.js will automatically trace each page and its dependencies to determine all of the files that are needed for deploying a production version of your application.</p> <p>This feature helps reduce the size of deployments drastically. Previously, when deploying with Docker you would need to have all files from your package's <code>dependencies</code> installed to run <code>next start</code>. Starting with Next.js 12, you can leverage Output File Tracing in the <code>.next/</code> directory to only include the necessary files.</p> <p>Furthermore, this removes the need for the deprecated <code>serverless</code> target which can cause various issues and also creates unnecessary duplication.</p> <h2 id=\"how-it-works\" data-docs-heading=\"\">How it Works     </h2> <p>During <code>next build</code>, Next.js will use <a href=\"https://github.com/vercel/nft\" rel=\"noopener noreferrer\" target=\"_blank\"><code>@vercel/nft</code></a> to statically analyze <code>import</code>, <code>require</code>, and <code>fs</code> usage to determine all files that a page might load.</p> <p>Next.js' production server is also traced for its needed files and output at <code>.next/next-server.js.nft.json</code> which can be leveraged in production.</p> <p>To leverage the <code>.nft.json</code> files emitted to the <code>.next</code> output directory, you can read the list of files in each trace that are relative to the <code>.nft.json</code> file and then copy them to your deployment location.</p> <h2 id=\"automatically-copying-traced-files\" data-docs-heading=\"\">Automatically Copying Traced Files     </h2> <p>Next.js can automatically create a <code>standalone</code> folder that copies only the necessary files for a production deployment including select files in <code>node_modules</code>.</p> <p>To leverage this automatic copying you can enable it in your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  output: 'standalone',\n}</pre></div> <p>This will create a folder at <code>.next/standalone</code> which can then be deployed on its own without installing <code>node_modules</code>.</p> <p>Additionally, a minimal <code>server.js</code> file is also output which can be used instead of <code>next start</code>. This minimal server does not copy the <code>public</code> or <code>.next/static</code> folders by default as these should ideally be handled by a CDN instead, although these folders can be copied to the <code>standalone/public</code> and <code>standalone/.next/static</code> folders manually, after which <code>server.js</code> file will serve these automatically.</p>  <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>next.config.js</code> is read during <code>next build</code> and serialized into the <code>server.js</code> output file. If the legacy <a href=\"runtime-configuration\"><code>serverRuntimeConfig</code> or <code>publicRuntimeConfig</code> options</a> are being used, the values will be specific to values at build time.</li> <li>If your project needs to listen to a specific port or hostname, you can define <code>PORT</code> or <code>HOSTNAME</code> environment variables before running <code>server.js</code>. For example, run <code>PORT=8080 HOSTNAME=0.0.0.0 node server.js</code> to start the server on <code>http://0.0.0.0:8080</code>.</li> <li>If your project uses <a href=\"../../building-your-application/optimizing/images\">Image Optimization</a> with the default <code>loader</code>, you must install <code>sharp</code> as a dependency:</li> </ul> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npm i sharp</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn add sharp</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm add sharp</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bun add sharp</pre></div> <h2 id=\"caveats\" data-docs-heading=\"\">Caveats     </h2> <ul> <li>While tracing in monorepo setups, the project directory is used for tracing by default. For <code>next build packages/web-app</code>, <code>packages/web-app</code> would be the tracing root and any files outside of that folder will not be included. To include files outside of this folder you can set <code>experimental.outputFileTracingRoot</code> in your <code>next.config.js</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    // this includes files from the monorepo base two directories up\n    outputFileTracingRoot: path.join(__dirname, '../../'),\n  },\n}</pre></div> <ul> <li>There are some cases in which Next.js might fail to include required files, or might incorrectly include unused files. In those cases, you can leverage <code>experimental.outputFileTracingExcludes</code> and <code>experimental.outputFileTracingIncludes</code> respectively in <code>next.config.js</code>. Each config accepts an object with <a href=\"https://www.npmjs.com/package/minimatch\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">minimatch globs</a> for the key to match specific pages and a value of an array with globs relative to the project's root to either include or exclude in the trace.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    outputFileTracingExcludes: {\n      '/api/hello': ['./un-necessary-folder/**/*'],\n    },\n    outputFileTracingIncludes: {\n      '/api/another': ['./necessary-folder/**/*'],\n    },\n  },\n}</pre></div> <ul> <li>Currently, Next.js does not do anything with the emitted <code>.nft.json</code> files. The files must be read by your deployment platform, for example <a href=\"https://vercel.com\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel</a>, to create a minimal deployment. In a future release, a new command is planned to utilize these <code>.nft.json</code> files.</li> </ul> <h2 id=\"experimental-turbotrace\" data-docs-heading=\"\">Experimental turbotrace     </h2> <p>Tracing dependencies can be slow because it requires very complex computations and analysis. We created <code>turbotrace</code> in Rust as a faster and smarter alternative to the JavaScript implementation.</p> <p>To enable it, you can add the following configuration to your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    turbotrace: {\n      // control the log level of the turbotrace, default is `error`\n      logLevel?:\n      | 'bug'\n      | 'fatal'\n      | 'error'\n      | 'warning'\n      | 'hint'\n      | 'note'\n      | 'suggestions'\n      | 'info',\n      // control if the log of turbotrace should contain the details of the analysis, default is `false`\n      logDetail?: boolean\n      // show all log messages without limit\n      // turbotrace only show 1 log message for each categories by default\n      logAll?: boolean\n      // control the context directory of the turbotrace\n      // files outside of the context directory will not be traced\n      // set the `experimental.outputFileTracingRoot` has the same effect\n      // if the `experimental.outputFileTracingRoot` and this option are both set, the `experimental.turbotrace.contextDirectory` will be used\n      contextDirectory?: string\n      // if there is `process.cwd()` expression in your code, you can set this option to tell `turbotrace` the value of `process.cwd()` while tracing.\n      // for example the require(process.cwd() + '/package.json') will be traced as require('/path/to/cwd/package.json')\n      processCwd?: string\n      // control the maximum memory usage of the `turbotrace`, in `MB`, default is `6000`.\n      memoryLimit?: number\n    },\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/output\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/output</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/poweredbyheader":"<h1 class=\"break-words\">poweredByHeader</h1> <p>By default Next.js will add the <code>x-powered-by</code> header. To opt-out of it, open <code>next.config.js</code> and disable the <code>poweredByHeader</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  poweredByHeader: false,\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/poweredByHeader\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/poweredByHeader</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/reactstrictmode":"<h1 class=\"break-words\">reactStrictMode</h1> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Since Next.js 13.4, Strict Mode is <code>true</code> by default with <code>app</code> router, so the above configuration is only necessary for <code>pages</code>. You can still disable Strict Mode by setting <code>reactStrictMode: false</code>.</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p><strong>Suggested</strong>: We strongly suggest you enable Strict Mode in your Next.js application to better prepare your application for the future of React.</p> </blockquote> <p>React's <a href=\"https://react.dev/reference/react/StrictMode\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Strict Mode</a> is a development mode only feature for highlighting potential problems in an application. It helps to identify unsafe lifecycles, legacy API usage, and a number of other features.</p> <p>The Next.js runtime is Strict Mode-compliant. To opt-in to Strict Mode, configure the following option in your <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  reactStrictMode: true,\n}</pre></div> <p>If you or your team are not ready to use Strict Mode in your entire application, that's OK! You can incrementally migrate on a page-by-page basis using <code>&lt;React.StrictMode&gt;</code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/reactStrictMode\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/reactStrictMode</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/redirects":"<h1 class=\"break-words\">redirects</h1> <p>Redirects allow you to redirect an incoming request path to a different destination path.</p> <p>To use redirects you can use the <code>redirects</code> key in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/about',\n        destination: '/',\n        permanent: true,\n      },\n    ]\n  },\n}</pre></div> <p><code>redirects</code> is an async function that expects an array to be returned holding objects with <code>source</code>, <code>destination</code>, and <code>permanent</code> properties:</p> <ul> <li>\n<code>source</code> is the incoming request path pattern.</li> <li>\n<code>destination</code> is the path you want to route to.</li> <li>\n<code>permanent</code> <code>true</code> or <code>false</code> - if <code>true</code> will use the 308 status code which instructs clients/search engines to cache the redirect forever, if <code>false</code> will use the 307 status code which is temporary and is not cached.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Why does Next.js use 307 and 308?</strong> Traditionally a 302 was used for a temporary redirect, and a 301 for a permanent redirect, but many browsers changed the request method of the redirect to <code>GET</code>, regardless of the original method. For example, if the browser made a request to <code>POST /v1/users</code> which returned status code <code>302</code> with location <code>/v2/users</code>, the subsequent request might be <code>GET /v2/users</code> instead of the expected <code>POST /v2/users</code>. Next.js uses the 307 temporary redirect, and 308 permanent redirect status codes to explicitly preserve the request method used.</p> </blockquote> <ul> <li>\n<code>basePath</code>: <code>false</code> or <code>undefined</code> - if false the <code>basePath</code> won't be included when matching, can be used for external redirects only.</li> <li>\n<code>locale</code>: <code>false</code> or <code>undefined</code> - whether the locale should not be included when matching.</li> <li>\n<code>has</code> is an array of <a href=\"#header-cookie-and-query-matching\">has objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> <li>\n<code>missing</code> is an array of <a href=\"#header-cookie-and-query-matching\">missing objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> </ul> <p>Redirects are checked before the filesystem which includes pages and <code>/public</code> files.</p> <p>When using the Pages Router, redirects are not applied to client-side routing (<code>Link</code>, <code>router.push</code>) unless <a href=\"../../../app/building-your-application/routing/middleware\">Middleware</a> is present and matches the path.</p> <p>When a redirect is applied, any query values provided in the request will be passed through to the redirect destination. For example, see the following redirect configuration:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  source: '/old-blog/:path*',\n  destination: '/blog/:path*',\n  permanent: false\n}</pre>\n</div> <p>When <code>/old-blog/post-1?hello=world</code> is requested, the client will be redirected to <code>/blog/post-1?hello=world</code>.</p> <h2 id=\"path-matching\" data-docs-heading=\"\">Path Matching     </h2> <p>Path matches are allowed, for example <code>/old-blog/:slug</code> will match <code>/old-blog/hello-world</code> (no nested paths):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/old-blog/:slug',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n        permanent: true,\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"wildcard-path-matching\" data-docs-heading=\"\">Wildcard Path Matching     </h3> <p>To match a wildcard path you can use <code>*</code> after a parameter, for example <code>/blog/:slug*</code> will match <code>/blog/a/b/c/d/hello-world</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/blog/:slug*',\n        destination: '/news/:slug*', // Matched parameters can be used in the destination\n        permanent: true,\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"regex-path-matching\" data-docs-heading=\"\">Regex Path Matching     </h3> <p>To match a regex path you can wrap the regex in parentheses after a parameter, for example <code>/post/:slug(\\\\d{1,})</code> will match <code>/post/123</code> but not <code>/post/abc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        source: '/post/:slug(\\\\d{1,})',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n        permanent: false,\n      },\n    ]\n  },\n}</pre></div> <p>The following characters <code>(</code>, <code>)</code>, <code>{</code>, <code>}</code>, <code>:</code>, <code>*</code>, <code>+</code>, <code>?</code> are used for regex path matching, so when used in the <code>source</code> as non-special values they must be escaped by adding <code>\\\\</code> before them:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        destination: '/en-us/:slug',\n        permanent: false,\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"header-cookie-and-query-matching\" data-docs-heading=\"\">Header, Cookie, and Query Matching     </h2> <p>To only match a redirect when header, cookie, or query values also match the <code>has</code> field or don't match the <code>missing</code> field can be used. Both the <code>source</code> and all <code>has</code> items must match and all <code>missing</code> items must not match for the redirect to be applied.</p> <p><code>has</code> and <code>missing</code> items can have the following fields:</p> <ul> <li>\n<code>type</code>: <code>String</code> - must be either <code>header</code>, <code>cookie</code>, <code>host</code>, or <code>query</code>.</li> <li>\n<code>key</code>: <code>String</code> - the key from the selected type to match against.</li> <li>\n<code>value</code>: <code>String</code> or <code>undefined</code> - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value <code>first-(?&lt;paramName&gt;.*)</code> is used for <code>first-second</code> then <code>second</code> will be usable in the destination with <code>:paramName</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async redirects() {\n    return [\n      // if the header `x-redirect-me` is present,\n      // this redirect will be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        has: [\n          {\n            type: 'header',\n            key: 'x-redirect-me',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n      // if the header `x-dont-redirect` is present,\n      // this redirect will NOT be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-do-not-redirect',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n      // if the source, query, and cookie are matched,\n      // this redirect will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // destination since value is provided and doesn't\n            // use a named capture group e.g. (?&lt;page&gt;home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        permanent: false,\n        destination: '/another/:path*',\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, this redirect will be applied\n      {\n        source: '/',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?&lt;authorized&gt;yes|true)',\n          },\n        ],\n        permanent: false,\n        destination: '/home?authorized=:authorized',\n      },\n      // if the host is `example.com`,\n      // this redirect will be applied\n      {\n        source: '/:path((?!another-page$).*)',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        permanent: false,\n        destination: '/another-page',\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"redirects-with-basepath-support\" data-docs-heading=\"\">Redirects with basePath support     </h3> <p>When leveraging <a href=\"../../../app/api-reference/next-config-js/basepath\"><code>basePath</code> support</a> with redirects each <code>source</code> and <code>destination</code> is automatically prefixed with the <code>basePath</code> unless you add <code>basePath: false</code> to the redirect:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  basePath: '/docs',\n \n  async redirects() {\n    return [\n      {\n        source: '/with-basePath', // automatically becomes /docs/with-basePath\n        destination: '/another', // automatically becomes /docs/another\n        permanent: false,\n      },\n      {\n        // does not add /docs since basePath: false is set\n        source: '/without-basePath',\n        destination: 'https://example.com',\n        basePath: false,\n        permanent: false,\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"redirects-with-i18n-support\" data-docs-heading=\"\">Redirects with i18n support     </h3>  <p>When leveraging <a href=\"../../building-your-application/routing/internationalization\"><code>i18n</code> support</a> with redirects each <code>source</code> and <code>destination</code> is automatically prefixed to handle the configured <code>locales</code> unless you add <code>locale: false</code> to the redirect. If <code>locale: false</code> is used you must prefix the <code>source</code> and <code>destination</code> with a locale for it to be matched correctly.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },\n \n  async redirects() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        destination: '/another', // automatically passes the locale on\n        permanent: false,\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        destination: '/nl/another',\n        locale: false,\n        permanent: false,\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        destination: '/en/another',\n        locale: false,\n        permanent: false,\n      },\n      // it's possible to match all locales even when locale: false is set\n      {\n        source: '/:locale/page',\n        destination: '/en/newpage',\n        permanent: false,\n        locale: false,\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        destination: '/another',\n        permanent: false,\n      },\n    ]\n  },\n}</pre></div> <p>In some rare cases, you might need to assign a custom status code for older HTTP Clients to properly redirect. In these cases, you can use the <code>statusCode</code> property instead of the <code>permanent</code> property, but not both. To to ensure IE11 compatibility, a <code>Refresh</code> header is automatically added for the 308 status code.</p> <h2 id=\"other-redirects\" data-docs-heading=\"\">Other Redirects     </h2> <ul> <li>Inside <a href=\"../../building-your-application/routing/api-routes\">API Routes</a> and <a href=\"../../../app/building-your-application/routing/route-handlers\">Route Handlers</a>, you can redirect based on the incoming request.</li> <li>Inside <a href=\"../../building-your-application/data-fetching/get-static-props\"><code>getStaticProps</code></a> and <a href=\"../../building-your-application/data-fetching/get-server-side-props\"><code>getServerSideProps</code></a>, you can redirect specific pages at request-time.</li> </ul> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>missing</code> added.</td>\n</tr>\n<tr>\n<td><code>v10.2.0</code></td>\n<td>\n<code>has</code> added.</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>\n<code>redirects</code> added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/redirects\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/redirects</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/rewrites":"<h1 class=\"break-words\">rewrites</h1> <p>Rewrites allow you to map an incoming request path to a different destination path.</p>  <p>Rewrites act as a URL proxy and mask the destination path, making it appear the user hasn't changed their location on the site. In contrast, <a href=\"redirects\">redirects</a> will reroute to a new page and show the URL changes.</p> <p>To use rewrites you can use the <code>rewrites</code> key in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/about',\n        destination: '/',\n      },\n    ]\n  },\n}</pre></div> <p>Rewrites are applied to client-side routing, a <code>&lt;Link href=\"/about\"&gt;</code> will have the rewrite applied in the above example.</p> <p><code>rewrites</code> is an async function that expects to return either an array or an object of arrays (see below) holding objects with <code>source</code> and <code>destination</code> properties:</p> <ul> <li>\n<code>source</code>: <code>String</code> - is the incoming request path pattern.</li> <li>\n<code>destination</code>: <code>String</code> is the path you want to route to.</li> <li>\n<code>basePath</code>: <code>false</code> or <code>undefined</code> - if false the basePath won't be included when matching, can be used for external rewrites only.</li> <li>\n<code>locale</code>: <code>false</code> or <code>undefined</code> - whether the locale should not be included when matching.</li> <li>\n<code>has</code> is an array of <a href=\"#header-cookie-and-query-matching\">has objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> <li>\n<code>missing</code> is an array of <a href=\"#header-cookie-and-query-matching\">missing objects</a> with the <code>type</code>, <code>key</code> and <code>value</code> properties.</li> </ul> <p>When the <code>rewrites</code> function returns an array, rewrites are applied after checking the filesystem (pages and <code>/public</code> files) and before dynamic routes. When the <code>rewrites</code> function returns an object of arrays with a specific shape, this behavior can be changed and more finely controlled, as of <code>v10.1</code> of Next.js:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return {\n      beforeFiles: [\n        // These rewrites are checked after headers/redirects\n        // and before all files including _next/public files which\n        // allows overriding page files\n        {\n          source: '/some-page',\n          destination: '/somewhere-else',\n          has: [{ type: 'query', key: 'overrideMe' }],\n        },\n      ],\n      afterFiles: [\n        // These rewrites are checked after pages/public files\n        // are checked but before dynamic routes\n        {\n          source: '/non-existent',\n          destination: '/somewhere-else',\n        },\n      ],\n      fallback: [\n        // These rewrites are checked after both pages/public files\n        // and dynamic routes are checked\n        {\n          source: '/:path*',\n          destination: `https://my-old-site.com/:path*`,\n        },\n      ],\n    }\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: rewrites in <code>beforeFiles</code> do not check the filesystem/dynamic routes immediately after matching a source, they continue until all <code>beforeFiles</code> have been checked.</p> </blockquote> <p>The order Next.js routes are checked is:</p>  <ol> <li>\n<a href=\"headers\">headers</a> are checked/applied</li> <li>\n<a href=\"redirects\">redirects</a> are checked/applied</li> <li>\n<code>beforeFiles</code> rewrites are checked/applied</li> <li>static files from the <a href=\"../../building-your-application/optimizing/static-assets\">public directory</a>, <code>_next/static</code> files, and non-dynamic pages are checked/served</li> <li>\n<code>afterFiles</code> rewrites are checked/applied, if one of these rewrites is matched we check dynamic routes/static files after each match</li> <li>\n<code>fallback</code> rewrites are checked/applied, these are applied before rendering the 404 page and after dynamic routes/all static assets have been checked. If you use <a href=\"../functions/get-static-paths#fallback-true\">fallback: true/'blocking'</a> in <code>getStaticPaths</code>, the fallback <code>rewrites</code> defined in your <code>next.config.js</code> will <em>not</em> be run.</li> </ol> <h2 id=\"rewrite-parameters\" data-docs-heading=\"\">Rewrite parameters     </h2> <p>When using parameters in a rewrite the parameters will be passed in the query by default when none of the parameters are used in the <code>destination</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/old-about/:path*',\n        destination: '/about', // The :path parameter isn't used here so will be automatically passed in the query\n      },\n    ]\n  },\n}</pre></div> <p>If a parameter is used in the destination none of the parameters will be automatically passed in the query.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/docs/:path*',\n        destination: '/:path*', // The :path parameter is used here so will not be automatically passed in the query\n      },\n    ]\n  },\n}</pre></div> <p>You can still pass the parameters manually in the query if one is already used in the destination by specifying the query in the <code>destination</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/:first/:second',\n        destination: '/:first?second=:second',\n        // Since the :first parameter is used in the destination the :second parameter\n        // will not automatically be added in the query although we can manually add it\n        // as shown above\n      },\n    ]\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Static pages from <a href=\"../../building-your-application/rendering/automatic-static-optimization\">Automatic Static Optimization</a> or <a href=\"../../building-your-application/data-fetching/get-static-props\">prerendering</a> params from rewrites will be parsed on the client after hydration and provided in the query.</p> </blockquote> <h2 id=\"path-matching\" data-docs-heading=\"\">Path Matching     </h2> <p>Path matches are allowed, for example <code>/blog/:slug</code> will match <code>/blog/hello-world</code> (no nested paths):</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog/:slug',\n        destination: '/news/:slug', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"wildcard-path-matching\" data-docs-heading=\"\">Wildcard Path Matching     </h3> <p>To match a wildcard path you can use <code>*</code> after a parameter, for example <code>/blog/:slug*</code> will match <code>/blog/a/b/c/d/hello-world</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog/:slug*',\n        destination: '/news/:slug*', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"regex-path-matching\" data-docs-heading=\"\">Regex Path Matching     </h3> <p>To match a regex path you can wrap the regex in parenthesis after a parameter, for example <code>/blog/:slug(\\\\d{1,})</code> will match <code>/blog/123</code> but not <code>/blog/abc</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/old-blog/:post(\\\\d{1,})',\n        destination: '/blog/:post', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}</pre></div> <p>The following characters <code>(</code>, <code>)</code>, <code>{</code>, <code>}</code>, <code>[</code>, <code>]</code>, <code>|</code>, <code>\\</code>, <code>^</code>, <code>.</code>, <code>:</code>, <code>*</code>, <code>+</code>, <code>-</code>, <code>?</code>, <code>$</code> are used for regex path matching, so when used in the <code>source</code> as non-special values they must be escaped by adding <code>\\\\</code> before them:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        // this will match `/english(default)/something` being requested\n        source: '/english\\\\(default\\\\)/:slug',\n        destination: '/en-us/:slug',\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"header-cookie-and-query-matching\" data-docs-heading=\"\">Header, Cookie, and Query Matching     </h2> <p>To only match a rewrite when header, cookie, or query values also match the <code>has</code> field or don't match the <code>missing</code> field can be used. Both the <code>source</code> and all <code>has</code> items must match and all <code>missing</code> items must not match for the rewrite to be applied.</p> <p><code>has</code> and <code>missing</code> items can have the following fields:</p> <ul> <li>\n<code>type</code>: <code>String</code> - must be either <code>header</code>, <code>cookie</code>, <code>host</code>, or <code>query</code>.</li> <li>\n<code>key</code>: <code>String</code> - the key from the selected type to match against.</li> <li>\n<code>value</code>: <code>String</code> or <code>undefined</code> - the value to check for, if undefined any value will match. A regex like string can be used to capture a specific part of the value, e.g. if the value <code>first-(?&lt;paramName&gt;.*)</code> is used for <code>first-second</code> then <code>second</code> will be usable in the destination with <code>:paramName</code>.</li> </ul> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      // if the header `x-rewrite-me` is present,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-rewrite-me',\n          },\n        ],\n        destination: '/another-page',\n      },\n      // if the header `x-rewrite-me` is not present,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        missing: [\n          {\n            type: 'header',\n            key: 'x-rewrite-me',\n          },\n        ],\n        destination: '/another-page',\n      },\n      // if the source, query, and cookie are matched,\n      // this rewrite will be applied\n      {\n        source: '/specific/:path*',\n        has: [\n          {\n            type: 'query',\n            key: 'page',\n            // the page value will not be available in the\n            // destination since value is provided and doesn't\n            // use a named capture group e.g. (?&lt;page&gt;home)\n            value: 'home',\n          },\n          {\n            type: 'cookie',\n            key: 'authorized',\n            value: 'true',\n          },\n        ],\n        destination: '/:path*/home',\n      },\n      // if the header `x-authorized` is present and\n      // contains a matching value, this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'header',\n            key: 'x-authorized',\n            value: '(?&lt;authorized&gt;yes|true)',\n          },\n        ],\n        destination: '/home?authorized=:authorized',\n      },\n      // if the host is `example.com`,\n      // this rewrite will be applied\n      {\n        source: '/:path*',\n        has: [\n          {\n            type: 'host',\n            value: 'example.com',\n          },\n        ],\n        destination: '/another-page',\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"rewriting-to-an-external-url\" data-docs-heading=\"\">Rewriting to an external URL     </h2> <details><summary>Examples</summary><ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/custom-routes-proxying\" rel=\"noopener noreferrer\" target=\"_blank\">Incremental adoption of Next.js</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/examples/with-zones\" rel=\"noopener noreferrer\" target=\"_blank\">Using Multiple Zones</a></li> </ul></details> <p>Rewrites allow you to rewrite to an external url. This is especially useful for incrementally adopting Next.js. The following is an example rewrite for redirecting the <code>/blog</code> route of your main app to an external site.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return [\n      {\n        source: '/blog',\n        destination: 'https://example.com/blog',\n      },\n      {\n        source: '/blog/:slug',\n        destination: 'https://example.com/blog/:slug', // Matched parameters can be used in the destination\n      },\n    ]\n  },\n}</pre></div> <p>If you're using <code>trailingSlash: true</code>, you also need to insert a trailing slash in the <code>source</code> parameter. If the destination server is also expecting a trailing slash it should be included in the <code>destination</code> parameter as well.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  trailingSlash: true,\n  async rewrites() {\n    return [\n      {\n        source: '/blog/',\n        destination: 'https://example.com/blog/',\n      },\n      {\n        source: '/blog/:path*/',\n        destination: 'https://example.com/blog/:path*/',\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"incremental-adoption-of-nextjs\" data-docs-heading=\"\">Incremental adoption of Next.js     </h3> <p>You can also have Next.js fall back to proxying to an existing website after checking all Next.js routes.</p> <p>This way you don't have to change the rewrites configuration when migrating more pages to Next.js</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  async rewrites() {\n    return {\n      fallback: [\n        {\n          source: '/:path*',\n          destination: `https://custom-routes-proxying-endpoint.vercel.app/:path*`,\n        },\n      ],\n    }\n  },\n}</pre></div> <h3 id=\"rewrites-with-basepath-support\" data-docs-heading=\"\">Rewrites with basePath support     </h3> <p>When leveraging <a href=\"../../../app/api-reference/next-config-js/basepath\"><code>basePath</code> support</a> with rewrites each <code>source</code> and <code>destination</code> is automatically prefixed with the <code>basePath</code> unless you add <code>basePath: false</code> to the rewrite:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  basePath: '/docs',\n \n  async rewrites() {\n    return [\n      {\n        source: '/with-basePath', // automatically becomes /docs/with-basePath\n        destination: '/another', // automatically becomes /docs/another\n      },\n      {\n        // does not add /docs to /without-basePath since basePath: false is set\n        // Note: this can not be used for internal rewrites e.g. `destination: '/another'`\n        source: '/without-basePath',\n        destination: 'https://example.com',\n        basePath: false,\n      },\n    ]\n  },\n}</pre></div> <h3 id=\"rewrites-with-i18n-support\" data-docs-heading=\"\">Rewrites with i18n support     </h3>  <p>When leveraging <a href=\"../../building-your-application/routing/internationalization\"><code>i18n</code> support</a> with rewrites each <code>source</code> and <code>destination</code> is automatically prefixed to handle the configured <code>locales</code> unless you add <code>locale: false</code> to the rewrite. If <code>locale: false</code> is used you must prefix the <code>source</code> and <code>destination</code> with a locale for it to be matched correctly.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  i18n: {\n    locales: ['en', 'fr', 'de'],\n    defaultLocale: 'en',\n  },\n \n  async rewrites() {\n    return [\n      {\n        source: '/with-locale', // automatically handles all locales\n        destination: '/another', // automatically passes the locale on\n      },\n      {\n        // does not handle locales automatically since locale: false is set\n        source: '/nl/with-locale-manual',\n        destination: '/nl/another',\n        locale: false,\n      },\n      {\n        // this matches '/' since `en` is the defaultLocale\n        source: '/en',\n        destination: '/en/another',\n        locale: false,\n      },\n      {\n        // it's possible to match all locales even when locale: false is set\n        source: '/:locale/api-alias/:path*',\n        destination: '/api/:path*',\n        locale: false,\n      },\n      {\n        // this gets converted to /(en|fr|de)/(.*) so will not match the top-level\n        // `/` or `/fr` routes like /:path* would\n        source: '/(.*)',\n        destination: '/another',\n      },\n    ]\n  },\n}</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.3.0</code></td>\n<td>\n<code>missing</code> added.</td>\n</tr>\n<tr>\n<td><code>v10.2.0</code></td>\n<td>\n<code>has</code> added.</td>\n</tr>\n<tr>\n<td><code>v9.5.0</code></td>\n<td>Headers added.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/rewrites\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/rewrites</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/runtime-configuration":"<h1 class=\"break-words\">Runtime Config</h1>\n<blockquote class=\"p-3 text-sm\"> <p><strong>Warning:</strong></p> <ul> <li>\n<strong>This feature is deprecated.</strong> We recommend using <a href=\"../../building-your-application/configuring/environment-variables\">environment variables</a> instead, which also can support reading runtime values.</li> <li>You can run code on server startup using the <a href=\"../../../app/building-your-application/optimizing/instrumentation\"><code>register</code> function</a>.</li> <li>This feature does not work with <a href=\"../../building-your-application/rendering/automatic-static-optimization\">Automatic Static Optimization</a>, <a href=\"output#automatically-copying-traced-files\">Output File Tracing</a>, or <a href=\"../../../app/building-your-application/rendering/server-components\">React Server Components</a>.</li> </ul> </blockquote> <p>To add runtime configuration to your app, open <code>next.config.js</code> and add the <code>publicRuntimeConfig</code> and <code>serverRuntimeConfig</code> configs:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  serverRuntimeConfig: {\n    // Will only be available on the server side\n    mySecret: 'secret',\n    secondSecret: process.env.SECOND_SECRET, // Pass through env variables\n  },\n  publicRuntimeConfig: {\n    // Will be available on both server and client\n    staticFolder: '/static',\n  },\n}</pre></div> <p>Place any server-only runtime config under <code>serverRuntimeConfig</code>.</p> <p>Anything accessible to both client and server-side code should be under <code>publicRuntimeConfig</code>.</p> <blockquote class=\"p-3 text-sm\"> <p>A page that relies on <code>publicRuntimeConfig</code> <strong>must</strong> use <code>getInitialProps</code> or <code>getServerSideProps</code> or your application must have a <a href=\"../../building-your-application/routing/custom-app\">Custom App</a> with <code>getInitialProps</code> to opt-out of <a href=\"../../building-your-application/rendering/automatic-static-optimization\">Automatic Static Optimization</a>. Runtime configuration won't be available to any page (or component in a page) without being server-side rendered.</p> </blockquote> <p>To get access to the runtime configs in your app use <code>next/config</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import getConfig from 'next/config'\nimport Image from 'next/image'\n \n// Only holds serverRuntimeConfig and publicRuntimeConfig\nconst { serverRuntimeConfig, publicRuntimeConfig } = getConfig()\n// Will only be available on the server-side\nconsole.log(serverRuntimeConfig.mySecret)\n// Will be available on both server-side and client-side\nconsole.log(publicRuntimeConfig.staticFolder)\n \nfunction MyImage() {\n  return (\n    &lt;div&gt;\n      &lt;Image\n        src={`${publicRuntimeConfig.staticFolder}/logo.png`}\n        alt=\"logo\"\n        layout=\"fill\"\n      /&gt;\n    &lt;/div&gt;\n  )\n}\n \nexport default MyImage</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/runtime-configuration\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/runtime-configuration</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/typescript":"<h1 class=\"break-words\">typescript</h1> <p>Next.js fails your <strong>production build</strong> (<code>next build</code>) when TypeScript errors are present in your project.</p> <p>If you'd like Next.js to dangerously produce production code even when your application has errors, you can disable the built-in type checking step.</p> <p>If disabled, be sure you are running type checks as part of your build or deploy process, otherwise this can be very dangerous.</p> <p>Open <code>next.config.js</code> and enable the <code>ignoreBuildErrors</code> option in the <code>typescript</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  typescript: {\n    // !! WARN !!\n    // Dangerously allow production builds to successfully complete even if\n    // your project has type errors.\n    // !! WARN !!\n    ignoreBuildErrors: true,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/typescript\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/typescript</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/ondemandentries":"<h1 class=\"break-words\">onDemandEntries</h1> <p>Next.js exposes some options that give you some control over how the server will dispose or keep in memory built pages in development.</p> <p>To change the defaults, open <code>next.config.js</code> and add the <code>onDemandEntries</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  onDemandEntries: {\n    // period (in ms) where the server will keep pages in the buffer\n    maxInactiveAge: 25 * 1000,\n    // number of pages that should be kept simultaneously without being disposed\n    pagesBufferLength: 2,\n  },\n}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/onDemandEntries\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/onDemandEntries</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/pageextensions":"<h1 class=\"break-words\">pageExtensions</h1>  <p>You can extend the default Page extensions (<code>.tsx</code>, <code>.ts</code>, <code>.jsx</code>, <code>.js</code>) used by Next.js. Inside <code>next.config.js</code>, add the <code>pageExtensions</code> config:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  pageExtensions: ['mdx', 'md', 'jsx', 'js', 'tsx', 'ts'],\n}</pre></div>\n<p>Changing these values affects <em>all</em> Next.js pages, including the following:</p>\n<ul> <li><a href=\"../../building-your-application/routing/middleware\"><code>middleware.js</code></a></li> <li><a href=\"../../building-your-application/optimizing/instrumentation\"><code>instrumentation.js</code></a></li> <li><code>pages/_document.js</code></li> <li><code>pages/_app.js</code></li> <li><code>pages/api/</code></li> </ul>\n<p>For example, if you reconfigure <code>.ts</code> page extensions to <code>.page.ts</code>, you would need to rename pages like <code>middleware.page.ts</code>, <code>instrumentation.page.ts</code>, <code>_app.page.ts</code>.</p>\n<h2 id=\"including-non-page-files-in-the-pages-directory\" data-docs-heading=\"\">Including non-page files in the pages directory     </h2>\n<p>You can colocate test files or other files used by components in the <code>pages</code> directory. Inside <code>next.config.js</code>, add the <code>pageExtensions</code> config:</p>\n<div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  pageExtensions: ['page.tsx', 'page.ts', 'page.jsx', 'page.js'],\n}</pre></div>\n<p>Then, rename your pages to have a file extension that includes <code>.page</code> (e.g. rename <code>MyPage.tsx</code> to <code>MyPage.page.tsx</code>). Ensure you rename <em>all</em> Next.js pages, including the files mentioned above.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/pageExtensions\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/pageExtensions</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/trailingslash":"<h1 class=\"break-words\">trailingSlash</h1> <p>By default Next.js will redirect urls with trailing slashes to their counterpart without a trailing slash. For example <code>/about/</code> will redirect to <code>/about</code>. You can configure this behavior to act the opposite way, where urls without trailing slashes are redirected to their counterparts with trailing slashes.</p> <p>Open <code>next.config.js</code> and add the <code>trailingSlash</code> config:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  trailingSlash: true,\n}</pre></div> <p>With this option set, urls like <code>/about</code> will redirect to <code>/about/</code>.</p> <p>When used with <a href=\"../../../app/building-your-application/deploying/static-exports\"><code>output: \"export\"</code></a> configuration, the <code>/about</code> page will output <code>/about/index.html</code> (instead of the default <code>/about.html</code>).</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v9.5.0</code></td>\n<td>\n<code>trailingSlash</code> added.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/trailingSlash\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/trailingSlash</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/transpilepackages":"<h1 class=\"break-words\">transpilePackages</h1> <p>Next.js can automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (<code>node_modules</code>). This replaces the <code>next-transpile-modules</code> package.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  transpilePackages: ['@acme/ui', 'lodash-es'],\n}\n \nmodule.exports = nextConfig</pre></div> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody><tr>\n<td><code>v13.0.0</code></td>\n<td>\n<code>transpilePackages</code> added.</td>\n</tr></tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/transpilePackages\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/transpilePackages</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/turbo":"<h1 class=\"break-words\">turbo (experimental)</h1> <p>Turbopack can be customized to transform different files and change how modules are resolved.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>These features are experimental and will only work with <code>next --turbo</code>.</li> <li>Turbopack for Next.js does not require loaders nor loader configuration for built-in functionality. Turbopack has built-in support for css and compiling modern JavaScript, so there's no need for <code>css-loader</code>, <code>postcss-loader</code>, or <code>babel-loader</code> if you're using <code>@babel/preset-env</code>.</li> </ul> </blockquote> <h2 id=\"webpack-loaders\" data-docs-heading=\"\">webpack loaders     </h2> <p>If you need loader support beyond what's built in, many webpack loaders already work with Turbopack. There are currently some limitations:</p> <ul> <li>Only a core subset of the webpack loader API is implemented. Currently, there is enough coverage for some popular loaders, and we'll expand our API support in the future.</li> <li>Only loaders that return JavaScript code are supported. Loaders that transform files like stylesheets or images are not currently supported.</li> <li>Options passed to webpack loaders must be plain JavaScript primitives, objects, and arrays. For example, it's not possible to pass <code>require()</code>d plugin modules as option values.</li> </ul> <p>To configure loaders, add the names of the loaders you've installed and any options in <code>next.config.js</code>, mapping file extensions to a list of loaders:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    turbo: {\n      rules: {\n        '*.svg': {\n          loaders: ['@svgr/webpack'],\n          as: '*.js',\n        },\n      },\n    },\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Prior to Next.js version 13.4.4, <code>experimental.turbo.rules</code> was named <code>experimental.turbo.loaders</code> and only accepted file extensions like <code>.mdx</code> instead of <code>*.mdx</code>.</p> </blockquote> <h3 id=\"supported-loaders\" data-docs-heading=\"\">Supported loaders     </h3> <p>The following loaders have been tested to work with Turbopack's webpack loader implementation:</p> <ul> <li><a href=\"https://www.npmjs.com/package/babel-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>babel-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/@svgr/webpack\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>@svgr/webpack</code></a></li> <li><a href=\"https://www.npmjs.com/package/svg-inline-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>svg-inline-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/yaml-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>yaml-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/string-replace-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>string-replace-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/raw-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>raw-loader</code></a></li> <li><a href=\"https://www.npmjs.com/package/sass-loader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">'sass-loader'</a></li> </ul> <h2 id=\"resolve-aliases\" data-docs-heading=\"\">Resolve aliases     </h2> <p>Through <code>next.config.js</code>, Turbopack can be configured to modify module resolution through aliases, similar to webpack's <a href=\"https://webpack.js.org/configuration/resolve/#resolvealias\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>resolve.alias</code></a> configuration.</p> <p>To configure resolve aliases, map imported patterns to their new destination in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    turbo: {\n      resolveAlias: {\n        underscore: 'lodash',\n        mocha: { browser: 'mocha/browser-entry.js' },\n      },\n    },\n  },\n}</pre></div> <p>This aliases imports of the <code>underscore</code> package to the <code>lodash</code> package. In other words, <code>import underscore from 'underscore'</code> will load the <code>lodash</code> module instead of <code>underscore</code>.</p> <p>Turbopack also supports conditional aliasing through this field, similar to Node.js's <a href=\"https://nodejs.org/docs/latest-v18.x/api/packages.html#conditional-exports\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">conditional exports</a>. At the moment only the <code>browser</code> condition is supported. In the case above, imports of the <code>mocha</code> module will be aliased to <code>mocha/browser-entry.js</code> when Turbopack targets browser environments.</p> <h2 id=\"resolve-extensions\" data-docs-heading=\"\">Resolve extensions     </h2> <p>Through <code>next.config.js</code>, Turbopack can be configured to resolve modules with custom extensions, similar to webpack's <a href=\"https://webpack.js.org/configuration/resolve/#resolveextensions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>resolve.extensions</code></a> configuration.</p> <p>To configure resolve extensions, use the <code>resolveExtensions</code> field in <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    turbo: {\n      resolveExtensions: [\n        '.mdx',\n        '.tsx',\n        '.ts',\n        '.jsx',\n        '.js',\n        '.mjs',\n        '.json',\n      ],\n    },\n  },\n}</pre></div> <p>This overwrites the original resolve extensions with the provided list. Make sure to include the default extensions.</p> <p>For more information and guidance for how to migrate your app to Turbopack from webpack, see <a href=\"https://turbo.build/pack/docs/migrating-from-webpack\" rel=\"noopener noreferrer\" target=\"_blank\">Turbopack's documentation on webpack compatibility</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/turbo\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/turbo</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/urlimports":"<h1 class=\"break-words\">urlImports</h1> <p>URL imports are an experimental feature that allows you to import modules directly from external servers (instead of from the local disk).</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Warning</strong>: This feature is experimental. Only use domains that you trust to download and execute on your machine. Please exercise discretion, and caution until the feature is flagged as stable.</p> </blockquote> <p>To opt-in, add the allowed URL prefixes inside <code>next.config.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    urlImports: ['https://example.com/assets/', 'https://cdn.skypack.dev'],\n  },\n}</pre></div> <p>Then, you can import modules directly from URLs:</p> <div class=\"code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { a, b, c } from 'https://example.com/assets/some/module.js'</pre>\n</div> <p>URL Imports can be used everywhere normal package imports can be used.</p> <h2 id=\"security-model\" data-docs-heading=\"\">Security Model     </h2> <p>This feature is being designed with <strong>security as the top priority</strong>. To start, we added an experimental flag forcing you to explicitly allow the domains you accept URL imports from. We're working to take this further by limiting URL imports to execute in the browser sandbox using the <a href=\"../../../app/api-reference/edge\">Edge Runtime</a>.</p> <h2 id=\"lockfile\" data-docs-heading=\"\">Lockfile     </h2> <p>When using URL imports, Next.js will create a <code>next.lock</code> directory containing a lockfile and fetched assets. This directory <strong>must be committed to Git</strong>, not ignored by <code>.gitignore</code>.</p> <ul> <li>When running <code>next dev</code>, Next.js will download and add all newly discovered URL Imports to your lockfile</li> <li>When running <code>next build</code>, Next.js will use only the lockfile to build the application for production</li> </ul> <p>Typically, no network requests are needed and any outdated lockfile will cause the build to fail. One exception is resources that respond with <code>Cache-Control: no-cache</code>. These resources will have a <code>no-cache</code> entry in the lockfile and will always be fetched from the network on each build.</p> <h2 id=\"examples\" data-docs-heading=\"\">Examples     </h2> <h3 id=\"skypack\" data-docs-heading=\"\">Skypack     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import confetti from 'https://cdn.skypack.dev/canvas-confetti'\nimport { useEffect } from 'react'\n \nexport default () =&gt; {\n  useEffect(() =&gt; {\n    confetti()\n  })\n  return &lt;p&gt;Hello&lt;/p&gt;\n}</pre>\n</div> <h3 id=\"static-image-imports\" data-docs-heading=\"\">Static Image Imports     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\nimport logo from 'https://example.com/assets/logo.png'\n \nexport default () =&gt; (\n  &lt;div&gt;\n    &lt;Image src={logo} placeholder=\"blur\" /&gt;\n  &lt;/div&gt;\n)</pre>\n</div> <h3 id=\"urls-in-css\" data-docs-heading=\"\">URLs in CSS     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">.className {\n  background: url('https://example.com/assets/hero.jpg');\n}</pre>\n</div> <h3 id=\"asset-imports\" data-docs-heading=\"\">Asset Imports     </h3> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const logo = new URL('https://example.com/assets/file.txt', import.meta.url)\n \nconsole.log(logo.pathname)\n \n// prints \"/_next/static/media/file.a9727b5d.txt\"</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/urlImports\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/urlImports</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/webpack":"<h1 class=\"break-words\">Custom Webpack Config</h1> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: changes to webpack config are not covered by semver so proceed at your own risk</p> </blockquote> <p>Before continuing to add custom webpack configuration to your application make sure Next.js doesn't already support your use-case:</p>  <ul> <li><a href=\"../../building-your-application/styling\">CSS imports</a></li> <li><a href=\"../../building-your-application/styling/css-modules\">CSS modules</a></li> <li><a href=\"../../building-your-application/styling/sass\">Sass/SCSS imports</a></li> <li><a href=\"../../building-your-application/styling/sass\">Sass/SCSS modules</a></li> <li><a href=\"../../building-your-application/configuring/babel\">Customizing babel configuration</a></li> </ul> <p>Some commonly asked for features are available as plugins:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/tree/canary/packages/next-mdx\" rel=\"noopener noreferrer\" target=\"_blank\">@next/mdx</a></li> <li><a href=\"https://github.com/vercel/next.js/tree/canary/packages/next-bundle-analyzer\" rel=\"noopener noreferrer\" target=\"_blank\">@next/bundle-analyzer</a></li> </ul> <p>In order to extend our usage of <code>webpack</code>, you can define a function that extends its config inside <code>next.config.js</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  webpack: (\n    config,\n    { buildId, dev, isServer, defaultLoaders, nextRuntime, webpack }\n  ) =&gt; {\n    // Important: return the modified config\n    return config\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p>The <code>webpack</code> function is executed three times, twice for the server (nodejs / edge runtime) and once for the client. This allows you to distinguish between client and server configuration using the <code>isServer</code> property.</p> </blockquote> <p>The second argument to the <code>webpack</code> function is an object with the following properties:</p> <ul> <li>\n<code>buildId</code>: <code>String</code> - The build id, used as a unique identifier between builds</li> <li>\n<code>dev</code>: <code>Boolean</code> - Indicates if the compilation will be done in development</li> <li>\n<code>isServer</code>: <code>Boolean</code> - It's <code>true</code> for server-side compilation, and <code>false</code> for client-side compilation</li> <li>\n<code>nextRuntime</code>: <code>String | undefined</code> - The target runtime for server-side compilation; either <code>\"edge\"</code> or <code>\"nodejs\"</code>, it's <code>undefined</code> for client-side compilation.</li> <li>\n<code>defaultLoaders</code>: <code>Object</code> - Default loaders used internally by Next.js: <ul> <li>\n<code>babel</code>: <code>Object</code> - Default <code>babel-loader</code> configuration</li> </ul> </li> </ul> <p>Example usage of <code>defaultLoaders.babel</code>:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// Example config for adding a loader that depends on babel-loader\n// This source was taken from the @next/mdx plugin source:\n// https://github.com/vercel/next.js/tree/canary/packages/next-mdx\nmodule.exports = {\n  webpack: (config, options) =&gt; {\n    config.module.rules.push({\n      test: /\\.mdx/,\n      use: [\n        options.defaultLoaders.babel,\n        {\n          loader: '@mdx-js/loader',\n          options: pluginOptions.options,\n        },\n      ],\n    })\n \n    return config\n  },\n}</pre>\n</div> <h4 id=\"nextruntime\" data-docs-heading=\"\">nextRuntime     </h4> <p>Notice that <code>isServer</code> is <code>true</code> when <code>nextRuntime</code> is <code>\"edge\"</code> or <code>\"nodejs\"</code>, nextRuntime \"<code>edge</code>\" is currently for middleware and Server Components in edge runtime only.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/webpack\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/webpack</a>\n  </p>\n</div>\n","pages/api-reference/next-config-js/webvitalsattribution":"<h1 class=\"break-words\">webVitalsAttribution</h1> <p>When debugging issues related to Web Vitals, it is often helpful if we can pinpoint the source of the problem. For example, in the case of Cumulative Layout Shift (CLS), we might want to know the first element that shifted when the single largest layout shift occurred. Or, in the case of Largest Contentful Paint (LCP), we might want to identify the element corresponding to the LCP for the page. If the LCP element is an image, knowing the URL of the image resource can help us locate the asset we need to optimize.</p> <p>Pinpointing the biggest contributor to the Web Vitals score, aka <a href=\"https://github.com/GoogleChrome/web-vitals/blob/4ca38ae64b8d1e899028c692f94d4c56acfc996c/README.md#attribution\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">attribution</a>, allows us to obtain more in-depth information like entries for <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceEventTiming\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">PerformanceEventTiming</a>, <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceNavigationTiming\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">PerformanceNavigationTiming</a> and <a href=\"https://developer.mozilla.org/docs/Web/API/PerformanceResourceTiming\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">PerformanceResourceTiming</a>.</p> <p>Attribution is disabled by default in Next.js but can be enabled <strong>per metric</strong> by specifying the following in <code>next.config.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">experimental: {\n  webVitalsAttribution: ['CLS', 'LCP']\n}</pre></div> <p>Valid attribution values are all <code>web-vitals</code> metrics specified in the <a href=\"https://github.com/vercel/next.js/blob/442378d21dd56d6e769863eb8c2cb521a463a2e0/packages/next/shared/lib/utils.ts#L43\" rel=\"noopener noreferrer\" target=\"_blank\"><code>NextWebVitalsMetric</code></a> type.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/webVitalsAttribution\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-config-js/webVitalsAttribution</a>\n  </p>\n</div>\n","pages/api-reference/create-next-app":"<h1 class=\"break-words\">create-next-app</h1> <p>The easiest way to get started with Next.js is by using <code>create-next-app</code>. This CLI tool enables you to quickly start building a new Next.js application, with everything set up for you.</p> <p>You can create a new app using the default Next.js template, or by using one of the <a href=\"https://github.com/vercel/next.js/tree/canary/examples\" rel=\"noopener noreferrer\" target=\"_blank\">official Next.js examples</a>.</p> <h3 id=\"interactive\" data-docs-heading=\"\">Interactive     </h3> <p>You can create a new project interactively by running:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">npx create-next-app@latest</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">yarn create next-app</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">pnpm create next-app</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">bunx create-next-app</pre></div> <p>You will then be asked the following prompts:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">What is your project named?  my-app\nWould you like to use TypeScript?  No / Yes\nWould you like to use ESLint?  No / Yes\nWould you like to use Tailwind CSS?  No / Yes\nWould you like to use `src/` directory?  No / Yes\nWould you like to use App Router? (recommended)  No / Yes\nWould you like to customize the default import alias (@/*)?  No / Yes</pre></div> <p>Once you've answered the prompts, a new project will be created with the correct configuration depending on your answers.</p> <h3 id=\"non-interactive\" data-docs-heading=\"\">Non-interactive     </h3> <p>You can also pass command line arguments to set up a new project non-interactively.</p> <p>Further, you can negate default options by prefixing them with <code>--no-</code> (e.g. <code>--no-eslint</code>).</p> <p>See <code>create-next-app --help</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: create-next-app &lt;project-directory&gt; [options]\n \nOptions:\n  -V, --version                        output the version number\n  --ts, --typescript\n \n    Initialize as a TypeScript project. (default)\n \n  --js, --javascript\n \n    Initialize as a JavaScript project.\n \n  --tailwind\n \n    Initialize with Tailwind CSS config. (default)\n \n  --eslint\n \n    Initialize with ESLint config.\n \n  --app\n \n    Initialize as an App Router project.\n \n  --src-dir\n \n    Initialize inside a `src/` directory.\n \n  --import-alias &lt;alias-to-configure&gt;\n \n    Specify import alias to use (default \"@/*\").\n \n  --use-npm\n \n    Explicitly tell the CLI to bootstrap the app using npm\n \n  --use-pnpm\n \n    Explicitly tell the CLI to bootstrap the app using pnpm\n \n  --use-yarn\n \n    Explicitly tell the CLI to bootstrap the app using Yarn\n \n  --use-bun\n \n    Explicitly tell the CLI to bootstrap the app using Bun\n \n  -e, --example [name]|[github-url]\n \n    An example to bootstrap the app with. You can use an example name\n    from the official Next.js repo or a public GitHub URL. The URL can use\n    any branch and/or subdirectory\n \n  --example-path &lt;path-to-example&gt;\n \n    In a rare case, your GitHub URL might contain a branch name with\n    a slash (e.g. bug/fix-1) and the path to the example (e.g. foo/bar).\n    In this case, you must specify the path to the example separately:\n    --example-path foo/bar\n \n  --reset-preferences\n \n    Explicitly tell the CLI to reset any stored preferences\n \n  -h, --help                           output usage information</pre></div> <h3 id=\"why-use-create-next-app\" data-docs-heading=\"\">Why use Create Next App?     </h3> <p><code>create-next-app</code> allows you to create a new Next.js app within seconds. It is officially maintained by the creators of Next.js, and includes a number of benefits:</p> <ul> <li>\n<strong>Interactive Experience</strong>: Running <code>npx create-next-app@latest</code> (with no arguments) launches an interactive experience that guides you through setting up a project.</li> <li>\n<strong>Zero Dependencies</strong>: Initializing a project is as quick as one second. Create Next App has zero dependencies.</li> <li>\n<strong>Offline Support</strong>: Create Next App will automatically detect if you're offline and bootstrap your project using your local package cache.</li> <li>\n<strong>Support for Examples</strong>: Create Next App can bootstrap your application using an example from the Next.js examples collection (e.g. <code>npx create-next-app --example api-routes</code>) or any public GitHub repository.</li> <li>\n<strong>Tested</strong>: The package is part of the Next.js monorepo and tested using the same integration test suite as Next.js itself, ensuring it works as expected with every release.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/create-next-app\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/create-next-app</a>\n  </p>\n</div>\n","pages/api-reference/next-cli":"<h1 class=\"break-words\">Next.js CLI</h1> <p>The Next.js CLI allows you to develop, build, start your application, and more.</p> <p>To get a list of the available CLI commands, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage next [options] [command]\n \nThe Next.js CLI allows you to develop, build, start your application, and more.\n \nOptions:\n  -v, --version                Outputs the Next.js version.\n  -h, --help                   Displays this message.\n \nCommands:\n  build [directory] [options]  Creates an optimized production build of your application.\n                               The output displays information about each route.\n  dev [directory] [options]    Starts Next.js in development mode with hot-code reloading,\n                               error reporting, and more.\n  info [options]               Prints relevant details about the current system which can be\n                               used to report Next.js bugs.\n  lint [directory] [options]   Runs ESLint for all files in the `/src`, `/app`, `/pages`,\n                               `/components`, and `/lib` directories. It also provides a\n                               guided setup to install any required dependencies if ESLint\n                               is not already configured in your application.\n  start [directory] [options]  Starts Next.js in production mode. The application should be\n                               compiled with `next build` first.\n  telemetry [options]          Allows you to enable or disable Next.js' completely\n                               anonymous telemetry collection.</pre></div> <p>You can pass any <a href=\"https://nodejs.org/api/cli.html#cli_node_options_options\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">node arguments</a> to <code>next</code> commands:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">NODE_OPTIONS='--throw-deprecation' next\nNODE_OPTIONS='-r esm' next\nNODE_OPTIONS='--inspect' next</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Running <code>next</code> without a command is the same as running <code>next dev</code></p> </blockquote> <h2 id=\"development\" data-docs-heading=\"\">Development     </h2> <p><code>next dev</code> starts the application in development mode with hot-code reloading, error reporting, and more.</p> <p>To get a list of the available options with <code>next dev</code>, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next dev [directory] [options]\n \nStarts Next.js in development mode with hot-code reloading, error reporting, and more.\n \nArguments:\n  [directory]                              A directory on which to build the application.\n                                           If no directory is provided, the current\n                                           directory will be used.\n \nOptions:\n  --turbo                                  Starts development mode using Turbopack (beta).\n  -p, --port &lt;port&gt;                        Specify a port number on which to start the\n                                           application. (default: 3000, env: PORT)\n  -H, --hostname &lt;hostname&gt;                Specify a hostname on which to start the\n                                           application (default: 0.0.0.0).\n  --experimental-https                     Starts the server with HTTPS and generates a\n                                           self-signed certificate.\n  --experimental-https-key, &lt;path&gt;         Path to a HTTPS key file.\n  --experimental-https-cert, &lt;path&gt;        Path to a HTTPS certificate file.\n  --experimental-https-ca, &lt;path&gt;          Path to a HTTPS certificate authority file.\n  --experimental-upload-trace, &lt;traceUrl&gt;  Reports a subset of the debugging trace to a\n                                           remote HTTP URL. Includes sensitive data.\n  -h, --help                               Displays this message.</pre></div> <p>The application will start at <code>http://localhost:3000</code> by default. The default port can be changed with <code>-p</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev -p 4000</pre></div> <p>Or using the <code>PORT</code> environment variable:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">PORT=4000 next dev</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>PORT</code> cannot be set in <code>.env</code> as booting up the HTTP server happens before any other code is initialized.</li> <li>Next.js will automatically retry with another port until a port is available if a port is not specified with the CLI option <code>--port</code> or the <code>PORT</code> environment variable.</li> </ul> </blockquote> <p>You can also set the hostname to be different from the default of <code>0.0.0.0</code>, this can be useful for making the application available for other devices on the network. The default hostname can be changed with <code>-H</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev -H 192.168.1.2</pre></div> <h3 id=\"turbopack\" data-docs-heading=\"\">Turbopack     </h3> <p><a href=\"../../architecture/turbopack\">Turbopack</a> (beta), our new bundler, which is being tested and stabilized in Next.js, helps speed up local iterations while working on your application.</p> <p>To use Turbopack in development mode, add the <code>--turbo</code> option:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev --turbo</pre></div> <h3 id=\"https-for-local-development\" data-docs-heading=\"\">HTTPS for Local Development     </h3> <p>For certain use cases like webhooks or authentication, it may be required to use HTTPS to have a secure environment on <code>localhost</code>. Next.js can generate a self-signed certificate with <code>next dev</code> as follows:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev --experimental-https</pre></div> <p>You can also provide a custom certificate and key with <code>--experimental-https-key</code> and <code>--experimental-https-cert</code>. Optionally, you can provide a custom CA certificate with <code>--experimental-https-ca</code> as well.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next dev --experimental-https --experimental-https-key ./certificates/localhost-key.pem --experimental-https-cert ./certificates/localhost.pem</pre></div> <p><code>next dev --experimental-https</code> is only intended for development and creates a locally-trusted certificate with <code>mkcert</code>. In production, use properly issued certificates from trusted authorities. When deploying to Vercel, HTTPS is <a href=\"https://vercel.com/docs/security/encryption\" rel=\"noopener noreferrer\" target=\"_blank\">automatically configured</a> for your Next.js application.</p> <h2 id=\"build\" data-docs-heading=\"\">Build     </h2> <p><code>next build</code> creates an optimized production build of your application. The output displays information about each route:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Route (app)                               Size     First Load JS\n  /                                     5.3 kB         89.5 kB\n  /_not-found                           885 B          85.1 kB\n  /about                                137 B          84.4 kB\n+ First Load JS shared by all             84.2 kB\n   chunks/184-d3bb186aac44da98.js        28.9 kB\n   chunks/30b509c0-f3503c24f98f3936.js   53.4 kB\n   other shared chunks (total)\n \n \n  (Static)  prerendered as static content</pre></div> <ul> <li>\n<strong>Size</strong>: The number of assets downloaded when navigating to the page client-side. The size for each route only includes its dependencies.</li> <li>\n<strong>First Load JS</strong>: The number of assets downloaded when visiting the page from the server. The amount of JS shared by all is shown as a separate metric.</li> </ul> <p>Both of these values are <a href=\"../../app/api-reference/next-config-js/compress\"><strong>compressed with gzip</strong></a>. The first load is indicated by green, yellow, or red. Aim for green for performant applications.</p> <p>To get a list of the available options with <code>next build</code>, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next build [directory] [options]\n \nCreates an optimized production build of your application. The output displays information\nabout each route.\n \nArguments:\n  [directory]                       A directory on which to build the application. If no\n                                    provided, the current directory will be\n                                    used.\n \nOptions:\n  -d, --debug                       Enables a more verbose build output.\n  --profile                         Enables production profiling for React.\n  --no-lint                         Disables linting.\n  --no-mangling                     Disables mangling.\n  --experimental-app-only           Builds only App Router routes.\n  --experimental-build-mode [mode]  Uses an experimental build mode. (choices: \"compile\"\n                                    \"generate\", default: \"default\")\n  -h, --help                        Displays this message.</pre></div> <h3 id=\"debug\" data-docs-heading=\"\">Debug     </h3> <p>You can enable more verbose build output with the <code>--debug</code> flag in <code>next build</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build --debug</pre></div> <p>With this flag enabled additional build output like rewrites, redirects, and headers will be shown.</p> <h3 id=\"linting\" data-docs-heading=\"\">Linting     </h3> <p>You can disable linting for builds like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build --no-lint</pre></div> <h3 id=\"mangling\" data-docs-heading=\"\">Mangling     </h3> <p>You can disable <a href=\"https://en.wikipedia.org/wiki/Name_mangling\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">mangling</a> for builds like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build --no-mangling</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This may affect performance and should only be used for debugging purposes.</p> </blockquote> <h3 id=\"profiling\" data-docs-heading=\"\">Profiling     </h3> <p>You can enable production profiling for React with the <code>--profile</code> flag in <code>next build</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next build --profile</pre></div> <p>After that, you can use the profiler in the same way as you would in development.</p> <h2 id=\"production\" data-docs-heading=\"\">Production     </h2> <p><code>next start</code> starts the application in production mode. The application should be compiled with <a href=\"#build\"><code>next build</code></a> first.</p> <p>To get a list of the available options with <code>next start</code>, run the follow command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next start -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next start [directory] [options]\n \nStarts Next.js in production mode. The application should be compiled with `next build`\nfirst.\n \nArguments:\n  [directory]                           A directory on which to start the application.\n                                        If not directory is provided, the current\n                                        directory will be used.\n \nOptions:\n  -p, --port &lt;port&gt;                     Specify a port number on which to start the\n                                        application. (default: 3000, env: PORT)\n  -H, --hostname &lt;hostname&gt;             Specify a hostname on which to start the\n                                        application (default: 0.0.0.0).\n  --keepAliveTimeout &lt;keepAliveTimeout&gt; Specify the maximum amount of milliseconds to wait\n                                        before closing the inactive connections.\n  -h, --help                            Displays this message.</pre></div> <p>The application will start at <code>http://localhost:3000</code> by default. The default port can be changed with <code>-p</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next start -p 4000</pre></div> <p>Or using the <code>PORT</code> environment variable:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">PORT=4000 next start</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>\n<code>PORT</code> cannot be set in <code>.env</code> as booting up the HTTP server happens before any other code is initialized.</li> <li>\n<code>next start</code> cannot be used with <code>output: 'standalone'</code> or <code>output: 'export'</code>.</li> </ul> </blockquote> <h3 id=\"keep-alive-timeout\" data-docs-heading=\"\">Keep Alive Timeout     </h3> <p>When deploying Next.js behind a downstream proxy (e.g. a load-balancer like AWS ELB/ALB) it's important to configure Next's underlying HTTP server with <a href=\"https://nodejs.org/api/http.html#http_server_keepalivetimeout\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">keep-alive timeouts</a> that are <em>larger</em> than the downstream proxy's timeouts. Otherwise, once a keep-alive timeout is reached for a given TCP connection, Node.js will immediately terminate that connection without notifying the downstream proxy. This results in a proxy error whenever it attempts to reuse a connection that Node.js has already terminated.</p> <p>To configure the timeout values for the production Next.js server, pass <code>--keepAliveTimeout</code> (in milliseconds) to <code>next start</code>, like so:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next start --keepAliveTimeout 70000</pre></div> <h2 id=\"info\" data-docs-heading=\"\">Info     </h2> <p><code>next info</code> prints relevant details about the current system which can be used to report Next.js bugs. This information includes Operating System platform/arch/version, Binaries (Node.js, npm, Yarn, pnpm) and npm package versions (<code>next</code>, <code>react</code>, <code>react-dom</code>).</p> <p>To get a list of the available options with <code>next info</code>, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next info -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next info [options]\n \nPrints relevant details about the current system which can be used to report Next.js bugs.\n \nOptions:\n  --verbose   Collections additional information for debugging.\n  -h, --help  Displays this message.</pre></div> <p>Running <code>next info</code> will give you information like this example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"> \nOperating System:\n  Platform: linux\n  Arch: x64\n  Version: #22-Ubuntu SMP Fri Nov 5 13:21:36 UTC 2021\n  Available memory (MB): 31795\n  Available CPU cores: 16\nBinaries:\n  Node: 16.13.0\n  npm: 8.1.0\n  Yarn: 1.22.17\n  pnpm: 6.24.2\nRelevant Packages:\n  next: 14.1.1-canary.61 // Latest available version is detected (14.1.1-canary.61).\n  react: 18.2.0\n  react-dom: 18.2.0\nNext.js Config:\n  output: N/A\n </pre></div> <p>This information should then be pasted into GitHub Issues.</p> <p>You can also run <code>next info --verbose</code> which will print additional information about the system and the installation of packages related to <code>next</code>.</p> <h2 id=\"lint\" data-docs-heading=\"\">Lint     </h2> <p><code>next lint</code> runs ESLint for all files in the <code>pages/</code>, <code>app/</code>, <code>components/</code>, <code>lib/</code>, and <code>src/</code> directories. It also provides a guided setup to install any required dependencies if ESLint is not already configured in your application.</p> <p>To get a list of the available options with <code>next lint</code>, run the following command inside your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next lint -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next lint [directory] [options]\n \nRuns ESLint for all files in the `/src`, `/app`, `/pages`, `/components`, and `/lib` directories. It also\nprovides a guided setup to install any required dependencies if ESLint is not already configured in your\napplication.\n \nArguments:\n  [directory]                                         A base directory on which to lint the application.\n                                                      If no directory is provided, the current directory\n                                                      will be used.\n \nOptions:\n  -d, --dir, &lt;dirs...&gt;                                Include directory, or directories, to run ESLint.\n  --file, &lt;files...&gt;                                  Include file, or files, to run ESLint.\n  --ext, [exts...]                                    Specify JavaScript file extensions. (default:\n                                                      [\".js\", \".mjs\", \".cjs\", \".jsx\", \".ts\", \".mts\", \".cts\", \".tsx\"])\n  -c, --config, &lt;config&gt;                              Uses this configuration file, overriding all other\n                                                      configuration options.\n  --resolve-plugins-relative-to, &lt;rprt&gt;               Specify a directory where plugins should be resolved\n                                                      from.\n  --strict                                            Creates a `.eslintrc.json` file using the Next.js\n                                                      strict configuration.\n  --rulesdir, &lt;rulesdir...&gt;                           Uses additional rules from this directory(s).\n  --fix                                               Automatically fix linting issues.\n  --fix-type &lt;fixType&gt;                                Specify the types of fixes to apply (e.g., problem,\n                                                      suggestion, layout).\n  --ignore-path &lt;path&gt;                                Specify a file to ignore.\n  --no-ignore &lt;path&gt;                                  Disables the `--ignore-path` option.\n  --quiet                                             Reports errors only.\n  --max-warnings [maxWarnings]                        Specify the number of warnings before triggering a\n                                                      non-zero exit code. (default: -1)\n  -o, --output-file, &lt;outputFile&gt;                     Specify a file to write report to.\n  -f, --format, &lt;format&gt;                              Uses a specifc output format.\n  --no-inline-config                                  Prevents comments from changing config or rules.\n  --report-unused-disable-directives-severity &lt;level&gt; Specify severity level for unused eslint-disable\n                                                      directives. (choices: \"error\", \"off\", \"warn\")\n  --no-cache                                          Disables caching.\n  --cache-location, &lt;cacheLocation&gt;                   Specify a location for cache.\n  --cache-strategy, [cacheStrategy]                   Specify a strategy to use for detecting changed files\n                                                      in the cache. (default: \"metadata\")\n  --error-on-unmatched-pattern                        Reports errors when any file patterns are unmatched.\n  -h, --help                                          Displays this message.</pre></div> <p>If you have other directories that you would like to lint, you can specify them using the <code>--dir</code> flag:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next lint --dir utils</pre></div> <p>For more information on the other options, check out our <a href=\"../../app/building-your-application/configuring/eslint\">ESLint</a> configuration documentation.</p> <h2 id=\"telemetry\" data-docs-heading=\"\">Telemetry     </h2> <p>Next.js collects <strong>completely anonymous</strong> telemetry data about general usage. Participation in this anonymous program is optional, and you may opt-out if you'd not like to share any information.</p> <p>To get a list of the available options with <code>next telemetry</code>, run the following command in your project directory:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">next telemetry -h</pre></div> <p>The output should look like this:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">Usage: next telemetry [options]\n \nAllows you to enable or disable Next.js' completely anonymous telemetry collection.\n \nOptions:\n  --enable    Eanbles Next.js' telemetry collection.\n  --disable   Disables Next.js' telemetry collection.\n  -h, --help  Displays this message.\n \nLearn more: https://nextjs.org/telemetry</pre></div> <p>Learn more about <a href=\"https://nextjs.org/telemetry\">Telemetry</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/next-cli\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/next-cli</a>\n  </p>\n</div>\n","pages/api-reference/edge":"<h1 class=\"break-words\">Edge Runtime</h1> <p>The Next.js Edge Runtime is based on standard Web APIs, it supports the following APIs:</p> <h2 id=\"network-apis\" data-docs-heading=\"\">Network APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Blob\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Blob</code></a></td>\n<td>Represents a blob</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Fetch_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>fetch</code></a></td>\n<td>Fetches a resource</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/FetchEvent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>FetchEvent</code></a></td>\n<td>Represents a fetch event</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/File\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>File</code></a></td>\n<td>Represents a file</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/FormData\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>FormData</code></a></td>\n<td>Represents form data</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Headers\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Headers</code></a></td>\n<td>Represents HTTP headers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Request</code></a></td>\n<td>Represents an HTTP request</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Response\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Response</code></a></td>\n<td>Represents an HTTP response</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams</code></a></td>\n<td>Represents URL search parameters</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WebSocket\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WebSocket</code></a></td>\n<td>Represents a websocket connection</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"encoding-apis\" data-docs-heading=\"\">Encoding APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/atob\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>atob</code></a></td>\n<td>Decodes a base-64 encoded string</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/btoa\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>btoa</code></a></td>\n<td>Encodes a string in base-64</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TextDecoder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TextDecoder</code></a></td>\n<td>Decodes a Uint8Array into a string</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TextDecoderStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TextDecoderStream</code></a></td>\n<td>Chainable decoder for streams</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TextEncoder\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TextEncoder</code></a></td>\n<td>Encodes a string into a Uint8Array</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TextEncoderStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TextEncoderStream</code></a></td>\n<td>Chainable encoder for streams</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"stream-apis\" data-docs-heading=\"\">Stream APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/ReadableStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReadableStream</code></a></td>\n<td>Represents a readable stream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/ReadableStreamBYOBReader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReadableStreamBYOBReader</code></a></td>\n<td>Represents a reader of a ReadableStream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/ReadableStreamDefaultReader\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReadableStreamDefaultReader</code></a></td>\n<td>Represents a reader of a ReadableStream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/TransformStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TransformStream</code></a></td>\n<td>Represents a transform stream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WritableStream\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WritableStream</code></a></td>\n<td>Represents a writable stream</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WritableStreamDefaultWriter\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WritableStreamDefaultWriter</code></a></td>\n<td>Represents a writer of a WritableStream</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"crypto-apis\" data-docs-heading=\"\">Crypto APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Window/crypto\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>crypto</code></a></td>\n<td>Provides access to the cryptographic functionality of the platform</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/CryptoKey\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>CryptoKey</code></a></td>\n<td>Represents a cryptographic key</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/SubtleCrypto\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>SubtleCrypto</code></a></td>\n<td>Provides access to common cryptographic primitives, like hashing, signing, encryption or decryption</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"web-standard-apis\" data-docs-heading=\"\">Web Standard APIs     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/AbortController\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>AbortController</code></a></td>\n<td>Allows you to abort one or more DOM requests as and when desired</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Array</code></a></td>\n<td>Represents an array of values</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ArrayBuffer</code></a></td>\n<td>Represents a generic, fixed-length raw binary data buffer</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Atomics\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Atomics</code></a></td>\n<td>Provides atomic operations as static methods</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigInt\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>BigInt</code></a></td>\n<td>Represents a whole number with arbitrary precision</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigInt64Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>BigInt64Array</code></a></td>\n<td>Represents a typed array of 64-bit signed integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigUint64Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>BigUint64Array</code></a></td>\n<td>Represents a typed array of 64-bit unsigned integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Boolean</code></a></td>\n<td>Represents a logical entity and can have two values: <code>true</code> and <code>false</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/clearInterval\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>clearInterval</code></a></td>\n<td>Cancels a timed, repeating action which was previously established by a call to <code>setInterval()</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/clearTimeout\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>clearTimeout</code></a></td>\n<td>Cancels a timed, repeating action which was previously established by a call to <code>setTimeout()</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Console\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>console</code></a></td>\n<td>Provides access to the browser's debugging console</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/DataView\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>DataView</code></a></td>\n<td>Represents a generic view of an <code>ArrayBuffer</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Date\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Date</code></a></td>\n<td>Represents a single moment in time in a platform-independent format</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/decodeURI\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>decodeURI</code></a></td>\n<td>Decodes a Uniform Resource Identifier (URI) previously created by <code>encodeURI</code> or by a similar routine</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/decodeURIComponent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>decodeURIComponent</code></a></td>\n<td>Decodes a Uniform Resource Identifier (URI) component previously created by <code>encodeURIComponent</code> or by a similar routine</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/DOMException\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>DOMException</code></a></td>\n<td>Represents an error that occurs in the DOM</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURI\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>encodeURI</code></a></td>\n<td>Encodes a Uniform Resource Identifier (URI) by replacing each instance of certain characters by one, two, three, or four escape sequences representing the UTF-8 encoding of the character</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>encodeURIComponent</code></a></td>\n<td>Encodes a Uniform Resource Identifier (URI) component by replacing each instance of certain characters by one, two, three, or four escape sequences representing the UTF-8 encoding of the character</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Error</code></a></td>\n<td>Represents an error when trying to execute a statement or accessing a property</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/EvalError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>EvalError</code></a></td>\n<td>Represents an error that occurs regarding the global function <code>eval()</code>\n</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Float32Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Float32Array</code></a></td>\n<td>Represents a typed array of 32-bit floating point numbers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Float64Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Float64Array</code></a></td>\n<td>Represents a typed array of 64-bit floating point numbers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Function</code></a></td>\n<td>Represents a function</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Infinity\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Infinity</code></a></td>\n<td>Represents the mathematical Infinity value</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int8Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Int8Array</code></a></td>\n<td>Represents a typed array of 8-bit signed integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int16Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Int16Array</code></a></td>\n<td>Represents a typed array of 16-bit signed integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int32Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Int32Array</code></a></td>\n<td>Represents a typed array of 32-bit signed integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Intl\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Intl</code></a></td>\n<td>Provides access to internationalization and localization functionality</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/isFinite\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>isFinite</code></a></td>\n<td>Determines whether a value is a finite number</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/isNaN\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>isNaN</code></a></td>\n<td>Determines whether a value is <code>NaN</code> or not</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>JSON</code></a></td>\n<td>Provides functionality to convert JavaScript values to and from the JSON format</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Map</code></a></td>\n<td>Represents a collection of values, where each value may occur only once</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Math\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Math</code></a></td>\n<td>Provides access to mathematical functions and constants</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Number</code></a></td>\n<td>Represents a numeric value</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Object</code></a></td>\n<td>Represents the object that is the base of all JavaScript objects</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/parseFloat\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>parseFloat</code></a></td>\n<td>Parses a string argument and returns a floating point number</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/parseInt\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>parseInt</code></a></td>\n<td>Parses a string argument and returns an integer of the specified radix</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Promise</code></a></td>\n<td>Represents the eventual completion (or failure) of an asynchronous operation, and its resulting value</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Proxy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Proxy</code></a></td>\n<td>Represents an object that is used to define custom behavior for fundamental operations (e.g. property lookup, assignment, enumeration, function invocation, etc)</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/queueMicrotask\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>queueMicrotask</code></a></td>\n<td>Queues a microtask to be executed</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RangeError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>RangeError</code></a></td>\n<td>Represents an error when a value is not in the set or range of allowed values</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>ReferenceError</code></a></td>\n<td>Represents an error when a non-existent variable is referenced</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Reflect\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Reflect</code></a></td>\n<td>Provides methods for interceptable JavaScript operations</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RegExp\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>RegExp</code></a></td>\n<td>Represents a regular expression, allowing you to match combinations of characters</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Set\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Set</code></a></td>\n<td>Represents a collection of values, where each value may occur only once</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/setInterval\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>setInterval</code></a></td>\n<td>Repeatedly calls a function, with a fixed time delay between each call</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/setTimeout\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>setTimeout</code></a></td>\n<td>Calls a function or evaluates an expression after a specified number of milliseconds</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>SharedArrayBuffer</code></a></td>\n<td>Represents a generic, fixed-length raw binary data buffer</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>String</code></a></td>\n<td>Represents a sequence of characters</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>structuredClone</code></a></td>\n<td>Creates a deep copy of a value</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Symbol\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Symbol</code></a></td>\n<td>Represents a unique and immutable data type that is used as the key of an object property</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>SyntaxError</code></a></td>\n<td>Represents an error when trying to interpret syntactically invalid code</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/TypeError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>TypeError</code></a></td>\n<td>Represents an error when a value is not of the expected type</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Uint8Array</code></a></td>\n<td>Represents a typed array of 8-bit unsigned integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Uint8ClampedArray</code></a></td>\n<td>Represents a typed array of 8-bit unsigned integers clamped to 0-255</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>Uint32Array</code></a></td>\n<td>Represents a typed array of 32-bit unsigned integers</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/URIError\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URIError</code></a></td>\n<td>Represents an error when a global URI handling function was used in a wrong way</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URL</code></a></td>\n<td>Represents an object providing static methods used for creating object URLs</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/URLPattern\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLPattern</code></a></td>\n<td>Represents a URL pattern</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/API/URLSearchParams\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLSearchParams</code></a></td>\n<td>Represents a collection of key/value pairs</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakMap\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WeakMap</code></a></td>\n<td>Represents a collection of key/value pairs in which the keys are weakly referenced</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakSet\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WeakSet</code></a></td>\n<td>Represents a collection of objects in which each object may occur only once</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WebAssembly</code></a></td>\n<td>Provides access to WebAssembly</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"nextjs-specific-polyfills\" data-docs-heading=\"\">Next.js Specific Polyfills     </h2> <ul> <li><a href=\"https://nodejs.org/api/async_context.html#class-asynclocalstorage\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>AsyncLocalStorage</code></a></li> </ul> <h2 id=\"environment-variables\" data-docs-heading=\"\">Environment Variables     </h2> <p>You can use <code>process.env</code> to access <a href=\"../../app/building-your-application/configuring/environment-variables\">Environment Variables</a> for both <code>next dev</code> and <code>next build</code>.</p> <h2 id=\"unsupported-apis\" data-docs-heading=\"\">Unsupported APIs     </h2> <p>The Edge Runtime has some restrictions including:</p> <ul> <li>Native Node.js APIs <strong>are not supported</strong>. For example, you can't read or write to the filesystem.</li> <li>\n<code>node_modules</code> <em>can</em> be used, as long as they implement ES Modules and do not use native Node.js APIs.</li> <li>Calling <code>require</code> directly is <strong>not allowed</strong>. Use ES Modules instead.</li> </ul> <p>The following JavaScript language features are disabled, and <strong>will not work:</strong></p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>API</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/eval\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>eval</code></a></td>\n<td>Evaluates JavaScript code represented as a string</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>new Function(evalString)</code></a></td>\n<td>Creates a new function with the code provided as an argument</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/compile\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WebAssembly.compile</code></a></td>\n<td>Compiles a WebAssembly module from a buffer source</td>\n</tr>\n<tr>\n<td><a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/instantiate\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>WebAssembly.instantiate</code></a></td>\n<td>Compiles and instantiates a WebAssembly module from a buffer source</td>\n</tr>\n</tbody>\n</table></div> <p>In rare cases, your code could contain (or import) some dynamic code evaluation statements which <em>can not be reached at runtime</em> and which can not be removed by treeshaking. You can relax the check to allow specific files with your Middleware or Edge API Route exported configuration:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  runtime: 'edge', // for Edge API Routes only\n  unstable_allowDynamic: [\n    // allows a single file\n    '/lib/utilities.js',\n    // use a glob to allow anything in the function-bind 3rd party module\n    '/node_modules/function-bind/**',\n  ],\n}</pre>\n</div> <p><code>unstable_allowDynamic</code> is a <a href=\"https://github.com/micromatch/micromatch#matching-features\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">glob</a>, or an array of globs, ignoring dynamic code evaluation for specific files. The globs are relative to your application root folder.</p> <p>Be warned that if these statements are executed on the Edge, <em>they will throw and cause a runtime error</em>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages/api-reference/edge\" class=\"_attribution-link\">https://nextjs.org/docs/pages/api-reference/edge</a>\n  </p>\n</div>\n","architecture":"<h1 class=\"break-words\">Architecture</h1>\n<p>Learn about the Next.js architecture and how it works under the hood.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/architecture\" class=\"_attribution-link\">https://nextjs.org/docs/architecture</a>\n  </p>\n</div>\n","architecture/accessibility":"<h1 class=\"break-words\">Accessibility</h1>\n<p>The Next.js team is committed to making Next.js accessible to all developers (and their end-users). By adding accessibility features to Next.js by default, we aim to make the Web more inclusive for everyone.</p> <h2 id=\"route-announcements\" data-docs-heading=\"\">Route Announcements     </h2> <p>When transitioning between pages rendered on the server (e.g. using the <code>&lt;a href&gt;</code> tag) screen readers and other assistive technology announce the page title when the page loads so that users understand that the page has changed.</p> <p>In addition to traditional page navigations, Next.js also supports client-side transitions for improved performance (using <code>next/link</code>). To ensure that client-side transitions are also announced to assistive technology, Next.js includes a route announcer by default.</p> <p>The Next.js route announcer looks for the page name to announce by first inspecting <code>document.title</code>, then the <code>&lt;h1&gt;</code> element, and finally the URL pathname. For the most accessible user experience, ensure that each page in your application has a unique and descriptive title.</p> <h2 id=\"linting\" data-docs-heading=\"\">Linting     </h2> <p>Next.js provides an <a href=\"../pages/building-your-application/configuring/eslint\">integrated ESLint experience</a> out of the box, including custom rules for Next.js. By default, Next.js includes <code>eslint-plugin-jsx-a11y</code> to help catch accessibility issues early, including warning on:</p> <ul> <li><a href=\"https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/aria-props.md?rgh-link-date=2021-06-04T02%3A10%3A36Z\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">aria-props</a></li> <li><a href=\"https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/aria-proptypes.md?rgh-link-date=2021-06-04T02%3A10%3A36Z\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">aria-proptypes</a></li> <li><a href=\"https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/aria-unsupported-elements.md?rgh-link-date=2021-06-04T02%3A10%3A36Z\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">aria-unsupported-elements</a></li> <li><a href=\"https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/role-has-required-aria-props.md?rgh-link-date=2021-06-04T02%3A10%3A36Z\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">role-has-required-aria-props</a></li> <li><a href=\"https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/role-supports-aria-props.md?rgh-link-date=2021-06-04T02%3A10%3A36Z\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">role-supports-aria-props</a></li> </ul> <p>For example, this plugin helps ensure you add alt text to <code>img</code> tags, use correct <code>aria-*</code> attributes, use correct <code>role</code> attributes, and more.</p> <h2 id=\"accessibility-resources\" data-docs-heading=\"\">Accessibility Resources     </h2> <ul> <li><a href=\"https://webaim.org/standards/wcag/checklist\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">WebAIM WCAG checklist</a></li> <li><a href=\"https://www.w3.org/TR/WCAG22/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">WCAG 2.2 Guidelines</a></li> <li><a href=\"https://www.a11yproject.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">The A11y Project</a></li> <li>Check <a href=\"https://developer.mozilla.org/docs/Web/Accessibility/Understanding_WCAG/Perceivable/Color_contrast\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">color contrast ratios</a> between foreground and background elements</li> <li>Use <a href=\"https://web.dev/prefers-reduced-motion/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>prefers-reduced-motion</code></a> when working with animations</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/architecture/accessibility\" class=\"_attribution-link\">https://nextjs.org/docs/architecture/accessibility</a>\n  </p>\n</div>\n","architecture/fast-refresh":"<h1 class=\"break-words\">Fast Refresh</h1>\n<p>Fast Refresh is a Next.js feature that gives you instantaneous feedback on edits made to your React components. Fast Refresh is enabled by default in all Next.js applications on <strong>9.4 or newer</strong>. With Next.js Fast Refresh enabled, most edits should be visible within a second, <strong>without losing component state</strong>.</p> <h2 id=\"how-it-works\" data-docs-heading=\"\">How It Works     </h2> <ul> <li>If you edit a file that <strong>only exports React component(s)</strong>, Fast Refresh will update the code only for that file, and re-render your component. You can edit anything in that file, including styles, rendering logic, event handlers, or effects.</li> <li>If you edit a file with exports that <em>aren't</em> React components, Fast Refresh will re-run both that file, and the other files importing it. So if both <code>Button.js</code> and <code>Modal.js</code> import <code>theme.js</code>, editing <code>theme.js</code> will update both components.</li> <li>Finally, if you <strong>edit a file</strong> that's <strong>imported by files outside of the React tree</strong>, Fast Refresh <strong>will fall back to doing a full reload</strong>. You might have a file which renders a React component but also exports a value that is imported by a <strong>non-React component</strong>. For example, maybe your component also exports a constant, and a non-React utility file imports it. In that case, consider migrating the constant to a separate file and importing it into both files. This will re-enable Fast Refresh to work. Other cases can usually be solved in a similar way.</li> </ul> <h2 id=\"error-resilience\" data-docs-heading=\"\">Error Resilience     </h2> <h3 id=\"syntax-errors\" data-docs-heading=\"\">Syntax Errors     </h3> <p>If you make a syntax error during development, you can fix it and save the file again. The error will disappear automatically, so you won't need to reload the app. <strong>You will not lose component state</strong>.</p> <h3 id=\"runtime-errors\" data-docs-heading=\"\">Runtime Errors     </h3> <p>If you make a mistake that leads to a runtime error inside your component, you'll be greeted with a contextual overlay. Fixing the error will automatically dismiss the overlay, without reloading the app.</p> <p>Component state will be retained if the error did not occur during rendering. If the error did occur during rendering, React will remount your application using the updated code.</p> <p>If you have <a href=\"https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">error boundaries</a> in your app (which is a good idea for graceful failures in production), they will retry rendering on the next edit after a rendering error. This means having an error boundary can prevent you from always getting reset to the root app state. However, keep in mind that error boundaries shouldn't be <em>too</em> granular. They are used by React in production, and should always be designed intentionally.</p> <h2 id=\"limitations\" data-docs-heading=\"\">Limitations     </h2> <p>Fast Refresh tries to preserve local React state in the component you're editing, but only if it's safe to do so. Here's a few reasons why you might see local state being reset on every edit to a file:</p> <ul> <li>Local state is not preserved for class components (only function components and Hooks preserve state).</li> <li>The file you're editing might have <em>other</em> exports in addition to a React component.</li> <li>Sometimes, a file would export the result of calling a higher-order component like <code>HOC(WrappedComponent)</code>. If the returned component is a class, its state will be reset.</li> <li>Anonymous arrow functions like <code>export default () =&gt; &lt;div /&gt;;</code> cause Fast Refresh to not preserve local component state. For large codebases you can use our <a href=\"../pages/building-your-application/upgrading/codemods#name-default-component\"><code>name-default-component</code> codemod</a>.</li> </ul> <p>As more of your codebase moves to function components and Hooks, you can expect state to be preserved in more cases.</p> <h2 id=\"tips\" data-docs-heading=\"\">Tips     </h2> <ul> <li>Fast Refresh preserves React local state in function components (and Hooks) by default.</li> <li>Sometimes you might want to <em>force</em> the state to be reset, and a component to be remounted. For example, this can be handy if you're tweaking an animation that only happens on mount. To do this, you can add <code>// @refresh reset</code> anywhere in the file you're editing. This directive is local to the file, and instructs Fast Refresh to remount components defined in that file on every edit.</li> <li>You can put <code>console.log</code> or <code>debugger;</code> into the components you edit during development.</li> <li>Remember that imports are case sensitive. Both fast and full refresh can fail, when your import doesn't match the actual filename. For example, <code>'./header'</code> vs <code>'./Header'</code>.</li> </ul> <h2 id=\"fast-refresh-and-hooks\" data-docs-heading=\"\">Fast Refresh and Hooks     </h2> <p>When possible, Fast Refresh attempts to preserve the state of your component between edits. In particular, <code>useState</code> and <code>useRef</code> preserve their previous values as long as you don't change their arguments or the order of the Hook calls.</p> <p>Hooks with dependenciessuch as <code>useEffect</code>, <code>useMemo</code>, and <code>useCallback</code>will <em>always</em> update during Fast Refresh. Their list of dependencies will be ignored while Fast Refresh is happening.</p> <p>For example, when you edit <code>useMemo(() =&gt; x * 2, [x])</code> to <code>useMemo(() =&gt; x * 10, [x])</code>, it will re-run even though <code>x</code> (the dependency) has not changed. If React didn't do that, your edit wouldn't reflect on the screen!</p> <p>Sometimes, this can lead to unexpected results. For example, even a <code>useEffect</code> with an empty array of dependencies would still re-run once during Fast Refresh.</p> <p>However, writing code resilient to occasional re-running of <code>useEffect</code> is a good practice even without Fast Refresh. It will make it easier for you to introduce new dependencies to it later on and it's enforced by <a href=\"../pages/api-reference/next-config-js/reactstrictmode\">React Strict Mode</a>, which we highly recommend enabling.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/architecture/fast-refresh\" class=\"_attribution-link\">https://nextjs.org/docs/architecture/fast-refresh</a>\n  </p>\n</div>\n","architecture/nextjs-compiler":"<h1 class=\"break-words\">Next.js Compiler</h1>\n<p>The Next.js Compiler, written in Rust using <a href=\"https://swc.rs/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SWC</a>, allows Next.js to transform and minify your JavaScript code for production. This replaces Babel for individual files and Terser for minifying output bundles.</p> <p>Compilation using the Next.js Compiler is 17x faster than Babel and enabled by default since Next.js version 12. If you have an existing Babel configuration or are using <a href=\"#unsupported-features\">unsupported features</a>, your application will opt-out of the Next.js Compiler and continue using Babel.</p> <h2 id=\"why-swc\" data-docs-heading=\"\">Why SWC?     </h2> <p><a href=\"https://swc.rs/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">SWC</a> is an extensible Rust-based platform for the next generation of fast developer tools.</p> <p>SWC can be used for compilation, minification, bundling, and more  and is designed to be extended. It's something you can call to perform code transformations (either built-in or custom). Running those transformations happens through higher-level tools like Next.js.</p> <p>We chose to build on SWC for a few reasons:</p> <ul> <li>\n<strong>Extensibility:</strong> SWC can be used as a Crate inside Next.js, without having to fork the library or workaround design constraints.</li> <li>\n<strong>Performance:</strong> We were able to achieve ~3x faster Fast Refresh and ~5x faster builds in Next.js by switching to SWC, with more room for optimization still in progress.</li> <li>\n<strong>WebAssembly:</strong> Rust's support for WASM is essential for supporting all possible platforms and taking Next.js development everywhere.</li> <li>\n<strong>Community:</strong> The Rust community and ecosystem are amazing and still growing.</li> </ul> <h2 id=\"supported-features\" data-docs-heading=\"\">Supported Features     </h2> <h3 id=\"styled-components\" data-docs-heading=\"\">Styled Components     </h3> <p>We're working to port <code>babel-plugin-styled-components</code> to the Next.js Compiler.</p> <p>First, update to the latest version of Next.js: <code>npm install next@latest</code>. Then, update your <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compiler: {\n    styledComponents: true,\n  },\n}</pre></div> <p>For advanced use cases, you can configure individual properties for styled-components compilation.</p> <blockquote class=\"p-3 text-sm\"> <p>Note: <code>minify</code>, <code>transpileTemplateLiterals</code> and <code>pure</code> are not yet implemented. You can follow the progress <a href=\"https://github.com/vercel/next.js/issues/30802\" rel=\"noopener noreferrer\" target=\"_blank\">here</a>. <code>ssr</code> and <code>displayName</code> transforms are the main requirement for using <code>styled-components</code> in Next.js.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compiler: {\n    // see https://styled-components.com/docs/tooling#babel-plugin for more info on the options.\n    styledComponents: {\n      // Enabled by default in development, disabled in production to reduce file size,\n      // setting this will override the default for all environments.\n      displayName?: boolean,\n      // Enabled by default.\n      ssr?: boolean,\n      // Enabled by default.\n      fileName?: boolean,\n      // Empty by default.\n      topLevelImportPaths?: string[],\n      // Defaults to [\"index\"].\n      meaninglessFileNames?: string[],\n      // Enabled by default.\n      cssProp?: boolean,\n      // Empty by default.\n      namespace?: string,\n      // Not supported yet.\n      minify?: boolean,\n      // Not supported yet.\n      transpileTemplateLiterals?: boolean,\n      // Not supported yet.\n      pure?: boolean,\n    },\n  },\n}</pre></div> <h3 id=\"jest\" data-docs-heading=\"\">Jest     </h3> <p>The Next.js Compiler transpiles your tests and simplifies configuring Jest together with Next.js including:</p> <ul> <li>Auto mocking of <code>.css</code>, <code>.module.css</code> (and their <code>.scss</code> variants), and image imports</li> <li>Automatically sets up <code>transform</code> using SWC</li> <li>Loading <code>.env</code> (and all variants) into <code>process.env</code>\n</li> <li>Ignores <code>node_modules</code> from test resolving and transforms</li> <li>Ignoring <code>.next</code> from test resolving</li> <li>Loads <code>next.config.js</code> for flags that enable experimental SWC transforms</li> </ul> <p>First, update to the latest version of Next.js: <code>npm install next@latest</code>. Then, update your <code>jest.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">const nextJest = require('next/jest')\n \n// Providing the path to your Next.js app which will enable loading next.config.js and .env files\nconst createJestConfig = nextJest({ dir: './' })\n \n// Any custom config you want to pass to Jest\nconst customJestConfig = {\n  setupFilesAfterEnv: ['&lt;rootDir&gt;/jest.setup.js'],\n}\n \n// createJestConfig is exported in this way to ensure that next/jest can load the Next.js configuration, which is async\nmodule.exports = createJestConfig(customJestConfig)</pre></div> <h3 id=\"relay\" data-docs-heading=\"\">Relay     </h3> <p>To enable <a href=\"https://relay.dev/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Relay</a> support:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compiler: {\n    relay: {\n      // This should match relay.config.js\n      src: './',\n      artifactDirectory: './__generated__',\n      language: 'typescript',\n      eagerEsModules: false,\n    },\n  },\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: In Next.js, all JavaScript files in <code>pages</code> directory are considered routes. So, for <code>relay-compiler</code> you'll need to specify <code>artifactDirectory</code> configuration settings outside of the <code>pages</code>, otherwise <code>relay-compiler</code> will generate files next to the source file in the <code>__generated__</code> directory, and this file will be considered a route, which will break production builds.</p> </blockquote> <h3 id=\"remove-react-properties\" data-docs-heading=\"\">Remove React Properties     </h3> <p>Allows to remove JSX properties. This is often used for testing. Similar to <code>babel-plugin-react-remove-properties</code>.</p> <p>To remove properties matching the default regex <code>^data-test</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compiler: {\n    reactRemoveProperties: true,\n  },\n}</pre></div> <p>To remove custom properties:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compiler: {\n    // The regexes defined here are processed in Rust so the syntax is different from\n    // JavaScript `RegExp`s. See https://docs.rs/regex.\n    reactRemoveProperties: { properties: ['^data-custom$'] },\n  },\n}</pre></div> <h3 id=\"remove-console\" data-docs-heading=\"\">Remove Console     </h3> <p>This transform allows for removing all <code>console.*</code> calls in application code (not <code>node_modules</code>). Similar to <code>babel-plugin-transform-remove-console</code>.</p> <p>Remove all <code>console.*</code> calls:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compiler: {\n    removeConsole: true,\n  },\n}</pre></div> <p>Remove <code>console.*</code> output except <code>console.error</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  compiler: {\n    removeConsole: {\n      exclude: ['error'],\n    },\n  },\n}</pre></div> <h3 id=\"legacy-decorators\" data-docs-heading=\"\">Legacy Decorators     </h3> <p>Next.js will automatically detect <code>experimentalDecorators</code> in <code>jsconfig.json</code> or <code>tsconfig.json</code>. Legacy decorators are commonly used with older versions of libraries like <code>mobx</code>.</p> <p>This flag is only supported for compatibility with existing applications. We do not recommend using legacy decorators in new applications.</p> <p>First, update to the latest version of Next.js: <code>npm install next@latest</code>. Then, update your <code>jsconfig.json</code> or <code>tsconfig.json</code> file:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"experimentalDecorators\": true\n  }\n}</pre>\n</div> <h3 id=\"importsource\" data-docs-heading=\"\">importSource     </h3> <p>Next.js will automatically detect <code>jsxImportSource</code> in <code>jsconfig.json</code> or <code>tsconfig.json</code> and apply that. This is commonly used with libraries like <a href=\"https://theme-ui.com\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Theme UI</a>.</p> <p>First, update to the latest version of Next.js: <code>npm install next@latest</code>. Then, update your <code>jsconfig.json</code> or <code>tsconfig.json</code> file:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"compilerOptions\": {\n    \"jsxImportSource\": \"theme-ui\"\n  }\n}</pre>\n</div> <h3 id=\"emotion\" data-docs-heading=\"\">Emotion     </h3> <p>We're working to port <code>@emotion/babel-plugin</code> to the Next.js Compiler.</p> <p>First, update to the latest version of Next.js: <code>npm install next@latest</code>. Then, update your <code>next.config.js</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\"> \nmodule.exports = {\n  compiler: {\n    emotion: boolean | {\n      // default is true. It will be disabled when build type is production.\n      sourceMap?: boolean,\n      // default is 'dev-only'.\n      autoLabel?: 'never' | 'dev-only' | 'always',\n      // default is '[local]'.\n      // Allowed values: `[local]` `[filename]` and `[dirname]`\n      // This option only works when autoLabel is set to 'dev-only' or 'always'.\n      // It allows you to define the format of the resulting label.\n      // The format is defined via string where variable parts are enclosed in square brackets [].\n      // For example labelFormat: \"my-classname--[local]\", where [local] will be replaced with the name of the variable the result is assigned to.\n      labelFormat?: string,\n      // default is undefined.\n      // This option allows you to tell the compiler what imports it should\n      // look at to determine what it should transform so if you re-export\n      // Emotion's exports, you can still use transforms.\n      importMap?: {\n        [packageName: string]: {\n          [exportName: string]: {\n            canonicalImport?: [string, string],\n            styledBaseImport?: [string, string],\n          }\n        }\n      },\n    },\n  },\n}</pre></div> <h3 id=\"minification\" data-docs-heading=\"\">Minification     </h3> <p>Next.js' swc compiler is used for minification by default since v13. This is 7x faster than Terser.</p> <p>If Terser is still needed for any reason this can be configured.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  swcMinify: false,\n}</pre></div> <h3 id=\"module-transpilation\" data-docs-heading=\"\">Module Transpilation     </h3> <p>Next.js can automatically transpile and bundle dependencies from local packages (like monorepos) or from external dependencies (<code>node_modules</code>). This replaces the <code>next-transpile-modules</code> package.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  transpilePackages: ['@acme/ui', 'lodash-es'],\n}</pre></div> <h3 id=\"modularize-imports\" data-docs-heading=\"\">Modularize Imports     </h3> <p>This option has been superseded by <a href=\"../app/api-reference/next-config-js/optimizepackageimports\"><code>optimizePackageImports</code></a> in Next.js 13.5. We recommend upgrading to use the new option that does not require manual configuration of import paths.</p> <h2 id=\"experimental-features\" data-docs-heading=\"\">Experimental Features     </h2> <h3 id=\"swc-trace-profiling\" data-docs-heading=\"\">SWC Trace profiling     </h3> <p>You can generate SWC's internal transform traces as chromium's <a href=\"https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview?mode=html#%21=\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">trace event format</a>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    swcTraceProfiling: true,\n  },\n}</pre></div> <p>Once enabled, swc will generate trace named as <code>swc-trace-profile-${timestamp}.json</code> under <code>.next/</code>. Chromium's trace viewer (chrome://tracing/, <a href=\"https://ui.perfetto.dev/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">https://ui.perfetto.dev/</a>), or compatible flamegraph viewer (<a href=\"https://www.speedscope.app/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">https://www.speedscope.app/</a>) can load &amp; visualize generated traces.</p> <h3 id=\"swc-plugins-experimental\" data-docs-heading=\"\">SWC Plugins (Experimental)     </h3> <p>You can configure swc's transform to use SWC's experimental plugin support written in wasm to customize transformation behavior.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  experimental: {\n    swcPlugins: [\n      [\n        'plugin',\n        {\n          ...pluginOptions,\n        },\n      ],\n    ],\n  },\n}</pre></div> <p><code>swcPlugins</code> accepts an array of tuples for configuring plugins. A tuple for the plugin contains the path to the plugin and an object for plugin configuration. The path to the plugin can be an npm module package name or an absolute path to the <code>.wasm</code> binary itself.</p> <h2 id=\"unsupported-features\" data-docs-heading=\"\">Unsupported Features     </h2> <p>When your application has a <code>.babelrc</code> file, Next.js will automatically fall back to using Babel for transforming individual files. This ensures backwards compatibility with existing applications that leverage custom Babel plugins.</p> <p>If you're using a custom Babel setup, <a href=\"https://github.com/vercel/next.js/discussions/30174\" rel=\"noopener noreferrer\" target=\"_blank\">please share your configuration</a>. We're working to port as many commonly used Babel transformations as possible, as well as supporting plugins in the future.</p> <h2 id=\"version-history\" data-docs-heading=\"\">Version History     </h2> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Version</th>\n<th>Changes</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>v13.1.0</code></td>\n<td>\n<a href=\"https://nextjs.org/blog/next-13-1#built-in-module-transpilation-stable\" rel=\"noopener noreferrer\" target=\"_blank\">Module Transpilation</a> and <a href=\"https://nextjs.org/blog/next-13-1#import-resolution-for-smaller-bundles\" rel=\"noopener noreferrer\" target=\"_blank\">Modularize Imports</a> stable.</td>\n</tr>\n<tr>\n<td><code>v13.0.0</code></td>\n<td>SWC Minifier enabled by default.</td>\n</tr>\n<tr>\n<td><code>v12.3.0</code></td>\n<td>SWC Minifier <a href=\"https://nextjs.org/blog/next-12-3#swc-minifier-stable\" rel=\"noopener noreferrer\" target=\"_blank\">stable</a>.</td>\n</tr>\n<tr>\n<td><code>v12.2.0</code></td>\n<td>\n<a href=\"#swc-plugins-experimental\">SWC Plugins</a> experimental support added.</td>\n</tr>\n<tr>\n<td><code>v12.1.0</code></td>\n<td>Added support for Styled Components, Jest, Relay, Remove React Properties, Legacy Decorators, Remove Console, and jsxImportSource.</td>\n</tr>\n<tr>\n<td><code>v12.0.0</code></td>\n<td>Next.js Compiler <a href=\"https://nextjs.org/blog/next-12\" rel=\"noopener noreferrer\" target=\"_blank\">introduced</a>.</td>\n</tr>\n</tbody>\n</table></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/architecture/nextjs-compiler\" class=\"_attribution-link\">https://nextjs.org/docs/architecture/nextjs-compiler</a>\n  </p>\n</div>\n","architecture/supported-browsers":"<h1 class=\"break-words\">Supported Browsers</h1>\n<p>Next.js supports <strong>modern browsers</strong> with zero configuration.</p> <ul> <li>Chrome 64+</li> <li>Edge 79+</li> <li>Firefox 67+</li> <li>Opera 51+</li> <li>Safari 12+</li> </ul> <h2 id=\"browserslist\" data-docs-heading=\"\">Browserslist     </h2> <p>If you would like to target specific browsers or features, Next.js supports <a href=\"https://browsersl.ist\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Browserslist</a> configuration in your <code>package.json</code> file. Next.js uses the following Browserslist configuration by default:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"browserslist\": [\n    \"chrome 64\",\n    \"edge 79\",\n    \"firefox 67\",\n    \"opera 51\",\n    \"safari 12\"\n  ]\n}</pre></div> <h2 id=\"polyfills\" data-docs-heading=\"\">Polyfills     </h2> <p>We inject <a href=\"https://github.com/vercel/next.js/blob/canary/packages/next-polyfill-nomodule/src/index.js\" rel=\"noopener noreferrer\" target=\"_blank\">widely used polyfills</a>, including:</p> <ul> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/API/Fetch_API\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><strong>fetch()</strong></a>  Replacing: <code>whatwg-fetch</code> and <code>unfetch</code>.</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/API/URL\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><strong>URL</strong></a>  Replacing: the <a href=\"https://nodejs.org/api/url.html\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>url</code> package (Node.js API)</a>.</li> <li>\n<a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><strong>Object.assign()</strong></a>  Replacing: <code>object-assign</code>, <code>object.assign</code>, and <code>core-js/object/assign</code>.</li> </ul> <p>If any of your dependencies include these polyfills, theyll be eliminated automatically from the production build to avoid duplication.</p> <p>In addition, to reduce bundle size, Next.js will only load these polyfills for browsers that require them. The majority of the web traffic globally will not download these polyfills.</p> <h3 id=\"custom-polyfills\" data-docs-heading=\"\">Custom Polyfills     </h3> <p>If your own code or any external npm dependencies require features not supported by your target browsers (such as IE 11), you need to add polyfills yourself.</p> <p>In this case, you should add a top-level import for the <strong>specific polyfill</strong> you need in your <a href=\"../pages/building-your-application/routing/custom-app\">Custom <code>&lt;App&gt;</code></a> or the individual component.</p> <h2 id=\"javascript-language-features\" data-docs-heading=\"\">JavaScript Language Features     </h2> <p>Next.js allows you to use the latest JavaScript features out of the box. In addition to <a href=\"https://github.com/lukehoban/es6features\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">ES6 features</a>, Next.js also supports:</p> <ul> <li>\n<a href=\"https://github.com/tc39/ecmascript-asyncawait\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Async/await</a> (ES2017)</li> <li>\n<a href=\"https://github.com/tc39/proposal-object-rest-spread\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Object Rest/Spread Properties</a> (ES2018)</li> <li>\n<a href=\"https://github.com/tc39/proposal-dynamic-import\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Dynamic <code>import()</code></a> (ES2020)</li> <li>\n<a href=\"https://github.com/tc39/proposal-optional-chaining\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Optional Chaining</a> (ES2020)</li> <li>\n<a href=\"https://github.com/tc39/proposal-nullish-coalescing\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Nullish Coalescing</a> (ES2020)</li> <li>\n<a href=\"https://github.com/tc39/proposal-class-fields\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Class Fields</a> and <a href=\"https://github.com/tc39/proposal-static-class-features\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Static Properties</a> (ES2022)</li> <li>and more!</li> </ul> <h3 id=\"typescript-features\" data-docs-heading=\"\">TypeScript Features     </h3> <p>Next.js has built-in TypeScript support. <a href=\"../pages/building-your-application/configuring/typescript\">Learn more here</a>.</p> <h3 id=\"customizing-babel-config-advanced\" data-docs-heading=\"\">Customizing Babel Config (Advanced)     </h3> <p>You can customize babel configuration. <a href=\"../pages/building-your-application/configuring/babel\">Learn more here</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/architecture/supported-browsers\" class=\"_attribution-link\">https://nextjs.org/docs/architecture/supported-browsers</a>\n  </p>\n</div>\n","architecture/turbopack":"<h1 class=\"break-words\">Turbopack</h1>\n<p><a href=\"https://turbo.build/pack\" rel=\"noopener noreferrer\" target=\"_blank\">Turbopack</a> (beta) is an incremental bundler optimized for JavaScript and TypeScript, written in Rust, and built into Next.js.</p> <h2 id=\"usage\" data-docs-heading=\"\">Usage     </h2> <p>Turbopack can be used in Next.js in both the <code>pages</code> and <code>app</code> directories for faster local development. To enable Turbopack, use the <code>--turbo</code> flag when running the Next.js development server.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"scripts\": {\n    \"dev\": \"next dev --turbo\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\"\n  }\n}</pre></div> <h2 id=\"supported-features\" data-docs-heading=\"\">Supported features     </h2> <p>Turbopack in Next.js requires zero-configuration for most users and can be extended for more advanced use cases. To learn more about the currently supported features for Turbopack, view the <a href=\"../app/api-reference/next-config-js/turbo\">API Reference</a>.</p> <h2 id=\"unsupported-features\" data-docs-heading=\"\">Unsupported features     </h2> <p>Turbopack currently only supports <code>next dev</code> and does not support <code>next build</code>. We are currently working on support for builds as we move closer towards stability.</p> <p>These features are currently not supported:</p> <ul> <li>\n<a href=\"../app/api-reference/next-config-js/webpack\"><code>webpack()</code></a> configuration in <code>next.config.js</code> <ul> <li>Turbopack replaces Webpack, this means that webpack configuration is not supported.</li> <li>To configure Turbopack, <a href=\"../app/api-reference/next-config-js/turbo\">see the documentation</a>.</li> <li>A subset of <a href=\"../app/api-reference/next-config-js/turbo#webpack-loaders\">Webpack loaders</a> are supported in Turbopack.</li> </ul> </li> <li>Babel (<code>.babelrc</code>) <ul> <li>Turbopack leverages the <a href=\"nextjs-compiler#why-swc\">SWC</a> compiler for all transpilation and optimizations. This means that Babel is not included by default.</li> <li>If you have a <code>.babelrc</code> file, you might no longer need it because Next.js includes common Babel plugins as SWC transforms that can be enabled. You can read more about this in the <a href=\"docs/architecture/nextjs-compiler#supported-features\">compiler documentation</a>.</li> <li>If you still need to use Babel after verifying your particular use case is not covered, you can leverage Turbopack's <a href=\"../app/api-reference/next-config-js/turbo#webpack-loaders\">support for custom webpack loaders</a> to include <code>babel-loader</code>.</li> </ul> </li> <li>Creating a root layout automatically in App Router. <ul> <li>This behavior is currently not supported since it changes input files, instead, an error will be shown for you manually add a root layout in the desired location.</li> </ul> </li> <li>\n<code>@next/font</code> (legacy font support). <ul> <li>\n<code>@next/font</code> is deprecated in favor of <code>next/font</code>. <a href=\"../app/building-your-application/optimizing/fonts\"><code>next/font</code></a> is fully supported with Turbopack.</li> </ul> </li> <li>\n<code>new Worker('file', import.meta.url)</code>. <ul> <li>We are planning to implement this in the future.</li> </ul> </li> <li>\n<a href=\"nextjs-compiler#relay\">Relay transforms</a> <ul> <li>We are planning to implement this in the future.</li> </ul> </li> <li>\n<code>experimental.nextScriptWorkers</code> <ul> <li>We are planning to implement this in the future.</li> </ul> </li> <li>\n<a href=\"../pages/building-your-application/configuring/amp\">AMP</a>. <ul> <li>We are currently not planning to support AMP in Next.js with Turbopack.</li> </ul> </li> <li>Yarn PnP <ul> <li>We are currently not planning to support Yarn PnP in Next.js with Turbopack.</li> </ul> </li> <li>\n<a href=\"../app/api-reference/next-config-js/urlimports\"><code>experimental.urlImports</code></a> <ul> <li>We are currently not planning to support <code>experimental.urlImports</code> in Next.js with Turbopack.</li> </ul> </li> </ul> <h2 id=\"generating-trace-files\" data-docs-heading=\"\">Generating Trace Files     </h2> <p>Trace files allow the Next.js team to investigate and improve performance metrics and memory usage. To generate a trace file, append <code>NEXT_TURBOPACK_TRACING=1</code> to the <code>next dev --turbo</code> command, this will generate a <code>.next/trace.log</code> file.</p> <p>When reporting issues related to Turbopack performance and memory usage, please include the trace file in your <a href=\"https://github.com/vercel/next.js\" rel=\"noopener noreferrer\" target=\"_blank\">GitHub</a> issue.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/architecture/turbopack\" class=\"_attribution-link\">https://nextjs.org/docs/architecture/turbopack</a>\n  </p>\n</div>\n","community":"<h1 class=\"break-words\">Next.js Community</h1>\n<p>With over 5 million weekly downloads, Next.js has a large and active community of developers across the world. Here's how you can get involved in our community:</p> <h2 id=\"contributing\" data-docs-heading=\"\">Contributing     </h2> <p>There are a couple of ways you can contribute to the development of Next.js:</p> <ul> <li>\n<a href=\"community/contribution-guide\">Documentation</a>: Suggest improvements or even write new sections to help our users understand how to use Next.js.</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/contributing/examples\" rel=\"noopener noreferrer\" target=\"_blank\">Examples</a>: Help developers integrate Next.js with other tools and services by creating a new example or improving an existing one.</li> <li>\n<a href=\"https://github.com/vercel/next.js/tree/canary/contributing/core\" rel=\"noopener noreferrer\" target=\"_blank\">Codebase</a>: Learn more about the underlying architecture, contribute to bug fixes, errors, and suggest new features.</li> </ul> <h2 id=\"discussions\" data-docs-heading=\"\">Discussions     </h2> <p>If you have a question about Next.js, or want to help others, you're always welcome to join the conversation:</p> <ul> <li><a href=\"https://github.com/vercel/next.js/discussions\" rel=\"noopener noreferrer\" target=\"_blank\">GitHub Discussions</a></li> <li><a href=\"https://discord.com/invite/bUG2bvbtHy\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Discord</a></li> <li><a href=\"https://www.reddit.com/r/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Reddit</a></li> </ul> <h2 id=\"social-media\" data-docs-heading=\"\">Social Media     </h2> <p>Follow Next.js on <a href=\"https://twitter.com/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Twitter</a> for the latest updates, and subscribe to the <a href=\"https://www.youtube.com/@VercelHQ\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Vercel YouTube channel</a> for Next.js videos.</p> <h2 id=\"code-of-conduct\" data-docs-heading=\"\">Code of Conduct     </h2> <p>We believe in creating an inclusive, welcoming community. As such, we ask all members to adhere to our <a href=\"https://github.com/vercel/next.js/blob/canary/CODE_OF_CONDUCT.md\" rel=\"noopener noreferrer\" target=\"_blank\">Code of Conduct</a>. This document outlines our expectations for participant behavior. We invite you to read it and help us maintain a safe and respectful environment.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/community\" class=\"_attribution-link\">https://nextjs.org/docs/community</a>\n  </p>\n</div>\n","community/contribution-guide":"<h1 class=\"break-words\">Docs Contribution Guide</h1>\n<p>Welcome to the Next.js Docs Contribution Guide! We're excited to have you here.</p> <p>This page provides instructions on how to edit the Next.js documentation. Our goal is to ensure that everyone in the community feels empowered to contribute and improve our docs.</p> <h2 id=\"why-contribute\" data-docs-heading=\"\">Why Contribute?     </h2> <p>Open-source work is never done, and neither is documentation. Contributing to docs is a good way for beginners to get involved in open-source and for experienced developers to clarify more complex topics while sharing their knowledge with the community.</p> <p>By contributing to the Next.js docs, you're helping us build a more robust learning resource for all developers. Whether you've found a typo, a confusing section, or you've realized that a particular topic is missing, your contributions are welcomed and appreciated.</p> <h2 id=\"how-to-contribute\" data-docs-heading=\"\">How to Contribute     </h2> <p>The docs content can be found on the <a href=\"https://github.com/vercel/next.js/tree/canary/docs\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js repo</a>. To contribute, you can edit the files directly on GitHub or clone the repo and edit the files locally.</p> <h3 id=\"github-workflow\" data-docs-heading=\"\">GitHub Workflow     </h3> <p>If you're new to GitHub, we recommend reading the <a href=\"https://opensource.guide/how-to-contribute/#opening-a-pull-request\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">GitHub Open Source Guide</a> to learn how to fork a repository, create a branch, and submit a pull request.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: The underlying docs code lives in a private codebase that is synced to the Next.js public repo. This means that you can't preview the docs locally. However, you'll see your changes on <a href=\"../index\" rel=\"noopener noreferrer\" target=\"_blank\">nextjs.org</a> after merging a pull request.</p> </blockquote> <h3 id=\"writing-mdx\" data-docs-heading=\"\">Writing MDX     </h3> <p>The docs are written in <a href=\"https://mdxjs.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDX</a>, a markdown format that supports JSX syntax. This allows us to embed React components in the docs. See the <a href=\"https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">GitHub Markdown Guide</a> for a quick overview of markdown syntax.</p> <h3 id=\"vscode\" data-docs-heading=\"\">VSCode     </h3> <h4 id=\"previewing-changes-locally\" data-docs-heading=\"\">Previewing Changes Locally     </h4> <p>VSCode has a built-in markdown previewer that you can use to see your edits locally. To enable the previewer for MDX files, you'll need to add a configuration option to your user settings.</p> <p>Open the command palette (<code> +  + P</code> on Mac or <code>Ctrl + Shift + P</code> on Windows) and search from <code>Preferences: Open User Settings (JSON)</code>.</p> <p>Then, add the following line to your <code>settings.json</code> file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"files.associations\": {\n    \"*.mdx\": \"markdown\"\n  }\n}</pre></div> <p>Next, open the command palette again, and search for <code>Markdown: Preview File</code> or <code>Markdown: Open Preview to the Side</code>. This will open a preview window where you can see your formatted changes.</p> <h4 id=\"extensions\" data-docs-heading=\"\">Extensions     </h4> <p>We also recommend the following extensions for VSCode users:</p> <ul> <li>\n<a href=\"https://marketplace.visualstudio.com/items?itemName=unifiedjs.vscode-mdx\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">MDX</a>: Intellisense and syntax highlighting for MDX.</li> <li>\n<a href=\"https://marketplace.visualstudio.com/items?itemName=znck.grammarly\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Grammarly</a>: Grammar and spell checker.</li> <li>\n<a href=\"https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Prettier</a>: Format MDX files on save.</li> </ul> <h3 id=\"review-process\" data-docs-heading=\"\">Review Process     </h3> <p>Once you've submitted your contribution, the Next.js or Developer Experience teams will review your changes, provide feedback, and merge the pull request when it's ready.</p> <p>Please let us know if you have any questions or need further assistance in your PR's comments. Thank you for contributing to the Next.js docs and being a part of our community!</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Tip:</strong> Run <code>pnpm prettier-fix</code> to run Prettier before submitting your PR.</p> </blockquote> <h2 id=\"file-structure\" data-docs-heading=\"\">File Structure     </h2> <p>The docs use <strong>file-system routing</strong>. Each folder and files inside <a href=\"https://github.com/vercel/next.js/tree/canary/docs\" rel=\"noopener noreferrer\" target=\"_blank\"><code>/docs</code></a> represent a route segment. These segments are used to generate the URL paths, navigation, and breadcrumbs.</p> <p>The file structure reflects the navigation that you see on the site, and by default, navigation items are sorted alphabetically. However, we can change the order of the items by prepending a two-digit number (<code>00-</code>) to the folder or file name.</p> <p>For example, in the <a href=\"../app/api-reference/functions\">functions API Reference</a>, the pages are sorted alphabetically because it makes it easier for developers to find a specific function:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">03-functions\n cookies.mdx\n draft-mode.mdx\n fetch.mdx\n ...</pre>\n</div> <p>But, in the <a href=\"../app/building-your-application/routing\">routing section</a>, the files are prefixed with a two-digit number, sorted in the order developers should learn these concepts:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">02-routing\n 01-defining-routes.mdx\n 02-pages-and-layouts.mdx\n 03-linking-and-navigating.mdx\n ...</pre>\n</div> <p>To quickly find a page, you can use <code> + P</code> (Mac) or <code>Ctrl + P</code> (Windows) to open the search bar on VSCode. Then, type the slug of the page you're looking for. E.g. <code>defining-routes</code></p> <blockquote class=\"p-3 text-sm\"> <p><strong>Why not use a manifest?</strong></p> <p>We considered using a manifest file (another popular way to generate the docs navigation), but we found that a manifest would quickly get out of sync with the files. File-system routing forces us to think about the structure of the docs and feels more native to Next.js.</p> </blockquote> <h2 id=\"metadata\" data-docs-heading=\"\">Metadata     </h2> <p>Each page has a metadata block at the top of the file separated by three dashes.</p> <h3 id=\"required-fields\" data-docs-heading=\"\">Required Fields     </h3> <p>The following fields are <strong>required</strong>:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Field</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>title</code></td>\n<td>The page's <code>&lt;h1&gt;</code> title, used for SEO and OG Images.</td>\n</tr>\n<tr>\n<td><code>description</code></td>\n<td>The page's description, used in the <code>&lt;meta name=\"description\"&gt;</code> tag for SEO.</td>\n</tr>\n</tbody>\n</table></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">---\ntitle: Page Title\ndescription: Page Description\n---</pre></div> <p>It's good practice to limit the page title to 2-3 words (e.g. Optimizing Images) and the description to 1-2 sentences (e.g. Learn how to optimize images in Next.js).</p> <h3 id=\"optional-fields\" data-docs-heading=\"\">Optional Fields     </h3> <p>The following fields are <strong>optional</strong>:</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Field</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>nav_title</code></td>\n<td>Overrides the page's title in the navigation. This is useful when the page's title is too long to fit. If not provided, the <code>title</code> field is used.</td>\n</tr>\n<tr>\n<td><code>source</code></td>\n<td>Pulls content into a shared page. See <a href=\"#shared-pages\">Shared Pages</a>.</td>\n</tr>\n<tr>\n<td><code>related</code></td>\n<td>A list of related pages at the bottom of the document. These will automatically be turned into cards. See <a href=\"#related-links\">Related Links</a>.</td>\n</tr>\n</tbody>\n</table></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">---\nnav_title: Nav Item Title\nsource: app/building-your-application/optimizing/images\nrelated:\n  description: See the image component API reference.\n  links:\n    - app/api-reference/components/image\n---</pre></div> <h2 id=\"app-and-pages-docs\" data-docs-heading=\"\">App and Pages Docs     </h2> <p>Since most of the features in the <strong>App Router</strong> and <strong>Pages Router</strong> are completely different, their docs for each are kept in separate sections (<code>02-app</code> and <code>03-pages</code>). However, there are a few features that are shared between them.</p> <h3 id=\"shared-pages\" data-docs-heading=\"\">Shared Pages     </h3> <p>To avoid content duplication and risk the content becoming out of sync, we use the <code>source</code> field to pull content from one page into another. For example, the <code>&lt;Link&gt;</code> component behaves <em>mostly</em> the same in <strong>App</strong> and <strong>Pages</strong>. Instead of duplicating the content, we can pull the content from <code>app/.../link.mdx</code> into <code>pages/.../link.mdx</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">---\ntitle: &lt;Link&gt;\ndescription: API reference for the &lt;Link&gt; component.\n---\n \nThis API reference will help you understand how to use the props\nand configuration options available for the Link Component.</pre></div> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">---\ntitle: &lt;Link&gt;\ndescription: API reference for the &lt;Link&gt; component.\nsource: app/api-reference/components/link\n---\n \n{/* DO NOT EDIT THIS PAGE. */}\n{/* The content of this page is pulled from the source above. */}</pre></div> <p>We can therefore edit the content in one place and have it reflected in both sections.</p> <h3 id=\"shared-content\" data-docs-heading=\"\">Shared Content     </h3> <p>In shared pages, sometimes there might be content that is <strong>App Router</strong> or <strong>Pages Router</strong> specific. For example, the <code>&lt;Link&gt;</code> component has a <code>shallow</code> prop that is only available in <strong>Pages</strong> but not in <strong>App</strong>.</p> <p>To make sure the content only shows in the correct router, we can wrap content blocks in an <code>&lt;AppOnly&gt;</code> or <code>&lt;PagesOnly&gt;</code> components:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">This content is shared between App and Pages.\n \n&lt;PagesOnly&gt;\n \nThis content will only be shown on the Pages docs.\n \n&lt;/PagesOnly&gt;\n \nThis content is shared between App and Pages.</pre></div> <p>You'll likely use these components for examples and code blocks.</p> <h2 id=\"code-blocks\" data-docs-heading=\"\">Code Blocks     </h2> <p>Code blocks should contain a minimum working example that can be copied and pasted. This means that the code should be able to run without any additional configuration.</p> <p>For example, if you're showing how to use the <code>&lt;Link&gt;</code> component, you should include the <code>import</code> statement and the <code>&lt;Link&gt;</code> component itself.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n}</pre></div> <p>Always run examples locally before committing them. This will ensure that the code is up-to-date and working.</p> <h3 id=\"language-and-filename\" data-docs-heading=\"\">Language and Filename     </h3> <p>Code blocks should have a header that includes the language and the <code>filename</code>. Add a <code>filename</code> prop to render a special Terminal icon that helps orientate users where to input the command. For example:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">```bash filename=\"Terminal\"\nnpx create-next-app\n```</pre></div> <p>Most examples in the docs are written in <code>tsx</code> and <code>jsx</code>, and a few in <code>bash</code>. However, you can use any supported language, here's the <a href=\"https://github.com/shikijs/shiki/blob/main/docs/languages.md#all-languages\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">full list</a>.</p> <p>When writing JavaScript code blocks, we use the following language and extension combinations.</p> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th></th>\n<th>Language</th>\n<th>Extension</th>\n</tr></thead>\n<tbody>\n<tr>\n<td>JavaScript files with JSX code</td>\n<td>```jsx</td>\n<td>.js</td>\n</tr>\n<tr>\n<td>JavaScript files without JSX</td>\n<td>```js</td>\n<td>.js</td>\n</tr>\n<tr>\n<td>TypeScript files with JSX</td>\n<td>```tsx</td>\n<td>.tsx</td>\n</tr>\n<tr>\n<td>TypeScript files without JSX</td>\n<td>```ts</td>\n<td>.ts</td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"ts-and-js-switcher\" data-docs-heading=\"\">TS and JS Switcher     </h3> <p>Add a language switcher to toggle between TypeScript and JavaScript. Code blocks should be TypeScript first with a JavaScript version to accommodate users.</p> <p>Currently, we write TS and JS examples one after the other, and link them with <code>switcher</code> prop:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">```tsx filename=\"app/page.tsx\" switcher\n \n```\n \n```jsx filename=\"app/page.js\" switcher\n \n```</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: We plan to automatically compile TypeScript snippets to JavaScript in the future. In the meantime, you can use <a href=\"https://transform.tools/typescript-to-javascript\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">transform.tools</a>.</p> </blockquote> <h3 id=\"line-highlighting\" data-docs-heading=\"\">Line Highlighting     </h3> <p>Code lines can be highlighted. This is useful when you want to draw attention to a specific part of the code. You can highlight lines by passing a number to the <code>highlight</code> prop.</p> <p><strong>Single Line:</strong> <code>highlight={1}</code></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n}</pre></div> <p><strong>Multiple Lines:</strong> <code>highlight={1,3}</code></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n}</pre></div> <p><strong>Range of Lines:</strong> <code>highlight={1-5}</code></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nexport default function Page() {\n  return &lt;Link href=\"/about\"&gt;About&lt;/Link&gt;\n}</pre></div> <h2 id=\"icons\" data-docs-heading=\"\">Icons     </h2> <p>The following icons are available for use in the docs:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;Check size={18} /&gt;\n&lt;Cross size={18} /&gt;</pre></div> <p><strong>Output:</strong></p>   <p>We do not use emojis in the docs.</p> <h2 id=\"notes\" data-docs-heading=\"\">Notes     </h2> <p>For information that is important but not critical, use notes. Notes are a good way to add information without distracting the user from the main content.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&gt; **Good to know**: This is a single line note.\n \n&gt; **Good to know**:\n&gt;\n&gt; - We also use this format for multi-line notes.\n&gt; - There are sometimes multiple items worth knowing or keeping in mind.</pre></div> <p><strong>Output:</strong></p> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: This is a single line note.</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>:</p> <ul> <li>We also use this format for multi-line notes.</li> <li>There are sometimes multiple item worths knowing or keeping in mind.</li> </ul> </blockquote> <h2 id=\"related-links\" data-docs-heading=\"\">Related Links     </h2> <p>Related Links guide the user's learning journey by adding links to logical next steps.</p> <ul> <li>Links will be displayed in cards under the main content of the page.</li> <li>Links will be automatically generated for pages that have child pages. For example, the <a href=\"../app/building-your-application/optimizing\">Optimizing</a> section has links to all of its child pages.</li> </ul> <p>Create related links using the <code>related</code> field in the page's metadata.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">---\nrelated:\n  description: Learn how to quickly get started with your first application.\n  links:\n    - app/building-your-application/routing/defining-routes\n    - app/building-your-application/data-fetching\n    - app/api-reference/file-conventions/page\n---</pre></div> <h3 id=\"nested-fields\" data-docs-heading=\"\">Nested Fields     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Field</th>\n<th>Required?</th>\n<th>Description</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>title</code></td>\n<td>Optional</td>\n<td>The title of the card list. Defaults to <strong>Next Steps</strong>.</td>\n</tr>\n<tr>\n<td><code>description</code></td>\n<td>Optional</td>\n<td>The description of the card list.</td>\n</tr>\n<tr>\n<td><code>links</code></td>\n<td>Required</td>\n<td>A list of links to other doc pages. Each list item should be a relative URL path (without a leading slash) e.g. <code>app/api-reference/file-conventions/page</code>\n</td>\n</tr>\n</tbody>\n</table></div> <h2 id=\"diagrams\" data-docs-heading=\"\">Diagrams     </h2> <p>Diagrams are a great way to explain complex concepts. We use <a href=\"https://www.figma.com/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Figma</a> to create diagrams, following Vercel's design guide.</p> <p>The diagrams currently live in the <code>/public</code> folder in our private Next.js site. If you'd like to update or add a diagram, please open a <a href=\"https://github.com/vercel/next.js/issues/new?assignees=&amp;labels=template%3A+documentation&amp;projects=&amp;template=4.docs_request.yml&amp;title=Docs%3A+\" rel=\"noopener noreferrer\" target=\"_blank\">GitHub issue</a> with your ideas.</p> <h2 id=\"custom-components-and-html\" data-docs-heading=\"\">Custom Components and HTML     </h2> <p>These are the React Components available for the docs: <code>&lt;Image /&gt;</code> (next/image), <code>&lt;PagesOnly /&gt;</code>, <code>&lt;AppOnly /&gt;</code>, <code>&lt;Cross /&gt;</code>, and <code>&lt;Check /&gt;</code>. We do not allow raw HTML in the docs besides the <code>&lt;details&gt;</code> tag.</p> <p>If you have ideas for new components, please open a <a href=\"https://github.com/vercel/next.js/issues/new/choose\" rel=\"noopener noreferrer\" target=\"_blank\">GitHub issue</a>.</p> <h2 id=\"style-guide\" data-docs-heading=\"\">Style Guide     </h2> <p>This section contains guidelines for writing docs for those who are new to technical writing.</p> <h3 id=\"page-templates\" data-docs-heading=\"\">Page Templates     </h3> <p>While we don't have a strict template for pages, there are page sections you'll see repeated across the docs:</p> <ul> <li>\n<strong>Overview:</strong> The first paragraph of a page should tell the user what the feature is and what it's used for. Followed by a minimum working example or its API reference.</li> <li>\n<strong>Convention:</strong> If the feature has a convention, it should be explained here.</li> <li>\n<strong>Examples</strong>: Show how the feature can be used with different use cases.</li> <li>\n<strong>API Tables</strong>: API Pages should have an overview table at the of the page with jump-to-section links (when possible).</li> <li>\n<strong>Next Steps (Related Links)</strong>: Add links to related pages to guide the user's learning journey.</li> </ul> <p>Feel free to add these sections as needed.</p> <h3 id=\"page-types\" data-docs-heading=\"\">Page Types     </h3> <p>Docs pages are also split into two categories: Conceptual and Reference.</p> <ul> <li>\n<strong>Conceptual</strong> pages are used to explain a concept or feature. They are usually longer and contain more information than reference pages. In the Next.js docs, conceptual pages are found in the <strong>Building Your Application</strong> section.</li> <li>\n<strong>Reference</strong> pages are used to explain a specific API. They are usually shorter and more focused. In the Next.js docs, reference pages are found in the <strong>API Reference</strong> section.</li> </ul> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know</strong>: Depending on the page you're contributing to, you may need to follow a different voice and style. For example, conceptual pages are more instructional and use the word <em>you</em> to address the user. Reference pages are more technical, they use more imperative words like \"create, update, accept\" and tend to omit the word <em>you</em>.</p> </blockquote> <h3 id=\"voice\" data-docs-heading=\"\">Voice     </h3> <p>Here are some guidelines to maintain a consistent style and voice across the docs:</p> <ul> <li>Write clear, concise sentences. Avoid tangents. <ul> <li>If you find yourself using a lot of commas, consider breaking the sentence into multiple sentences or use a list.</li> <li>Swap out complex words for simpler ones. For example, <em>use</em> instead of <em>utilize</em>.</li> </ul> </li> <li>Be mindful with the word <em>this</em>. It can be ambiguous and confusing, don't be afraid to repeat the subject of the sentence if unclear. <ul> <li>For example, <em>Next.js uses React</em> instead of <em>Next.js uses this</em>.</li> </ul> </li> <li>Use an active voice instead of passive. An active sentence is easier to read. <ul> <li>For example, <em>Next.js uses React</em> instead of <em>React is used by Next.js</em>. If you find yourself using words like <em>was</em> and <em>by</em> you may be using a passive voice.</li> </ul> </li> <li>Avoid using words like <em>easy</em>, <em>quick</em>, <em>simple</em>, <em>just</em>, etc. This is subjective and can be discouraging to users.</li> <li>Avoid negative words like <em>don't</em>, <em>can't</em>, <em>won't</em>, etc. This can be discouraging to readers. <ul> <li>For example, <em>\"You can use the <code>Link</code> component to create links between pages\"</em> instead of <em>\"Don't use the <code>&lt;a&gt;</code> tag to create links between pages\"</em>.</li> </ul> </li> <li>Write in second person (you/your). This is more personal and engaging.</li> <li>Use gender-neutral language. Use <em>developers</em>, <em>users</em>, or <em>readers</em>, when referring to the audience.</li> <li>If adding code examples, ensure they are properly formatted and working.</li> </ul> <p>While these guidelines are not exhaustive, they should help you get started. If you'd like to dive deeper into technical writing, check out the <a href=\"https://developers.google.com/tech-writing/overview\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Technical Writing Course</a>.</p> <hr> <p>Thank you for contributing to the docs and being part of the Next.js community!</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/community/contribution-guide\" class=\"_attribution-link\">https://nextjs.org/docs/community/contribution-guide</a>\n  </p>\n</div>\n","app":"<h1 class=\"break-words\">App Router</h1>\n<p>The Next.js App Router introduces a new model for building applications using React's latest features such as <a href=\"app/building-your-application/rendering/server-components\">Server Components</a>, <a href=\"app/building-your-application/routing/loading-ui-and-streaming#streaming-with-suspense\">Streaming with Suspense</a>, and <a href=\"app/building-your-application/data-fetching/server-actions-and-mutations\">Server Actions</a>.</p> <p>Get started with the App Router by <a href=\"app/building-your-application/routing/pages-and-layouts\">creating your first page</a>.</p> <h2 id=\"frequently-asked-questions\" data-docs-heading=\"\">Frequently Asked Questions     </h2> <h3 id=\"how-can-i-access-the-request-object-in-a-layout\" data-docs-heading=\"\">How can I access the request object in a layout?     </h3> <p>You intentionally cannot access the raw request object. However, you can access <a href=\"app/api-reference/functions/headers\"><code>headers</code></a> and <a href=\"app/api-reference/functions/cookies\"><code>cookies</code></a> through server-only functions. You can also <a href=\"#how-can-i-set-cookies\">set cookies</a>.</p> <p><a href=\"app/building-your-application/routing/pages-and-layouts#layouts\">Layouts</a> do not rerender. They can be cached and reused to avoid unnecessary computation when navigating between pages. By restricting layouts from accessing the raw request, Next.js can prevent the execution of potentially slow or expensive user code within the layout, which could negatively impact performance.</p> <p>This design also enforces consistent and predictable behavior for layouts across different pages, which simplifies development and debugging.</p> <p>Depending on the UI pattern you're building, <a href=\"app/building-your-application/routing/parallel-routes\">Parallel Routes</a> allow you to render multiple pages in the same layout, and pages have access to the route segments as well as the URL search params.</p> <h3 id=\"how-can-i-access-the-url-on-a-page\" data-docs-heading=\"\">How can I access the URL on a page?     </h3> <p>By default, pages are Server Components. You can access the route segments through the <a href=\"app/api-reference/file-conventions/page#params-optional\"><code>params</code></a> prop and the URL search params through the <a href=\"app/api-reference/file-conventions/page#searchparams-optional\"><code>searchParams</code></a> prop for a given page.</p> <p>If you are using Client Components, you can use <a href=\"app/api-reference/functions/use-pathname\"><code>usePathname</code></a>, <a href=\"app/api-reference/functions/use-selected-layout-segment\"><code>useSelectedLayoutSegment</code></a>, and <a href=\"app/api-reference/functions/use-selected-layout-segments\"><code>useSelectedLayoutSegments</code></a> for more complex routes.</p> <p>Further, depending on the UI pattern you're building, <a href=\"app/building-your-application/routing/parallel-routes\">Parallel Routes</a> allow you to render multiple pages in the same layout, and pages have access to the route segments as well as the URL search params.</p> <h3 id=\"how-can-i-redirect-from-a-server-component\" data-docs-heading=\"\">How can I redirect from a Server Component?     </h3> <p>You can use <a href=\"app/api-reference/functions/redirect\"><code>redirect</code></a> to redirect from a page to a relative or absolute URL. <a href=\"app/api-reference/functions/redirect\"><code>redirect</code></a> is a temporary (307) redirect, while <a href=\"app/api-reference/functions/permanentredirect\"><code>permanentRedirect</code></a> is a permanent (308) redirect. When these functions are used while streaming UI, they will insert a meta tag to emit the redirect on the client side.</p> <h3 id=\"how-can-i-handle-authentication-with-the-app-router\" data-docs-heading=\"\">How can I handle authentication with the App Router?     </h3> <p>Here are some common authentication solutions that support the App Router:</p> <ul> <li><a href=\"https://next-auth.js.org/configuration/nextjs#in-app-router\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">NextAuth.js</a></li> <li><a href=\"https://clerk.com/docs/quickstarts/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Clerk</a></li> <li><a href=\"https://lucia-auth.com/getting-started/nextjs-app\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Lucia</a></li> <li><a href=\"https://github.com/auth0/nextjs-auth0#app-router\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Auth0</a></li> <li><a href=\"https://stytch.com/docs/example-apps/frontend/nextjs\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Stytch</a></li> <li><a href=\"https://kinde.com/docs/developer-tools/nextjs-sdk/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Kinde</a></li> <li>Or manually handling sessions or JWTs</li> </ul> <h3 id=\"how-can-i-set-cookies\" data-docs-heading=\"\">How can I set cookies?     </h3> <p>You can set cookies in <a href=\"app/building-your-application/data-fetching/server-actions-and-mutations#cookies\">Server Actions</a> or <a href=\"app/building-your-application/routing/route-handlers\">Route Handlers</a> using the <a href=\"app/api-reference/functions/cookies\"><code>cookies</code></a> function.</p> <p>Since HTTP does not allow setting cookies after streaming starts, you cannot set cookies from a page or layout directly. You can also set cookies from <a href=\"app/building-your-application/routing/middleware#using-cookies\">Middleware</a>.</p> <h3 id=\"how-can-i-build-multi-tenant-apps\" data-docs-heading=\"\">How can I build multi-tenant apps?     </h3> <p>If you are looking to build a single Next.js application that serves multiple tenants, we have <a href=\"https://vercel.com/templates/next.js/platforms-starter-kit\" rel=\"noopener noreferrer\" target=\"_blank\">built an example</a> showing our recommended architecture.</p> <h3 id=\"how-can-i-invalidate-the-app-router-cache\" data-docs-heading=\"\">How can I invalidate the App Router cache?     </h3> <p>There are multiple layers of caching in Next.js, and thus, multiple ways to invalidate different parts of the cache. <a href=\"app/building-your-application/caching\">Learn more about caching</a>.</p> <h3 id=\"are-there-any-comprehensive-open-source-applications-built-on-the-app-router\" data-docs-heading=\"\">Are there any comprehensive, open-source applications built on the App Router?     </h3> <p>Yes. You can view <a href=\"https://vercel.com/templates/next.js/nextjs-commerce\" rel=\"noopener noreferrer\" target=\"_blank\">Next.js Commerce</a> or the <a href=\"https://vercel.com/templates/next.js/platforms-starter-kit\" rel=\"noopener noreferrer\" target=\"_blank\">Platforms Starter Kit</a> for two larger examples of using the App Router that are open-source.</p> <h2 id=\"learn-more\" data-docs-heading=\"\">Learn More     </h2> <ul> <li><a href=\"app/building-your-application/routing\">Routing Fundamentals</a></li> <li><a href=\"app/building-your-application/data-fetching/fetching-caching-and-revalidating\">Data Fetching, Caching, and Revalidating</a></li> <li><a href=\"app/building-your-application/data-fetching/server-actions-and-mutations\">Forms and Mutations</a></li> <li><a href=\"app/building-your-application/caching\">Caching</a></li> <li><a href=\"app/building-your-application/rendering\">Rendering Fundamentals</a></li> <li><a href=\"app/building-your-application/rendering/server-components\">Server Components</a></li> <li><a href=\"app/building-your-application/rendering/client-components\">Client Components</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/app\" class=\"_attribution-link\">https://nextjs.org/docs/app</a>\n  </p>\n</div>\n","messages/google-font-display":"<h1>Google Font Display</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Enforce font-display behavior with Google Fonts.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>For a Google Font, the font-display descriptor was either missing or set to <code>auto</code>, <code>block</code>, or <code>fallback</code>, which are not recommended.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>For most cases, the best font display strategy for custom fonts is <code>optional</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Head from 'next/head'\n \nexport default function IndexPage() {\n  return (\n    &lt;div&gt;\n      &lt;Head&gt;\n        &lt;link\n          href=\"https://fonts.googleapis.com/css2?family=Krona+One&amp;display=optional\"\n          rel=\"stylesheet\"\n        /&gt;\n      &lt;/Head&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p>Specifying <code>display=optional</code> minimizes the risk of invisible text or layout shift. If swapping to the custom font after it has loaded is important to you, then use <code>display=swap</code> instead.</p> <h3 id=\"when-not-to-use-it\" data-docs-heading=\"\">When Not To Use It     </h3> <p>If you want to specifically display a font using an <code>auto</code>, <code>block</code>, or <code>fallback</code> strategy, then you can disable this rule.</p> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"https://developer.chrome.com/blog/font-display/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Controlling Font Performance with font-display</a></li> <li><a href=\"https://developers.google.com/fonts/docs/css2#use_font-display\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Fonts API Docs</a></li> <li><a href=\"https://www.w3.org/TR/css-fonts-4/#font-display-desc\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">CSS <code>font-display</code> property</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/google-font-display\" class=\"_attribution-link\">https://nextjs.org/docs/messages/google-font-display</a>\n  </p>\n</div>\n","messages/inline-script-id":"<h1>Inline script id</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Enforce <code>id</code> attribute on <code>next/script</code> components with inline content.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p><code>next/script</code> components with inline content require an <code>id</code> attribute to be defined to track and optimize the script.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Add an <code>id</code> attribute to the <code>next/script</code> component.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function App({ Component, pageProps }) {\n  return (\n    &lt;&gt;\n      &lt;Script id=\"my-script\"&gt;{`console.log('Hello world!');`}&lt;/Script&gt;\n      &lt;Component {...pageProps} /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful links     </h2> <ul> <li><a href=\"../pages/building-your-application/optimizing/scripts\">Docs for Next.js Script component</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/inline-script-id\" class=\"_attribution-link\">https://nextjs.org/docs/messages/inline-script-id</a>\n  </p>\n</div>\n","messages/next-script-for-ga":"<h1>Using Google Analytics with Next.js (through `next/script`)</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prefer <code>next/script</code> component when using the inline script for Google Analytics.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>An inline script was used for Google Analytics which might impact your webpage's performance. Instead, we recommend using <code>next/script</code> through the <code>@next/third-parties</code> library.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <h4 id=\"use-nextthird-parties-to-add-google-analytics\" data-docs-heading=\"\">Use @next/third-parties to add Google Analytics     </h4> <p><strong><code>@next/third-parties</code></strong> is a library that provides a collection of components and utilities that improve the performance and developer experience of loading popular third-party libraries in your Next.js application. It is available with Next.js 14 (install <code>next@latest</code>).</p> <p>The <code>GoogleAnalytics</code> component can be used to include <a href=\"https://developers.google.com/analytics/devguides/collection/ga4\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Google Analytics 4</a> to your page via the Google tag (<code>gtag.js</code>). By default, it fetches the original scripts after hydration occurs on the page.</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Recommendation</strong>: If Google Tag Manager is already included in your application, you can configure Google Analytics directly using it, rather than including Google Analytics as a separate component. Refer to the <a href=\"https://developers.google.com/analytics/devguides/collection/ga4/tag-options#what-is-gtm\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">documentation</a> to learn more about the differences between Tag Manager and <code>gtag.js</code>.</p> </blockquote> <p>To load Google Analytics for all routes, include the component directly in your root layout and pass in your measurement ID:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleAnalytics } from '@next/third-parties/google'\n \nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n      &lt;GoogleAnalytics gaId=\"G-XYZ\" /&gt;\n    &lt;/html&gt;\n  )\n}</pre></div>  <p>To load Google Analytics for a single route, include the component in your page file:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { GoogleAnalytics } from '@next/third-parties/google'\n \nexport default function Page() {\n  return &lt;GoogleAnalytics gaId=\"G-XYZ\" /&gt;\n}</pre></div> <blockquote class=\"p-3 text-sm\"> <p><strong>Good to know:</strong></p> <ul> <li>If you are using the Pages Router, please refer to the <a href=\"../pages/building-your-application/optimizing/third-party-libraries\"><code>pages/</code> documentation</a>.</li> <li>\n<code>@next/third-parties</code> also supports <a href=\"../app/building-your-application/optimizing/third-party-libraries#google-tag-manager\">Google Tag Manager</a> and other third parties.</li> <li>Using <code>@next/third-parties</code> is not required. You can also use the <code>next/script</code> component directly. Refer to the <a href=\"../app/building-your-application/optimizing/scripts\"><code>next/script</code> documentation</a> to learn more.</li> </ul> </blockquote> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../app/building-your-application/optimizing/third-party-libraries\"><code>@next/third-parties</code> Documentation</a></li> <li><a href=\"../app/building-your-application/optimizing/scripts\"><code>next/script</code> Documentation</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/next-script-for-ga\" class=\"_attribution-link\">https://nextjs.org/docs/messages/next-script-for-ga</a>\n  </p>\n</div>\n","pages":"<h1 class=\"break-words\">Pages Router</h1>\n<p>Before Next.js 13, the Pages Router was the main way to create routes in Next.js. It used an intuitive file-system router to map each file to a route. The Pages Router is still supported in newer versions of Next.js, but we recommend migrating to the new <a href=\"app\">App Router</a> to leverage React's latest features.</p> <p>Use this section of the documentation for existing applications that use the Pages Router.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/pages\" class=\"_attribution-link\">https://nextjs.org/docs/pages</a>\n  </p>\n</div>\n","messages/google-font-preconnect":"<h1>Google Font Preconnect</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Next.js automatically adds <code>&lt;link rel=\"preconnect\" /&gt;</code> after version <code>12.0.1</code>.</p> </blockquote> <blockquote class=\"p-3 text-sm\"> <p>Ensure <code>preconnect</code> is used with Google Fonts.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>A preconnect resource hint was not used with a request to the Google Fonts domain. Adding <code>preconnect</code> is recommended to initiate an early connection to the origin.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Add <code>rel=\"preconnect\"</code> to the Google Font domain <code>&lt;link&gt;</code> tag:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" /&gt;</pre></div> <p>Note: a <strong>separate</strong> link with <code>dns-prefetch</code> can be used as a fallback for browsers that don't support <code>preconnect</code> although this is not required.</p> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"https://web.dev/uses-rel-preconnect/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Preconnect to required origins</a></li> <li><a href=\"https://web.dev/preconnect-and-dns-prefetch/#resolve-domain-name-early-with-reldns-prefetch\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Preconnect and dns-prefetch</a></li> <li><a href=\"../pages/building-your-application/optimizing/fonts\">Next.js Font Optimization</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/google-font-preconnect\" class=\"_attribution-link\">https://nextjs.org/docs/messages/google-font-preconnect</a>\n  </p>\n</div>\n","messages/no-assign-module-variable":"<h1>No assign module variable</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent assignment to the <code>module</code> variable.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>A value is being assigned to the <code>module</code> variable. The <code>module</code> variable is already used and it is highly likely that assigning to this variable will cause errors.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Use a different variable name:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">let myModule = {...}</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-assign-module-variable\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-assign-module-variable</a>\n  </p>\n</div>\n","messages/no-async-client-component":"<h1>No async client component</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Client components cannot be async functions.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>As per the <a href=\"https://github.com/acdlite/rfcs/blob/first-class-promises/text/0000-first-class-support-for-promises.md\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">React Server Component RFC on promise support</a>, <a href=\"https://github.com/acdlite/rfcs/blob/first-class-promises/text/0000-first-class-support-for-promises.md#why-cant-client-components-be-async-functions\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">client components cannot be async functions</a>.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <ol> <li>Remove the <code>async</code> keyword from the client component function declaration, or</li> <li>Convert the client component to a server component</li> </ol><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-async-client-component\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-async-client-component</a>\n  </p>\n</div>\n","messages/no-before-interactive-script-outside-document":"<h1>No Before Interactive Script Outside Document</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent usage of <code>next/script</code>'s <code>beforeInteractive</code> strategy outside of <code>app/layout.jsx</code> or <code>pages/_document.js</code>.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>You cannot use the <code>next/script</code> component with the <code>beforeInteractive</code> strategy outside <code>app/layout.jsx</code> or <code>pages/_document.js</code>. That's because <code>beforeInteractive</code> strategy only works inside <strong><code>app/layout.jsx</code></strong> or <strong><code>pages/_document.js</code></strong> and is designed to load scripts that are needed by the entire site (i.e. the script will load when any page in the application has been loaded server-side).</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <h3 id=\"app-router\" data-docs-heading=\"\">App Router     </h3> <p>If you want a global script, and you are using the App Router, move the script inside <code>app/layout.jsx</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nexport default function RootLayout({ children }) {\n  return (\n    &lt;html lang=\"en\"&gt;\n      &lt;body&gt;{children}&lt;/body&gt;\n      &lt;Script\n        src=\"https://example.com/script.js\"\n        strategy=\"beforeInteractive\"\n      /&gt;\n    &lt;/html&gt;\n  )\n}</pre></div> <h3 id=\"pages-router\" data-docs-heading=\"\">Pages Router     </h3> <p>If you want a global script, and you are using the Pages Router, move the script inside <code>pages/_document.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Html, Head, Main, NextScript } from 'next/document'\nimport Script from 'next/script'\n \nexport default function Document() {\n  return (\n    &lt;Html&gt;\n      &lt;Head /&gt;\n      &lt;body&gt;\n        &lt;Main /&gt;\n        &lt;NextScript /&gt;\n        &lt;Script\n          src=\"https://example.com/script.js\"\n          strategy=\"beforeInteractive\"\n        &gt;&lt;/Script&gt;\n      &lt;/body&gt;\n    &lt;/Html&gt;\n  )\n}</pre></div> <ul> <li><a href=\"../app/building-your-application/optimizing/scripts\">App Router Script Optimization</a></li> <li><a href=\"../pages/building-your-application/optimizing/scripts\">Pages Router Script Optimization</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-before-interactive-script-outside-document\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-before-interactive-script-outside-document</a>\n  </p>\n</div>\n","messages/no-page-custom-font":"<h1>No Page Custom Font</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent page-only custom fonts.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <ul> <li>The custom font you're adding was added to a page - this only adds the font to the specific page and not the entire application.</li> <li>The custom font you're adding was added to a separate component within <code>pages/_document.js</code> - this disables automatic font optimization.</li> </ul> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Create the file <code>./pages/_document.js</code> and add the font to a custom Document:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Document, { Html, Head, Main, NextScript } from 'next/document'\n \nclass MyDocument extends Document {\n  render() {\n    return (\n      &lt;Html&gt;\n        &lt;Head&gt;\n          &lt;link\n            href=\"https://fonts.googleapis.com/css2?family=Inter&amp;display=optional\"\n            rel=\"stylesheet\"\n          /&gt;\n        &lt;/Head&gt;\n        &lt;body&gt;\n          &lt;Main /&gt;\n          &lt;NextScript /&gt;\n        &lt;/body&gt;\n      &lt;/Html&gt;\n    )\n  }\n}\n \nexport default MyDocument</pre></div> <p>Or as a function component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { Html, Head, Main, NextScript } from 'next/document'\n \nexport default function Document() {\n  return (\n    &lt;Html&gt;\n      &lt;Head&gt;\n        &lt;link\n          href=\"https://fonts.googleapis.com/css2?family=Inter&amp;display=optional\"\n          rel=\"stylesheet\"\n        /&gt;\n      &lt;/Head&gt;\n      &lt;body&gt;\n        &lt;Main /&gt;\n        &lt;NextScript /&gt;\n      &lt;/body&gt;\n    &lt;/Html&gt;\n  )\n}</pre></div> <h3 id=\"when-not-to-use-it\" data-docs-heading=\"\">When Not To Use It     </h3> <p>If you have a reason to only load a font for a particular page or don't care about font optimization, then you can disable this rule.</p> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/building-your-application/routing/custom-document\">Custom Document</a></li> <li><a href=\"../pages/building-your-application/optimizing/fonts\">Font Optimization</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-page-custom-font\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-page-custom-font</a>\n  </p>\n</div>\n","messages/no-css-tags":"<h1>No CSS Tags</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent manual stylesheet tags.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>A <code>link</code> element was used to link to an external stylesheet. This can negatively affect CSS resource loading on your webpage.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>There are multiple ways to include styles using Next.js' built-in CSS support, including the option to use <code>@import</code> within the root stylesheet that is imported in <code>pages/_app.js</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">/* Root stylesheet */\n@import 'extra.css';\n \nbody {\n  /* ... */\n}</pre></div> <p>Another option is to use CSS Modules to import the CSS file scoped specifically to the component.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import styles from './extra.module.css'\n \nexport class Home {\n  render() {\n    return (\n      &lt;div&gt;\n        &lt;button type=\"button\" className={styles.active}&gt;\n          Open\n        &lt;/button&gt;\n      &lt;/div&gt;\n    )\n  }\n}</pre></div> <p>Refer to the <a href=\"../pages/building-your-application/styling\">Built-In CSS Support</a> documentation to learn about all the ways to include CSS to your application.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-css-tags\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-css-tags</a>\n  </p>\n</div>\n","messages/no-duplicate-head":"<h1>No Duplicate Head</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent duplicate usage of <code>&lt;Head&gt;</code> in <code>pages/_document.js</code>.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>More than a single instance of the <code>&lt;Head /&gt;</code> component was used in a single custom document. This can cause unexpected behavior in your application.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Only use a single <code>&lt;Head /&gt;</code> component in your custom document in <code>pages/_document.js</code>.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Document, { Html, Head, Main, NextScript } from 'next/document'\n \nclass MyDocument extends Document {\n  static async getInitialProps(ctx) {\n    //...\n  }\n \n  render() {\n    return (\n      &lt;Html&gt;\n        &lt;Head /&gt;\n        &lt;body&gt;\n          &lt;Main /&gt;\n          &lt;NextScript /&gt;\n        &lt;/body&gt;\n      &lt;/Html&gt;\n    )\n  }\n}\n \nexport default MyDocument</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/building-your-application/routing/custom-document\">Custom Document</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-duplicate-head\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-duplicate-head</a>\n  </p>\n</div>\n","messages/no-head-element":"<h1>No Head Element</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent usage of <code>&lt;head&gt;</code> element.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>A <code>&lt;head&gt;</code> element was used to include page-level metadata, but this can cause unexpected behavior in a Next.js application. Use Next.js' built-in <code>next/head</code> component instead.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Import and use the <code>&lt;Head /&gt;</code> component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Head from 'next/head'\n \nfunction Index() {\n  return (\n    &lt;&gt;\n      &lt;Head&gt;\n        &lt;title&gt;My page title&lt;/title&gt;\n        &lt;meta name=\"viewport\" content=\"initial-scale=1.0, width=device-width\" /&gt;\n      &lt;/Head&gt;\n    &lt;/&gt;\n  )\n}\n \nexport default Index</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/api-reference/components/head\">next/head</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-head-element\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-head-element</a>\n  </p>\n</div>\n","messages/no-unwanted-polyfillio":"<h1>No Unwanted Polyfill.io</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent duplicate polyfills from Polyfill.io.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>You are using polyfills from Polyfill.io and including polyfills already shipped with Next.js. This unnecessarily increases page weight which can affect loading performance.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Remove all duplicate polyfills. If you need to add polyfills but are not sure if Next.js already includes it, take a look at the list of <a href=\"../architecture/supported-browsers\">supported browsers and features</a>.</p> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../architecture/supported-browsers\">Supported Browsers and Features</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-unwanted-polyfillio\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-unwanted-polyfillio</a>\n  </p>\n</div>\n","messages/url-deprecated":"<h1>`url` is deprecated</h1>\n<h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>In versions prior to 6.x the <code>url</code> property got magically injected into every <code>Page</code> component (every page inside the <code>pages</code> directory).</p> <p>The reason this is going away is that we want to make things very predictable and explicit. Having a magical url property coming out of nowhere doesn't aid that goal.</p> <blockquote class=\"p-3 text-sm\"> <p> In some cases using React Dev Tools may trigger this warning even if you do not reference <code>url</code> anywhere in your code. Try temporarily disabling the extension and see if the warning persists.</p> </blockquote> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>/docs/advanced-features/codemods#url-to-withrouter</p> <p>Since Next 5 we provide a way to explicitly inject the Next.js router object into pages and all their descending components. The <code>router</code> property that is injected will hold the same values as <code>url</code>, like <code>pathname</code>, <code>asPath</code>, and <code>query</code>.</p> <p>Here's an example of using <code>withRouter</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { withRouter } from 'next/router'\n \nclass Page extends React.Component {\n  render() {\n    const { router } = this.props\n    console.log(router)\n    return &lt;div&gt;{router.pathname}&lt;/div&gt;\n  }\n}\n \nexport default withRouter(Page)</pre></div> <p>We provide a codemod (a code to code transformation) to automatically change the <code>url</code> property usages to <code>withRouter</code>.</p> <p>You can find this codemod and instructions on how to run it here: /docs/advanced-features/codemods#url-to-withrouter</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/url-deprecated\" class=\"_attribution-link\">https://nextjs.org/docs/messages/url-deprecated</a>\n  </p>\n</div>\n","messages/no-head-import-in-document":"<h1>No Head Import in Document</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent usage of <code>next/head</code> in <code>pages/_document.js</code>.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p><code>next/head</code> was imported in <code>pages/_document.js</code>. This can cause unexpected issues in your application.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Only import and use <code>next/document</code> within <code>pages/_document.js</code> to override the default <code>Document</code> component. If you are importing <code>next/head</code> to use the <code>Head</code> component, import it from <code>next/document</code> instead in order to modify <code>&lt;head&gt;</code> code across all pages:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Document, { Html, Head, Main, NextScript } from 'next/document'\n \nclass MyDocument extends Document {\n  static async getInitialProps(ctx) {\n    //...\n  }\n \n  render() {\n    return (\n      &lt;Html&gt;\n        &lt;Head&gt;&lt;/Head&gt;\n      &lt;/Html&gt;\n    )\n  }\n}\n \nexport default MyDocument</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/building-your-application/routing/custom-document\">Custom Document</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-head-import-in-document\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-head-import-in-document</a>\n  </p>\n</div>\n","messages/no-html-link-for-pages":"<h1>No HTML link for pages</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent usage of <code>&lt;a&gt;</code> elements to navigate to internal Next.js pages.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>An <code>&lt;a&gt;</code> element was used to navigate to a page route without using the <code>next/link</code> component, causing unnecessary full-page refreshes.</p> <p>The <code>Link</code> component is required to enable client-side route transitions between pages and provide a single-page app experience.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Make sure to import the <code>Link</code> component and wrap anchor elements that route to different page routes.</p> <p><strong>Before:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function Home() {\n  return (\n    &lt;div&gt;\n      &lt;a href=\"/about\"&gt;About Us&lt;/a&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <p><strong>After:</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Link from 'next/link'\n \nfunction Home() {\n  return (\n    &lt;div&gt;\n      &lt;Link href=\"/about\"&gt;About Us&lt;/Link&gt;\n    &lt;/div&gt;\n  )\n}\n \nexport default Home</pre></div> <h3 id=\"options\" data-docs-heading=\"\">Options     </h3> <h4 id=\"pagesdir\" data-docs-heading=\"\">pagesDir     </h4> <p>This rule can normally locate your <code>pages</code> directory automatically.</p> <p>If you're working in a monorepo, we recommend configuring the <a href=\"../pages/building-your-application/configuring/eslint#rootdir\"><code>rootDir</code></a> setting in <code>eslint-plugin-next</code>, which <code>pagesDir</code> will use to locate your <code>pages</code> directory.</p> <p>In some cases, you may also need to configure this rule directly by providing a <code>pages</code> directory. This can be a path or an array of paths.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">{\n  \"rules\": {\n    \"@next/next/no-html-link-for-pages\": [\"error\", \"packages/my-app/pages/\"]\n  }\n}</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/api-reference/components/link\">next/link API Reference</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-html-link-for-pages\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-html-link-for-pages</a>\n  </p>\n</div>\n","messages/no-script-component-in-head":"<h1>No Script Component in Head</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent usage of <code>next/script</code> in <code>next/head</code> component.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>The <code>next/script</code> component should not be used in a <code>next/head</code> component.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Move the <code>&lt;Script /&gt;</code> component outside of <code>&lt;Head&gt;</code> instead.</p> <p><strong>Before</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\nimport Head from 'next/head'\n \nexport default function Index() {\n  return (\n    &lt;Head&gt;\n      &lt;title&gt;Next.js&lt;/title&gt;\n      &lt;Script src=\"/my-script.js\" /&gt;\n    &lt;/Head&gt;\n  )\n}</pre></div> <p><strong>After</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\nimport Head from 'next/head'\n \nexport default function Index() {\n  return (\n    &lt;&gt;\n      &lt;Head&gt;\n        &lt;title&gt;Next.js&lt;/title&gt;\n      &lt;/Head&gt;\n      &lt;Script src=\"/my-script.js\" /&gt;\n    &lt;/&gt;\n  )\n}</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/api-reference/components/head\">next/head</a></li> <li><a href=\"../pages/building-your-application/optimizing/scripts\">next/script</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-script-component-in-head\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-script-component-in-head</a>\n  </p>\n</div>\n","messages/no-sync-scripts":"<h1>No Sync Scripts</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent synchronous scripts.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>A synchronous script was used which can impact your webpage performance.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <h4 id=\"script-component-recommended\" data-docs-heading=\"\">Script component (recommended)     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Script from 'next/script'\n \nfunction Home() {\n  return (\n    &lt;div class=\"container\"&gt;\n      &lt;Script src=\"https://third-party-script.js\"&gt;&lt;/Script&gt;\n      &lt;div&gt;Home Page&lt;/div&gt;\n    &lt;/div&gt;\n  )\n}\n \nexport default Home</pre></div> <h4 id=\"use-async-or-defer\" data-docs-heading=\"\">Use async or defer     </h4> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">&lt;script src=\"https://third-party-script.js\" async /&gt;\n&lt;script src=\"https://third-party-script.js\" defer /&gt;</pre>\n</div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"https://web.dev/efficiently-load-third-party-javascript/\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Efficiently load third-party JavaScript</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-sync-scripts\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-sync-scripts</a>\n  </p>\n</div>\n","messages/conflicting-public-file-page":"<h1>Conflicting Public File and Page File</h1>\n<h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>One of your public files has the same path as a page file which is not supported. Since only one resource can reside at the URL both public files and page files must be unique.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Rename either the public file or page file that is causing the conflict.</p> <p>Example conflict between public file and page file</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">public/\n  hello\npages/\n  hello.js</pre></div> <p>Non-conflicting public file and page file</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">public/\n  hello.txt\npages/\n  hello.js</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/building-your-application/optimizing/static-assets\">Static file serving docs</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/conflicting-public-file-page\" class=\"_attribution-link\">https://nextjs.org/docs/messages/conflicting-public-file-page</a>\n  </p>\n</div>\n","messages/middleware-upgrade-guide":"<h1>Middleware Upgrade Guide</h1>\n<p>As we work on improving Middleware for General Availability (GA), we've made some changes to the Middleware APIs (and how you define Middleware in your application) based on your feedback.</p> <p>This upgrade guide will help you understand the changes, why they were made, and how to migrate your existing Middleware to the new API. The guide is for Next.js developers who:</p> <ul> <li>Currently use the beta Next.js Middleware features</li> <li>Choose to upgrade to the next stable version of Next.js (<code>v12.2</code>)</li> </ul> <p>You can start upgrading your Middleware usage today with the latest release (<code>npm i next@latest</code>).</p> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: These changes described in this guide are included in Next.js <code>12.2</code>. You can keep your current site structure, including nested Middleware, until you move to <code>12.2</code> (or a <code>canary</code> build of Next.js).</p> </blockquote> <p>If you have ESLint configured, you will need to run <code>npm i eslint-config-next@latest --save-dev</code> to upgrade your ESLint configuration to ensure the same version is being used as the Next.js version. You might also need to restart VSCode for the changes to take effect.</p> <h2 id=\"using-nextjs-middleware-on-vercel\" data-docs-heading=\"\">Using Next.js Middleware on Vercel     </h2> <p>If you're using Next.js on Vercel, your existing deploys using Middleware will continue to work, and you can continue to deploy your site using Middleware. When you upgrade your site to the next stable version of Next.js (<code>v12.2</code>), you will need to follow this upgrade guide to update your Middleware.</p> <h2 id=\"breaking-changes\" data-docs-heading=\"\">Breaking changes     </h2> <ol> <li><a href=\"#no-nested-middleware\">No Nested Middleware</a></li> <li><a href=\"#no-response-body\">No Response Body</a></li> <li><a href=\"#cookies-api-revamped\">Cookies API Revamped</a></li> <li><a href=\"#new-user-agent-helper\">New User-Agent Helper</a></li> <li><a href=\"#no-more-page-match-data\">No More Page Match Data</a></li> <li><a href=\"#executing-middleware-on-internal-nextjs-requests\">Executing Middleware on Internal Next.js Requests</a></li> </ol> <h2 id=\"no-nested-middleware\" data-docs-heading=\"\">No Nested Middleware     </h2> <h3 id=\"summary-of-changes\" data-docs-heading=\"\">Summary of changes     </h3> <ul> <li>Define a single Middleware file next to your <code>pages</code> folder</li> <li>No need to prefix the file with an underscore</li> <li>A custom matcher can be used to define matching routes using an exported config object</li> </ul> <h3 id=\"explanation\" data-docs-heading=\"\">Explanation     </h3> <p>Previously, you could create a <code>_middleware.ts</code> file under the <code>pages</code> directory at any level. Middleware execution was based on the file path where it was created.</p> <p>Based on customer feedback, we have replaced this API with a single root Middleware, which provides the following improvements:</p> <ul> <li>\n<strong>Faster execution with lower latency</strong>: With nested Middleware, a single request could invoke multiple Middleware functions. A single Middleware means a single function execution, which is more efficient.</li> <li>\n<strong>Less expensive</strong>: Middleware usage is billed per invocation. Using nested Middleware, a single request could invoke multiple Middleware functions, meaning multiple Middleware charges per request. A single Middleware means a single invocation per request and is more cost effective.</li> <li>\n<strong>Middleware can conveniently filter on things besides routes</strong>: With nested Middleware, the Middleware files were located in the <code>pages</code> directory and Middleware was executed based on request paths. By moving to a single root Middleware, you can still execute code based on request paths, but you can now more conveniently execute Middleware based on other conditions, like <code>cookies</code> or the presence of a request header.</li> <li>\n<strong>Deterministic execution ordering</strong>: With nested Middleware, a single request could match multiple Middleware functions. For example, a request to <code>/dashboard/users/*</code> would invoke Middleware defined in both <code>/dashboard/users/_middleware.ts</code> and <code>/dashboard/_middleware.js</code>. However, the execution order is difficult to reason about. Moving to a single, root Middleware more explicitly defines execution order.</li> <li>\n<strong>Supports Next.js Layouts (RFC)</strong>: Moving to a single, root Middleware helps support the new <a href=\"https://nextjs.org/blog/layouts-rfc\">Layouts (RFC) in Next.js</a>.</li> </ul> <h3 id=\"how-to-upgrade\" data-docs-heading=\"\">How to upgrade     </h3> <p>You should declare <strong>one single Middleware file</strong> in your application, which should be located next to the <code>pages</code> directory and named <strong>without</strong> an <code>_</code> prefix. Your Middleware file can still have either a <code>.ts</code> or <code>.js</code> extension.</p> <p>Middleware will be invoked for <strong>every route in the app</strong>, and a custom matcher can be used to define matching filters. The following is an example for a Middleware that triggers for <code>/about/*</code> and <code>/dashboard/:path*</code>, the custom matcher is defined in an exported config object:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  return NextResponse.rewrite(new URL('/about-2', request.url))\n}\n \n// Supports both a single string value or an array of matchers\nexport const config = {\n  matcher: ['/about/:path*', '/dashboard/:path*'],\n}</pre></div> <p>The matcher config also allows full regex so matching like negative lookaheads or character matching is supported. An example of a negative lookahead to match all except specific paths can be seen here:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - favicon.ico (favicon file)\n     */\n    '/((?!api|_next/static|favicon.ico).*)',\n  ],\n}</pre></div> <p>While the config option is preferred since it doesn't get invoked on every request, you can also use conditional statements to only run the Middleware when it matches specific paths. One advantage of using conditionals is defining explicit ordering for when Middleware executes. The following example shows how you can merge two previously nested Middleware:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  if (request.nextUrl.pathname.startsWith('/about')) {\n    // This logic is only applied to /about\n  }\n \n  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n    // This logic is only applied to /dashboard\n  }\n}</pre></div> <h2 id=\"no-response-body\" data-docs-heading=\"\">No Response Body     </h2> <h3 id=\"summary-of-changes-1\" data-docs-heading=\"\">Summary of changes     </h3> <ul> <li>Middleware can no longer produce a response body</li> <li>If your Middleware <em>does</em> respond with a body, a runtime error will be thrown</li> <li>Migrate to using <code>rewrite</code>/<code>redirect</code> to pages/APIs handling a response</li> </ul> <h3 id=\"explanation-1\" data-docs-heading=\"\">Explanation     </h3> <p>To respect the differences in client-side and server-side navigation, and to help ensure that developers do not build insecure Middleware, we are removing the ability to send response bodies in Middleware. This ensures that Middleware is only used to <code>rewrite</code>, <code>redirect</code>, or modify the incoming request (e.g. <a href=\"#cookies-api-revamped\">setting cookies</a>).</p> <p>The following patterns will no longer work:</p> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">new Response('a text value')\nnew Response(streamOrBuffer)\nnew Response(JSON.stringify(obj), { headers: 'application/json' })\nNextResponse.json()</pre>\n</div> <h3 id=\"how-to-upgrade-1\" data-docs-heading=\"\">How to upgrade     </h3> <p>For cases where Middleware is used to respond (such as authorization), you should migrate to use <code>rewrite</code>/<code>redirect</code> to pages that show an authorization error, login forms, or to an API Route.</p> <h4 id=\"before\" data-docs-heading=\"\">Before     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\nimport { isAuthValid } from './lib/auth'\n \nexport function middleware(request: NextRequest) {\n  // Example function to validate auth\n  if (isAuthValid(request)) {\n    return NextResponse.next()\n  }\n \n  return NextResponse.json({ message: 'Auth required' }, { status: 401 })\n}</pre></div> <h4 id=\"after\" data-docs-heading=\"\">After     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\nimport { isAuthValid } from './lib/auth'\n \nexport function middleware(request: NextRequest) {\n  // Example function to validate auth\n  if (isAuthValid(request)) {\n    return NextResponse.next()\n  }\n \n  const loginUrl = new URL('/login', request.url)\n  loginUrl.searchParams.set('from', request.nextUrl.pathname)\n \n  return NextResponse.redirect(loginUrl)\n}</pre></div> <h4 id=\"edge-api-routes\" data-docs-heading=\"\">Edge API Routes     </h4> <p>If you were previously using Middleware to forward headers to an external API, you can now use <a href=\"../pages/building-your-application/routing/api-routes\">Edge API Routes</a>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { type NextRequest } from 'next/server'\n \nexport const config = {\n  runtime: 'edge',\n}\n \nexport default async function handler(req: NextRequest) {\n  const authorization = req.cookies.get('authorization')\n  return fetch('https://backend-api.com/api/protected', {\n    method: req.method,\n    headers: {\n      authorization,\n    },\n    redirect: 'manual',\n  })\n}</pre></div> <h2 id=\"cookies-api-revamped\" data-docs-heading=\"\">Cookies API Revamped     </h2> <h3 id=\"summary-of-changes-2\" data-docs-heading=\"\">Summary of changes     </h3> <div class=\"overflow-x-auto\"><table class=\"w-full table-auto\">\n<thead><tr>\n<th>Added</th>\n<th>Removed</th>\n</tr></thead>\n<tbody>\n<tr>\n<td><code>cookies.set</code></td>\n<td><code>cookie</code></td>\n</tr>\n<tr>\n<td><code>cookies.delete</code></td>\n<td><code>clearCookie</code></td>\n</tr>\n<tr>\n<td><code>cookies.getWithOptions</code></td>\n<td><code>cookies</code></td>\n</tr>\n</tbody>\n</table></div> <h3 id=\"explanation-2\" data-docs-heading=\"\">Explanation     </h3> <p>Based on beta feedback, we are changing the Cookies API in <code>NextRequest</code> and <code>NextResponse</code> to align more to a <code>get</code>/<code>set</code> model. The <code>Cookies</code> API extends Map, including methods like <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map/entries\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">entries</a> and <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map/entries\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">values</a>.</p> <h3 id=\"how-to-upgrade-2\" data-docs-heading=\"\">How to upgrade     </h3> <p><code>NextResponse</code> now has a <code>cookies</code> instance with:</p> <ul> <li><code>cookies.delete</code></li> <li><code>cookies.set</code></li> <li><code>cookies.getWithOptions</code></li> </ul> <p>As well as other extended methods from <code>Map</code>.</p> <h4 id=\"before-1\" data-docs-heading=\"\">Before     </h4> <div class=\"code-block_wrapper__t6FCO not-prose\">\n<pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">// pages/_middleware.ts\nimport { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  // create an instance of the class to access the public methods. This uses `next()`,\n  // you could use `redirect()` or `rewrite()` as well\n  let response = NextResponse.next()\n  // get the cookies from the request\n  let cookieFromRequest = request.cookies['my-cookie']\n  // set the `cookie`\n  response.cookie('hello', 'world')\n  // set the `cookie` with options\n  const cookieWithOptions = response.cookie('hello', 'world', {\n    path: '/',\n    maxAge: 1000 * 60 * 60 * 24 * 7,\n    httpOnly: true,\n    sameSite: 'strict',\n    domain: 'example.com',\n  })\n  // clear the `cookie`\n  response.clearCookie('hello')\n \n  return response\n}</pre>\n</div> <h4 id=\"after-1\" data-docs-heading=\"\">After     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">export function middleware() {\n  const response = new NextResponse()\n \n  // set a cookie\n  response.cookies.set('vercel', 'fast')\n \n  // set another cookie with options\n  response.cookies.set('nextjs', 'awesome', { path: '/test' })\n \n  // get all the details of a cookie\n  const { value, ...options } = response.cookies.getWithOptions('vercel')\n  console.log(value) // =&gt; 'fast'\n  console.log(options) // =&gt; { name: 'vercel', Path: '/test' }\n \n  // deleting a cookie will mark it as expired\n  response.cookies.delete('vercel')\n \n  return response\n}</pre></div> <h2 id=\"new-user-agent-helper\" data-docs-heading=\"\">New User-Agent Helper     </h2> <h3 id=\"summary-of-changes-3\" data-docs-heading=\"\">Summary of changes     </h3> <ul> <li>Accessing the user agent is no longer available on the request object</li> <li>We've added a new <code>userAgent</code> helper to reduce Middleware size by <code>17kb</code>\n</li> </ul> <h3 id=\"explanation-3\" data-docs-heading=\"\">Explanation     </h3> <p>To help reduce the size of your Middleware, we have extracted the user agent from the request object and created a new helper <code>userAgent</code>.</p> <p>The helper is imported from <code>next/server</code> and allows you to opt in to using the user agent. The helper gives you access to the same properties that were available from the request object.</p> <h3 id=\"how-to-upgrade-3\" data-docs-heading=\"\">How to upgrade     </h3> <ul> <li>Import the <code>userAgent</code> helper from <code>next/server</code>\n</li> <li>Destructure the properties you need to work with</li> </ul> <h4 id=\"before-2\" data-docs-heading=\"\">Before     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  const url = request.nextUrl\n  const viewport = request.ua.device.type === 'mobile' ? 'mobile' : 'desktop'\n  url.searchParams.set('viewport', viewport)\n  return NextResponse.rewrite(url)\n}</pre></div> <h4 id=\"after-2\" data-docs-heading=\"\">After     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextRequest, NextResponse, userAgent } from 'next/server'\n \nexport function middleware(request: NextRequest) {\n  const url = request.nextUrl\n  const { device } = userAgent(request)\n  const viewport = device.type === 'mobile' ? 'mobile' : 'desktop'\n  url.searchParams.set('viewport', viewport)\n  return NextResponse.rewrite(url)\n}</pre></div> <h2 id=\"no-more-page-match-data\" data-docs-heading=\"\">No More Page Match Data     </h2> <h3 id=\"summary-of-changes-4\" data-docs-heading=\"\">Summary of changes     </h3> <ul> <li>Use <a href=\"https://developer.mozilla.org/docs/Web/API/URLPattern\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLPattern</code></a> to check if a Middleware is being invoked for a certain page match</li> </ul> <h3 id=\"explanation-4\" data-docs-heading=\"\">Explanation     </h3> <p>Currently, Middleware estimates whether you are serving an asset of a Page based on the Next.js routes manifest (internal configuration). This value is surfaced through <code>request.page</code>.</p> <p>To make page and asset matching more accurate, we are now using the web standard <code>URLPattern</code> API.</p> <h3 id=\"how-to-upgrade-4\" data-docs-heading=\"\">How to upgrade     </h3> <p>Use <a href=\"https://developer.mozilla.org/docs/Web/API/URLPattern\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>URLPattern</code></a> to check if a Middleware is being invoked for a certain page match.</p> <h4 id=\"before-3\" data-docs-heading=\"\">Before     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest, NextFetchEvent } from 'next/server'\n \nexport function middleware(request: NextRequest, event: NextFetchEvent) {\n  const { params } = event.request.page\n  const { locale, slug } = params\n \n  if (locale &amp;&amp; slug) {\n    const { search, protocol, host } = request.nextUrl\n    const url = new URL(`${protocol}//${locale}.${host}/${slug}${search}`)\n    return NextResponse.redirect(url)\n  }\n}</pre></div> <h4 id=\"after-3\" data-docs-heading=\"\">After     </h4> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n \nconst PATTERNS = [\n  [\n    new URLPattern({ pathname: '/:locale/:slug' }),\n    ({ pathname }) =&gt; pathname.groups,\n  ],\n]\n \nconst params = (url) =&gt; {\n  const input = url.split('?')[0]\n  let result = {}\n \n  for (const [pattern, handler] of PATTERNS) {\n    const patternResult = pattern.exec(input)\n    if (patternResult !== null &amp;&amp; 'pathname' in patternResult) {\n      result = handler(patternResult)\n      break\n    }\n  }\n  return result\n}\n \nexport function middleware(request: NextRequest) {\n  const { locale, slug } = params(request.url)\n \n  if (locale &amp;&amp; slug) {\n    const { search, protocol, host } = request.nextUrl\n    const url = new URL(`${protocol}//${locale}.${host}/${slug}${search}`)\n    return NextResponse.redirect(url)\n  }\n}</pre></div> <h2 id=\"executing-middleware-on-internal-nextjs-requests\" data-docs-heading=\"\">Executing Middleware on Internal Next.js Requests     </h2> <h3 id=\"summary-of-changes-5\" data-docs-heading=\"\">Summary of changes     </h3> <ul> <li>Middleware will be executed for <em>all</em> requests, including <code>_next</code>\n</li> </ul> <h3 id=\"explanation-5\" data-docs-heading=\"\">Explanation     </h3> <p>Prior to Next.js <code>v12.2</code>, Middleware was not executed for <code>_next</code> requests.</p> <p>For cases where Middleware is used for authorization, you should migrate to use <code>rewrite</code>/<code>redirect</code> to Pages that show an authorization error, login forms, or to an API Route.</p> <p>See <a href=\"#no-response-body\">No Response Body</a> for an example of how to migrate to use <code>rewrite</code>/<code>redirect</code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/middleware-upgrade-guide\" class=\"_attribution-link\">https://nextjs.org/docs/messages/middleware-upgrade-guide</a>\n  </p>\n</div>\n","messages/no-img-element":"<h1>No img element</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent usage of <code>&lt;img&gt;</code> element due to slower LCP and higher bandwidth.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>An <code>&lt;img&gt;</code> element was used to display an image instead of <code>&lt;Image /&gt;</code> from <code>next/image</code>.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Use <a href=\"../pages/api-reference/components/image\"><code>next/image</code></a> to improve performance with automatic <a href=\"../pages/building-your-application/optimizing/images\">Image Optimization</a>.</p> <blockquote class=\"p-3 text-sm\"> <p>Note: If deploying to a <a href=\"../pages/building-your-application/deploying\">managed hosting provider</a>, remember to check provider pricing since optimized images might be charged differently than the original images.</p> <p>Common image optimization platform pricing:</p> <ul> <li><a href=\"https://vercel.com/pricing\" rel=\"noopener noreferrer\" target=\"_blank\">Vercel pricing</a></li> <li><a href=\"https://cloudinary.com/pricing\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">Cloudinary pricing</a></li> <li><a href=\"https://imgix.com/pricing\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">imgix pricing</a></li> </ul> </blockquote> <blockquote class=\"p-3 text-sm\"> <p>Note: If self-hosting, remember to install <a href=\"https://www.npmjs.com/package/sharp\" rel=\"noopener noreferrer nofollow\" target=\"_blank\"><code>sharp</code></a> and check if your server has enough storage to cache the optimized images.</p> </blockquote> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Image from 'next/image'\n \nfunction Home() {\n  return (\n    &lt;Image\n      src=\"https://example.com/hero.jpg\"\n      alt=\"Landscape picture\"\n      width={800}\n      height={500}\n    /&gt;\n  )\n}\n \nexport default Home</pre></div> <p>If you would like to use <code>next/image</code> features such as blur-up placeholders but disable Image Optimization, you can do so using <a href=\"../pages/api-reference/components/image#unoptimized\">unoptimized</a>.</p> <p>Or, use a <code>&lt;picture&gt;</code> element with the nested <code>&lt;img&gt;</code> element:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">function Home() {\n  return (\n    &lt;picture&gt;\n      &lt;source srcSet=\"https://example.com/hero.avif\" type=\"image/avif\" /&gt;\n      &lt;source srcSet=\"https://example.com/hero.webp\" type=\"image/webp\" /&gt;\n      &lt;img\n        src=\"https://example.com/hero.jpg\"\n        alt=\"Landscape picture\"\n        width={800}\n        height={500}\n      /&gt;\n    &lt;/picture&gt;\n  )\n}</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/building-your-application/optimizing/images\">Image Component and Image Optimization</a></li> <li><a href=\"../pages/api-reference/components/image\">next/image API Reference</a></li> <li><a href=\"https://nextjs.org/learn/seo/web-performance/lcp\">Largest Contentful Paint (LCP)</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-img-element\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-img-element</a>\n  </p>\n</div>\n","messages/no-styled-jsx-in-document":"<h1>No `styled-jsx` in `_document`</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent usage of <code>styled-jsx</code> in <code>pages/_document.js</code>.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>Custom CSS like <code>styled-jsx</code> is not allowed in a <a href=\"../pages/building-your-application/routing/custom-document\">Custom Document</a>.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>If you need shared CSS for all of your pages, take a look at the <a href=\"../pages/building-your-application/routing/custom-app\">Custom <code>App</code></a> file or define a custom layout.</p> <p>For example, consider the following stylesheet named <code>styles.css</code>:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">body {\n  font-family: 'SF Pro Text', 'SF Pro Icons', 'Helvetica Neue', 'Helvetica',\n    'Arial', sans-serif;\n  padding: 20px 20px 60px;\n  max-width: 680px;\n  margin: 0 auto;\n}</pre></div> <p>Create a <code>pages/_app.{js,tsx}</code> file if not already present. Then, import the <code>styles.css</code> file.</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import '../styles.css'\n \n// This default export is required in a new `pages/_app.js` file.\nexport default function MyApp({ Component, pageProps }) {\n  return &lt;Component {...pageProps} /&gt;\n}</pre></div> <p>These styles (<code>styles.css</code>) will apply to all pages and components in your application.</p> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/building-your-application/routing/custom-document#caveats\">Custom Document Caveats</a></li> <li><a href=\"../pages/building-your-application/routing/pages-and-layouts#layout-pattern\">Layouts</a></li> <li><a href=\"../pages/building-your-application/styling\">Built in CSS Support</a></li> <li><a href=\"../pages/building-your-application/routing/custom-app\">Custom <code>App</code></a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-styled-jsx-in-document\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-styled-jsx-in-document</a>\n  </p>\n</div>\n","messages/no-title-in-document-head":"<h1>No Title in Document Head</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent usage of <code>&lt;title&gt;</code> with <code>Head</code> component from <code>next/document</code>.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>A <code>&lt;title&gt;</code> element was defined within the <code>Head</code> component imported from <code>next/document</code>, which should only be used for any <code>&lt;head&gt;</code> code that is common for all pages. Title tags should be defined at the page-level using <code>next/head</code> instead.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Within a page or component, import and use <code>next/head</code> to define a page title:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Head from 'next/head'\n \nexport function Home() {\n  return (\n    &lt;div&gt;\n      &lt;Head&gt;\n        &lt;title&gt;My page title&lt;/title&gt;\n      &lt;/Head&gt;\n    &lt;/div&gt;\n  )\n}</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/api-reference/components/head\">next/head</a></li> <li><a href=\"../pages/building-your-application/routing/custom-document\">Custom Document</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-title-in-document-head\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-title-in-document-head</a>\n  </p>\n</div>\n","messages/no-cache":"<h1>No Cache Detected</h1>\n<h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>A Next.js build was triggered in a continuous integration environment, but no cache was detected.</p> <p>This results in slower builds and can hurt Next.js' persistent caching of client-side bundles across builds.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <blockquote class=\"p-3 text-sm\"> <p><strong>Note</strong>: If this is a new project, or being built for the first time in your CI, you can ignore this error. However, you'll want to make sure it doesn't continue to happen and fix it if it does!</p> </blockquote> <p>Follow the instructions in <a href=\"../pages/building-your-application/deploying/ci-build-caching\">CI Build Caching</a> to ensure your Next.js cache is persisted between builds.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-cache\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-cache</a>\n  </p>\n</div>\n","messages/webpack5":"<h1>Webpack 5 Adoption</h1>\n<h4 id=\"why-this-message-occurred\" data-docs-heading=\"\">Why This Message Occurred     </h4> <p>Next.js has adopted webpack 5 as the default for compilation. We've spent a lot of effort into ensuring the transition from webpack 4 to 5 will be as smooth as possible.</p> <p>Your application currently has webpack 5 disabled using the <code>webpack5: false</code> flag which has been removed in Next.js 12:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">module.exports = {\n  // Webpack 5 is enabled by default\n  // You can still use webpack 4 while upgrading to the latest version of Next.js by adding the \"webpack5: false\" flag\n  webpack5: false,\n}</pre></div> <p>Using webpack 5 in your application has many benefits, notably:</p> <ul> <li>Improved Disk Caching: <code>next build</code> is significantly faster on subsequent builds</li> <li>Improved Fast Refresh: Fast Refresh work is prioritized</li> <li>Improved Long Term Caching of Assets: Deterministic code output that is less likely to change between builds</li> <li>Improved Tree Shaking</li> <li>Support for assets using <code>new URL(\"file.png\", import.meta.url)</code>\n</li> <li>Support for web workers using <code>new Worker(new URL(\"worker.js\", import.meta.url))</code>\n</li> <li>Support for <code>exports</code>/<code>imports</code> field in <code>package.json</code>\n</li> </ul> <p>In the past releases we have gradually rolled out webpack 5 to Next.js applications:</p> <ul> <li>In Next.js 10.2 we automatically opted-in applications without custom webpack configuration in <code>next.config.js</code>\n</li> <li>In Next.js 10.2 we automatically opted-in applications that do not have a <code>next.config.js</code>\n</li> <li>In Next.js 11 webpack 5 was enabled by default for all applications. You could still opt-out and use webpack 4 to help with backwards compatibility using <code>webpack5: false</code> in <code>next.config.js</code>\n</li> <li>In Next.js 12 webpack 4 support was removed.</li> </ul> <h4 id=\"custom-webpack-configuration\" data-docs-heading=\"\">Custom webpack configuration     </h4> <p>In case you do have custom webpack configuration, either through custom plugins or your own modifications you'll have to take a few steps to ensure your applications works with webpack 5.</p> <ul> <li>When using <code>next-transpile-modules</code> make sure you use the latest version which includes <a href=\"https://github.com/martpie/next-transpile-modules/pull/179\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">this patch</a>\n</li> <li>When using <code>@zeit/next-css</code> / <code>@zeit/next-sass</code> make sure you use the <a href=\"../pages/building-your-application/styling\">built-in CSS/Sass support</a> instead</li> <li>When using <code>@zeit/next-preact</code> use <a href=\"https://github.com/vercel/next.js/tree/canary/examples/using-preact\" rel=\"noopener noreferrer\" target=\"_blank\">this example</a> instead</li> <li>When using <code>@zeit/next-source-maps</code> use the <a href=\"../pages/api-reference/next-config-js/productionbrowsersourcemaps\">built-in production Source Map support</a>\n</li> <li>When using webpack plugins make sure they're upgraded to the latest version, in most cases the latest version will include webpack 5 support. In some cases these upgraded webpack plugins will only support webpack 5.</li> </ul> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <p>In case you're running into issues you can connect with the community in <a href=\"https://github.com/vercel/next.js/discussions/23498\" rel=\"noopener noreferrer\" target=\"_blank\">this help discussion</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/webpack5\" class=\"_attribution-link\">https://nextjs.org/docs/messages/webpack5</a>\n  </p>\n</div>\n","messages/no-document-import-in-page":"<h1>No Document Import in Page</h1>\n<blockquote class=\"p-3 text-sm\"> <p>Prevent importing <code>next/document</code> outside of <code>pages/_document.js</code>.</p> </blockquote> <h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p><code>next/document</code> was imported in a page outside of <code>pages/_document.js</code> (or <code>pages/_document.tsx</code> if you are using TypeScript). This can cause unexpected issues in your application.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Only import and use <code>next/document</code> within <code>pages/_document.js</code> (or <code>pages/_document.tsx</code>) to override the default <code>Document</code> component:</p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import Document, { Html, Head, Main, NextScript } from 'next/document'\n \nclass MyDocument extends Document {\n  //...\n}\n \nexport default MyDocument</pre></div> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/building-your-application/routing/custom-document\">Custom Document</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/no-document-import-in-page\" class=\"_attribution-link\">https://nextjs.org/docs/messages/no-document-import-in-page</a>\n  </p>\n</div>\n","messages/app-container-deprecated":"<h1>Addressing \"App Container Deprecated\" Error in Next.js</h1>\n<p>This document guides developers on how to resolve the \"App Container Deprecated\" error in Next.js by updating their custom App component.</p>\n<h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>The \"App Container Deprecated\" error usually occurs when you are using the <code>&lt;Container&gt;</code> component in your custom <code>&lt;App&gt;</code> (<code>pages/_app.js</code>). Prior to version <code>9.0.4</code> of Next.js, the <code>&lt;Container&gt;</code> component was used to handle scrolling to hashes.</p> <p>From version <code>9.0.4</code> onwards, this functionality was moved up the component tree, rendering the <code>&lt;Container&gt;</code> component unnecessary in your custom <code>&lt;App&gt;</code>.</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>To resolve this issue, you need to remove the <code>&lt;Container&gt;</code> component from your custom <code>&lt;App&gt;</code> (<code>pages/_app.js</code>).</p> <p><strong>Before</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nimport App, { Container } from 'next/app'\n \nclass MyApp extends App {\n  render() {\n    const { Component, pageProps } = this.props\n    return (\n      &lt;Container&gt;\n        &lt;Component {...pageProps} /&gt;\n      &lt;/Container&gt;\n    )\n  }\n}\n \nexport default MyApp</pre></div> <p><strong>After</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import React from 'react'\nimport App from 'next/app'\n \nclass MyApp extends App {\n  render() {\n    const { Component, pageProps } = this.props\n    return &lt;Component {...pageProps} /&gt;\n  }\n}\n \nexport default MyApp</pre></div> <p>After making this change, your custom <code>&lt;App&gt;</code> should work as expected without the <code>&lt;Container&gt;</code> component.</p> <h2 id=\"useful-links\" data-docs-heading=\"\">Useful Links     </h2> <ul> <li><a href=\"../pages/building-your-application/routing/custom-app\">Custom App</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/app-container-deprecated\" class=\"_attribution-link\">https://nextjs.org/docs/messages/app-container-deprecated</a>\n  </p>\n</div>\n","messages/next-dynamic-modules":"<h1>`next/dynamic` has deprecated loading multiple modules at once</h1>\n<h2 id=\"why-this-error-occurred\" data-docs-heading=\"\">Why This Error Occurred     </h2> <p>The ability to load multiple modules at once has been deprecated in <code>next/dynamic</code> to be closer to React's implementation (<code>React.lazy</code> and <code>Suspense</code>).</p> <p>Updating code that relies on this behavior is relatively straightforward! We've provided an example of a before/after to help you migrate your application:</p> <h2 id=\"possible-ways-to-fix-it\" data-docs-heading=\"\">Possible Ways to Fix It     </h2> <p>Migrate to using separate dynamic calls for each module.</p> <p><strong>Before</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst HelloBundle = dynamic({\n  modules: () =&gt; {\n    const components = {\n      Hello1: () =&gt; import('../components/hello1').then((m) =&gt; m.default),\n      Hello2: () =&gt; import('../components/hello2').then((m) =&gt; m.default),\n    }\n \n    return components\n  },\n  render: (props, { Hello1, Hello2 }) =&gt; (\n    &lt;div&gt;\n      &lt;h1&gt;{props.title}&lt;/h1&gt;\n      &lt;Hello1 /&gt;\n      &lt;Hello2 /&gt;\n    &lt;/div&gt;\n  ),\n})\n \nfunction DynamicBundle() {\n  return &lt;HelloBundle title=\"Dynamic Bundle\" /&gt;\n}\n \nexport default DynamicBundle</pre></div> <p><strong>After</strong></p> <div class=\"code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose\"><pre class=\"code-block_pre___OLfy\" data-language=\"typescript\">import dynamic from 'next/dynamic'\n \nconst Hello1 = dynamic(() =&gt; import('../components/hello1'))\nconst Hello2 = dynamic(() =&gt; import('../components/hello2'))\n \nfunction HelloBundle({ title }) {\n  return (\n    &lt;div&gt;\n      &lt;h1&gt;{title}&lt;/h1&gt;\n      &lt;Hello1 /&gt;\n      &lt;Hello2 /&gt;\n    &lt;/div&gt;\n  )\n}\n \nfunction DynamicBundle() {\n  return &lt;HelloBundle title=\"Dynamic Bundle\" /&gt;\n}\n \nexport default DynamicBundle</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>\n    <a href=\"https://nextjs.org/docs/messages/next-dynamic-modules\" class=\"_attribution-link\">https://nextjs.org/docs/messages/next-dynamic-modules</a>\n  </p>\n</div>\n"}